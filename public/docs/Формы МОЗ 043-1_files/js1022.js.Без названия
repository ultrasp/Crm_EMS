
/*!
 * Bootstrap v3.3.2 (http://getbootstrap.com)
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 */
if("undefined"==typeof jQuery)throw new Error("Bootstrap's JavaScript requires jQuery");+function(a){"use strict";var b=a.fn.jquery.split(" ")[0].split(".");if(b[0]<2&&b[1]<9||1==b[0]&&9==b[1]&&b[2]<1)throw new Error("Bootstrap's JavaScript requires jQuery version 1.9.1 or higher")}(jQuery),+function(a){"use strict";function b(){var a=document.createElement("bootstrap"),b={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var c in b)if(void 0!==a.style[c])return{end:b[c]};return!1}a.fn.emulateTransitionEnd=function(b){var c=!1,d=this;a(this).one("bsTransitionEnd",function(){c=!0});var e=function(){c||a(d).trigger(a.support.transition.end)};return setTimeout(e,b),this},a(function(){a.support.transition=b(),a.support.transition&&(a.event.special.bsTransitionEnd={bindType:a.support.transition.end,delegateType:a.support.transition.end,handle:function(b){return a(b.target).is(this)?b.handleObj.handler.apply(this,arguments):void 0}})})}(jQuery),+function(a){"use strict";function b(b){return this.each(function(){var c=a(this),e=c.data("bs.alert");e||c.data("bs.alert",e=new d(this)),"string"==typeof b&&e[b].call(c)})}var c='[data-dismiss="alert"]',d=function(b){a(b).on("click",c,this.close)};d.VERSION="3.3.2",d.TRANSITION_DURATION=150,d.prototype.close=function(b){function c(){g.detach().trigger("closed.bs.alert").remove()}var e=a(this),f=e.attr("data-target");f||(f=e.attr("href"),f=f&&f.replace(/.*(?=#[^\s]*$)/,""));var g=a(f);b&&b.preventDefault(),g.length||(g=e.closest(".alert")),g.trigger(b=a.Event("close.bs.alert")),b.isDefaultPrevented()||(g.removeClass("in"),a.support.transition&&g.hasClass("fade")?g.one("bsTransitionEnd",c).emulateTransitionEnd(d.TRANSITION_DURATION):c())};var e=a.fn.alert;a.fn.alert=b,a.fn.alert.Constructor=d,a.fn.alert.noConflict=function(){return a.fn.alert=e,this},a(document).on("click.bs.alert.data-api",c,d.prototype.close)}(jQuery),+function(a){"use strict";function b(b){return this.each(function(){var d=a(this),e=d.data("bs.button"),f="object"==typeof b&&b;e||d.data("bs.button",e=new c(this,f)),"toggle"==b?e.toggle():b&&e.setState(b)})}var c=function(b,d){this.$element=a(b),this.options=a.extend({},c.DEFAULTS,d),this.isLoading=!1};c.VERSION="3.3.2",c.DEFAULTS={loadingText:"loading..."},c.prototype.setState=function(b){var c="disabled",d=this.$element,e=d.is("input")?"val":"html",f=d.data();b+="Text",null==f.resetText&&d.data("resetText",d[e]()),setTimeout(a.proxy(function(){d[e](null==f[b]?this.options[b]:f[b]),"loadingText"==b?(this.isLoading=!0,d.addClass(c).attr(c,c)):this.isLoading&&(this.isLoading=!1,d.removeClass(c).removeAttr(c))},this),0)},c.prototype.toggle=function(){var a=!0,b=this.$element.closest('[data-toggle="buttons"]');if(b.length){var c=this.$element.find("input");"radio"==c.prop("type")&&(c.prop("checked")&&this.$element.hasClass("active")?a=!1:b.find(".active").removeClass("active")),a&&c.prop("checked",!this.$element.hasClass("active")).trigger("change")}else this.$element.attr("aria-pressed",!this.$element.hasClass("active"));a&&this.$element.toggleClass("active")};var d=a.fn.button;a.fn.button=b,a.fn.button.Constructor=c,a.fn.button.noConflict=function(){return a.fn.button=d,this},a(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(c){var d=a(c.target);d.hasClass("btn")||(d=d.closest(".btn")),b.call(d,"toggle"),c.preventDefault()}).on("focus.bs.button.data-api blur.bs.button.data-api",'[data-toggle^="button"]',function(b){a(b.target).closest(".btn").toggleClass("focus",/^focus(in)?$/.test(b.type))})}(jQuery),+function(a){"use strict";function b(b){return this.each(function(){var d=a(this),e=d.data("bs.carousel"),f=a.extend({},c.DEFAULTS,d.data(),"object"==typeof b&&b),g="string"==typeof b?b:f.slide;e||d.data("bs.carousel",e=new c(this,f)),"number"==typeof b?e.to(b):g?e[g]():f.interval&&e.pause().cycle()})}var c=function(b,c){this.$element=a(b),this.$indicators=this.$element.find(".carousel-indicators"),this.options=c,this.paused=this.sliding=this.interval=this.$active=this.$items=null,this.options.keyboard&&this.$element.on("keydown.bs.carousel",a.proxy(this.keydown,this)),"hover"==this.options.pause&&!("ontouchstart"in document.documentElement)&&this.$element.on("mouseenter.bs.carousel",a.proxy(this.pause,this)).on("mouseleave.bs.carousel",a.proxy(this.cycle,this))};c.VERSION="3.3.2",c.TRANSITION_DURATION=600,c.DEFAULTS={interval:5e3,pause:"hover",wrap:!0,keyboard:!0},c.prototype.keydown=function(a){if(!/input|textarea/i.test(a.target.tagName)){switch(a.which){case 37:this.prev();break;case 39:this.next();break;default:return}a.preventDefault()}},c.prototype.cycle=function(b){return b||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(a.proxy(this.next,this),this.options.interval)),this},c.prototype.getItemIndex=function(a){return this.$items=a.parent().children(".item"),this.$items.index(a||this.$active)},c.prototype.getItemForDirection=function(a,b){var c=this.getItemIndex(b),d="prev"==a&&0===c||"next"==a&&c==this.$items.length-1;if(d&&!this.options.wrap)return b;var e="prev"==a?-1:1,f=(c+e)%this.$items.length;return this.$items.eq(f)},c.prototype.to=function(a){var b=this,c=this.getItemIndex(this.$active=this.$element.find(".item.active"));return a>this.$items.length-1||0>a?void 0:this.sliding?this.$element.one("slid.bs.carousel",function(){b.to(a)}):c==a?this.pause().cycle():this.slide(a>c?"next":"prev",this.$items.eq(a))},c.prototype.pause=function(b){return b||(this.paused=!0),this.$element.find(".next, .prev").length&&a.support.transition&&(this.$element.trigger(a.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},c.prototype.next=function(){return this.sliding?void 0:this.slide("next")},c.prototype.prev=function(){return this.sliding?void 0:this.slide("prev")},c.prototype.slide=function(b,d){var e=this.$element.find(".item.active"),f=d||this.getItemForDirection(b,e),g=this.interval,h="next"==b?"left":"right",i=this;if(f.hasClass("active"))return this.sliding=!1;var j=f[0],k=a.Event("slide.bs.carousel",{relatedTarget:j,direction:h});if(this.$element.trigger(k),!k.isDefaultPrevented()){if(this.sliding=!0,g&&this.pause(),this.$indicators.length){this.$indicators.find(".active").removeClass("active");var l=a(this.$indicators.children()[this.getItemIndex(f)]);l&&l.addClass("active")}var m=a.Event("slid.bs.carousel",{relatedTarget:j,direction:h});return a.support.transition&&this.$element.hasClass("slide")?(f.addClass(b),f[0].offsetWidth,e.addClass(h),f.addClass(h),e.one("bsTransitionEnd",function(){f.removeClass([b,h].join(" ")).addClass("active"),e.removeClass(["active",h].join(" ")),i.sliding=!1,setTimeout(function(){i.$element.trigger(m)},0)}).emulateTransitionEnd(c.TRANSITION_DURATION)):(e.removeClass("active"),f.addClass("active"),this.sliding=!1,this.$element.trigger(m)),g&&this.cycle(),this}};var d=a.fn.carousel;a.fn.carousel=b,a.fn.carousel.Constructor=c,a.fn.carousel.noConflict=function(){return a.fn.carousel=d,this};var e=function(c){var d,e=a(this),f=a(e.attr("data-target")||(d=e.attr("href"))&&d.replace(/.*(?=#[^\s]+$)/,""));if(f.hasClass("carousel")){var g=a.extend({},f.data(),e.data()),h=e.attr("data-slide-to");h&&(g.interval=!1),b.call(f,g),h&&f.data("bs.carousel").to(h),c.preventDefault()}};a(document).on("click.bs.carousel.data-api","[data-slide]",e).on("click.bs.carousel.data-api","[data-slide-to]",e),a(window).on("load",function(){a('[data-ride="carousel"]').each(function(){var c=a(this);b.call(c,c.data())})})}(jQuery),+function(a){"use strict";function b(b){var c,d=b.attr("data-target")||(c=b.attr("href"))&&c.replace(/.*(?=#[^\s]+$)/,"");return a(d)}function c(b){return this.each(function(){var c=a(this),e=c.data("bs.collapse"),f=a.extend({},d.DEFAULTS,c.data(),"object"==typeof b&&b);!e&&f.toggle&&"show"==b&&(f.toggle=!1),e||c.data("bs.collapse",e=new d(this,f)),"string"==typeof b&&e[b]()})}var d=function(b,c){this.$element=a(b),this.options=a.extend({},d.DEFAULTS,c),this.$trigger=a(this.options.trigger).filter('[href="#'+b.id+'"], [data-target="#'+b.id+'"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()};d.VERSION="3.3.2",d.TRANSITION_DURATION=350,d.DEFAULTS={toggle:!0,trigger:'[data-toggle="collapse"]'},d.prototype.dimension=function(){var a=this.$element.hasClass("width");return a?"width":"height"},d.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var b,e=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing");if(!(e&&e.length&&(b=e.data("bs.collapse"),b&&b.transitioning))){var f=a.Event("show.bs.collapse");if(this.$element.trigger(f),!f.isDefaultPrevented()){e&&e.length&&(c.call(e,"hide"),b||e.data("bs.collapse",null));var g=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[g](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1;var h=function(){this.$element.removeClass("collapsing").addClass("collapse in")[g](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!a.support.transition)return h.call(this);var i=a.camelCase(["scroll",g].join("-"));this.$element.one("bsTransitionEnd",a.proxy(h,this)).emulateTransitionEnd(d.TRANSITION_DURATION)[g](this.$element[0][i])}}}},d.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var b=a.Event("hide.bs.collapse");if(this.$element.trigger(b),!b.isDefaultPrevented()){var c=this.dimension();this.$element[c](this.$element[c]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1;var e=function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")};return a.support.transition?void this.$element[c](0).one("bsTransitionEnd",a.proxy(e,this)).emulateTransitionEnd(d.TRANSITION_DURATION):e.call(this)}}},d.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},d.prototype.getParent=function(){return a(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each(a.proxy(function(c,d){var e=a(d);this.addAriaAndCollapsedClass(b(e),e)},this)).end()},d.prototype.addAriaAndCollapsedClass=function(a,b){var c=a.hasClass("in");a.attr("aria-expanded",c),b.toggleClass("collapsed",!c).attr("aria-expanded",c)};var e=a.fn.collapse;a.fn.collapse=c,a.fn.collapse.Constructor=d,a.fn.collapse.noConflict=function(){return a.fn.collapse=e,this},a(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(d){var e=a(this);e.attr("data-target")||d.preventDefault();var f=b(e),g=f.data("bs.collapse"),h=g?"toggle":a.extend({},e.data(),{trigger:this});c.call(f,h)})}(jQuery),+function(a){"use strict";function b(b){b&&3===b.which||(a(e).remove(),a(f).each(function(){var d=a(this),e=c(d),f={relatedTarget:this};e.hasClass("open")&&(e.trigger(b=a.Event("hide.bs.dropdown",f)),b.isDefaultPrevented()||(d.attr("aria-expanded","false"),e.removeClass("open").trigger("hidden.bs.dropdown",f)))}))}function c(b){var c=b.attr("data-target");c||(c=b.attr("href"),c=c&&/#[A-Za-z]/.test(c)&&c.replace(/.*(?=#[^\s]*$)/,""));var d=c&&a(c);return d&&d.length?d:b.parent()}function d(b){return this.each(function(){var c=a(this),d=c.data("bs.dropdown");d||c.data("bs.dropdown",d=new g(this)),"string"==typeof b&&d[b].call(c)})}var e=".dropdown-backdrop",f='[data-toggle="dropdown"]',g=function(b){a(b).on("click.bs.dropdown",this.toggle)};g.VERSION="3.3.2",g.prototype.toggle=function(d){var e=a(this);if(!e.is(".disabled, :disabled")){var f=c(e),g=f.hasClass("open");if(b(),!g){"ontouchstart"in document.documentElement&&!f.closest(".navbar-nav").length&&a('<div class="dropdown-backdrop"/>').insertAfter(a(this)).on("click",b);var h={relatedTarget:this};if(f.trigger(d=a.Event("show.bs.dropdown",h)),d.isDefaultPrevented())return;e.trigger("focus").attr("aria-expanded","true"),f.toggleClass("open").trigger("shown.bs.dropdown",h)}return!1}},g.prototype.keydown=function(b){if(/(38|40|27|32)/.test(b.which)&&!/input|textarea/i.test(b.target.tagName)){var d=a(this);if(b.preventDefault(),b.stopPropagation(),!d.is(".disabled, :disabled")){var e=c(d),g=e.hasClass("open");if(!g&&27!=b.which||g&&27==b.which)return 27==b.which&&e.find(f).trigger("focus"),d.trigger("click");var h=" li:not(.divider):visible a",i=e.find('[role="menu"]'+h+', [role="listbox"]'+h);if(i.length){var j=i.index(b.target);38==b.which&&j>0&&j--,40==b.which&&j<i.length-1&&j++,~j||(j=0),i.eq(j).trigger("focus")}}}};var h=a.fn.dropdown;a.fn.dropdown=d,a.fn.dropdown.Constructor=g,a.fn.dropdown.noConflict=function(){return a.fn.dropdown=h,this},a(document).on("click.bs.dropdown.data-api",b).on("click.bs.dropdown.data-api",".dropdown form",function(a){a.stopPropagation()}).on("click.bs.dropdown.data-api",f,g.prototype.toggle).on("keydown.bs.dropdown.data-api",f,g.prototype.keydown).on("keydown.bs.dropdown.data-api",'[role="menu"]',g.prototype.keydown).on("keydown.bs.dropdown.data-api",'[role="listbox"]',g.prototype.keydown)}(jQuery),+function(a){"use strict";function b(b,d){return this.each(function(){var e=a(this),f=e.data("bs.modal"),g=a.extend({},c.DEFAULTS,e.data(),"object"==typeof b&&b);f||e.data("bs.modal",f=new c(this,g)),"string"==typeof b?f[b](d):g.show&&f.show(d)})}var c=function(b,c){this.options=c,this.$body=a(document.body),this.$element=a(b),this.$backdrop=this.isShown=null,this.scrollbarWidth=0,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,a.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};c.VERSION="3.3.2",c.TRANSITION_DURATION=300,c.BACKDROP_TRANSITION_DURATION=150,c.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},c.prototype.toggle=function(a){return this.isShown?this.hide():this.show(a)},c.prototype.show=function(b){var d=this,e=a.Event("show.bs.modal",{relatedTarget:b});this.$element.trigger(e),this.isShown||e.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("modal-open"),this.escape(),this.resize(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',a.proxy(this.hide,this)),this.backdrop(function(){var e=a.support.transition&&d.$element.hasClass("fade");d.$element.parent().length||d.$element.appendTo(d.$body),d.$element.show().scrollTop(0),d.options.backdrop&&d.adjustBackdrop(),d.adjustDialog(),e&&d.$element[0].offsetWidth,d.$element.addClass("in").attr("aria-hidden",!1),d.enforceFocus();var f=a.Event("shown.bs.modal",{relatedTarget:b});e?d.$element.find(".modal-dialog").one("bsTransitionEnd",function(){d.$element.trigger("focus").trigger(f)}).emulateTransitionEnd(c.TRANSITION_DURATION):d.$element.trigger("focus").trigger(f)}))},c.prototype.hide=function(b){b&&b.preventDefault(),b=a.Event("hide.bs.modal"),this.$element.trigger(b),this.isShown&&!b.isDefaultPrevented()&&(this.isShown=!1,this.escape(),this.resize(),a(document).off("focusin.bs.modal"),this.$element.removeClass("in").attr("aria-hidden",!0).off("click.dismiss.bs.modal"),a.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",a.proxy(this.hideModal,this)).emulateTransitionEnd(c.TRANSITION_DURATION):this.hideModal())},c.prototype.enforceFocus=function(){a(document).off("focusin.bs.modal").on("focusin.bs.modal",a.proxy(function(a){this.$element[0]===a.target||this.$element.has(a.target).length||this.$element.trigger("focus")},this))},c.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",a.proxy(function(a){27==a.which&&this.hide()},this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")},c.prototype.resize=function(){this.isShown?a(window).on("resize.bs.modal",a.proxy(this.handleUpdate,this)):a(window).off("resize.bs.modal")},c.prototype.hideModal=function(){var a=this;this.$element.hide(),this.backdrop(function(){a.$body.removeClass("modal-open"),a.resetAdjustments(),a.resetScrollbar(),a.$element.trigger("hidden.bs.modal")})},c.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},c.prototype.backdrop=function(b){var d=this,e=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var f=a.support.transition&&e;if(this.$backdrop=a('<div class="modal-backdrop '+e+'" />').prependTo(this.$element).on("click.dismiss.bs.modal",a.proxy(function(a){a.target===a.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus.call(this.$element[0]):this.hide.call(this))},this)),f&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!b)return;f?this.$backdrop.one("bsTransitionEnd",b).emulateTransitionEnd(c.BACKDROP_TRANSITION_DURATION):b()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var g=function(){d.removeBackdrop(),b&&b()};a.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",g).emulateTransitionEnd(c.BACKDROP_TRANSITION_DURATION):g()}else b&&b()},c.prototype.handleUpdate=function(){this.options.backdrop&&this.adjustBackdrop(),this.adjustDialog()},c.prototype.adjustBackdrop=function(){this.$backdrop.css("height",0).css("height",this.$element[0].scrollHeight)},c.prototype.adjustDialog=function(){var a=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&a?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!a?this.scrollbarWidth:""})},c.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})},c.prototype.checkScrollbar=function(){this.bodyIsOverflowing=document.body.scrollHeight>document.documentElement.clientHeight,this.scrollbarWidth=this.measureScrollbar()},c.prototype.setScrollbar=function(){var a=parseInt(this.$body.css("padding-right")||0,10);this.bodyIsOverflowing&&this.$body.css("padding-right",a+this.scrollbarWidth)},c.prototype.resetScrollbar=function(){this.$body.css("padding-right","")},c.prototype.measureScrollbar=function(){var a=document.createElement("div");a.className="modal-scrollbar-measure",this.$body.append(a);var b=a.offsetWidth-a.clientWidth;return this.$body[0].removeChild(a),b};var d=a.fn.modal;a.fn.modal=b,a.fn.modal.Constructor=c,a.fn.modal.noConflict=function(){return a.fn.modal=d,this},a(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(c){var d=a(this),e=d.attr("href"),f=a(d.attr("data-target")||e&&e.replace(/.*(?=#[^\s]+$)/,"")),g=f.data("bs.modal")?"toggle":a.extend({remote:!/#/.test(e)&&e},f.data(),d.data());d.is("a")&&c.preventDefault(),f.one("show.bs.modal",function(a){a.isDefaultPrevented()||f.one("hidden.bs.modal",function(){d.is(":visible")&&d.trigger("focus")})}),b.call(f,g,this)})}(jQuery),+function(a){"use strict";function b(b){return this.each(function(){var d=a(this),e=d.data("bs.tooltip"),f="object"==typeof b&&b;(e||"destroy"!=b)&&(e||d.data("bs.tooltip",e=new c(this,f)),"string"==typeof b&&e[b]())})}var c=function(a,b){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",a,b)};c.VERSION="3.3.2",c.TRANSITION_DURATION=150,c.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},c.prototype.init=function(b,c,d){this.enabled=!0,this.type=b,this.$element=a(c),this.options=this.getOptions(d),this.$viewport=this.options.viewport&&a(this.options.viewport.selector||this.options.viewport);for(var e=this.options.trigger.split(" "),f=e.length;f--;){var g=e[f];if("click"==g)this.$element.on("click."+this.type,this.options.selector,a.proxy(this.toggle,this));else if("manual"!=g){var h="hover"==g?"mouseenter":"focusin",i="hover"==g?"mouseleave":"focusout";this.$element.on(h+"."+this.type,this.options.selector,a.proxy(this.enter,this)),this.$element.on(i+"."+this.type,this.options.selector,a.proxy(this.leave,this))}}this.options.selector?this._options=a.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},c.prototype.getDefaults=function(){return c.DEFAULTS},c.prototype.getOptions=function(b){return b=a.extend({},this.getDefaults(),this.$element.data(),b),b.delay&&"number"==typeof b.delay&&(b.delay={show:b.delay,hide:b.delay}),b},c.prototype.getDelegateOptions=function(){var b={},c=this.getDefaults();return this._options&&a.each(this._options,function(a,d){c[a]!=d&&(b[a]=d)}),b},c.prototype.enter=function(b){var c=b instanceof this.constructor?b:a(b.currentTarget).data("bs."+this.type);return c&&c.$tip&&c.$tip.is(":visible")?void(c.hoverState="in"):(c||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data("bs."+this.type,c)),clearTimeout(c.timeout),c.hoverState="in",c.options.delay&&c.options.delay.show?void(c.timeout=setTimeout(function(){"in"==c.hoverState&&c.show()},c.options.delay.show)):c.show())},c.prototype.leave=function(b){var c=b instanceof this.constructor?b:a(b.currentTarget).data("bs."+this.type);return c||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data("bs."+this.type,c)),clearTimeout(c.timeout),c.hoverState="out",c.options.delay&&c.options.delay.hide?void(c.timeout=setTimeout(function(){"out"==c.hoverState&&c.hide()},c.options.delay.hide)):c.hide()},c.prototype.show=function(){var b=a.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(b);var d=a.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(b.isDefaultPrevented()||!d)return;var e=this,f=this.tip(),g=this.getUID(this.type);this.setContent(),f.attr("id",g),this.$element.attr("aria-describedby",g),this.options.animation&&f.addClass("fade");var h="function"==typeof this.options.placement?this.options.placement.call(this,f[0],this.$element[0]):this.options.placement,i=/\s?auto?\s?/i,j=i.test(h);j&&(h=h.replace(i,"")||"top"),f.detach().css({top:0,left:0,display:"block"}).addClass(h).data("bs."+this.type,this),this.options.container?f.appendTo(this.options.container):f.insertAfter(this.$element);var k=this.getPosition(),l=f[0].offsetWidth,m=f[0].offsetHeight;if(j){var n=h,o=this.options.container?a(this.options.container):this.$element.parent(),p=this.getPosition(o);h="bottom"==h&&k.bottom+m>p.bottom?"top":"top"==h&&k.top-m<p.top?"bottom":"right"==h&&k.right+l>p.width?"left":"left"==h&&k.left-l<p.left?"right":h,f.removeClass(n).addClass(h)}var q=this.getCalculatedOffset(h,k,l,m);this.applyPlacement(q,h);var r=function(){var a=e.hoverState;e.$element.trigger("shown.bs."+e.type),e.hoverState=null,"out"==a&&e.leave(e)};a.support.transition&&this.$tip.hasClass("fade")?f.one("bsTransitionEnd",r).emulateTransitionEnd(c.TRANSITION_DURATION):r()}},c.prototype.applyPlacement=function(b,c){var d=this.tip(),e=d[0].offsetWidth,f=d[0].offsetHeight,g=parseInt(d.css("margin-top"),10),h=parseInt(d.css("margin-left"),10);isNaN(g)&&(g=0),isNaN(h)&&(h=0),b.top=b.top+g,b.left=b.left+h,a.offset.setOffset(d[0],a.extend({using:function(a){d.css({top:Math.round(a.top),left:Math.round(a.left)})}},b),0),d.addClass("in");var i=d[0].offsetWidth,j=d[0].offsetHeight;"top"==c&&j!=f&&(b.top=b.top+f-j);var k=this.getViewportAdjustedDelta(c,b,i,j);k.left?b.left+=k.left:b.top+=k.top;var l=/top|bottom/.test(c),m=l?2*k.left-e+i:2*k.top-f+j,n=l?"offsetWidth":"offsetHeight";d.offset(b),this.replaceArrow(m,d[0][n],l)},c.prototype.replaceArrow=function(a,b,c){this.arrow().css(c?"left":"top",50*(1-a/b)+"%").css(c?"top":"left","")},c.prototype.setContent=function(){var a=this.tip(),b=this.getTitle();a.find(".tooltip-inner")[this.options.html?"html":"text"](b),a.removeClass("fade in top bottom left right")},c.prototype.hide=function(b){function d(){"in"!=e.hoverState&&f.detach(),e.$element.removeAttr("aria-describedby").trigger("hidden.bs."+e.type),b&&b()}var e=this,f=this.tip(),g=a.Event("hide.bs."+this.type);return this.$element.trigger(g),g.isDefaultPrevented()?void 0:(f.removeClass("in"),a.support.transition&&this.$tip.hasClass("fade")?f.one("bsTransitionEnd",d).emulateTransitionEnd(c.TRANSITION_DURATION):d(),this.hoverState=null,this)},c.prototype.fixTitle=function(){var a=this.$element;(a.attr("title")||"string"!=typeof a.attr("data-original-title"))&&a.attr("data-original-title",a.attr("title")||"").attr("title","")},c.prototype.hasContent=function(){return this.getTitle()},c.prototype.getPosition=function(b){b=b||this.$element;var c=b[0],d="BODY"==c.tagName,e=c.getBoundingClientRect();null==e.width&&(e=a.extend({},e,{width:e.right-e.left,height:e.bottom-e.top}));var f=d?{top:0,left:0}:b.offset(),g={scroll:d?document.documentElement.scrollTop||document.body.scrollTop:b.scrollTop()},h=d?{width:a(window).width(),height:a(window).height()}:null;return a.extend({},e,g,h,f)},c.prototype.getCalculatedOffset=function(a,b,c,d){return"bottom"==a?{top:b.top+b.height,left:b.left+b.width/2-c/2}:"top"==a?{top:b.top-d,left:b.left+b.width/2-c/2}:"left"==a?{top:b.top+b.height/2-d/2,left:b.left-c}:{top:b.top+b.height/2-d/2,left:b.left+b.width}},c.prototype.getViewportAdjustedDelta=function(a,b,c,d){var e={top:0,left:0};if(!this.$viewport)return e;var f=this.options.viewport&&this.options.viewport.padding||0,g=this.getPosition(this.$viewport);if(/right|left/.test(a)){var h=b.top-f-g.scroll,i=b.top+f-g.scroll+d;h<g.top?e.top=g.top-h:i>g.top+g.height&&(e.top=g.top+g.height-i)}else{var j=b.left-f,k=b.left+f+c;j<g.left?e.left=g.left-j:k>g.width&&(e.left=g.left+g.width-k)}return e},c.prototype.getTitle=function(){var a,b=this.$element,c=this.options;return a=b.attr("data-original-title")||("function"==typeof c.title?c.title.call(b[0]):c.title)},c.prototype.getUID=function(a){do a+=~~(1e6*Math.random());while(document.getElementById(a));return a},c.prototype.tip=function(){return this.$tip=this.$tip||a(this.options.template)},c.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},c.prototype.enable=function(){this.enabled=!0},c.prototype.disable=function(){this.enabled=!1},c.prototype.toggleEnabled=function(){this.enabled=!this.enabled},c.prototype.toggle=function(b){var c=this;b&&(c=a(b.currentTarget).data("bs."+this.type),c||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data("bs."+this.type,c))),c.tip().hasClass("in")?c.leave(c):c.enter(c)},c.prototype.destroy=function(){var a=this;clearTimeout(this.timeout),this.hide(function(){a.$element.off("."+a.type).removeData("bs."+a.type)})};var d=a.fn.tooltip;a.fn.tooltip=b,a.fn.tooltip.Constructor=c,a.fn.tooltip.noConflict=function(){return a.fn.tooltip=d,this}}(jQuery),+function(a){"use strict";function b(b){return this.each(function(){var d=a(this),e=d.data("bs.popover"),f="object"==typeof b&&b;(e||"destroy"!=b)&&(e||d.data("bs.popover",e=new c(this,f)),"string"==typeof b&&e[b]())})}var c=function(a,b){this.init("popover",a,b)};if(!a.fn.tooltip)throw new Error("Popover requires tooltip.js");c.VERSION="3.3.2",c.DEFAULTS=a.extend({},a.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),c.prototype=a.extend({},a.fn.tooltip.Constructor.prototype),c.prototype.constructor=c,c.prototype.getDefaults=function(){return c.DEFAULTS},c.prototype.setContent=function(){var a=this.tip(),b=this.getTitle(),c=this.getContent();a.find(".popover-title")[this.options.html?"html":"text"](b),a.find(".popover-content").children().detach().end()[this.options.html?"string"==typeof c?"html":"append":"text"](c),a.removeClass("fade top bottom left right in"),a.find(".popover-title").html()||a.find(".popover-title").hide()},c.prototype.hasContent=function(){return this.getTitle()||this.getContent()},c.prototype.getContent=function(){var a=this.$element,b=this.options;return a.attr("data-content")||("function"==typeof b.content?b.content.call(a[0]):b.content)},c.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")},c.prototype.tip=function(){return this.$tip||(this.$tip=a(this.options.template)),this.$tip};var d=a.fn.popover;a.fn.popover=b,a.fn.popover.Constructor=c,a.fn.popover.noConflict=function(){return a.fn.popover=d,this}}(jQuery),+function(a){"use strict";function b(c,d){var e=a.proxy(this.process,this);this.$body=a("body"),this.$scrollElement=a(a(c).is("body")?window:c),this.options=a.extend({},b.DEFAULTS,d),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.bs.scrollspy",e),this.refresh(),this.process()}function c(c){return this.each(function(){var d=a(this),e=d.data("bs.scrollspy"),f="object"==typeof c&&c;e||d.data("bs.scrollspy",e=new b(this,f)),"string"==typeof c&&e[c]()})}b.VERSION="3.3.2",b.DEFAULTS={offset:10},b.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},b.prototype.refresh=function(){var b="offset",c=0;a.isWindow(this.$scrollElement[0])||(b="position",c=this.$scrollElement.scrollTop()),this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight();var d=this;this.$body.find(this.selector).map(function(){var d=a(this),e=d.data("target")||d.attr("href"),f=/^#./.test(e)&&a(e);return f&&f.length&&f.is(":visible")&&[[f[b]().top+c,e]]||null}).sort(function(a,b){return a[0]-b[0]}).each(function(){d.offsets.push(this[0]),d.targets.push(this[1])})},b.prototype.process=function(){var a,b=this.$scrollElement.scrollTop()+this.options.offset,c=this.getScrollHeight(),d=this.options.offset+c-this.$scrollElement.height(),e=this.offsets,f=this.targets,g=this.activeTarget;if(this.scrollHeight!=c&&this.refresh(),b>=d)return g!=(a=f[f.length-1])&&this.activate(a);if(g&&b<e[0])return this.activeTarget=null,this.clear();for(a=e.length;a--;)g!=f[a]&&b>=e[a]&&(!e[a+1]||b<=e[a+1])&&this.activate(f[a])},b.prototype.activate=function(b){this.activeTarget=b,this.clear();var c=this.selector+'[data-target="'+b+'"],'+this.selector+'[href="'+b+'"]',d=a(c).parents("li").addClass("active");d.parent(".dropdown-menu").length&&(d=d.closest("li.dropdown").addClass("active")),d.trigger("activate.bs.scrollspy")},b.prototype.clear=function(){a(this.selector).parentsUntil(this.options.target,".active").removeClass("active")};var d=a.fn.scrollspy;a.fn.scrollspy=c,a.fn.scrollspy.Constructor=b,a.fn.scrollspy.noConflict=function(){return a.fn.scrollspy=d,this},a(window).on("load.bs.scrollspy.data-api",function(){a('[data-spy="scroll"]').each(function(){var b=a(this);c.call(b,b.data())})})}(jQuery),+function(a){"use strict";function b(b){return this.each(function(){var d=a(this),e=d.data("bs.tab");e||d.data("bs.tab",e=new c(this)),"string"==typeof b&&e[b]()})}var c=function(b){this.element=a(b)};c.VERSION="3.3.2",c.TRANSITION_DURATION=150,c.prototype.show=function(){var b=this.element,c=b.closest("ul:not(.dropdown-menu)"),d=b.data("target");if(d||(d=b.attr("href"),d=d&&d.replace(/.*(?=#[^\s]*$)/,"")),!b.parent("li").hasClass("active")){var e=c.find(".active:last a"),f=a.Event("hide.bs.tab",{relatedTarget:b[0]}),g=a.Event("show.bs.tab",{relatedTarget:e[0]});if(e.trigger(f),b.trigger(g),!g.isDefaultPrevented()&&!f.isDefaultPrevented()){var h=a(d);this.activate(b.closest("li"),c),this.activate(h,h.parent(),function(){e.trigger({type:"hidden.bs.tab",relatedTarget:b[0]}),b.trigger({type:"shown.bs.tab",relatedTarget:e[0]})})}}},c.prototype.activate=function(b,d,e){function f(){g.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!1),b.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded",!0),h?(b[0].offsetWidth,b.addClass("in")):b.removeClass("fade"),b.parent(".dropdown-menu")&&b.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!0),e&&e()
}var g=d.find("> .active"),h=e&&a.support.transition&&(g.length&&g.hasClass("fade")||!!d.find("> .fade").length);g.length&&h?g.one("bsTransitionEnd",f).emulateTransitionEnd(c.TRANSITION_DURATION):f(),g.removeClass("in")};var d=a.fn.tab;a.fn.tab=b,a.fn.tab.Constructor=c,a.fn.tab.noConflict=function(){return a.fn.tab=d,this};var e=function(c){c.preventDefault(),b.call(a(this),"show")};a(document).on("click.bs.tab.data-api",'[data-toggle="tab"]',e).on("click.bs.tab.data-api",'[data-toggle="pill"]',e)}(jQuery),+function(a){"use strict";function b(b){return this.each(function(){var d=a(this),e=d.data("bs.affix"),f="object"==typeof b&&b;e||d.data("bs.affix",e=new c(this,f)),"string"==typeof b&&e[b]()})}var c=function(b,d){this.options=a.extend({},c.DEFAULTS,d),this.$target=a(this.options.target).on("scroll.bs.affix.data-api",a.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",a.proxy(this.checkPositionWithEventLoop,this)),this.$element=a(b),this.affixed=this.unpin=this.pinnedOffset=null,this.checkPosition()};c.VERSION="3.3.2",c.RESET="affix affix-top affix-bottom",c.DEFAULTS={offset:0,target:window},c.prototype.getState=function(a,b,c,d){var e=this.$target.scrollTop(),f=this.$element.offset(),g=this.$target.height();if(null!=c&&"top"==this.affixed)return c>e?"top":!1;if("bottom"==this.affixed)return null!=c?e+this.unpin<=f.top?!1:"bottom":a-d>=e+g?!1:"bottom";var h=null==this.affixed,i=h?e:f.top,j=h?g:b;return null!=c&&c>=e?"top":null!=d&&i+j>=a-d?"bottom":!1},c.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(c.RESET).addClass("affix");var a=this.$target.scrollTop(),b=this.$element.offset();return this.pinnedOffset=b.top-a},c.prototype.checkPositionWithEventLoop=function(){setTimeout(a.proxy(this.checkPosition,this),1)},c.prototype.checkPosition=function(){if(this.$element.is(":visible")){var b=this.$element.height(),d=this.options.offset,e=d.top,f=d.bottom,g=a("body").height();"object"!=typeof d&&(f=e=d),"function"==typeof e&&(e=d.top(this.$element)),"function"==typeof f&&(f=d.bottom(this.$element));var h=this.getState(g,b,e,f);if(this.affixed!=h){null!=this.unpin&&this.$element.css("top","");var i="affix"+(h?"-"+h:""),j=a.Event(i+".bs.affix");if(this.$element.trigger(j),j.isDefaultPrevented())return;this.affixed=h,this.unpin="bottom"==h?this.getPinnedOffset():null,this.$element.removeClass(c.RESET).addClass(i).trigger(i.replace("affix","affixed")+".bs.affix")}"bottom"==h&&this.$element.offset({top:g-b-f})}};var d=a.fn.affix;a.fn.affix=b,a.fn.affix.Constructor=c,a.fn.affix.noConflict=function(){return a.fn.affix=d,this},a(window).on("load",function(){a('[data-spy="affix"]').each(function(){var c=a(this),d=c.data();d.offset=d.offset||{},null!=d.offsetBottom&&(d.offset.bottom=d.offsetBottom),null!=d.offsetTop&&(d.offset.top=d.offsetTop),b.call(c,d)})})}(jQuery);;
/**
 * Project: Bootstrap Hover Dropdown
 * Author: Cameron Spear
 * Contributors: Mattia Larentis
 *
 * Dependencies: Bootstrap's Dropdown plugin, jQuery
 *
 * A simple plugin to enable Bootstrap dropdowns to active on hover and provide a nice user experience.
 *
 * License: MIT
 *
 * http://cameronspear.com/blog/bootstrap-dropdown-on-hover-plugin/
 */(function(b,a,c){var d=b();b.fn.dropdownHover=function(e){if("ontouchstart" in document){return this}d=d.add(this.parent());return this.each(function(){var m=b(this),l=m.parent(),k={delay:500,instantlyCloseOthers:true},i={delay:b(this).data("delay"),instantlyCloseOthers:b(this).data("close-others")},f="show.bs.dropdown",j="hide.bs.dropdown",g=b.extend(true,{},k,e,i),h;l.hover(function(n){if(!l.hasClass("open")&&!m.is(n.target)){return true}d.find(":focus").blur();if(g.instantlyCloseOthers===true){d.removeClass("open")}a.clearTimeout(h);l.addClass("open");m.trigger(f)},function(){h=a.setTimeout(function(){l.removeClass("open");m.trigger(j)},g.delay)});m.hover(function(){d.find(":focus").blur();if(g.instantlyCloseOthers===true){d.removeClass("open")}a.clearTimeout(h);l.addClass("open");m.trigger(f)});l.find(".dropdown-submenu").each(function(){var o=b(this);var n;o.hover(function(){a.clearTimeout(n);o.children(".dropdown-menu").show();o.siblings().children(".dropdown-menu").hide()},function(){var p=o.children(".dropdown-menu");n=a.setTimeout(function(){p.hide()},g.delay)})})})};b(document).ready(function(){b('[data-hover="dropdown"]').dropdownHover()})})(jQuery,this);;
/*! Copyright (c) 2011 Piotr Rochala (http://rocha.la)
 * Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
 * and GPL (http://www.opensource.org/licenses/gpl-license.php) licenses.
 *
 * Improved by keenthemes for Metronic Theme
 * Version: 1.3.2
 *
 */
!function(e){jQuery.fn.extend({slimScroll:function(i){var o={width:"auto",height:"250px",size:"7px",color:"#000",position:"right",distance:"1px",start:"top",opacity:.4,alwaysVisible:!1,disableFadeOut:!1,railVisible:!1,railColor:"#333",railOpacity:.2,railDraggable:!0,railClass:"slimScrollRail",barClass:"slimScrollBar",wrapperClass:"slimScrollDiv",allowPageScroll:!1,wheelStep:20,touchScrollStep:200,borderRadius:"7px",railBorderRadius:"7px",animate:!0},a=e.extend(o,i);return this.each(function(){function o(t){if(u){var t=t||window.event,i=0;t.wheelDelta&&(i=-t.wheelDelta/120),t.detail&&(i=t.detail/3);var o=t.target||t.srcTarget||t.srcElement;e(o).closest("."+a.wrapperClass).is(S.parent())&&r(i,!0),t.preventDefault&&!y&&t.preventDefault(),y||(t.returnValue=!1)}}function r(e,t,i){y=!1;var o=e,r=S.outerHeight()-M.outerHeight();if(t&&(o=parseInt(M.css("top"))+e*parseInt(a.wheelStep)/100*M.outerHeight(),o=Math.min(Math.max(o,0),r),o=e>0?Math.ceil(o):Math.floor(o),M.css({top:o+"px"})),v=parseInt(M.css("top"))/(S.outerHeight()-M.outerHeight()),o=v*(S[0].scrollHeight-S.outerHeight()),i){o=e;var s=o/S[0].scrollHeight*S.outerHeight();s=Math.min(Math.max(s,0),r),M.css({top:s+"px"})}"scrollTo"in a&&a.animate?S.animate({scrollTop:o}):S.scrollTop(o),S.trigger("slimscrolling",~~o),l(),c()}function s(){window.addEventListener?(this.addEventListener("DOMMouseScroll",o,!1),this.addEventListener("mousewheel",o,!1)):document.attachEvent("onmousewheel",o)}function n(){f=Math.max(S.outerHeight()/S[0].scrollHeight*S.outerHeight(),m),M.css({height:f+"px"});var e=f==S.outerHeight()?"none":"block";M.css({display:e})}function l(){if(n(),clearTimeout(p),v==~~v){if(y=a.allowPageScroll,b!=v){var e=0==~~v?"top":"bottom";S.trigger("slimscroll",e)}}else y=!1;return b=v,f>=S.outerHeight()?void(y=!0):(M.stop(!0,!0).fadeIn("fast"),void(a.railVisible&&H.stop(!0,!0).fadeIn("fast")))}function c(){a.alwaysVisible||(p=setTimeout(function(){a.disableFadeOut&&u||h||d||(M.fadeOut("slow"),H.fadeOut("slow"))},1e3))}var u,h,d,p,g,f,v,b,w="<div></div>",m=30,y=!1,S=e(this);if("ontouchstart"in window&&window.navigator.msPointerEnabled&&S.css("-ms-touch-action","none"),S.parent().hasClass(a.wrapperClass)){var E=S.scrollTop();if(M=S.parent().find("."+a.barClass),H=S.parent().find("."+a.railClass),n(),e.isPlainObject(i)){if("height"in i&&"auto"==i.height){S.parent().css("height","auto"),S.css("height","auto");var x=S.parent().parent().height();S.parent().css("height",x),S.css("height",x)}if("scrollTo"in i)E=parseInt(a.scrollTo);else if("scrollBy"in i)E+=parseInt(a.scrollBy);else if("destroy"in i)return M.remove(),H.remove(),void S.unwrap();r(E,!1,!0)}}else{a.height="auto"==i.height?S.parent().height():i.height;var C=e(w).addClass(a.wrapperClass).css({position:"relative",overflow:"hidden",width:a.width,height:a.height});S.css({overflow:"hidden",width:a.width,height:a.height});var H=e(w).addClass(a.railClass).css({width:a.size,height:"100%",position:"absolute",top:0,display:a.alwaysVisible&&a.railVisible?"block":"none","border-radius":a.railBorderRadius,background:a.railColor,opacity:a.railOpacity,zIndex:90}),M=e(w).addClass(a.barClass).css({background:a.color,width:a.size,position:"absolute",top:0,opacity:a.opacity,display:a.alwaysVisible?"block":"none","border-radius":a.borderRadius,BorderRadius:a.borderRadius,MozBorderRadius:a.borderRadius,WebkitBorderRadius:a.borderRadius,zIndex:99}),D="right"==a.position?{right:a.distance}:{left:a.distance};H.css(D),M.css(D),S.wrap(C),S.parent().append(M),S.parent().append(H),a.railDraggable&&M.bind("mousedown",function(i){var o=e(document);return d=!0,t=parseFloat(M.css("top")),pageY=i.pageY,o.bind("mousemove.slimscroll",function(e){currTop=t+e.pageY-pageY,M.css("top",currTop),r(0,M.position().top,!1)}),o.bind("mouseup.slimscroll",function(){d=!1,c(),o.unbind(".slimscroll")}),!1}).bind("selectstart.slimscroll",function(e){return e.stopPropagation(),e.preventDefault(),!1}),"ontouchstart"in window&&window.navigator.msPointerEnabled&&(S.bind("MSPointerDown",function(e){g=e.originalEvent.pageY}),S.bind("MSPointerMove",function(e){e.originalEvent.preventDefault();var t=(g-e.originalEvent.pageY)/a.touchScrollStep;r(t,!0),g=e.originalEvent.pageY})),H.hover(function(){l()},function(){c()}),M.hover(function(){h=!0},function(){h=!1}),S.hover(function(){u=!0,l(),c()},function(){u=!1,c()}),S.bind("touchstart",function(e){e.originalEvent.touches.length&&(g=e.originalEvent.touches[0].pageY)}),S.bind("touchmove",function(e){if(y||e.originalEvent.preventDefault(),e.originalEvent.touches.length){var t=(g-e.originalEvent.touches[0].pageY)/a.touchScrollStep;r(t,!0),g=e.originalEvent.touches[0].pageY}}),n(),"bottom"===a.start?(M.css({top:S.outerHeight()-M.outerHeight()}),r(0,!0)):"top"!==a.start&&(r(e(a.start).position().top,null,!0),a.alwaysVisible||M.hide()),s()}}),this}}),jQuery.fn.extend({slimscroll:jQuery.fn.slimScroll})}(jQuery);;
/*!
 * jQuery blockUI plugin
 * Version 2.66.0-2013.10.09
 * Requires jQuery v1.7 or later
 *
 * Examples at: http://malsup.com/jquery/block/
 * Copyright (c) 2007-2013 M. Alsup
 * Dual licensed under the MIT and GPL licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl.html
 *
 * Thanks to Amir-Hossein Sobhi for some excellent contributions!
 */

!function(){"use strict";function e(e){function t(t,n){var s,h,k=t==window,y=n&&void 0!==n.message?n.message:void 0;if(n=e.extend({},e.blockUI.defaults,n||{}),!n.ignoreIfBlocked||!e(t).data("blockUI.isBlocked")){if(n.overlayCSS=e.extend({},e.blockUI.defaults.overlayCSS,n.overlayCSS||{}),s=e.extend({},e.blockUI.defaults.css,n.css||{}),n.onOverlayClick&&(n.overlayCSS.cursor="pointer"),h=e.extend({},e.blockUI.defaults.themedCSS,n.themedCSS||{}),y=void 0===y?n.message:y,k&&p&&o(window,{fadeOut:0}),y&&"string"!=typeof y&&(y.parentNode||y.jquery)){var m=y.jquery?y[0]:y,v={};e(t).data("blockUI.history",v),v.el=m,v.parent=m.parentNode,v.display=m.style.display,v.position=m.style.position,v.parent&&v.parent.removeChild(m)}e(t).data("blockUI.onUnblock",n.onUnblock);var g,I,w,U,x=n.baseZ;g=r||n.forceIframe?e('<iframe class="blockUI" style="z-index:'+x++ +';display:none;border:none;margin:0;padding:0;position:absolute;width:100%;height:100%;top:0;left:0" src="'+n.iframeSrc+'"></iframe>'):e('<div class="blockUI" style="display:none"></div>'),I=n.theme?e('<div class="blockUI blockOverlay ui-widget-overlay" style="z-index:'+x++ +';display:none"></div>'):e('<div class="blockUI blockOverlay" style="z-index:'+x++ +';display:none;border:none;margin:0;padding:0;width:100%;height:100%;top:0;left:0"></div>'),n.theme&&k?(U='<div class="blockUI '+n.blockMsgClass+' blockPage ui-dialog ui-widget ui-corner-all" style="z-index:'+(x+10)+';display:none;position:fixed">',n.title&&(U+='<div class="ui-widget-header ui-dialog-titlebar ui-corner-all blockTitle">'+(n.title||"&nbsp;")+"</div>"),U+='<div class="ui-widget-content ui-dialog-content"></div>',U+="</div>"):n.theme?(U='<div class="blockUI '+n.blockMsgClass+' blockElement ui-dialog ui-widget ui-corner-all" style="z-index:'+(x+10)+';display:none;position:absolute">',n.title&&(U+='<div class="ui-widget-header ui-dialog-titlebar ui-corner-all blockTitle">'+(n.title||"&nbsp;")+"</div>"),U+='<div class="ui-widget-content ui-dialog-content"></div>',U+="</div>"):U=k?'<div class="blockUI '+n.blockMsgClass+' blockPage" style="z-index:'+(x+10)+';display:none;position:fixed"></div>':'<div class="blockUI '+n.blockMsgClass+' blockElement" style="z-index:'+(x+10)+';display:none;position:absolute"></div>',w=e(U),y&&(n.theme?(w.css(h),w.addClass("ui-widget-content")):w.css(s)),n.theme||I.css(n.overlayCSS),I.css("position",k?"fixed":"absolute"),(r||n.forceIframe)&&g.css("opacity",0);var C=[g,I,w],S=k?e("body"):e(t);e.each(C,function(){this.appendTo(S)}),n.theme&&n.draggable&&e.fn.draggable&&w.draggable({handle:".ui-dialog-titlebar",cancel:"li"});var O=f&&(!e.support.boxModel||e("object,embed",k?null:t).length>0);if(u||O){if(k&&n.allowBodyStretch&&e.support.boxModel&&e("html,body").css("height","100%"),(u||!e.support.boxModel)&&!k)var E=d(t,"borderTopWidth"),T=d(t,"borderLeftWidth"),M=E?"(0 - "+E+")":0,B=T?"(0 - "+T+")":0;e.each(C,function(e,t){var o=t[0].style;if(o.position="absolute",2>e)k?o.setExpression("height","Math.max(document.body.scrollHeight, document.body.offsetHeight) - (jQuery.support.boxModel?0:"+n.quirksmodeOffsetHack+') + "px"'):o.setExpression("height",'this.parentNode.offsetHeight + "px"'),k?o.setExpression("width",'jQuery.support.boxModel && document.documentElement.clientWidth || document.body.clientWidth + "px"'):o.setExpression("width",'this.parentNode.offsetWidth + "px"'),B&&o.setExpression("left",B),M&&o.setExpression("top",M);else if(n.centerY)k&&o.setExpression("top",'(document.documentElement.clientHeight || document.body.clientHeight) / 2 - (this.offsetHeight / 2) + (blah = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "px"'),o.marginTop=0;else if(!n.centerY&&k){var i=n.css&&n.css.top?parseInt(n.css.top,10):0,s="((document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "+i+') + "px"';o.setExpression("top",s)}})}if(y&&(n.theme?w.find(".ui-widget-content").append(y):w.append(y),(y.jquery||y.nodeType)&&e(y).show()),(r||n.forceIframe)&&n.showOverlay&&g.show(),n.fadeIn){var j=n.onBlock?n.onBlock:c,H=n.showOverlay&&!y?j:c,z=y?j:c;n.showOverlay&&I._fadeIn(n.fadeIn,H),y&&w._fadeIn(n.fadeIn,z)}else n.showOverlay&&I.show(),y&&w.show(),n.onBlock&&n.onBlock();if(i(1,t,n),k?(p=w[0],b=e(n.focusableElements,p),n.focusInput&&setTimeout(l,20)):a(w[0],n.centerX,n.centerY),n.timeout){var W=setTimeout(function(){k?e.unblockUI(n):e(t).unblock(n)},n.timeout);e(t).data("blockUI.timeout",W)}}}function o(t,o){var s,l=t==window,a=e(t),d=a.data("blockUI.history"),c=a.data("blockUI.timeout");c&&(clearTimeout(c),a.removeData("blockUI.timeout")),o=e.extend({},e.blockUI.defaults,o||{}),i(0,t,o),null===o.onUnblock&&(o.onUnblock=a.data("blockUI.onUnblock"),a.removeData("blockUI.onUnblock"));var r;r=l?e("body").children().filter(".blockUI").add("body > .blockUI"):a.find(">.blockUI"),o.cursorReset&&(r.length>1&&(r[1].style.cursor=o.cursorReset),r.length>2&&(r[2].style.cursor=o.cursorReset)),l&&(p=b=null),o.fadeOut?(s=r.length,r.stop().fadeOut(o.fadeOut,function(){0===--s&&n(r,d,o,t)})):n(r,d,o,t)}function n(t,o,n,i){var s=e(i);if(!s.data("blockUI.isBlocked")){t.each(function(){this.parentNode&&this.parentNode.removeChild(this)}),o&&o.el&&(o.el.style.display=o.display,o.el.style.position=o.position,o.parent&&o.parent.appendChild(o.el),s.removeData("blockUI.history")),s.data("blockUI.static")&&s.css("position","static"),"function"==typeof n.onUnblock&&n.onUnblock(i,n);var l=e(document.body),a=l.width(),d=l[0].style.width;l.width(a-1).width(a),l[0].style.width=d}}function i(t,o,n){var i=o==window,l=e(o);if((t||(!i||p)&&(i||l.data("blockUI.isBlocked")))&&(l.data("blockUI.isBlocked",t),i&&n.bindEvents&&(!t||n.showOverlay))){var a="mousedown mouseup keydown keypress keyup touchstart touchend touchmove";t?e(document).bind(a,n,s):e(document).unbind(a,s)}}function s(t){if("keydown"===t.type&&t.keyCode&&9==t.keyCode&&p&&t.data.constrainTabKey){var o=b,n=!t.shiftKey&&t.target===o[o.length-1],i=t.shiftKey&&t.target===o[0];if(n||i)return setTimeout(function(){l(i)},10),!1}var s=t.data,a=e(t.target);return a.hasClass("blockOverlay")&&s.onOverlayClick&&s.onOverlayClick(t),a.parents("div."+s.blockMsgClass).length>0?!0:0===a.parents().children().filter("div.blockUI").length}function l(e){if(b){var t=b[e===!0?b.length-1:0];t&&t.focus()}}function a(e,t,o){var n=e.parentNode,i=e.style,s=(n.offsetWidth-e.offsetWidth)/2-d(n,"borderLeftWidth"),l=(n.offsetHeight-e.offsetHeight)/2-d(n,"borderTopWidth");t&&(i.left=s>0?s+"px":"0"),o&&(i.top=l>0?l+"px":"0")}function d(t,o){return parseInt(e.css(t,o),10)||0}e.fn._fadeIn=e.fn.fadeIn;var c=e.noop||function(){},r=/MSIE/.test(navigator.userAgent),u=/MSIE 6.0/.test(navigator.userAgent)&&!/MSIE 8.0/.test(navigator.userAgent),f=(document.documentMode||0,e.isFunction(document.createElement("div").style.setExpression));e.blockUI=function(e){t(window,e)},e.unblockUI=function(e){o(window,e)},e.growlUI=function(t,o,n,i){var s=e('<div class="growlUI"></div>');t&&s.append("<h1>"+t+"</h1>"),o&&s.append("<h2>"+o+"</h2>"),void 0===n&&(n=3e3);var l=function(t){t=t||{},e.blockUI({message:s,fadeIn:"undefined"!=typeof t.fadeIn?t.fadeIn:700,fadeOut:"undefined"!=typeof t.fadeOut?t.fadeOut:1e3,timeout:"undefined"!=typeof t.timeout?t.timeout:n,centerY:!1,showOverlay:!1,onUnblock:i,css:e.blockUI.defaults.growlCSS})};l();s.css("opacity");s.mouseover(function(){l({fadeIn:0,timeout:3e4});var t=e(".blockMsg");t.stop(),t.fadeTo(300,1)}).mouseout(function(){e(".blockMsg").fadeOut(1e3)})},e.fn.block=function(o){if(this[0]===window)return e.blockUI(o),this;var n=e.extend({},e.blockUI.defaults,o||{});return this.each(function(){var t=e(this);n.ignoreIfBlocked&&t.data("blockUI.isBlocked")||t.unblock({fadeOut:0})}),this.each(function(){"static"==e.css(this,"position")&&(this.style.position="relative",e(this).data("blockUI.static",!0)),this.style.zoom=1,t(this,o)})},e.fn.unblock=function(t){return this[0]===window?(e.unblockUI(t),this):this.each(function(){o(this,t)})},e.blockUI.version=2.66,e.blockUI.defaults={message:"<h1>Please wait...</h1>",title:null,draggable:!0,theme:!1,css:{padding:0,margin:0,width:"30%",top:"40%",left:"35%",textAlign:"center",color:"#000",border:"3px solid #aaa",backgroundColor:"#fff",cursor:"wait"},themedCSS:{width:"30%",top:"40%",left:"35%"},overlayCSS:{backgroundColor:"#000",opacity:.6,cursor:"wait"},cursorReset:"default",growlCSS:{width:"350px",top:"10px",left:"",right:"10px",border:"none",padding:"5px",opacity:.6,cursor:"default",color:"#fff",backgroundColor:"#000","-webkit-border-radius":"10px","-moz-border-radius":"10px","border-radius":"10px"},iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank",forceIframe:!1,baseZ:1e3,centerX:!0,centerY:!0,allowBodyStretch:!0,bindEvents:!0,constrainTabKey:!0,fadeIn:200,fadeOut:400,timeout:0,showOverlay:!0,focusInput:!0,focusableElements:":input:enabled:visible",onBlock:null,onUnblock:null,onOverlayClick:null,quirksmodeOffsetHack:4,blockMsgClass:"blockMsg",ignoreIfBlocked:!1};var p=null,b=[]}"function"==typeof define&&define.amd&&define.amd.jQuery?define(["jquery"],e):e(jQuery)}();;
/*!
 * jQuery Cookie Plugin v1.3.1
 * https://github.com/carhartl/jquery-cookie
 * Plugin file name changed to jquery.cokie.min to prevent blocking by ModSecurity module
 *
 * Copyright 2013 Klaus Hartl
 * Released under the MIT license
 */
(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{a(jQuery)}}(function(e){var a=/\+/g;function d(g){return g}function b(g){return decodeURIComponent(g.replace(a," "))}function f(g){if(g.indexOf('"')===0){g=g.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\")}try{return c.json?JSON.parse(g):g}catch(h){}}var c=e.cookie=function(p,o,u){if(o!==undefined){u=e.extend({},c.defaults,u);if(typeof u.expires==="number"){var q=u.expires,s=u.expires=new Date();s.setDate(s.getDate()+q)}o=c.json?JSON.stringify(o):String(o);return(document.cookie=[c.raw?p:encodeURIComponent(p),"=",c.raw?o:encodeURIComponent(o),u.expires?"; expires="+u.expires.toUTCString():"",u.path?"; path="+u.path:"",u.domain?"; domain="+u.domain:"",u.secure?"; secure":""].join(""))}var g=c.raw?d:b;var r=document.cookie.split("; ");var v=p?undefined:{};for(var n=0,k=r.length;n<k;n++){var m=r[n].split("=");var h=g(m.shift());var j=g(m.join("="));if(p&&p===h){v=f(j);break}if(!p){v[h]=f(j)}}return v};c.defaults={};e.removeCookie=function(h,g){if(e.cookie(h)!==undefined){e.cookie(h,"",e.extend({},g,{expires:-1}));return true}return false}}));;
(function(e,t){"use strict";function n(e){var t=Array.prototype.slice.call(arguments,1);return e.prop?e.prop.apply(e,t):e.attr.apply(e,t)}function s(e,t,n){var s,a;for(s in n)n.hasOwnProperty(s)&&(a=s.replace(/ |$/g,t.eventNamespace),e.bind(a,n[s]))}function a(e,t,n){s(e,n,{focus:function(){t.addClass(n.focusClass)},blur:function(){t.removeClass(n.focusClass),t.removeClass(n.activeClass)},mouseenter:function(){t.addClass(n.hoverClass)},mouseleave:function(){t.removeClass(n.hoverClass),t.removeClass(n.activeClass)},"mousedown touchbegin":function(){e.is(":disabled")||t.addClass(n.activeClass)},"mouseup touchend":function(){t.removeClass(n.activeClass)}})}function i(e,t){e.removeClass(t.hoverClass+" "+t.focusClass+" "+t.activeClass)}function r(e,t,n){n?e.addClass(t):e.removeClass(t)}function l(e,t,n){var s="checked",a=t.is(":"+s);t.prop?t.prop(s,a):a?t.attr(s,s):t.removeAttr(s),r(e,n.checkedClass,a)}function u(e,t,n){r(e,n.disabledClass,t.is(":disabled"))}function o(e,t,n){switch(n){case"after":return e.after(t),e.next();case"before":return e.before(t),e.prev();case"wrap":return e.wrap(t),e.parent()}return null}function c(t,s,a){var i,r,l;return a||(a={}),a=e.extend({bind:{},divClass:null,divWrap:"wrap",spanClass:null,spanHtml:null,spanWrap:"wrap"},a),i=e("<div />"),r=e("<span />"),s.autoHide&&t.is(":hidden")&&"none"===t.css("display")&&i.hide(),a.divClass&&i.addClass(a.divClass),s.wrapperClass&&i.addClass(s.wrapperClass),a.spanClass&&r.addClass(a.spanClass),l=n(t,"id"),s.useID&&l&&n(i,"id",s.idPrefix+"-"+l),a.spanHtml&&r.html(a.spanHtml),i=o(t,i,a.divWrap),r=o(t,r,a.spanWrap),u(i,t,s),{div:i,span:r}}function d(t,n){var s;return n.wrapperClass?(s=e("<span />").addClass(n.wrapperClass),s=o(t,s,"wrap")):null}function f(){var t,n,s,a;return a="rgb(120,2,153)",n=e('<div style="width:0;height:0;color:'+a+'">'),e("body").append(n),s=n.get(0),t=window.getComputedStyle?window.getComputedStyle(s,"").color:(s.currentStyle||s.style||{}).color,n.remove(),t.replace(/ /g,"")!==a}function p(t){return t?e("<span />").text(t).html():""}function m(){return navigator.cpuClass&&!navigator.product}function v(){return window.XMLHttpRequest!==void 0?!0:!1}function h(e){var t;return e[0].multiple?!0:(t=n(e,"size"),!t||1>=t?!1:!0)}function C(){return!1}function w(e,t){var n="none";s(e,t,{"selectstart dragstart mousedown":C}),e.css({MozUserSelect:n,msUserSelect:n,webkitUserSelect:n,userSelect:n})}function b(e,t,n){var s=e.val();""===s?s=n.fileDefaultHtml:(s=s.split(/[\/\\]+/),s=s[s.length-1]),t.text(s)}function y(e,t,n){var s,a;for(s=[],e.each(function(){var e;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&(s.push({el:this,name:e,old:this.style[e]}),this.style[e]=t[e])}),n();s.length;)a=s.pop(),a.el.style[a.name]=a.old}function g(e,t){var n;n=e.parents(),n.push(e[0]),n=n.not(":visible"),y(n,{visibility:"hidden",display:"block",position:"absolute"},t)}function k(e,t){return function(){e.unwrap().unwrap().unbind(t.eventNamespace)}}var H=!0,x=!1,A=[{match:function(e){return e.is("a, button, :submit, :reset, input[type='button']")},apply:function(e,t){var r,l,o,d,f;return l=t.submitDefaultHtml,e.is(":reset")&&(l=t.resetDefaultHtml),d=e.is("a, button")?function(){return e.html()||l}:function(){return p(n(e,"value"))||l},o=c(e,t,{divClass:t.buttonClass,spanHtml:d()}),r=o.div,a(e,r,t),f=!1,s(r,t,{"click touchend":function(){var t,s,a,i;f||e.is(":disabled")||(f=!0,e[0].dispatchEvent?(t=document.createEvent("MouseEvents"),t.initEvent("click",!0,!0),s=e[0].dispatchEvent(t),e.is("a")&&s&&(a=n(e,"target"),i=n(e,"href"),a&&"_self"!==a?window.open(i,a):document.location.href=i)):e.click(),f=!1)}}),w(r,t),{remove:function(){return r.after(e),r.remove(),e.unbind(t.eventNamespace),e},update:function(){i(r,t),u(r,e,t),e.detach(),o.span.html(d()).append(e)}}}},{match:function(e){return e.is(":checkbox")},apply:function(e,t){var n,r,o;return n=c(e,t,{divClass:t.checkboxClass}),r=n.div,o=n.span,a(e,r,t),s(e,t,{"click touchend":function(){l(o,e,t)}}),l(o,e,t),{remove:k(e,t),update:function(){i(r,t),o.removeClass(t.checkedClass),l(o,e,t),u(r,e,t)}}}},{match:function(e){return e.is(":file")},apply:function(t,r){function l(){b(t,p,r)}var d,f,p,v;return d=c(t,r,{divClass:r.fileClass,spanClass:r.fileButtonClass,spanHtml:r.fileButtonHtml,spanWrap:"after"}),f=d.div,v=d.span,p=e("<span />").html(r.fileDefaultHtml),p.addClass(r.filenameClass),p=o(t,p,"after"),n(t,"size")||n(t,"size",f.width()/10),a(t,f,r),l(),m()?s(t,r,{click:function(){t.trigger("change"),setTimeout(l,0)}}):s(t,r,{change:l}),w(p,r),w(v,r),{remove:function(){return p.remove(),v.remove(),t.unwrap().unbind(r.eventNamespace)},update:function(){i(f,r),b(t,p,r),u(f,t,r)}}}},{match:function(e){if(e.is("input")){var t=(" "+n(e,"type")+" ").toLowerCase(),s=" color date datetime datetime-local email month number password search tel text time url week ";return s.indexOf(t)>=0}return!1},apply:function(e,t){var s,i;return s=n(e,"type"),e.addClass(t.inputClass),i=d(e,t),a(e,e,t),t.inputAddTypeAsClass&&e.addClass(s),{remove:function(){e.removeClass(t.inputClass),t.inputAddTypeAsClass&&e.removeClass(s),i&&e.unwrap()},update:C}}},{match:function(e){return e.is(":radio")},apply:function(t,r){var o,d,f;return o=c(t,r,{divClass:r.radioClass}),d=o.div,f=o.span,a(t,d,r),s(t,r,{"click touchend":function(){e.uniform.update(e(':radio[name="'+n(t,"name")+'"]'))}}),l(f,t,r),{remove:k(t,r),update:function(){i(d,r),l(f,t,r),u(d,t,r)}}}},{match:function(e){return e.is("select")&&!h(e)?!0:!1},apply:function(t,n){var r,l,o,d;return n.selectAutoWidth&&g(t,function(){d=t.width()}),r=c(t,n,{divClass:n.selectClass,spanHtml:(t.find(":selected:first")||t.find("option:first")).html(),spanWrap:"before"}),l=r.div,o=r.span,n.selectAutoWidth?g(t,function(){y(e([o[0],l[0]]),{display:"block"},function(){var e;e=o.outerWidth()-o.width(),l.width(d+e),o.width(d)})}):l.addClass("fixedWidth"),a(t,l,n),s(t,n,{change:function(){o.html(t.find(":selected").html()),l.removeClass(n.activeClass)},"click touchend":function(){var e=t.find(":selected").html();o.html()!==e&&t.trigger("change")},keyup:function(){o.html(t.find(":selected").html())}}),w(o,n),{remove:function(){return o.remove(),t.unwrap().unbind(n.eventNamespace),t},update:function(){n.selectAutoWidth?(e.uniform.restore(t),t.uniform(n)):(i(l,n),o.html(t.find(":selected").html()),u(l,t,n))}}}},{match:function(e){return e.is("select")&&h(e)?!0:!1},apply:function(e,t){var n;return e.addClass(t.selectMultiClass),n=d(e,t),a(e,e,t),{remove:function(){e.removeClass(t.selectMultiClass),n&&e.unwrap()},update:C}}},{match:function(e){return e.is("textarea")},apply:function(e,t){var n;return e.addClass(t.textareaClass),n=d(e,t),a(e,e,t),{remove:function(){e.removeClass(t.textareaClass),n&&e.unwrap()},update:C}}}];m()&&!v()&&(H=!1),e.uniform={defaults:{activeClass:"active",autoHide:!0,buttonClass:"button",checkboxClass:"checker",checkedClass:"checked",disabledClass:"disabled",eventNamespace:".uniform",fileButtonClass:"action",fileButtonHtml:"Choose File",fileClass:"uploader",fileDefaultHtml:"No file selected",filenameClass:"filename",focusClass:"focus",hoverClass:"hover",idPrefix:"uniform",inputAddTypeAsClass:!0,inputClass:"uniform-input",radioClass:"radio",resetDefaultHtml:"Reset",resetSelector:!1,selectAutoWidth:!0,selectClass:"selector",selectMultiClass:"uniform-multiselect",submitDefaultHtml:"Submit",textareaClass:"uniform",useID:!0,wrapperClass:null},elements:[]},e.fn.uniform=function(t){var n=this;return t=e.extend({},e.uniform.defaults,t),x||(x=!0,f()&&(H=!1)),H?(t.resetSelector&&e(t.resetSelector).mouseup(function(){window.setTimeout(function(){e.uniform.update(n)},10)}),this.each(function(){var n,s,a,i=e(this);if(i.data("uniformed"))return e.uniform.update(i),void 0;for(n=0;A.length>n;n+=1)if(s=A[n],s.match(i,t))return a=s.apply(i,t),i.data("uniformed",a),e.uniform.elements.push(i.get(0)),void 0})):this},e.uniform.restore=e.fn.uniform.restore=function(n){n===t&&(n=e.uniform.elements),e(n).each(function(){var t,n,s=e(this);n=s.data("uniformed"),n&&(n.remove(),t=e.inArray(this,e.uniform.elements),t>=0&&e.uniform.elements.splice(t,1),s.removeData("uniformed"))})},e.uniform.update=e.fn.uniform.update=function(n){n===t&&(n=e.uniform.elements),e(n).each(function(){var t,n=e(this);t=n.data("uniformed"),t&&t.update(n,t.options)})}})(jQuery);;
_modalOffsetTop=0;
!function(c){function f(a){return function(b){if(b&&this===b.target)return a.apply(this,arguments)}}var g=function(a,b){this.init(a,b)};g.prototype={constructor:g,init:function(a,b){this.$element=c(a);this.options=c.extend({},c.fn.modalmanager.defaults,this.$element.data(),"object"==typeof b&&b);this.stack=[];this.backdropCount=0;if(this.options.resize){var d,e=this;c(window).on("resize.modal",function(){d&&clearTimeout(d);d=setTimeout(function(){for(var a=0;a<e.stack.length;a++)e.stack[a].isShown&&e.stack[a].layout()},
10)})}},createModal:function(a,b){c(a).modal(c.extend({manager:this},b))},appendModal:function(a){this.stack.push(a);var b=this;a.$element.on("show.modalmanager",f(function(d){d=function(){a.isShown=!0;var d=c.support.transition&&a.$element.hasClass("fade");b.$element.toggleClass("modal-open",b.hasOpenModal()).toggleClass("page-overflow",c(window).height()<b.$element.height());a.$parent=a.$element.parent();a.$container=b.createContainer(a);a.$element.appendTo(a.$container);b.backdrop(a,function(){a.$element.show();
d&&a.$element[0].offsetWidth;a.layout();a.$element.addClass("in").attr("aria-hidden",!1);var e=function(){b.setFocus();a.$element.trigger("shown")};d?a.$element.one(c.support.transition.end,e):e()})};a.options.replace?b.replace(d):d()}));a.$element.on("hidden.modalmanager",f(function(d){b.backdrop(a);a.$element.parent().length?a.$backdrop?(c.support.transition&&a.$element.hasClass("fade")&&a.$element[0].offsetWidth,c.support.transition&&a.$element.hasClass("fade")?a.$backdrop.one(c.support.transition.end,
function(){a.destroy()}):a.destroy()):a.destroy():b.destroyModal(a)}));a.$element.on("destroyed.modalmanager",f(function(c){b.destroyModal(a)}))},getOpenModals:function(){for(var a=[],b=0;b<this.stack.length;b++)this.stack[b].isShown&&a.push(this.stack[b]);return a},hasOpenModal:function(){return 0<this.getOpenModals().length},setFocus:function(){for(var a,b=0;b<this.stack.length;b++)this.stack[b].isShown&&(a=this.stack[b]);a&&a.focus()},destroyModal:function(a){a.$element.off(".modalmanager");a.$backdrop&&
this.removeBackdrop(a);this.stack.splice(this.getIndexOfModal(a),1);var b=this.hasOpenModal();this.$element.toggleClass("modal-open",b);b||this.$element.removeClass("page-overflow");this.removeContainer(a);this.setFocus()},getModalAt:function(a){return this.stack[a]},getIndexOfModal:function(a){for(var b=0;b<this.stack.length;b++)if(a===this.stack[b])return b},replace:function(a){for(var b,d=0;d<this.stack.length;d++)this.stack[d].isShown&&(b=this.stack[d]);b?(this.$backdropHandle=b.$backdrop,b.$backdrop=
null,a&&b.$element.one("hidden",f(c.proxy(a,this))),b.hide()):a&&a()},removeBackdrop:function(a){a.$backdrop.remove();a.$backdrop=null},createBackdrop:function(a,b){this.$backdropHandle?(a=this.$backdropHandle,a.off(".modalmanager"),this.$backdropHandle=null,this.isLoading&&this.removeSpinner()):a=c(b).addClass(a).appendTo(this.$element);return a},removeContainer:function(a){a.$container.remove();a.$container=null},createContainer:function(a){isMobileDevice&&(_modalOffsetTop=c(window).scrollTop());
var b=c('<div class="modal-scrollable">').css("z-index",h("modal",this.getOpenModals().length)).appendTo(this.$element);if(a&&"static"!=a.options.backdrop)b.on("click.modal",f(function(b){a.hide()}));else if(a)b.on("click.modal",f(function(b){a.attention()}));return b},backdrop:function(a,b){var d=a.$element.hasClass("fade")?"fade":"",e=a.options.backdrop&&this.backdropCount<this.options.backdropLimit;if(a.isShown&&e)e=c.support.transition&&d&&!this.$backdropHandle,a.$backdrop=this.createBackdrop(d,
a.options.backdropTemplate),a.$backdrop.css("z-index",h("backdrop",this.getOpenModals().length)),e&&a.$backdrop[0].offsetWidth,a.$backdrop.addClass("in"),this.backdropCount+=1,e?a.$backdrop.one(c.support.transition.end,b):b();else if(!a.isShown&&a.$backdrop){a.$backdrop.removeClass("in");--this.backdropCount;var f=this;c.support.transition&&a.$element.hasClass("fade")?a.$backdrop.one(c.support.transition.end,function(){f.removeBackdrop(a)}):f.removeBackdrop(a)}else b&&b()},removeSpinner:function(){this.$spinner&&
this.$spinner.remove();this.$spinner=null;this.isLoading=!1},removeLoading:function(){this.$backdropHandle&&this.$backdropHandle.remove();this.$backdropHandle=null;this.removeSpinner()},loading:function(a){a=a||function(){};this.$element.toggleClass("modal-open",!this.isLoading||this.hasOpenModal()).toggleClass("page-overflow",c(window).height()<this.$element.height());if(this.isLoading)if(this.isLoading&&this.$backdropHandle){this.$backdropHandle.removeClass("in");var b=this;c.support.transition?
this.$backdropHandle.one(c.support.transition.end,function(){b.removeLoading()}):b.removeLoading()}else a&&a(this.isLoading);else{this.$backdropHandle=this.createBackdrop("fade",this.options.backdropTemplate);this.$backdropHandle[0].offsetWidth;var d=this.getOpenModals();this.$backdropHandle.css("z-index",h("backdrop",d.length+1)).addClass("in");d=c(this.options.spinner).css("z-index",h("modal",d.length+1)).appendTo(this.$element).addClass("in");this.$spinner=c(this.createContainer()).append(d).on("click.modalmanager",
c.proxy(this.loading,this));this.isLoading=!0;c.support.transition?this.$backdropHandle.one(c.support.transition.end,a):a()}}};var h=function(){var a,b={};return function(d,e){if("undefined"===typeof a){var f=c('<div class="modal hide" />').appendTo("body"),g=c('<div class="modal-backdrop hide" />').appendTo("body");b.modal=+f.css("z-index");b.backdrop=+g.css("z-index");a=b.modal-b.backdrop;f.remove();g.remove()}return b[d]+a*e}}();c.fn.modalmanager=function(a,b){return this.each(function(){var d=
c(this),e=d.data("modalmanager");e||d.data("modalmanager",e=new g(this,a));"string"===typeof a&&e[a].apply(e,[].concat(b))})};c.fn.modalmanager.defaults={backdropLimit:999,resize:!0,spinner:'<div class="loading-spinner fade" style="width: 200px; margin-left: -100px;"><div class="progress progress-striped active"><div class="bar" style="width: 100%;"></div></div></div>',backdropTemplate:'<div class="modal-backdrop" />'};c.fn.modalmanager.Constructor=g;c(function(){c(document).off("show.bs.modal").off("hidden.bs.modal")})}(jQuery);
;
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(b,f,a){b instanceof String&&(b=String(b));for(var d=b.length,c=0;c<d;c++){var e=b[c];if(f.call(a,e,c,b))return{i:c,v:e}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,f,a){b!=Array.prototype&&b!=Object.prototype&&(b[f]=a.value)};$jscomp.getGlobal=function(b){b=["object"==typeof globalThis&&globalThis,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,b];for(var f=0;f<b.length;++f){var a=b[f];if(a&&a.Math==Math)return a}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(b,f,a,d){if(f){a=$jscomp.global;b=b.split(".");for(d=0;d<b.length-1;d++){var c=b[d];c in a||(a[c]={});a=a[c]}b=b[b.length-1];d=a[b];f=f(d);f!=d&&null!=f&&$jscomp.defineProperty(a,b,{configurable:!0,writable:!0,value:f})}};$jscomp.polyfill("Array.prototype.find",function(b){return b?b:function(b,a){return $jscomp.findInternal(this,b,a).v}},"es6","es3");
!function(b){var f=function(a,b){this.init(a,b)};f.prototype={constructor:f,init:function(a,d){var c=this;this.options=d;this.$element=b(a).delegate('[data-dismiss="modal"]',"click.dismiss.modal",b.proxy(this.hide,this));this.options.remote&&this.$element.find(".modal-body").load(this.options.remote,function(){var a=b.Event("loaded");c.$element.trigger(a)});a="function"===typeof this.options.manager?this.options.manager.call(this):this.options.manager;a=a.appendModal?a:b(a).modalmanager().data("modalmanager");
a.appendModal(this)},toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var a=b.Event("show");this.isShown||(this.$element.trigger(a),a.isDefaultPrevented()||(this.escape(),this.tab(),this.options.loading&&this.loading()))},hide:function(a){a&&a.preventDefault();a=b.Event("hide");this.$element.trigger(a);this.isShown&&!a.isDefaultPrevented()&&(this.isShown=!1,this.escape(),this.tab(),this.isLoading&&this.loading(),b(document).off("focusin.modal"),this.$element.removeClass("in").removeClass("animated").removeClass(this.options.attentionAnimation).removeClass("modal-overflow").attr("aria-hidden",
!0),b.support.transition&&this.$element.hasClass("fade")?this.hideWithTransition():this.hideModal())},layout:function(){var a=this.options.height?"height":"max-height",d=this.options.height||this.options.maxHeight;if(this.options.width){this.$element.css("width",this.options.width);var c=this;this.$element.css("margin-left",function(){return/%/ig.test(c.options.width)?-(parseInt(c.options.width)/2)+"%":-(b(this).width()/2)+"px"})}else this.$element.css("width",""),this.$element.css("margin-left",
"");this.$element.find(".modal-body").css("overflow","").css(a,"");d&&this.$element.find(".modal-body").css("overflow","auto").css(a,d);b(window).height()-10<this.$element.height()||this.options.modalOverflow?this.$element.css("margin-top",0).addClass("modal-overflow"):this.$element.css("margin-top",-(this.$element.height()/2)).removeClass("modal-overflow")},tab:function(){var a=this;if(this.isShown&&this.options.consumeTab)this.$element.on("keydown.tabindex.modal","[data-tabindex]",function(d){if(d.keyCode&&
9==d.keyCode){var c=[],e=Number(b(this).data("tabindex"));a.$element.find("[data-tabindex]:enabled:visible:not([readonly])").each(function(a){c.push(Number(b(this).data("tabindex")))});c.sort(function(a,b){return a-b});e=b.inArray(e,c);d.shiftKey?0==e?a.$element.find("[data-tabindex="+c[c.length-1]+"]").focus():a.$element.find("[data-tabindex="+c[e-1]+"]").focus():e<c.length-1?a.$element.find("[data-tabindex="+c[e+1]+"]").focus():a.$element.find("[data-tabindex="+c[0]+"]").focus();d.preventDefault()}});
else this.isShown||this.$element.off("keydown.tabindex.modal")},escape:function(){var a=this;this.isShown&&this.options.keyboard?(this.$element.attr("tabindex")||this.$element.attr("tabindex",-1),this.$element.on("keyup.dismiss.modal",function(b){27==b.which&&a.hide()})):this.isShown||this.$element.off("keyup.dismiss.modal")},hideWithTransition:function(){var a=this,d=setTimeout(function(){a.$element.off(b.support.transition.end);a.hideModal()},500);this.$element.one(b.support.transition.end,function(){clearTimeout(d);
a.hideModal()})},hideModal:function(){var a=this.options.height?"height":"max-height";(this.options.height||this.options.maxHeight)&&this.$element.find(".modal-body").css("overflow","").css(a,"");this.$element.hide().trigger("hidden")},removeLoading:function(){this.$loading.remove();this.$loading=null;this.isLoading=!1},loading:function(a){a=a||function(){};var d=this.$element.hasClass("fade")?"fade":"";if(this.isLoading)if(this.isLoading&&this.$loading){this.$loading.removeClass("in");var c=this;
b.support.transition&&this.$element.hasClass("fade")?this.$loading.one(b.support.transition.end,function(){c.removeLoading()}):c.removeLoading()}else a&&a(this.isLoading);else{var e=b.support.transition&&d;this.$loading=b('<div class="loading-mask '+d+'">').append(this.options.spinner).appendTo(this.$element);e&&this.$loading[0].offsetWidth;this.$loading.addClass("in");this.isLoading=!0;e?this.$loading.one(b.support.transition.end,a):a()}},focus:function(){var a=this.$element.find(this.options.focusOn);
a=a.length?a:this.$element;a.focus()},attention:function(){if(this.options.attentionAnimation){this.$element.removeClass("animated").removeClass(this.options.attentionAnimation);var a=this;setTimeout(function(){a.$element.addClass("animated").addClass(a.options.attentionAnimation)},0)}this.focus()},destroy:function(){var a=b.Event("destroy");this.$element.trigger(a);a.isDefaultPrevented()||(this.$element.off(".modal").removeData("modal").removeClass("in").attr("aria-hidden",!0),this.$parent!==this.$element.parent()?
this.$element.appendTo(this.$parent):this.$parent.length||(this.$element.remove(),this.$element=null),this.$element.trigger("destroyed"))}};b.fn.modal=function(a,d){return this.each(function(){var c=b(this),e=c.data("modal"),g=b.extend({},b.fn.modal.defaults,c.data(),"object"==typeof a&&a);e||c.data("modal",e=new f(this,g));"string"==typeof a?e[a].apply(e,[].concat(d)):g.show&&e.show()})};b.fn.modal.defaults={keyboard:!0,backdrop:!0,loading:!1,show:!0,width:null,height:null,maxHeight:null,modalOverflow:!1,
consumeTab:!0,focusOn:null,replace:!1,resize:!1,attentionAnimation:"shake",manager:"body",spinner:'<div class="loading-spinner" style="width: 200px; margin-left: -100px;"><div class="progress progress-striped active"><div class="bar" style="width: 100%;"></div></div></div>',backdropTemplate:'<div class="modal-backdrop" />'};b.fn.modal.Constructor=f;b(function(){b(document).off("click.modal").on("click.modal.data-api",'[data-toggle="modal"]',function(a){var d=b(this),c=d.attr("href"),e=b(d.attr("data-target")||
c&&c.replace(/.*(?=#[^\s]+$)/,""));c=e.data("modal")?"toggle":b.extend({remote:!/#/.test(c)&&c},e.data(),d.data());a.preventDefault();e.modal(c).one("hide",function(){d.focus()})})})}(window.jQuery);
;
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(b,d,c){b instanceof String&&(b=String(b));for(var g=b.length,f=0;f<g;f++){var h=b[f];if(d.call(c,h,f,b))return{i:f,v:h}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,d,c){b!=Array.prototype&&b!=Object.prototype&&(b[d]=c.value)};$jscomp.getGlobal=function(b){b=["object"==typeof globalThis&&globalThis,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,b];for(var d=0;d<b.length;++d){var c=b[d];if(c&&c.Math==Math)return c}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(b,d,c,g){if(d){c=$jscomp.global;b=b.split(".");for(g=0;g<b.length-1;g++){var f=b[g];f in c||(c[f]={});c=c[f]}b=b[b.length-1];g=c[b];d=d(g);d!=g&&null!=d&&$jscomp.defineProperty(c,b,{configurable:!0,writable:!0,value:d})}};$jscomp.polyfill("Array.prototype.find",function(b){return b?b:function(b,c){return $jscomp.findInternal(this,b,c).v}},"es6","es3");
var Metronic=function(){var b=!1,d=!1,c=!1,g=!1,f=[],h="/c/theme2/",n="global/img/",p="global/plugins/",q={blue:"#89C4F4",red:"#F3565D",green:"#1bbc9b",purple:"#9b59b6",grey:"#95a5a6",yellow:"#F8CB00"},k=function(){for(var a=0;a<f.length;a++)f[a].call()},w=function(){var a;if(d){var e;$(window).resize(function(){e!=document.documentElement.clientHeight&&(a&&clearTimeout(a),a=setTimeout(function(){k()},50),e=document.documentElement.clientHeight)})}else $(window).resize(function(){a&&clearTimeout(a);
a=setTimeout(function(){k()},50)})},x=function(){$("body").on("click",".portlet > .portlet-title .fullscreen",function(a){a.preventDefault();a=$(this).closest(".portlet");if(a.hasClass("portlet-fullscreen"))$(this).removeClass("on"),a.removeClass("portlet-fullscreen"),$("body").removeClass("page-portlet-fullscreen"),a.children(".portlet-body").css("height","auto");else{var e=Metronic.getViewPort().height-a.children(".portlet-title").outerHeight()-parseInt(a.children(".portlet-body").css("padding-top"))-
parseInt(a.children(".portlet-body").css("padding-bottom"));$(this).addClass("on");a.addClass("portlet-fullscreen");$("body").addClass("page-portlet-fullscreen");a.children(".portlet-body").css("height",e)}});$("body").on("click",".portlet > .portlet-title > .tools > .collapse, .portlet .portlet-title > .tools > .expand",function(a){a.preventDefault();a=$(this).closest(".portlet").children(".portlet-body");$(this).hasClass("collapse")?($(this).removeClass("collapse").addClass("expand"),a.slideUp(200)):
($(this).removeClass("expand").addClass("collapse"),a.slideDown(200))})},l=function(){if($().uniform){var a=$("input[type=checkbox]:not(.toggle, .md-check, .md-radiobtn, .make-switch, .icheck, .switchery), input[type=radio]:not(.toggle, .md-check, .md-radiobtn, .star, .make-switch, .icheck)");0<a.size()&&a.each(function(){0===$(this).parents(".checker").size()&&($(this).show(),$(this).uniform())})}},y=function(){$("body").on("click",".md-checkbox > label, .md-radio > label",function(){var a=$(this),
b=$(this).children("span:first-child"),c=b.clone(!0);b.before(c);$("."+b.attr("class")+":last",a).remove()});if($("body").hasClass("page-md"))$("body").on("click","a.btn, button.btn, input.btn, label.btn",function(a){var e=$(this);0==e.find(".md-click-circle").length&&e.prepend("<span class='md-click-circle'></span>");var b=e.find(".md-click-circle");b.removeClass("md-click-animate");if(!b.height()&&!b.width()){var c=Math.max(e.outerWidth(),e.outerHeight());b.css({height:c,width:c})}c=a.pageX-e.offset().left-
b.width()/2;a=a.pageY-e.offset().top-b.height()/2;b.css({top:a+"px",left:c+"px"}).addClass("md-click-animate")});var a=function(a){""!=a.val()?a.addClass("edited"):a.removeClass("edited")};$("body").on("keydown",".form-md-floating-label > .form-control",function(e){a($(this))});$("body").on("blur",".form-md-floating-label > .form-control",function(e){a($(this))})},r=function(){$().bootstrapSwitch&&$(".make-switch").bootstrapSwitch()},t=function(){$().confirmation&&$("[data-toggle=confirmation]").confirmation({container:"body",
btnOkClass:"btn-xs btn-success",btnCancelClass:"btn-xs btn-danger"})},z=function(){if(location.hash){var a=location.hash.substr(1);$('a[href="#'+a+'"]').parents(".tab-pane:hidden").each(function(){var a=$(this).attr("id");$('a[href="#'+a+'"]').click()});$('a[href="#'+a+'"]').click()}$().tabdrop&&$(".tabbable-tabdrop .nav-pills, .tabbable-tabdrop .nav-tabs").tabdrop({text:'<i class="fa fa-ellipsis-v"></i>&nbsp;<i class="fa fa-angle-down"></i>'})},A=function(){$("body").on("hide.bs.modal",function(){1<
$(".modal:visible").size()&&!1===$("html").hasClass("modal-open")?$("html").addClass("modal-open"):1>=$(".modal:visible").size()&&$("html").removeClass("modal-open")});$("body").on("show.bs.modal",".modal",function(){isMobileDevice&&(console.log("_modalOffsetTop",_modalOffsetTop),$("body").addClass("mobileDeviceModalScrollableAbsolute"));$(this).hasClass("modal-scroll")&&$("body").addClass("modal-open-noscroll")});$("body").on("hide.bs.modal",".modal",function(){$("body").removeClass("modal-open-noscroll")});
$("body").on("hidden.bs.modal",".modal",function(){isMobileDevice&&window.scrollTo(0,_modalOffsetTop)});$("body").on("hidden.bs.modal",".modal:not(.modal-cached)",function(){$(this).removeData("bs.modal")})},u=function(){$("body").on("click",".dropdown-menu.hold-on-click",function(a){a.stopPropagation()})},B=function(){$("body").on("click",'[data-close="alert"]',function(a){$(this).parent(".alert").hide();$(this).closest(".note").hide();a.preventDefault()});$("body").on("click",'[data-close="note"]',
function(a){$(this).closest(".note").hide();a.preventDefault()});$("body").on("click",'[data-remove="note"]',function(a){$(this).closest(".note").remove();a.preventDefault()})},C=function(){$('[data-hover="dropdown"]').not(".hover-initialized").each(function(){$(this).dropdownHover();$(this).addClass("hover-initialized")})},m,v=function(){$(".popovers").popover();$(document).on("click.bs.popover.data-api",function(a){m&&m.popover("hide")})},D=function(){(d||c)&&$("input[placeholder]:not(.placeholder-no-fix), textarea[placeholder]:not(.placeholder-no-fix)").each(function(){var a=
$(this);""===a.val()&&""!==a.attr("placeholder")&&a.addClass("placeholder").val(a.attr("placeholder"));a.focus(function(){a.val()==a.attr("placeholder")&&a.val("")});a.blur(function(){""!==a.val()&&a.val()!=a.attr("placeholder")||a.val(a.attr("placeholder"))})})};return{init:function(){"rtl"===$("body").css("direction")&&(b=!0);d=!!navigator.userAgent.match(/MSIE 8.0/);c=!!navigator.userAgent.match(/MSIE 9.0/);(g=!!navigator.userAgent.match(/MSIE 10.0/))&&$("html").addClass("ie10");(g||c||d)&&$("html").addClass("ie");
w();y();l();r();Metronic.initSlimScroll(".scroller");x();B();u();z();v();A();t();D()},initAjax:function(){l();r();C();Metronic.initSlimScroll(".scroller");u();v();t()},initComponents:function(){this.initAjax()},setLastPopedPopover:function(a){m=a},addResizeHandler:function(a){f.push(a)},runResizeHandlers:function(){k()},scrollTo:function(a,b){var e=a&&0<a.size()?a.offset().top:0;a&&($("body").hasClass("page-header-fixed")&&(e-=$(".page-header").height()),e+=b?b:-1*a.height());$("html,body").animate({scrollTop:e},
"slow")},initSlimScroll:function(a){$(a).each(function(){if(!$(this).attr("data-initialized")){var a=$(this).attr("data-height")?$(this).attr("data-height"):$(this).css("height");$(this).slimScroll({allowPageScroll:!1,size:"7px",color:$(this).attr("data-handle-color")?$(this).attr("data-handle-color"):"#bbb",wrapperClass:$(this).attr("data-wrapper-class")?$(this).attr("data-wrapper-class"):"slimScrollDiv",railColor:$(this).attr("data-rail-color")?$(this).attr("data-rail-color"):"#eaeaea",position:b?
"left":"right",height:a,alwaysVisible:"1"==$(this).attr("data-always-visible")?!0:!1,railVisible:"1"==$(this).attr("data-rail-visible")?!0:!1,disableFadeOut:!0});$(this).attr("data-initialized","1")}})},destroySlimScroll:function(a){$(a).each(function(){if("1"===$(this).attr("data-initialized")){$(this).removeAttr("data-initialized");$(this).removeAttr("style");var a={};$(this).attr("data-handle-color")&&(a["data-handle-color"]=$(this).attr("data-handle-color"));$(this).attr("data-wrapper-class")&&
(a["data-wrapper-class"]=$(this).attr("data-wrapper-class"));$(this).attr("data-rail-color")&&(a["data-rail-color"]=$(this).attr("data-rail-color"));$(this).attr("data-always-visible")&&(a["data-always-visible"]=$(this).attr("data-always-visible"));$(this).attr("data-rail-visible")&&(a["data-rail-visible"]=$(this).attr("data-rail-visible"));$(this).slimScroll({wrapperClass:$(this).attr("data-wrapper-class")?$(this).attr("data-wrapper-class"):"slimScrollDiv",destroy:!0});var b=$(this);$.each(a,function(a,
e){b.attr(a,e)})}})},scrollTop:function(){Metronic.scrollTo()},blockUI:function(a){a=$.extend(!0,{},a);var b=a.animate?'<div class="loading-message '+(a.boxed?"loading-message-boxed":"")+'"><div class="block-spinner-bar"><div class="bounce1"></div><div class="bounce2"></div><div class="bounce3"></div></div></div>':a.iconOnly?'<div class="loading-message '+(a.boxed?"loading-message-boxed":"")+'"><div class="loader"><svg class="circular" viewBox="25 25 50 50"><circle class="path" cx="50" cy="50" r="20" fill="none" stroke-width="2" stroke-miterlimit="10"/></svg></div></div>':
a.textOnly?'<div class="loading-message '+(a.boxed?"loading-message-boxed":"")+'"><span>&nbsp;&nbsp;'+(a.message?a.message:"LOADING...")+"</span></div>":'<div class="loading-message '+(a.boxed?"loading-message-boxed":"")+'"><img src="'+this.getGlobalImgPath()+'loading-spinner-grey.gif" align=""><span>&nbsp;&nbsp;'+(a.message?a.message:"LOADING...")+"</span></div>";if(a.target){var c=$(a.target);c.height()<=$(window).height()&&(a.cenrerY=!0);c.block({message:b,baseZ:a.zIndex?a.zIndex:1E3,centerY:void 0!==
a.cenrerY?a.cenrerY:!1,css:{top:"10%",border:"0",padding:"0",backgroundColor:"none"},overlayCSS:{backgroundColor:a.overlayColor?a.overlayColor:"#555",opacity:a.boxed?.4:.1,cursor:"  cursor: auto;"},fadeIn:0})}else $.blockUI({message:b,baseZ:a.zIndex?a.zIndex:1E3,css:{border:"0",padding:"0",backgroundColor:"none"},overlayCSS:{backgroundColor:a.overlayColor?a.overlayColor:"#555",opacity:0,cursor:"  cursor: auto;"},fadeIn:300})},unblockUI:function(a){a?$(a).unblock({onUnblock:function(){$(a).css("position",
"");$(a).css("zoom","")},fadeOut:0}):$.unblockUI({fadeOut:0})},startPageLoading:function(a){a&&a.animate?($(".page-spinner-bar").remove(),$("body").append('<div class="page-spinner-bar"><div class="bounce1"></div><div class="bounce2"></div><div class="bounce3"></div></div>')):($(".page-loading").remove(),$("body").append('<div class="page-loading"><img src="'+this.getGlobalImgPath()+'loading-spinner-grey.gif"/>&nbsp;&nbsp;<span>'+(a&&a.message?a.message:"Loading...")+"</span></div>"))},stopPageLoading:function(){$(".page-loading, .page-spinner-bar").remove()},
alert:function(a){a=$.extend(!0,{container:"",place:"append",type:"success",message:"",close:!0,reset:!0,focus:!0,closeInSeconds:0,icon:""},a);var b=Metronic.getUniqueID("Metronic_alert"),c='<div id="'+b+'" class="Metronic-alerts alert alert-'+a.type+' fade in">'+(a.close?'<button type="button" class="close" data-dismiss="alert" aria-hidden="true"></button>':"")+(""!==a.icon?'<i class="fa-lg fa fa-'+a.icon+'"></i>  ':"")+a.message+"</div>";a.reset&&$(".Metronic-alerts").remove();a.container?"append"==
a.place?$(a.container).append(c):$(a.container).prepend(c):$("body").hasClass("page-container-bg-solid")?$(".page-title").after(c):0<$(".page-bar").size()?$(".page-bar").after(c):$(".page-breadcrumb").after(c);a.focus&&Metronic.scrollTo($("#"+b));0<a.closeInSeconds&&setTimeout(function(){$("#"+b).remove()},1E3*a.closeInSeconds);return b},initUniform:function(a){a?$(a).each(function(){0===$(this).parents(".checker").size()&&($(this).show(),$(this).uniform())}):l()},updateUniform:function(a){$.uniform.update(a)},
initFancybox:function(){handleFancybox()},getActualVal:function(a){a=$(a);return a.val()===a.attr("placeholder")?"":a.val()},getURLParameter:function(a){var b,c=window.location.search.substring(1).split("&");for(b=0;b<c.length;b++){var d=c[b].split("=");if(d[0]==a)return unescape(d[1])}return null},isTouchDevice:function(){try{return document.createEvent("TouchEvent"),!0}catch(a){return!1}},getViewPort:function(){var a=window,b="inner";"innerWidth"in window||(b="client",a=document.documentElement||
document.body);return{width:a[b+"Width"],height:a[b+"Height"]}},getUniqueID:function(a){return"prefix_"+Math.floor(Math.random()*(new Date).getTime())},isIE8:function(){return d},isIE9:function(){return c},isRTL:function(){return b},isAngularJsApp:function(){return"undefined"==typeof angular?!1:!0},getAssetsPath:function(){return h},setAssetsPath:function(a){h=a},setGlobalImgPath:function(a){n=a},getGlobalImgPath:function(){return h+n},setGlobalPluginsPath:function(a){p=a},getGlobalPluginsPath:function(){return h+
p},getGlobalCssPath:function(){return h+"global/css/"},getBrandColor:function(a){return q[a]?q[a]:""},getResponsiveBreakpoint:function(a){var b={xs:480,sm:768,md:992,lg:1200};return b[a]?b[a]:0}}}();
;
/*
 !$('.page-sidebar').on('click', ' li > a.ajaxify', function (e) {
            e.preventDefault();
            Metronic.scrollTop();

            var url = $(this).attr("href");
            var menuContainer = $('.page-sidebar ul');
            var pageContent = $('.page-content');
            var pageContentBody = $('.page-content .page-content-body');

            menuContainer.children('li.active').removeClass('active');
            menuContainer.children('arrow.open').removeClass('open');

            $(this).parents('li').each(function () {
                $(this).addClass('active');
                $(this).children('a > span.arrow').addClass('open');
            });
            $(this).parents('li').addClass('active');

            if (Metronic.getViewPort().width < resBreakpointMd && $('.page-sidebar').hasClass("in")) { // close the menu on mobile view while laoding a page
                $('.page-header .responsive-toggler').click();
            }

            Metronic.startPageLoading();

            var the = $(this);

            $.ajax({
                type: "GET",
                cache: false,
                url: url,
                dataType: "html",
                success: function (res) {
                    if (the.parents('li.open').size() === 0) {
                        $('.page-sidebar-menu > li.open > a').click();
                    }

                    Metronic.stopPageLoading();
                    pageContentBody.html(res);
                    Layout.fixContentHeight(); // fix content height
                    Metronic.initAjax(); // initialize core stuff
                },
                error: function (xhr, ajaxOptions, thrownError) {
                    Metronic.stopPageLoading();
                    pageContentBody.html('<h4>Could not load the requested content.</h4>');
                }
            });
        });

        // handle ajax link within main content
        $('.page-content').on('click', '.ajaxify', function (e) {
            e.preventDefault();
            Metronic.scrollTop();

            var url = $(this).attr("href");
            var pageContent = $('.page-content');
            var pageContentBody = $('.page-content .page-content-body');

            Metronic.startPageLoading();

            if (Metronic.getViewPort().width < resBreakpointMd && $('.page-sidebar').hasClass("in")) { // close the menu on mobile view while laoding a page
                $('.page-header .responsive-toggler').click();
            }

            $.ajax({
                type: "GET",
                cache: false,
                url: url,
                dataType: "html",
                success: function (res) {
                    Metronic.stopPageLoading();
                    pageContentBody.html(res);
                    Layout.fixContentHeight(); // fix content height
                    Metronic.initAjax(); // initialize core stuff
                },
                error: function (xhr, ajaxOptions, thrownError) {
                    pageContentBody.html('<h4>Could not load the requested content.</h4>');
                    Metronic.stopPageLoading();
                }
            });
        });*/
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(b,e,c){b instanceof String&&(b=String(b));for(var f=b.length,g=0;g<f;g++){var k=b[g];if(e.call(c,k,g,b))return{i:g,v:k}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,e,c){b!=Array.prototype&&b!=Object.prototype&&(b[e]=c.value)};$jscomp.getGlobal=function(b){b=["object"==typeof globalThis&&globalThis,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,b];for(var e=0;e<b.length;++e){var c=b[e];if(c&&c.Math==Math)return c}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(b,e,c,f){if(e){c=$jscomp.global;b=b.split(".");for(f=0;f<b.length-1;f++){var g=b[f];g in c||(c[g]={});c=c[g]}b=b[b.length-1];f=c[b];e=e(f);e!=f&&null!=e&&$jscomp.defineProperty(c,b,{configurable:!0,writable:!0,value:e})}};$jscomp.polyfill("Array.prototype.find",function(b){return b?b:function(b,c){return $jscomp.findInternal(this,b,c).v}},"es6","es3");
var Layout=function(){var b=Metronic.getResponsiveBreakpoint("md"),e=function(){var a=$(".page-content"),d=$(".page-sidebar"),h=$("body");if(!0===h.hasClass("page-footer-fixed")&&!1===h.hasClass("page-sidebar-fixed"))d=Metronic.getViewPort().height-$(".page-footer").outerHeight()-$(".page-header").outerHeight(),a.height()<d&&a.attr("style","min-height:"+(d-8)+"px");else{if(h.hasClass("page-sidebar-fixed"))d=g(),!1===h.hasClass("page-footer-fixed")&&(d-=$(".page-footer").outerHeight());else{h=$(".page-header").outerHeight();
var e=$(".page-footer").outerHeight();d=Metronic.getViewPort().width<b?Metronic.getViewPort().height-h-e:d.height()+20;d+h+e<=Metronic.getViewPort().height&&(d=Metronic.getViewPort().height-h-e)}a.attr("style","min-height:"+(d-8)+"px")}},c=function(a,d){var e=location.hash.toLowerCase(),c=$(".page-sidebar-menu");c.find("li.active").removeClass("active");"click"===a||"set"===a?d=$(d):"match"===a&&c.find("li > a").each(function(){if("undefined"!=typeof $(this).attr("href")){var a=$(this).attr("href").toLowerCase();
"#"==a&&""==e.length?d=$(this):1<a.length&&e.substr(1,a.length-1)==a.substr(1)&&(d=$(this))}});d&&0!=d.size()&&"javascript:;"!==d.attr("href").toLowerCase()&&(parseInt(c.data("slide-speed")),c.data("keep-expanded"),c.find("li.active").removeClass("active"),c.find("li > a > .selected").remove(),!1===c.hasClass("page-sidebar-menu-hover-submenu")?c.find("li.open").each(function(){0===$(this).children(".sub-menu").size()&&($(this).removeClass("open"),$(this).find("> a > .arrow.open").removeClass("open"))}):
c.find("li.open").removeClass("open"),d.parents("li").each(function(){$(this).addClass("active");$(this).find("> a > span.arrow").addClass("open");1===$(this).parent("ul.page-sidebar-menu").size()&&$(this).find("> a").append('<span class="selected"></span>');1===$(this).children("ul.sub-menu").size()&&$(this).addClass("open")}),"click"===a&&Metronic.getViewPort().width<b&&$(".page-sidebar").hasClass("in")&&$(".page-header .responsive-toggler").click())},f=function(){$(".page-sidebar").on("click",
"li > a",function(a){a=$(this).next();var d=$(this),c=a.hasClass("sub-menu");if(!(Metronic.getViewPort().width>=b&&1===d.parents(".page-sidebar-menu-hover-submenu").size())){var g=$(this).parent(),f=g.parent().children("li.open");!1===c?(Metronic.getViewPort().width<b&&$(".page-sidebar").hasClass("in")&&$(".page-header .responsive-toggler").click(),f.children("a").children(".arrow").removeClass("open"),f.children(".sub-menu:not(.always-open)").slideUp(300),f.removeClass("open")):(!a.is(":visible")&&
c&&($(".arrow",d).addClass("open"),d.parent().addClass("open"),a.slideDown(300,function(){e()})),g[0]!=f[0]&&(f.children("a").children(".arrow").removeClass("open"),f.children(".sub-menu:not(.always-open)").slideUp(300),f.removeClass("open")))}});$(document).on("click",".page-header-fixed-mobile .page-header .responsive-toggler",function(){Metronic.scrollTop()});l();$(".page-sidebar").on("click",".sidebar-search .remove",function(a){a.preventDefault();$(".sidebar-search").removeClass("open")});$(".page-sidebar .sidebar-search").on("keypress",
"input.form-control",function(a){if(13==a.which)return $(".sidebar-search").submit(),!1});$(".sidebar-search .submit").on("click",function(a){a.preventDefault();$("body").hasClass("page-sidebar-closed")?!1===$(".sidebar-search").hasClass("open")?(1===$(".page-sidebar-fixed").size()&&$(".page-sidebar .sidebar-toggler").click(),$(".sidebar-search").addClass("open")):$(".sidebar-search").submit():$(".sidebar-search").submit()})},g=function(){var a=Metronic.getViewPort().height-$(".page-header").outerHeight();
$("body").hasClass("page-footer-fixed")&&(a-=$(".page-footer").outerHeight());return a},k=function(){var a=$(".page-sidebar-menu");Metronic.destroySlimScroll(a);0===$(".page-sidebar-fixed").size()?e():Metronic.getViewPort().width>=b&&(a.attr("data-height",g()),e())},l=function(){var a=$("body");if(a.hasClass("page-sidebar-fixed"))$(".page-sidebar").on("mouseenter",function(){a.hasClass("page-sidebar-closed")&&$(this).find(".page-sidebar-menu").removeClass("page-sidebar-menu-closed")}).on("mouseleave",
function(){a.hasClass("page-sidebar-closed")&&$(this).find(".page-sidebar-menu").addClass("page-sidebar-menu-closed")})},p=function(){var a=$("body");$.cookie&&"1"===$.cookie("sidebar_closed")&&Metronic.getViewPort().width>=b&&($("body").addClass("page-sidebar-closed"),$(".page-sidebar-menu").addClass("page-sidebar-menu-closed"));$("body").on("click",".sidebar-toggler",function(b){b=$(".page-sidebar");var d=$(".page-sidebar-menu");$(".sidebar-search",b).removeClass("open");a.hasClass("page-sidebar-closed")?
(a.removeClass("page-sidebar-closed"),d.removeClass("page-sidebar-menu-closed"),$.cookie&&$.cookie("sidebar_closed","0")):(a.addClass("page-sidebar-closed"),d.addClass("page-sidebar-menu-closed"),a.hasClass("page-sidebar-fixed")&&d.trigger("mouseleave"),$.cookie&&$.cookie("sidebar_closed","1"));$(window).trigger("resize")})},q=function(){$("body").on("shown.bs.tab",'a[data-toggle="tab"]',function(){e()})},m=function(){isMobileDevice?$(".scroll-to-top").remove():991>$(window).width()?$(".scroll-to-top").hide():
($(window).scroll(function(){991>$(window).width()?$(".scroll-to-top").hide():300<$(this).scrollTop()?$(".scroll-to-top").fadeIn(500):$(".scroll-to-top").fadeOut(500)}),$(".scroll-to-top").click(function(a){a.preventDefault();$("html, body").animate({scrollTop:0},500);return!1}))},n=function(){var a=$(".full-height-content");var d=Metronic.getViewPort().height-$(".page-header").outerHeight(!0)-$(".page-footer").outerHeight(!0)-$(".page-title").outerHeight(!0)-$(".page-bar").outerHeight(!0);if(a.hasClass("portlet")){var c=
a.find(".portlet-body");Metronic.getViewPort().width<b?Metronic.destroySlimScroll(c.find(".full-height-content-body")):(d=d-a.find(".portlet-title").outerHeight(!0)-parseInt(a.find(".portlet-body").css("padding-top"))-parseInt(a.find(".portlet-body").css("padding-bottom"))-2,a.hasClass("full-height-content-scrollable")?(d-=35,c.find(".full-height-content-body").css("height",d),Metronic.initSlimScroll(c.find(".full-height-content-body"))):c.css("min-height",d))}else Metronic.getViewPort().width<b?
Metronic.destroySlimScroll(a.find(".full-height-content-body")):a.hasClass("full-height-content-scrollable")?(d-=35,a.find(".full-height-content-body").css("height",d),Metronic.initSlimScroll(a.find(".full-height-content-body"))):a.css("min-height",d)};return{setSidebarMenuActiveLink:function(a,b){c(a,b)},initSidebar:function(){k();f();p();Metronic.addResizeHandler(k)},initContent:function(){n();q();Metronic.addResizeHandler(e);Metronic.addResizeHandler(n)},initFooter:function(){m()},handleGoTop:function(){m()},
init:function(){this.initSidebar();this.initContent();this.initFooter()},fixContentHeight:function(){e()},initFixedSidebarHoverEffect:function(){l()},initFixedSidebar:function(){k()},getLayoutImgPath:function(){return Metronic.getAssetsPath()+"admin/layout/img/"},getLayoutCssPath:function(){return Metronic.getAssetsPath()+"admin/layout/css/"}}}();
;
var Demo=function(){var handleTheme=function(){var panel=$(".theme-panel");var resetLayout=function(){$("body").removeClass("page-boxed").removeClass("page-footer-fixed").removeClass("page-sidebar-fixed").removeClass("page-header-fixed").removeClass("page-sidebar-reversed");$(".page-header > .page-header-inner").removeClass("container");if($(".page-container").parent(".container").size()===1)$(".page-container").insertAfter("body > .clearfix");if($(".page-footer > .container").size()===1)$(".page-footer").html($(".page-footer > .container").html());
else if($(".page-footer").parent(".container").size()===1){$(".page-footer").insertAfter(".page-container");$(".scroll-to-top").insertAfter(".page-footer")}$(".top-menu > .navbar-nav > li.dropdown").removeClass("dropdown-dark");$("body > .container").remove()};var lastSelectedLayout="";var setLayout=function(){var layoutOption="fluid";var sidebarOption="fixed";var headerOption="fixed";var footerOption="default";var sidebarPosOption="left";var sidebarStyleOption="light";var sidebarMenuOption="accordion";
    var headerTopDropdownStyle="light";if(sidebarOption=="fixed"&&headerOption=="default"){alert("Default Header with Fixed Sidebar option is not supported. Proceed with Fixed Header with Fixed Sidebar.");$(".page-header-option",panel).val("fixed");$(".sidebar-option",panel).val("fixed");sidebarOption="fixed";headerOption="fixed"}resetLayout();if(layoutOption==="boxed"){$("body").addClass("page-boxed");$(".page-header > .page-header-inner").addClass("container");var cont=$("body > .clearfix").after('<div class="container"></div>');
        $(".page-container").appendTo("body > .container");if(footerOption==="fixed")$(".page-footer").html('<div class="container">'+$(".page-footer").html()+"</div>");else $(".page-footer").appendTo("body > .container")}if(lastSelectedLayout!=layoutOption)Metronic.runResizeHandlers();lastSelectedLayout=layoutOption;if(headerOption==="fixed"){$("body").addClass("page-header-fixed");$(".page-header").removeClass("navbar-static-top").addClass("navbar-fixed-top")}else{$("body").removeClass("page-header-fixed");
        $(".page-header").removeClass("navbar-fixed-top").addClass("navbar-static-top")}if($("body").hasClass("page-full-width")===false)if(sidebarOption==="fixed"){$("body").addClass("page-sidebar-fixed");$("page-sidebar-menu").addClass("page-sidebar-menu-fixed");$("page-sidebar-menu").removeClass("page-sidebar-menu-default");Layout.initFixedSidebarHoverEffect()}else{$("body").removeClass("page-sidebar-fixed");$("page-sidebar-menu").addClass("page-sidebar-menu-default");$("page-sidebar-menu").removeClass("page-sidebar-menu-fixed");
        $(".page-sidebar-menu").unbind("mouseenter").unbind("mouseleave")}if(headerTopDropdownStyle==="dark")$(".top-menu > .navbar-nav > li.dropdown").addClass("dropdown-dark");else $(".top-menu > .navbar-nav > li.dropdown").removeClass("dropdown-dark");if(footerOption==="fixed")$("body").addClass("page-footer-fixed");else $("body").removeClass("page-footer-fixed");if(sidebarStyleOption==="light")$(".page-sidebar-menu").addClass("page-sidebar-menu-light");else $(".page-sidebar-menu").removeClass("page-sidebar-menu-light");
    if(sidebarMenuOption==="hover")if(sidebarOption=="fixed"){$(".sidebar-menu-option",panel).val("accordion");alert("Hover Sidebar Menu is not compatible with Fixed Sidebar Mode. Select Default Sidebar Mode Instead.")}else $(".page-sidebar-menu").addClass("page-sidebar-menu-hover-submenu");else $(".page-sidebar-menu").removeClass("page-sidebar-menu-hover-submenu");if(Metronic.isRTL())if(sidebarPosOption==="left"){$("body").addClass("page-sidebar-reversed");$("#frontend-link").tooltip("destroy").tooltip({placement:"right"})}else{$("body").removeClass("page-sidebar-reversed");
        $("#frontend-link").tooltip("destroy").tooltip({placement:"left"})}else if(sidebarPosOption==="right"){$("body").addClass("page-sidebar-reversed");$("#frontend-link").tooltip("destroy").tooltip({placement:"left"})}else{$("body").removeClass("page-sidebar-reversed");$("#frontend-link").tooltip("destroy").tooltip({placement:"right"})}Layout.fixContentHeight();Layout.initFixedSidebar()};var setColor=function(color){if(typeof color=="undefined")color=$(".theme-colors > ul > li.current",panel).attr("data-style");
    var color_=Metronic.isRTL()?color+"-rtl":color;$("#style_color").attr("href",Layout.getLayoutCssPath()+"themes/"+color_+".css");$(".page-logo img").attr("src",Layout.getLayoutImgPath()+"logo.png")};$(".toggler-close",panel).click(function(){$(".toggler-close").hide();$(".theme-panel > .theme-options").hide()});$(".theme-colors > ul > li",panel).click(function(){var color=$(this).attr("data-style");setColor(color);$("ul > li",panel).removeClass("current");$(this).addClass("current");saveUserLayoutOptions()});
    if($("body").hasClass("page-boxed"))$(".layout-option",panel).val("boxed");if($("body").hasClass("page-sidebar-fixed"))$(".sidebar-option",panel).val("fixed");if($("body").hasClass("page-header-fixed"))$(".page-header-option",panel).val("fixed");if($("body").hasClass("page-footer-fixed"))$(".page-footer-option",panel).val("fixed");if($("body").hasClass("page-sidebar-reversed"))$(".sidebar-pos-option",panel).val("right");if($(".page-sidebar-menu").hasClass("page-sidebar-menu-light"))$(".sidebar-style-option",
        panel).val("light");if($(".page-sidebar-menu").hasClass("page-sidebar-menu-hover-submenu"))$(".sidebar-menu-option",panel).val("hover");var sidebarOption=$(".sidebar-option",panel).val();var headerOption=$(".page-header-option",panel).val();var footerOption=$(".page-footer-option",panel).val();var sidebarPosOption=$(".sidebar-pos-option",panel).val();var sidebarStyleOption=$(".sidebar-style-option",panel).val();var sidebarMenuOption=$(".sidebar-menu-option",panel).val();$(".layout-option, .page-header-option, .page-header-top-dropdown-style-option, .sidebar-option, .page-footer-option, .sidebar-pos-option, .sidebar-style-option, .sidebar-menu-option",
        panel).change(function(){setLayout()});setLayout();setColor()};var setThemeStyle=function(style){var file=style==="rounded"?"components-rounded":"components";file=Metronic.isRTL()?file+"-rtl":file;$("#style_components").attr("href",Metronic.getGlobalCssPath()+file+".css");if($.cookie)$.cookie("layout-style-option",style)};return{init:function(){handleTheme();$(".theme-panel .layout-style-option").change(function(){setThemeStyle($(this).val())})}}}();
;
(function(c){var j={init:function(a){var b={color:c(this).css("background-color"),reach:20,speed:1E3,pause:0,glow:!0,repeat:!0,onHover:!1};c(this).css({"-moz-outline-radius":c(this).css("border-top-left-radius"),"-webkit-outline-radius":c(this).css("border-top-left-radius"),"outline-radius":c(this).css("border-top-left-radius")});a&&c.extend(b,a);b.color=c("<div style='background:"+b.color+"'></div>").css("background-color");!0!==b.repeat&&(!isNaN(b.repeat)&&0<b.repeat)&&(b.repeat-=1);return this.each(function(){b.onHover?
c(this).bind("mouseover",function(){g(b,this,0)}).bind("mouseout",function(){c(this).pulsate("destroy")}):g(b,this,0)})},destroy:function(){return this.each(function(){clearTimeout(this.timer);c(this).css("outline",0)})}},g=function(a,b,d){var f=a.reach;d=d>f?0:d;var h=(f-d)/f,e=a.color.split(","),h="rgba("+e[0].split("(")[1]+","+e[1]+","+e[2].split(")")[0]+","+h+")",e={outline:"2px solid "+h};a.glow?(e["box-shadow"]="0px 0px "+parseInt(d/1.5)+"px "+h,userAgent=navigator.userAgent||"",/(chrome)[ \/]([\w.]+)/.test(userAgent.toLowerCase())&&
(e["outline-offset"]=d+"px",e["outline-radius"]="100 px")):e["outline-offset"]=d+"px";c(b).css(e);b.timer=setTimeout(function(){if(d>=f&&!a.repeat)return c(b).pulsate("destroy"),!1;if(d>=f&&!0!==a.repeat&&!isNaN(a.repeat)&&0<a.repeat)a.repeat-=1;else if(a.pause&&d>=f){var e=d+1;innerfunc=function(){g(a,b,e)};setTimeout(innerfunc,a.pause);return!1}g(a,b,d+1)},a.speed/f)};c.fn.pulsate=function(a){if(j[a])return j[a].apply(this,Array.prototype.slice.call(arguments,1));if("object"===typeof a||!a)return j.init.apply(this,
arguments);c.error("Method "+a+" does not exist on jQuery.pulsate")}})(jQuery);;
(function(f,C){"object"===typeof exports&&"undefined"!==typeof module?module.exports=C():"function"===typeof define&&define.amd?define(C):f.moment=C()})(this,function(){function f(){return Rb.apply(null,arguments)}function C(a){return a instanceof Array||"[object Array]"===Object.prototype.toString.call(a)}function ma(a){return a instanceof Date||"[object Date]"===Object.prototype.toString.call(a)}function bb(a,b){var c=[],d;for(d=0;d<a.length;++d)c.push(b(a[d],d));return c}function z(a,b){return Object.prototype.hasOwnProperty.call(a,
b)}function U(a,b){for(var c in b)z(b,c)&&(a[c]=b[c]);z(b,"toString")&&(a.toString=b.toString);z(b,"valueOf")&&(a.valueOf=b.valueOf);return a}function H(a,b,c,d){return cb(a,b,c,d,!0).utc()}function n(a){null==a._pf&&(a._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null});return a._pf}function Da(a){if(null==a._isValid){var b=n(a),c=Sb.call(b.parsedDateParts,function(a){return null!=
a});a._isValid=!isNaN(a._d.getTime())&&0>b.overflow&&!b.empty&&!b.invalidMonth&&!b.invalidWeekday&&!b.nullInput&&!b.invalidFormat&&!b.userInvalidated&&(!b.meridiem||b.meridiem&&c);a._strict&&(a._isValid=a._isValid&&0===b.charsLeftOver&&0===b.unusedTokens.length&&void 0===b.bigHour)}return a._isValid}function na(a){var b=H(NaN);null!=a?U(n(b),a):n(b).userInvalidated=!0;return b}function y(a){return void 0===a}function Ea(a,b){var c;y(b._isAMomentObject)||(a._isAMomentObject=b._isAMomentObject);y(b._i)||
(a._i=b._i);y(b._f)||(a._f=b._f);y(b._l)||(a._l=b._l);y(b._strict)||(a._strict=b._strict);y(b._tzm)||(a._tzm=b._tzm);y(b._isUTC)||(a._isUTC=b._isUTC);y(b._offset)||(a._offset=b._offset);y(b._pf)||(a._pf=n(b));y(b._locale)||(a._locale=b._locale);if(0<Fa.length)for(c in Fa){var d=Fa[c];var h=b[d];y(h)||(a[d]=h)}return a}function ha(a){Ea(this,a);this._d=new Date(null!=a._d?a._d.getTime():NaN);!1===Ga&&(Ga=!0,f.updateOffset(this),Ga=!1)}function N(a){return a instanceof ha||null!=a&&null!=a._isAMomentObject}
function A(a){return 0>a?Math.ceil(a):Math.floor(a)}function g(a){a=+a;var b=0;0!==a&&isFinite(a)&&(b=A(a));return b}function db(a,b,c){var d=Math.min(a.length,b.length),h=Math.abs(a.length-b.length),e=0,f;for(f=0;f<d;f++)(c&&a[f]!==b[f]||!c&&g(a[f])!==g(b[f]))&&e++;return e+h}function eb(a){!1===f.suppressDeprecationWarnings&&"undefined"!==typeof console&&console.warn&&console.warn("Deprecation warning: "+a)}function D(a,b){var c=!0;return U(function(){null!=f.deprecationHandler&&f.deprecationHandler(null,
a);c&&(eb(a+"\nArguments: "+Array.prototype.slice.call(arguments).join(", ")+"\n"+Error().stack),c=!1);return b.apply(this,arguments)},b)}function Ha(a,b){null!=f.deprecationHandler&&f.deprecationHandler(a,b);fb[a]||(eb(b),fb[a]=!0)}function O(a){return a instanceof Function||"[object Function]"===Object.prototype.toString.call(a)}function Ia(a,b){var c=U({},a),d;for(d in b)z(b,d)&&("[object Object]"===Object.prototype.toString.call(a[d])&&"[object Object]"===Object.prototype.toString.call(b[d])?
(c[d]={},U(c[d],a[d]),U(c[d],b[d])):null!=b[d]?c[d]=b[d]:delete c[d]);return c}function Ja(a){null!=a&&this.set(a)}function gb(a){return a?a.toLowerCase().replace("_","-"):a}function hb(a){var b=null;if(!u[a]&&"undefined"!==typeof module&&module&&module.exports)try{b=oa._abbr,require("./locale/"+a),aa(b)}catch(c){}return u[a]}function aa(a,b){a&&(a=y(b)?P(a):ib(a,b))&&(oa=a);return oa._abbr}function ib(a,b){if(null!==b)return b.abbr=a,null!=u[a]?(Ha("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale"),
b=Ia(u[a]._config,b)):null!=b.parentLocale&&(null!=u[b.parentLocale]?b=Ia(u[b.parentLocale]._config,b):Ha("parentLocaleUndefined","specified parentLocale is not defined yet")),u[a]=new Ja(b),aa(a),u[a];delete u[a];return null}function P(a){var b;a&&a._locale&&a._locale._abbr&&(a=a._locale._abbr);if(!a)return oa;if(!C(a)){if(b=hb(a))return b;a=[a]}a:{b=0;for(var c,d,h,e;b<a.length;){e=gb(a[b]).split("-");c=e.length;for(d=(d=gb(a[b+1]))?d.split("-"):null;0<c;){if(h=hb(e.slice(0,c).join("-"))){a=h;break a}if(d&&
d.length>=c&&db(e,d,!0)>=c-1)break;c--}b++}a=null}return a}function x(a,b){var c=a.toLowerCase();ia[c]=ia[c+"s"]=ia[b]=a}function E(a){return"string"===typeof a?ia[a]||ia[a.toLowerCase()]:void 0}function jb(a){var b={},c,d;for(d in a)z(a,d)&&(c=E(d))&&(b[c]=a[d]);return b}function ba(a,b){return function(c){if(null!=c){if(this.isValid())this._d["set"+(this._isUTC?"UTC":"")+a](c);f.updateOffset(this,b);return this}return pa(this,a)}}function pa(a,b){return a.isValid()?a._d["get"+(a._isUTC?"UTC":"")+
b]():NaN}function kb(a,b){var c;if("object"===typeof a)for(c in a)this.set(c,a[c]);else if(a=E(a),O(this[a]))return this[a](b);return this}function J(a,b,c){var d=""+Math.abs(a);return(0<=a?c?"+":"":"-")+Math.pow(10,Math.max(0,b-d.length)).toString().substr(1)+d}function m(a,b,c,d){var h=d;"string"===typeof d&&(h=function(){return this[d]()});a&&(ca[a]=h);b&&(ca[b[0]]=function(){return J(h.apply(this,arguments),b[1],b[2])});c&&(ca[c]=function(){return this.localeData().ordinal(h.apply(this,arguments),
a)})}function Tb(a){return a.match(/\[[\s\S]/)?a.replace(/^\[|\]$/g,""):a.replace(/\\/g,"")}function Ub(a){var b=a.match(lb),c;var d=0;for(c=b.length;d<c;d++)b[d]=ca[b[d]]?ca[b[d]]:Tb(b[d]);return function(d){var h="",e;for(e=0;e<c;e++)h+=b[e]instanceof Function?b[e].call(d,a):b[e];return h}}function Ka(a,b){if(!a.isValid())return a.localeData().invalidDate();b=mb(b,a.localeData());La[b]=La[b]||Ub(b);return La[b](a)}function mb(a,b){function c(a){return b.longDateFormat(a)||a}var d=5;for(qa.lastIndex=
0;0<=d&&qa.test(a);)a=a.replace(qa,c),qa.lastIndex=0,--d;return a}function k(a,b,c){Ma[a]=O(b)?b:function(a,h){return a&&c?c:b}}function Vb(a,b){return z(Ma,a)?Ma[a](b._strict,b._locale):new RegExp(Wb(a))}function Wb(a){return V(a.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(a,c,d,h,e){return c||d||h||e}))}function V(a){return a.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function q(a,b){var c,d=b;"string"===typeof a&&(a=[a]);"number"===typeof b&&(d=function(a,c){c[b]=g(a)});
for(c=0;c<a.length;c++)Na[a[c]]=d}function ja(a,b){q(a,function(a,d,h,e){h._w=h._w||{};b(a,h._w,h,e)})}function Oa(a,b){return(new Date(Date.UTC(a,b+1,0))).getUTCDate()}function nb(a,b){if(!a.isValid())return a;if("string"===typeof b)if(/^\d+$/.test(b))b=g(b);else if(b=a.localeData().monthsParse(b),"number"!==typeof b)return a;var c=Math.min(a.date(),Oa(a.year(),b));a._d["set"+(a._isUTC?"UTC":"")+"Month"](b,c);return a}function ob(a){return null!=a?(nb(this,a),f.updateOffset(this,!0),this):pa(this,
"Month")}function pb(){function a(a,b){return b.length-a.length}var b=[],c=[],d=[],h;for(h=0;12>h;h++){var e=H([2E3,h]);b.push(this.monthsShort(e,""));c.push(this.months(e,""));d.push(this.months(e,""));d.push(this.monthsShort(e,""))}b.sort(a);c.sort(a);d.sort(a);for(h=0;12>h;h++)b[h]=V(b[h]),c[h]=V(c[h]),d[h]=V(d[h]);this._monthsShortRegex=this._monthsRegex=new RegExp("^("+d.join("|")+")","i");this._monthsStrictRegex=new RegExp("^("+c.join("|")+")","i");this._monthsShortStrictRegex=new RegExp("^("+
b.join("|")+")","i")}function Pa(a){var b;(b=a._a)&&-2===n(a).overflow&&(b=0>b[K]||11<b[K]?K:1>b[I]||b[I]>Oa(b[F],b[K])?I:0>b[v]||24<b[v]||24===b[v]&&(0!==b[G]||0!==b[L]||0!==b[W])?v:0>b[G]||59<b[G]?G:0>b[L]||59<b[L]?L:0>b[W]||999<b[W]?W:-1,n(a)._overflowDayOfYear&&(b<F||b>I)&&(b=I),n(a)._overflowWeeks&&-1===b&&(b=Xb),n(a)._overflowWeekday&&-1===b&&(b=Yb),n(a).overflow=b);return a}function qb(a){var b;var c=a._i;var d=Zb.exec(c)||$b.exec(c);if(d){n(a).iso=!0;c=0;for(b=ra.length;c<b;c++)if(ra[c][1].exec(d[1])){var h=
ra[c][0];var e=!1!==ra[c][2];break}if(null==h)a._isValid=!1;else{if(d[3]){c=0;for(b=Qa.length;c<b;c++)if(Qa[c][1].exec(d[3])){var f=(d[2]||" ")+Qa[c][0];break}if(null==f){a._isValid=!1;return}}if(e||null==f){if(d[4])if(ac.exec(d[4]))var k="Z";else{a._isValid=!1;return}a._f=h+(f||"")+(k||"");Ra(a)}else a._isValid=!1}}else a._isValid=!1}function bc(a){var b=cc.exec(a._i);null!==b?a._d=new Date(+b[1]):(qb(a),!1===a._isValid&&(delete a._isValid,f.createFromInputFallback(a)))}function dc(a,b,c,d,h,e,f){b=
new Date(a,b,c,d,h,e,f);100>a&&0<=a&&isFinite(b.getFullYear())&&b.setFullYear(a);return b}function sa(a){var b=new Date(Date.UTC.apply(null,arguments));100>a&&0<=a&&isFinite(b.getUTCFullYear())&&b.setUTCFullYear(a);return b}function da(a){return 0===a%4&&0!==a%100||0===a%400}function ta(a,b,c){c=7+b-c;return-((7+sa(a,0,c).getUTCDay()-b)%7)+c-1}function rb(a,b,c,d,h){c=(7+c-d)%7;d=ta(a,d,h);d=1+7*(b-1)+c+d;0>=d?(b=a-1,a=(da(b)?366:365)+d):d>(da(a)?366:365)?(b=a+1,a=d-(da(a)?366:365)):(b=a,a=d);return{year:b,
dayOfYear:a}}function ka(a,b,c){var d=ta(a.year(),b,c);d=Math.floor((a.dayOfYear()-d-1)/7)+1;1>d?(a=a.year()-1,b=d+X(a,b,c)):d>X(a.year(),b,c)?(b=d-X(a.year(),b,c),a=a.year()+1):(a=a.year(),b=d);return{week:b,year:a}}function X(a,b,c){var d=ta(a,b,c);b=ta(a+1,b,c);return((da(a)?366:365)-d+b)/7}function ea(a,b,c){return null!=a?a:null!=b?b:c}function Sa(a){var b=[];if(!a._d){var c=new Date(f.now());c=a._useUTC?[c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate()]:[c.getFullYear(),c.getMonth(),c.getDate()];
if(a._w&&null==a._a[I]&&null==a._a[K]){var d=a._w;if(null!=d.GG||null!=d.W||null!=d.E){var h=1;var e=4;var k=ea(d.GG,a._a[F],ka(r(),1,4).year);var m=ea(d.W,1);var l=ea(d.E,1);if(1>l||7<l)var g=!0}else if(h=a._locale._week.dow,e=a._locale._week.doy,k=ea(d.gg,a._a[F],ka(r(),h,e).year),m=ea(d.w,1),null!=d.d){if(l=d.d,0>l||6<l)g=!0}else if(null!=d.e){if(l=d.e+h,0>d.e||6<d.e)g=!0}else l=h;1>m||m>X(k,h,e)?n(a)._overflowWeeks=!0:null!=g?n(a)._overflowWeekday=!0:(g=rb(k,m,l,h,e),a._a[F]=g.year,a._dayOfYear=
g.dayOfYear)}a._dayOfYear&&(g=ea(a._a[F],c[F]),a._dayOfYear>(da(g)?366:365)&&(n(a)._overflowDayOfYear=!0),g=sa(g,0,a._dayOfYear),a._a[K]=g.getUTCMonth(),a._a[I]=g.getUTCDate());for(g=0;3>g&&null==a._a[g];++g)a._a[g]=b[g]=c[g];for(;7>g;g++)a._a[g]=b[g]=null==a._a[g]?2===g?1:0:a._a[g];24===a._a[v]&&0===a._a[G]&&0===a._a[L]&&0===a._a[W]&&(a._nextDay=!0,a._a[v]=0);a._d=(a._useUTC?sa:dc).apply(null,b);null!=a._tzm&&a._d.setUTCMinutes(a._d.getUTCMinutes()-a._tzm);a._nextDay&&(a._a[v]=24)}}function Ra(a){if(a._f===
f.ISO_8601)qb(a);else{a._a=[];n(a).empty=!0;var b=""+a._i,c,d,h=b.length,e=0;var g=mb(a._f,a._locale).match(lb)||[];for(c=0;c<g.length;c++){var k=g[c];if(d=(b.match(Vb(k,a))||[])[0]){var l=b.substr(0,b.indexOf(d));0<l.length&&n(a).unusedInput.push(l);b=b.slice(b.indexOf(d)+d.length);e+=d.length}if(ca[k]){if(d?n(a).empty=!1:n(a).unusedTokens.push(k),l=a,null!=d&&z(Na,k))Na[k](d,l._a,l,k)}else a._strict&&!d&&n(a).unusedTokens.push(k)}n(a).charsLeftOver=h-e;0<b.length&&n(a).unusedInput.push(b);!0===
n(a).bigHour&&12>=a._a[v]&&0<a._a[v]&&(n(a).bigHour=void 0);n(a).parsedDateParts=a._a.slice(0);n(a).meridiem=a._meridiem;b=a._a;c=v;h=a._locale;g=a._a[v];e=a._meridiem;null!=e&&(null!=h.meridiemHour?g=h.meridiemHour(g,e):null!=h.isPM&&((h=h.isPM(e))&&12>g&&(g+=12),h||12!==g||(g=0)));b[c]=g;Sa(a);Pa(a)}}function ec(a){if(!a._d){var b=jb(a._i);a._a=bb([b.year,b.month,b.day||b.date,b.hour,b.minute,b.second,b.millisecond],function(a){return a&&parseInt(a,10)});Sa(a)}}function sb(a){var b=a._i,c=a._f;
a._locale=a._locale||P(a._l);if(null===b||void 0===c&&""===b)return na({nullInput:!0});"string"===typeof b&&(a._i=b=a._locale.preparse(b));if(N(b))return new ha(Pa(b));if(C(c))if(0===a._f.length)n(a).invalidFormat=!0,a._d=new Date(NaN);else{for(b=0;b<a._f.length;b++){c=0;var d=Ea({},a);null!=a._useUTC&&(d._useUTC=a._useUTC);d._f=a._f[b];Ra(d);if(Da(d)&&(c+=n(d).charsLeftOver,c+=10*n(d).unusedTokens.length,n(d).score=c,null==h||c<h)){var h=c;var e=d}}U(a,e||d)}else c?Ra(a):ma(b)?a._d=b:fc(a);Da(a)||
(a._d=null);return a}function fc(a){var b=a._i;void 0===b?a._d=new Date(f.now()):ma(b)?a._d=new Date(b.valueOf()):"string"===typeof b?bc(a):C(b)?(a._a=bb(b.slice(0),function(a){return parseInt(a,10)}),Sa(a)):"object"===typeof b?ec(a):"number"===typeof b?a._d=new Date(b):f.createFromInputFallback(a)}function cb(a,b,c,d,h){var e={};"boolean"===typeof c&&(d=c,c=void 0);e._isAMomentObject=!0;e._useUTC=e._isUTC=h;e._l=c;e._i=a;e._f=b;e._strict=d;a=new ha(Pa(sb(e)));a._nextDay&&(a.add(1,"d"),a._nextDay=
void 0);return a}function r(a,b,c,d){return cb(a,b,c,d,!1)}function tb(a,b){var c;1===b.length&&C(b[0])&&(b=b[0]);if(!b.length)return r();var d=b[0];for(c=1;c<b.length;++c)if(!b[c].isValid()||b[c][a](d))d=b[c];return d}function ua(a){a=jb(a);var b=a.year||0,c=a.quarter||0,d=a.month||0,h=a.week||0,e=a.day||0;this._milliseconds=+(a.millisecond||0)+1E3*(a.second||0)+6E4*(a.minute||0)+36E5*(a.hour||0);this._days=+e+7*h;this._months=+d+3*c+12*b;this._data={};this._locale=P();this._bubble()}function Ta(a){return a instanceof
ua}function ub(a,b){m(a,0,0,function(){var a=this.utcOffset(),d="+";0>a&&(a=-a,d="-");return d+J(~~(a/60),2)+b+J(~~a%60,2)})}function Ua(a,b){a=(b||"").match(a)||[];a=((a[a.length-1]||[])+"").match(gc)||["-",0,0];b=+(60*a[1])+g(a[2]);return"+"===a[0]?b:-b}function Va(a,b){return b._isUTC?(b=b.clone(),a=(N(a)||ma(a)?a.valueOf():r(a).valueOf())-b.valueOf(),b._d.setTime(b._d.valueOf()+a),f.updateOffset(b,!1),b):r(a).local()}function vb(){return this.isValid()?this._isUTC&&0===this._offset:!1}function Q(a,
b){var c=a;Ta(a)?c={ms:a._milliseconds,d:a._days,M:a._months}:"number"===typeof a?(c={},b?c[b]=a:c.milliseconds=a):(b=hc.exec(a))?(c="-"===b[1]?-1:1,c={y:0,d:g(b[I])*c,h:g(b[v])*c,m:g(b[G])*c,s:g(b[L])*c,ms:g(b[W])*c}):(b=ic.exec(a))?(c="-"===b[1]?-1:1,c={y:Y(b[2],c),M:Y(b[3],c),w:Y(b[4],c),d:Y(b[5],c),h:Y(b[6],c),m:Y(b[7],c),s:Y(b[8],c)}):null==c?c={}:"object"===typeof c&&("from"in c||"to"in c)&&(b=r(c.from),c=r(c.to),b.isValid()&&c.isValid()?(c=Va(c,b),b.isBefore(c)?c=wb(b,c):(c=wb(c,b),c.milliseconds=
-c.milliseconds,c.months=-c.months),b=c):b={milliseconds:0,months:0},c={},c.ms=b.milliseconds,c.M=b.months);c=new ua(c);Ta(a)&&z(a,"_locale")&&(c._locale=a._locale);return c}function Y(a,b){a=a&&parseFloat(a.replace(",","."));return(isNaN(a)?0:a)*b}function wb(a,b){var c={milliseconds:0,months:0};c.months=b.month()-a.month()+12*(b.year()-a.year());a.clone().add(c.months,"M").isAfter(b)&&--c.months;c.milliseconds=+b-+a.clone().add(c.months,"M");return c}function xb(a){return 0>a?-1*Math.round(-1*a):
Math.round(a)}function yb(a,b){return function(c,d){if(null!==d&&!isNaN(+d)){Ha(b,"moment()."+b+"(period, number) is deprecated. Please use moment()."+b+"(number, period).");var h=c;c=d;d=h}c=Q("string"===typeof c?+c:c,d);zb(this,c,a);return this}}function zb(a,b,c,d){var h=b._milliseconds,e=xb(b._days);b=xb(b._months);if(a.isValid()){d=null==d?!0:d;h&&a._d.setTime(a._d.valueOf()+h*c);if(e&&(h=pa(a,"Date")+e*c,a.isValid()))a._d["set"+(a._isUTC?"UTC":"")+"Date"](h);b&&nb(a,pa(a,"Month")+b*c);d&&f.updateOffset(a,
e||b)}}function Ab(a){if(void 0===a)return this._locale._abbr;a=P(a);null!=a&&(this._locale=a);return this}function Bb(){return this._locale}function va(a,b){m(0,[a,a.length],0,b)}function Cb(a,b,c,d,h){if(null==a)return ka(this,d,h).year;var e=X(a,d,h);b>e&&(b=e);a=rb(a,b,c,d,h);a=sa(a.year,0,a.dayOfYear);this.year(a.getUTCFullYear());this.month(a.getUTCMonth());this.date(a.getUTCDate());return this}function jc(a,b,c){var d;a=a.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=
[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],d=0;7>d;++d){var e=H([2E3,1]).day(d);this._minWeekdaysParse[d]=this.weekdaysMin(e,"").toLocaleLowerCase();this._shortWeekdaysParse[d]=this.weekdaysShort(e,"").toLocaleLowerCase();this._weekdaysParse[d]=this.weekdays(e,"").toLocaleLowerCase()}if(c)b="dddd"===b?w.call(this._weekdaysParse,a):"ddd"===b?w.call(this._shortWeekdaysParse,a):w.call(this._minWeekdaysParse,a);else if("dddd"===b){b=w.call(this._weekdaysParse,a);if(-1!==b)return b;b=w.call(this._shortWeekdaysParse,
a);if(-1!==b)return b;b=w.call(this._minWeekdaysParse,a)}else if("ddd"===b){b=w.call(this._shortWeekdaysParse,a);if(-1!==b)return b;b=w.call(this._weekdaysParse,a);if(-1!==b)return b;b=w.call(this._minWeekdaysParse,a)}else{b=w.call(this._minWeekdaysParse,a);if(-1!==b)return b;b=w.call(this._weekdaysParse,a);if(-1!==b)return b;b=w.call(this._shortWeekdaysParse,a)}return-1!==b?b:null}function Wa(){function a(a,b){return b.length-a.length}var b=[],c=[],d=[],e=[],f;for(f=0;7>f;f++){var g=H([2E3,1]).day(f);
var k=this.weekdaysMin(g,"");var l=this.weekdaysShort(g,"");g=this.weekdays(g,"");b.push(k);c.push(l);d.push(g);e.push(k);e.push(l);e.push(g)}b.sort(a);c.sort(a);d.sort(a);e.sort(a);for(f=0;7>f;f++)c[f]=V(c[f]),d[f]=V(d[f]),e[f]=V(e[f]);this._weekdaysMinRegex=this._weekdaysShortRegex=this._weekdaysRegex=new RegExp("^("+e.join("|")+")","i");this._weekdaysStrictRegex=new RegExp("^("+d.join("|")+")","i");this._weekdaysShortStrictRegex=new RegExp("^("+c.join("|")+")","i");this._weekdaysMinStrictRegex=
new RegExp("^("+b.join("|")+")","i")}function Xa(){return this.hours()%12||12}function Db(a,b){m(a,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),b)})}function Eb(a,b){return b._meridiemParse}function kc(a,b){b[W]=g(1E3*("0."+a))}function Fb(a){return a}function wa(a,b,c,d){var e=P();b=H().set(d,b);return e[c](b,a)}function Gb(a,b,c){"number"===typeof a&&(b=a,a=void 0);a=a||"";if(null!=b)return wa(a,b,c,"month");var d=[];for(b=0;12>b;b++)d[b]=wa(a,b,c,"month");return d}
function Ya(a,b,c,d){"boolean"!==typeof a&&(c=b=a,a=!1);"number"===typeof b&&(c=b,b=void 0);b=b||"";var e=P();a=a?e._week.dow:0;if(null!=c)return wa(b,(c+a)%7,d,"day");e=[];for(c=0;7>c;c++)e[c]=wa(b,(c+a)%7,d,"day");return e}function Hb(a,b,c,d){b=Q(b,c);a._milliseconds+=d*b._milliseconds;a._days+=d*b._days;a._months+=d*b._months;return a._bubble()}function Ib(a){return 0>a?Math.floor(a):Math.ceil(a)}function R(a){return function(){return this.as(a)}}function Z(a){return function(){return this._data[a]}}
function lc(a,b,c,d,e){return e.relativeTime(b||1,!!c,a,d)}function xa(){var a=Za(this._milliseconds)/1E3,b=Za(this._days),c=Za(this._months);var d=A(a/60);var e=A(d/60);a%=60;d%=60;var f=A(c/12);c%=12;var g=this.asSeconds();return g?(0>g?"-":"")+"P"+(f?f+"Y":"")+(c?c+"M":"")+(b?b+"D":"")+(e||d||a?"T":"")+(e?e+"H":"")+(d?d+"M":"")+(a?a+"S":""):"P0D"}var Sb=Array.prototype.some?Array.prototype.some:function(a){for(var b=Object(this),c=b.length>>>0,d=0;d<c;d++)if(d in b&&a.call(this,b[d],d,b))return!0;
return!1};var Fa=f.momentProperties=[],Ga=!1,fb={};f.suppressDeprecationWarnings=!1;f.deprecationHandler=null;var mc=Object.keys?Object.keys:function(a){var b,c=[];for(b in a)z(a,b)&&c.push(b);return c};var u={},oa,ia={},lb=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,qa=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,La={},ca={},Jb=/\d/,B=/\d\d/,Kb=/\d{3}/,$a=/\d{4}/,
ya=/[+-]?\d{6}/,t=/\d\d?/,Lb=/\d\d\d\d?/,Mb=/\d\d\d\d\d\d?/,za=/\d{1,3}/,ab=/\d{1,4}/,Aa=/[+-]?\d{1,6}/,nc=/\d+/,Ba=/[+-]?\d+/,oc=/Z|[+-]\d\d:?\d\d/gi,Ca=/Z|[+-]\d\d(?::?\d\d)?/gi,la=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,Ma={},Na={},F=0,K=1,I=2,v=3,G=4,L=5,W=6,Xb=7,Yb=8;var w=Array.prototype.indexOf?Array.prototype.indexOf:function(a){var b;for(b=0;b<this.length;++b)if(this[b]===a)return b;return-1};m("M",["MM",2],"Mo",function(){return this.month()+
1});m("MMM",0,0,function(a){return this.localeData().monthsShort(this,a)});m("MMMM",0,0,function(a){return this.localeData().months(this,a)});x("month","M");k("M",t);k("MM",t,B);k("MMM",function(a,b){return b.monthsShortRegex(a)});k("MMMM",function(a,b){return b.monthsRegex(a)});q(["M","MM"],function(a,b){b[K]=g(a)-1});q(["MMM","MMMM"],function(a,b,c,d){d=c._locale.monthsParse(a,d,c._strict);null!=d?b[K]=d:n(c).invalidMonth=a});var Nb=/D[oD]?(\[[^\[\]]*\]|\s+)+MMMM?/,Zb=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/,
$b=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/,ac=/Z|[+-]\d\d(?::?\d\d)?/,ra=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],Qa=
[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],cc=/^\/?Date\((\-?\d+)/i;f.createFromInputFallback=D("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.",
function(a){a._d=new Date(a._i+(a._useUTC?" UTC":""))});m("Y",0,0,function(){var a=this.year();return 9999>=a?""+a:"+"+a});m(0,["YY",2],0,function(){return this.year()%100});m(0,["YYYY",4],0,"year");m(0,["YYYYY",5],0,"year");m(0,["YYYYYY",6,!0],0,"year");x("year","y");k("Y",Ba);k("YY",t,B);k("YYYY",ab,$a);k("YYYYY",Aa,ya);k("YYYYYY",Aa,ya);q(["YYYYY","YYYYYY"],F);q("YYYY",function(a,b){b[F]=2===a.length?f.parseTwoDigitYear(a):g(a)});q("YY",function(a,b){b[F]=f.parseTwoDigitYear(a)});q("Y",function(a,
b){b[F]=parseInt(a,10)});f.parseTwoDigitYear=function(a){return g(a)+(68<g(a)?1900:2E3)};var Ob=ba("FullYear",!0);f.ISO_8601=function(){};var pc=D("moment().min is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",function(){var a=r.apply(null,arguments);return this.isValid()&&a.isValid()?a<this?this:a:na()}),qc=D("moment().max is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(){var a=r.apply(null,arguments);return this.isValid()&&
a.isValid()?a>this?this:a:na()});ub("Z",":");ub("ZZ","");k("Z",Ca);k("ZZ",Ca);q(["Z","ZZ"],function(a,b,c){c._useUTC=!0;c._tzm=Ua(Ca,a)});var gc=/([\+\-]|\d\d)/gi;f.updateOffset=function(){};var hc=/^(\-)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)\.?(\d{3})?\d*)?$/,ic=/^(-)?P(?:(-?[0-9,.]*)Y)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)W)?(?:(-?[0-9,.]*)D)?(?:T(?:(-?[0-9,.]*)H)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)S)?)?$/;Q.fn=ua.prototype;var rc=yb(1,"add"),sc=yb(-1,"subtract");f.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";f.defaultFormatUtc=
"YYYY-MM-DDTHH:mm:ss[Z]";var Pb=D("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(a){return void 0===a?this.localeData():this.locale(a)});m(0,["gg",2],0,function(){return this.weekYear()%100});m(0,["GG",2],0,function(){return this.isoWeekYear()%100});va("gggg","weekYear");va("ggggg","weekYear");va("GGGG","isoWeekYear");va("GGGGG","isoWeekYear");x("weekYear","gg");x("isoWeekYear","GG");k("G",
Ba);k("g",Ba);k("GG",t,B);k("gg",t,B);k("GGGG",ab,$a);k("gggg",ab,$a);k("GGGGG",Aa,ya);k("ggggg",Aa,ya);ja(["gggg","ggggg","GGGG","GGGGG"],function(a,b,c,d){b[d.substr(0,2)]=g(a)});ja(["gg","GG"],function(a,b,c,d){b[d]=f.parseTwoDigitYear(a)});m("Q",0,"Qo","quarter");x("quarter","Q");k("Q",Jb);q("Q",function(a,b){b[K]=3*(g(a)-1)});m("w",["ww",2],"wo","week");m("W",["WW",2],"Wo","isoWeek");x("week","w");x("isoWeek","W");k("w",t);k("ww",t,B);k("W",t);k("WW",t,B);ja(["w","ww","W","WW"],function(a,b,
c,d){b[d.substr(0,1)]=g(a)});m("D",["DD",2],"Do","date");x("date","D");k("D",t);k("DD",t,B);k("Do",function(a,b){return a?b._ordinalParse:b._ordinalParseLenient});q(["D","DD"],I);q("Do",function(a,b){b[I]=g(a.match(t)[0],10)});var Qb=ba("Date",!0);m("d",0,"do","day");m("dd",0,0,function(a){return this.localeData().weekdaysMin(this,a)});m("ddd",0,0,function(a){return this.localeData().weekdaysShort(this,a)});m("dddd",0,0,function(a){return this.localeData().weekdays(this,a)});m("e",0,0,"weekday");
m("E",0,0,"isoWeekday");x("day","d");x("weekday","e");x("isoWeekday","E");k("d",t);k("e",t);k("E",t);k("dd",function(a,b){return b.weekdaysMinRegex(a)});k("ddd",function(a,b){return b.weekdaysShortRegex(a)});k("dddd",function(a,b){return b.weekdaysRegex(a)});ja(["dd","ddd","dddd"],function(a,b,c,d){d=c._locale.weekdaysParse(a,d,c._strict);null!=d?b.d=d:n(c).invalidWeekday=a});ja(["d","e","E"],function(a,b,c,d){b[d]=g(a)});m("DDD",["DDDD",3],"DDDo","dayOfYear");x("dayOfYear","DDD");k("DDD",za);k("DDDD",
Kb);q(["DDD","DDDD"],function(a,b,c){c._dayOfYear=g(a)});m("H",["HH",2],0,"hour");m("h",["hh",2],0,Xa);m("k",["kk",2],0,function(){return this.hours()||24});m("hmm",0,0,function(){return""+Xa.apply(this)+J(this.minutes(),2)});m("hmmss",0,0,function(){return""+Xa.apply(this)+J(this.minutes(),2)+J(this.seconds(),2)});m("Hmm",0,0,function(){return""+this.hours()+J(this.minutes(),2)});m("Hmmss",0,0,function(){return""+this.hours()+J(this.minutes(),2)+J(this.seconds(),2)});Db("a",!0);Db("A",!1);x("hour",
"h");k("a",Eb);k("A",Eb);k("H",t);k("h",t);k("HH",t,B);k("hh",t,B);k("hmm",Lb);k("hmmss",Mb);k("Hmm",Lb);k("Hmmss",Mb);q(["H","HH"],v);q(["a","A"],function(a,b,c){c._isPm=c._locale.isPM(a);c._meridiem=a});q(["h","hh"],function(a,b,c){b[v]=g(a);n(c).bigHour=!0});q("hmm",function(a,b,c){var d=a.length-2;b[v]=g(a.substr(0,d));b[G]=g(a.substr(d));n(c).bigHour=!0});q("hmmss",function(a,b,c){var d=a.length-4,e=a.length-2;b[v]=g(a.substr(0,d));b[G]=g(a.substr(d,2));b[L]=g(a.substr(e));n(c).bigHour=!0});
q("Hmm",function(a,b,c){c=a.length-2;b[v]=g(a.substr(0,c));b[G]=g(a.substr(c))});q("Hmmss",function(a,b,c){c=a.length-4;var d=a.length-2;b[v]=g(a.substr(0,c));b[G]=g(a.substr(c,2));b[L]=g(a.substr(d))});var tc=ba("Hours",!0);m("m",["mm",2],0,"minute");x("minute","m");k("m",t);k("mm",t,B);q(["m","mm"],G);var uc=ba("Minutes",!1);m("s",["ss",2],0,"second");x("second","s");k("s",t);k("ss",t,B);q(["s","ss"],L);var vc=ba("Seconds",!1);m("S",0,0,function(){return~~(this.millisecond()/100)});m(0,["SS",2],
0,function(){return~~(this.millisecond()/10)});m(0,["SSS",3],0,"millisecond");m(0,["SSSS",4],0,function(){return 10*this.millisecond()});m(0,["SSSSS",5],0,function(){return 100*this.millisecond()});m(0,["SSSSSS",6],0,function(){return 1E3*this.millisecond()});m(0,["SSSSSSS",7],0,function(){return 1E4*this.millisecond()});m(0,["SSSSSSSS",8],0,function(){return 1E5*this.millisecond()});m(0,["SSSSSSSSS",9],0,function(){return 1E6*this.millisecond()});x("millisecond","ms");k("S",za,Jb);k("SS",za,B);k("SSS",
za,Kb);var S;for(S="SSSS";9>=S.length;S+="S")k(S,nc);for(S="S";9>=S.length;S+="S")q(S,kc);var wc=ba("Milliseconds",!1);m("z",0,0,"zoneAbbr");m("zz",0,0,"zoneName");var e=ha.prototype;e.add=rc;e.calendar=function(a,b){a=a||r();var c=Va(a,this).startOf("day");c=this.diff(c,"days",!0);c=-6>c?"sameElse":-1>c?"lastWeek":0>c?"lastDay":1>c?"sameDay":2>c?"nextDay":7>c?"nextWeek":"sameElse";b=b&&(O(b[c])?b[c]():b[c]);return this.format(b||this.localeData().calendar(c,this,r(a)))};e.clone=function(){return new ha(this)};
e.diff=function(a,b,c){if(!this.isValid())return NaN;a=Va(a,this);if(!a.isValid())return NaN;var d=6E4*(a.utcOffset()-this.utcOffset());b=E(b);if("year"===b||"month"===b||"quarter"===b){d=12*(a.year()-this.year())+(a.month()-this.month());var e=this.clone().add(d,"months");if(0>a-e){var f=this.clone().add(d-1,"months");a=(a-e)/(e-f)}else f=this.clone().add(d+1,"months"),a=(a-e)/(f-e);a=-(d+a)||0;"quarter"===b?a/=3:"year"===b&&(a/=12)}else a=this-a,a="second"===b?a/1E3:"minute"===b?a/6E4:"hour"===
b?a/36E5:"day"===b?(a-d)/864E5:"week"===b?(a-d)/6048E5:a;return c?a:A(a)};e.endOf=function(a){a=E(a);if(void 0===a||"millisecond"===a)return this;"date"===a&&(a="day");return this.startOf(a).add(1,"isoWeek"===a?"week":a).subtract(1,"ms")};e.format=function(a){a||(a=this.isUtc()?f.defaultFormatUtc:f.defaultFormat);a=Ka(this,a);return this.localeData().postformat(a)};e.from=function(a,b){return this.isValid()&&(N(a)&&a.isValid()||r(a).isValid())?Q({to:this,from:a}).locale(this.locale()).humanize(!b):
this.localeData().invalidDate()};e.fromNow=function(a){return this.from(r(),a)};e.to=function(a,b){return this.isValid()&&(N(a)&&a.isValid()||r(a).isValid())?Q({from:this,to:a}).locale(this.locale()).humanize(!b):this.localeData().invalidDate()};e.toNow=function(a){return this.to(r(),a)};e.get=kb;e.invalidAt=function(){return n(this).overflow};e.isAfter=function(a,b){a=N(a)?a:r(a);if(!this.isValid()||!a.isValid())return!1;b=E(y(b)?"millisecond":b);return"millisecond"===b?this.valueOf()>a.valueOf():
a.valueOf()<this.clone().startOf(b).valueOf()};e.isBefore=function(a,b){a=N(a)?a:r(a);if(!this.isValid()||!a.isValid())return!1;b=E(y(b)?"millisecond":b);return"millisecond"===b?this.valueOf()<a.valueOf():this.clone().endOf(b).valueOf()<a.valueOf()};e.isBetween=function(a,b,c,d){d=d||"()";return("("===d[0]?this.isAfter(a,c):!this.isBefore(a,c))&&(")"===d[1]?this.isBefore(b,c):!this.isAfter(b,c))};e.isSame=function(a,b){a=N(a)?a:r(a);if(!this.isValid()||!a.isValid())return!1;b=E(b||"millisecond");
if("millisecond"===b)return this.valueOf()===a.valueOf();a=a.valueOf();return this.clone().startOf(b).valueOf()<=a&&a<=this.clone().endOf(b).valueOf()};e.isSameOrAfter=function(a,b){return this.isSame(a,b)||this.isAfter(a,b)};e.isSameOrBefore=function(a,b){return this.isSame(a,b)||this.isBefore(a,b)};e.isValid=function(){return Da(this)};e.lang=Pb;e.locale=Ab;e.localeData=Bb;e.max=qc;e.min=pc;e.parsingFlags=function(){return U({},n(this))};e.set=kb;e.startOf=function(a){a=E(a);switch(a){case "year":this.month(0);
case "quarter":case "month":this.date(1);case "week":case "isoWeek":case "day":case "date":this.hours(0);case "hour":this.minutes(0);case "minute":this.seconds(0);case "second":this.milliseconds(0)}"week"===a&&this.weekday(0);"isoWeek"===a&&this.isoWeekday(1);"quarter"===a&&this.month(3*Math.floor(this.month()/3));return this};e.subtract=sc;e.toArray=function(){return[this.year(),this.month(),this.date(),this.hour(),this.minute(),this.second(),this.millisecond()]};e.toObject=function(){return{years:this.year(),
months:this.month(),date:this.date(),hours:this.hours(),minutes:this.minutes(),seconds:this.seconds(),milliseconds:this.milliseconds()}};e.toDate=function(){return this._offset?new Date(this.valueOf()):this._d};e.toISOString=function(){var a=this.clone().utc();return 0<a.year()&&9999>=a.year()?O(Date.prototype.toISOString)?this.toDate().toISOString():Ka(a,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):Ka(a,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")};e.toJSON=function(){return this.isValid()?this.toISOString():null};e.toString=
function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")};e.unix=function(){return Math.floor(this.valueOf()/1E3)};e.valueOf=function(){return this._d.valueOf()-6E4*(this._offset||0)};e.creationData=function(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}};e.year=Ob;e.isLeapYear=function(){return da(this.year())};e.weekYear=function(a){return Cb.call(this,a,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)};
e.isoWeekYear=function(a){return Cb.call(this,a,this.isoWeek(),this.isoWeekday(),1,4)};e.quarter=e.quarters=function(a){return null==a?Math.ceil((this.month()+1)/3):this.month(3*(a-1)+this.month()%3)};e.month=ob;e.daysInMonth=function(){return Oa(this.year(),this.month())};e.week=e.weeks=function(a){var b=this.localeData().week(this);return null==a?b:this.add(7*(a-b),"d")};e.isoWeek=e.isoWeeks=function(a){var b=ka(this,1,4).week;return null==a?b:this.add(7*(a-b),"d")};e.weeksInYear=function(){var a=
this.localeData()._week;return X(this.year(),a.dow,a.doy)};e.isoWeeksInYear=function(){return X(this.year(),1,4)};e.date=Qb;e.day=e.days=function(a){if(!this.isValid())return null!=a?this:NaN;var b=this._isUTC?this._d.getUTCDay():this._d.getDay();if(null!=a){var c=this.localeData();"string"===typeof a&&(isNaN(a)?(a=c.weekdaysParse(a),a="number"===typeof a?a:null):a=parseInt(a,10));return this.add(a-b,"d")}return b};e.weekday=function(a){if(!this.isValid())return null!=a?this:NaN;var b=(this.day()+
7-this.localeData()._week.dow)%7;return null==a?b:this.add(a-b,"d")};e.isoWeekday=function(a){return this.isValid()?null==a?this.day()||7:this.day(this.day()%7?a:a-7):null!=a?this:NaN};e.dayOfYear=function(a){var b=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864E5)+1;return null==a?b:this.add(a-b,"d")};e.hour=e.hours=tc;e.minute=e.minutes=uc;e.second=e.seconds=vc;e.millisecond=e.milliseconds=wc;e.utcOffset=function(a,b){var c=this._offset||0,d;return this.isValid()?null!=
a?("string"===typeof a?a=Ua(Ca,a):16>Math.abs(a)&&(a*=60),!this._isUTC&&b&&(d=15*-Math.round(this._d.getTimezoneOffset()/15)),this._offset=a,this._isUTC=!0,null!=d&&this.add(d,"m"),c!==a&&(!b||this._changeInProgress?zb(this,Q(a-c,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,f.updateOffset(this,!0),this._changeInProgress=null)),this):this._isUTC?c:15*-Math.round(this._d.getTimezoneOffset()/15):null!=a?this:NaN};e.utc=function(a){return this.utcOffset(0,a)};e.local=function(a){this._isUTC&&
(this.utcOffset(0,a),this._isUTC=!1,a&&this.subtract(15*-Math.round(this._d.getTimezoneOffset()/15),"m"));return this};e.parseZone=function(){this._tzm?this.utcOffset(this._tzm):"string"===typeof this._i&&this.utcOffset(Ua(oc,this._i));return this};e.hasAlignedHourOffset=function(a){if(!this.isValid())return!1;a=a?r(a).utcOffset():0;return 0===(this.utcOffset()-a)%60};e.isDST=function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()};
e.isDSTShifted=function(){if(!y(this._isDSTShifted))return this._isDSTShifted;var a={};Ea(a,this);a=sb(a);if(a._a){var b=a._isUTC?H(a._a):r(a._a);this._isDSTShifted=this.isValid()&&0<db(a._a,b.toArray())}else this._isDSTShifted=!1;return this._isDSTShifted};e.isLocal=function(){return this.isValid()?!this._isUTC:!1};e.isUtcOffset=function(){return this.isValid()?this._isUTC:!1};e.isUtc=vb;e.isUTC=vb;e.zoneAbbr=function(){return this._isUTC?"UTC":""};e.zoneName=function(){return this._isUTC?"Coordinated Universal Time":
""};e.dates=D("dates accessor is deprecated. Use date instead.",Qb);e.months=D("months accessor is deprecated. Use month instead",ob);e.years=D("years accessor is deprecated. Use year instead",Ob);e.zone=D("moment().zone is deprecated, use moment().utcOffset instead. https://github.com/moment/moment/issues/1779",function(a,b){return null!=a?("string"!==typeof a&&(a=-a),this.utcOffset(a,b),this):-this.utcOffset()});var l=Ja.prototype;l._calendar={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",
nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};l.calendar=function(a,b,c){a=this._calendar[a];return O(a)?a.call(b,c):a};l._longDateFormat={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};l.longDateFormat=function(a){var b=this._longDateFormat[a],c=this._longDateFormat[a.toUpperCase()];if(b||!c)return b;this._longDateFormat[a]=c.replace(/MMMM|MM|DD|dddd/g,function(a){return a.slice(1)});
return this._longDateFormat[a]};l._invalidDate="Invalid date";l.invalidDate=function(){return this._invalidDate};l._ordinal="%d";l.ordinal=function(a){return this._ordinal.replace("%d",a)};l._ordinalParse=/\d{1,2}/;l.preparse=Fb;l.postformat=Fb;l._relativeTime={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};l.relativeTime=function(a,b,c,d){var e=this._relativeTime[c];
return O(e)?e(a,b,c,d):e.replace(/%d/i,a)};l.pastFuture=function(a,b){a=this._relativeTime[0<a?"future":"past"];return O(a)?a(b):a.replace(/%s/i,b)};l.set=function(a){var b;for(b in a){var c=a[b];O(c)?this[b]=c:this["_"+b]=c}this._config=a;this._ordinalParseLenient=new RegExp(this._ordinalParse.source+"|"+/\d{1,2}/.source)};l.months=function(a,b){return C(this._months)?this._months[a.month()]:this._months[Nb.test(b)?"format":"standalone"][a.month()]};l._months="January February March April May June July August September October November December".split(" ");
l.monthsShort=function(a,b){return C(this._monthsShort)?this._monthsShort[a.month()]:this._monthsShort[Nb.test(b)?"format":"standalone"][a.month()]};l._monthsShort="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ");l.monthsParse=function(a,b,c){var d;if(this._monthsParseExact){a:{a=a.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],d=0;12>d;++d){var e=H([2E3,d]);this._shortMonthsParse[d]=this.monthsShort(e,"").toLocaleLowerCase();
this._longMonthsParse[d]=this.months(e,"").toLocaleLowerCase()}if(c)b="MMM"===b?w.call(this._shortMonthsParse,a):w.call(this._longMonthsParse,a);else if("MMM"===b){b=w.call(this._shortMonthsParse,a);if(-1!==b)break a;b=w.call(this._longMonthsParse,a)}else{b=w.call(this._longMonthsParse,a);if(-1!==b)break a;b=w.call(this._shortMonthsParse,a)}b=-1!==b?b:null}return b}this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]);for(d=0;12>d;d++)if(e=H([2E3,d]),c&&!this._longMonthsParse[d]&&
(this._longMonthsParse[d]=new RegExp("^"+this.months(e,"").replace(".","")+"$","i"),this._shortMonthsParse[d]=new RegExp("^"+this.monthsShort(e,"").replace(".","")+"$","i")),c||this._monthsParse[d]||(e="^"+this.months(e,"")+"|^"+this.monthsShort(e,""),this._monthsParse[d]=new RegExp(e.replace(".",""),"i")),c&&"MMMM"===b&&this._longMonthsParse[d].test(a)||c&&"MMM"===b&&this._shortMonthsParse[d].test(a)||!c&&this._monthsParse[d].test(a))return d};l._monthsRegex=la;l.monthsRegex=function(a){return this._monthsParseExact?
(z(this,"_monthsRegex")||pb.call(this),a?this._monthsStrictRegex:this._monthsRegex):this._monthsStrictRegex&&a?this._monthsStrictRegex:this._monthsRegex};l._monthsShortRegex=la;l.monthsShortRegex=function(a){return this._monthsParseExact?(z(this,"_monthsRegex")||pb.call(this),a?this._monthsShortStrictRegex:this._monthsShortRegex):this._monthsShortStrictRegex&&a?this._monthsShortStrictRegex:this._monthsShortRegex};l.week=function(a){return ka(a,this._week.dow,this._week.doy).week};l._week={dow:0,doy:6};
l.firstDayOfYear=function(){return this._week.doy};l.firstDayOfWeek=function(){return this._week.dow};l.weekdays=function(a,b){return C(this._weekdays)?this._weekdays[a.day()]:this._weekdays[this._weekdays.isFormat.test(b)?"format":"standalone"][a.day()]};l._weekdays="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" ");l.weekdaysMin=function(a){return this._weekdaysMin[a.day()]};l._weekdaysMin="Su Mo Tu We Th Fr Sa".split(" ");l.weekdaysShort=function(a){return this._weekdaysShort[a.day()]};
l._weekdaysShort="Sun Mon Tue Wed Thu Fri Sat".split(" ");l.weekdaysParse=function(a,b,c){var d;if(this._weekdaysParseExact)return jc.call(this,a,b,c);this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]);for(d=0;7>d;d++){var e=H([2E3,1]).day(d);c&&!this._fullWeekdaysParse[d]&&(this._fullWeekdaysParse[d]=new RegExp("^"+this.weekdays(e,"").replace(".",".?")+"$","i"),this._shortWeekdaysParse[d]=new RegExp("^"+this.weekdaysShort(e,
"").replace(".",".?")+"$","i"),this._minWeekdaysParse[d]=new RegExp("^"+this.weekdaysMin(e,"").replace(".",".?")+"$","i"));this._weekdaysParse[d]||(e="^"+this.weekdays(e,"")+"|^"+this.weekdaysShort(e,"")+"|^"+this.weekdaysMin(e,""),this._weekdaysParse[d]=new RegExp(e.replace(".",""),"i"));if(c&&"dddd"===b&&this._fullWeekdaysParse[d].test(a)||c&&"ddd"===b&&this._shortWeekdaysParse[d].test(a)||c&&"dd"===b&&this._minWeekdaysParse[d].test(a)||!c&&this._weekdaysParse[d].test(a))return d}};l._weekdaysRegex=
la;l.weekdaysRegex=function(a){return this._weekdaysParseExact?(z(this,"_weekdaysRegex")||Wa.call(this),a?this._weekdaysStrictRegex:this._weekdaysRegex):this._weekdaysStrictRegex&&a?this._weekdaysStrictRegex:this._weekdaysRegex};l._weekdaysShortRegex=la;l.weekdaysShortRegex=function(a){return this._weekdaysParseExact?(z(this,"_weekdaysRegex")||Wa.call(this),a?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):this._weekdaysShortStrictRegex&&a?this._weekdaysShortStrictRegex:this._weekdaysShortRegex};
l._weekdaysMinRegex=la;l.weekdaysMinRegex=function(a){return this._weekdaysParseExact?(z(this,"_weekdaysRegex")||Wa.call(this),a?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):this._weekdaysMinStrictRegex&&a?this._weekdaysMinStrictRegex:this._weekdaysMinRegex};l.isPM=function(a){return"p"===(a+"").toLowerCase().charAt(0)};l._meridiemParse=/[ap]\.?m?\.?/i;l.meridiem=function(a,b,c){return 11<a?c?"pm":"PM":c?"am":"AM"};aa("en",{ordinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(a){var b=a%10;
b=1===g(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return a+b}});f.lang=D("moment.lang is deprecated. Use moment.locale instead.",aa);f.langData=D("moment.langData is deprecated. Use moment.localeData instead.",P);var M=Math.abs,xc=R("ms"),yc=R("s"),zc=R("m"),Ac=R("h"),Bc=R("d"),Cc=R("w"),Dc=R("M"),Ec=R("y"),Fc=Z("milliseconds"),Gc=Z("seconds"),Hc=Z("minutes"),Ic=Z("hours"),Jc=Z("days"),Kc=Z("months"),Lc=Z("years"),fa=Math.round,T={s:45,m:45,h:22,d:26,M:11},Za=Math.abs,p=ua.prototype;p.abs=
function(){var a=this._data;this._milliseconds=M(this._milliseconds);this._days=M(this._days);this._months=M(this._months);a.milliseconds=M(a.milliseconds);a.seconds=M(a.seconds);a.minutes=M(a.minutes);a.hours=M(a.hours);a.months=M(a.months);a.years=M(a.years);return this};p.add=function(a,b){return Hb(this,a,b,1)};p.subtract=function(a,b){return Hb(this,a,b,-1)};p.as=function(a){var b=this._milliseconds;a=E(a);if("month"===a||"year"===a){var c=this._days+b/864E5;c=this._months+4800*c/146097;return"month"===
a?c:c/12}c=this._days+Math.round(146097*this._months/4800);switch(a){case "week":return c/7+b/6048E5;case "day":return c+b/864E5;case "hour":return 24*c+b/36E5;case "minute":return 1440*c+b/6E4;case "second":return 86400*c+b/1E3;case "millisecond":return Math.floor(864E5*c)+b;default:throw Error("Unknown unit "+a);}};p.asMilliseconds=xc;p.asSeconds=yc;p.asMinutes=zc;p.asHours=Ac;p.asDays=Bc;p.asWeeks=Cc;p.asMonths=Dc;p.asYears=Ec;p.valueOf=function(){return this._milliseconds+864E5*this._days+this._months%
12*2592E6+31536E6*g(this._months/12)};p._bubble=function(){var a=this._milliseconds,b=this._days,c=this._months,d=this._data;0<=a&&0<=b&&0<=c||0>=a&&0>=b&&0>=c||(a+=864E5*Ib(146097*c/4800+b),c=b=0);d.milliseconds=a%1E3;a=A(a/1E3);d.seconds=a%60;a=A(a/60);d.minutes=a%60;a=A(a/60);d.hours=a%24;b+=A(a/24);a=A(4800*b/146097);c+=a;b-=Ib(146097*a/4800);a=A(c/12);d.days=b;d.months=c%12;d.years=a;return this};p.get=function(a){a=E(a);return this[a+"s"]()};p.milliseconds=Fc;p.seconds=Gc;p.minutes=Hc;p.hours=
Ic;p.days=Jc;p.weeks=function(){return A(this.days()/7)};p.months=Kc;p.years=Lc;p.humanize=function(a){var b=this.localeData();var c=!a;var d=Q(this).abs(),e=fa(d.as("s")),f=fa(d.as("m")),g=fa(d.as("h")),k=fa(d.as("d")),l=fa(d.as("M"));d=fa(d.as("y"));e=e<T.s&&["s",e]||1>=f&&["m"]||f<T.m&&["mm",f]||1>=g&&["h"]||g<T.h&&["hh",g]||1>=k&&["d"]||k<T.d&&["dd",k]||1>=l&&["M"]||l<T.M&&["MM",l]||1>=d&&["y"]||["yy",d];e[2]=c;e[3]=0<+this;e[4]=b;c=lc.apply(null,e);a&&(c=b.pastFuture(+this,c));return b.postformat(c)};
p.toISOString=xa;p.toString=xa;p.toJSON=xa;p.locale=Ab;p.localeData=Bb;p.toIsoString=D("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",xa);p.lang=Pb;m("X",0,0,"unix");m("x",0,0,"valueOf");k("x",Ba);k("X",/[+-]?\d+(\.\d{1,3})?/);q("X",function(a,b,c){c._d=new Date(1E3*parseFloat(a,10))});q("x",function(a,b,c){c._d=new Date(g(a))});f.version="2.13.0";var Rb=r;f.fn=e;f.min=function(){var a=[].slice.call(arguments,0);return tb("isBefore",a)};f.max=function(){var a=
[].slice.call(arguments,0);return tb("isAfter",a)};f.now=function(){return Date.now?Date.now():+new Date};f.utc=H;f.unix=function(a){return r(1E3*a)};f.months=function(a,b){return Gb(a,b,"months")};f.isDate=ma;f.locale=aa;f.invalid=na;f.duration=Q;f.isMoment=N;f.weekdays=function(a,b,c){return Ya(a,b,c,"weekdays")};f.parseZone=function(){return r.apply(null,arguments).parseZone()};f.localeData=P;f.isDuration=Ta;f.monthsShort=function(a,b){return Gb(a,b,"monthsShort")};f.weekdaysMin=function(a,b,c){return Ya(a,
b,c,"weekdaysMin")};f.defineLocale=ib;f.updateLocale=function(a,b){null!=b?(null!=u[a]&&(b=Ia(u[a]._config,b)),b=new Ja(b),b.parentLocale=u[a],u[a]=b,aa(a)):null!=u[a]&&(null!=u[a].parentLocale?u[a]=u[a].parentLocale:null!=u[a]&&delete u[a]);return u[a]};f.locales=function(){return mc(u)};f.weekdaysShort=function(a,b,c){return Ya(a,b,c,"weekdaysShort")};f.normalizeUnits=E;f.relativeTimeThreshold=function(a,b){if(void 0===T[a])return!1;if(void 0===b)return T[a];T[a]=b;return!0};f.prototype=e;return f});
;
"en"==cabinetLanguage&&function(d,a){"object"===typeof exports&&"undefined"!==typeof module&&"function"===typeof require?a(require("../moment")):"function"===typeof define&&define.amd?define(["moment"],a):a(d.moment)}(this,function(d){return d.defineLocale("en-gb",{months:"January February March April May June July August September October November December".split(" "),monthsShort:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),weekdays:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),
    weekdaysShort:"Sun Mon Tue Wed Thu Fri Sat".split(" "),weekdaysMin:"Su Mo Tu We Th Fr Sa".split(" "),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",
        d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},ordinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(a){var b=a%10;return a+(1===~~(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th")},week:{dow:1,doy:4}})});
"ua"==cabinetLanguage&&function(d,a){"object"===typeof exports&&"undefined"!==typeof module&&"function"===typeof require?a(require("../moment")):"function"===typeof define&&define.amd?define(["moment"],a):a(d.moment)}(this,function(d){function a(a,e,f){if("m"===f)return e?"\u0445\u0432\u0438\u043b\u0438\u043d\u0430":"\u0445\u0432\u0438\u043b\u0438\u043d\u0443";if("h"===f)return e?"\u0433\u043e\u0434\u0438\u043d\u0430":"\u0433\u043e\u0434\u0438\u043d\u0443";var c=+a;e={mm:e?"\u0445\u0432\u0438\u043b\u0438\u043d\u0430_\u0445\u0432\u0438\u043b\u0438\u043d\u0438_\u0445\u0432\u0438\u043b\u0438\u043d":
        "\u0445\u0432\u0438\u043b\u0438\u043d\u0443_\u0445\u0432\u0438\u043b\u0438\u043d\u0438_\u0445\u0432\u0438\u043b\u0438\u043d",hh:e?"\u0433\u043e\u0434\u0438\u043d\u0430_\u0433\u043e\u0434\u0438\u043d\u0438_\u0433\u043e\u0434\u0438\u043d":"\u0433\u043e\u0434\u0438\u043d\u0443_\u0433\u043e\u0434\u0438\u043d\u0438_\u0433\u043e\u0434\u0438\u043d",dd:"\u0434\u0435\u043d\u044c_\u0434\u043d\u0456_\u0434\u043d\u0456\u0432",MM:"\u043c\u0456\u0441\u044f\u0446\u044c_\u043c\u0456\u0441\u044f\u0446\u0456_\u043c\u0456\u0441\u044f\u0446\u0456\u0432",
    yy:"\u0440\u0456\u043a_\u0440\u043e\u043a\u0438_\u0440\u043e\u043a\u0456\u0432"}[f].split("_");return a+" "+(1===c%10&&11!==c%100?e[0]:2<=c%10&&4>=c%10&&(10>c%100||20<=c%100)?e[1]:e[2])}function b(c){return function(){return c+"\u043e"+(11===this.hours()?"\u0431":"")+"] LT"}}return d.defineLocale("uk",{months:{format:"\u0441\u0456\u0447\u043d\u044f \u043b\u044e\u0442\u043e\u0433\u043e \u0431\u0435\u0440\u0435\u0437\u043d\u044f \u043a\u0432\u0456\u0442\u043d\u044f \u0442\u0440\u0430\u0432\u043d\u044f \u0447\u0435\u0440\u0432\u043d\u044f \u043b\u0438\u043f\u043d\u044f \u0441\u0435\u0440\u043f\u043d\u044f \u0432\u0435\u0440\u0435\u0441\u043d\u044f \u0436\u043e\u0432\u0442\u043d\u044f \u043b\u0438\u0441\u0442\u043e\u043f\u0430\u0434\u0430 \u0433\u0440\u0443\u0434\u043d\u044f".split(" "),
        standalone:"\u0421\u0456\u0447\u0435\u043d\u044c \u041b\u044e\u0442\u0438\u0439 \u0411\u0435\u0440\u0435\u0437\u0435\u043d\u044c \u041a\u0432\u0456\u0442\u0435\u043d\u044c \u0422\u0440\u0430\u0432\u0435\u043d\u044c \u0427\u0435\u0440\u0432\u0435\u043d\u044c \u041b\u0438\u043f\u0435\u043d\u044c \u0421\u0435\u0440\u043f\u0435\u043d\u044c \u0412\u0435\u0440\u0435\u0441\u0435\u043d\u044c \u0416\u043e\u0432\u0442\u0435\u043d\u044c \u041b\u0438\u0441\u0442\u043e\u043f\u0430\u0434 \u0413\u0440\u0443\u0434\u0435\u043d\u044c".split(" ")},
    monthsShort:"\u0441\u0456\u0447 \u043b\u044e\u0442 \u0431\u0435\u0440 \u043a\u0432\u0456\u0442 \u0442\u0440\u0430\u0432 \u0447\u0435\u0440\u0432 \u043b\u0438\u043f \u0441\u0435\u0440\u043f \u0432\u0435\u0440 \u0436\u043e\u0432\u0442 \u043b\u0438\u0441\u0442 \u0433\u0440\u0443\u0434".split(" "),weekdays:function(c,a){return{nominative:"\u043d\u0435\u0434\u0456\u043b\u044f \u043f\u043e\u043d\u0435\u0434\u0456\u043b\u043e\u043a \u0432\u0456\u0432\u0442\u043e\u0440\u043e\u043a \u0441\u0435\u0440\u0435\u0434\u0430 \u0447\u0435\u0442\u0432\u0435\u0440 \u043f\u2019\u044f\u0442\u043d\u0438\u0446\u044f \u0441\u0443\u0431\u043e\u0442\u0430".split(" "),
        accusative:"\u043d\u0435\u0434\u0456\u043b\u044e \u043f\u043e\u043d\u0435\u0434\u0456\u043b\u043e\u043a \u0432\u0456\u0432\u0442\u043e\u0440\u043e\u043a \u0441\u0435\u0440\u0435\u0434\u0443 \u0447\u0435\u0442\u0432\u0435\u0440 \u043f\u2019\u044f\u0442\u043d\u0438\u0446\u044e \u0441\u0443\u0431\u043e\u0442\u0443".split(" "),genitive:"\u043d\u0435\u0434\u0456\u043b\u0456 \u043f\u043e\u043d\u0435\u0434\u0456\u043b\u043a\u0430 \u0432\u0456\u0432\u0442\u043e\u0440\u043a\u0430 \u0441\u0435\u0440\u0435\u0434\u0438 \u0447\u0435\u0442\u0432\u0435\u0440\u0433\u0430 \u043f\u2019\u044f\u0442\u043d\u0438\u0446\u0456 \u0441\u0443\u0431\u043e\u0442\u0438".split(" ")}[/(\[[\u0412\u0432\u0423\u0443]\]) ?dddd/.test(a)?
        "accusative":/\[?(?:\u043c\u0438\u043d\u0443\u043b\u043e\u0457|\u043d\u0430\u0441\u0442\u0443\u043f\u043d\u043e\u0457)? ?\] ?dddd/.test(a)?"genitive":"nominative"][c.day()]},weekdaysShort:"\u043d\u0434 \u043f\u043d \u0432\u0442 \u0441\u0440 \u0447\u0442 \u043f\u0442 \u0441\u0431".split(" "),weekdaysMin:"\u043d\u0434 \u043f\u043d \u0432\u0442 \u0441\u0440 \u0447\u0442 \u043f\u0442 \u0441\u0431".split(" "),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY \u0440.",LLL:"D MMMM YYYY \u0440., HH:mm",
        LLLL:"dddd, D MMMM YYYY \u0440., HH:mm"},calendar:{sameDay:b("[\u0421\u044c\u043e\u0433\u043e\u0434\u043d\u0456 "),nextDay:b("[\u0417\u0430\u0432\u0442\u0440\u0430 "),lastDay:b("[\u0412\u0447\u043e\u0440\u0430 "),nextWeek:b("[\u0423] dddd ["),lastWeek:function(){switch(this.day()){case 0:case 3:case 5:case 6:return b("[\u041c\u0438\u043d\u0443\u043b\u043e\u0457] dddd [").call(this);case 1:case 2:case 4:return b("[\u041c\u0438\u043d\u0443\u043b\u043e\u0433\u043e] dddd [").call(this)}},sameElse:"L"},
    relativeTime:{future:"\u0437\u0430 %s",past:"%s \u0442\u043e\u043c\u0443",s:"\u0434\u0435\u043a\u0456\u043b\u044c\u043a\u0430 \u0441\u0435\u043a\u0443\u043d\u0434",m:a,mm:a,h:"\u0433\u043e\u0434\u0438\u043d\u0443",hh:a,d:"\u0434\u0435\u043d\u044c",dd:a,M:"\u043c\u0456\u0441\u044f\u0446\u044c",MM:a,y:"\u0440\u0456\u043a",yy:a},meridiemParse:/\u043d\u043e\u0447\u0456|\u0440\u0430\u043d\u043a\u0443|\u0434\u043d\u044f|\u0432\u0435\u0447\u043e\u0440\u0430/,isPM:function(a){return/^(\u0434\u043d\u044f|\u0432\u0435\u0447\u043e\u0440\u0430)$/.test(a)},
    meridiem:function(a,b,f){return 4>a?"\u043d\u043e\u0447\u0456":12>a?"\u0440\u0430\u043d\u043a\u0443":17>a?"\u0434\u043d\u044f":"\u0432\u0435\u0447\u043e\u0440\u0430"},ordinalParse:/\d{1,2}-(\u0439|\u0433\u043e)/,ordinal:function(a,b){switch(b){case "M":case "d":case "DDD":case "w":case "W":return a+"-\u0439";case "D":return a+"-\u0433\u043e";default:return a}},week:{dow:1,doy:7}})});
"ru"==cabinetLanguage&&function(d,a){"object"===typeof exports&&"undefined"!==typeof module&&"function"===typeof require?a(require("../moment")):"function"===typeof define&&define.amd?define(["moment"],a):a(d.moment)}(this,function(d){function a(a,b,f){if("m"===f)return b?"\u043c\u0438\u043d\u0443\u0442\u0430":"\u043c\u0438\u043d\u0443\u0442\u0443";var c=+a;b={mm:b?"\u043c\u0438\u043d\u0443\u0442\u0430_\u043c\u0438\u043d\u0443\u0442\u044b_\u043c\u0438\u043d\u0443\u0442":"\u043c\u0438\u043d\u0443\u0442\u0443_\u043c\u0438\u043d\u0443\u0442\u044b_\u043c\u0438\u043d\u0443\u0442",
    hh:"\u0447\u0430\u0441_\u0447\u0430\u0441\u0430_\u0447\u0430\u0441\u043e\u0432",dd:"\u0434\u0435\u043d\u044c_\u0434\u043d\u044f_\u0434\u043d\u0435\u0439",MM:"\u043c\u0435\u0441\u044f\u0446_\u043c\u0435\u0441\u044f\u0446\u0430_\u043c\u0435\u0441\u044f\u0446\u0435\u0432",yy:"\u0433\u043e\u0434_\u0433\u043e\u0434\u0430_\u043b\u0435\u0442"}[f].split("_");return a+" "+(1===c%10&&11!==c%100?b[0]:2<=c%10&&4>=c%10&&(10>c%100||20<=c%100)?b[1]:b[2])}var b=[/^\u044f\u043d\u0432/i,/^\u0444\u0435\u0432/i,/^\u043c\u0430\u0440/i,
    /^\u0430\u043f\u0440/i,/^\u043c\u0430[\u0439\u044f]/i,/^\u0438\u044e\u043d/i,/^\u0438\u044e\u043b/i,/^\u0430\u0432\u0433/i,/^\u0441\u0435\u043d/i,/^\u043e\u043a\u0442/i,/^\u043d\u043e\u044f/i,/^\u0434\u0435\u043a/i];return d.defineLocale("ru",{months:{format:"\u044f\u043d\u0432\u0430\u0440\u044f \u0444\u0435\u0432\u0440\u0430\u043b\u044f \u043c\u0430\u0440\u0442\u0430 \u0430\u043f\u0440\u0435\u043b\u044f \u043c\u0430\u044f \u0438\u044e\u043d\u044f \u0438\u044e\u043b\u044f \u0430\u0432\u0433\u0443\u0441\u0442\u0430 \u0441\u0435\u043d\u0442\u044f\u0431\u0440\u044f \u043e\u043a\u0442\u044f\u0431\u0440\u044f \u043d\u043e\u044f\u0431\u0440\u044f \u0434\u0435\u043a\u0430\u0431\u0440\u044f".split(" "),
        standalone:"\u042f\u043d\u0432\u0430\u0440\u044c \u0424\u0435\u0432\u0440\u0430\u043b\u044c \u041c\u0430\u0440\u0442 \u0410\u043f\u0440\u0435\u043b\u044c \u041c\u0430\u0439 \u0418\u044e\u043d\u044c \u0418\u044e\u043b\u044c \u0410\u0432\u0433\u0443\u0441\u0442 \u0421\u0435\u043d\u0442\u044f\u0431\u0440\u044c \u041e\u043a\u0442\u044f\u0431\u0440\u044c \u041d\u043e\u044f\u0431\u0440\u044c \u0414\u0435\u043a\u0430\u0431\u0440\u044c".split(" ")},monthsShort:{format:"\u044f\u043d\u0432. \u0444\u0435\u0432\u0440. \u043c\u0430\u0440. \u0430\u043f\u0440. \u043c\u0430\u044f \u0438\u044e\u043d\u044f \u0438\u044e\u043b\u044f \u0430\u0432\u0433. \u0441\u0435\u043d\u0442. \u043e\u043a\u0442. \u043d\u043e\u044f\u0431. \u0434\u0435\u043a.".split(" "),
        standalone:"\u044f\u043d\u0432. \u0444\u0435\u0432\u0440. \u043c\u0430\u0440\u0442 \u0430\u043f\u0440. \u043c\u0430\u0439 \u0438\u044e\u043d\u044c \u0438\u044e\u043b\u044c \u0430\u0432\u0433. \u0441\u0435\u043d\u0442. \u043e\u043a\u0442. \u043d\u043e\u044f\u0431. \u0434\u0435\u043a.".split(" ")},weekdays:{standalone:"\u0432\u043e\u0441\u043a\u0440\u0435\u0441\u0435\u043d\u044c\u0435 \u043f\u043e\u043d\u0435\u0434\u0435\u043b\u044c\u043d\u0438\u043a \u0432\u0442\u043e\u0440\u043d\u0438\u043a \u0441\u0440\u0435\u0434\u0430 \u0447\u0435\u0442\u0432\u0435\u0440\u0433 \u043f\u044f\u0442\u043d\u0438\u0446\u0430 \u0441\u0443\u0431\u0431\u043e\u0442\u0430".split(" "),
        format:"\u0432\u043e\u0441\u043a\u0440\u0435\u0441\u0435\u043d\u044c\u0435 \u043f\u043e\u043d\u0435\u0434\u0435\u043b\u044c\u043d\u0438\u043a \u0432\u0442\u043e\u0440\u043d\u0438\u043a \u0441\u0440\u0435\u0434\u0443 \u0447\u0435\u0442\u0432\u0435\u0440\u0433 \u043f\u044f\u0442\u043d\u0438\u0446\u0443 \u0441\u0443\u0431\u0431\u043e\u0442\u0443".split(" "),isFormat:/\[ ?[\u0412\u0432] ?(?:\u043f\u0440\u043e\u0448\u043b\u0443\u044e|\u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0443\u044e|\u044d\u0442\u0443)? ?\] ?dddd/},
    weekdaysShort:"\u0432\u0441 \u043f\u043d \u0432\u0442 \u0441\u0440 \u0447\u0442 \u043f\u0442 \u0441\u0431".split(" "),weekdaysMin:"\u0432\u0441 \u043f\u043d \u0432\u0442 \u0441\u0440 \u0447\u0442 \u043f\u0442 \u0441\u0431".split(" "),monthsParse:b,longMonthsParse:b,shortMonthsParse:b,monthsRegex:/^(\u0441\u0435\u043d\u0442\u044f\u0431\u0440[\u044f\u044c]|\u043e\u043a\u0442\u044f\u0431\u0440[\u044f\u044c]|\u0434\u0435\u043a\u0430\u0431\u0440[\u044f\u044c]|\u0444\u0435\u0432\u0440\u0430\u043b[\u044f\u044c]|\u044f\u043d\u0432\u0430\u0440[\u044f\u044c]|\u0430\u043f\u0440\u0435\u043b[\u044f\u044c]|\u0430\u0432\u0433\u0443\u0441\u0442\u0430?|\u043d\u043e\u044f\u0431\u0440[\u044f\u044c]|\u0441\u0435\u043d\u0442\.|\u0444\u0435\u0432\u0440\.|\u043d\u043e\u044f\u0431\.|\u0438\u044e\u043d\u044c|\u044f\u043d\u0432.|\u0438\u044e\u043b\u044c|\u0434\u0435\u043a.|\u0430\u0432\u0433.|\u0430\u043f\u0440.|\u043c\u0430\u0440\u0442\u0430|\u043c\u0430\u0440[.\u0442]|\u043e\u043a\u0442.|\u0438\u044e\u043d[\u044f\u044c]|\u0438\u044e\u043b[\u044f\u044c]|\u043c\u0430[\u044f\u0439])/i,
    monthsShortRegex:/^(\u0441\u0435\u043d\u0442\u044f\u0431\u0440[\u044f\u044c]|\u043e\u043a\u0442\u044f\u0431\u0440[\u044f\u044c]|\u0434\u0435\u043a\u0430\u0431\u0440[\u044f\u044c]|\u0444\u0435\u0432\u0440\u0430\u043b[\u044f\u044c]|\u044f\u043d\u0432\u0430\u0440[\u044f\u044c]|\u0430\u043f\u0440\u0435\u043b[\u044f\u044c]|\u0430\u0432\u0433\u0443\u0441\u0442\u0430?|\u043d\u043e\u044f\u0431\u0440[\u044f\u044c]|\u0441\u0435\u043d\u0442\.|\u0444\u0435\u0432\u0440\.|\u043d\u043e\u044f\u0431\.|\u0438\u044e\u043d\u044c|\u044f\u043d\u0432.|\u0438\u044e\u043b\u044c|\u0434\u0435\u043a.|\u0430\u0432\u0433.|\u0430\u043f\u0440.|\u043c\u0430\u0440\u0442\u0430|\u043c\u0430\u0440[.\u0442]|\u043e\u043a\u0442.|\u0438\u044e\u043d[\u044f\u044c]|\u0438\u044e\u043b[\u044f\u044c]|\u043c\u0430[\u044f\u0439])/i,
    monthsStrictRegex:/^(\u0441\u0435\u043d\u0442\u044f\u0431\u0440[\u044f\u044c]|\u043e\u043a\u0442\u044f\u0431\u0440[\u044f\u044c]|\u0434\u0435\u043a\u0430\u0431\u0440[\u044f\u044c]|\u0444\u0435\u0432\u0440\u0430\u043b[\u044f\u044c]|\u044f\u043d\u0432\u0430\u0440[\u044f\u044c]|\u0430\u043f\u0440\u0435\u043b[\u044f\u044c]|\u0430\u0432\u0433\u0443\u0441\u0442\u0430?|\u043d\u043e\u044f\u0431\u0440[\u044f\u044c]|\u043c\u0430\u0440\u0442\u0430?|\u0438\u044e\u043d[\u044f\u044c]|\u0438\u044e\u043b[\u044f\u044c]|\u043c\u0430[\u044f\u0439])/i,
    monthsShortStrictRegex:/^(\u043d\u043e\u044f\u0431\.|\u0444\u0435\u0432\u0440\.|\u0441\u0435\u043d\u0442\.|\u0438\u044e\u043b\u044c|\u044f\u043d\u0432\.|\u0438\u044e\u043d[\u044f\u044c]|\u043c\u0430\u0440[.\u0442]|\u0430\u0432\u0433\.|\u0430\u043f\u0440\.|\u043e\u043a\u0442\.|\u0434\u0435\u043a\.|\u043c\u0430[\u044f\u0439])/i,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY \u0433.",LLL:"D MMMM YYYY \u0433., HH:mm",LLLL:"dddd, D MMMM YYYY \u0433., HH:mm"},calendar:{sameDay:"[\u0421\u0435\u0433\u043e\u0434\u043d\u044f \u0432] LT",
        nextDay:"[\u0417\u0430\u0432\u0442\u0440\u0430 \u0432] LT",lastDay:"[\u0412\u0447\u0435\u0440\u0430 \u0432] LT",nextWeek:function(a){if(a.week()!==this.week())switch(this.day()){case 0:return"[\u0412 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0435\u0435] dddd [\u0432] LT";case 1:case 2:case 4:return"[\u0412 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0439] dddd [\u0432] LT";case 3:case 5:case 6:return"[\u0412 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0443\u044e] dddd [\u0432] LT"}else return 2===
        this.day()?"[\u0412\u043e] dddd [\u0432] LT":"[\u0412] dddd [\u0432] LT"},lastWeek:function(a){if(a.week()!==this.week())switch(this.day()){case 0:return"[\u0412 \u043f\u0440\u043e\u0448\u043b\u043e\u0435] dddd [\u0432] LT";case 1:case 2:case 4:return"[\u0412 \u043f\u0440\u043e\u0448\u043b\u044b\u0439] dddd [\u0432] LT";case 3:case 5:case 6:return"[\u0412 \u043f\u0440\u043e\u0448\u043b\u0443\u044e] dddd [\u0432] LT"}else return 2===this.day()?"[\u0412\u043e] dddd [\u0432] LT":"[\u0412] dddd [\u0432] LT"},
        sameElse:"L"},relativeTime:{future:"\u0447\u0435\u0440\u0435\u0437 %s",past:"%s \u043d\u0430\u0437\u0430\u0434",s:"\u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0441\u0435\u043a\u0443\u043d\u0434",m:a,mm:a,h:"\u0447\u0430\u0441",hh:a,d:"\u0434\u0435\u043d\u044c",dd:a,M:"\u043c\u0435\u0441\u044f\u0446",MM:a,y:"\u0433\u043e\u0434",yy:a},meridiemParse:/\u043d\u043e\u0447\u0438|\u0443\u0442\u0440\u0430|\u0434\u043d\u044f|\u0432\u0435\u0447\u0435\u0440\u0430/i,isPM:function(a){return/^(\u0434\u043d\u044f|\u0432\u0435\u0447\u0435\u0440\u0430)$/.test(a)},
    meridiem:function(a,b,f){return 4>a?"\u043d\u043e\u0447\u0438":12>a?"\u0443\u0442\u0440\u0430":17>a?"\u0434\u043d\u044f":"\u0432\u0435\u0447\u0435\u0440\u0430"},ordinalParse:/\d{1,2}-(\u0439|\u0433\u043e|\u044f)/,ordinal:function(a,b){switch(b){case "M":case "d":case "DDD":return a+"-\u0439";case "D":return a+"-\u0433\u043e";case "w":case "W":return a+"-\u044f";default:return a}},week:{dow:1,doy:7}})});
"lt"==cabinetLanguage&&function(d,a){"object"===typeof exports&&"undefined"!==typeof module&&"function"===typeof require?a(require("../moment")):"function"===typeof define&&define.amd?define(["moment"],a):a(d.moment)}(this,function(d){function a(a,c,d,e){return c?b(d)[0]:e?b(d)[1]:b(d)[2]}function b(a){return e[a].split("_")}function c(c,d,e,g){var f=c+" ";return 1===c?f+a(c,d,e[0],g):d?f+(0===c%10||10<c&&20>c?b(e)[1]:b(e)[0]):g?f+b(e)[1]:f+(0===c%10||10<c&&20>c?b(e)[1]:b(e)[2])}var e={m:"minut\u0117_minut\u0117s_minut\u0119",
    mm:"minut\u0117s_minu\u010di\u0173_minutes",h:"valanda_valandos_valand\u0105",hh:"valandos_valand\u0173_valandas",d:"diena_dienos_dien\u0105",dd:"dienos_dien\u0173_dienas",M:"m\u0117nuo_m\u0117nesio_m\u0117nes\u012f",MM:"m\u0117nesiai_m\u0117nesi\u0173_m\u0117nesius",y:"metai_met\u0173_metus",yy:"metai_met\u0173_metus"};return d.defineLocale("lt",{months:{format:"sausio vasario kovo baland\u017eio gegu\u017e\u0117s bir\u017eelio liepos rugpj\u016b\u010dio rugs\u0117jo spalio lapkri\u010dio gruod\u017eio".split(" "),
        standalone:"sausis vasaris kovas balandis gegu\u017e\u0117 bir\u017eelis liepa rugpj\u016btis rugs\u0117jis spalis lapkritis gruodis".split(" ")},monthsShort:"sau vas kov bal geg bir lie rgp rgs spa lap grd".split(" "),weekdays:{format:"sekmadien\u012f pirmadien\u012f antradien\u012f tre\u010diadien\u012f ketvirtadien\u012f penktadien\u012f \u0161e\u0161tadien\u012f".split(" "),standalone:"sekmadienis pirmadienis antradienis tre\u010diadienis ketvirtadienis penktadienis \u0161e\u0161tadienis".split(" "),
        isFormat:/dddd HH:mm/},weekdaysShort:"Sek Pir Ant Tre Ket Pen \u0160e\u0161".split(" "),weekdaysMin:"S P A T K Pn \u0160".split(" "),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"YYYY [m.] MMMM D [d.]",LLL:"YYYY [m.] MMMM D [d.], HH:mm [val.]",LLLL:"YYYY [m.] MMMM D [d.], dddd, HH:mm [val.]",l:"YYYY-MM-DD",ll:"YYYY [m.] MMMM D [d.]",lll:"YYYY [m.] MMMM D [d.], HH:mm [val.]",llll:"YYYY [m.] MMMM D [d.], ddd, HH:mm [val.]"},calendar:{sameDay:"[\u0160iandien] LT",
        nextDay:"[Rytoj] LT",nextWeek:"dddd LT",lastDay:"[Vakar] LT",lastWeek:"[Pra\u0117jus\u012f] dddd LT",sameElse:"L"},relativeTime:{future:"po %s",past:"prie\u0161 %s",s:function(a,b,c,d){return b?"kelios sekund\u0117s":d?"keli\u0173 sekund\u017ei\u0173":"kelias sekundes"},m:a,mm:c,h:a,hh:c,d:a,dd:c,M:a,MM:c,y:a,yy:c},ordinalParse:/\d{1,2}-oji/,ordinal:function(a){return a+"-oji"},week:{dow:1,doy:4}})});
;
/*
 version : 4.17.37
 =========================================================
 bootstrap-datetimejs
 https://github.com/Eonasdan/bootstrap-datetimepicker
 Copyright (c) 2015 Jonathan Peterson
 =========================================================
*/
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(c,l,n){c instanceof String&&(c=String(c));for(var e=c.length,b=0;b<e;b++){var d=c[b];if(l.call(n,d,b,c))return{i:b,v:d}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(c,l,n){c!=Array.prototype&&c!=Object.prototype&&(c[l]=n.value)};$jscomp.getGlobal=function(c){c=["object"==typeof globalThis&&globalThis,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,c];for(var l=0;l<c.length;++l){var n=c[l];if(n&&n.Math==Math)return n}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(c,l,n,e){if(l){n=$jscomp.global;c=c.split(".");for(e=0;e<c.length-1;e++){var b=c[e];b in n||(n[b]={});n=n[b]}c=c[c.length-1];e=n[c];l=l(e);l!=e&&null!=l&&$jscomp.defineProperty(n,c,{configurable:!0,writable:!0,value:l})}};$jscomp.polyfill("Array.prototype.find",function(c){return c?c:function(c,n){return $jscomp.findInternal(this,c,n).v}},"es6","es3");$jscomp.arrayIteratorImpl=function(c){var l=0;return function(){return l<c.length?{done:!1,value:c[l++]}:{done:!0}}};
$jscomp.arrayIterator=function(c){return{next:$jscomp.arrayIteratorImpl(c)}};$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.SymbolClass=function(c,l){this.$jscomp$symbol$id_=c;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:l})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};
$jscomp.Symbol=function(){function c(n){if(this instanceof c)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(n||"")+"_"+l++,n)}var l=0;return c}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var c=$jscomp.global.Symbol.iterator;c||(c=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[c]&&$jscomp.defineProperty(Array.prototype,c,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var c=$jscomp.global.Symbol.asyncIterator;c||(c=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(c){$jscomp.initSymbolIterator();c={next:c};c[$jscomp.global.Symbol.iterator]=function(){return this};return c};
$jscomp.iteratorFromArray=function(c,l){$jscomp.initSymbolIterator();c instanceof String&&(c+="");var n=0,e={next:function(){if(n<c.length){var b=n++;return{value:l(b,c[b]),done:!1}}e.next=function(){return{done:!0,value:void 0}};return e.next()}};e[Symbol.iterator]=function(){return e};return e};$jscomp.polyfill("Array.prototype.keys",function(c){return c?c:function(){return $jscomp.iteratorFromArray(this,function(c){return c})}},"es6","es3");
(function(c){if("function"===typeof define&&define.amd)define(["jquery","moment"],c);else if("object"===typeof exports)c(require("jquery"),require("moment"));else{if("undefined"===typeof jQuery)throw"bootstrap-datetimepicker requires jQuery to be loaded first";if("undefined"===typeof moment)throw"bootstrap-datetimepicker requires Moment.js to be loaded first";c(jQuery,moment)}})(function(c,l){if(!l)throw Error("bootstrap-datetimepicker requires Moment.js to be loaded first");var n=function(e,b){var d=
{},n=!0,t=!1,f=!1,A,C=0,w,B,z,I=[{clsName:"days",navFnc:"M",navStep:1},{clsName:"months",navFnc:"y",navStep:1},{clsName:"years",navFnc:"y",navStep:10},{clsName:"decades",navFnc:"y",navStep:100}],O=["days","months","years","decades"],R=["top","bottom","auto"],S=["left","right","auto"],U=["default","top","bottom"],V={up:38,38:"up",down:40,40:"down",left:37,37:"left",right:39,39:"right",tab:9,9:"tab",escape:27,27:"escape",enter:13,13:"enter",pageUp:33,33:"pageUp",pageDown:34,34:"pageDown",shift:16,16:"shift",
control:17,17:"control",space:32,32:"space",t:84,84:"t","delete":46,46:"delete"},J={},D=function(a){var c=!1;void 0!==l.tz&&void 0!==b.timeZone&&null!==b.timeZone&&""!==b.timeZone&&(c=!0);if(void 0===a||null===a)a=c?l().tz(b.timeZone).startOf("d"):l().startOf("d");else if(c){c=l().tz(b.timeZone).utcOffset();var d=l(a,B,b.useStrict).utcOffset();d!==c?(c=l().tz(b.timeZone).format("Z"),a=l(a,B,b.useStrict).format("YYYY-MM-DD[T]HH:mm:ss")+c,a=l(a,B,b.useStrict).tz(b.timeZone)):a=l(a,B,b.useStrict).tz(b.timeZone)}else a=
l(a,B,b.useStrict);return a},x=function(a){if("string"!==typeof a||1<a.length)throw new TypeError("isEnabled expects a single character string parameter");switch(a){case "y":return-1!==w.indexOf("Y");case "M":return-1!==w.indexOf("M");case "d":return-1!==w.toLowerCase().indexOf("d");case "h":case "H":return-1!==w.toLowerCase().indexOf("h");case "m":return-1!==w.indexOf("m");case "s":return-1!==w.indexOf("s");default:return!1}},K=function(){return x("h")||x("m")||x("s")},L=function(){return x("y")||
x("M")||x("d")},ca=function(){var a=c("<thead>").append(c("<tr>").append(c("<th>").addClass("prev").attr("data-action","previous").append(c("<span>").addClass(b.icons.previous))).append(c("<th>").addClass("picker-switch").attr("data-action","pickerSwitch").attr("colspan",b.calendarWeeks?"6":"5")).append(c("<th>").addClass("next").attr("data-action","next").append(c("<span>").addClass(b.icons.next)))),g=c("<tbody>").append(c("<tr>").append(c("<td>").attr("colspan",b.calendarWeeks?"8":"7")));return[c("<div>").addClass("datepicker-days").append(c("<table>").addClass("table-condensed").append(a).append(c("<tbody>"))),
c("<div>").addClass("datepicker-months").append(c("<table>").addClass("table-condensed").append(a.clone()).append(g.clone())),c("<div>").addClass("datepicker-years").append(c("<table>").addClass("table-condensed").append(a.clone()).append(g.clone())),c("<div>").addClass("datepicker-decades").append(c("<table>").addClass("table-condensed").append(a.clone()).append(g.clone()))]},da=function(){var a=c("<div>").addClass("timepicker-hours").append(c("<table>").addClass("table-condensed")),g=c("<div>").addClass("timepicker-minutes").append(c("<table>").addClass("table-condensed")),
d=c("<div>").addClass("timepicker-seconds").append(c("<table>").addClass("table-condensed")),e=c("<tr>"),f=c("<tr>"),h=c("<tr>");x("h")&&(e.append(c("<td>").append(c("<a>").attr({href:"#",tabindex:"-1",title:b.tooltips.incrementHour}).addClass("btn").attr("data-action","incrementHours").append(c("<span>").addClass(b.icons.up)))),f.append(c("<td>").append(c("<span>").addClass("timepicker-hour").attr({"data-time-component":"hours",title:b.tooltips.pickHour}).attr("data-action","showHours"))),h.append(c("<td>").append(c("<a>").attr({href:"#",
tabindex:"-1",title:b.tooltips.decrementHour}).addClass("btn").attr("data-action","decrementHours").append(c("<span>").addClass(b.icons.down)))));x("m")&&(x("h")&&(e.append(c("<td>").addClass("separator")),f.append(c("<td>").addClass("separator").html(":")),h.append(c("<td>").addClass("separator"))),e.append(c("<td>").append(c("<a>").attr({href:"#",tabindex:"-1",title:b.tooltips.incrementMinute}).addClass("btn").attr("data-action","incrementMinutes").append(c("<span>").addClass(b.icons.up)))),f.append(c("<td>").append(c("<span>").addClass("timepicker-minute").attr({"data-time-component":"minutes",
title:b.tooltips.pickMinute}).attr("data-action","showMinutes"))),h.append(c("<td>").append(c("<a>").attr({href:"#",tabindex:"-1",title:b.tooltips.decrementMinute}).addClass("btn").attr("data-action","decrementMinutes").append(c("<span>").addClass(b.icons.down)))));x("s")&&(x("m")&&(e.append(c("<td>").addClass("separator")),f.append(c("<td>").addClass("separator").html(":")),h.append(c("<td>").addClass("separator"))),e.append(c("<td>").append(c("<a>").attr({href:"#",tabindex:"-1",title:b.tooltips.incrementSecond}).addClass("btn").attr("data-action",
"incrementSeconds").append(c("<span>").addClass(b.icons.up)))),f.append(c("<td>").append(c("<span>").addClass("timepicker-second").attr({"data-time-component":"seconds",title:b.tooltips.pickSecond}).attr("data-action","showSeconds"))),h.append(c("<td>").append(c("<a>").attr({href:"#",tabindex:"-1",title:b.tooltips.decrementSecond}).addClass("btn").attr("data-action","decrementSeconds").append(c("<span>").addClass(b.icons.down)))));A||(e.append(c("<td>").addClass("separator")),f.append(c("<td>").append(c("<button>").addClass("btn btn-primary").attr({"data-action":"togglePeriod",
tabindex:"-1",title:b.tooltips.togglePeriod}))),h.append(c("<td>").addClass("separator")));e=[c("<div>").addClass("timepicker-picker").append(c("<table>").addClass("table-condensed").append([e,f,h]))];x("h")&&e.push(a);x("m")&&e.push(g);x("s")&&e.push(d);return e},ea=function(){var a=[];b.showTodayButton&&(a.push(c('<td class="prevDayButton">').append(c("<a>").attr({"data-action":"previousDay",title:b.tooltips.today}).append(c('<span class="fa fa-angle-left" title="Previous Day"></span>')))),a.push(c("<td>").append(c("<a>").attr({"data-action":"today",
title:b.tooltips.today}).append(c('<span><span class="datetimePickerTodaySpan"">'+T.Today+"</span>")))),a.push(c('<td class="nextDayButton">').append(c("<a>").attr({"data-action":"nextDay",title:b.tooltips.today}).append(c('<span class="fa fa-angle-right" title="Next Day"></span>')))));!b.sideBySide&&L()&&K()&&a.push(c("<td>").append(c("<a>").attr({"data-action":"togglePicker",title:b.tooltips.selectTime}).append(c("<span>").addClass(b.icons.time))));b.showClear&&a.push(c("<td>").append(c("<a>").attr({"data-action":"clear",
title:b.tooltips.clear}).append(c("<span>").addClass(b.icons.clear))));b.showClose&&a.push(c("<td>").append(c("<a>").attr({"data-action":"close",title:b.tooltips.close}).append(c("<span>").addClass(b.icons.close))));return c("<table>").addClass("table-condensed").append(c("<tbody>").append(c("<tr>").append(a)))},fa=function(){var a=c("<div>").addClass("bootstrap-datetimepicker-widget dropdown-menu"),g=c("<div>").addClass("datepicker").append(ca()),d=c("<div>").addClass("timepicker").append(da()),
e=c("<ul>").addClass("list-unstyled"),f=c("<li>").addClass("picker-switch"+(b.collapse?" accordion-toggle":"")).append(ea());b.inline&&a.removeClass("dropdown-menu");A&&a.addClass("usetwentyfour");x("s")&&!A&&a.addClass("wider");if(b.sideBySide&&L()&&K())return a.addClass("timepicker-sbs"),"top"===b.toolbarPlacement&&a.append(f),a.append(c("<div>").addClass("row").append(g.addClass("col-md-6")).append(d.addClass("col-md-6"))),"bottom"===b.toolbarPlacement&&a.append(f),a;"top"===b.toolbarPlacement&&
e.append(f);L()&&e.append(c("<li>").addClass(b.collapse&&K()?"collapse in":"").append(g));"default"===b.toolbarPlacement&&e.append(f);K()&&e.append(c("<li>").addClass(b.collapse&&L()?"collapse":"").append(d));"bottom"===b.toolbarPlacement&&e.append(f);return a.append(e)},P=function(){var a=(t||e).position(),g=(t||e).offset(),d=b.widgetPositioning.vertical,h=b.widgetPositioning.horizontal;if(b.widgetParent)var k=b.widgetParent.append(f);else if(e.is("input"))k=e.after(f).parent();else{if(b.inline){k=
e.append(f);return}k=e;e.children().first().after(f)}"auto"===d&&(d=g.top+1.5*f.height()>=c(window).height()+c(window).scrollTop()&&f.height()+e.outerHeight()<g.top?"top":"bottom");"auto"===h&&(h=k.width()<g.left+f.outerWidth()/2&&g.left+f.outerWidth()>c(window).width()?"right":"left");"top"===d?f.addClass("top").removeClass("bottom"):f.addClass("bottom").removeClass("top");"right"===h?f.addClass("pull-right"):f.removeClass("pull-right");"relative"!==k.css("position")&&(k=k.parents().filter(function(){return"relative"===
c(this).css("position")}).first());if(0===k.length)throw Error("datetimepicker component should be placed within a relative positioned container");f.css({top:"top"===d?"auto":a.top+e.outerHeight(),bottom:"top"===d?a.top+e.outerHeight():"auto",left:"left"===h?k===e?0:a.left:"auto",right:"left"===h?"auto":k.outerWidth()-e.outerWidth()-(k===e?0:a.left)})},F=function(a){"y"===a&&(a="YYYY");e.trigger({type:"dp.update",change:a,viewDate:k.clone()})},G=function(a){f&&(a&&(z=Math.max(C,Math.min(1,z+a))),
f.find(".datepicker > div").hide().filter(".datepicker-"+I[z].clsName).show())},ha=function(){var a=c("<tr>"),g=k.clone().startOf("w").startOf("d");for(!0===b.calendarWeeks&&a.append(c("<th>").addClass("cw").text("#"));g.isBefore(k.clone().endOf("w"));)a.append(c("<th>").addClass("dow").text(g.format("dd"))),g.add(1,"d");f.find(".datepicker-days thead").append(a)},r=function(a,g){if(!a.isValid()||b.disabledDates&&"d"===g&&!0===b.disabledDates[a.format("YYYY-MM-DD")]||b.enabledDates&&"d"===g&&!0!==
b.enabledDates[a.format("YYYY-MM-DD")]||b.minDate&&a.isBefore(b.minDate,g)||b.maxDate&&a.isAfter(b.maxDate,g)||b.daysOfWeekDisabled&&"d"===g&&-1!==b.daysOfWeekDisabled.indexOf(a.day())||b.disabledHours&&("h"===g||"m"===g||"s"===g)&&!0===b.disabledHours[a.format("H")]||b.enabledHours&&("h"===g||"m"===g||"s"===g)&&!0!==b.enabledHours[a.format("H")])return!1;if(b.disabledTimeIntervals&&("h"===g||"m"===g||"s"===g)){var d=!1;c.each(b.disabledTimeIntervals,function(){if(a.isBetween(this[0],this[1]))return d=
!0,!1});if(d)return!1}return!0},ia=function(){for(var a=[],b=k.clone().startOf("y").startOf("d");b.isSame(k,"y");)a.push(c("<span>").attr("data-action","selectMonth").addClass("month").text(b.format("MMM"))),b.add(1,"M");f.find(".datepicker-months td").empty().append(a)},ja=function(){var a=f.find(".datepicker-months"),g=a.find("th"),d=a.find("tbody").find("span");g.eq(0).find("span").attr("title",b.tooltips.prevYear);g.eq(1).attr("title",b.tooltips.selectYear);g.eq(2).find("span").attr("title",b.tooltips.nextYear);
a.find(".disabled").removeClass("disabled");r(k.clone().subtract(1,"y"),"y")||g.eq(0).addClass("disabled");g.eq(1).text(k.year());r(k.clone().add(1,"y"),"y")||g.eq(2).addClass("disabled");d.removeClass("active");h.isSame(k,"y")&&!n&&d.eq(h.month()).addClass("active");d.each(function(a){r(k.clone().month(a),"M")||c(this).addClass("disabled")})},H=function(){var a=f.find(".datepicker-days"),g=a.find("th"),d=[],e;if(L()){g.eq(0).find("span").attr("title",b.tooltips.prevMonth);g.eq(1).attr("title",b.tooltips.selectMonth);
g.eq(2).find("span").attr("title",b.tooltips.nextMonth);a.find(".disabled").removeClass("disabled");g.eq(1).text(k.format(b.dayViewHeaderFormat));r(k.clone().subtract(1,"M"),"M")||g.eq(0).addClass("disabled");r(k.clone().add(1,"M"),"M")||g.eq(2).addClass("disabled");g=k.clone().startOf("M").startOf("w").startOf("d");for(e=0;42>e;e++){if(0===g.weekday()){var q=c("<tr>");b.calendarWeeks&&q.append('<td class="cw">'+g.week()+"</td>");d.push(q)}var m="";g.isBefore(k,"M")&&(m+=" old");g.isAfter(k,"M")&&
(m+=" new");g.isSame(h,"d")&&!n&&(m+=" active");r(g,"d")||(m+=" disabled");g.isSame(D(),"d")&&(m+=" today");if(0===g.day()||6===g.day())m+=" weekend";q.append('<td data-action="selectDay" data-day="'+g.format("L")+'" class="day'+m+'">'+g.date()+"</td>");g.add(1,"d")}a.find("tbody").empty().append(d);ja();a=f.find(".datepicker-years");d=a.find("th");q=k.clone().subtract(5,"y");g=k.clone().add(6,"y");m="";d.eq(0).find("span").attr("title",b.tooltips.prevDecade);d.eq(1).attr("title",b.tooltips.selectDecade);
d.eq(2).find("span").attr("title",b.tooltips.nextDecade);a.find(".disabled").removeClass("disabled");b.minDate&&b.minDate.isAfter(q,"y")&&d.eq(0).addClass("disabled");d.eq(1).text(q.year()+"-"+g.year());for(b.maxDate&&b.maxDate.isBefore(g,"y")&&d.eq(2).addClass("disabled");!q.isAfter(g,"y");)m+='<span data-action="selectYear" class="year'+(q.isSame(h,"y")&&!n?" active":"")+(r(q,"y")?"":" disabled")+'">'+q.year()+"</span>",q.add(1,"y");a.find("td").html(m);a=f.find(".datepicker-decades");d=a.find("th");
q=l({y:k.year()-k.year()%100-1});g=q.clone().add(100,"y");m=q.clone();e="";d.eq(0).find("span").attr("title",b.tooltips.prevCentury);d.eq(2).find("span").attr("title",b.tooltips.nextCentury);a.find(".disabled").removeClass("disabled");(q.isSame(l({y:1900}))||b.minDate&&b.minDate.isAfter(q,"y"))&&d.eq(0).addClass("disabled");d.eq(1).text(q.year()+"-"+g.year());for((q.isSame(l({y:2E3}))||b.maxDate&&b.maxDate.isBefore(g,"y"))&&d.eq(2).addClass("disabled");!q.isAfter(g,"y");)e+='<span data-action="selectDecade" class="decade'+
(q.isSame(h,"y")?" active":"")+(r(q,"y")?"":" disabled")+'" data-selection="'+(q.year()+6)+'">'+(q.year()+1)+" - "+(q.year()+12)+"</span>",q.add(12,"y");e+="<span></span><span></span><span></span>";a.find("td").html(e);d.eq(1).text(m.year()+1+"-"+q.year())}},u=function(){if(f){H();var a=f.find(".timepicker span[data-time-component]");if(!A){var d=f.find(".timepicker [data-action=togglePeriod]");var e=h.clone().add(12<=h.hours()?-12:12,"h");d.text(h.format("A"));r(e,"h")?d.removeClass("disabled"):
d.addClass("disabled")}a.filter("[data-time-component=hours]").text(h.format(A?"HH":"hh"));a.filter("[data-time-component=minutes]").text(h.format("mm"));a.filter("[data-time-component=seconds]").text(h.format("ss"));d=f.find(".timepicker-hours table");e=k.clone().startOf("d");a=[];var l=c("<tr>");for(11<k.hour()&&!A&&e.hour(12);e.isSame(k,"d")&&(A||12>k.hour()&&12>e.hour()||11<k.hour());)0===e.hour()%4&&(l=c("<tr>"),a.push(l)),l.append('<td data-action="selectHour" class="hour'+(r(e,"h")?"":" disabled")+
'">'+e.format(A?"HH":"hh")+"</td>"),e.add(1,"h");d.empty().append(a);d=f.find(".timepicker-minutes table");e=k.clone().startOf("h");a=[];l=c("<tr>");for(var m=1===b.stepping?5:b.stepping;k.isSame(e,"h");)0===e.minute()%(4*m)&&(l=c("<tr>"),a.push(l)),l.append('<td data-action="selectMinute" class="minute'+(r(e,"m")?"":" disabled")+'">'+e.format("mm")+"</td>"),e.add(m,"m");d.empty().append(a);d=f.find(".timepicker-seconds table");e=k.clone().startOf("m");a=[];for(l=c("<tr>");k.isSame(e,"m");)0===e.second()%
20&&(l=c("<tr>"),a.push(l)),l.append('<td data-action="selectSecond" class="second'+(r(e,"s")?"":" disabled")+'">'+e.format("ss")+"</td>"),e.add(5,"s");d.empty().append(a)}},m=function(a){var c=n?null:h;a?(a=a.clone().locale(b.locale),1!==b.stepping&&a.minutes(Math.round(a.minutes()/b.stepping)*b.stepping%60).seconds(0),r(a)?(h=a,k=h.clone(),p.val(h.format(w)),e.data("date",h.format(w)),n=!1,u(),e.trigger({type:"dp.change",date:h.clone(),oldDate:c})):(b.keepInvalid||p.val(n?"":h.format(w)),e.trigger({type:"dp.error",
date:a}))):(n=!0,p.val(""),e.data("date",""),e.trigger({type:"dp.change",date:!1,oldDate:c}),u())},v=function(){var a=!1;if(!f)return d;f.find(".collapse").each(function(){var b=c(this).data("collapse");return b&&b.transitioning?(a=!0,!1):!0});if(a)return d;t&&t.hasClass("btn")&&t.toggleClass("active");f.hide();c(window).off("resize",P);f.off("click","[data-action]");f.off("mousedown",!1);f.remove();f=!1;e.trigger({type:"dp.hide",date:h.clone()});p.blur();return d},W=function(){m(null)},M={next:function(){var a=
I[z].navFnc;k.add(I[z].navStep,a);H();F(a)},previous:function(){var a=I[z].navFnc;k.subtract(I[z].navStep,a);H();F(a)},pickerSwitch:function(){G(1)},selectMonth:function(a){a=c(a.target).closest("tbody").find("span").index(c(a.target));k.month(a);z===C?(m(h.clone().year(k.year()).month(k.month())),b.inline||v()):(G(-1),H());F("M")},selectYear:function(a){a=parseInt(c(a.target).text(),10)||0;k.year(a);z===C?(m(h.clone().year(k.year())),b.inline||v()):(G(-1),H());F("YYYY")},selectDecade:function(a){a=
parseInt(c(a.target).data("selection"),10)||0;k.year(a);z===C?(m(h.clone().year(k.year())),b.inline||v()):(G(-1),H());F("YYYY")},selectDay:function(a){var d=k.clone();c(a.target).is(".old")&&d.subtract(1,"M");c(a.target).is(".new")&&d.add(1,"M");m(d.date(parseInt(c(a.target).text(),10)));K()||b.keepOpen||b.inline||v()},incrementHours:function(){var a=h.clone().add(1,"h");r(a,"h")&&m(a)},incrementMinutes:function(){var a=h.clone().add(b.stepping,"m");r(a,"m")&&m(a)},incrementSeconds:function(){var a=
h.clone().add(1,"s");r(a,"s")&&m(a)},decrementHours:function(){var a=h.clone().subtract(1,"h");r(a,"h")&&m(a)},decrementMinutes:function(){var a=h.clone().subtract(b.stepping,"m");r(a,"m")&&m(a)},decrementSeconds:function(){var a=h.clone().subtract(1,"s");r(a,"s")&&m(a)},togglePeriod:function(){m(h.clone().add(12<=h.hours()?-12:12,"h"))},togglePicker:function(a){a=c(a.target);var d=a.closest("ul"),e=d.find(".in");d=d.find(".collapse:not(.in)");if(e&&e.length){var f=e.data("collapse");f&&f.transitioning||
(e.collapse?(e.collapse("hide"),d.collapse("show")):(e.removeClass("in"),d.addClass("in")),a.is("span")?a.toggleClass(b.icons.time+" "+b.icons.date):a.find("span").toggleClass(b.icons.time+" "+b.icons.date))}},showPicker:function(){f.find(".timepicker > div:not(.timepicker-picker)").hide();f.find(".timepicker .timepicker-picker").show()},showHours:function(){f.find(".timepicker .timepicker-picker").hide();f.find(".timepicker .timepicker-hours").show()},showMinutes:function(){f.find(".timepicker .timepicker-picker").hide();
f.find(".timepicker .timepicker-minutes").show()},showSeconds:function(){f.find(".timepicker .timepicker-picker").hide();f.find(".timepicker .timepicker-seconds").show()},selectHour:function(a){a=parseInt(c(a.target).text(),10);A||(12<=h.hours()?12!==a&&(a+=12):12===a&&(a=0));m(h.clone().hours(a));M.showPicker.call(d)},selectMinute:function(a){m(h.clone().minutes(parseInt(c(a.target).text(),10)));M.showPicker.call(d)},selectSecond:function(a){m(h.clone().seconds(parseInt(c(a.target).text(),10)));
M.showPicker.call(d)},clear:W,today:function(){var a=D();r(a,"d")&&m(a)},previousDay:function(){m(d.date().add(-1,"days"))},nextDay:function(){m(d.date().add(1,"days"))},close:v},ka=function(a){if(c(a.currentTarget).is(".disabled"))return!1;M[c(a.currentTarget).data("action")].apply(d,arguments);return!1},y=function(){var a={year:function(a){return a.month(0).date(1).hours(0).seconds(0).minutes(0)},month:function(a){return a.date(1).hours(0).seconds(0).minutes(0)},day:function(a){return a.hours(0).seconds(0).minutes(0)},
hour:function(a){return a.seconds(0).minutes(0)},minute:function(a){return a.seconds(0)}};if(p.prop("disabled")||!b.ignoreReadonly&&p.prop("readonly")||f)return d;if(void 0!==p.val()&&0!==p.val().trim().length)m(E(p.val().trim()));else if(b.useCurrent&&n&&(p.is("input")&&0===p.val().trim().length||b.inline)){var g=D();"string"===typeof b.useCurrent&&(g=a[b.useCurrent](g));m(g)}f=fa();ha();ia();f.find(".timepicker-hours").hide();f.find(".timepicker-minutes").hide();f.find(".timepicker-seconds").hide();
u();G();c(window).on("resize",P);f.on("click","[data-action]",ka);f.on("mousedown",!1);t&&t.hasClass("btn")&&t.toggleClass("active");f.show();P();b.focusOnShow&&!p.is(":focus")&&p.focus();e.trigger({type:"dp.show"});return d},Q=function(){return f?v():y()},E=function(a){a=void 0===b.parseInputDate?l.isMoment(a)||a instanceof Date?l(a):D(a):b.parseInputDate(a);a.locale(b.locale);return a},X=function(a){var c=null,e,h,k=[],l={},m=a.which;J[m]="p";for(e in J)J.hasOwnProperty(e)&&"p"===J[e]&&(k.push(e),
parseInt(e,10)!==m&&(l[e]=!0));for(e in b.keyBinds)if(b.keyBinds.hasOwnProperty(e)&&"function"===typeof b.keyBinds[e]){var n=e.split(" ");if(n.length===k.length&&V[m]===n[n.length-1]){var p=!0;for(h=n.length-2;0<=h;h--)if(!(V[n[h]]in l)){p=!1;break}if(p){c=b.keyBinds[e];break}}}c&&(c.call(d,f),a.stopPropagation(),a.preventDefault())},Y=function(a){J[a.which]="r";a.stopPropagation();a.preventDefault()},Z=function(a){var b=c(a.target).val().trim();b=b?E(b):null;m(b);a.stopImmediatePropagation();return!1},
aa=function(a){var b={};c.each(a,function(){var a=E(this);a.isValid()&&(b[a.format("YYYY-MM-DD")]=!0)});return Object.keys(b).length?b:!1},ba=function(a){var b={};c.each(a,function(){b[this]=!0});return Object.keys(b).length?b:!1},N=function(){var a=b.format||"L LT";w=a.replace(/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,function(a){return(h.localeData().longDateFormat(a)||a).replace(/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,function(a){return h.localeData().longDateFormat(a)||a})});B=b.extraFormats?
b.extraFormats.slice():[];0>B.indexOf(a)&&0>B.indexOf(w)&&B.push(w);A=1>w.toLowerCase().indexOf("a")&&1>w.replace(/\[.*?\]/g,"").indexOf("h");x("y")&&(C=2);x("M")&&(C=1);x("d")&&(C=0);z=Math.max(C,z);n||m(h)};d.destroy=function(){v();p.off({change:Z,blur:blur,keydown:X,keyup:Y,focus:b.allowInputToggle?v:""});e.is("input")?p.off({focus:y}):t&&(t.off("click",Q),t.off("mousedown",!1));e.removeData("DateTimePicker");e.removeData("date")};d.toggle=Q;d.show=y;d.hide=v;d.disable=function(){v();t&&t.hasClass("btn")&&
t.addClass("disabled");p.prop("disabled",!0);return d};d.enable=function(){t&&t.hasClass("btn")&&t.removeClass("disabled");p.prop("disabled",!1);return d};d.ignoreReadonly=function(a){if(0===arguments.length)return b.ignoreReadonly;if("boolean"!==typeof a)throw new TypeError("ignoreReadonly () expects a boolean parameter");b.ignoreReadonly=a;return d};d.options=function(a){if(0===arguments.length)return c.extend(!0,{},b);if(!(a instanceof Object))throw new TypeError("options() options parameter should be an object");
c.extend(!0,b,a);c.each(b,function(a,b){if(void 0!==d[a])d[a](b);else throw new TypeError("option "+a+" is not recognized!");});return d};d.date=function(a){if(0===arguments.length)return n?null:h.clone();if(!(null===a||"string"===typeof a||l.isMoment(a)||a instanceof Date))throw new TypeError("date() parameter must be one of [null, string, moment or Date]");m(null===a?null:E(a));return d};d.format=function(a){if(0===arguments.length)return b.format;if("string"!==typeof a&&("boolean"!==typeof a||
!1!==a))throw new TypeError("format() expects a sting or boolean:false parameter "+a);b.format=a;w&&N();return d};d.timeZone=function(a){if(0===arguments.length)return b.timeZone;b.timeZone=a;return d};d.dayViewHeaderFormat=function(a){if(0===arguments.length)return b.dayViewHeaderFormat;if("string"!==typeof a)throw new TypeError("dayViewHeaderFormat() expects a string parameter");b.dayViewHeaderFormat=a;return d};d.extraFormats=function(a){if(0===arguments.length)return b.extraFormats;if(!1!==a&&
!(a instanceof Array))throw new TypeError("extraFormats() expects an array or false parameter");b.extraFormats=a;B&&N();return d};d.disabledDates=function(a){if(0===arguments.length)return b.disabledDates?c.extend({},b.disabledDates):b.disabledDates;if(!a)return b.disabledDates=!1,u(),d;if(!(a instanceof Array))throw new TypeError("disabledDates() expects an array parameter");b.disabledDates=aa(a);b.enabledDates=!1;u();return d};d.enabledDates=function(a){if(0===arguments.length)return b.enabledDates?
c.extend({},b.enabledDates):b.enabledDates;if(!a)return b.enabledDates=!1,u(),d;if(!(a instanceof Array))throw new TypeError("enabledDates() expects an array parameter");b.enabledDates=aa(a);b.disabledDates=!1;u();return d};d.daysOfWeekDisabled=function(a){if(0===arguments.length)return b.daysOfWeekDisabled.splice(0);if("boolean"===typeof a&&!a)return b.daysOfWeekDisabled=!1,u(),d;if(!(a instanceof Array))throw new TypeError("daysOfWeekDisabled() expects an array parameter");b.daysOfWeekDisabled=
a.reduce(function(a,b){b=parseInt(b,10);if(6<b||0>b||isNaN(b))return a;-1===a.indexOf(b)&&a.push(b);return a},[]).sort();if(b.useCurrent&&!b.keepInvalid){for(var c=0;!r(h,"d");){h.add(1,"d");if(7===c)throw"Tried 7 times to find a valid date";c++}m(h)}u();return d};d.maxDate=function(a){if(0===arguments.length)return b.maxDate?b.maxDate.clone():b.maxDate;if("boolean"===typeof a&&!1===a)return b.maxDate=!1,u(),d;"string"!==typeof a||"now"!==a&&"moment"!==a||(a=D());var c=E(a);if(!c.isValid())throw new TypeError("maxDate() Could not parse date parameter: "+
a);if(b.minDate&&c.isBefore(b.minDate))throw new TypeError("maxDate() date parameter is before options.minDate: "+c.format(w));b.maxDate=c;b.useCurrent&&!b.keepInvalid&&h.isAfter(a)&&m(b.maxDate);k.isAfter(c)&&(k=c.clone().subtract(b.stepping,"m"));u();return d};d.minDate=function(a){if(0===arguments.length)return b.minDate?b.minDate.clone():b.minDate;if("boolean"===typeof a&&!1===a)return b.minDate=!1,u(),d;"string"!==typeof a||"now"!==a&&"moment"!==a||(a=D());var c=E(a);if(!c.isValid())throw new TypeError("minDate() Could not parse date parameter: "+
a);if(b.maxDate&&c.isAfter(b.maxDate))throw new TypeError("minDate() date parameter is after options.maxDate: "+c.format(w));b.minDate=c;b.useCurrent&&!b.keepInvalid&&h.isBefore(a)&&m(b.minDate);k.isBefore(c)&&(k=c.clone().add(b.stepping,"m"));u();return d};d.defaultDate=function(a){if(0===arguments.length)return b.defaultDate?b.defaultDate.clone():b.defaultDate;if(!a)return b.defaultDate=!1,d;"string"!==typeof a||"now"!==a&&"moment"!==a||(a=D());var c=E(a);if(!c.isValid())throw new TypeError("defaultDate() Could not parse date parameter: "+
a);if(!r(c))throw new TypeError("defaultDate() date passed is invalid according to component setup validations");b.defaultDate=c;(b.defaultDate&&b.inline||""===p.val().trim())&&m(b.defaultDate);return d};d.locale=function(a){if(0===arguments.length)return b.locale;if(!l.localeData(a))throw new TypeError("locale() locale "+a+" is not loaded from moment locales!");b.locale=a;h.locale(b.locale);k.locale(b.locale);w&&N();f&&(v(),y());return d};d.stepping=function(a){if(0===arguments.length)return b.stepping;
a=parseInt(a,10);if(isNaN(a)||1>a)a=1;b.stepping=a;return d};d.useCurrent=function(a){var c=["year","month","day","hour","minute"];if(0===arguments.length)return b.useCurrent;if("boolean"!==typeof a&&"string"!==typeof a)throw new TypeError("useCurrent() expects a boolean or string parameter");if("string"===typeof a&&-1===c.indexOf(a.toLowerCase()))throw new TypeError("useCurrent() expects a string parameter of "+c.join(", "));b.useCurrent=a;return d};d.collapse=function(a){if(0===arguments.length)return b.collapse;
if("boolean"!==typeof a)throw new TypeError("collapse() expects a boolean parameter");if(b.collapse===a)return d;b.collapse=a;f&&(v(),y());return d};d.icons=function(a){if(0===arguments.length)return c.extend({},b.icons);if(!(a instanceof Object))throw new TypeError("icons() expects parameter to be an Object");c.extend(b.icons,a);f&&(v(),y());return d};d.tooltips=function(a){if(0===arguments.length)return c.extend({},b.tooltips);if(!(a instanceof Object))throw new TypeError("tooltips() expects parameter to be an Object");
c.extend(b.tooltips,a);f&&(v(),y());return d};d.useStrict=function(a){if(0===arguments.length)return b.useStrict;if("boolean"!==typeof a)throw new TypeError("useStrict() expects a boolean parameter");b.useStrict=a;return d};d.sideBySide=function(a){if(0===arguments.length)return b.sideBySide;if("boolean"!==typeof a)throw new TypeError("sideBySide() expects a boolean parameter");b.sideBySide=a;f&&(v(),y());return d};d.viewMode=function(a){if(0===arguments.length)return b.viewMode;if("string"!==typeof a)throw new TypeError("viewMode() expects a string parameter");
if(-1===O.indexOf(a))throw new TypeError("viewMode() parameter must be one of ("+O.join(", ")+") value");b.viewMode=a;z=Math.max(O.indexOf(a),C);G();return d};d.toolbarPlacement=function(a){if(0===arguments.length)return b.toolbarPlacement;if("string"!==typeof a)throw new TypeError("toolbarPlacement() expects a string parameter");if(-1===U.indexOf(a))throw new TypeError("toolbarPlacement() parameter must be one of ("+U.join(", ")+") value");b.toolbarPlacement=a;f&&(v(),y());return d};d.widgetPositioning=
function(a){if(0===arguments.length)return c.extend({},b.widgetPositioning);if("[object Object]"!=={}.toString.call(a))throw new TypeError("widgetPositioning() expects an object variable");if(a.horizontal){if("string"!==typeof a.horizontal)throw new TypeError("widgetPositioning() horizontal variable must be a string");a.horizontal=a.horizontal.toLowerCase();if(-1===S.indexOf(a.horizontal))throw new TypeError("widgetPositioning() expects horizontal parameter to be one of ("+S.join(", ")+")");b.widgetPositioning.horizontal=
a.horizontal}if(a.vertical){if("string"!==typeof a.vertical)throw new TypeError("widgetPositioning() vertical variable must be a string");a.vertical=a.vertical.toLowerCase();if(-1===R.indexOf(a.vertical))throw new TypeError("widgetPositioning() expects vertical parameter to be one of ("+R.join(", ")+")");b.widgetPositioning.vertical=a.vertical}u();return d};d.calendarWeeks=function(a){if(0===arguments.length)return b.calendarWeeks;if("boolean"!==typeof a)throw new TypeError("calendarWeeks() expects parameter to be a boolean value");
b.calendarWeeks=a;u();return d};d.showTodayButton=function(a){if(0===arguments.length)return b.showTodayButton;if("boolean"!==typeof a)throw new TypeError("showTodayButton() expects a boolean parameter");b.showTodayButton=a;f&&(v(),y());return d};d.showClear=function(a){if(0===arguments.length)return b.showClear;if("boolean"!==typeof a)throw new TypeError("showClear() expects a boolean parameter");b.showClear=a;f&&(v(),y());return d};d.widgetParent=function(a){if(0===arguments.length)return b.widgetParent;
"string"===typeof a&&(a=c(a));if(null!==a&&"string"!==typeof a&&!(a instanceof c))throw new TypeError("widgetParent() expects a string or a jQuery object parameter");b.widgetParent=a;f&&(v(),y());return d};d.keepOpen=function(a){if(0===arguments.length)return b.keepOpen;if("boolean"!==typeof a)throw new TypeError("keepOpen() expects a boolean parameter");b.keepOpen=a;return d};d.focusOnShow=function(a){if(0===arguments.length)return b.focusOnShow;if("boolean"!==typeof a)throw new TypeError("focusOnShow() expects a boolean parameter");
b.focusOnShow=a;return d};d.inline=function(a){if(0===arguments.length)return b.inline;if("boolean"!==typeof a)throw new TypeError("inline() expects a boolean parameter");b.inline=a;return d};d.clear=function(){W();return d};d.keyBinds=function(a){b.keyBinds=a;return d};d.getMoment=function(a){return D(a)};d.debug=function(a){if("boolean"!==typeof a)throw new TypeError("debug() expects a boolean parameter");b.debug=a;return d};d.allowInputToggle=function(a){if(0===arguments.length)return b.allowInputToggle;
if("boolean"!==typeof a)throw new TypeError("allowInputToggle() expects a boolean parameter");b.allowInputToggle=a;return d};d.showClose=function(a){if(0===arguments.length)return b.showClose;if("boolean"!==typeof a)throw new TypeError("showClose() expects a boolean parameter");b.showClose=a;return d};d.keepInvalid=function(a){if(0===arguments.length)return b.keepInvalid;if("boolean"!==typeof a)throw new TypeError("keepInvalid() expects a boolean parameter");b.keepInvalid=a;return d};d.datepickerInput=
function(a){if(0===arguments.length)return b.datepickerInput;if("string"!==typeof a)throw new TypeError("datepickerInput() expects a string parameter");b.datepickerInput=a;return d};d.parseInputDate=function(a){if(0===arguments.length)return b.parseInputDate;if("function"!==typeof a)throw new TypeError("parseInputDate() sholud be as function");b.parseInputDate=a;return d};d.disabledTimeIntervals=function(a){if(0===arguments.length)return b.disabledTimeIntervals?c.extend({},b.disabledTimeIntervals):
b.disabledTimeIntervals;if(!a)return b.disabledTimeIntervals=!1,u(),d;if(!(a instanceof Array))throw new TypeError("disabledTimeIntervals() expects an array parameter");b.disabledTimeIntervals=a;u();return d};d.disabledHours=function(a){if(0===arguments.length)return b.disabledHours?c.extend({},b.disabledHours):b.disabledHours;if(!a)return b.disabledHours=!1,u(),d;if(!(a instanceof Array))throw new TypeError("disabledHours() expects an array parameter");b.disabledHours=ba(a);b.enabledHours=!1;if(b.useCurrent&&
!b.keepInvalid){for(var e=0;!r(h,"h");){h.add(1,"h");if(24===e)throw"Tried 24 times to find a valid date";e++}m(h)}u();return d};d.enabledHours=function(a){if(0===arguments.length)return b.enabledHours?c.extend({},b.enabledHours):b.enabledHours;if(!a)return b.enabledHours=!1,u(),d;if(!(a instanceof Array))throw new TypeError("enabledHours() expects an array parameter");b.enabledHours=ba(a);b.disabledHours=!1;if(b.useCurrent&&!b.keepInvalid){for(var e=0;!r(h,"h");){h.add(1,"h");if(24===e)throw"Tried 24 times to find a valid date";
e++}m(h)}u();return d};d.viewDate=function(a){if(0===arguments.length)return k.clone();if(!a)return k=h.clone(),d;if(!("string"===typeof a||l.isMoment(a)||a instanceof Date))throw new TypeError("viewDate() parameter must be one of [string, moment or Date]");k=E(a);F();return d};if(e.is("input"))var p=e;else if(p=e.find(b.datepickerInput),0===p.size())p=e.find("input");else if(!p.is("input"))throw Error('CSS class "'+b.datepickerInput+'" cannot be applied to non input element');e.hasClass("input-group")&&
(t=0===e.find(".datepickerbutton").size()?e.find(".input-group-addon"):e.find(".datepickerbutton"));if(!b.inline&&!p.is("input"))throw Error("Could not initialize DateTimePicker without an input element");var h=D();var k=h.clone();c.extend(!0,b,function(){var a={};var d=e.is("input")||b.inline?e.data():e.find("input").data();d.dateOptions&&d.dateOptions instanceof Object&&(a=c.extend(!0,a,d.dateOptions));c.each(b,function(b){var c="date"+b.charAt(0).toUpperCase()+b.slice(1);void 0!==d[c]&&(a[b]=d[c])});
return a}());d.options(b);N();p.on({change:Z,blur:b.debug?"":v,keydown:X,keyup:Y,focus:b.allowInputToggle?y:""});if(e.is("input"))p.on({focus:y});else t&&(t.on("click",Q),t.on("mousedown",!1));p.prop("disabled")&&d.disable();p.is("input")&&0!==p.val().trim().length?m(E(p.val().trim())):b.defaultDate&&void 0===p.attr("placeholder")&&m(b.defaultDate);b.inline&&y();return d};c.fn.datetimepicker=function(e){return this.each(function(){var b=c(this);b.data("DateTimePicker")||(e=c.extend(!0,{},c.fn.datetimepicker.defaults,
e),b.data("DateTimePicker",n(b,e)))})};c.fn.datetimepicker.defaults={timeZone:"Etc/UTC",format:!1,dayViewHeaderFormat:"MMMM YYYY",extraFormats:!1,stepping:1,minDate:!1,maxDate:!1,useCurrent:!0,collapse:!0,locale:l.locale(),defaultDate:!1,disabledDates:!1,enabledDates:!1,icons:{time:"glyphicon glyphicon-time",date:"glyphicon glyphicon-calendar",up:"glyphicon glyphicon-chevron-up",down:"glyphicon glyphicon-chevron-down",previous:"glyphicon glyphicon-chevron-left",next:"glyphicon glyphicon-chevron-right",
today:"glyphicon glyphicon-screenshot",clear:"glyphicon glyphicon-trash",close:"glyphicon glyphicon-remove"},tooltips:{today:"Go to today",clear:"Clear selection",close:"Close the picker",selectMonth:"Select Month",prevMonth:"Previous Month",nextMonth:"Next Month",selectYear:"Select Year",prevYear:"Previous Year",nextYear:"Next Year",selectDecade:"Select Decade",prevDecade:"Previous Decade",nextDecade:"Next Decade",prevCentury:"Previous Century",nextCentury:"Next Century",pickHour:"Pick Hour",incrementHour:"Increment Hour",
decrementHour:"Decrement Hour",pickMinute:"Pick Minute",incrementMinute:"Increment Minute",decrementMinute:"Decrement Minute",pickSecond:"Pick Second",incrementSecond:"Increment Second",decrementSecond:"Decrement Second",togglePeriod:"Toggle Period",selectTime:"Select Time"},useStrict:!1,sideBySide:!1,daysOfWeekDisabled:!1,calendarWeeks:!1,viewMode:"days",toolbarPlacement:"default",showTodayButton:!1,showClear:!1,showClose:!1,widgetPositioning:{horizontal:"auto",vertical:"auto"},widgetParent:null,
ignoreReadonly:!1,keepOpen:!1,focusOnShow:!0,inline:!1,keepInvalid:!1,datepickerInput:".datepickerinput",keyBinds:{up:function(c){if(c){var b=this.date()||this.getMoment();c.find(".datepicker").is(":visible")?this.date(b.clone().subtract(7,"d")):this.date(b.clone().add(this.stepping(),"m"))}},down:function(c){if(c){var b=this.date()||this.getMoment();c.find(".datepicker").is(":visible")?this.date(b.clone().add(7,"d")):this.date(b.clone().subtract(this.stepping(),"m"))}else this.show()},"control up":function(c){if(c){var b=
this.date()||this.getMoment();c.find(".datepicker").is(":visible")?this.date(b.clone().subtract(1,"y")):this.date(b.clone().add(1,"h"))}},"control down":function(c){if(c){var b=this.date()||this.getMoment();c.find(".datepicker").is(":visible")?this.date(b.clone().add(1,"y")):this.date(b.clone().subtract(1,"h"))}},left:function(c){if(c){var b=this.date()||this.getMoment();c.find(".datepicker").is(":visible")&&this.date(b.clone().subtract(1,"d"))}},right:function(c){if(c){var b=this.date()||this.getMoment();
c.find(".datepicker").is(":visible")&&this.date(b.clone().add(1,"d"))}},pageUp:function(c){if(c){var b=this.date()||this.getMoment();c.find(".datepicker").is(":visible")&&this.date(b.clone().subtract(1,"M"))}},pageDown:function(c){if(c){var b=this.date()||this.getMoment();c.find(".datepicker").is(":visible")&&this.date(b.clone().add(1,"M"))}},enter:function(){this.hide()},escape:function(){this.hide()},"control space":function(c){c.find(".timepicker").is(":visible")&&c.find('.btn[data-action="togglePeriod"]').click()},
t:function(){this.date(this.getMoment())},"delete":function(){this.clear()}},debug:!1,allowInputToggle:!1,disabledTimeIntervals:!1,disabledHours:!1,enabledHours:!1,viewDate:!1}});
;
/*! DataTables 1.10.2
 * 2008-2014 SpryMedia Ltd - datatables.net/license
 */
(function(za,O,l){var N=function(h){function T(a){var b,c,d={};h.each(a,function(e){if((b=e.match(/^([^A-Z]+?)([A-Z])/))&&-1!=="a aa ai ao as b fn i m o s ".indexOf(b[1]+" "))c=e.replace(b[0],b[2].toLowerCase()),d[c]=e,"o"===b[1]&&T(a[e])});a._hungarianMap=d}function G(a,b,c){a._hungarianMap||T(a);var d;h.each(b,function(e){d=a._hungarianMap[e];if(d!==l&&(c||b[d]===l))"o"===d.charAt(0)?(b[d]||(b[d]={}),h.extend(!0,b[d],b[e]),G(a[d],b[d],c)):b[d]=b[e]})}function N(a){var b=p.defaults.oLanguage,c=a.sZeroRecords;
!a.sEmptyTable&&(c&&"No data available in table"===b.sEmptyTable)&&D(a,a,"sZeroRecords","sEmptyTable");!a.sLoadingRecords&&(c&&"Loading..."===b.sLoadingRecords)&&D(a,a,"sZeroRecords","sLoadingRecords");a.sInfoThousands&&(a.sThousands=a.sInfoThousands);(a=a.sDecimal)&&cb(a)}function db(a){w(a,"ordering","bSort");w(a,"orderMulti","bSortMulti");w(a,"orderClasses","bSortClasses");w(a,"orderCellsTop","bSortCellsTop");w(a,"order","aaSorting");w(a,"orderFixed","aaSortingFixed");w(a,"paging","bPaginate");
w(a,"pagingType","sPaginationType");w(a,"pageLength","iDisplayLength");w(a,"searching","bFilter");if(a=a.aoSearchCols)for(var b=0,c=a.length;b<c;b++)a[b]&&G(p.models.oSearch,a[b])}function eb(a){w(a,"orderable","bSortable");w(a,"orderData","aDataSort");w(a,"orderSequence","asSorting");w(a,"orderDataType","sortDataType")}function fb(a){var a=a.oBrowser,b=h("<div/>").css({position:"absolute",top:0,left:0,height:1,width:1,overflow:"hidden"}).append(h("<div/>").css({position:"absolute",top:1,left:1,width:100,
overflow:"scroll"}).append(h('<div class="test"/>').css({width:"100%",height:10}))).appendTo("body"),c=b.find(".test");a.bScrollOversize=100===c[0].offsetWidth;a.bScrollbarLeft=1!==c.offset().left;b.remove()}function gb(a,b,c,d,e,f){var g,j=!1;c!==l&&(g=c,j=!0);for(;d!==e;)a.hasOwnProperty(d)&&(g=j?b(g,a[d],d,a):a[d],j=!0,d+=f);return g}function Aa(a,b){var c=p.defaults.column,d=a.aoColumns.length,c=h.extend({},p.models.oColumn,c,{nTh:b?b:O.createElement("th"),sTitle:c.sTitle?c.sTitle:b?b.innerHTML:
"",aDataSort:c.aDataSort?c.aDataSort:[d],mData:c.mData?c.mData:d,idx:d});a.aoColumns.push(c);c=a.aoPreSearchCols;c[d]=h.extend({},p.models.oSearch,c[d]);fa(a,d,null)}function fa(a,b,c){var b=a.aoColumns[b],d=a.oClasses,e=h(b.nTh);if(!b.sWidthOrig){b.sWidthOrig=e.attr("width")||null;var f=(e.attr("style")||"").match(/width:\s*(\d+[pxem%]+)/);f&&(b.sWidthOrig=f[1])}c!==l&&null!==c&&(eb(c),G(p.defaults.column,c),c.mDataProp!==l&&!c.mData&&(c.mData=c.mDataProp),c.sType&&(b._sManualType=c.sType),c.className&&
!c.sClass&&(c.sClass=c.className),h.extend(b,c),D(b,c,"sWidth","sWidthOrig"),"number"===typeof c.iDataSort&&(b.aDataSort=[c.iDataSort]),D(b,c,"aDataSort"));var g=b.mData,j=U(g),i=b.mRender?U(b.mRender):null,c=function(a){return"string"===typeof a&&-1!==a.indexOf("@")};b._bAttrSrc=h.isPlainObject(g)&&(c(g.sort)||c(g.type)||c(g.filter));b.fnGetData=function(a,b,c){var d=j(a,b,l,c);return i&&b?i(d,b,a,c):d};b.fnSetData=function(a,b,c){return Ba(g)(a,b,c)};a.oFeatures.bSort||(b.bSortable=!1,e.addClass(d.sSortableNone));
a=-1!==h.inArray("asc",b.asSorting);c=-1!==h.inArray("desc",b.asSorting);!b.bSortable||!a&&!c?(b.sSortingClass=d.sSortableNone,b.sSortingClassJUI=""):a&&!c?(b.sSortingClass=d.sSortableAsc,b.sSortingClassJUI=d.sSortJUIAscAllowed):!a&&c?(b.sSortingClass=d.sSortableDesc,b.sSortingClassJUI=d.sSortJUIDescAllowed):(b.sSortingClass=d.sSortable,b.sSortingClassJUI=d.sSortJUI)}function V(a){if(!1!==a.oFeatures.bAutoWidth){var b=a.aoColumns;Ca(a);for(var c=0,d=b.length;c<d;c++)b[c].nTh.style.width=b[c].sWidth}b=
a.oScroll;(""!==b.sY||""!==b.sX)&&W(a);u(a,null,"column-sizing",[a])}function ga(a,b){var c=X(a,"bVisible");return"number"===typeof c[b]?c[b]:null}function Y(a,b){var c=X(a,"bVisible"),c=h.inArray(b,c);return-1!==c?c:null}function Z(a){return X(a,"bVisible").length}function X(a,b){var c=[];h.map(a.aoColumns,function(a,e){a[b]&&c.push(e)});return c}function Da(a){var b=a.aoColumns,c=a.aoData,d=p.ext.type.detect,e,f,g,j,i,h,m,o,k;e=0;for(f=b.length;e<f;e++)if(m=b[e],k=[],!m.sType&&m._sManualType)m.sType=
m._sManualType;else if(!m.sType){g=0;for(j=d.length;g<j;g++){i=0;for(h=c.length;i<h&&!(k[i]===l&&(k[i]=A(a,i,e,"type")),o=d[g](k[i],a),!o||"html"===o);i++);if(o){m.sType=o;break}}m.sType||(m.sType="string")}}function hb(a,b,c,d){var e,f,g,j,i,n,m=a.aoColumns;if(b)for(e=b.length-1;0<=e;e--){n=b[e];var o=n.targets!==l?n.targets:n.aTargets;h.isArray(o)||(o=[o]);f=0;for(g=o.length;f<g;f++)if("number"===typeof o[f]&&0<=o[f]){for(;m.length<=o[f];)Aa(a);d(o[f],n)}else if("number"===typeof o[f]&&0>o[f])d(m.length+
o[f],n);else if("string"===typeof o[f]){j=0;for(i=m.length;j<i;j++)("_all"==o[f]||h(m[j].nTh).hasClass(o[f]))&&d(j,n)}}if(c){e=0;for(a=c.length;e<a;e++)d(e,c[e])}}function I(a,b,c,d){var e=a.aoData.length,f=h.extend(!0,{},p.models.oRow,{src:c?"dom":"data"});f._aData=b;a.aoData.push(f);for(var b=a.aoColumns,f=0,g=b.length;f<g;f++)c&&Ea(a,e,f,A(a,e,f)),b[f].sType=null;a.aiDisplayMaster.push(e);(c||!a.oFeatures.bDeferRender)&&Fa(a,e,c,d);return e}function ha(a,b){var c;b instanceof h||(b=h(b));return b.map(function(b,
e){c=ia(a,e);return I(a,c.data,e,c.cells)})}function A(a,b,c,d){var e=a.iDraw,f=a.aoColumns[c],g=a.aoData[b]._aData,j=f.sDefaultContent,c=f.fnGetData(g,d,{settings:a,row:b,col:c});if(c===l)return a.iDrawError!=e&&null===j&&(P(a,0,"Requested unknown parameter "+("function"==typeof f.mData?"{function}":"'"+f.mData+"'")+" for row "+b,4),a.iDrawError=e),j;if((c===g||null===c)&&null!==j)c=j;else if("function"===typeof c)return c.call(g);return null===c&&"display"==d?"":c}function Ea(a,b,c,d){a.aoColumns[c].fnSetData(a.aoData[b]._aData,
d,{settings:a,row:b,col:c})}function Ga(a){return h.map(a.match(/(\\.|[^\.])+/g),function(a){return a.replace(/\\./g,".")})}function U(a){if(h.isPlainObject(a)){var b={};h.each(a,function(a,c){c&&(b[a]=U(c))});return function(a,c,f,g){var j=b[c]||b._;return j!==l?j(a,c,f,g):a}}if(null===a)return function(a){return a};if("function"===typeof a)return function(b,c,f,g){return a(b,c,f,g)};if("string"===typeof a&&(-1!==a.indexOf(".")||-1!==a.indexOf("[")||-1!==a.indexOf("("))){var c=function(a,b,f){var g,
j;if(""!==f){j=Ga(f);for(var i=0,h=j.length;i<h;i++){f=j[i].match($);g=j[i].match(Q);if(f){j[i]=j[i].replace($,"");""!==j[i]&&(a=a[j[i]]);g=[];j.splice(0,i+1);j=j.join(".");i=0;for(h=a.length;i<h;i++)g.push(c(a[i],b,j));a=f[0].substring(1,f[0].length-1);a=""===a?g:g.join(a);break}else if(g){j[i]=j[i].replace(Q,"");a=a[j[i]]();continue}if(null===a||a[j[i]]===l)return l;a=a[j[i]]}}return a};return function(b,e){return c(b,e,a)}}return function(b){return b[a]}}function Ba(a){if(h.isPlainObject(a))return Ba(a._);
if(null===a)return function(){};if("function"===typeof a)return function(b,d,e){a(b,"set",d,e)};if("string"===typeof a&&(-1!==a.indexOf(".")||-1!==a.indexOf("[")||-1!==a.indexOf("("))){var b=function(a,d,e){var e=Ga(e),f;f=e[e.length-1];for(var g,j,i=0,h=e.length-1;i<h;i++){g=e[i].match($);j=e[i].match(Q);if(g){e[i]=e[i].replace($,"");a[e[i]]=[];f=e.slice();f.splice(0,i+1);g=f.join(".");j=0;for(h=d.length;j<h;j++)f={},b(f,d[j],g),a[e[i]].push(f);return}j&&(e[i]=e[i].replace(Q,""),a=a[e[i]](d));if(null===
a[e[i]]||a[e[i]]===l)a[e[i]]={};a=a[e[i]]}if(f.match(Q))a[f.replace(Q,"")](d);else a[f.replace($,"")]=d};return function(c,d){return b(c,d,a)}}return function(b,d){b[a]=d}}function Ha(a){return C(a.aoData,"_aData")}function ja(a){a.aoData.length=0;a.aiDisplayMaster.length=0;a.aiDisplay.length=0}function ka(a,b,c){for(var d=-1,e=0,f=a.length;e<f;e++)a[e]==b?d=e:a[e]>b&&a[e]--; -1!=d&&c===l&&a.splice(d,1)}function la(a,b,c,d){var e=a.aoData[b],f;if("dom"===c||(!c||"auto"===c)&&"dom"===e.src)e._aData=
ia(a,e).data;else{var g=e.anCells,j;if(g){c=0;for(f=g.length;c<f;c++){for(j=g[c];j.childNodes.length;)j.removeChild(j.firstChild);g[c].innerHTML=A(a,b,c,"display")}}}e._aSortData=null;e._aFilterData=null;a=a.aoColumns;if(d!==l)a[d].sType=null;else{c=0;for(f=a.length;c<f;c++)a[c].sType=null}Ia(e)}function ia(a,b){var c=[],d=[],e=b.firstChild,f,g,j,i=0,n,m=a.aoColumns,o=function(a,b,c){"string"===typeof a&&(b=a.indexOf("@"),-1!==b&&(a=a.substring(b+1),j["@"+a]=c.getAttribute(a)))},k=function(a){g=m[i];
n=h.trim(a.innerHTML);g&&g._bAttrSrc?(j={display:n},o(g.mData.sort,j,a),o(g.mData.type,j,a),o(g.mData.filter,j,a),c.push(j)):c.push(n);i++};if(e)for(;e;){f=e.nodeName.toUpperCase();if("TD"==f||"TH"==f)k(e),d.push(e);e=e.nextSibling}else{d=b.anCells;e=0;for(f=d.length;e<f;e++)k(d[e])}return{data:c,cells:d}}function Fa(a,b,c,d){var e=a.aoData[b],f=e._aData,g=[],j,i,h,m,o;if(null===e.nTr){j=c||O.createElement("tr");e.nTr=j;e.anCells=g;j._DT_RowIndex=b;Ia(e);m=0;for(o=a.aoColumns.length;m<o;m++){h=a.aoColumns[m];
i=c?d[m]:O.createElement(h.sCellType);g.push(i);if(!c||h.mRender||h.mData!==m)i.innerHTML=A(a,b,m,"display");h.sClass&&(i.className+=" "+h.sClass);h.bVisible&&!c?j.appendChild(i):!h.bVisible&&c&&i.parentNode.removeChild(i);h.fnCreatedCell&&h.fnCreatedCell.call(a.oInstance,i,A(a,b,m),f,b,m)}u(a,"aoRowCreatedCallback",null,[j,f,b])}e.nTr.setAttribute("role","row")}function Ia(a){var b=a.nTr,c=a._aData;if(b){c.DT_RowId&&(b.id=c.DT_RowId);if(c.DT_RowClass){var d=c.DT_RowClass.split(" ");a.__rowc=a.__rowc?
Ja(a.__rowc.concat(d)):d;h(b).removeClass(a.__rowc.join(" ")).addClass(c.DT_RowClass)}c.DT_RowData&&h(b).data(c.DT_RowData)}}function ib(a){var b,c,d,e,f,g=a.nTHead,j=a.nTFoot,i=0===h("th, td",g).length,n=a.oClasses,m=a.aoColumns;i&&(e=h("<tr/>").appendTo(g));b=0;for(c=m.length;b<c;b++)f=m[b],d=h(f.nTh).addClass(f.sClass),i&&d.appendTo(e),a.oFeatures.bSort&&(d.addClass(f.sSortingClass),!1!==f.bSortable&&(d.attr("tabindex",a.iTabIndex).attr("aria-controls",a.sTableId),Ka(a,f.nTh,b))),f.sTitle!=d.html()&&
d.html(f.sTitle),La(a,"header")(a,d,f,n);i&&aa(a.aoHeader,g);h(g).find(">tr").attr("role","row");h(g).find(">tr>th, >tr>td").addClass(n.sHeaderTH);h(j).find(">tr>th, >tr>td").addClass(n.sFooterTH);if(null!==j){a=a.aoFooter[0];b=0;for(c=a.length;b<c;b++)f=m[b],f.nTf=a[b].cell,f.sClass&&h(f.nTf).addClass(f.sClass)}}function ba(a,b,c){var d,e,f,g=[],j=[],i=a.aoColumns.length,n;if(b){c===l&&(c=!1);d=0;for(e=b.length;d<e;d++){g[d]=b[d].slice();g[d].nTr=b[d].nTr;for(f=i-1;0<=f;f--)!a.aoColumns[f].bVisible&&
!c&&g[d].splice(f,1);j.push([])}d=0;for(e=g.length;d<e;d++){if(a=g[d].nTr)for(;f=a.firstChild;)a.removeChild(f);f=0;for(b=g[d].length;f<b;f++)if(n=i=1,j[d][f]===l){a.appendChild(g[d][f].cell);for(j[d][f]=1;g[d+i]!==l&&g[d][f].cell==g[d+i][f].cell;)j[d+i][f]=1,i++;for(;g[d][f+n]!==l&&g[d][f].cell==g[d][f+n].cell;){for(c=0;c<i;c++)j[d+c][f+n]=1;n++}h(g[d][f].cell).attr("rowspan",i).attr("colspan",n)}}}}function K(a){var b=u(a,"aoPreDrawCallback","preDraw",[a]);if(-1!==h.inArray(!1,b))B(a,!1);else{var b=
[],c=0,d=a.asStripeClasses,e=d.length,f=a.oLanguage,g=a.iInitDisplayStart,j="ssp"==z(a),i=a.aiDisplay;a.bDrawing=!0;g!==l&&-1!==g&&(a._iDisplayStart=j?g:g>=a.fnRecordsDisplay()?0:g,a.iInitDisplayStart=-1);var g=a._iDisplayStart,n=a.fnDisplayEnd();if(a.bDeferLoading)a.bDeferLoading=!1,a.iDraw++,B(a,!1);else if(j){if(!a.bDestroying&&!jb(a))return}else a.iDraw++;if(0!==i.length){f=j?a.aoData.length:n;for(j=j?0:g;j<f;j++){var m=i[j],o=a.aoData[m];null===o.nTr&&Fa(a,m);m=o.nTr;if(0!==e){var k=d[c%e];o._sRowStripe!=
k&&(h(m).removeClass(o._sRowStripe).addClass(k),o._sRowStripe=k)}u(a,"aoRowCallback",null,[m,o._aData,c,j]);b.push(m);c++}}else c=f.sZeroRecords,1==a.iDraw&&"ajax"==z(a)?c=f.sLoadingRecords:f.sEmptyTable&&0===a.fnRecordsTotal()&&(c=f.sEmptyTable),b[0]=h("<tr/>",{"class":e?d[0]:""}).append(h("<td />",{valign:"top",colSpan:Z(a),"class":a.oClasses.sRowEmpty}).html(c))[0];u(a,"aoHeaderCallback","header",[h(a.nTHead).children("tr")[0],Ha(a),g,n,i]);u(a,"aoFooterCallback","footer",[h(a.nTFoot).children("tr")[0],
Ha(a),g,n,i]);d=h(a.nTBody);d.children().detach();d.append(h(b));u(a,"aoDrawCallback","draw",[a]);a.bSorted=!1;a.bFiltered=!1;a.bDrawing=!1}}function L(a,b){var c=a.oFeatures,d=c.bFilter;c.bSort&&kb(a);d?ca(a,a.oPreviousSearch):a.aiDisplay=a.aiDisplayMaster.slice();!0!==b&&(a._iDisplayStart=0);a._drawHold=b;K(a);a._drawHold=!1}function lb(a){var b=a.oClasses,c=h(a.nTable),c=h("<div/>").insertBefore(c),d=a.oFeatures,e=h("<div/>",{id:a.sTableId+"_wrapper","class":b.sWrapper+(a.nTFoot?"":" "+b.sNoFooter)});
a.nHolding=c[0];a.nTableWrapper=e[0];a.nTableReinsertBefore=a.nTable.nextSibling;for(var f=a.sDom.split(""),g,j,i,n,m,o,k=0;k<f.length;k++){g=null;j=f[k];if("<"==j){i=h("<div/>")[0];n=f[k+1];if("'"==n||'"'==n){m="";for(o=2;f[k+o]!=n;)m+=f[k+o],o++;"H"==m?m=b.sJUIHeader:"F"==m&&(m=b.sJUIFooter);-1!=m.indexOf(".")?(n=m.split("."),i.id=n[0].substr(1,n[0].length-1),i.className=n[1]):"#"==m.charAt(0)?i.id=m.substr(1,m.length-1):i.className=m;k+=o}e.append(i);e=h(i)}else if(">"==j)e=e.parent();else if("l"==
j&&d.bPaginate&&d.bLengthChange)g=mb(a);else if("f"==j&&d.bFilter)g=nb(a);else if("r"==j&&d.bProcessing)g=ob(a);else if("t"==j)g=pb(a);else if("i"==j&&d.bInfo)g=qb(a);else if("p"==j&&d.bPaginate)g=rb(a);else if(0!==p.ext.feature.length){i=p.ext.feature;o=0;for(n=i.length;o<n;o++)if(j==i[o].cFeature){g=i[o].fnInit(a);break}}g&&(i=a.aanFeatures,i[j]||(i[j]=[]),i[j].push(g),e.append(g))}c.replaceWith(e)}function aa(a,b){var c=h(b).children("tr"),d,e,f,g,j,i,n,m,o,k;a.splice(0,a.length);f=0;for(i=c.length;f<
i;f++)a.push([]);f=0;for(i=c.length;f<i;f++){d=c[f];for(e=d.firstChild;e;){if("TD"==e.nodeName.toUpperCase()||"TH"==e.nodeName.toUpperCase()){m=1*e.getAttribute("colspan");o=1*e.getAttribute("rowspan");m=!m||0===m||1===m?1:m;o=!o||0===o||1===o?1:o;g=0;for(j=a[f];j[g];)g++;n=g;k=1===m?!0:!1;for(j=0;j<m;j++)for(g=0;g<o;g++)a[f+g][n+j]={cell:e,unique:k},a[f+g].nTr=d}e=e.nextSibling}}}function ma(a,b,c){var d=[];c||(c=a.aoHeader,b&&(c=[],aa(c,b)));for(var b=0,e=c.length;b<e;b++)for(var f=0,g=c[b].length;f<
g;f++)if(c[b][f].unique&&(!d[f]||!a.bSortCellsTop))d[f]=c[b][f].cell;return d}function na(a,b,c){u(a,"aoServerParams","serverParams",[b]);if(b&&h.isArray(b)){var d={},e=/(.*?)\[\]$/;h.each(b,function(a,b){var c=b.name.match(e);c?(c=c[0],d[c]||(d[c]=[]),d[c].push(b.value)):d[b.name]=b.value});b=d}var f,g=a.ajax,j=a.oInstance;if(h.isPlainObject(g)&&g.data){f=g.data;var i=h.isFunction(f)?f(b):f,b=h.isFunction(f)&&i?i:h.extend(!0,b,i);delete g.data}i={data:b,success:function(b){var d=b.error||b.sError;
d&&a.oApi._fnLog(a,0,d);a.json=b;u(a,null,"xhr",[a,b]);c(b)},dataType:"json",cache:!1,type:a.sServerMethod,error:function(b,c){var d=a.oApi._fnLog;"parsererror"==c?d(a,0,"Invalid JSON response",1):4===b.readyState&&d(a,0,"Ajax error",7);B(a,!1)}};a.oAjaxData=b;u(a,null,"preXhr",[a,b]);a.fnServerData?a.fnServerData.call(j,a.sAjaxSource,h.map(b,function(a,b){return{name:b,value:a}}),c,a):a.sAjaxSource||"string"===typeof g?a.jqXHR=h.ajax(h.extend(i,{url:g||a.sAjaxSource})):h.isFunction(g)?a.jqXHR=g.call(j,
b,c,a):(a.jqXHR=h.ajax(h.extend(i,g)),g.data=f)}function jb(a){return a.bAjaxDataGet?(a.iDraw++,B(a,!0),na(a,sb(a),function(b){tb(a,b)}),!1):!0}function sb(a){var b=a.aoColumns,c=b.length,d=a.oFeatures,e=a.oPreviousSearch,f=a.aoPreSearchCols,g,j=[],i,n,m,o=R(a);g=a._iDisplayStart;i=!1!==d.bPaginate?a._iDisplayLength:-1;var k=function(a,b){j.push({name:a,value:b})};k("sEcho",a.iDraw);k("iColumns",c);k("sColumns",C(b,"sName").join(","));k("iDisplayStart",g);k("iDisplayLength",i);var l={draw:a.iDraw,
columns:[],order:[],start:g,length:i,search:{value:e.sSearch,regex:e.bRegex}};for(g=0;g<c;g++)n=b[g],m=f[g],i="function"==typeof n.mData?"function":n.mData,l.columns.push({data:i,name:n.sName,searchable:n.bSearchable,orderable:n.bSortable,search:{value:m.sSearch,regex:m.bRegex}}),k("mDataProp_"+g,i),d.bFilter&&(k("sSearch_"+g,m.sSearch),k("bRegex_"+g,m.bRegex),k("bSearchable_"+g,n.bSearchable)),d.bSort&&k("bSortable_"+g,n.bSortable);d.bFilter&&(k("sSearch",e.sSearch),k("bRegex",e.bRegex));d.bSort&&
(h.each(o,function(a,b){l.order.push({column:b.col,dir:b.dir});k("iSortCol_"+a,b.col);k("sSortDir_"+a,b.dir)}),k("iSortingCols",o.length));b=p.ext.legacy.ajax;return null===b?a.sAjaxSource?j:l:b?j:l}function tb(a,b){var c=b.sEcho!==l?b.sEcho:b.draw,d=b.iTotalRecords!==l?b.iTotalRecords:b.recordsTotal,e=b.iTotalDisplayRecords!==l?b.iTotalDisplayRecords:b.recordsFiltered;if(c){if(1*c<a.iDraw)return;a.iDraw=1*c}ja(a);a._iRecordsTotal=parseInt(d,10);a._iRecordsDisplay=parseInt(e,10);c=oa(a,b);d=0;for(e=
c.length;d<e;d++)I(a,c[d]);a.aiDisplay=a.aiDisplayMaster.slice();a.bAjaxDataGet=!1;K(a);a._bInitComplete||pa(a,b);a.bAjaxDataGet=!0;B(a,!1)}function oa(a,b){var c=h.isPlainObject(a.ajax)&&a.ajax.dataSrc!==l?a.ajax.dataSrc:a.sAjaxDataProp;return"data"===c?b.aaData||b[c]:""!==c?U(c)(b):b}function nb(a){var b=a.oClasses,c=a.sTableId,d=a.oLanguage,e=a.oPreviousSearch,f=a.aanFeatures,g='<input type="search" class="'+b.sFilterInput+'"/>',j=d.sSearch,j=j.match(/_INPUT_/)?j.replace("_INPUT_",g):j+g,b=h("<div/>",
{id:!f.f?c+"_filter":null,"class":b.sFilter}).append(h("<label/>").append(j)),f=function(){var b=!this.value?"":this.value;b!=e.sSearch&&(ca(a,{sSearch:b,bRegex:e.bRegex,bSmart:e.bSmart,bCaseInsensitive:e.bCaseInsensitive}),a._iDisplayStart=0,K(a))},i=h("input",b).val(e.sSearch).attr("placeholder",d.sSearchPlaceholder).bind("keyup.DT search.DT input.DT paste.DT cut.DT","ssp"===z(a)?Ma(f,400):f).bind("keypress.DT",function(a){if(13==a.keyCode)return!1}).attr("aria-controls",c);h(a.nTable).on("search.dt.DT",
function(b,c){if(a===c)try{i[0]!==O.activeElement&&i.val(e.sSearch)}catch(d){}});return b[0]}function ca(a,b,c){var d=a.oPreviousSearch,e=a.aoPreSearchCols,f=function(a){d.sSearch=a.sSearch;d.bRegex=a.bRegex;d.bSmart=a.bSmart;d.bCaseInsensitive=a.bCaseInsensitive};Da(a);if("ssp"!=z(a)){ub(a,b.sSearch,c,b.bEscapeRegex!==l?!b.bEscapeRegex:b.bRegex,b.bSmart,b.bCaseInsensitive);f(b);for(b=0;b<e.length;b++)vb(a,e[b].sSearch,b,e[b].bEscapeRegex!==l?!e[b].bEscapeRegex:e[b].bRegex,e[b].bSmart,e[b].bCaseInsensitive);
wb(a)}else f(b);a.bFiltered=!0;u(a,null,"search",[a])}function wb(a){for(var b=p.ext.search,c=a.aiDisplay,d,e,f=0,g=b.length;f<g;f++){for(var j=[],i=0,h=c.length;i<h;i++)e=c[i],d=a.aoData[e],b[f](a,d._aFilterData,e,d._aData,i)&&j.push(e);c.length=0;c.push.apply(c,j)}}function vb(a,b,c,d,e,f){if(""!==b)for(var g=a.aiDisplay,d=Na(b,d,e,f),e=g.length-1;0<=e;e--)b=a.aoData[g[e]]._aFilterData[c],d.test(b)||g.splice(e,1)}function ub(a,b,c,d,e,f){var d=Na(b,d,e,f),e=a.oPreviousSearch.sSearch,f=a.aiDisplayMaster,
g;0!==p.ext.search.length&&(c=!0);g=xb(a);if(0>=b.length)a.aiDisplay=f.slice();else{if(g||c||e.length>b.length||0!==b.indexOf(e)||a.bSorted)a.aiDisplay=f.slice();b=a.aiDisplay;for(c=b.length-1;0<=c;c--)d.test(a.aoData[b[c]]._sFilterRow)||b.splice(c,1)}}function Na(a,b,c,d){a=b?a:Oa(a);c&&(a="^(?=.*?"+h.map(a.match(/"[^"]+"|[^ ]+/g)||"",function(a){return'"'===a.charAt(0)?a.match(/^"(.*)"$/)[1]:a}).join(")(?=.*?")+").*$");return RegExp(a,d?"i":"")}function Oa(a){return a.replace(Vb,"\\$1")}function xb(a){var b=
a.aoColumns,c,d,e,f,g,j,i,h,m=p.ext.type.search;c=!1;d=0;for(f=a.aoData.length;d<f;d++)if(h=a.aoData[d],!h._aFilterData){j=[];e=0;for(g=b.length;e<g;e++)c=b[e],c.bSearchable?(i=A(a,d,e,"filter"),m[c.sType]&&(i=m[c.sType](i)),null===i&&(i=""),"string"!==typeof i&&i.toString&&(i=i.toString())):i="",i.indexOf&&-1!==i.indexOf("&")&&(qa.innerHTML=i,i=Wb?qa.textContent:qa.innerText),i.replace&&(i=i.replace(/[\r\n]/g,"")),j.push(i);h._aFilterData=j;h._sFilterRow=j.join("  ");c=!0}return c}function yb(a){return{search:a.sSearch,
smart:a.bSmart,regex:a.bRegex,caseInsensitive:a.bCaseInsensitive}}function zb(a){return{sSearch:a.search,bSmart:a.smart,bRegex:a.regex,bCaseInsensitive:a.caseInsensitive}}function qb(a){var b=a.sTableId,c=a.aanFeatures.i,d=h("<div/>",{"class":a.oClasses.sInfo,id:!c?b+"_info":null});c||(a.aoDrawCallback.push({fn:Ab,sName:"information"}),d.attr("role","status").attr("aria-live","polite"),h(a.nTable).attr("aria-describedby",b+"_info"));return d[0]}function Ab(a){var b=a.aanFeatures.i;if(0!==b.length){var c=
a.oLanguage,d=a._iDisplayStart+1,e=a.fnDisplayEnd(),f=a.fnRecordsTotal(),g=a.fnRecordsDisplay(),j=g?c.sInfo:c.sInfoEmpty;g!==f&&(j+=" "+c.sInfoFiltered);j+=c.sInfoPostFix;j=Bb(a,j);c=c.fnInfoCallback;null!==c&&(j=c.call(a.oInstance,a,d,e,f,g,j));h(b).html(j)}}function Bb(a,b){var c=a.fnFormatNumber,d=a._iDisplayStart+1,e=a._iDisplayLength,f=a.fnRecordsDisplay(),g=-1===e;return b.replace(/_START_/g,c.call(a,d)).replace(/_END_/g,c.call(a,a.fnDisplayEnd())).replace(/_MAX_/g,c.call(a,a.fnRecordsTotal())).replace(/_TOTAL_/g,
c.call(a,f)).replace(/_PAGE_/g,c.call(a,g?1:Math.ceil(d/e))).replace(/_PAGES_/g,c.call(a,g?1:Math.ceil(f/e)))}function ra(a){var b,c,d=a.iInitDisplayStart,e=a.aoColumns,f;c=a.oFeatures;if(a.bInitialised){lb(a);ib(a);ba(a,a.aoHeader);ba(a,a.aoFooter);B(a,!0);c.bAutoWidth&&Ca(a);b=0;for(c=e.length;b<c;b++)f=e[b],f.sWidth&&(f.nTh.style.width=s(f.sWidth));L(a);e=z(a);"ssp"!=e&&("ajax"==e?na(a,[],function(c){var f=oa(a,c);for(b=0;b<f.length;b++)I(a,f[b]);a.iInitDisplayStart=d;L(a);B(a,!1);pa(a,c)},a):
(B(a,!1),pa(a)))}else setTimeout(function(){ra(a)},200)}function pa(a,b){a._bInitComplete=!0;b&&V(a);u(a,"aoInitComplete","init",[a,b])}function Pa(a,b){var c=parseInt(b,10);a._iDisplayLength=c;Qa(a);u(a,null,"length",[a,c])}function mb(a){for(var b=a.oClasses,c=a.sTableId,d=a.aLengthMenu,e=h.isArray(d[0]),f=e?d[0]:d,d=e?d[1]:d,e=h("<select/>",{name:c+"_length","aria-controls":c,"class":b.sLengthSelect}),g=0,j=f.length;g<j;g++)e[0][g]=new Option(d[g],f[g]);var i=h("<div><label/></div>").addClass(b.sLength);
a.aanFeatures.l||(i[0].id=c+"_length");i.children().append(a.oLanguage.sLengthMenu.replace("_MENU_",e[0].outerHTML));h("select",i).val(a._iDisplayLength).bind("change.DT",function(){Pa(a,h(this).val());K(a)});h(a.nTable).bind("length.dt.DT",function(b,c,d){a===c&&h("select",i).val(d)});return i[0]}function rb(a){var b=a.sPaginationType,c=p.ext.pager[b],d="function"===typeof c,e=function(a){K(a)},b=h("<div/>").addClass(a.oClasses.sPaging+b)[0],f=a.aanFeatures;d||c.fnInit(a,b,e);f.p||(b.id=a.sTableId+
"_paginate",a.aoDrawCallback.push({fn:function(a){if(d){var b=a._iDisplayStart,i=a._iDisplayLength,h=a.fnRecordsDisplay(),m=-1===i,b=m?0:Math.ceil(b/i),i=m?1:Math.ceil(h/i),h=c(b,i),o,m=0;for(o=f.p.length;m<o;m++)La(a,"pageButton")(a,f.p[m],m,h,b,i)}else c.fnUpdate(a,e)},sName:"pagination"}));return b}function Ra(a,b,c){var d=a._iDisplayStart,e=a._iDisplayLength,f=a.fnRecordsDisplay();0===f||-1===e?d=0:"number"===typeof b?(d=b*e,d>f&&(d=0)):"first"==b?d=0:"previous"==b?(d=0<=e?d-e:0,0>d&&(d=0)):"next"==
b?d+e<f&&(d+=e):"last"==b?d=Math.floor((f-1)/e)*e:P(a,0,"Unknown paging action: "+b,5);b=a._iDisplayStart!==d;a._iDisplayStart=d;b&&(u(a,null,"page",[a]),c&&K(a));return b}function ob(a){return h("<div/>",{id:!a.aanFeatures.r?a.sTableId+"_processing":null,"class":a.oClasses.sProcessing}).html(a.oLanguage.sProcessing).insertBefore(a.nTable)[0]}function B(a,b){a.oFeatures.bProcessing&&h(a.aanFeatures.r).css("display",b?"block":"none");u(a,null,"processing",[a,b])}function pb(a){var b=h(a.nTable);b.attr("role",
"grid");var c=a.oScroll;if(""===c.sX&&""===c.sY)return a.nTable;var d=c.sX,e=c.sY,f=a.oClasses,g=b.children("caption"),j=g.length?g[0]._captionSide:null,i=h(b[0].cloneNode(!1)),n=h(b[0].cloneNode(!1)),m=b.children("tfoot");c.sX&&"100%"===b.attr("width")&&b.removeAttr("width");m.length||(m=null);c=h("<div/>",{"class":f.sScrollWrapper}).append(h("<div/>",{"class":f.sScrollHead}).css({overflow:"hidden",position:"relative",border:0,width:d?!d?null:s(d):"100%"}).append(h("<div/>",{"class":f.sScrollHeadInner}).css({"box-sizing":"content-box",
width:c.sXInner||"100%"}).append(i.removeAttr("id").css("margin-left",0).append(b.children("thead")))).append("top"===j?g:null)).append(h("<div/>",{"class":f.sScrollBody}).css({overflow:"auto",height:!e?null:s(e),width:!d?null:s(d)}).append(b));m&&c.append(h("<div/>",{"class":f.sScrollFoot}).css({overflow:"hidden",border:0,width:d?!d?null:s(d):"100%"}).append(h("<div/>",{"class":f.sScrollFootInner}).append(n.removeAttr("id").css("margin-left",0).append(b.children("tfoot")))).append("bottom"===j?g:
null));var b=c.children(),o=b[0],f=b[1],k=m?b[2]:null;d&&h(f).scroll(function(){var a=this.scrollLeft;o.scrollLeft=a;m&&(k.scrollLeft=a)});a.nScrollHead=o;a.nScrollBody=f;a.nScrollFoot=k;a.aoDrawCallback.push({fn:W,sName:"scrolling"});return c[0]}function W(a){var b=a.oScroll,c=b.sX,d=b.sXInner,e=b.sY,f=b.iBarWidth,g=h(a.nScrollHead),j=g[0].style,i=g.children("div"),n=i[0].style,m=i.children("table"),i=a.nScrollBody,o=h(i),k=i.style,l=h(a.nScrollFoot).children("div"),p=l.children("table"),r=h(a.nTHead),
q=h(a.nTable),da=q[0],M=da.style,J=a.nTFoot?h(a.nTFoot):null,u=a.oBrowser,v=u.bScrollOversize,y,t,x,w,z,A=[],B=[],C=[],D,E=function(a){a=a.style;a.paddingTop="0";a.paddingBottom="0";a.borderTopWidth="0";a.borderBottomWidth="0";a.height=0};q.children("thead, tfoot").remove();z=r.clone().prependTo(q);y=r.find("tr");x=z.find("tr");z.find("th, td").removeAttr("tabindex");J&&(w=J.clone().prependTo(q),t=J.find("tr"),w=w.find("tr"));c||(k.width="100%",g[0].style.width="100%");h.each(ma(a,z),function(b,c){D=
ga(a,b);c.style.width=a.aoColumns[D].sWidth});J&&F(function(a){a.style.width=""},w);b.bCollapse&&""!==e&&(k.height=o[0].offsetHeight+r[0].offsetHeight+"px");g=q.outerWidth();if(""===c){if(M.width="100%",v&&(q.find("tbody").height()>i.offsetHeight||"scroll"==o.css("overflow-y")))M.width=s(q.outerWidth()-f)}else""!==d?M.width=s(d):g==o.width()&&o.height()<q.height()?(M.width=s(g-f),q.outerWidth()>g-f&&(M.width=s(g))):M.width=s(g);g=q.outerWidth();F(E,x);F(function(a){C.push(a.innerHTML);A.push(s(h(a).css("width")))},
x);F(function(a,b){a.style.width=A[b]},y);h(x).height(0);J&&(F(E,w),F(function(a){B.push(s(h(a).css("width")))},w),F(function(a,b){a.style.width=B[b]},t),h(w).height(0));F(function(a,b){a.innerHTML='<div class="dataTables_sizing" style="height:0;overflow:hidden;">'+C[b]+"</div>";a.style.width=A[b]},x);J&&F(function(a,b){a.innerHTML="";a.style.width=B[b]},w);if(q.outerWidth()<g){t=i.scrollHeight>i.offsetHeight||"scroll"==o.css("overflow-y")?g+f:g;if(v&&(i.scrollHeight>i.offsetHeight||"scroll"==o.css("overflow-y")))M.width=
s(t-f);(""===c||""!==d)&&P(a,1,"Possible column misalignment",6)}else t="100%";k.width=s(t);j.width=s(t);J&&(a.nScrollFoot.style.width=s(t));!e&&v&&(k.height=s(da.offsetHeight+f));e&&b.bCollapse&&(k.height=s(e),b=c&&da.offsetWidth>i.offsetWidth?f:0,da.offsetHeight<i.offsetHeight&&(k.height=s(da.offsetHeight+b)));b=q.outerWidth();m[0].style.width=s(b);n.width=s(b);m=q.height()>i.clientHeight||"scroll"==o.css("overflow-y");u="padding"+(u.bScrollbarLeft?"Left":"Right");n[u]=m?f+"px":"0px";J&&(p[0].style.width=
s(b),l[0].style.width=s(b),l[0].style[u]=m?f+"px":"0px");o.scroll();if((a.bSorted||a.bFiltered)&&!a._drawHold)i.scrollTop=0}function F(a,b,c){for(var d=0,e=0,f=b.length,g,j;e<f;){g=b[e].firstChild;for(j=c?c[e].firstChild:null;g;)1===g.nodeType&&(c?a(g,j,d):a(g,d),d++),g=g.nextSibling,j=c?j.nextSibling:null;e++}}function Ca(a){var b=a.nTable,c=a.aoColumns,d=a.oScroll,e=d.sY,f=d.sX,g=d.sXInner,j=c.length,d=X(a,"bVisible"),i=h("th",a.nTHead),n=b.getAttribute("width"),m=b.parentNode,o=!1,k,l;for(k=0;k<
d.length;k++)l=c[d[k]],null!==l.sWidth&&(l.sWidth=Cb(l.sWidthOrig,m),o=!0);if(!o&&!f&&!e&&j==Z(a)&&j==i.length)for(k=0;k<j;k++)c[k].sWidth=s(i.eq(k).width());else{j=h(b).clone().empty().css("visibility","hidden").removeAttr("id").append(h(a.nTHead).clone(!1)).append(h(a.nTFoot).clone(!1)).append(h("<tbody><tr/></tbody>"));j.find("tfoot th, tfoot td").css("width","");var p=j.find("tbody tr"),i=ma(a,j.find("thead")[0]);for(k=0;k<d.length;k++)l=c[d[k]],i[k].style.width=null!==l.sWidthOrig&&""!==l.sWidthOrig?
s(l.sWidthOrig):"";if(a.aoData.length)for(k=0;k<d.length;k++)o=d[k],l=c[o],h(Db(a,o)).clone(!1).append(l.sContentPadding).appendTo(p);j.appendTo(m);f&&g?j.width(g):f?(j.css("width","auto"),j.width()<m.offsetWidth&&j.width(m.offsetWidth)):e?j.width(m.offsetWidth):n&&j.width(n);Eb(a,j[0]);if(f){for(k=g=0;k<d.length;k++)l=c[d[k]],e=h(i[k]).outerWidth(),g+=null===l.sWidthOrig?e:parseInt(l.sWidth,10)+e-h(i[k]).width();j.width(s(g));b.style.width=s(g)}for(k=0;k<d.length;k++)if(l=c[d[k]],e=h(i[k]).width())l.sWidth=
s(e);b.style.width=s(j.css("width"));j.remove()}n&&(b.style.width=s(n));if((n||f)&&!a._reszEvt)h(za).bind("resize.DT-"+a.sInstance,Ma(function(){V(a)})),a._reszEvt=!0}function Ma(a,b){var c=b||200,d,e;return function(){var b=this,g=+new Date,j=arguments;d&&g<d+c?(clearTimeout(e),e=setTimeout(function(){d=l;a.apply(b,j)},c)):d?(d=g,a.apply(b,j)):d=g}}function Cb(a,b){if(!a)return 0;var c=h("<div/>").css("width",s(a)).appendTo(b||O.body),d=c[0].offsetWidth;c.remove();return d}function Eb(a,b){var c=
a.oScroll;if(c.sX||c.sY)c=!c.sX?c.iBarWidth:0,b.style.width=s(h(b).outerWidth()-c)}function Db(a,b){var c=Fb(a,b);if(0>c)return null;var d=a.aoData[c];return!d.nTr?h("<td/>").html(A(a,c,b,"display"))[0]:d.anCells[b]}function Fb(a,b){for(var c,d=-1,e=-1,f=0,g=a.aoData.length;f<g;f++)c=A(a,f,b,"display")+"",c=c.replace(Xb,""),c.length>d&&(d=c.length,e=f);return e}function s(a){return null===a?"0px":"number"==typeof a?0>a?"0px":a+"px":a.match(/\d$/)?a+"px":a}function Gb(){if(!p.__scrollbarWidth){var a=
h("<p/>").css({width:"100%",height:200,padding:0})[0],b=h("<div/>").css({position:"absolute",top:0,left:0,width:200,height:150,padding:0,overflow:"hidden",visibility:"hidden"}).append(a).appendTo("body"),c=a.offsetWidth;b.css("overflow","scroll");a=a.offsetWidth;c===a&&(a=b[0].clientWidth);b.remove();p.__scrollbarWidth=c-a}return p.__scrollbarWidth}function R(a){var b,c,d=[],e=a.aoColumns,f,g,j,i;b=a.aaSortingFixed;c=h.isPlainObject(b);var n=[];f=function(a){a.length&&!h.isArray(a[0])?n.push(a):n.push.apply(n,
a)};h.isArray(b)&&f(b);c&&b.pre&&f(b.pre);f(a.aaSorting);c&&b.post&&f(b.post);for(a=0;a<n.length;a++){i=n[a][0];f=e[i].aDataSort;b=0;for(c=f.length;b<c;b++)g=f[b],j=e[g].sType||"string",d.push({src:i,col:g,dir:n[a][1],index:n[a][2],type:j,formatter:p.ext.type.order[j+"-pre"]})}return d}function kb(a){var b,c,d=[],e=p.ext.type.order,f=a.aoData,g=0,j,i=a.aiDisplayMaster,h;Da(a);h=R(a);b=0;for(c=h.length;b<c;b++)j=h[b],j.formatter&&g++,Hb(a,j.col);if("ssp"!=z(a)&&0!==h.length){b=0;for(c=i.length;b<c;b++)d[i[b]]=
b;g===h.length?i.sort(function(a,b){var c,e,g,j,i=h.length,l=f[a]._aSortData,p=f[b]._aSortData;for(g=0;g<i;g++)if(j=h[g],c=l[j.col],e=p[j.col],c=c<e?-1:c>e?1:0,0!==c)return"asc"===j.dir?c:-c;c=d[a];e=d[b];return c<e?-1:c>e?1:0}):i.sort(function(a,b){var c,g,j,i,l=h.length,p=f[a]._aSortData,r=f[b]._aSortData;for(j=0;j<l;j++)if(i=h[j],c=p[i.col],g=r[i.col],i=e[i.type+"-"+i.dir]||e["string-"+i.dir],c=i(c,g),0!==c)return c;c=d[a];g=d[b];return c<g?-1:c>g?1:0})}a.bSorted=!0}function Ib(a){for(var b,c,
d=a.aoColumns,e=R(a),a=a.oLanguage.oAria,f=0,g=d.length;f<g;f++){c=d[f];var j=c.asSorting;b=c.sTitle.replace(/<.*?>/g,"");var i=c.nTh;i.removeAttribute("aria-sort");c.bSortable&&(0<e.length&&e[0].col==f?(i.setAttribute("aria-sort","asc"==e[0].dir?"ascending":"descending"),c=j[e[0].index+1]||j[0]):c=j[0],b+="asc"===c?a.sSortAscending:a.sSortDescending);i.setAttribute("aria-label",b)}}function Sa(a,b,c,d){var e=a.aaSorting,f=a.aoColumns[b].asSorting,g=function(a){var b=a._idx;b===l&&(b=h.inArray(a[1],
f));return b+1>=f.length?0:b+1};"number"===typeof e[0]&&(e=a.aaSorting=[e]);c&&a.oFeatures.bSortMulti?(c=h.inArray(b,C(e,"0")),-1!==c?(b=g(e[c]),e[c][1]=f[b],e[c]._idx=b):(e.push([b,f[0],0]),e[e.length-1]._idx=0)):e.length&&e[0][0]==b?(b=g(e[0]),e.length=1,e[0][1]=f[b],e[0]._idx=b):(e.length=0,e.push([b,f[0]]),e[0]._idx=0);L(a);"function"==typeof d&&d(a)}function Ka(a,b,c,d){var e=a.aoColumns[c];Ta(b,{},function(b){!1!==e.bSortable&&(a.oFeatures.bProcessing?(B(a,!0),setTimeout(function(){Sa(a,c,b.shiftKey,
d);"ssp"!==z(a)&&B(a,!1)},0)):Sa(a,c,b.shiftKey,d))})}function sa(a){var b=a.aLastSort,c=a.oClasses.sSortColumn,d=R(a),e=a.oFeatures,f,g;if(e.bSort&&e.bSortClasses){e=0;for(f=b.length;e<f;e++)g=b[e].src,h(C(a.aoData,"anCells",g)).removeClass(c+(2>e?e+1:3));e=0;for(f=d.length;e<f;e++)g=d[e].src,h(C(a.aoData,"anCells",g)).addClass(c+(2>e?e+1:3))}a.aLastSort=d}function Hb(a,b){var c=a.aoColumns[b],d=p.ext.order[c.sSortDataType],e;d&&(e=d.call(a.oInstance,a,b,Y(a,b)));for(var f,g=p.ext.type.order[c.sType+
"-pre"],j=0,i=a.aoData.length;j<i;j++)if(c=a.aoData[j],c._aSortData||(c._aSortData=[]),!c._aSortData[b]||d)f=d?e[j]:A(a,j,b,"sort"),c._aSortData[b]=g?g(f):f}function ta(a){if(a.oFeatures.bStateSave&&!a.bDestroying){var b={time:+new Date,start:a._iDisplayStart,length:a._iDisplayLength,order:h.extend(!0,[],a.aaSorting),search:yb(a.oPreviousSearch),columns:h.map(a.aoColumns,function(b,d){return{visible:b.bVisible,search:yb(a.aoPreSearchCols[d])}})};u(a,"aoStateSaveParams","stateSaveParams",[a,b]);a.oSavedState=
b;a.fnStateSaveCallback.call(a.oInstance,a,b)}}function Jb(a){var b,c,d=a.aoColumns;if(a.oFeatures.bStateSave){var e=a.fnStateLoadCallback.call(a.oInstance,a);if(e&&e.time&&(b=u(a,"aoStateLoadParams","stateLoadParams",[a,e]),-1===h.inArray(!1,b)&&(b=a.iStateDuration,!(0<b&&e.time<+new Date-1E3*b)&&d.length===e.columns.length))){a.oLoadedState=h.extend(!0,{},e);a._iDisplayStart=e.start;a.iInitDisplayStart=e.start;a._iDisplayLength=e.length;a.aaSorting=[];h.each(e.order,function(b,c){a.aaSorting.push(c[0]>=
d.length?[0,c[1]]:c)});h.extend(a.oPreviousSearch,zb(e.search));b=0;for(c=e.columns.length;b<c;b++){var f=e.columns[b];d[b].bVisible=f.visible;h.extend(a.aoPreSearchCols[b],zb(f.search))}u(a,"aoStateLoaded","stateLoaded",[a,e])}}}function ua(a){var b=p.settings,a=h.inArray(a,C(b,"nTable"));return-1!==a?b[a]:null}function P(a,b,c,d){c="DataTables warning: "+(null!==a?"table id="+a.sTableId+" - ":"")+c;d&&(c+=". For more information about this error, please see http://datatables.net/tn/"+d);if(b)za.console&&
console.log&&console.log(c);else if(a=p.ext,"alert"==(a.sErrMode||a.errMode))alert(c);else throw Error(c);}function D(a,b,c,d){h.isArray(c)?h.each(c,function(c,d){h.isArray(d)?D(a,b,d[0],d[1]):D(a,b,d)}):(d===l&&(d=c),b[c]!==l&&(a[d]=b[c]))}function Kb(a,b,c){var d,e;for(e in b)b.hasOwnProperty(e)&&(d=b[e],h.isPlainObject(d)?(h.isPlainObject(a[e])||(a[e]={}),h.extend(!0,a[e],d)):a[e]=c&&"data"!==e&&"aaData"!==e&&h.isArray(d)?d.slice():d);return a}function Ta(a,b,c){h(a).bind("click.DT",b,function(b){a.blur();
c(b)}).bind("keypress.DT",b,function(a){13===a.which&&(a.preventDefault(),c(a))}).bind("selectstart.DT",function(){return!1})}function x(a,b,c,d){c&&a[b].push({fn:c,sName:d})}function u(a,b,c,d){var e=[];b&&(e=h.map(a[b].slice().reverse(),function(b){return b.fn.apply(a.oInstance,d)}));null!==c&&h(a.nTable).trigger(c+".dt",d);return e}function Qa(a){var b=a._iDisplayStart,c=a.fnDisplayEnd(),d=a._iDisplayLength;c===a.fnRecordsDisplay()&&(b=c-d);if(-1===d||0>b)b=0;a._iDisplayStart=b}function La(a,b){var c=
a.renderer,d=p.ext.renderer[b];return h.isPlainObject(c)&&c[b]?d[c[b]]||d._:"string"===typeof c?d[c]||d._:d._}function z(a){return a.oFeatures.bServerSide?"ssp":a.ajax||a.sAjaxSource?"ajax":"dom"}function Ua(a,b){var c=[],c=Lb.numbers_length,d=Math.floor(c/2);b<=c?c=S(0,b):a<=d?(c=S(0,c-2),c.push("ellipsis"),c.push(b-1)):(a>=b-1-d?c=S(b-(c-2),b):(c=S(a-1,a+2),c.push("ellipsis"),c.push(b-1)),c.splice(0,0,"ellipsis"),c.splice(0,0,0));c.DT_el="span";return c}function cb(a){h.each({num:function(b){return va(b,
a)},"num-fmt":function(b){return va(b,a,Va)},"html-num":function(b){return va(b,a,wa)},"html-num-fmt":function(b){return va(b,a,wa,Va)}},function(b,c){t.type.order[b+a+"-pre"]=c})}function Mb(a){return function(){var b=[ua(this[p.ext.iApiIndex])].concat(Array.prototype.slice.call(arguments));return p.ext.internal[a].apply(this,b)}}var p,t,q,r,v,Wa={},Nb=/[\r\n]/g,wa=/<.*?>/g,Yb=/^[\w\+\-]/,Zb=/[\w\+\-]$/,Vb=RegExp("(\\/|\\.|\\*|\\+|\\?|\\||\\(|\\)|\\[|\\]|\\{|\\}|\\\\|\\$|\\^|\\-)","g"),Va=/[',$\u00a3\u20ac\u00a5%\u2009\u202F]/g,
H=function(a){return!a||!0===a||"-"===a?!0:!1},Ob=function(a){var b=parseInt(a,10);return!isNaN(b)&&isFinite(a)?b:null},Pb=function(a,b){Wa[b]||(Wa[b]=RegExp(Oa(b),"g"));return"string"===typeof a?a.replace(/\./g,"").replace(Wa[b],"."):a},Xa=function(a,b,c){var d="string"===typeof a;b&&d&&(a=Pb(a,b));c&&d&&(a=a.replace(Va,""));return H(a)||!isNaN(parseFloat(a))&&isFinite(a)},Qb=function(a,b,c){return H(a)?!0:!(H(a)||"string"===typeof a)?null:Xa(a.replace(wa,""),b,c)?!0:null},C=function(a,b,c){var d=
[],e=0,f=a.length;if(c!==l)for(;e<f;e++)a[e]&&a[e][b]&&d.push(a[e][b][c]);else for(;e<f;e++)a[e]&&d.push(a[e][b]);return d},xa=function(a,b,c,d){var e=[],f=0,g=b.length;if(d!==l)for(;f<g;f++)e.push(a[b[f]][c][d]);else for(;f<g;f++)e.push(a[b[f]][c]);return e},S=function(a,b){var c=[],d;b===l?(b=0,d=a):(d=b,b=a);for(var e=b;e<d;e++)c.push(e);return c},Ja=function(a){var b=[],c,d,e=a.length,f,g=0;d=0;a:for(;d<e;d++){c=a[d];for(f=0;f<g;f++)if(b[f]===c)continue a;b.push(c);g++}return b},w=function(a,
b,c){a[b]!==l&&(a[c]=a[b])},$=/\[.*?\]$/,Q=/\(\)$/,qa=h("<div>")[0],Wb=qa.textContent!==l,Xb=/<.*?>/g;p=function(a){this.$=function(a,b){return this.api(!0).$(a,b)};this._=function(a,b){return this.api(!0).rows(a,b).data()};this.api=function(a){return a?new q(ua(this[t.iApiIndex])):new q(this)};this.fnAddData=function(a,b){var c=this.api(!0),d=h.isArray(a)&&(h.isArray(a[0])||h.isPlainObject(a[0]))?c.rows.add(a):c.row.add(a);(b===l||b)&&c.draw();return d.flatten().toArray()};this.fnAdjustColumnSizing=
function(a){var b=this.api(!0).columns.adjust(),c=b.settings()[0],d=c.oScroll;a===l||a?b.draw(!1):(""!==d.sX||""!==d.sY)&&W(c)};this.fnClearTable=function(a){var b=this.api(!0).clear();(a===l||a)&&b.draw()};this.fnClose=function(a){this.api(!0).row(a).child.hide()};this.fnDeleteRow=function(a,b,c){var d=this.api(!0),a=d.rows(a),e=a.settings()[0],h=e.aoData[a[0][0]];a.remove();b&&b.call(this,e,h);(c===l||c)&&d.draw();return h};this.fnDestroy=function(a){this.api(!0).destroy(a)};this.fnDraw=function(a){this.api(!0).draw(!a)};
this.fnFilter=function(a,b,c,d,e,h){e=this.api(!0);null===b||b===l?e.search(a,c,d,h):e.column(b).search(a,c,d,h);e.draw()};this.fnGetData=function(a,b){var c=this.api(!0);if(a!==l){var d=a.nodeName?a.nodeName.toLowerCase():"";return b!==l||"td"==d||"th"==d?c.cell(a,b).data():c.row(a).data()||null}return c.data().toArray()};this.fnGetNodes=function(a){var b=this.api(!0);return a!==l?b.row(a).node():b.rows().nodes().flatten().toArray()};this.fnGetPosition=function(a){var b=this.api(!0),c=a.nodeName.toUpperCase();
return"TR"==c?b.row(a).index():"TD"==c||"TH"==c?(a=b.cell(a).index(),[a.row,a.columnVisible,a.column]):null};this.fnIsOpen=function(a){return this.api(!0).row(a).child.isShown()};this.fnOpen=function(a,b,c){return this.api(!0).row(a).child(b,c).show().child()[0]};this.fnPageChange=function(a,b){var c=this.api(!0).page(a);(b===l||b)&&c.draw(!1)};this.fnSetColumnVis=function(a,b,c){a=this.api(!0).column(a).visible(b);(c===l||c)&&a.columns.adjust().draw()};this.fnSettings=function(){return ua(this[t.iApiIndex])};
this.fnSort=function(a){this.api(!0).order(a).draw()};this.fnSortListener=function(a,b,c){this.api(!0).order.listener(a,b,c)};this.fnUpdate=function(a,b,c,d,e){var h=this.api(!0);c===l||null===c?h.row(b).data(a):h.cell(b,c).data(a);(e===l||e)&&h.columns.adjust();(d===l||d)&&h.draw();return 0};this.fnVersionCheck=t.fnVersionCheck;var b=this,c=a===l,d=this.length;c&&(a={});this.oApi=this.internal=t.internal;for(var e in p.ext.internal)e&&(this[e]=Mb(e));this.each(function(){var e={},g=1<d?Kb(e,a,!0):
a,j=0,i,n=this.getAttribute("id"),e=!1,m=p.defaults;if("table"!=this.nodeName.toLowerCase())P(null,0,"Non-table node initialisation ("+this.nodeName+")",2);else{db(m);eb(m.column);G(m,m,!0);G(m.column,m.column,!0);G(m,g);var o=p.settings,j=0;for(i=o.length;j<i;j++){if(o[j].nTable==this){i=g.bRetrieve!==l?g.bRetrieve:m.bRetrieve;if(c||i)return o[j].oInstance;if(g.bDestroy!==l?g.bDestroy:m.bDestroy){o[j].oInstance.fnDestroy();break}else{P(o[j],0,"Cannot reinitialise DataTable",3);return}}if(o[j].sTableId==
this.id){o.splice(j,1);break}}if(null===n||""===n)this.id=n="DataTables_Table_"+p.ext._unique++;var k=h.extend(!0,{},p.models.oSettings,{nTable:this,oApi:b.internal,oInit:g,sDestroyWidth:h(this)[0].style.width,sInstance:n,sTableId:n});o.push(k);k.oInstance=1===b.length?b:h(this).dataTable();db(g);g.oLanguage&&N(g.oLanguage);g.aLengthMenu&&!g.iDisplayLength&&(g.iDisplayLength=h.isArray(g.aLengthMenu[0])?g.aLengthMenu[0][0]:g.aLengthMenu[0]);g=Kb(h.extend(!0,{},m),g);D(k.oFeatures,g,"bPaginate bLengthChange bFilter bSort bSortMulti bInfo bProcessing bAutoWidth bSortClasses bServerSide bDeferRender".split(" "));
D(k,g,["asStripeClasses","ajax","fnServerData","fnFormatNumber","sServerMethod","aaSorting","aaSortingFixed","aLengthMenu","sPaginationType","sAjaxSource","sAjaxDataProp","iStateDuration","sDom","bSortCellsTop","iTabIndex","fnStateLoadCallback","fnStateSaveCallback","renderer",["iCookieDuration","iStateDuration"],["oSearch","oPreviousSearch"],["aoSearchCols","aoPreSearchCols"],["iDisplayLength","_iDisplayLength"],["bJQueryUI","bJUI"]]);D(k.oScroll,g,[["sScrollX","sX"],["sScrollXInner","sXInner"],
["sScrollY","sY"],["bScrollCollapse","bCollapse"]]);D(k.oLanguage,g,"fnInfoCallback");x(k,"aoDrawCallback",g.fnDrawCallback,"user");x(k,"aoServerParams",g.fnServerParams,"user");x(k,"aoStateSaveParams",g.fnStateSaveParams,"user");x(k,"aoStateLoadParams",g.fnStateLoadParams,"user");x(k,"aoStateLoaded",g.fnStateLoaded,"user");x(k,"aoRowCallback",g.fnRowCallback,"user");x(k,"aoRowCreatedCallback",g.fnCreatedRow,"user");x(k,"aoHeaderCallback",g.fnHeaderCallback,"user");x(k,"aoFooterCallback",g.fnFooterCallback,
"user");x(k,"aoInitComplete",g.fnInitComplete,"user");x(k,"aoPreDrawCallback",g.fnPreDrawCallback,"user");n=k.oClasses;g.bJQueryUI?(h.extend(n,p.ext.oJUIClasses,g.oClasses),g.sDom===m.sDom&&"lfrtip"===m.sDom&&(k.sDom='<"H"lfr>t<"F"ip>'),k.renderer)?h.isPlainObject(k.renderer)&&!k.renderer.header&&(k.renderer.header="jqueryui"):k.renderer="jqueryui":h.extend(n,p.ext.classes,g.oClasses);h(this).addClass(n.sTable);if(""!==k.oScroll.sX||""!==k.oScroll.sY)k.oScroll.iBarWidth=Gb();!0===k.oScroll.sX&&(k.oScroll.sX=
"100%");k.iInitDisplayStart===l&&(k.iInitDisplayStart=g.iDisplayStart,k._iDisplayStart=g.iDisplayStart);null!==g.iDeferLoading&&(k.bDeferLoading=!0,j=h.isArray(g.iDeferLoading),k._iRecordsDisplay=j?g.iDeferLoading[0]:g.iDeferLoading,k._iRecordsTotal=j?g.iDeferLoading[1]:g.iDeferLoading);""!==g.oLanguage.sUrl?(k.oLanguage.sUrl=g.oLanguage.sUrl,h.getJSON(k.oLanguage.sUrl,null,function(a){N(a);G(m.oLanguage,a);h.extend(true,k.oLanguage,g.oLanguage,a);ra(k)}),e=!0):h.extend(!0,k.oLanguage,g.oLanguage);
null===g.asStripeClasses&&(k.asStripeClasses=[n.sStripeOdd,n.sStripeEven]);var j=k.asStripeClasses,r=h("tbody tr:eq(0)",this);-1!==h.inArray(!0,h.map(j,function(a){return r.hasClass(a)}))&&(h("tbody tr",this).removeClass(j.join(" ")),k.asDestroyStripes=j.slice());var o=[],q,j=this.getElementsByTagName("thead");0!==j.length&&(aa(k.aoHeader,j[0]),o=ma(k));if(null===g.aoColumns){q=[];j=0;for(i=o.length;j<i;j++)q.push(null)}else q=g.aoColumns;j=0;for(i=q.length;j<i;j++)Aa(k,o?o[j]:null);hb(k,g.aoColumnDefs,
q,function(a,b){fa(k,a,b)});if(r.length){var s=function(a,b){return a.getAttribute("data-"+b)?b:null};h.each(ia(k,r[0]).cells,function(a,b){var c=k.aoColumns[a];if(c.mData===a){var d=s(b,"sort")||s(b,"order"),e=s(b,"filter")||s(b,"search");if(d!==null||e!==null){c.mData={_:a+".display",sort:d!==null?a+".@data-"+d:l,type:d!==null?a+".@data-"+d:l,filter:e!==null?a+".@data-"+e:l};fa(k,a)}}})}var t=k.oFeatures;g.bStateSave&&(t.bStateSave=!0,Jb(k,g),x(k,"aoDrawCallback",ta,"state_save"));if(g.aaSorting===
l){o=k.aaSorting;j=0;for(i=o.length;j<i;j++)o[j][1]=k.aoColumns[j].asSorting[0]}sa(k);t.bSort&&x(k,"aoDrawCallback",function(){if(k.bSorted){var a=R(k),b={};h.each(a,function(a,c){b[c.src]=c.dir});u(k,null,"order",[k,a,b]);Ib(k)}});x(k,"aoDrawCallback",function(){(k.bSorted||z(k)==="ssp"||t.bDeferRender)&&sa(k)},"sc");fb(k);j=h(this).children("caption").each(function(){this._captionSide=h(this).css("caption-side")});i=h(this).children("thead");0===i.length&&(i=h("<thead/>").appendTo(this));k.nTHead=
i[0];i=h(this).children("tbody");0===i.length&&(i=h("<tbody/>").appendTo(this));k.nTBody=i[0];i=h(this).children("tfoot");if(0===i.length&&0<j.length&&(""!==k.oScroll.sX||""!==k.oScroll.sY))i=h("<tfoot/>").appendTo(this);0===i.length||0===i.children().length?h(this).addClass(n.sNoFooter):0<i.length&&(k.nTFoot=i[0],aa(k.aoFooter,k.nTFoot));if(g.aaData)for(j=0;j<g.aaData.length;j++)I(k,g.aaData[j]);else(k.bDeferLoading||"dom"==z(k))&&ha(k,h(k.nTBody).children("tr"));k.aiDisplay=k.aiDisplayMaster.slice();
k.bInitialised=!0;!1===e&&ra(k)}});b=null;return this};var Rb=[],y=Array.prototype,$b=function(a){var b,c,d=p.settings,e=h.map(d,function(a){return a.nTable});if(a){if(a.nTable&&a.oApi)return[a];if(a.nodeName&&"table"===a.nodeName.toLowerCase())return b=h.inArray(a,e),-1!==b?[d[b]]:null;if(a&&"function"===typeof a.settings)return a.settings().toArray();"string"===typeof a?c=h(a):a instanceof h&&(c=a)}else return[];if(c)return c.map(function(){b=h.inArray(this,e);return-1!==b?d[b]:null}).toArray()};
q=function(a,b){if(!this instanceof q)throw"DT API must be constructed as a new object";var c=[],d=function(a){(a=$b(a))&&c.push.apply(c,a)};if(h.isArray(a))for(var e=0,f=a.length;e<f;e++)d(a[e]);else d(a);this.context=Ja(c);b&&this.push.apply(this,b.toArray?b.toArray():b);this.selector={rows:null,cols:null,opts:null};q.extend(this,this,Rb)};p.Api=q;q.prototype={concat:y.concat,context:[],each:function(a){for(var b=0,c=this.length;b<c;b++)a.call(this,this[b],b,this);return this},eq:function(a){var b=
this.context;return b.length>a?new q(b[a],this[a]):null},filter:function(a){var b=[];if(y.filter)b=y.filter.call(this,a,this);else for(var c=0,d=this.length;c<d;c++)a.call(this,this[c],c,this)&&b.push(this[c]);return new q(this.context,b)},flatten:function(){var a=[];return new q(this.context,a.concat.apply(a,this.toArray()))},join:y.join,indexOf:y.indexOf||function(a,b){for(var c=b||0,d=this.length;c<d;c++)if(this[c]===a)return c;return-1},iterator:function(a,b,c){var d=[],e,f,g,h,i,n=this.context,
m,o,k=this.selector;"string"===typeof a&&(c=b,b=a,a=!1);f=0;for(g=n.length;f<g;f++)if("table"===b)e=c(n[f],f),e!==l&&d.push(e);else if("columns"===b||"rows"===b)e=c(n[f],this[f],f),e!==l&&d.push(e);else if("column"===b||"column-rows"===b||"row"===b||"cell"===b){o=this[f];"column-rows"===b&&(m=Ya(n[f],k.opts));h=0;for(i=o.length;h<i;h++)e=o[h],e="cell"===b?c(n[f],e.row,e.column,f,h):c(n[f],e,f,h,m),e!==l&&d.push(e)}return d.length?(a=new q(n,a?d.concat.apply([],d):d),b=a.selector,b.rows=k.rows,b.cols=
k.cols,b.opts=k.opts,a):this},lastIndexOf:y.lastIndexOf||function(a,b){return this.indexOf.apply(this.toArray.reverse(),arguments)},length:0,map:function(a){var b=[];if(y.map)b=y.map.call(this,a,this);else for(var c=0,d=this.length;c<d;c++)b.push(a.call(this,this[c],c));return new q(this.context,b)},pluck:function(a){return this.map(function(b){return b[a]})},pop:y.pop,push:y.push,reduce:y.reduce||function(a,b){return gb(this,a,b,0,this.length,1)},reduceRight:y.reduceRight||function(a,b){return gb(this,
a,b,this.length-1,-1,-1)},reverse:y.reverse,selector:null,shift:y.shift,sort:y.sort,splice:y.splice,toArray:function(){return y.slice.call(this)},to$:function(){return h(this)},toJQuery:function(){return h(this)},unique:function(){return new q(this.context,Ja(this))},unshift:y.unshift};q.extend=function(a,b,c){if(b&&(b instanceof q||b.__dt_wrapper)){var d,e,f,g=function(a,b,c){return function(){var d=b.apply(a,arguments);q.extend(d,d,c.methodExt);return d}};d=0;for(e=c.length;d<e;d++)f=c[d],b[f.name]=
"function"===typeof f.val?g(a,f.val,f):h.isPlainObject(f.val)?{}:f.val,b[f.name].__dt_wrapper=!0,q.extend(a,b[f.name],f.propExt)}};q.register=r=function(a,b){if(h.isArray(a))for(var c=0,d=a.length;c<d;c++)q.register(a[c],b);else for(var e=a.split("."),f=Rb,g,j,c=0,d=e.length;c<d;c++){g=(j=-1!==e[c].indexOf("()"))?e[c].replace("()",""):e[c];var i;a:{i=0;for(var n=f.length;i<n;i++)if(f[i].name===g){i=f[i];break a}i=null}i||(i={name:g,val:{},methodExt:[],propExt:[]},f.push(i));c===d-1?i.val=b:f=j?i.methodExt:
i.propExt}};q.registerPlural=v=function(a,b,c){q.register(a,c);q.register(b,function(){var a=c.apply(this,arguments);return a===this?this:a instanceof q?a.length?h.isArray(a[0])?new q(a.context,a[0]):a[0]:l:a})};r("tables()",function(a){var b;if(a){b=q;var c=this.context;if("number"===typeof a)a=[c[a]];else var d=h.map(c,function(a){return a.nTable}),a=h(d).filter(a).map(function(){var a=h.inArray(this,d);return c[a]}).toArray();b=new b(a)}else b=this;return b});r("table()",function(a){var a=this.tables(a),
b=a.context;return b.length?new q(b[0]):a});v("tables().nodes()","table().node()",function(){return this.iterator("table",function(a){return a.nTable})});v("tables().body()","table().body()",function(){return this.iterator("table",function(a){return a.nTBody})});v("tables().header()","table().header()",function(){return this.iterator("table",function(a){return a.nTHead})});v("tables().footer()","table().footer()",function(){return this.iterator("table",function(a){return a.nTFoot})});v("tables().containers()",
"table().container()",function(){return this.iterator("table",function(a){return a.nTableWrapper})});r("draw()",function(a){return this.iterator("table",function(b){L(b,!1===a)})});r("page()",function(a){return a===l?this.page.info().page:this.iterator("table",function(b){Ra(b,a)})});r("page.info()",function(){if(0===this.context.length)return l;var a=this.context[0],b=a._iDisplayStart,c=a._iDisplayLength,d=a.fnRecordsDisplay(),e=-1===c;return{page:e?0:Math.floor(b/c),pages:e?1:Math.ceil(d/c),start:b,
end:a.fnDisplayEnd(),length:c,recordsTotal:a.fnRecordsTotal(),recordsDisplay:d}});r("page.len()",function(a){return a===l?0!==this.context.length?this.context[0]._iDisplayLength:l:this.iterator("table",function(b){Pa(b,a)})});var Sb=function(a,b,c){"ssp"==z(a)?L(a,b):(B(a,!0),na(a,[],function(c){ja(a);for(var c=oa(a,c),d=0,g=c.length;d<g;d++)I(a,c[d]);L(a,b);B(a,!1)}));if(c){var d=new q(a);d.one("draw",function(){c(d.ajax.json())})}};r("ajax.json()",function(){var a=this.context;if(0<a.length)return a[0].json});
r("ajax.params()",function(){var a=this.context;if(0<a.length)return a[0].oAjaxData});r("ajax.reload()",function(a,b){return this.iterator("table",function(c){Sb(c,!1===b,a)})});r("ajax.url()",function(a){var b=this.context;if(a===l){if(0===b.length)return l;b=b[0];return b.ajax?h.isPlainObject(b.ajax)?b.ajax.url:b.ajax:b.sAjaxSource}return this.iterator("table",function(b){h.isPlainObject(b.ajax)?b.ajax.url=a:b.ajax=a})});r("ajax.url().load()",function(a,b){return this.iterator("table",function(c){Sb(c,
!1===b,a)})});var Za=function(a,b){var c=[],d,e,f,g,j,i;if(!a||"string"===typeof a||a.length===l)a=[a];f=0;for(g=a.length;f<g;f++){e=a[f]&&a[f].split?a[f].split(","):[a[f]];j=0;for(i=e.length;j<i;j++)(d=b("string"===typeof e[j]?h.trim(e[j]):e[j]))&&d.length&&c.push.apply(c,d)}return c},$a=function(a){a||(a={});a.filter&&!a.search&&(a.search=a.filter);return{search:a.search||"none",order:a.order||"current",page:a.page||"all"}},ab=function(a){for(var b=0,c=a.length;b<c;b++)if(0<a[b].length)return a[0]=
a[b],a.length=1,a.context=[a.context[b]],a;a.length=0;return a},Ya=function(a,b){var c,d,e,f=[],g=a.aiDisplay;c=a.aiDisplayMaster;var j=b.search;d=b.order;e=b.page;if("ssp"==z(a))return"removed"===j?[]:S(0,c.length);if("current"==e){c=a._iDisplayStart;for(d=a.fnDisplayEnd();c<d;c++)f.push(g[c])}else if("current"==d||"applied"==d)f="none"==j?c.slice():"applied"==j?g.slice():h.map(c,function(a){return-1===h.inArray(a,g)?a:null});else if("index"==d||"original"==d){c=0;for(d=a.aoData.length;c<d;c++)"none"==
j?f.push(c):(e=h.inArray(c,g),(-1===e&&"removed"==j||0<=e&&"applied"==j)&&f.push(c))}return f};r("rows()",function(a,b){a===l?a="":h.isPlainObject(a)&&(b=a,a="");var b=$a(b),c=this.iterator("table",function(c){var e=b;return Za(a,function(a){var b=Ob(a);if(b!==null&&!e)return[b];var j=Ya(c,e);if(b!==null&&h.inArray(b,j)!==-1)return[b];if(!a)return j;for(var b=[],i=0,n=j.length;i<n;i++)b.push(c.aoData[j[i]].nTr);return a.nodeName&&h.inArray(a,b)!==-1?[a._DT_RowIndex]:h(b).filter(a).map(function(){return this._DT_RowIndex}).toArray()})});
c.selector.rows=a;c.selector.opts=b;return c});r("rows().nodes()",function(){return this.iterator("row",function(a,b){return a.aoData[b].nTr||l})});r("rows().data()",function(){return this.iterator(!0,"rows",function(a,b){return xa(a.aoData,b,"_aData")})});v("rows().cache()","row().cache()",function(a){return this.iterator("row",function(b,c){var d=b.aoData[c];return"search"===a?d._aFilterData:d._aSortData})});v("rows().invalidate()","row().invalidate()",function(a){return this.iterator("row",function(b,
c){la(b,c,a)})});v("rows().indexes()","row().index()",function(){return this.iterator("row",function(a,b){return b})});v("rows().remove()","row().remove()",function(){var a=this;return this.iterator("row",function(b,c,d){var e=b.aoData;e.splice(c,1);for(var f=0,g=e.length;f<g;f++)null!==e[f].nTr&&(e[f].nTr._DT_RowIndex=f);h.inArray(c,b.aiDisplay);ka(b.aiDisplayMaster,c);ka(b.aiDisplay,c);ka(a[d],c,!1);Qa(b)})});r("rows.add()",function(a){var b=this.iterator("table",function(b){var c,f,g,h=[];f=0;
for(g=a.length;f<g;f++)c=a[f],c.nodeName&&"TR"===c.nodeName.toUpperCase()?h.push(ha(b,c)[0]):h.push(I(b,c));return h}),c=this.rows(-1);c.pop();c.push.apply(c,b.toArray());return c});r("row()",function(a,b){return ab(this.rows(a,b))});r("row().data()",function(a){var b=this.context;if(a===l)return b.length&&this.length?b[0].aoData[this[0]]._aData:l;b[0].aoData[this[0]]._aData=a;la(b[0],this[0],"data");return this});r("row().node()",function(){var a=this.context;return a.length&&this.length?a[0].aoData[this[0]].nTr||
null:null});r("row.add()",function(a){a instanceof h&&a.length&&(a=a[0]);var b=this.iterator("table",function(b){return a.nodeName&&"TR"===a.nodeName.toUpperCase()?ha(b,a)[0]:I(b,a)});return this.row(b[0])});var bb=function(a){var b=a.context;b.length&&a.length&&(a=b[0].aoData[a[0]],a._details&&(a._details.remove(),a._detailsShow=l,a._details=l))},Tb=function(a,b){var c=a.context;if(c.length&&a.length){var d=c[0].aoData[a[0]];if(d._details){(d._detailsShow=b)?d._details.insertAfter(d.nTr):d._details.detach();
var e=c[0],f=new q(e),g=e.aoData;f.off("draw.dt.DT_details column-visibility.dt.DT_details destroy.dt.DT_details");0<C(g,"_details").length&&(f.on("draw.dt.DT_details",function(a,b){e===b&&f.rows({page:"current"}).eq(0).each(function(a){a=g[a];a._detailsShow&&a._details.insertAfter(a.nTr)})}),f.on("column-visibility.dt.DT_details",function(a,b){if(e===b)for(var c,d=Z(b),f=0,h=g.length;f<h;f++)c=g[f],c._details&&c._details.children("td[colspan]").attr("colspan",d)}),f.on("destroy.dt.DT_details",function(a,
b){if(e===b)for(var c=0,d=g.length;c<d;c++)g[c]._details&&bb(g[c])}))}}};r("row().child()",function(a,b){var c=this.context;if(a===l)return c.length&&this.length?c[0].aoData[this[0]]._details:l;if(!0===a)this.child.show();else if(!1===a)bb(this);else if(c.length&&this.length){var d=c[0],c=c[0].aoData[this[0]],e=[],f=function(a,b){if(a.nodeName&&"tr"===a.nodeName.toLowerCase())e.push(a);else{var c=h("<tr><td/></tr>").addClass(b);h("td",c).addClass(b).html(a)[0].colSpan=Z(d);e.push(c[0])}};if(h.isArray(a)||
a instanceof h)for(var g=0,j=a.length;g<j;g++)f(a[g],b);else f(a,b);c._details&&c._details.remove();c._details=h(e);c._detailsShow&&c._details.insertAfter(c.nTr)}return this});r(["row().child.show()","row().child().show()"],function(){Tb(this,!0);return this});r(["row().child.hide()","row().child().hide()"],function(){Tb(this,!1);return this});r(["row().child.remove()","row().child().remove()"],function(){bb(this);return this});r("row().child.isShown()",function(){var a=this.context;return a.length&&
this.length?a[0].aoData[this[0]]._detailsShow||!1:!1});var ac=/^(.+):(name|visIdx|visible)$/;r("columns()",function(a,b){a===l?a="":h.isPlainObject(a)&&(b=a,a="");var b=$a(b),c=this.iterator("table",function(b){var c=a,f=b.aoColumns,g=C(f,"sName"),j=C(f,"nTh");return Za(c,function(a){var c=Ob(a);if(a==="")return S(f.length);if(c!==null)return[c>=0?c:f.length+c];var e=typeof a==="string"?a.match(ac):"";if(e)switch(e[2]){case "visIdx":case "visible":a=parseInt(e[1],10);if(a<0){c=h.map(f,function(a,
b){return a.bVisible?b:null});return[c[c.length+a]]}return[ga(b,a)];case "name":return h.map(g,function(a,b){return a===e[1]?b:null})}else return h(j).filter(a).map(function(){return h.inArray(this,j)}).toArray()})});c.selector.cols=a;c.selector.opts=b;return c});v("columns().header()","column().header()",function(){return this.iterator("column",function(a,b){return a.aoColumns[b].nTh})});v("columns().footer()","column().footer()",function(){return this.iterator("column",function(a,b){return a.aoColumns[b].nTf})});
v("columns().data()","column().data()",function(){return this.iterator("column-rows",function(a,b,c,d,e){for(var c=[],d=0,f=e.length;d<f;d++)c.push(A(a,e[d],b,""));return c})});v("columns().cache()","column().cache()",function(a){return this.iterator("column-rows",function(b,c,d,e,f){return xa(b.aoData,f,"search"===a?"_aFilterData":"_aSortData",c)})});v("columns().nodes()","column().nodes()",function(){return this.iterator("column-rows",function(a,b,c,d,e){return xa(a.aoData,e,"anCells",b)})});v("columns().visible()",
"column().visible()",function(a,b){return this.iterator("column",function(c,d){var e;if(a===l)e=c.aoColumns[d].bVisible;else{var f=c.aoColumns;e=f[d];var g=c.aoData,j,i,n;if(a===l)e=e.bVisible;else{if(e.bVisible!==a){if(a){var m=h.inArray(!0,C(f,"bVisible"),d+1);j=0;for(i=g.length;j<i;j++)n=g[j].nTr,f=g[j].anCells,n&&n.insertBefore(f[d],f[m]||null)}else h(C(c.aoData,"anCells",d)).detach();e.bVisible=a;ba(c,c.aoHeader);ba(c,c.aoFooter);if(b===l||b)V(c),(c.oScroll.sX||c.oScroll.sY)&&W(c);u(c,null,"column-visibility",
[c,d,a]);ta(c)}e=void 0}}return e})});v("columns().indexes()","column().index()",function(a){return this.iterator("column",function(b,c){return"visible"===a?Y(b,c):c})});r("columns.adjust()",function(){return this.iterator("table",function(a){V(a)})});r("column.index()",function(a,b){if(0!==this.context.length){var c=this.context[0];if("fromVisible"===a||"toData"===a)return ga(c,b);if("fromData"===a||"toVisible"===a)return Y(c,b)}});r("column()",function(a,b){return ab(this.columns(a,b))});r("cells()",
function(a,b,c){h.isPlainObject(a)&&(typeof a.row!==l?(c=b,b=null):(c=a,a=null));h.isPlainObject(b)&&(c=b,b=null);if(null===b||b===l)return this.iterator("table",function(b){var d=a,e=$a(c),f=b.aoData,g=Ya(b,e),e=xa(f,g,"anCells"),j=h([].concat.apply([],e)),i,m=b.aoColumns.length,n,p,r,q;return Za(d,function(a){if(a===null||a===l){n=[];p=0;for(r=g.length;p<r;p++){i=g[p];for(q=0;q<m;q++)n.push({row:i,column:q})}return n}return h.isPlainObject(a)?[a]:j.filter(a).map(function(a,b){i=b.parentNode._DT_RowIndex;
return{row:i,column:h.inArray(b,f[i].anCells)}}).toArray()})});var d=this.columns(b,c),e=this.rows(a,c),f,g,j,i,n,m=this.iterator("table",function(a,b){f=[];g=0;for(j=e[b].length;g<j;g++){i=0;for(n=d[b].length;i<n;i++)f.push({row:e[b][g],column:d[b][i]})}return f});h.extend(m.selector,{cols:b,rows:a,opts:c});return m});v("cells().nodes()","cell().node()",function(){return this.iterator("cell",function(a,b,c){return a.aoData[b].anCells[c]})});r("cells().data()",function(){return this.iterator("cell",
function(a,b,c){return A(a,b,c)})});v("cells().cache()","cell().cache()",function(a){a="search"===a?"_aFilterData":"_aSortData";return this.iterator("cell",function(b,c,d){return b.aoData[c][a][d]})});v("cells().indexes()","cell().index()",function(){return this.iterator("cell",function(a,b,c){return{row:b,column:c,columnVisible:Y(a,c)}})});r(["cells().invalidate()","cell().invalidate()"],function(a){var b=this.selector;this.rows(b.rows,b.opts).invalidate(a);return this});r("cell()",function(a,b,
c){return ab(this.cells(a,b,c))});r("cell().data()",function(a){var b=this.context,c=this[0];if(a===l)return b.length&&c.length?A(b[0],c[0].row,c[0].column):l;Ea(b[0],c[0].row,c[0].column,a);la(b[0],c[0].row,"data",c[0].column);return this});r("order()",function(a,b){var c=this.context;if(a===l)return 0!==c.length?c[0].aaSorting:l;"number"===typeof a?a=[[a,b]]:h.isArray(a[0])||(a=Array.prototype.slice.call(arguments));return this.iterator("table",function(b){b.aaSorting=a.slice()})});r("order.listener()",
function(a,b,c){return this.iterator("table",function(d){Ka(d,a,b,c)})});r(["columns().order()","column().order()"],function(a){var b=this;return this.iterator("table",function(c,d){var e=[];h.each(b[d],function(b,c){e.push([c,a])});c.aaSorting=e})});r("search()",function(a,b,c,d){var e=this.context;return a===l?0!==e.length?e[0].oPreviousSearch.sSearch:l:this.iterator("table",function(e){e.oFeatures.bFilter&&ca(e,h.extend({},e.oPreviousSearch,{sSearch:a+"",bRegex:null===b?!1:b,bSmart:null===c?!0:
c,bCaseInsensitive:null===d?!0:d}),1)})});v("columns().search()","column().search()",function(a,b,c,d){return this.iterator("column",function(e,f){var g=e.aoPreSearchCols;if(a===l)return g[f].sSearch;e.oFeatures.bFilter&&(h.extend(g[f],{sSearch:a+"",bRegex:null===b?!1:b,bSmart:null===c?!0:c,bCaseInsensitive:null===d?!0:d}),ca(e,e.oPreviousSearch,1))})});r("state()",function(){return this.context.length?this.context[0].oSavedState:null});r("state.clear()",function(){return this.iterator("table",function(a){a.fnStateSaveCallback.call(a.oInstance,
a,{})})});r("state.loaded()",function(){return this.context.length?this.context[0].oLoadedState:null});r("state.save()",function(){return this.iterator("table",function(a){ta(a)})});p.versionCheck=p.fnVersionCheck=function(a){for(var b=p.version.split("."),a=a.split("."),c,d,e=0,f=a.length;e<f;e++)if(c=parseInt(b[e],10)||0,d=parseInt(a[e],10)||0,c!==d)return c>d;return!0};p.isDataTable=p.fnIsDataTable=function(a){var b=h(a).get(0),c=!1;h.each(p.settings,function(a,e){if(e.nTable===b||e.nScrollHead===
b||e.nScrollFoot===b)c=!0});return c};p.tables=p.fnTables=function(a){return jQuery.map(p.settings,function(b){if(!a||a&&h(b.nTable).is(":visible"))return b.nTable})};p.camelToHungarian=G;r("$()",function(a,b){var c=this.rows(b).nodes(),c=h(c);return h([].concat(c.filter(a).toArray(),c.find(a).toArray()))});h.each(["on","one","off"],function(a,b){r(b+"()",function(){var a=Array.prototype.slice.call(arguments);a[0].match(/\.dt\b/)||(a[0]+=".dt");var d=h(this.tables().nodes());d[b].apply(d,a);return this})});
r("clear()",function(){return this.iterator("table",function(a){ja(a)})});r("settings()",function(){return new q(this.context,this.context)});r("data()",function(){return this.iterator("table",function(a){return C(a.aoData,"_aData")}).flatten()});r("destroy()",function(a){a=a||!1;return this.iterator("table",function(b){var c=b.nTableWrapper.parentNode,d=b.oClasses,e=b.nTable,f=b.nTBody,g=b.nTHead,j=b.nTFoot,i=h(e),f=h(f),l=h(b.nTableWrapper),m=h.map(b.aoData,function(a){return a.nTr}),o;b.bDestroying=
!0;u(b,"aoDestroyCallback","destroy",[b]);a||(new q(b)).columns().visible(!0);l.unbind(".DT").find(":not(tbody *)").unbind(".DT");h(za).unbind(".DT-"+b.sInstance);e!=g.parentNode&&(i.children("thead").detach(),i.append(g));j&&e!=j.parentNode&&(i.children("tfoot").detach(),i.append(j));i.detach();l.detach();b.aaSorting=[];b.aaSortingFixed=[];sa(b);h(m).removeClass(b.asStripeClasses.join(" "));h("th, td",g).removeClass(d.sSortable+" "+d.sSortableAsc+" "+d.sSortableDesc+" "+d.sSortableNone);b.bJUI&&
(h("th span."+d.sSortIcon+", td span."+d.sSortIcon,g).detach(),h("th, td",g).each(function(){var a=h("div."+d.sSortJUIWrapper,this);h(this).append(a.contents());a.detach()}));!a&&c&&c.insertBefore(e,b.nTableReinsertBefore);f.children().detach();f.append(m);i.css("width",b.sDestroyWidth).removeClass(d.sTable);(o=b.asDestroyStripes.length)&&f.children().each(function(a){h(this).addClass(b.asDestroyStripes[a%o])});c=h.inArray(b,p.settings);-1!==c&&p.settings.splice(c,1)})});p.version="1.10.2";p.settings=
[];p.models={};p.models.oSearch={bCaseInsensitive:!0,sSearch:"",bRegex:!1,bSmart:!0};p.models.oRow={nTr:null,anCells:null,_aData:[],_aSortData:null,_aFilterData:null,_sFilterRow:null,_sRowStripe:"",src:null};p.models.oColumn={idx:null,aDataSort:null,asSorting:null,bSearchable:null,bSortable:null,bVisible:null,_sManualType:null,_bAttrSrc:!1,fnCreatedCell:null,fnGetData:null,fnSetData:null,mData:null,mRender:null,nTh:null,nTf:null,sClass:null,sContentPadding:null,sDefaultContent:null,sName:null,sSortDataType:"std",
sSortingClass:null,sSortingClassJUI:null,sTitle:null,sType:null,sWidth:null,sWidthOrig:null};p.defaults={aaData:null,aaSorting:[[0,"asc"]],aaSortingFixed:[],ajax:null,aLengthMenu:[10,25,50,100],aoColumns:null,aoColumnDefs:null,aoSearchCols:[],asStripeClasses:null,bAutoWidth:!0,bDeferRender:!1,bDestroy:!1,bFilter:!0,bInfo:!0,bJQueryUI:!1,bLengthChange:!0,bPaginate:!0,bProcessing:!1,bRetrieve:!1,bScrollCollapse:!1,bServerSide:!1,bSort:!0,bSortMulti:!0,bSortCellsTop:!1,bSortClasses:!0,bStateSave:!1,
fnCreatedRow:null,fnDrawCallback:null,fnFooterCallback:null,fnFormatNumber:function(a){return a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,this.oLanguage.sThousands)},fnHeaderCallback:null,fnInfoCallback:null,fnInitComplete:null,fnPreDrawCallback:null,fnRowCallback:null,fnServerData:null,fnServerParams:null,fnStateLoadCallback:function(a){try{return JSON.parse((-1===a.iStateDuration?sessionStorage:localStorage).getItem("DataTables_"+a.sInstance+"_"+location.pathname))}catch(b){}},fnStateLoadParams:null,
fnStateLoaded:null,fnStateSaveCallback:function(a,b){try{(-1===a.iStateDuration?sessionStorage:localStorage).setItem("DataTables_"+a.sInstance+"_"+location.pathname,JSON.stringify(b))}catch(c){}},fnStateSaveParams:null,iStateDuration:7200,iDeferLoading:null,iDisplayLength:10,iDisplayStart:0,iTabIndex:0,oClasses:{},oLanguage:{oAria:{sSortAscending:": activate to sort column ascending",sSortDescending:": activate to sort column descending"},oPaginate:{sFirst:"First",sLast:"Last",sNext:"Next",sPrevious:"Previous"},
sEmptyTable:"No data available in table",sInfo:"Showing _START_ to _END_ of _TOTAL_ entries",sInfoEmpty:"Showing 0 to 0 of 0 entries",sInfoFiltered:"(filtered from _MAX_ total entries)",sInfoPostFix:"",sDecimal:"",sThousands:",",sLengthMenu:"Show _MENU_ entries",sLoadingRecords:"Loading...",sProcessing:"Processing...",sSearch:"Search:",sSearchPlaceholder:"",sUrl:"",sZeroRecords:"No matching records found"},oSearch:h.extend({},p.models.oSearch),sAjaxDataProp:"data",sAjaxSource:null,sDom:"lfrtip",sPaginationType:"simple_numbers",
sScrollX:"",sScrollXInner:"",sScrollY:"",sServerMethod:"GET",renderer:null};T(p.defaults);p.defaults.column={aDataSort:null,iDataSort:-1,asSorting:["asc","desc"],bSearchable:!0,bSortable:!0,bVisible:!0,fnCreatedCell:null,mData:null,mRender:null,sCellType:"td",sClass:"",sContentPadding:"",sDefaultContent:null,sName:"",sSortDataType:"std",sTitle:null,sType:null,sWidth:null};T(p.defaults.column);p.models.oSettings={oFeatures:{bAutoWidth:null,bDeferRender:null,bFilter:null,bInfo:null,bLengthChange:null,
bPaginate:null,bProcessing:null,bServerSide:null,bSort:null,bSortMulti:null,bSortClasses:null,bStateSave:null},oScroll:{bCollapse:null,iBarWidth:0,sX:null,sXInner:null,sY:null},oLanguage:{fnInfoCallback:null},oBrowser:{bScrollOversize:!1,bScrollbarLeft:!1},ajax:null,aanFeatures:[],aoData:[],aiDisplay:[],aiDisplayMaster:[],aoColumns:[],aoHeader:[],aoFooter:[],oPreviousSearch:{},aoPreSearchCols:[],aaSorting:null,aaSortingFixed:[],asStripeClasses:null,asDestroyStripes:[],sDestroyWidth:0,aoRowCallback:[],
aoHeaderCallback:[],aoFooterCallback:[],aoDrawCallback:[],aoRowCreatedCallback:[],aoPreDrawCallback:[],aoInitComplete:[],aoStateSaveParams:[],aoStateLoadParams:[],aoStateLoaded:[],sTableId:"",nTable:null,nTHead:null,nTFoot:null,nTBody:null,nTableWrapper:null,bDeferLoading:!1,bInitialised:!1,aoOpenRows:[],sDom:null,sPaginationType:"two_button",iStateDuration:0,aoStateSave:[],aoStateLoad:[],oSavedState:null,oLoadedState:null,sAjaxSource:null,sAjaxDataProp:null,bAjaxDataGet:!0,jqXHR:null,json:l,oAjaxData:l,
fnServerData:null,aoServerParams:[],sServerMethod:null,fnFormatNumber:null,aLengthMenu:null,iDraw:0,bDrawing:!1,iDrawError:-1,_iDisplayLength:10,_iDisplayStart:0,_iRecordsTotal:0,_iRecordsDisplay:0,bJUI:null,oClasses:{},bFiltered:!1,bSorted:!1,bSortCellsTop:null,oInit:null,aoDestroyCallback:[],fnRecordsTotal:function(){return"ssp"==z(this)?1*this._iRecordsTotal:this.aiDisplayMaster.length},fnRecordsDisplay:function(){return"ssp"==z(this)?1*this._iRecordsDisplay:this.aiDisplay.length},fnDisplayEnd:function(){var a=
this._iDisplayLength,b=this._iDisplayStart,c=b+a,d=this.aiDisplay.length,e=this.oFeatures,f=e.bPaginate;return e.bServerSide?!1===f||-1===a?b+d:Math.min(b+a,this._iRecordsDisplay):!f||c>d||-1===a?d:c},oInstance:null,sInstance:null,iTabIndex:0,nScrollHead:null,nScrollFoot:null,aLastSort:[],oPlugins:{}};p.ext=t={classes:{},errMode:"alert",feature:[],search:[],internal:{},legacy:{ajax:null},pager:{},renderer:{pageButton:{},header:{}},order:{},type:{detect:[],search:{},order:{}},_unique:0,fnVersionCheck:p.fnVersionCheck,
iApiIndex:0,oJUIClasses:{},sVersion:p.version};h.extend(t,{afnFiltering:t.search,aTypes:t.type.detect,ofnSearch:t.type.search,oSort:t.type.order,afnSortData:t.order,aoFeatures:t.feature,oApi:t.internal,oStdClasses:t.classes,oPagination:t.pager});h.extend(p.ext.classes,{sTable:"dataTable",sNoFooter:"no-footer",sPageButton:"paginate_button",sPageButtonActive:"current",sPageButtonDisabled:"disabled",sStripeOdd:"odd",sStripeEven:"even",sRowEmpty:"dataTables_empty",sWrapper:"dataTables_wrapper",sFilter:"dataTables_filter",
sInfo:"dataTables_info",sPaging:"dataTables_paginate paging_",sLength:"dataTables_length",sProcessing:"dataTables_processing",sSortAsc:"sorting_asc",sSortDesc:"sorting_desc",sSortable:"sorting",sSortableAsc:"sorting_asc_disabled",sSortableDesc:"sorting_desc_disabled",sSortableNone:"sorting_disabled",sSortColumn:"sorting_",sFilterInput:"",sLengthSelect:"",sScrollWrapper:"dataTables_scroll",sScrollHead:"dataTables_scrollHead",sScrollHeadInner:"dataTables_scrollHeadInner",sScrollBody:"dataTables_scrollBody",
sScrollFoot:"dataTables_scrollFoot",sScrollFootInner:"dataTables_scrollFootInner",sHeaderTH:"",sFooterTH:"",sSortJUIAsc:"",sSortJUIDesc:"",sSortJUI:"",sSortJUIAscAllowed:"",sSortJUIDescAllowed:"",sSortJUIWrapper:"",sSortIcon:"",sJUIHeader:"",sJUIFooter:""});var ya="",ya="",E=ya+"ui-state-default",ea=ya+"css_right ui-icon ui-icon-",Ub=ya+"fg-toolbar ui-toolbar ui-widget-header ui-helper-clearfix";h.extend(p.ext.oJUIClasses,p.ext.classes,{sPageButton:"fg-button ui-button "+E,sPageButtonActive:"ui-state-disabled",
sPageButtonDisabled:"ui-state-disabled",sPaging:"dataTables_paginate fg-buttonset ui-buttonset fg-buttonset-multi ui-buttonset-multi paging_",sSortAsc:E+" sorting_asc",sSortDesc:E+" sorting_desc",sSortable:E+" sorting",sSortableAsc:E+" sorting_asc_disabled",sSortableDesc:E+" sorting_desc_disabled",sSortableNone:E+" sorting_disabled",sSortJUIAsc:ea+"triangle-1-n",sSortJUIDesc:ea+"triangle-1-s",sSortJUI:ea+"carat-2-n-s",sSortJUIAscAllowed:ea+"carat-1-n",sSortJUIDescAllowed:ea+"carat-1-s",sSortJUIWrapper:"DataTables_sort_wrapper",
sSortIcon:"DataTables_sort_icon",sScrollHead:"dataTables_scrollHead "+E,sScrollFoot:"dataTables_scrollFoot "+E,sHeaderTH:E,sFooterTH:E,sJUIHeader:Ub+" ui-corner-tl ui-corner-tr",sJUIFooter:Ub+" ui-corner-bl ui-corner-br"});var Lb=p.ext.pager;h.extend(Lb,{simple:function(){return["previous","next"]},full:function(){return["first","previous","next","last"]},simple_numbers:function(a,b){return["previous",Ua(a,b),"next"]},full_numbers:function(a,b){return["first","previous",Ua(a,b),"next","last"]},_numbers:Ua,
numbers_length:7});h.extend(!0,p.ext.renderer,{pageButton:{_:function(a,b,c,d,e,f){var g=a.oClasses,j=a.oLanguage.oPaginate,i,l,m=0,o=function(b,d){var k,p,r,q,s=function(b){Ra(a,b.data.action,true)};k=0;for(p=d.length;k<p;k++){q=d[k];if(h.isArray(q)){r=h("<"+(q.DT_el||"div")+"/>").appendTo(b);o(r,q)}else{l=i="";switch(q){case "ellipsis":b.append("<span>&hellip;</span>");break;case "first":i=j.sFirst;l=q+(e>0?"":" "+g.sPageButtonDisabled);break;case "previous":i=j.sPrevious;l=q+(e>0?"":" "+g.sPageButtonDisabled);
break;case "next":i=j.sNext;l=q+(e<f-1?"":" "+g.sPageButtonDisabled);break;case "last":i=j.sLast;l=q+(e<f-1?"":" "+g.sPageButtonDisabled);break;default:i=q+1;l=e===q?g.sPageButtonActive:""}if(i){r=h("<a>",{"class":g.sPageButton+" "+l,"aria-controls":a.sTableId,"data-dt-idx":m,tabindex:a.iTabIndex,id:c===0&&typeof q==="string"?a.sTableId+"_"+q:null}).html(i).appendTo(b);Ta(r,{action:q},s);m++}}}};try{var k=h(O.activeElement).data("dt-idx");o(h(b).empty(),d);k!==null&&h(b).find("[data-dt-idx="+k+"]").focus()}catch(p){}}}});
var va=function(a,b,c,d){if(!a||"-"===a)return-Infinity;b&&(a=Pb(a,b));a.replace&&(c&&(a=a.replace(c,"")),d&&(a=a.replace(d,"")));return 1*a};h.extend(t.type.order,{"date-pre":function(a){return Date.parse(a)||0},"html-pre":function(a){return H(a)?"":a.replace?a.replace(/<.*?>/g,"").toLowerCase():a+""},"string-pre":function(a){return H(a)?"":"string"===typeof a?a.toLowerCase():!a.toString?"":a.toString()},"string-asc":function(a,b){return a<b?-1:a>b?1:0},"string-desc":function(a,b){return a<b?1:a>
b?-1:0}});cb("");h.extend(p.ext.type.detect,[function(a,b){var c=b.oLanguage.sDecimal;return Xa(a,c)?"num"+c:null},function(a){if(a&&(!Yb.test(a)||!Zb.test(a)))return null;var b=Date.parse(a);return null!==b&&!isNaN(b)||H(a)?"date":null},function(a,b){var c=b.oLanguage.sDecimal;return Xa(a,c,!0)?"num-fmt"+c:null},function(a,b){var c=b.oLanguage.sDecimal;return Qb(a,c)?"html-num"+c:null},function(a,b){var c=b.oLanguage.sDecimal;return Qb(a,c,!0)?"html-num-fmt"+c:null},function(a){return H(a)||"string"===
typeof a&&-1!==a.indexOf("<")?"html":null}]);h.extend(p.ext.type.search,{html:function(a){return H(a)?a:"string"===typeof a?a.replace(Nb," ").replace(wa,""):""},string:function(a){return H(a)?a:"string"===typeof a?a.replace(Nb," "):a}});h.extend(!0,p.ext.renderer,{header:{_:function(a,b,c,d){h(a.nTable).on("order.dt.DT",function(e,f,g,h){if(a===f){e=c.idx;b.removeClass(c.sSortingClass+" "+d.sSortAsc+" "+d.sSortDesc).addClass(h[e]=="asc"?d.sSortAsc:h[e]=="desc"?d.sSortDesc:c.sSortingClass)}})},jqueryui:function(a,
b,c,d){var e=c.idx;h("<div/>").addClass(d.sSortJUIWrapper).append(b.contents()).append(h("<span/>").addClass(d.sSortIcon+" "+c.sSortingClassJUI)).appendTo(b);h(a.nTable).on("order.dt.DT",function(f,g,h,i){if(a===g){b.removeClass(d.sSortAsc+" "+d.sSortDesc).addClass(i[e]=="asc"?d.sSortAsc:i[e]=="desc"?d.sSortDesc:c.sSortingClass);b.find("span."+d.sSortIcon).removeClass(d.sSortJUIAsc+" "+d.sSortJUIDesc+" "+d.sSortJUI+" "+d.sSortJUIAscAllowed+" "+d.sSortJUIDescAllowed).addClass(i[e]=="asc"?d.sSortJUIAsc:
i[e]=="desc"?d.sSortJUIDesc:c.sSortingClassJUI)}})}}});p.render={number:function(a,b,c,d){return{display:function(e){var f=0>e?"-":"",e=Math.abs(parseFloat(e)),g=parseInt(e,10),e=c?b+(e-g).toFixed(c).substring(2):"";return f+(d||"")+g.toString().replace(/\B(?=(\d{3})+(?!\d))/g,a)+e}}}};h.extend(p.ext.internal,{_fnExternApiFunc:Mb,_fnBuildAjax:na,_fnAjaxUpdate:jb,_fnAjaxParameters:sb,_fnAjaxUpdateDraw:tb,_fnAjaxDataSrc:oa,_fnAddColumn:Aa,_fnColumnOptions:fa,_fnAdjustColumnSizing:V,_fnVisibleToColumnIndex:ga,
_fnColumnIndexToVisible:Y,_fnVisbleColumns:Z,_fnGetColumns:X,_fnColumnTypes:Da,_fnApplyColumnDefs:hb,_fnHungarianMap:T,_fnCamelToHungarian:G,_fnLanguageCompat:N,_fnBrowserDetect:fb,_fnAddData:I,_fnAddTr:ha,_fnNodeToDataIndex:function(a,b){return b._DT_RowIndex!==l?b._DT_RowIndex:null},_fnNodeToColumnIndex:function(a,b,c){return h.inArray(c,a.aoData[b].anCells)},_fnGetCellData:A,_fnSetCellData:Ea,_fnSplitObjNotation:Ga,_fnGetObjectDataFn:U,_fnSetObjectDataFn:Ba,_fnGetDataMaster:Ha,_fnClearTable:ja,
_fnDeleteIndex:ka,_fnInvalidateRow:la,_fnGetRowElements:ia,_fnCreateTr:Fa,_fnBuildHead:ib,_fnDrawHead:ba,_fnDraw:K,_fnReDraw:L,_fnAddOptionsHtml:lb,_fnDetectHeader:aa,_fnGetUniqueThs:ma,_fnFeatureHtmlFilter:nb,_fnFilterComplete:ca,_fnFilterCustom:wb,_fnFilterColumn:vb,_fnFilter:ub,_fnFilterCreateSearch:Na,_fnEscapeRegex:Oa,_fnFilterData:xb,_fnFeatureHtmlInfo:qb,_fnUpdateInfo:Ab,_fnInfoMacros:Bb,_fnInitialise:ra,_fnInitComplete:pa,_fnLengthChange:Pa,_fnFeatureHtmlLength:mb,_fnFeatureHtmlPaginate:rb,
_fnPageChange:Ra,_fnFeatureHtmlProcessing:ob,_fnProcessingDisplay:B,_fnFeatureHtmlTable:pb,_fnScrollDraw:W,_fnApplyToChildren:F,_fnCalculateColumnWidths:Ca,_fnThrottle:Ma,_fnConvertToWidth:Cb,_fnScrollingWidthAdjust:Eb,_fnGetWidestNode:Db,_fnGetMaxLenString:Fb,_fnStringToCss:s,_fnScrollBarWidth:Gb,_fnSortFlatten:R,_fnSort:kb,_fnSortAria:Ib,_fnSortListener:Sa,_fnSortAttachListener:Ka,_fnSortingClasses:sa,_fnSortData:Hb,_fnSaveState:ta,_fnLoadState:Jb,_fnSettingsFromNode:ua,_fnLog:P,_fnMap:D,_fnBindAction:Ta,
_fnCallbackReg:x,_fnCallbackFire:u,_fnLengthOverflow:Qa,_fnRenderer:La,_fnDataSource:z,_fnRowAttributes:Ia,_fnCalculateEnd:function(){}});h.fn.dataTable=p;h.fn.dataTableSettings=p.settings;h.fn.dataTableExt=p.ext;h.fn.DataTable=function(a){return h(this).dataTable(a).api()};h.each(p,function(a,b){h.fn.DataTable[a]=b});return h.fn.dataTable};"function"===typeof define&&define.amd?define("datatables",["jquery"],N):"object"===typeof exports?N(require("jquery")):jQuery&&!jQuery.fn.dataTable&&N(jQuery)})(window,
document);
;
$.extend(true,$.fn.dataTable.defaults,{"dom":"<'row'<'col-md-6 col-sm-12'l><'col-md-6 col-sm-12'f>r><'table-scrollable't><'row'<'col-md-5 col-sm-12'i><'col-md-7 col-sm-12'p>>","language":{"lengthMenu":" _MENU_ records ","paginate":{"previous":'<i class="fa fa-angle-left"></i>',"next":'<i class="fa fa-angle-right"></i>'}}});$.extend($.fn.dataTableExt.oStdClasses,{"sWrapper":"dataTables_wrapper","sFilterInput":"form-control input-small input-inline","sLengthSelect":"form-control input-xsmall input-inline"});
$.fn.dataTable.defaults.renderer="bootstrap";
$.fn.dataTable.ext.renderer.pageButton.bootstrap=function(settings,host,idx,buttons,page,pages){var api=new $.fn.dataTable.Api(settings);var classes=settings.oClasses;var lang=settings.oLanguage.oPaginate;var btnDisplay,btnClass;var attach=function(container,buttons){var i,ien,node,button;var clickHandler=function(e){e.preventDefault();if(e.data.action!=="ellipsis")api.page(e.data.action).draw(false)};for(i=0,ien=buttons.length;i<ien;i++){button=buttons[i];if($.isArray(button))attach(container,button);
else{btnDisplay="";btnClass="";switch(button){case "ellipsis":btnDisplay="&hellip;";btnClass="disabled";break;case "first":btnDisplay=lang.sFirst;btnClass=button+(page>0?"":" disabled");break;case "previous":btnDisplay=lang.sPrevious;btnClass=button+(page>0?"":" disabled");break;case "next":btnDisplay=lang.sNext;btnClass=button+(page<pages-1?"":" disabled");break;case "last":btnDisplay=lang.sLast;btnClass=button+(page<pages-1?"":" disabled");break;default:btnDisplay=button+1;btnClass=page===button?
    "active":"";break}if(btnDisplay){node=$("<li>",{"class":classes.sPageButton+" "+btnClass,"aria-controls":settings.sTableId,"tabindex":settings.iTabIndex,"id":idx===0&&typeof button==="string"?settings.sTableId+"_"+button:null}).append($("<a>",{"href":"#"}).html(btnDisplay)).appendTo(container);settings.oApi._fnBindAction(node,{action:button},clickHandler)}}}};attach($(host).empty().html('<ul class="pagination"/>').children("ul"),buttons)};
if($.fn.DataTable.TableTools){$.extend(true,$.fn.DataTable.TableTools.classes,{"container":"DTTT btn-group","buttons":{"normal":"btn btn-default","disabled":"disabled"},"collection":{"container":"DTTT_dropdown dropdown-menu","buttons":{"normal":"","disabled":"disabled"}},"print":{"info":"DTTT_Print_Info"},"select":{"row":"active"}});$.extend(true,$.fn.DataTable.TableTools.DEFAULTS.oTags,{"collection":{"container":"ul","button":"li","liner":"a"}})}
$.fn.dataTableExt.oApi.fnPagingInfo=function(oSettings){return{"iStart":oSettings._iDisplayStart,"iEnd":oSettings.fnDisplayEnd(),"iLength":oSettings._iDisplayLength,"iTotal":oSettings.fnRecordsTotal(),"iFilteredTotal":oSettings.fnRecordsDisplay(),"iPage":oSettings._iDisplayLength===-1?0:Math.ceil(oSettings._iDisplayStart/oSettings._iDisplayLength),"iTotalPages":oSettings._iDisplayLength===-1?0:Math.ceil(oSettings.fnRecordsDisplay()/oSettings._iDisplayLength)}};
$.extend($.fn.dataTableExt.oPagination,{"bootstrap_full_number":{"fnInit":function(oSettings,nPaging,fnDraw){var oLang=oSettings.oLanguage.oPaginate;var fnClickHandler=function(e){e.preventDefault();if(oSettings.oApi._fnPageChange(oSettings,e.data.action))fnDraw(oSettings)};$(nPaging).append('<ul class="pagination">'+'<li class="prev disabled"><a href="#" title="'+oLang.sFirst+'"><i class="fa fa-angle-double-left"></i></a></li>'+'<li class="prev disabled"><a href="#" title="'+oLang.sPrevious+'"><i class="fa fa-angle-left"></i></a></li>'+
            '<li class="next disabled"><a href="#" title="'+oLang.sNext+'"><i class="fa fa-angle-right"></i></a></li>'+'<li class="next disabled"><a href="#" title="'+oLang.sLast+'"><i class="fa fa-angle-double-right"></i></a></li>'+"</ul>");var els=$("a",nPaging);$(els[0]).bind("click.DT",{action:"first"},fnClickHandler);$(els[1]).bind("click.DT",{action:"previous"},fnClickHandler);$(els[2]).bind("click.DT",{action:"next"},fnClickHandler);$(els[3]).bind("click.DT",{action:"last"},fnClickHandler)},"fnUpdate":function(oSettings,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           fnDraw){var iListLength=5;var oPaging=oSettings.oInstance.fnPagingInfo();var an=oSettings.aanFeatures.p;var i,j,sClass,iStart,iEnd,iHalf=Math.floor(iListLength/2);if(oPaging.iTotalPages<iListLength){iStart=1;iEnd=oPaging.iTotalPages}else if(oPaging.iPage<=iHalf){iStart=1;iEnd=iListLength}else if(oPaging.iPage>=oPaging.iTotalPages-iHalf){iStart=oPaging.iTotalPages-iListLength+1;iEnd=oPaging.iTotalPages}else{iStart=oPaging.iPage-iHalf+1;iEnd=iStart+iListLength-1}for(i=0,iLen=an.length;i<iLen;i++){if(oPaging.iTotalPages<=
            0)$(".pagination",an[i]).css("visibility","hidden");else $(".pagination",an[i]).css("visibility","visible");$("li:gt(1)",an[i]).filter(":not(.next)").remove();for(j=iStart;j<=iEnd;j++){sClass=j==oPaging.iPage+1?'class="active"':"";$("<li "+sClass+'><a href="#">'+j+"</a></li>").insertBefore($("li.next:first",an[i])[0]).bind("click",function(e){e.preventDefault();oSettings._iDisplayStart=(parseInt($("a",this).text(),10)-1)*oPaging.iLength;fnDraw(oSettings)})}if(oPaging.iPage===0)$("li.prev",an[i]).addClass("disabled");
        else $("li.prev",an[i]).removeClass("disabled");if(oPaging.iPage===oPaging.iTotalPages-1||oPaging.iTotalPages===0)$("li.next",an[i]).addClass("disabled");else $("li.next",an[i]).removeClass("disabled")}}}});
$.extend($.fn.dataTableExt.oPagination,{"bootstrap_extended":{"fnInit":function(oSettings,nPaging,fnDraw){var oLang=oSettings.oLanguage.oPaginate;var oPaging=oSettings.oInstance.fnPagingInfo();var fnClickHandler=function(e){e.preventDefault();if(oSettings.oApi._fnPageChange(oSettings,e.data.action))fnDraw(oSettings)};var printUrl=eval(oSettings.sTableId+"PrintUrl");var excelUrl=eval(oSettings.sTableId+"ExcelUrl");$(nPaging).append('<div class="pagination-panel"> '+oLang.page+" "+'<a href="#" class="btn btn-sm default prev disabled" title="'+
            oLang.previous+'"><i class="fa fa-angle-left"></i></a>'+'<input type="text" class="pagination-panel-input form-control input-mini input-inline input-sm" maxlenght="5" style="text-align:center; margin: 0 5px;">'+'<a href="#" class="btn btn-sm default next disabled" title="'+oLang.next+'"><i class="fa fa-angle-right"></i></a> '+oLang.pageOf+' <span class="pagination-panel-total"></span>'+(printUrl!=""?' <a href="/cabinet/'+printUrl+'" target="_blank" class="tablePrintButton btn btn-default btn-sm"><i class="fa fa-print"></i>&nbsp;&nbsp;&nbsp;'+
                T["Print"]+"</a> ":"")+(excelUrl!=""?' <a href="/cabinet/'+excelUrl+'" target="_blank" class="tableExcelButton btn btn-default btn-sm"><i class="fa fa-file-excel-o"></i>&nbsp;&nbsp;&nbsp;'+"Excel"+"</a> ":"")+"</div>");var els=$("a",nPaging);$(els[0]).bind("click.DT",{action:"previous"},fnClickHandler);$(els[1]).bind("click.DT",{action:"next"},fnClickHandler);$(".pagination-panel-input",nPaging).bind("change.DT",function(e){var oPaging=oSettings.oInstance.fnPagingInfo();e.preventDefault();var page=
            parseInt($(this).val());if(page>0&&page<=oPaging.iTotalPages){if(oSettings.oApi._fnPageChange(oSettings,page-1))fnDraw(oSettings)}else $(this).val(oPaging.iPage+1)});$(".pagination-panel-input",nPaging).bind("keypress.DT",function(e){var oPaging=oSettings.oInstance.fnPagingInfo();if(e.which==13){var page=parseInt($(this).val());if(page>0&&page<=oSettings.oInstance.fnPagingInfo().iTotalPages){if(oSettings.oApi._fnPageChange(oSettings,page-1))fnDraw(oSettings)}else $(this).val(oPaging.iPage+1);e.preventDefault()}})},
        "fnUpdate":function(oSettings,fnDraw){var iListLength=5;var oPaging=oSettings.oInstance.fnPagingInfo();var an=oSettings.aanFeatures.p;var i,j,sClass,iStart,iEnd,iHalf=Math.floor(iListLength/2);if(oPaging.iTotalPages<iListLength){iStart=1;iEnd=oPaging.iTotalPages}else if(oPaging.iPage<=iHalf){iStart=1;iEnd=iListLength}else if(oPaging.iPage>=oPaging.iTotalPages-iHalf){iStart=oPaging.iTotalPages-iListLength+1;iEnd=oPaging.iTotalPages}else{iStart=oPaging.iPage-iHalf+1;iEnd=iStart+iListLength-1}for(i=
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               0,iLen=an.length;i<iLen;i++){var wrapper=$(an[i]).parents(".dataTables_wrapper");if(oPaging.iTotal<=0)$(".dataTables_paginate, .dataTables_length",wrapper).hide();else $(".dataTables_paginate, .dataTables_length",wrapper).show();if(oPaging.iTotalPages<=0)$(".dataTables_paginate, .dataTables_length .seperator",wrapper).hide();else $(".dataTables_paginate, .dataTables_length .seperator",wrapper).show();$(".pagination-panel-total",an[i]).html(oPaging.iTotalPages);$(".pagination-panel-input",an[i]).val(oPaging.iPage+
            1);$("li:gt(1)",an[i]).filter(":not(.next)").remove();for(j=iStart;j<=iEnd;j++){sClass=j==oPaging.iPage+1?'class="active"':"";$("<li "+sClass+'><a href="#">'+j+"</a></li>").insertBefore($("li.next:first",an[i])[0]).bind("click",function(e){e.preventDefault();oSettings._iDisplayStart=(parseInt($("a",this).text(),10)-1)*oPaging.iLength;fnDraw(oSettings)})}if(oPaging.iPage===0)$("a.prev",an[i]).addClass("disabled");else $("a.prev",an[i]).removeClass("disabled");if(oPaging.iPage===oPaging.iTotalPages-
            1||oPaging.iTotalPages===0)$("a.next",an[i]).addClass("disabled");else $("a.next",an[i]).removeClass("disabled")}}}});
;
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,c,b){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var h=a[e];if(c.call(b,h,e,a))return{i:e,v:h}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,b){if(a==Array.prototype||a==Object.prototype)return a;a[c]=b.value;return a};$jscomp.getGlobal=function(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var c=0;c<a.length;++c){var b=a[c];if(b&&b.Math==Math)return b}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(a,c){var b=$jscomp.propertyToPolyfillSymbol[c];if(null==b)return a[c];b=a[b];return void 0!==b?b:a[c]};
$jscomp.polyfill=function(a,c,b,d){c&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(a,c,b,d):$jscomp.polyfillUnisolated(a,c,b,d))};$jscomp.polyfillUnisolated=function(a,c,b,d){b=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in b||(b[e]={});b=b[e]}a=a[a.length-1];d=b[a];c=c(d);c!=d&&null!=c&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:c})};
$jscomp.polyfillIsolated=function(a,c,b,d){var e=a.split(".");a=1===e.length;d=e[0];d=!a&&d in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var h=0;h<e.length-1;h++){var g=e[h];g in d||(d[g]={});d=d[g]}e=e[e.length-1];b=$jscomp.IS_SYMBOL_NATIVE&&"es6"===b?d[e]:null;c=c(b);null!=c&&(a?$jscomp.defineProperty($jscomp.polyfills,e,{configurable:!0,writable:!0,value:c}):c!==b&&($jscomp.propertyToPolyfillSymbol[e]=$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(e):$jscomp.POLYFILL_PREFIX+e,e=$jscomp.propertyToPolyfillSymbol[e],
$jscomp.defineProperty(d,e,{configurable:!0,writable:!0,value:c})))};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,b){return $jscomp.findInternal(this,a,b).v}},"es6","es3");
var Datatable=function(){var a,c,b,d,e,h=!1,g={},f,m=function(){var d=$('tbody > tr > td:nth-child(1) input[type="checkbox"]:checked',b).size(),c=a.dataTable.language.metronicGroupActions;0<d?$(".table-group-actions > span",e).text(c.replace("_TOTAL_",d)):$(".table-group-actions > span",e).text("")};return{init:function(k){if($().dataTable){f=this;a=k=$.extend(!0,{src:"",filterApplyAction:"filter",filterCancelAction:"filter_cancel",resetGroupActionInputOnSuccess:!0,loadingMessage:"Loading...",initialTableSumsText:"",
dataTable:{dom:"<'row'<'col-md-8 col-sm-12'pli><'col-md-4 col-sm-12'<'table-group-actions pull-right'>>r><'table-scrollable't><'row'<'col-md-8 col-sm-12'pli><'col-md-4 col-sm-12'>>",pageLength:10,language:{metronicGroupActions:"_TOTAL_ records selected:  ",metronicAjaxRequestGeneralError:"Could not complete request. Please check your internet connection",lengthMenu:"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_MENU_",info:T["Total records"]+":&nbsp;&nbsp;_TOTAL_",infoEmpty:"",emptyTable:T["No records"],zeroRecords:T["No records"],
paginate:{previous:"Prev",next:"Next",last:"Last",first:"First",page:T.Page,pageOf:T.of}},orderCellsTop:!0,columnDefs:[{orderable:!1,targets:[0]}],pagingType:"bootstrap_extended",autoWidth:!1,processing:!1,serverSide:!0,ajax:{url:"",type:"POST",timeout:2E4,data:function(a){$.each(g,function(b,d){a[b]=d})},dataSrc:function(c){c.customActionMessage&&Metronic.alert({type:"OK"==c.customActionStatus?"success":"danger",icon:"OK"==c.customActionStatus?"check":"warning",message:c.customActionMessage,container:e,
place:"prepend"});c.customActionStatus&&a.resetGroupActionInputOnSuccess&&$(".table-group-action-input",e).val("");1===$(".group-checkable",b).size()&&($(".group-checkable",b).attr("checked",!1),$.uniform.update($(".group-checkable",b)));a.onSuccess&&a.onSuccess.call(void 0,f);Metronic.unblockUI(d);return c.data},error:function(){a.onError&&a.onError.call(void 0,f);Metronic.alert({type:"danger",icon:"warning",message:a.dataTable.language.metronicAjaxRequestGeneralError,container:e,place:"prepend"});
Metronic.unblockUI(d)}},drawCallback:function(c){0<c._iRecordsTotal?"undefined"!=typeof c.json?$(d).find(".sumContainer").html(c.json.sumsText):$(d).find(".sumContainer").html(a.initialTableSumsText):$(d).find(".sumContainer").html("");!1===h&&(h=!0,b.show());Metronic.initUniform($('input[type="checkbox"]',b));m();a.onDataLoad&&a.onDataLoad.call(void 0,f);window.scrollTo(0,0);if("undefined"!=typeof a.customOptions.dateSplit&&c.aaSorting[0][0]==a.customOptions.dateSplitColumnIndex&&0<c._iRecordsTotal){var e=
"";$("#PlanItemstable tbody tr").each(function(b){b=$(this);var c=b.find("td:eq("+a.customOptions.dateSplitColumnIndex+")").text();e!=c&&(1==a.customOptions.dateSplitColumnIndex?b.before("<tr class='planItemsTableInsertTr'><td></td><td colspan='100'></td></tr>"):b.before("<tr class='planItemsTableInsertTr'><td colspan='100'></td></tr>"),e=c)})}isMobileDevice||$(d).find(".tooltipster:not(.tooltipstered)").tooltipster({theme:"tooltipster-shadow"});f.updateFilters();var k=[];$("[data-total-hide-if-zero]").each(function(a,
b){$(b).contents().each(function(a,b){if("#text"!==b.nodeName&&"W"!==b.nodeName||0!==parseFloat($(b).text().replace(/ /g,""))){if(a=$(b).text())a=parseFloat(a.replace(/ /g,"")),isNaN(a)||k.push(a)}else $(b).parent().hide()})});c=k.filter(function(a,b,c){return b==c.indexOf(a)});2===k.length&&1===c.length&&$("[data-total-hide-if-same]").hide()}}},k);b=$(k.src);d=b.parents(".table-container");var l=$.fn.dataTableExt.oStdClasses;$.fn.dataTableExt.oStdClasses.sWrapper+=" dataTables_extended_wrapper";
$.fn.dataTableExt.oStdClasses.sFilterInput="form-control input-small input-sm input-inline";$.fn.dataTableExt.oStdClasses.sLengthSelect="form-control input-xsmall input-sm input-inline";c=b.DataTable(k.dataTable);$.fn.dataTableExt.oStdClasses.sWrapper=l.sWrapper;$.fn.dataTableExt.oStdClasses.sFilterInput=l.sFilterInput;$.fn.dataTableExt.oStdClasses.sLengthSelect=l.sLengthSelect;e=b.parents(".dataTables_wrapper");1===$(".table-actions-wrapper",d).size()&&($(".table-group-actions",e).html($(".table-actions-wrapper",
d).html()),$(".table-actions-wrapper",d).remove());$(".group-checkable",b).change(function(){var a=$('tbody > tr > td:nth-child(1) input[type="checkbox"]',b),c=$(this).is(":checked");$(a).each(function(){$(this).attr("checked",c)});$.uniform.update(a);m()});b.on("change",'tbody > tr > td:nth-child(1) input[type="checkbox"]',function(){m()});b.on("click",".filter-submit",function(a){a.preventDefault();f.submitFilter()});b.on("click",".filter-cancel",function(a){a.preventDefault();f.resetFilter()})}},
updateFilters:function(){$("input.form-filter.cabinetTableDateFilter",b).each(function(){var a=moment($(this).val(),dateFormats[cabinetLanguage]).format("YYYY-MM-DD");a="Invalid date"!=a?a:"";f.setAjaxParam($(this).attr("name"),a)});$('textarea.form-filter, select.form-filter, input.form-filter:not([type="radio"],[type="checkbox"], .cabinetTableDateFilter)',b).each(function(){f.setAjaxParam($(this).attr("name"),$(this).val())});$('input.form-filter[type="checkbox"]:checked',b).each(function(){f.addAjaxParam($(this).attr("name"),
$(this).val())});$('input.form-filter[type="radio"]:checked',b).each(function(){f.setAjaxParam($(this).attr("name"),$(this).val())})},submitFilter:function(){f.setAjaxParam("action",a.filterApplyAction);f.updateFilters();c.ajax.reload()},resetFilter:function(){$("textarea.form-filter, select.form-filter, input.form-filter",b).each(function(){$(this).val("")});$('input.form-filter[type="checkbox"]',b).each(function(){$(this).attr("checked",!1)});f.clearAjaxParams();f.addAjaxParam("action",a.filterCancelAction);
c.ajax.reload()},getSelectedRowsCount:function(){return $('tbody > tr > td:nth-child(1) input[type="checkbox"]:checked',b).size()},getSelectedRows:function(){var a=[];$('tbody > tr > td:nth-child(1) input[type="checkbox"]:checked',b).each(function(){a.push($(this).val())});return a},setAjaxParam:function(a,b){g[a]=b},addAjaxParam:function(a,b){g[a]||(g[a]=[]);skip=!1;for(var c=0;c<g[a].length;c++)g[a][c]===b&&(skip=!0);!1===skip&&g[a].push(b)},clearAjaxParams:function(a,b){g={}},getDataTable:function(){return c},
getTableWrapper:function(){return e},gettableContainer:function(){return d},getTable:function(){return b}}};
;
/*!
 FixedColumns 3.0.2
 2010-2014 SpryMedia Ltd - datatables.net/license
*/
(function(q,r){var o=function(d){var k=function(a,b){var c=this;if(!this instanceof k)alert("FixedColumns warning: FixedColumns must be initialised with the 'new' keyword.");else{"undefined"==typeof b&&(b={});d.fn.dataTable.camelToHungarian&&d.fn.dataTable.camelToHungarian(k.defaults,b);var g=d.fn.dataTable.Api?(new d.fn.dataTable.Api(a)).settings()[0]:a.fnSettings();this.s={dt:g,iTableColumns:g.aoColumns.length,aiOuterWidths:[],aiInnerWidths:[]};this.dom={scroller:null,header:null,body:null,footer:null,
grid:{wrapper:null,dt:null,left:{wrapper:null,head:null,body:null,foot:null},right:{wrapper:null,head:null,body:null,foot:null}},clone:{left:{header:null,body:null,footer:null},right:{header:null,body:null,footer:null}}};g._oFixedColumns=this;g._bInitComplete?this._fnConstruct(b):g.oApi._fnCallbackReg(g,"aoInitComplete",function(){c._fnConstruct(b)},"FixedColumns")}};k.prototype={fnUpdate:function(){this._fnDraw(!0)},fnRedrawLayout:function(){this._fnColCalc();this._fnGridLayout();this.fnUpdate()},
fnRecalculateHeight:function(a){delete a._DTTC_iHeight;a.style.height="auto"},fnSetRowHeight:function(a,b){a.style.height=b+"px"},fnGetPosition:function(a){var b=this.s.dt.oInstance;if(d(a).parents(".DTFC_Cloned").length){if("tr"===a.nodeName.toLowerCase())return a=d(a).index(),b.fnGetPosition(d("tr",this.s.dt.nTBody)[a]);var c=d(a).index(),a=d(a.parentNode).index();return[b.fnGetPosition(d("tr",this.s.dt.nTBody)[a]),c,b.oApi._fnVisibleToColumnIndex(this.s.dt,c)]}return b.fnGetPosition(a)},_fnConstruct:function(a){var b=
this;if("function"!=typeof this.s.dt.oInstance.fnVersionCheck||!0!==this.s.dt.oInstance.fnVersionCheck("1.8.0"))alert("FixedColumns "+k.VERSION+" required DataTables 1.8.0 or later. Please upgrade your DataTables installation");else if(""===this.s.dt.oScroll.sX)this.s.dt.oInstance.oApi._fnLog(this.s.dt,1,"FixedColumns is not needed (no x-scrolling in DataTables enabled), so no action will be taken. Use 'FixedHeader' for column fixing when scrolling is not enabled");else{this.s=d.extend(!0,this.s,
k.defaults,a);a=this.s.dt.oClasses;this.dom.grid.dt=d(this.s.dt.nTable).parents("div."+a.sScrollWrapper)[0];this.dom.scroller=d("div."+a.sScrollBody,this.dom.grid.dt)[0];this._fnColCalc();this._fnGridSetup();var c;d(this.dom.scroller).on("mouseover.DTFC touchstart.DTFC",function(){c="main"}).on("scroll.DTFC",function(){if("main"===c&&(0<b.s.iLeftColumns&&(b.dom.grid.left.liner.scrollTop=b.dom.scroller.scrollTop),0<b.s.iRightColumns))b.dom.grid.right.liner.scrollTop=b.dom.scroller.scrollTop});var g=
"onwheel"in r.createElement("div")?"wheel.DTFC":"mousewheel.DTFC";if(0<b.s.iLeftColumns)d(b.dom.grid.left.liner).on("mouseover.DTFC touchstart.DTFC",function(){c="left"}).on("scroll.DTFC",function(){"left"===c&&(b.dom.scroller.scrollTop=b.dom.grid.left.liner.scrollTop,0<b.s.iRightColumns&&(b.dom.grid.right.liner.scrollTop=b.dom.grid.left.liner.scrollTop))}).on(g,function(a){b.dom.scroller.scrollLeft-="wheel"===a.type?-a.originalEvent.deltaX:a.originalEvent.wheelDeltaX});if(0<b.s.iRightColumns)d(b.dom.grid.right.liner).on("mouseover.DTFC touchstart.DTFC",
function(){c="right"}).on("scroll.DTFC",function(){"right"===c&&(b.dom.scroller.scrollTop=b.dom.grid.right.liner.scrollTop,0<b.s.iLeftColumns&&(b.dom.grid.left.liner.scrollTop=b.dom.grid.right.liner.scrollTop))}).on(g,function(a){b.dom.scroller.scrollLeft-="wheel"===a.type?-a.originalEvent.deltaX:a.originalEvent.wheelDeltaX});d(q).on("resize.DTFC",function(){b._fnGridLayout.call(b)});var f=!0,e=d(this.s.dt.nTable);e.on("draw.dt.DTFC",function(){b._fnDraw.call(b,f);f=!1}).on("column-sizing.dt.DTFC",
function(){b._fnColCalc();b._fnGridLayout(b)}).on("column-visibility.dt.DTFC",function(){b._fnColCalc();b._fnGridLayout(b);b._fnDraw(!0)}).on("destroy.dt.DTFC",function(){e.off("column-sizing.dt.DTFC destroy.dt.DTFC draw.dt.DTFC");d(b.dom.scroller).off("scroll.DTFC mouseover.DTFC");d(q).off("resize.DTFC");d(b.dom.grid.left.liner).off("scroll.DTFC mouseover.DTFC "+g);d(b.dom.grid.left.wrapper).remove();d(b.dom.grid.right.liner).off("scroll.DTFC mouseover.DTFC "+g);d(b.dom.grid.right.wrapper).remove()});
this._fnGridLayout();this.s.dt.oInstance.fnDraw(!1)}},_fnColCalc:function(){var a=this,b=0,c=0;this.s.aiInnerWidths=[];this.s.aiOuterWidths=[];d.each(this.s.dt.aoColumns,function(g,f){var e=d(f.nTh),h;if(e.filter(":visible").length){var i=e.outerWidth();0===a.s.aiOuterWidths.length&&(h=d(a.s.dt.nTable).css("border-left-width"),i+="string"===typeof h?1:parseInt(h,10));a.s.aiOuterWidths.length===a.s.dt.aoColumns.length-1&&(h=d(a.s.dt.nTable).css("border-right-width"),i+="string"===typeof h?1:parseInt(h,
10));a.s.aiOuterWidths.push(i);a.s.aiInnerWidths.push(e.width());g<a.s.iLeftColumns&&(b+=i);a.s.iTableColumns-a.s.iRightColumns<=g&&(c+=i)}else a.s.aiInnerWidths.push(0),a.s.aiOuterWidths.push(0)});this.s.iLeftWidth=b;this.s.iRightWidth=c},_fnGridSetup:function(){var a=this._fnDTOverflow(),b;this.dom.body=this.s.dt.nTable;this.dom.header=this.s.dt.nTHead.parentNode;this.dom.header.parentNode.parentNode.style.position="relative";var c=d('<div class="DTFC_ScrollWrapper" style="position:relative; clear:both;"><div class="DTFC_LeftWrapper" style="position:absolute; top:0; left:0;"><div class="DTFC_LeftHeadWrapper" style="position:relative; top:0; left:0; overflow:hidden;"></div><div class="DTFC_LeftBodyWrapper" style="position:relative; top:0; left:0; overflow:hidden;"><div class="DTFC_LeftBodyLiner" style="position:relative; top:0; left:0; overflow-y:scroll;"></div></div><div class="DTFC_LeftFootWrapper" style="position:relative; top:0; left:0; overflow:hidden;"></div></div><div class="DTFC_RightWrapper" style="position:absolute; top:0; left:0;"><div class="DTFC_RightHeadWrapper" style="position:relative; top:0; left:0;"><div class="DTFC_RightHeadBlocker DTFC_Blocker" style="position:absolute; top:0; bottom:0;"></div></div><div class="DTFC_RightBodyWrapper" style="position:relative; top:0; left:0; overflow:hidden;"><div class="DTFC_RightBodyLiner" style="position:relative; top:0; left:0; overflow-y:scroll;"></div></div><div class="DTFC_RightFootWrapper" style="position:relative; top:0; left:0;"><div class="DTFC_RightFootBlocker DTFC_Blocker" style="position:absolute; top:0; bottom:0;"></div></div></div></div>')[0],
g=c.childNodes[0],f=c.childNodes[1];this.dom.grid.dt.parentNode.insertBefore(c,this.dom.grid.dt);c.appendChild(this.dom.grid.dt);this.dom.grid.wrapper=c;0<this.s.iLeftColumns&&(this.dom.grid.left.wrapper=g,this.dom.grid.left.head=g.childNodes[0],this.dom.grid.left.body=g.childNodes[1],this.dom.grid.left.liner=d("div.DTFC_LeftBodyLiner",c)[0],c.appendChild(g));0<this.s.iRightColumns&&(this.dom.grid.right.wrapper=f,this.dom.grid.right.head=f.childNodes[0],this.dom.grid.right.body=f.childNodes[1],this.dom.grid.right.liner=
d("div.DTFC_RightBodyLiner",c)[0],b=d("div.DTFC_RightHeadBlocker",c)[0],b.style.width=a.bar+"px",b.style.right=-a.bar+"px",this.dom.grid.right.headBlock=b,b=d("div.DTFC_RightFootBlocker",c)[0],b.style.width=a.bar+"px",b.style.right=-a.bar+"px",this.dom.grid.right.footBlock=b,c.appendChild(f));if(this.s.dt.nTFoot&&(this.dom.footer=this.s.dt.nTFoot.parentNode,0<this.s.iLeftColumns&&(this.dom.grid.left.foot=g.childNodes[2]),0<this.s.iRightColumns))this.dom.grid.right.foot=f.childNodes[2]},_fnGridLayout:function(){var a=
this.dom.grid,b=d(a.wrapper).width(),c=d(this.s.dt.nTable.parentNode).outerHeight(),g=d(this.s.dt.nTable.parentNode.parentNode).outerHeight(),f=this._fnDTOverflow(),e=this.s.iLeftWidth,h=this.s.iRightWidth;f.x&&(c-=f.bar);a.wrapper.style.height=g+"px";0<this.s.iLeftColumns&&(a.left.wrapper.style.width=e+"px",a.left.wrapper.style.height="1px",a.left.body.style.height=c+"px",a.left.foot&&(a.left.foot.style.top=(f.x?f.bar:0)+"px"),a.left.liner.style.width=e+f.bar+"px",a.left.liner.style.height=c+"px");
0<this.s.iRightColumns&&(b-=h,f.y&&(b-=f.bar),a.right.wrapper.style.width=h+"px",a.right.wrapper.style.left=b+"px",a.right.wrapper.style.height="1px",a.right.body.style.height=c+"px",a.right.foot&&(a.right.foot.style.top=(f.x?f.bar:0)+"px"),a.right.liner.style.width=h+f.bar+"px",a.right.liner.style.height=c+"px",a.right.headBlock.style.display=f.y?"block":"none",a.right.footBlock.style.display=f.y?"block":"none")},_fnDTOverflow:function(){var a=this.s.dt.nTable,b=a.parentNode,c={x:!1,y:!1,bar:this.s.dt.oScroll.iBarWidth};
a.offsetWidth>b.clientWidth&&(c.x=!0);a.offsetHeight>b.clientHeight&&(c.y=!0);return c},_fnDraw:function(a){this._fnGridLayout();this._fnCloneLeft(a);this._fnCloneRight(a);null!==this.s.fnDrawCallback&&this.s.fnDrawCallback.call(this,this.dom.clone.left,this.dom.clone.right);d(this).trigger("draw.dtfc",{leftClone:this.dom.clone.left,rightClone:this.dom.clone.right})},_fnCloneRight:function(a){if(!(0>=this.s.iRightColumns)){var b,c=[];for(b=this.s.iTableColumns-this.s.iRightColumns;b<this.s.iTableColumns;b++)this.s.dt.aoColumns[b].bVisible&&
c.push(b);this._fnClone(this.dom.clone.right,this.dom.grid.right,c,a)}},_fnCloneLeft:function(a){if(!(0>=this.s.iLeftColumns)){var b,c=[];for(b=0;b<this.s.iLeftColumns;b++)this.s.dt.aoColumns[b].bVisible&&c.push(b);this._fnClone(this.dom.clone.left,this.dom.grid.left,c,a)}},_fnCopyLayout:function(a,b){for(var c=[],g=[],f=[],e=0,h=a.length;e<h;e++){var i=[];i.nTr=d(a[e].nTr).clone(!0,!0)[0];for(var j=0,n=this.s.iTableColumns;j<n;j++)if(-1!==d.inArray(j,b)){var l=d.inArray(a[e][j].cell,f);-1===l?(l=
d(a[e][j].cell).clone(!0,!0)[0],g.push(l),f.push(a[e][j].cell),i.push({cell:l,unique:a[e][j].unique})):i.push({cell:g[l],unique:a[e][j].unique})}c.push(i)}return c},_fnClone:function(a,b,c,g){var f=this,e,h,i,j,n,l,k,m,p;if(g){null!==a.header&&a.header.parentNode.removeChild(a.header);a.header=d(this.dom.header).clone(!0,!0)[0];a.header.className+=" DTFC_Cloned";a.header.style.width="100%";b.head.appendChild(a.header);m=this._fnCopyLayout(this.s.dt.aoHeader,c);j=d(">thead",a.header);j.empty();e=0;
for(h=m.length;e<h;e++)j[0].appendChild(m[e].nTr);this.s.dt.oApi._fnDrawHead(this.s.dt,m,!0)}else{m=this._fnCopyLayout(this.s.dt.aoHeader,c);p=[];this.s.dt.oApi._fnDetectHeader(p,d(">thead",a.header)[0]);e=0;for(h=m.length;e<h;e++){i=0;for(j=m[e].length;i<j;i++)p[e][i].cell.className=m[e][i].cell.className,d("span.DataTables_sort_icon",p[e][i].cell).each(function(){this.className=d("span.DataTables_sort_icon",m[e][i].cell)[0].className})}}this._fnEqualiseHeights("thead",this.dom.header,a.header);
"auto"==this.s.sHeightMatch&&d(">tbody>tr",f.dom.body).css("height","auto");null!==a.body&&(a.body.parentNode.removeChild(a.body),a.body=null);a.body=d(this.dom.body).clone(!0)[0];a.body.className+=" DTFC_Cloned";a.body.style.paddingBottom=this.s.dt.oScroll.iBarWidth+"px";a.body.style.marginBottom=2*this.s.dt.oScroll.iBarWidth+"px";null!==a.body.getAttribute("id")&&a.body.removeAttribute("id");d(">thead>tr",a.body).empty();d(">tfoot",a.body).remove();var o=d("tbody",a.body)[0];d(o).empty();if(0<this.s.dt.aiDisplay.length){h=
d(">thead>tr",a.body)[0];for(k=0;k<c.length;k++)n=c[k],l=d(this.s.dt.aoColumns[n].nTh).clone(!0)[0],l.innerHTML="",j=l.style,j.paddingTop="0",j.paddingBottom="0",j.borderTopWidth="0",j.borderBottomWidth="0",j.height=0,j.width=f.s.aiInnerWidths[n]+"px",h.appendChild(l);d(">tbody>tr",f.dom.body).each(function(a){var b=this.cloneNode(false);b.removeAttribute("id");a=f.s.dt.oFeatures.bServerSide===false?f.s.dt.aiDisplay[f.s.dt._iDisplayStart+a]:a;for(k=0;k<c.length;k++){var e=f.s.dt.aoData[a].anCells||
f.s.dt.oApi._fnGetTdNodes(f.s.dt,a);n=c[k];if(e.length>0){l=d(e[n]).clone(true,true)[0];b.appendChild(l)}}o.appendChild(b)})}else d(">tbody>tr",f.dom.body).each(function(){l=this.cloneNode(true);l.className=l.className+" DTFC_NoData";d("td",l).html("");o.appendChild(l)});a.body.style.width="100%";a.body.style.margin="0";a.body.style.padding="0";g&&"undefined"!=typeof this.s.dt.oScroller&&b.liner.appendChild(this.s.dt.oScroller.dom.force.cloneNode(!0));b.liner.appendChild(a.body);this._fnEqualiseHeights("tbody",
f.dom.body,a.body);if(null!==this.s.dt.nTFoot){if(g){null!==a.footer&&a.footer.parentNode.removeChild(a.footer);a.footer=d(this.dom.footer).clone(!0,!0)[0];a.footer.className+=" DTFC_Cloned";a.footer.style.width="100%";b.foot.appendChild(a.footer);m=this._fnCopyLayout(this.s.dt.aoFooter,c);b=d(">tfoot",a.footer);b.empty();e=0;for(h=m.length;e<h;e++)b[0].appendChild(m[e].nTr);this.s.dt.oApi._fnDrawHead(this.s.dt,m,!0)}else{m=this._fnCopyLayout(this.s.dt.aoFooter,c);b=[];this.s.dt.oApi._fnDetectHeader(b,
d(">tfoot",a.footer)[0]);e=0;for(h=m.length;e<h;e++){i=0;for(j=m[e].length;i<j;i++)b[e][i].cell.className=m[e][i].cell.className}}this._fnEqualiseHeights("tfoot",this.dom.footer,a.footer)}b=this.s.dt.oApi._fnGetUniqueThs(this.s.dt,d(">thead",a.header)[0]);d(b).each(function(a){n=c[a];this.style.width=f.s.aiInnerWidths[n]+"px"});null!==f.s.dt.nTFoot&&(b=this.s.dt.oApi._fnGetUniqueThs(this.s.dt,d(">tfoot",a.footer)[0]),d(b).each(function(a){n=c[a];this.style.width=f.s.aiInnerWidths[n]+"px"}))},_fnGetTrNodes:function(a){for(var b=
[],c=0,d=a.childNodes.length;c<d;c++)"TR"==a.childNodes[c].nodeName.toUpperCase()&&b.push(a.childNodes[c]);return b},_fnEqualiseHeights:function(a,b,c){if(!("none"==this.s.sHeightMatch&&"thead"!==a&&"tfoot"!==a)){var g,f,e=b.getElementsByTagName(a)[0],c=c.getElementsByTagName(a)[0],a=d(">"+a+">tr:eq(0)",b).children(":first");a.outerHeight();a.height();for(var e=this._fnGetTrNodes(e),b=this._fnGetTrNodes(c),h=[],c=0,a=b.length;c<a;c++)g=e[c].offsetHeight,f=b[c].offsetHeight,g=f>g?f:g,"semiauto"==this.s.sHeightMatch&&
(e[c]._DTTC_iHeight=g),h.push(g);c=0;for(a=b.length;c<a;c++)b[c].style.height=h[c]+"px",e[c].style.height=h[c]+"px"}}};k.defaults={iLeftColumns:1,iRightColumns:0,fnDrawCallback:null,sHeightMatch:"semiauto"};k.version="3.0.2";d.fn.dataTable.FixedColumns=k;return d.fn.DataTable.FixedColumns=k};"function"===typeof define&&define.amd?define(["jquery","datatables"],o):"object"===typeof exports?o(require("jquery"),require("datatables")):jQuery&&!jQuery.fn.dataTable.FixedColumns&&o(jQuery,jQuery.fn.dataTable)})(window,
document);
;
/**
 * Copyright (c) 2007-2015 Ariel Flesler - aflesler  gmail  com | http://flesler.blogspot.com
 * Licensed under MIT
 * @author Ariel Flesler
 * @version 2.1.3
 */
;(function(f){"use strict";"function"===typeof define&&define.amd?define(["jquery"],f):"undefined"!==typeof module&&module.exports?module.exports=f(require("jquery")):f(jQuery)})(function($){"use strict";function n(a){return!a.nodeName||-1!==$.inArray(a.nodeName.toLowerCase(),["iframe","#document","html","body"])}function h(a){return $.isFunction(a)||$.isPlainObject(a)?a:{top:a,left:a}}var p=$.scrollTo=function(a,d,b){return $(window).scrollTo(a,d,b)};p.defaults={axis:"xy",duration:0,limit:!0};$.fn.scrollTo=function(a,d,b){"object"=== typeof d&&(b=d,d=0);"function"===typeof b&&(b={onAfter:b});"max"===a&&(a=9E9);b=$.extend({},p.defaults,b);d=d||b.duration;var u=b.queue&&1<b.axis.length;u&&(d/=2);b.offset=h(b.offset);b.over=h(b.over);return this.each(function(){function k(a){var k=$.extend({},b,{queue:!0,duration:d,complete:a&&function(){a.call(q,e,b)}});r.animate(f,k)}if(null!==a){var l=n(this),q=l?this.contentWindow||window:this,r=$(q),e=a,f={},t;switch(typeof e){case "number":case "string":if(/^([+-]=?)?\d+(\.\d+)?(px|%)?$/.test(e)){e= h(e);break}e=l?$(e):$(e,q);case "object":if(e.length===0)return;if(e.is||e.style)t=(e=$(e)).offset()}var v=$.isFunction(b.offset)&&b.offset(q,e)||b.offset;$.each(b.axis.split(""),function(a,c){var d="x"===c?"Left":"Top",m=d.toLowerCase(),g="scroll"+d,h=r[g](),n=p.max(q,c);t?(f[g]=t[m]+(l?0:h-r.offset()[m]),b.margin&&(f[g]-=parseInt(e.css("margin"+d),10)||0,f[g]-=parseInt(e.css("border"+d+"Width"),10)||0),f[g]+=v[m]||0,b.over[m]&&(f[g]+=e["x"===c?"width":"height"]()*b.over[m])):(d=e[m],f[g]=d.slice&& "%"===d.slice(-1)?parseFloat(d)/100*n:d);b.limit&&/^\d+$/.test(f[g])&&(f[g]=0>=f[g]?0:Math.min(f[g],n));!a&&1<b.axis.length&&(h===f[g]?f={}:u&&(k(b.onAfterFirst),f={}))});k(b.onAfter)}})};p.max=function(a,d){var b="x"===d?"Width":"Height",h="scroll"+b;if(!n(a))return a[h]-$(a)[b.toLowerCase()]();var b="client"+b,k=a.ownerDocument||a.document,l=k.documentElement,k=k.body;return Math.max(l[h],k[h])-Math.min(l[b],k[b])};$.Tween.propHooks.scrollLeft=$.Tween.propHooks.scrollTop={get:function(a){return $(a.elem)[a.prop]()}, set:function(a){var d=this.get(a);if(a.options.interrupt&&a._last&&a._last!==d)return $(a.elem).stop();var b=Math.round(a.now);d!==b&&($(a.elem)[a.prop](b),a._last=this.get(a))}};return p});;
/*!
 * imagesLoaded PACKAGED v4.1.0
 * JavaScript is all like "You images are done yet or what?"
 * MIT License
 */

!function(t,e){"function"==typeof define&&define.amd?define("ev-emitter/ev-emitter",e):"object"==typeof module&&module.exports?module.exports=e():t.EvEmitter=e()}(this,function(){function t(){}var e=t.prototype;return e.on=function(t,e){if(t&&e){var i=this._events=this._events||{},n=i[t]=i[t]||[];return-1==n.indexOf(e)&&n.push(e),this}},e.once=function(t,e){if(t&&e){this.on(t,e);var i=this._onceEvents=this._onceEvents||{},n=i[t]=i[t]||[];return n[e]=!0,this}},e.off=function(t,e){var i=this._events&&this._events[t];if(i&&i.length){var n=i.indexOf(e);return-1!=n&&i.splice(n,1),this}},e.emitEvent=function(t,e){var i=this._events&&this._events[t];if(i&&i.length){var n=0,o=i[n];e=e||[];for(var r=this._onceEvents&&this._onceEvents[t];o;){var s=r&&r[o];s&&(this.off(t,o),delete r[o]),o.apply(this,e),n+=s?0:1,o=i[n]}return this}},t}),function(t,e){"use strict";"function"==typeof define&&define.amd?define(["ev-emitter/ev-emitter"],function(i){return e(t,i)}):"object"==typeof module&&module.exports?module.exports=e(t,require("ev-emitter")):t.imagesLoaded=e(t,t.EvEmitter)}(window,function(t,e){function i(t,e){for(var i in e)t[i]=e[i];return t}function n(t){var e=[];if(Array.isArray(t))e=t;else if("number"==typeof t.length)for(var i=0;i<t.length;i++)e.push(t[i]);else e.push(t);return e}function o(t,e,r){return this instanceof o?("string"==typeof t&&(t=document.querySelectorAll(t)),this.elements=n(t),this.options=i({},this.options),"function"==typeof e?r=e:i(this.options,e),r&&this.on("always",r),this.getImages(),h&&(this.jqDeferred=new h.Deferred),void setTimeout(function(){this.check()}.bind(this))):new o(t,e,r)}function r(t){this.img=t}function s(t,e){this.url=t,this.element=e,this.img=new Image}var h=t.jQuery,a=t.console;o.prototype=Object.create(e.prototype),o.prototype.options={},o.prototype.getImages=function(){this.images=[],this.elements.forEach(this.addElementImages,this)},o.prototype.addElementImages=function(t){"IMG"==t.nodeName&&this.addImage(t),this.options.background===!0&&this.addElementBackgroundImages(t);var e=t.nodeType;if(e&&d[e]){for(var i=t.querySelectorAll("img"),n=0;n<i.length;n++){var o=i[n];this.addImage(o)}if("string"==typeof this.options.background){var r=t.querySelectorAll(this.options.background);for(n=0;n<r.length;n++){var s=r[n];this.addElementBackgroundImages(s)}}}};var d={1:!0,9:!0,11:!0};return o.prototype.addElementBackgroundImages=function(t){var e=getComputedStyle(t);if(e)for(var i=/url\((['"])?(.*?)\1\)/gi,n=i.exec(e.backgroundImage);null!==n;){var o=n&&n[2];o&&this.addBackground(o,t),n=i.exec(e.backgroundImage)}},o.prototype.addImage=function(t){var e=new r(t);this.images.push(e)},o.prototype.addBackground=function(t,e){var i=new s(t,e);this.images.push(i)},o.prototype.check=function(){function t(t,i,n){setTimeout(function(){e.progress(t,i,n)})}var e=this;return this.progressedCount=0,this.hasAnyBroken=!1,this.images.length?void this.images.forEach(function(e){e.once("progress",t),e.check()}):void this.complete()},o.prototype.progress=function(t,e,i){this.progressedCount++,this.hasAnyBroken=this.hasAnyBroken||!t.isLoaded,this.emitEvent("progress",[this,t,e]),this.jqDeferred&&this.jqDeferred.notify&&this.jqDeferred.notify(this,t),this.progressedCount==this.images.length&&this.complete(),this.options.debug&&a&&a.log("progress: "+i,t,e)},o.prototype.complete=function(){var t=this.hasAnyBroken?"fail":"done";if(this.isComplete=!0,this.emitEvent(t,[this]),this.emitEvent("always",[this]),this.jqDeferred){var e=this.hasAnyBroken?"reject":"resolve";this.jqDeferred[e](this)}},r.prototype=Object.create(e.prototype),r.prototype.check=function(){var t=this.getIsImageComplete();return t?void this.confirm(0!==this.img.naturalWidth,"naturalWidth"):(this.proxyImage=new Image,this.proxyImage.addEventListener("load",this),this.proxyImage.addEventListener("error",this),this.img.addEventListener("load",this),this.img.addEventListener("error",this),void(this.proxyImage.src=this.img.src))},r.prototype.getIsImageComplete=function(){return this.img.complete&&void 0!==this.img.naturalWidth},r.prototype.confirm=function(t,e){this.isLoaded=t,this.emitEvent("progress",[this,this.img,e])},r.prototype.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},r.prototype.onload=function(){this.confirm(!0,"onload"),this.unbindEvents()},r.prototype.onerror=function(){this.confirm(!1,"onerror"),this.unbindEvents()},r.prototype.unbindEvents=function(){this.proxyImage.removeEventListener("load",this),this.proxyImage.removeEventListener("error",this),this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},s.prototype=Object.create(r.prototype),s.prototype.check=function(){this.img.addEventListener("load",this),this.img.addEventListener("error",this),this.img.src=this.url;var t=this.getIsImageComplete();t&&(this.confirm(0!==this.img.naturalWidth,"naturalWidth"),this.unbindEvents())},s.prototype.unbindEvents=function(){this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},s.prototype.confirm=function(t,e){this.isLoaded=t,this.emitEvent("progress",[this,this.element,e])},o.makeJQueryPlugin=function(e){e=e||t.jQuery,e&&(h=e,h.fn.imagesLoaded=function(t,e){var i=new o(this,t,e);return i.jqDeferred.promise(h(this))})},o.makeJQueryPlugin(),o});;
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,c,b){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var f=a[e];if(c.call(b,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,b){if(a==Array.prototype||a==Object.prototype)return a;a[c]=b.value;return a};$jscomp.getGlobal=function(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var c=0;c<a.length;++c){var b=a[c];if(b&&b.Math==Math)return b}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(a,c){var b=$jscomp.propertyToPolyfillSymbol[c];if(null==b)return a[c];b=a[b];return void 0!==b?b:a[c]};
$jscomp.polyfill=function(a,c,b,d){c&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(a,c,b,d):$jscomp.polyfillUnisolated(a,c,b,d))};$jscomp.polyfillUnisolated=function(a,c,b,d){b=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in b||(b[e]={});b=b[e]}a=a[a.length-1];d=b[a];c=c(d);c!=d&&null!=c&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:c})};
$jscomp.polyfillIsolated=function(a,c,b,d){var e=a.split(".");a=1===e.length;d=e[0];d=!a&&d in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var f=0;f<e.length-1;f++){var g=e[f];g in d||(d[g]={});d=d[g]}e=e[e.length-1];b=$jscomp.IS_SYMBOL_NATIVE&&"es6"===b?d[e]:null;c=c(b);null!=c&&(a?$jscomp.defineProperty($jscomp.polyfills,e,{configurable:!0,writable:!0,value:c}):c!==b&&($jscomp.propertyToPolyfillSymbol[e]=$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(e):$jscomp.POLYFILL_PREFIX+e,e=$jscomp.propertyToPolyfillSymbol[e],
$jscomp.defineProperty(d,e,{configurable:!0,writable:!0,value:c})))};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,b){return $jscomp.findInternal(this,a,b).v}},"es6","es3");var dateFormats={ua:"DD.MM.YYYY",en:"MM.DD.YYYY",ru:"DD.MM.YYYY",lt:"DD.MM.YYYY"},dateTimeFormats={ua:"DD.MM.YYYY HH:mm",en:"MM.DD.YYYY HH:mm",ru:"DD.MM.YYYY HH:mm",lt:"DD.MM.YYYY HH:mm"};
function initDateTimePicker(a,c){var b={useCurrent:!1,format:dateFormats[cabinetLanguage],allowInputToggle:!0,icons:{time:"glyphicon glyphicon-time",date:"glyphicon glyphicon-calendar",up:"fa fa-angle-up",down:"fa fa-angle-down",previous:"fa fa-angle-left",next:"fa fa-angle-right",today:"glyphicon glyphicon-screenshot",clear:"glyphicon glyphicon-trash",close:"glyphicon glyphicon-remove"}};b=$.extend(b,c);a.datetimepicker(b).on("dp.show",function(a){a=$("body").find(".bootstrap-datetimepicker-widget:last");
var b=a.offset(),c=a.parent(),d=c.offset(),h=a.width();c=c.width();a.appendTo("body");a.css({position:"absolute",top:b.top,bottom:"auto",left:b.left,right:"auto","z-index":2E4});d.left+c<b.left+h&&(b=d.left,a.css({left:b+c/2-h/2}))})}function getDateTimePickerDateInServerFormat(a,c){"undefined"==typeof c&&(c="YYYY-MM-DD");a=$(a).data("DateTimePicker").date();return null!=a?a.format(c):""};
;
var datePageLoaded = new Date();
var unsavedChanges = false;
var isMobileDevice = false;

ajaxParameters = {
    type: 'POST',
    timeout: 25000, // Formgen timeout in QForm.php
    error: function (req, error) {
        // console.log(req, 'req');
        // console.log(req.statusCode(), 'req statusCode');
        // console.log(error, 'error');
        if (req.status == 404) {
            showAjaxData({page404: true});
            clearTimeout(timeout);
            hideLoadingBlock();
            return;
        }
        if (req.status == 500) {
            messageBoard(req.responseText, 'warning');
        } else {
            if (error === 'error') error = req.statusText;
            messageBoard(T['Bad internet connection error'], 'warning');
        }
    },
    showAjaxLoadingBlock: true,
};
var timeout;
var loadingBlockBlackoutTimeout;

function ajax(parameters) {
    var success = parameters.success;
    parameters.success = function (data) {
        try {
            data = eval('(' + data + ')');
        } catch (err) {
            messageBoard(data, 'warning');
        }
        if (data.action !== undefined) {
            eval(data.action);
        }

        if (data.error === undefined) {
            success(data);
            if (data.message !== undefined) {
                messageBoard(data.message);
            }
        } else {
            errorHandler(data);
        }
        clearTimeout(timeout);
        if (typeof (parameters.doNotHideLoadingBlockOnSuccess) == 'undefined')
            hideLoadingBlock();
        preloadFirstZoomImage();
    };
    clearTimeout(timeout);
    if (typeof (parameters.showAjaxLoadingBlock) == 'undefined' || parameters.showAjaxLoadingBlock) {
        timeout = setTimeout("showLoadingBlock()", 270);
    }
    if (typeof (parameters.data) == 'undefined') {
        parameters.data = {};
    }
    if (typeof (parameters.data.currentClinicId) == 'undefined') {
        parameters.data.currentClinicId = currentClinicId;
    }
    $.ajax($.extend({}, ajaxParameters, parameters));
}

function blackOutLoadingBlock() {
    $('.blockUI.blockOverlay').fadeTo(2500, '0.7');
}

function showLoadingBlock() {
    Metronic.blockUI({
        boxed: true,
        zIndex: 11000,
        message: T['Wait please'],
        iconOnly: true,
        css: {
            width: '50%',
        },
    });
    loadingBlockBlackoutTimeout = setTimeout("blackOutLoadingBlock()", 1700);
}

function hideLoadingBlock() {
    clearTimeout(blackOutLoadingBlock);
    Metronic.unblockUI();
}

function errorHandler(data) {
    if (data.error == 'auth') {
        document.location = '/cabinet';
    } else {
        messageBoard(htmlspecialchars(data.error), 'warning');
    }
}

// String.prototype.searchCaseInsensitive = function (substring) {
//     var string = this.toLocaleLowerCase();
//     substring = substring.toLocaleLowerCase();
//     return string.indexOf(substring) > -1;
// };

searchCaseInsensitive = function (string, substring) {
    var string = string.toLocaleLowerCase();
    substring = substring.toLocaleLowerCase();
    return string.indexOf(substring) > -1;
};

window.addEventListener("hashchange", locationHashChanged, false);
var scrollToNewWhateverNeeded = false;
var stageIdToScrollTo = false; // used for search results, consider making deeplinking to stages
var pageWebSocket = false;

function locationHashChanged(scrollToTopAfterDataLoad, customAjaxData) {
    var ajaxData = typeof customAjaxData !== 'undefined' ? customAjaxData : {};
    scrollToTopAfterDataLoad = typeof scrollToTopAfterDataLoad !== 'undefined' ? scrollToTopAfterDataLoad : true;

    var hash = location.hash.substring(1);
    //var ajaxData = new Object();
    ajaxData.hash = hash;

    if (typeof (ajaxData.currentClinicId) == 'undefined') {
        ajaxData.currentClinicId = currentClinicId;
    }
    ajaxData.windowWidth = $(window).width();


    ajax({
        url: '/cabinet/' + hash,
        data: ajaxData,
        success: function (data) {
            // console.log("hash", hash);
            if (typeof (data.V) != 'undefined' && data.V != V)
                location.reload();
            if (Math.floor(((new Date() - datePageLoaded) / 1000) / (60 * 60)) >= 12)
                // if (Math.floor(((new Date() - datePageLoaded) / 1000) / (60)) > 1)
                location.reload();
            if (pageWebSocket)
                pageWebSocket.close();

            if (hash == 'schedule' || hash == 'schedule/assistants' || hash == 'schedule/administrators') {
                $('#menuBottomBlock').show();
                $(' .page-content').addClass('page-content-wrapper-no-right-padding');
            } else {
                $('#menuBottomBlock').hide();
                $('.page-content-wrapper-no-right-padding').removeClass('page-content-wrapper-no-right-padding');
            }
            showAjaxData(data, scrollToTopAfterDataLoad);
            updateWsPageType();
            if (1 || scrollToNewWhateverNeeded) {
                scrollToNewWhateverNeeded = false;
                scrollToNewWhatever();
            }
            if (stageIdToScrollTo) {
                $('#main_content').imagesLoaded(function () {
                    if ($('#stage' + stageIdToScrollTo).length) {
                        var _stageIdToScrollTo = stageIdToScrollTo;
                        stageIdToScrollTo = false;
                        $('body, html').animate(
                            {scrollTop: $('#stage' + _stageIdToScrollTo).offset().top - 52}, 80,
                            function () {
                                $('#stage' + _stageIdToScrollTo + ' .portlet.light.stage-custom-portlet').addClass('highlightStage');
                                $('#stage' + _stageIdToScrollTo + ' .commentWrap').addClass('highlightComment');
                                $('.highlightStage').animate({
                                    backgroundColor: "white"
                                }, 4000, function () {
                                    $('.highlightStage').removeClass('highlightStage')
                                });
                                $('.highlightComment').animate({
                                    backgroundColor: "#F9F9F9"
                                }, 4000, function () {
                                    $('.highlightComment').removeClass('highlightComment')
                                });
//                                $('#stage' + _stageIdToScrollTo + ' .portlet.light.stage-custom-portlet').addClass('newStage');
//                                animateNewStages();
                            }
                        );
                    }
                });
            }
            $('body').removeClass('hideNewStage');
            //exitSelectionMode();
            // Show selection buttons
            if ($('#stages').length) {
                $('#selectionModeTrigger').show();
                $('.startSelection').fadeIn();
                //$('#stages').focus();
            } else {
                $('#selectionModeTrigger').hide();
                if (document.location.hash != '#flow')
                    $('.startSelection').fadeOut();
            }
            // Show + patient button
            if ($('#cabusersFilterWrap ').length) { // Patients' list
                $('.addPatientBottomLeftButton').fadeIn();
            } else {
                $('.addPatientBottomLeftButton').fadeOut().hide();
            }
            // Handle schedule block in menu bottom
            if (hash == 'schedule' || hash == 'schedule/assistants' || hash == 'schedule/administrators') {
                $('#menuBottomBlock').show();
                $(' .page-content').addClass('page-content-wrapper-no-right-padding');
            } else {
                $('#menuBottomBlock').hide();
                $('.page-content-wrapper-no-right-padding').removeClass('page-content-wrapper-no-right-padding');
            }

            initTooltips();
            selectCurrentClinic(data.currentClinicId);
        }
    })

    Layout.setSidebarMenuActiveLink('match');
    //$('#imageZoom').modal('hide');
    if ($('.modal.in:not(#messageModal, #shareModal, #messageModalPayment, #messageModalBillingNotice, #messageModalWelcomeNotice)').length) {
        $('.modal.in').modal('hide');
    }
    if (typeof (calendar) != 'undefined' && typeof (calendar.hideContextMenu) != 'undefined') {
        calendar.hideContextMenu(true);
    }
}

function initTooltips() {
    if (!isMobileDevice)
        $('.tooltipster').not('.tooltipstered').tooltipster({theme: 'tooltipster-shadow'});
    $('.tooltipsterClick').not('.tooltipstered').tooltipster({
        theme: 'tooltipster-shadow',
        trigger: 'click',
        contentAsHTML: true,
        functionInit: function (instance, helper) {
            var content = instance.content();
            var maxWidth = $(window).width();
            var newContent = '<div style="max-width: ' + maxWidth + 'px; white-space: normal;">' + content.html() + '</div>';
            instance.content(newContent);
        }
    });
}

function showAjaxData(data, scrollToTopAfterDataLoad) {

    $patientHeaderFixed = false;
    if (typeof (data.page404) != 'undefined') {
        data.title = page404.title;
        data.smallTitle = page404.smallTitle;
        data.breadCrumbs = page404.breadCrumbs;
        data.html = $('#page404Content').html();
        data.customWrappers = true;
    }

    if (typeof (data.title) != 'undefined') {
        document.title = (newNotificationsCount ? '(' + newNotificationsCount + ') ' : '') + data.title;
    } else {
        document.title = '';
    }
    /*if (isMobileDevice) {
        var headerTitle = typeof(data.headerTitle) != 'undefined' ? data.headerTitle : data.title;
        $('#headerTitle').html(headerTitle);
        if (document.location.hash == '#patients') {
            $('#headerTitle').hide();
            $('#headerSearch').show();
        } else {
            $('#headerTitle').show();
            $('#headerSearch').hide();
        }
    }*/

    var html = data.html;
    if (typeof (data.customWrappers) == 'undefined')
        data.html = '<div class="col-md-12">' + data.html + '</div>';
    $('#main_content').html(html);

    $('body').removeClass('page-portlet-fullscreen');
    Metronic.initComponents();
    if (document.selection) {
        document.selection.empty();
    } else if (window.getSelection) {
        window.getSelection().removeAllRanges();
    }
    if (scrollToTopAfterDataLoad) {
        if (!(typeof (data.skipScroll2Top) != 'undefined' && data.skipScroll2Top === 1)) {
            window.scrollTo(0, 0);
        }
        //Metronic.scrollTo();
    }
    handleSelectionButtons(false);

    if (document.location.hash != '#patients')
        $('#patientsFilter_').val('');
    //$('#patientsFilter_').focus();
    //setTimeout(function() { console.log($(':focus'), 'foc2') }, 1000);
    if (typeof (handlePlanButtons) != 'undefined')
        handlePlanButtons();

    // Close floatingViewer everywhere but in plans
    if ($('#floatingViewer').is(':visible')) {
        if (!location.hash.match(/#plans\//)) {
            $('#floatingViewer').hide();
            $('#floatingViewerContents').html('');
        }
    }
}

$(document).ready(function () {
    $('#closeZoomImage').trigger('click');
    $(document).keydown(function (e) {
        if (e.keyCode == 27) { // Escape
            //closeTopPopup();
            //hideLoadingBlock();
            $('#exifModal').modal('hide');
            $('.portlet-fullscreen').removeClass('portlet-fullscreen');
            $('body').removeClass('page-portlet-fullscreen');
            //$('#header_inbox_bar').removeClass('open');
            closeNotificationsPopup();
            //hideImageUploader();
            //closeMapPointSelect();
        }
    });

    // Refresh in case hash was the same (communication error or simple refresh)
    $('body').on('click', "a[href^='#']", function (event) {
        //console.log(event, 'Button clicked');
        //console.log("caller is " + arguments.callee.caller.toString());
        if (typeof (event.isTrigger) == 'undefined' && location.hash == $(this).attr('href'))
            locationHashChanged();
    });

    locationHashChanged();

    $(window).on('resize', function (e) {
        if (e.target == this) { // UI fix
            Layout.handleGoTop();
            setSearchWidth();
            setNavbarToWidth();
        }
    });
    setSearchWidth();
    onResize();

    $(".page-sidebar").fadeTo('slow', 1, function () {
    });
    $(".page-header-inner .search-form").fadeTo('slow', 1, function () {
    });
    $("#menu-left-bottom").fadeTo('slow', 1, function () {
    });
});

function setSearchWidth() {
    var windowWidth = $(window).width();
    if (windowWidth > 500) { // todo
        var width = $(window).width() - $('.page-header-inner .search-form').offset().left - $('.top-menu').width() - $('.menu-toggler.responsive-toggler').width() - 40;
        if (width > 620)
            width = 620;
        //$('.menu-toggler.responsive-toggler').width()
        if (width < 110) // Iphone 5 fix
            width += 30;
        $('.page-header-inner .search-form').css('width', width);
    } else {
        $('.page-header-inner .search-form').hide();
    }
}

function onResize() {
    setNotificationsArrow();
}

var TT = function (text) {
    if (typeof T[text] === 'undefined') {
        return text;
    }
    return T[text]
};

function messageBoard(text, type) {
    text = TT(text);
    clearTimeout(timeout);
    hideLoadingBlock();
    if (type === undefined) type = 'success';
    if (type == 'success') {
    } else if (type == 'warning') {
        // $('#errorMessage').html('<pre>' + text + '</pre>');
        $('#errorMessage').html(text);
        $('#errorMessageModal').modal('show');
    } else if (type == 'message') {
        $('#errorMessage').html(text);
        $('#errorMessageModal').modal('show');
    }
    photoEditingIsGoingOn = false;
}

/**
 * @param text
 * @param isFail
 * @param duration
 */
function flashMessage(text, isFail, duration) {
    isFail = !!isFail;
    if (typeof text === 'object' && text.message) {
        isFail = !text.success;
        text = text.message;
    }
    if (typeof text === 'object' && text.error) {
        isFail = true;
        text = text.error;
    }
    text = TT(text);
    $.notify({
        message: text
    }, {
        // settings
        type: isFail ? 'danger' : 'success',
        z_index: 9997,
        allow_dismiss: true,
        placement: {
            from: "bottom",
            align: "right"
        },
        offset: {
            y: 20,
            x: 20
        },
        delay: duration || 10000,
        timer: 1000,
        animate: {
            enter: "animated fadeInRight",
            exit: "animated fadeOutRight"
        }
    });
}

// Dialog
function confirmDialog(options) {

    if (typeof (options.action) != 'undefined') {
        var yesButtonText = typeof (options.buttonText) != 'undefined' && options.buttonText.length ? options.buttonText : 'Ok';
        $('#confirmModal button#yesConfirmModalButton').show().html(yesButtonText).unbind().click(function (event) {
            options.action();
        });
    } else {
        $('#confirmModal button#yesConfirmModalButton').hide();
    }

    var cancelButtonText = typeof (options.cancelButtonText) != 'undefined' && options.cancelButtonText.length ? options.cancelButtonText : T['Cancel'];
    $('#confirmModal button#cancelConfirmModalButton').html(cancelButtonText);

    if (typeof (options.cancelAction) != 'undefined') {
        $('#confirmModal button#cancelConfirmModalButton').show().unbind().click(function (event) {
            options.cancelAction();
        });
    } else {
        $('#confirmModal button#cancelConfirmModalButton').show().unbind();
    }

    // Yes button color
    if (typeof (options.buttonColor) == 'undefined') {
        var colorClass = 'blue';
    } else {
        var colorClass = 'btn-danger';
    }
    $('#confirmModal button#yesConfirmModalButton').removeClass('blue').removeClass('btn-danger').addClass(colorClass);


    var text = typeof (options.text) != 'undefined' && options.text.length ? options.text : T['Confirmation'];
    $('#confirmModal #confirmModalBody').html(text);

    $('#confirmModal').modal('show');
    var windowWidth = 350;
    if (typeof (options.width) != 'undefined') {
        windowWidth = options.width;
    }
    $('#confirmModal').css('width', windowWidth + 'px');
    $('#confirmModal button#yesConfirmModalButton').focus();//.attr("tabindex", 1001);
}


// Service functions


function htmlspecialchars(string, quote_style, charset, double_encode) {
    var optTemp = 0,
        i = 0,
        noquotes = false;
    if (typeof quote_style === 'undefined' || quote_style === null) {
        quote_style = 2;
    }
    string = string.toString();
    if (double_encode !== false) { // Put this first to avoid double-encoding
        string = string.replace(/&/g, '&amp;');
    }
    string = string.replace(/</g, '&lt;').replace(/>/g, '&gt;');

    var OPTS = {
        'ENT_NOQUOTES': 0,
        'ENT_HTML_QUOTE_SINGLE': 1,
        'ENT_HTML_QUOTE_DOUBLE': 2,
        'ENT_COMPAT': 2,
        'ENT_QUOTES': 3,
        'ENT_IGNORE': 4
    };
    if (quote_style === 0) {
        noquotes = true;
    }
    if (typeof quote_style !== 'number') { // Allow for a single string or an array of string flags
        quote_style = [].concat(quote_style);
        for (i = 0; i < quote_style.length; i++) {
            // Resolve string input to bitwise e.g. 'ENT_IGNORE' becomes 4
            if (OPTS[quote_style[i]] === 0) {
                noquotes = true;
            } else if (OPTS[quote_style[i]]) {
                optTemp = optTemp | OPTS[quote_style[i]];
            }
        }
        quote_style = optTemp;
    }
    if (quote_style & OPTS.ENT_HTML_QUOTE_SINGLE) {
        string = string.replace(/'/g, '&#039;');
    }
    if (!noquotes) {
        string = string.replace(/"/g, '&quot;');
    }

    return string;
}


function closeMobileMenuIfOpened() {
    if ($('.page-sidebar.navbar-collapse').attr('aria-expanded') == 'true')
        $('.menu-toggler.responsive-toggler').trigger('click');
}

$(document).ready(function () {
    $(window).scroll(function () {
        closeMobileMenuIfOpened();
    });

    isMobileDevice = (/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(navigator.userAgent.toLowerCase()));
    if (isMobileDevice)
        $('body').addClass('mobileDevice');
    Metronic.init();
    Layout.init();
    Demo.init();

    if (isMobileDevice) {
        // IOS Touch bug fix
        zoomBgTimeout = false;
        $('#zoom_container')
            .smoothZoom('destroy')
            .smoothZoom({
                width: '100%',
                height: '100%',
                responsive: true,
                zoom_MAX: 200,
                background_COLOR: 'black',
                border_SIZE: 0,
                zoom_BUTTONS_SHOW: false,
                pan_BUTTONS_SHOW: false,
                //zoom_OUT_TO_FIT: true,
                image_url: '/c/theme2/admin/layout/img/logo.png',
                animation_SPEED_ZOOM: 10,
                animation_SMOOTHNESS: 10
            });

        $('#zoomButtons').hide();
        $('#closeZoomImage').hide();
    }

    $('body').on('click', 'a', function (event) {
        var href = $(this).attr('href');
        if (unsavedChanges && typeof (href) != 'undefined' && href.length && href.indexOf('javascript') === -1) {
            if ($(this).closest('.dontTriggerUnsavedChangesDialog').length)
                return;
            event.preventDefault();
            //confirmDialog({cancelButtonText: 'Ok', text: '     '});
            confirmDialog({
                buttonText: T['Leave'],
                text: T['There\'re unsaved changes. Leave page?'],
                buttonColor: 'white',
                cancelButtonText: T['Stay on page'],
                action: function () {
                    unsavedChanges = false;
                    changeLocationHash(href);
                }
            });
        }
    });

    var _userAgent = navigator.userAgent || navigator.vendor || window.opera;
    iosDevice = /iPad|iPhone|iPod/.test(_userAgent) && !window.MSStream;

    //websocketConnect(currentCabinetUserId);

    if (adBlockIsPresent) {
    }
});


function changeLocationHash(hash) {
    if (hash == document.location.hash)
        locationHashChanged();
    else document.location.hash = hash;
}


function deleteAction(url, ids) {
    ajax({
        url: '/cabinet/' + url,
        data: {'ids': ids},
        success: function (data) {
            if (data.redirectHash !== undefined) {
                if (location.hash == '#' + data.redirectHash)
                    locationHashChanged();
                else location.hash = data.redirectHash;
            } else {
                locationHashChanged();
            }
            if (url == 'schedule-shifts/delete-schedule-shifts')
                sendScheduleUpdateMessage(data.websocketUpdateData);
        }
    });
}


(function (window, $) {
    window.tracking = {
        startStop: function (clinicMemberId, comment) {
            ajax({
                url: '/cabinet/tracker/start-stop',
                data: {clinicMemberId: clinicMemberId, comment: comment, stopConfirmed: (typeof comment === 'undefined' ? 0 : 1)},
                success: function (response) {
                    if (response.html) {
                        $('#trackerStopModal').html(response.html).modal('show');
                        return;
                    }
                    tracking.updateButton(response && response.message === 'started')
                }
            })
        },
        updateButton: function (isRunning) {
            var $el = $('#startStopTracking');
            if (isRunning) {
                $el.addClass('active');
                $el.find('.fa').addClass('fa-stop');
            } else {
                $el.removeClass('active');
                $el.find('.fa').removeClass('fa-stop');
            }
        },
    };
})(window, jQuery)

$('body').on('click', '.tableDeleteButton', function (event) {
    var url = $(this).attr('data-url');
    var itemId = $(this).attr('data-itemId');

    var text = T['Delete'] + '?';
    if (url == 'patients-payments/delete-payments')
        text = T['Delete payment?'];
    if (url == 'invoices/delete-invoices')
        text = T['Delete invoice?'];
    if (url == 'invoices/delete-invoices/standard')
        text = T['Delete standard invoice?'];
    if (url == 'schedule-shifts/delete-schedule-shifts')
        text = T['Delete shift?'];
    if (url == 'salary/delete-salaries')
        text = T['Delete salary?'];
    if (url == 'plans/delete-plan-items')
        text = T['Delete manipulation?'];
    if (url == 'schedule-visits/delete-visits')
        text = T['Delete visit?'];
    if (url == 'reminders/delete-reminders')
        text = T['Delete reminder?'];
    confirmDialog({
        buttonText: T['Delete'],
        buttonColor: 'red',
        text: text,
        action: function () {
            deleteAction(url, itemId);
        }
    });
});

(function ($, currentClinicMemberId) {
    $.getScriptCached = function (url, callback) {
        return $.ajax({
            url: url,
            dataType: "script",
            cache: true
        })
            .done(callback)
    }
    $('#startStopTracking').click(function (e) {
        e.stopPropagation();
        window.tracking.startStop(currentClinicMemberId);
    })
})(jQuery, currentClinicMemberId)

/**
 *
 * @returns number
 * @param i
 */
window.getFloatFromStr = function (i) {
    if (typeof i === 'number') {
        i = i.toString()
    }
    var j = parseFloat(i.replace(/ /g, ''));
    if (isNaN(j)) {
        return 0.0
    }
    return j;
};
/**
 *
 * @param price
 * @returns {string}
 */
window.getFormattedFloat = function (price) {
    if (isNaN(price)) {
        return '';
    }
    if (price === Infinity) {
        return '';
    }
    return number_format(price, 2, '.', ' ').replace(/,/g, ' ');
}

function number_format(number, decimals, dec_point, thousands_sep) {
    number = (number + '').replace(/[^0-9+\-Ee.]/g, '');
    var n = !isFinite(+number) ? 0 : +number,
        prec = !isFinite(+decimals) ? 0 : Math.abs(decimals),
        sep = (typeof thousands_sep === 'undefined') ? ',' : thousands_sep,
        dec = (typeof dec_point === 'undefined') ? '.' : dec_point,
        s = '',
        toFixedFix = function (n, prec) {
            var k = Math.pow(10, prec);
            return '' + (Math.round(n * k) / k)
                .toFixed(prec);
        };
    // Fix for IE parseFloat(0.55).toFixed(0) = 0;
    s = (prec ? toFixedFix(n, prec) : '' + Math.round(n))
        .split('.');
    if (s[0].length > 3) {
        s[0] = s[0].replace(/\B(?=(?:\d{3})+(?!\d))/g, sep);
    }
    if ((s[1] || '')
        .length < prec) {
        s[1] = s[1] || '';
        s[1] += new Array(prec - s[1].length + 1)
            .join('0');
    }
    return s.join(dec);
}


window.numberFormat = {
    digitGroupSeparator: ' ',
    decimalCharacterAlternative: ',',
    decimalCharacter: '.',
    watchExternalChanges: true,
    //onInvalidPaste: 'truncate',
    //currencySymbol: '',
    //currencySymbolPlacement: AutoNumeric.options.currencySymbolPlacement.suffix,
    //negativePositiveSignPlacement: AutoNumeric.options.negativePositiveSignPlacement.prefix,
}
;
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,b,c){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var f=a[e];if(b.call(c,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){a=["object"==typeof globalThis&&globalThis,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,a];for(var b=0;b<a.length;++b){var c=a[b];if(c&&c.Math==Math)return c}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6","es3");
function renderErrors(a,b){b=$(b);var c=[];if(0===b.length)console.warn("Couldn't find form");else{for(var d in a){if(!a.hasOwnProperty(d))return;var e=b.find('[name="'+d+'"]'),f=e.parent();0===e.length?(c.push(a[d].join(";")),console.warn("renderErrors: Couldn't find input for "+d),console.warn("renderErrors: "+a[d].join(";"))):"hidden"===e.attr("type")?console.warn("renderErrors: Error in hidden field: "+a[d].join(";")):0===f.length?console.warn("renderErrors: Couldn't find container for "+d):(0<
c.length&&b.prepend('<div data-error-message class="alert alert-warning" style="position: static" role="alert"><ul><li>'+c.join("</li><li>")+"</li></ul></div>"),f.addClass("has-error"),f.append("<div data-error-message class='help-block small col-md-12 text-right'>"+a[d].join("<br/>")+"</div>"),e.on("focus change",function(){$(this).siblings("[data-error-message]").remove();$(this).closest(".form-group").removeClass("has-error")}))}b.submit(function(){hideErrors($(this))})}}
function hideErrors(a){a=$(a);0===a.length?console.warn("Couldn't find form"):(a.find("[data-error-message]").remove(),a.find(".form-group").removeClass("has-error"))};
;
$(document).ready(function(){var c,d,e,f=!1;$("body").on("click",".inviteNewUser",function(b){c=accessType;d=patientId;e=stageId;ajax({url:"/cabinet/invite/html",data:{accessType:c,stageId:e,patientId:d},success:function(a){"undefined"!=typeof a.status&&"success"==a.status&&($("#inviteModal .modal-body").html(a.inviteHtml),$("#inviteModal").modal("show"),a=$("#accessUserSearch").val(),-1==a.indexOf("@")&&(a=""),$("#inviteEmail").val(a).focus())}})});$("body").on("click","#sendInviteButton",function(b){f||
(f=!0,b=$("#inviteEmail").val(),ajax({url:"/cabinet/invite/invite",data:{accessType:c,stageId:e,patientId:d,email:b},success:function(a){"undefined"!=typeof a.status&&"success"==a.status&&($("#inviteEmail").val(""),$("#inviteModal").modal("hide"),getUsersWithAccessListForAccessPopup(accessType,stageId,patientId));"undefined"!=typeof a.status&&"error"==a.status&&$("#inviteModal #inviteModalErrorMessage").text(a.errorMessage).show();f=!1}}))});$("body").on("keydown","#inviteEmail",function(b){13==b.keyCode&&
(focusOnEmptyStageComment=stageId,$("#sendInviteButton").trigger("click"))})});
;
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,f,d){a instanceof String&&(a=String(a));for(var h=a.length,b=0;b<h;b++){var c=a[b];if(f.call(d,c,b,a))return{i:b,v:c}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,f,d){a!=Array.prototype&&a!=Object.prototype&&(a[f]=d.value)};$jscomp.getGlobal=function(a){a=["object"==typeof globalThis&&globalThis,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,a];for(var f=0;f<a.length;++f){var d=a[f];if(d&&d.Math==Math)return d}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,f,d,h){if(f){d=$jscomp.global;a=a.split(".");for(h=0;h<a.length-1;h++){var b=a[h];b in d||(d[b]={});d=d[b]}a=a[a.length-1];h=d[a];f=f(h);f!=h&&null!=f&&$jscomp.defineProperty(d,a,{configurable:!0,writable:!0,value:f})}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,d){return $jscomp.findInternal(this,a,d).v}},"es6","es3");
!function(a,f,d,h){a(d).ready(function(){function b(a){var b={};for(a=a.match(/([^;:]+)/g)||[];a.length;)b[a.shift()]=a.shift().trim();return b}a("table").each(function(){"dnd"===a(this).data("table")&&a(this).tableDnD({onDragStyle:a(this).data("ondragstyle")&&b(a(this).data("ondragstyle"))||null,onDropStyle:a(this).data("ondropstyle")&&b(a(this).data("ondropstyle"))||null,onDragClass:a(this).data("ondragclass")===h&&"tDnD_whileDrag"||a(this).data("ondragclass"),onDrop:a(this).data("ondrop")&&new Function("table",
"row",a(this).data("ondrop")),onDragStart:a(this).data("ondragstart")&&new Function("table","row",a(this).data("ondragstart")),onDragStop:a(this).data("ondragstop")&&new Function("table","row",a(this).data("ondragstop")),scrollAmount:a(this).data("scrollamount")||5,sensitivity:a(this).data("sensitivity")||10,hierarchyLevel:a(this).data("hierarchylevel")||0,indentArtifact:a(this).data("indentartifact")||'<div class="indent">&nbsp;</div>',autoWidthAdjust:a(this).data("autowidthadjust")||!0,autoCleanRelations:a(this).data("autocleanrelations")||
!0,jsonPretifySeparator:a(this).data("jsonpretifyseparator")||"\t",serializeRegexp:a(this).data("serializeregexp")&&new RegExp(a(this).data("serializeregexp"))||/[^\-]*$/,serializeParamName:a(this).data("serializeparamname")||!1,dragHandle:a(this).data("draghandle")||null})})});jQuery.tableDnD={currentTable:null,dragObject:null,mouseOffset:null,oldX:0,oldY:0,build:function(b){this.each(function(){this.tableDnDConfig=a.extend({onDragStyle:null,onDropStyle:null,onDragClass:"tDnD_whileDrag",onDrop:null,
onDragStart:null,onDragStop:null,scrollAmount:5,sensitivity:10,hierarchyLevel:0,indentArtifact:'<div class="indent">&nbsp;</div>',autoWidthAdjust:!0,autoCleanRelations:!0,jsonPretifySeparator:"\t",serializeRegexp:/[^\-]*$/,serializeParamName:!1,dragHandle:null},b||{});a.tableDnD.makeDraggable(this);this.tableDnDConfig.hierarchyLevel&&a.tableDnD.makeIndented(this)});return this},makeIndented:function(b){var c=b.tableDnDConfig,e=b.rows,g=a(e).first().find("td:first")[0],d=0,f=0;if(a(b).hasClass("indtd"))return null;
var l=a(b).addClass("indtd").attr("style");a(b).css({whiteSpace:"nowrap"});for(var k=0;k<e.length;k++)if(f<a(e[k]).find("td:first").text().length){f=a(e[k]).find("td:first").text().length;var h=k}a(g).css({width:"auto"});for(k=0;k<c.hierarchyLevel;k++)a(e[h]).find("td:first").prepend(c.indentArtifact);g&&a(g).css({width:g.offsetWidth});l&&a(b).css(l);for(k=0;k<c.hierarchyLevel;k++)a(e[h]).find("td:first").children(":first").remove();c.hierarchyLevel&&a(e).each(function(){d=a(this).data("level")||
0;d<=c.hierarchyLevel&&a(this).data("level",d)||a(this).data("level",0);for(var b=0;b<a(this).data("level");b++)a(this).find("td:first").prepend(c.indentArtifact)});return this},makeDraggable:function(b){var c=b.tableDnDConfig;c.dragHandle&&a(c.dragHandle,b).each(function(){a(this).bind("touchstart mousedown",function(e){a.tableDnD.initialiseDrag(a(this).parents("tr")[0],b,this,e,c);return!1})})||a(b.rows).each(function(){a(this).hasClass("nodrag")?a(this).css("cursor",""):a(this).bind("touchstart mousedown",
function(e){if("TD"===e.target.tagName)return a.tableDnD.initialiseDrag(this,b,this,e,c),!1}).css("cursor","move")})},currentOrder:function(){return a.map(this.currentTable.rows,function(b){return(a(b).data("level")+b.id).replace(/\s/g,"")}).join("")},initialiseDrag:function(b,c,e,g,f){this.dragObject=b;this.currentTable=c;this.mouseOffset=this.getMouseOffset(e,g);this.originalOrder=this.currentOrder();a(d).bind("touchmove mousemove",this.mousemove).bind("touchend mouseup",this.mouseup);f.onDragStart&&
f.onDragStart(c,e)},updateTables:function(){this.each(function(){this.tableDnDConfig&&a.tableDnD.makeDraggable(this)})},mouseCoords:function(a){return a.originalEvent.changedTouches?{x:a.originalEvent.changedTouches[0].clientX,y:a.originalEvent.changedTouches[0].clientY}:a.pageX||a.pageY?{x:a.pageX,y:a.pageY}:{x:a.clientX+d.body.scrollLeft-d.body.clientLeft,y:a.clientY+d.body.scrollTop-d.body.clientTop}},getMouseOffset:function(a,c){c=c||f.event;a=this.getPosition(a);c=this.mouseCoords(c);return{x:c.x-
a.x,y:c.y-a.y}},getPosition:function(a){var b=0,e=0;0===a.offsetHeight&&(a=a.firstChild);for(;a.offsetParent;)b+=a.offsetLeft,e+=a.offsetTop,a=a.offsetParent;b+=a.offsetLeft;e+=a.offsetTop;return{x:b,y:e}},autoScroll:function(a){var b=this.currentTable.tableDnDConfig,e=f.pageYOffset,g=f.innerHeight?f.innerHeight:d.documentElement.clientHeight?d.documentElement.clientHeight:d.body.clientHeight;d.all&&("undefined"!==typeof d.compatMode&&"BackCompat"!==d.compatMode?e=d.documentElement.scrollTop:"undefined"!==
typeof d.body&&(e=d.body.scrollTop));a.y-e<b.scrollAmount&&f.scrollBy(0,-b.scrollAmount)||g-(a.y-e)<b.scrollAmount&&f.scrollBy(0,b.scrollAmount)},moveVerticle:function(a,c){0!==a.vertical&&c&&this.dragObject!==c&&this.dragObject.parentNode===c.parentNode&&(0>a.vertical&&this.dragObject.parentNode.insertBefore(this.dragObject,c.nextSibling)||0<a.vertical&&this.dragObject.parentNode.insertBefore(this.dragObject,c))},moveHorizontal:function(b,c){var e=this.currentTable.tableDnDConfig;if(!e.hierarchyLevel||
0===b.horizontal||!c||this.dragObject!==c)return null;var g=a(c).data("level");0<b.horizontal&&0<g&&a(c).find("td:first").children(":first").remove()&&a(c).data("level",--g);0>b.horizontal&&g<e.hierarchyLevel&&a(c).prev().data("level")>=g&&a(c).children(":first").prepend(e.indentArtifact)&&a(c).data("level",++g)},mousemove:function(b){var c=a(a.tableDnD.dragObject),e=a.tableDnD.currentTable.tableDnDConfig;b&&b.preventDefault();if(!a.tableDnD.dragObject)return!1;"touchmove"===b.type&&event.preventDefault();
e.onDragClass&&c.addClass(e.onDragClass)||c.css(e.onDragStyle);var g=a.tableDnD.mouseCoords(b);b=g.x-a.tableDnD.mouseOffset.x;e=g.y-a.tableDnD.mouseOffset.y;a.tableDnD.autoScroll(g);c=a.tableDnD.findDropTargetRow(c,e);b=a.tableDnD.findDragDirection(b,e);a.tableDnD.moveVerticle(b,c);a.tableDnD.moveHorizontal(b,c);return!1},findDragDirection:function(a,c){var b=this.currentTable.tableDnDConfig.sensitivity,g=this.oldX,d=this.oldY;b={horizontal:a>=g-b&&a<=g+b?0:a>g?-1:1,vertical:c>=d-b&&c<=d+b?0:c>d?
-1:1};0!==b.horizontal&&(this.oldX=a);0!==b.vertical&&(this.oldY=c);return b},findDropTargetRow:function(b,c){for(var e,d=this.currentTable.rows,f=this.currentTable.tableDnDConfig,m,l,k=0;k<d.length;k++)if(l=d[k],m=this.getPosition(l).y,e=parseInt(l.offsetHeight)/2,0===l.offsetHeight&&(m=this.getPosition(l.firstChild).y,e=parseInt(l.firstChild.offsetHeight)/2),c>m-e&&c<m+e)if(b.is(l)||f.onAllowDrop&&!f.onAllowDrop(b,l)||a(l).hasClass("nodrop"))break;else return l;return null},processMouseup:function(){if(!this.currentTable||
!this.dragObject)return null;var b=this.currentTable.tableDnDConfig,c=this.dragObject,e=0,g=0;a(d).unbind("touchmove mousemove",this.mousemove).unbind("touchend mouseup",this.mouseup);b.hierarchyLevel&&b.autoCleanRelations&&a(this.currentTable.rows).first().find("td:first").children().each(function(){(g=a(this).parents("tr:first").data("level"))&&a(this).parents("tr:first").data("level",--g)&&a(this).remove()})&&1<b.hierarchyLevel&&a(this.currentTable.rows).each(function(){g=a(this).data("level");
if(1<g)for(e=a(this).prev().data("level");g>e+1;)a(this).find("td:first").children(":first").remove(),a(this).data("level",--g)});b.onDragClass&&a(c).removeClass(b.onDragClass)||a(c).css(b.onDropStyle);this.dragObject=null;b.onDrop&&this.originalOrder!==this.currentOrder()&&a(c).hide().fadeIn("fast")&&b.onDrop(this.currentTable,c);b.onDragStop&&b.onDragStop(this.currentTable,c);this.currentTable=null},mouseup:function(b){b&&b.preventDefault();a.tableDnD.processMouseup();return!1},jsonize:function(a){var b=
this.currentTable;return a?JSON.stringify(this.tableData(b),null,b.tableDnDConfig.jsonPretifySeparator):JSON.stringify(this.tableData(b))},serialize:function(){return a.param(this.tableData(this.currentTable))},serializeTable:function(a){for(var b="",e=a.tableDnDConfig.serializeParamName||a.id,d=a.rows,f=0;f<d.length;f++){0<b.length&&(b+="&");var m=d[f].id;m&&a.tableDnDConfig&&a.tableDnDConfig.serializeRegexp&&(m=m.match(a.tableDnDConfig.serializeRegexp)[0],b+=e+"[]="+m)}return b},serializeTables:function(){var b=
[];a("table").each(function(){this.id&&b.push(a.param(a.tableDnD.tableData(this)))});return b.join("&")},tableData:function(b){var c=b.tableDnDConfig,e=[],d=0,f=0;f=null;var m={},l;b||(b=this.currentTable);if(!b||!b.rows||!b.rows.length)return{error:{code:500,message:"Not a valid table."}};if(!b.id&&!c.serializeParamName)return{error:{code:500,message:"No serializable unique id provided."}};var k=c.autoCleanRelations&&b.rows||a.makeArray(b.rows);var h=l=c.serializeParamName||b.id;b=function(a){return a&&
c&&c.serializeRegexp?a.match(c.serializeRegexp)[0]:a};m[h]=[];!c.autoCleanRelations&&a(k[0]).data("level")&&k.unshift({id:"undefined"});for(var p=0;p<k.length;p++){if(c.hierarchyLevel){f=a(k[p]).data("level")||0;if(0===f)h=l,e=[];else if(f>d)e.push([h,d]),h=b(k[p-1].id);else if(f<d)for(var n=0;n<e.length;n++)e[n][1]===f&&(h=e[n][0]),e[n][1]>=d&&(e[n][1]=0);d=f;a.isArray(m[h])||(m[h]=[])}(f=b(k[p].id))&&m[h].push(f)}return m}};jQuery.fn.extend({tableDnD:a.tableDnD.build,tableDnDUpdate:a.tableDnD.updateTables,
tableDnDSerialize:a.proxy(a.tableDnD.serialize,a.tableDnD),tableDnDSerializeAll:a.tableDnD.serializeTables,tableDnDData:a.proxy(a.tableDnD.tableData,a.tableDnD)})}(jQuery,window,window.document);
;
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(c,a,b){c instanceof String&&(c=String(c));for(var d=c.length,e=0;e<d;e++){var f=c[e];if(a.call(b,f,e,c))return{i:e,v:f}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(c,a,b){c!=Array.prototype&&c!=Object.prototype&&(c[a]=b.value)};$jscomp.getGlobal=function(c){c=["object"==typeof globalThis&&globalThis,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,c];for(var a=0;a<c.length;++a){var b=c[a];if(b&&b.Math==Math)return b}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(c,a,b,d){if(a){b=$jscomp.global;c=c.split(".");for(d=0;d<c.length-1;d++){var e=c[d];e in b||(b[e]={});b=b[e]}c=c[c.length-1];d=b[c];a=a(d);a!=d&&null!=a&&$jscomp.defineProperty(b,c,{configurable:!0,writable:!0,value:a})}};$jscomp.polyfill("Array.prototype.find",function(c){return c?c:function(a,b){return $jscomp.findInternal(this,a,b).v}},"es6","es3");
(function(c){c.extend(c.fn,{validate:function(a){if(this.length){var b=c.data(this[0],"validator");if(b)return b;this.attr("novalidate","novalidate");b=new c.validator(a,this[0]);c.data(this[0],"validator",b);b.settings.onsubmit&&(a=this.find("input, button"),a.filter(".cancel").click(function(){b.cancelSubmit=!0}),b.settings.submitHandler&&a.filter(":submit").click(function(){b.submitButton=this}),this.submit(function(a){function d(){if(b.settings.submitHandler){if(b.submitButton)var a=c("<input type='hidden'/>").attr("name",
b.submitButton.name).val(b.submitButton.value).appendTo(b.currentForm);b.settings.submitHandler.call(b,b.currentForm);b.submitButton&&a.remove();return!1}return!0}b.settings.debug&&a.preventDefault();if(b.cancelSubmit)return b.cancelSubmit=!1,d();if(b.form())return b.pendingRequest?(b.formSubmitted=!0,!1):d();b.focusInvalid();return!1}));return b}a&&a.debug&&window.console&&console.warn("nothing selected, can't validate, returning nothing")},valid:function(){if(c(this[0]).is("form"))return this.validate().form();
var a=!0,b=c(this[0].form).validate();this.each(function(){a&=b.element(this)});return a},removeAttrs:function(a){var b={},d=this;c.each(a.split(/\s/),function(a,c){b[c]=d.attr(c);d.removeAttr(c)});return b},rules:function(a,b){var d=this[0];if(a){var e=c.data(d.form,"validator").settings,f=e.rules,g=c.validator.staticRules(d);switch(a){case "add":c.extend(g,c.validator.normalizeRule(b));f[d.name]=g;b.messages&&(e.messages[d.name]=c.extend(e.messages[d.name],b.messages));break;case "remove":if(!b)return delete f[d.name],
g;var h={};c.each(b.split(/\s/),function(a,b){h[b]=g[b];delete g[b]});return h}}a=c.validator.normalizeRules(c.extend({},c.validator.metadataRules(d),c.validator.classRules(d),c.validator.attributeRules(d),c.validator.staticRules(d)),d);a.required&&(b=a.required,delete a.required,a=c.extend({required:b},a));return a}});c.extend(c.expr[":"],{blank:function(a){return!c.trim(""+a.value)},filled:function(a){return!!c.trim(""+a.value)},unchecked:function(a){return!a.checked}});c.validator=function(a,b){this.settings=
c.extend(!0,{},c.validator.defaults,a);this.currentForm=b;this.init()};c.validator.format=function(a,b){if(1==arguments.length)return function(){var b=c.makeArray(arguments);b.unshift(a);return c.validator.format.apply(this,b)};2<arguments.length&&b.constructor!=Array&&(b=c.makeArray(arguments).slice(1));b.constructor!=Array&&(b=[b]);c.each(b,function(b,c){a=a.replace(new RegExp("\\{"+b+"\\}","g"),c)});return a};c.extend(c.validator,{defaults:{messages:{},groups:{},rules:{},errorClass:"error",validClass:"valid",
errorElement:"label",focusInvalid:!0,errorContainer:c([]),errorLabelContainer:c([]),onsubmit:!0,ignore:":hidden",ignoreTitle:!1,onfocusin:function(a,b){this.lastActive=a;this.settings.focusCleanup&&!this.blockFocusCleanup&&(this.settings.unhighlight&&this.settings.unhighlight.call(this,a,this.settings.errorClass,this.settings.validClass),this.addWrapper(this.errorsFor(a)).hide())},onfocusout:function(a,b){this.checkable(a)||!(a.name in this.submitted)&&this.optional(a)||this.element(a)},onkeyup:function(a,
b){(a.name in this.submitted||a==this.lastElement)&&this.element(a)},onclick:function(a,b){a.name in this.submitted?this.element(a):a.parentNode.name in this.submitted&&this.element(a.parentNode)},highlight:function(a,b,d){"radio"===a.type?this.findByName(a.name).addClass(b).removeClass(d):c(a).addClass(b).removeClass(d)},unhighlight:function(a,b,d){"radio"===a.type?this.findByName(a.name).removeClass(b).addClass(d):c(a).removeClass(b).addClass(d)}},setDefaults:function(a){c.extend(c.validator.defaults,
a)},messages:{required:"This field is required.",remote:"Please fix this field.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",date:"Please enter a valid date.",dateISO:"Please enter a valid date (ISO).",number:"Please enter a valid number.",digits:"Please enter only digits.",creditcard:"Please enter a valid credit card number.",equalTo:"Please enter the same value again.",accept:"Please enter a value with a valid extension.",maxlength:c.validator.format("Please enter no more than {0} characters."),
minlength:c.validator.format("Please enter at least {0} characters."),rangelength:c.validator.format("Please enter a value between {0} and {1} characters long."),range:c.validator.format("Please enter a value between {0} and {1}."),max:c.validator.format("Please enter a value less than or equal to {0}."),min:c.validator.format("Please enter a value greater than or equal to {0}.")},autoCreateRanges:!1,prototype:{init:function(){function a(a){var b=c.data(this[0].form,"validator"),d="on"+a.type.replace(/^validate/,
"");b.settings[d]&&b.settings[d].call(b,this[0],a)}this.labelContainer=c(this.settings.errorLabelContainer);this.errorContext=this.labelContainer.length&&this.labelContainer||c(this.currentForm);this.containers=c(this.settings.errorContainer).add(this.settings.errorLabelContainer);this.submitted={};this.valueCache={};this.pendingRequest=0;this.pending={};this.invalid={};this.reset();var b=this.groups={};c.each(this.settings.groups,function(a,d){c.each(d.split(/\s/),function(c,d){b[d]=a})});var d=
this.settings.rules;c.each(d,function(a,b){d[a]=c.validator.normalizeRule(b)});c(this.currentForm).validateDelegate("[type='text'], [type='password'], [type='file'], select, textarea, [type='number'], [type='search'] ,[type='tel'], [type='url'], [type='email'], [type='datetime'], [type='date'], [type='month'], [type='week'], [type='time'], [type='datetime-local'], [type='range'], [type='color'] ","focusin focusout keyup",a).validateDelegate("[type='radio'], [type='checkbox'], select, option","click",
a);this.settings.invalidHandler&&c(this.currentForm).bind("invalid-form.validate",this.settings.invalidHandler)},form:function(){this.checkForm();c.extend(this.submitted,this.errorMap);this.invalid=c.extend({},this.errorMap);this.valid()||c(this.currentForm).triggerHandler("invalid-form",[this]);this.showErrors();return this.valid()},checkForm:function(){this.prepareForm();for(var a=0,b=this.currentElements=this.elements();b[a];a++)this.check(b[a]);return this.valid()},element:function(a){this.lastElement=
a=this.validationTargetFor(this.clean(a));this.prepareElement(a);this.currentElements=c(a);var b=this.check(a);b?delete this.invalid[a.name]:this.invalid[a.name]=!0;this.numberOfInvalids()||(this.toHide=this.toHide.add(this.containers));this.showErrors();return b},showErrors:function(a){if(a){c.extend(this.errorMap,a);this.errorList=[];for(var b in a)this.errorList.push({message:a[b],element:this.findByName(b)[0]});this.successList=c.grep(this.successList,function(b){return!(b.name in a)})}this.settings.showErrors?
this.settings.showErrors.call(this,this.errorMap,this.errorList):this.defaultShowErrors()},resetForm:function(){c.fn.resetForm&&c(this.currentForm).resetForm();this.submitted={};this.lastElement=null;this.prepareForm();this.hideErrors();this.elements().removeClass(this.settings.errorClass)},numberOfInvalids:function(){return this.objectLength(this.invalid)},objectLength:function(a){var b=0,c;for(c in a)b++;return b},hideErrors:function(){this.addWrapper(this.toHide).hide()},valid:function(){return 0==
this.size()},size:function(){return this.errorList.length},focusInvalid:function(){if(this.settings.focusInvalid)try{c(this.findLastActive()||this.errorList.length&&this.errorList[0].element||[]).filter(":visible").focus().trigger("focusin")}catch(a){}},findLastActive:function(){var a=this.lastActive;return a&&1==c.grep(this.errorList,function(b){return b.element.name==a.name}).length&&a},elements:function(){var a=this,b={};return c(this.currentForm).find("input, select, textarea").not(":submit, :reset, :image, [disabled]").not(this.settings.ignore).filter(function(){!this.name&&
a.settings.debug&&window.console&&console.error("%o has no name assigned",this);return this.name in b||!a.objectLength(c(this).rules())?!1:b[this.name]=!0})},clean:function(a){return c(a)[0]},errors:function(){return c(this.settings.errorElement+"."+this.settings.errorClass,this.errorContext)},reset:function(){this.successList=[];this.errorList=[];this.errorMap={};this.toShow=c([]);this.toHide=c([]);this.currentElements=c([])},prepareForm:function(){this.reset();this.toHide=this.errors().add(this.containers)},
prepareElement:function(a){this.reset();this.toHide=this.errorsFor(a)},check:function(a){a=this.validationTargetFor(this.clean(a));var b=c(a).rules(),d=!1,e;for(e in b){var f={method:e,parameters:b[e]};try{var g=c.validator.methods[e].call(this,(null==a.value?"":a.value).replace(/\r/g,""),a,f.parameters);if("dependency-mismatch"==g)d=!0;else{d=!1;if("pending"==g){this.toHide=this.toHide.not(this.errorsFor(a));return}if(!g)return this.formatAndAdd(a,f),!1}}catch(h){throw this.settings.debug&&window.console&&
console.log("exception occured when checking element "+a.id+", check the '"+f.method+"' method",h),h;}}if(!d)return this.objectLength(b)&&this.successList.push(a),!0},customMetaMessage:function(a,b){if(c.metadata)return(a=this.settings.meta?c(a).metadata()[this.settings.meta]:c(a).metadata())&&a.messages&&a.messages[b]},customMessage:function(a,b){return(a=this.settings.messages[a])&&(a.constructor==String?a:a[b])},findDefined:function(){for(var a=0;a<arguments.length;a++)if(void 0!==arguments[a])return arguments[a]},
defaultMessage:function(a,b){return this.findDefined(this.customMessage(a.name,b),this.customMetaMessage(a,b),!this.settings.ignoreTitle&&a.title||void 0,c.validator.messages[b],"<strong>Warning: No message defined for "+a.name+"</strong>")},formatAndAdd:function(a,b){var c=this.defaultMessage(a,b.method),e=/\$?\{(\d+)\}/g;"function"==typeof c?c=c.call(this,b.parameters,a):e.test(c)&&(c=jQuery.format(c.replace(e,"{$1}"),b.parameters));this.errorList.push({message:c,element:a});this.errorMap[a.name]=
c;this.submitted[a.name]=c},addWrapper:function(a){this.settings.wrapper&&(a=a.add(a.parent(this.settings.wrapper)));return a},defaultShowErrors:function(){for(var a=0;this.errorList[a];a++){var b=this.errorList[a];this.settings.highlight&&this.settings.highlight.call(this,b.element,this.settings.errorClass,this.settings.validClass);this.showLabel(b.element,b.message)}this.errorList.length&&(this.toShow=this.toShow.add(this.containers));if(this.settings.success)for(a=0;this.successList[a];a++)this.showLabel(this.successList[a]);
if(this.settings.unhighlight)for(a=0,b=this.validElements();b[a];a++)this.settings.unhighlight.call(this,b[a],this.settings.errorClass,this.settings.validClass);this.toHide=this.toHide.not(this.toShow);this.hideErrors();this.addWrapper(this.toShow).show()},validElements:function(){return this.currentElements.not(this.invalidElements())},invalidElements:function(){return c(this.errorList).map(function(){return this.element})},showLabel:function(a,b){var d=this.errorsFor(a);d.length?(d.removeClass(this.settings.validClass).addClass(this.settings.errorClass),
d.attr("generated")&&d.html(b)):(d=c("<"+this.settings.errorElement+"/>").attr({"for":this.idOrName(a),generated:!0}).addClass(this.settings.errorClass).html(b||""),this.settings.wrapper&&(d=d.hide().show().wrap("<"+this.settings.wrapper+"/>").parent()),this.labelContainer.append(d).length||(this.settings.errorPlacement?this.settings.errorPlacement(d,c(a)):d.insertAfter(a)));!b&&this.settings.success&&(d.text(""),"string"==typeof this.settings.success?d.addClass(this.settings.success):this.settings.success(d));
this.toShow=this.toShow.add(d)},errorsFor:function(a){var b=this.idOrName(a);return this.errors().filter(function(){return c(this).attr("for")==b})},idOrName:function(a){return this.groups[a.name]||(this.checkable(a)?a.name:a.id||a.name)},validationTargetFor:function(a){this.checkable(a)&&(a=this.findByName(a.name).not(this.settings.ignore)[0]);return a},checkable:function(a){return/radio|checkbox/i.test(a.type)},findByName:function(a){var b=this.currentForm;return c(document.getElementsByName(a)).map(function(c,
e){return e.form==b&&e.name==a&&e||null})},getLength:function(a,b){switch(b.nodeName.toLowerCase()){case "select":return c("option:selected",b).length;case "input":if(this.checkable(b))return this.findByName(b.name).filter(":checked").length}return a.length},depend:function(a,b){return this.dependTypes[typeof a]?this.dependTypes[typeof a](a,b):!0},dependTypes:{"boolean":function(a,b){return a},string:function(a,b){return!!c(a,b.form).length},"function":function(a,b){return a(b)}},optional:function(a){return!c.validator.methods.required.call(this,
c.trim(a.value),a)&&"dependency-mismatch"},startRequest:function(a){this.pending[a.name]||(this.pendingRequest++,this.pending[a.name]=!0)},stopRequest:function(a,b){this.pendingRequest--;0>this.pendingRequest&&(this.pendingRequest=0);delete this.pending[a.name];b&&0==this.pendingRequest&&this.formSubmitted&&this.form()?(c(this.currentForm).submit(),this.formSubmitted=!1):!b&&0==this.pendingRequest&&this.formSubmitted&&(c(this.currentForm).triggerHandler("invalid-form",[this]),this.formSubmitted=!1)},
previousValue:function(a){return c.data(a,"previousValue")||c.data(a,"previousValue",{old:null,valid:!0,message:this.defaultMessage(a,"remote")})}},classRuleSettings:{required:{required:!0},email:{email:!0},url:{url:!0},date:{date:!0},dateISO:{dateISO:!0},dateDE:{dateDE:!0},number:{number:!0},numberDE:{numberDE:!0},digits:{digits:!0},creditcard:{creditcard:!0}},addClassRules:function(a,b){a.constructor==String?this.classRuleSettings[a]=b:c.extend(this.classRuleSettings,a)},classRules:function(a){var b=
{};(a=c(a).attr("class"))&&c.each(a.split(" "),function(){this in c.validator.classRuleSettings&&c.extend(b,c.validator.classRuleSettings[this])});return b},attributeRules:function(a){var b={};a=c(a);for(var d in c.validator.methods){var e;(e="required"===d&&"function"===typeof c.fn.prop?a.prop(d):a.attr(d))?b[d]=e:a[0].getAttribute("type")===d&&(b[d]=!0)}b.maxlength&&/-1|2147483647|524288/.test(b.maxlength)&&delete b.maxlength;return b},metadataRules:function(a){if(!c.metadata)return{};var b=c.data(a.form,
"validator").settings.meta;return b?c(a).metadata()[b]:c(a).metadata()},staticRules:function(a){var b={},d=c.data(a.form,"validator");d.settings.rules&&(b=c.validator.normalizeRule(d.settings.rules[a.name])||{});return b},normalizeRules:function(a,b){c.each(a,function(d,e){if(!1===e)delete a[d];else if(e.param||e.depends){var f=!0;switch(typeof e.depends){case "string":f=!!c(e.depends,b.form).length;break;case "function":f=e.depends.call(b,b)}f?a[d]=void 0!==e.param?e.param:!0:delete a[d]}});c.each(a,
function(d,e){a[d]=c.isFunction(e)?e(b):e});c.each(["minlength","maxlength","min","max"],function(){a[this]&&(a[this]=Number(a[this]))});c.each(["rangelength","range"],function(){a[this]&&(a[this]=[Number(a[this][0]),Number(a[this][1])])});c.validator.autoCreateRanges&&(a.min&&a.max&&(a.range=[a.min,a.max],delete a.min,delete a.max),a.minlength&&a.maxlength&&(a.rangelength=[a.minlength,a.maxlength],delete a.minlength,delete a.maxlength));a.messages&&delete a.messages;return a},normalizeRule:function(a){if("string"==
typeof a){var b={};c.each(a.split(/\s/),function(){b[this]=!0});a=b}return a},addMethod:function(a,b,d){c.validator.methods[a]=b;c.validator.messages[a]=void 0!=d?d:c.validator.messages[a];3>b.length&&c.validator.addClassRules(a,c.validator.normalizeRule(a))},methods:{required:function(a,b,d){if(!this.depend(d,b))return"dependency-mismatch";switch(b.nodeName.toLowerCase()){case "select":return(a=c(b).val())&&0<a.length;case "input":if(this.checkable(b))return 0<this.getLength(a,b);default:return 0<
c.trim(a).length}},remote:function(a,b,d){if(this.optional(b))return"dependency-mismatch";var e=this.previousValue(b);this.settings.messages[b.name]||(this.settings.messages[b.name]={});e.originalMessage=this.settings.messages[b.name].remote;this.settings.messages[b.name].remote=e.message;d="string"==typeof d&&{url:d}||d;if(this.pending[b.name])return"pending";if(e.old===a)return e.valid;e.old=a;var f=this;this.startRequest(b);var g={};g[b.name]=a;c.ajax(c.extend(!0,{url:d,mode:"abort",port:"validate"+
b.name,dataType:"json",data:g,success:function(d){f.settings.messages[b.name].remote=e.originalMessage;var g=!0===d;if(g){var h=f.formSubmitted;f.prepareElement(b);f.formSubmitted=h;f.successList.push(b);f.showErrors()}else h={},d=d||f.defaultMessage(b,"remote"),h[b.name]=e.message=c.isFunction(d)?d(a):d,f.showErrors(h);e.valid=g;f.stopRequest(b,g)}},d));return"pending"},minlength:function(a,b,d){return this.optional(b)||this.getLength(c.trim(a),b)>=d},maxlength:function(a,b,d){return this.optional(b)||
this.getLength(c.trim(a),b)<=d},rangelength:function(a,b,d){a=this.getLength(c.trim(a),b);return this.optional(b)||a>=d[0]&&a<=d[1]},min:function(a,b,c){return this.optional(b)||a>=c},max:function(a,b,c){return this.optional(b)||a<=c},range:function(a,b,c){return this.optional(b)||a>=c[0]&&a<=c[1]},email:function(a,b){return this.optional(b)||/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(a)},
url:function(a,b){return this.optional(b)||/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(a)},
date:function(a,b){return this.optional(b)||!/Invalid|NaN/.test(new Date(a))},dateISO:function(a,b){return this.optional(b)||/^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}$/.test(a)},number:function(a,b){return this.optional(b)||/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/.test(a)},digits:function(a,b){return this.optional(b)||/^\d+$/.test(a)},creditcard:function(a,b){if(this.optional(b))return"dependency-mismatch";if(/[^0-9 -]+/.test(a))return!1;b=0;var c=!1;a=a.replace(/\D/g,"");for(var e=a.length-1;0<=e;e--){var f=
a.charAt(e);f=parseInt(f,10);c&&9<(f*=2)&&(f-=9);b+=f;c=!c}return 0==b%10},accept:function(a,b,c){c="string"==typeof c?c.replace(/,/g,"|"):"png|jpe?g|gif";return this.optional(b)||a.match(new RegExp(".("+c+")$","i"))},equalTo:function(a,b,d){d=c(d).unbind(".validate-equalTo").bind("blur.validate-equalTo",function(){c(b).valid()});return a==d.val()}}});c.format=c.validator.format})(jQuery);
(function(c){var a={};if(c.ajaxPrefilter)c.ajaxPrefilter(function(b,c,f){c=b.port;"abort"==b.mode&&(a[c]&&a[c].abort(),a[c]=f)});else{var b=c.ajax;c.ajax=function(d){var e=("port"in d?d:c.ajaxSettings).port;return"abort"==("mode"in d?d:c.ajaxSettings).mode?(a[e]&&a[e].abort(),a[e]=b.apply(this,arguments)):b.apply(this,arguments)}}})(jQuery);
(function(c){jQuery.event.special.focusin||jQuery.event.special.focusout||!document.addEventListener||c.each({focus:"focusin",blur:"focusout"},function(a,b){function d(a){a=c.event.fix(a);a.type=b;return c.event.handle.call(this,a)}c.event.special[b]={setup:function(){this.addEventListener(a,d,!0)},teardown:function(){this.removeEventListener(a,d,!0)},handler:function(a){arguments[0]=c.event.fix(a);arguments[0].type=b;return c.event.handle.apply(this,arguments)}}});c.extend(c.fn,{validateDelegate:function(a,
b,d){return this.bind(b,function(b){var e=c(b.target);if(e.is(a))return d.apply(e,arguments)})}})})(jQuery);
;
/*
 jQuery Form Plugin
 version: 3.14 (30-JUL-2012)
 @requires jQuery v1.3.2 or later

 Examples and documentation at: http://malsup.com/jquery/form/
 Project repository: https://github.com/malsup/form
 Dual licensed under the MIT and GPL licenses:
    http://malsup.github.com/mit-license.txt
    http://malsup.github.com/gpl-license-v2.txt
*/
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(b,f,n){b instanceof String&&(b=String(b));for(var p=b.length,q=0;q<p;q++){var w=b[q];if(f.call(n,w,q,b))return{i:q,v:w}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,f,n){b!=Array.prototype&&b!=Object.prototype&&(b[f]=n.value)};$jscomp.getGlobal=function(b){b=["object"==typeof globalThis&&globalThis,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,b];for(var f=0;f<b.length;++f){var n=b[f];if(n&&n.Math==Math)return n}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(b,f,n,p){if(f){n=$jscomp.global;b=b.split(".");for(p=0;p<b.length-1;p++){var q=b[p];q in n||(n[q]={});n=n[q]}b=b[b.length-1];p=n[b];f=f(p);f!=p&&null!=f&&$jscomp.defineProperty(n,b,{configurable:!0,writable:!0,value:f})}};$jscomp.polyfill("Array.prototype.find",function(b){return b?b:function(b,n){return $jscomp.findInternal(this,b,n).v}},"es6","es3");
(function(b){function f(a){var c=a.data;a.isDefaultPrevented()||(a.preventDefault(),b(this).ajaxSubmit(c))}function n(a){var c=a.target,l=b(c);if(!l.is(":submit,input:image")){c=l.closest(":submit");if(0===c.length)return;c=c[0]}var d=this;d.clk=c;"image"==c.type&&(void 0!==a.offsetX?(d.clk_x=a.offsetX,d.clk_y=a.offsetY):"function"==typeof b.fn.offset?(l=l.offset(),d.clk_x=a.pageX-l.left,d.clk_y=a.pageY-l.top):(d.clk_x=a.pageX-c.offsetLeft,d.clk_y=a.pageY-c.offsetTop));setTimeout(function(){d.clk=
d.clk_x=d.clk_y=null},100)}function p(){if(b.fn.ajaxSubmit.debug){var a="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(a):window.opera&&window.opera.postError&&window.opera.postError(a)}}var q=void 0!==b("<input type='file'/>").get(0).files;var w=void 0!==window.FormData;b.fn.ajaxSubmit=function(a){function c(d){for(var c=new FormData,g=0;g<d.length;g++)c.append(d[g].name,d[g].value);if(a.extraData)for(var l in a.extraData)a.extraData.hasOwnProperty(l)&&
c.append(l,a.extraData[l]);a.data=null;d=b.extend(!0,{},b.ajaxSettings,a,{contentType:!1,processData:!1,cache:!1,type:"POST"});a.uploadProgress&&(d.xhr=function(){var b=jQuery.ajaxSettings.xhr();b.upload&&(b.upload.onprogress=function(b){var d=0,c=b.loaded||b.position,e=b.total;b.lengthComputable&&(d=Math.ceil(c/e*100));a.uploadProgress(b,c,e,d)});return b});d.data=null;var u=d.beforeSend;d.beforeSend=function(a,b){b.data=c;u&&u.call(this,a,b)};b.ajax(d)}function l(c){function g(){function a(){try{var b=
(r.contentWindow?r.contentWindow.document:r.contentDocument?r.contentDocument:r.document).readyState;p("state = "+b);b&&"uninitialized"==b.toLowerCase()&&setTimeout(a,50)}catch(D){p("Server abort: ",D," (",D.name,")"),l(2),q&&clearTimeout(q),q=void 0}}var c=d.attr("target"),g=d.attr("action");h.setAttribute("target",w);u||h.setAttribute("method","POST");g!=e.url&&h.setAttribute("action",e.url);e.skipEncodingOverride||u&&!/post/i.test(u)||d.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"});
e.timeout&&(q=setTimeout(function(){v=!0;l(1)},e.timeout));var k=[];try{if(e.extraData)for(var m in e.extraData)e.extraData.hasOwnProperty(m)&&(b.isPlainObject(e.extraData[m])&&e.extraData[m].hasOwnProperty("name")&&e.extraData[m].hasOwnProperty("value")?k.push(b('<input type="hidden" name="'+e.extraData[m].name+'">').attr("value",e.extraData[m].value).appendTo(h)[0]):k.push(b('<input type="hidden" name="'+m+'">').attr("value",e.extraData[m]).appendTo(h)[0]));e.iframeTarget||(y.appendTo("body"),r.attachEvent?
r.attachEvent("onload",l):r.addEventListener("load",l,!1));setTimeout(a,15);h.submit()}finally{h.setAttribute("action",g),c?h.setAttribute("target",c):d.removeAttr("target"),b(k).remove()}}function l(a){if(!k.aborted&&!E){try{t=r.contentWindow?r.contentWindow.document:r.contentDocument?r.contentDocument:r.document}catch(z){p("cannot access response document: ",z),a=2}if(1===a&&k)k.abort("timeout");else if(2==a&&k)k.abort("server abort");else if(t&&t.location.href!=e.iframeSrc||v){r.detachEvent?r.detachEvent("onload",
l):r.removeEventListener("load",l,!1);a="success";var c;try{if(v)throw"timeout";var d="xml"==e.dataType||t.XMLDocument||b.isXMLDoc(t);p("isXml="+d);if(!d&&window.opera&&(null===t.body||!t.body.innerHTML)&&--H){p("requeing onLoad callback, DOM not available");setTimeout(l,250);return}var g=t.body?t.body:t.documentElement;k.responseText=g?g.innerHTML:null;k.responseXML=t.XMLDocument?t.XMLDocument:t;d&&(e.dataType="xml");k.getResponseHeader=function(a){return{"content-type":e.dataType}[a]};g&&(k.status=
Number(g.getAttribute("status"))||k.status,k.statusText=g.getAttribute("statusText")||k.statusText);var h=(e.dataType||"").toLowerCase(),u=/(json|script|text)/.test(h);if(u||e.textarea){var f=t.getElementsByTagName("textarea")[0];if(f)k.responseText=f.value,k.status=Number(f.getAttribute("status"))||k.status,k.statusText=f.getAttribute("statusText")||k.statusText;else if(u){var n=t.getElementsByTagName("pre")[0],A=t.getElementsByTagName("body")[0];n?k.responseText=n.textContent?n.textContent:n.innerText:
A&&(k.responseText=A.textContent?A.textContent:A.innerText)}}else"xml"==h&&!k.responseXML&&k.responseText&&(k.responseXML=B(k.responseText));try{C=F(k,h,e)}catch(z){a="parsererror",k.error=c=z||a}}catch(z){p("error caught: ",z),a="error",k.error=c=z||a}k.aborted&&(p("upload aborted"),a=null);k.status&&(a=200<=k.status&&300>k.status||304===k.status?"success":"error");"success"===a?(e.success&&e.success.call(e.context,C,"success",k),m&&b.event.trigger("ajaxSuccess",[k,e])):a&&(void 0===c&&(c=k.statusText),
e.error&&e.error.call(e.context,k,a,c),m&&b.event.trigger("ajaxError",[k,e,c]));m&&b.event.trigger("ajaxComplete",[k,e]);m&&!--b.active&&b.event.trigger("ajaxStop");e.complete&&e.complete.call(e.context,k,a);E=!0;e.timeout&&clearTimeout(q);setTimeout(function(){e.iframeTarget||y.remove();k.responseXML=null},100)}}}var h=d[0],f,m,v,q;var x=!!b.fn.prop;if(b(":input[name=submit],:input[id=submit]",h).length)alert('Error: Form elements must not have name or id of "submit".');else{if(c)for(f=0;f<n.length;f++)c=
b(n[f]),x?c.prop("disabled",!1):c.removeAttr("disabled");var e=b.extend(!0,{},b.ajaxSettings,a);e.context=e.context||e;var w="jqFormIO"+(new Date).getTime();if(e.iframeTarget){var y=b(e.iframeTarget);(c=y.attr("name"))?w=c:y.attr("name",w)}else y=b('<iframe name="'+w+'" src="'+e.iframeSrc+'" />'),y.css({position:"absolute",top:"-1000px",left:"-1000px"});var r=y[0];var k={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},
setRequestHeader:function(){},abort:function(a){var c="timeout"===a?"timeout":"aborted";p("aborting upload... "+c);this.aborted=1;if(r.contentWindow.document.execCommand)try{r.contentWindow.document.execCommand("Stop")}catch(I){}y.attr("src",e.iframeSrc);k.error=c;e.error&&e.error.call(e.context,k,c,a);m&&b.event.trigger("ajaxError",[k,e,c]);e.complete&&e.complete.call(e.context,k,c)}};(m=e.global)&&0===b.active++&&b.event.trigger("ajaxStart");m&&b.event.trigger("ajaxSend",[k,e]);if(e.beforeSend&&
!1===e.beforeSend.call(e.context,k,e))e.global&&b.active--;else if(!k.aborted){(x=h.clk)&&(c=x.name)&&!x.disabled&&(e.extraData=e.extraData||{},e.extraData[c]=x.value,"image"==x.type&&(e.extraData[c+".x"]=h.clk_x,e.extraData[c+".y"]=h.clk_y));x=b("meta[name=csrf-token]").attr("content");(c=b("meta[name=csrf-param]").attr("content"))&&x&&(e.extraData=e.extraData||{},e.extraData[c]=x);e.forceSync?g():setTimeout(g,10);var C,t,H=50,E,B=b.parseXML||function(a,b){window.ActiveXObject?(b=new ActiveXObject("Microsoft.XMLDOM"),
b.async="false",b.loadXML(a)):b=(new DOMParser).parseFromString(a,"text/xml");return b&&b.documentElement&&"parsererror"!=b.documentElement.nodeName?b:null},G=b.parseJSON||function(a){return window.eval("("+a+")")},F=function(a,c,d){var e=a.getResponseHeader("content-type")||"",g="xml"===c||!c&&0<=e.indexOf("xml");a=g?a.responseXML:a.responseText;g&&"parsererror"===a.documentElement.nodeName&&b.error&&b.error("parsererror");d&&d.dataFilter&&(a=d.dataFilter(a,c));"string"===typeof a&&("json"===c||
!c&&0<=e.indexOf("json")?a=G(a):("script"===c||!c&&0<=e.indexOf("javascript"))&&b.globalEval(a));return a}}}}if(!this.length)return p("ajaxSubmit: skipping submit process - no element selected"),this;var d=this;"function"==typeof a&&(a={success:a});var u=this.attr("method");var g=this.attr("action");(g=(g="string"===typeof g?b.trim(g):"")||window.location.href||"")&&(g=(g.match(/^([^#]+)/)||[])[1]);a=b.extend(!0,{url:g,success:b.ajaxSettings.success,type:u||"GET",iframeSrc:/^https/i.test(window.location.href||
"")?"javascript:false":"about:blank"},a);g={};this.trigger("form-pre-serialize",[this,a,g]);if(g.veto)return p("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(a.beforeSerialize&&!1===a.beforeSerialize(this,a))return p("ajaxSubmit: submit aborted via beforeSerialize callback"),this;var m=a.traditional;void 0===m&&(m=b.ajaxSettings.traditional);var n=[],f=this.formToArray(a.semantic,n);if(a.data){a.extraData=a.data;var h=b.param(a.data,m)}if(a.beforeSubmit&&!1===a.beforeSubmit(f,
this,a))return p("ajaxSubmit: submit aborted via beforeSubmit callback"),this;this.trigger("form-submit-validate",[f,this,a,g]);if(g.veto)return p("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;g=b.param(f,m);h&&(g=g?g+"&"+h:h);"GET"==a.type.toUpperCase()?(a.url+=(0<=a.url.indexOf("?")?"&":"?")+g,a.data=null):a.data=g;var v=[];a.resetForm&&v.push(function(){d.resetForm()});a.clearForm&&v.push(function(){d.clearForm(a.includeHidden)});if(!a.dataType&&a.target){var B=a.success||
function(){};v.push(function(c){var d=a.replaceTarget?"replaceWith":"html";b(a.target)[d](c).each(B,arguments)})}else a.success&&v.push(a.success);a.success=function(b,c,g){for(var l=a.context||this,h=0,m=v.length;h<m;h++)v[h].apply(l,[b,c,g||d,d])};h=0<b("input:file:enabled[value]",this).length;g="multipart/form-data"==d.attr("enctype")||"multipart/form-data"==d.attr("encoding");m=q&&w;p("fileAPI :"+m);!1!==a.iframe&&(a.iframe||(h||g)&&!m)?a.closeKeepAlive?b.get(a.closeKeepAlive,function(){l(f)}):
l(f):(h||g)&&m?c(f):b.ajax(a);for(h=0;h<n.length;h++)n[h]=null;this.trigger("form-submit-notify",[this,a]);return this};b.fn.ajaxForm=function(a){a=a||{};a.delegation=a.delegation&&b.isFunction(b.fn.on);if(!a.delegation&&0===this.length){var c=this.selector,l=this.context;if(!b.isReady&&c)return p("DOM not ready, queuing ajaxForm"),b(function(){b(c,l).ajaxForm(a)}),this;p("terminating; zero elements found by selector"+(b.isReady?"":" (DOM not ready)"));return this}return a.delegation?(b(document).off("submit.form-plugin",
this.selector,f).off("click.form-plugin",this.selector,n).on("submit.form-plugin",this.selector,a,f).on("click.form-plugin",this.selector,a,n),this):this.ajaxFormUnbind().bind("submit.form-plugin",a,f).bind("click.form-plugin",a,n)};b.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")};b.fn.formToArray=function(a,c){var l=[];if(0===this.length)return l;var d=this[0],u=a?d.getElementsByTagName("*"):d.elements;if(!u)return l;var g,m,f;var n=0;for(f=u.length;n<f;n++){var h=
u[n];if(g=h.name)if(a&&d.clk&&"image"==h.type)h.disabled||d.clk!=h||(l.push({name:g,value:b(h).val(),type:h.type}),l.push({name:g+".x",value:d.clk_x},{name:g+".y",value:d.clk_y}));else if((m=b.fieldValue(h,!0))&&m.constructor==Array){c&&c.push(h);var p=0;for(h=m.length;p<h;p++)l.push({name:g,value:m[p]})}else if(q&&"file"==h.type&&!h.disabled)if(c&&c.push(h),m=h.files,m.length)for(p=0;p<m.length;p++)l.push({name:g,value:m[p],type:h.type});else l.push({name:g,value:"",type:h.type});else null!==m&&
"undefined"!=typeof m&&(c&&c.push(h),l.push({name:g,value:m,type:h.type,required:h.required}))}!a&&d.clk&&(a=b(d.clk),c=a[0],(g=c.name)&&!c.disabled&&"image"==c.type&&(l.push({name:g,value:a.val()}),l.push({name:g+".x",value:d.clk_x},{name:g+".y",value:d.clk_y})));return l};b.fn.formSerialize=function(a){return b.param(this.formToArray(a))};b.fn.fieldSerialize=function(a){var c=[];this.each(function(){var l=this.name;if(l){var d=b.fieldValue(this,a);if(d&&d.constructor==Array)for(var f=0,g=d.length;f<
g;f++)c.push({name:l,value:d[f]});else null!==d&&"undefined"!=typeof d&&c.push({name:this.name,value:d})}});return b.param(c)};b.fn.fieldValue=function(a){for(var c=[],l=0,d=this.length;l<d;l++){var f=b.fieldValue(this[l],a);null===f||"undefined"==typeof f||f.constructor==Array&&!f.length||(f.constructor==Array?b.merge(c,f):c.push(f))}return c};b.fieldValue=function(a,c){var l=a.name,d=a.type,f=a.tagName.toLowerCase();void 0===c&&(c=!0);if(c&&(!l||a.disabled||"reset"==d||"button"==d||("checkbox"==
d||"radio"==d)&&!a.checked||("submit"==d||"image"==d)&&a.form&&a.form.clk!=a||"select"==f&&-1==a.selectedIndex))return null;if("select"==f){f=a.selectedIndex;if(0>f)return null;c=[];a=a.options;l=(d="select-one"==d)?f+1:a.length;for(f=d?f:0;f<l;f++){var g=a[f];if(g.selected){var m=g.value;m||(m=g.attributes&&g.attributes.value&&!g.attributes.value.specified?g.text:g.value);if(d)return m;c.push(m)}}return c}return b(a).val()};b.fn.clearForm=function(a){return this.each(function(){b("input,select,textarea",
this).clearFields(a)})};b.fn.clearFields=b.fn.clearInputs=function(a){var c=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var f=this.type,d=this.tagName.toLowerCase();c.test(f)||"textarea"==d?this.value="":"checkbox"==f||"radio"==f?this.checked=!1:"select"==d?this.selectedIndex=-1:a&&(!0===a&&/hidden/.test(f)||"string"==typeof a&&b(this).is(a))&&(this.value="")})};b.fn.resetForm=function(){return this.each(function(){("function"==
typeof this.reset||"object"==typeof this.reset&&!this.reset.nodeType)&&this.reset()})};b.fn.enable=function(a){void 0===a&&(a=!0);return this.each(function(){this.disabled=!a})};b.fn.selected=function(a){void 0===a&&(a=!0);return this.each(function(){var c=this.type;"checkbox"==c||"radio"==c?this.checked=a:"option"==this.tagName.toLowerCase()&&(c=b(this).parent("select"),a&&c[0]&&"select-one"==c[0].type&&c.find("option").selected(!1),this.selected=a)})};b.fn.ajaxSubmit.debug=!1})(jQuery);
;
(function(b){b.fn.extend({defaultValue:function(e){return"placeholder"in document.createElement("input")?!1:this.each(function(){if(b(this).data("defaultValued"))return!1;var a=b(this),h=a.attr("placeholder"),f={input:a};a.data("defaultValued",!0);var d=function(){if("input"==a.context.nodeName.toLowerCase())var c=b("<input />").attr({type:"text"});else if("textarea"==a.context.nodeName.toLowerCase())c=b("<textarea />");else throw"DefaultValue only works with input and textareas";c.attr({value:h,
"class":a.attr("class")+" empty",size:a.attr("size"),style:a.attr("style"),tabindex:a.attr("tabindex"),rows:a.attr("rows"),cols:a.attr("cols"),name:"defaultvalue-clone-"+(65536*(1+Math.random())|0).toString(16).substring(1)});c.focus(function(){c.hide();a.show();setTimeout(function(){a.focus()},1)});return c}();f.clone=d;d.insertAfter(a);var g=function(){0>=a.val().length?(d.show(),a.hide()):(d.hide(),a.show().trigger("click"))};a.bind("blur",g);g();e&&e(f)})}})})(jQuery);
;
/*
	Masked Input plugin for jQuery
	Copyright (c) 2007-2011 Josh Bush (digitalbush.com)
	Licensed under the MIT license (http://digitalbush.com/projects/masked-input-plugin/#license) 
	Version: 1.3
*/
(function(a){var b=(a.browser.msie?"paste":"input")+".mask",c=window.orientation!=undefined;a.mask={definitions:{9:"[0-9]",a:"[A-Za-z]","*":"[A-Za-z0-9]"},dataName:"rawMaskFn"},a.fn.extend({caret:function(a,b){if(this.length!=0){if(typeof a=="number"){b=typeof b=="number"?b:a;return this.each(function(){if(this.setSelectionRange)this.setSelectionRange(a,b);else if(this.createTextRange){var c=this.createTextRange();c.collapse(!0),c.moveEnd("character",b),c.moveStart("character",a),c.select()}})}if(this[0].setSelectionRange)a=this[0].selectionStart,b=this[0].selectionEnd;else if(document.selection&&document.selection.createRange){var c=document.selection.createRange();a=0-c.duplicate().moveStart("character",-1e5),b=a+c.text.length}return{begin:a,end:b}}},unmask:function(){return this.trigger("unmask")},mask:function(d,e){if(!d&&this.length>0){var f=a(this[0]);return f.data(a.mask.dataName)()}e=a.extend({placeholder:"_",completed:null},e);var g=a.mask.definitions,h=[],i=d.length,j=null,k=d.length;a.each(d.split(""),function(a,b){b=="?"?(k--,i=a):g[b]?(h.push(new RegExp(g[b])),j==null&&(j=h.length-1)):h.push(null)});return this.trigger("unmask").each(function(){function v(a){var b=f.val(),c=-1;for(var d=0,g=0;d<k;d++)if(h[d]){l[d]=e.placeholder;while(g++<b.length){var m=b.charAt(g-1);if(h[d].test(m)){l[d]=m,c=d;break}}if(g>b.length)break}else l[d]==b.charAt(g)&&d!=i&&(g++,c=d);if(!a&&c+1<i)f.val(""),t(0,k);else if(a||c+1>=i)u(),a||f.val(f.val().substring(0,c+1));return i?d:j}function u(){return f.val(l.join("")).val()}function t(a,b){for(var c=a;c<b&&c<k;c++)h[c]&&(l[c]=e.placeholder)}function s(a){var b=a.which,c=f.caret();if(a.ctrlKey||a.altKey||a.metaKey||b<32)return!0;if(b){c.end-c.begin!=0&&(t(c.begin,c.end),p(c.begin,c.end-1));var d=n(c.begin-1);if(d<k){var g=String.fromCharCode(b);if(h[d].test(g)){q(d),l[d]=g,u();var i=n(d);f.caret(i),e.completed&&i>=k&&e.completed.call(f)}}return!1}}function r(a){var b=a.which;if(b==8||b==46||c&&b==127){var d=f.caret(),e=d.begin,g=d.end;g-e==0&&(e=b!=46?o(e):g=n(e-1),g=b==46?n(g):g),t(e,g),p(e,g-1);return!1}if(b==27){f.val(m),f.caret(0,v());return!1}}function q(a){for(var b=a,c=e.placeholder;b<k;b++)if(h[b]){var d=n(b),f=l[b];l[b]=c;if(d<k&&h[d].test(f))c=f;else break}}function p(a,b){if(!(a<0)){for(var c=a,d=n(b);c<k;c++)if(h[c]){if(d<k&&h[c].test(l[d]))l[c]=l[d],l[d]=e.placeholder;else break;d=n(d)}u(),f.caret(Math.max(j,a))}}function o(a){while(--a>=0&&!h[a]);return a}function n(a){while(++a<=k&&!h[a]);return a}var f=a(this),l=a.map(d.split(""),function(a,b){if(a!="?")return g[a]?e.placeholder:a}),m=f.val();f.data(a.mask.dataName,function(){return a.map(l,function(a,b){return h[b]&&a!=e.placeholder?a:null}).join("")}),f.attr("readonly")||f.one("unmask",function(){f.unbind(".mask").removeData(a.mask.dataName)}).bind("focus.mask",function(){m=f.val();var b=v();u();var c=function(){b==d.length?f.caret(0,b):f.caret(b)};(a.browser.msie?c:function(){setTimeout(c,0)})()}).bind("blur.mask",function(){v(),f.val()!=m&&f.change()}).bind("keydown.mask",r).bind("keypress.mask",s).bind(b,function(){setTimeout(function(){f.caret(v(!0))},0)}),v()})}})})(jQuery);
function trim(a,b){b=b?b.replace(/([\[\]\(\)\.\?\/\*\{\}\+\$\^:])/g,"$1"):" ";return a.replace(new RegExp("^["+b+"]+|["+b+"]+$","g"),"")}function explode(a,b){var c={0:""};if(2!=arguments.length||"undefined"==typeof arguments[0]||"undefined"==typeof arguments[1])return null;if(""===a||!1===a||null===a)return!1;if("function"==typeof a||"object"==typeof a||"function"==typeof b||"object"==typeof b)return c;!0===a&&(a="1");return b.toString().split(a.toString())}
function refreshSecretkey(a){$("#"+a+"_secretkey").val("");$("#"+a+"_secretkey_img").attr({src:"/secretkey.php?type="+a+"&hash="+Math.round(1E3*Math.random(0))+1})}jQuery.validator.addMethod("validemail",function(a,b,c){if(""==trim(a)&&0==this.optional(b))return!1;c=/^[0-9a-z_\.-]+@[0-9a-z_^\.-]+\.[a-z]{2,6}$/i;return this.optional(b)||c.test(a)||c.test(a)},"Please enter valid email");
jQuery.validator.addMethod("checkDate",function(a,b,c){c=explode(",",c);a=parseInt($("#"+c[0]).val());c=parseInt($("#"+c[1]).val())-1;var d=parseInt($("#"+b.id).val());if(!this.optional(b)&&-1==a+c+d)return!0;b=new Date(d,c,a);return a==b.getDate()&&c==b.getMonth()&&d==b.getFullYear()&&1753<d?!0:!1});jQuery.validator.addMethod("secretkey",function(a,b,c){return""==trim(a)&&0==this.optional(b)?!0:/^[a-z0-9_-]+$/i.test(a)},"Please enter valid secretkey!");
jQuery.validator.addMethod("checkAge",function(a,b,c){var d=explode(",",c);c=parseInt($("#"+d[0]).val());var e=parseInt($("#"+d[1]).val())-1,f=parseInt($("#"+b.id).val());a=d[2];d=d[3];if(!this.optional(b)&&-1==c+e+f)return!0;b=new Date(f,e,c);return c==b.getDate()&&e==b.getMonth()&&f==b.getFullYear()&&1753<f?(c=new Date,e=new Date(c.getFullYear()-d,c.getMonth(),c.getDate()),a=new Date(c.getFullYear()-a,c.getMonth(),c.getDate()),b.getTime()>=e.getTime()&&b.getTime()<=a.getTime()):!1});
jQuery.validator.addMethod("validnickname",function(a,b,c){return""==a?!1:/^[a-zA-Z0-9_]+$/i.test(a)},"Please enter valid nickname!");jQuery.validator.addMethod("validshortname",function(a,b,c){return""==a?!0:/^[a-zA-Z0-9_-]+$/i.test(a)},"Please enter valid shortname!");jQuery.validator.addMethod("urlshortname",function(a,b,c){return""==a?!0:/^[a-zA-Z0-9_\-]+$/i.test(a)},"Please enter valid shortname!");
jQuery.validator.addMethod("validlatin",function(a,b,c){return""==trim(a)&&0!=this.optional(b)?!0:/^[a-z0-9!@%#$\^&*()\[\]+_=<>?.\/\\{}~"'\u2019`:;,| \r\n\t~\u00a2\u00a3\u00a4\u00a5\u00a6\u00a7\u00a8\u00a9\u00ab\u00ac\u00ae\u00af\u00b0\u00b1\u00b2\u00b3\u00b4\u00b7\u00b8\u00b9\u00ba\u00bb\u01c0\u01c1\u01c2\u2012\u2013\u2014\u2015\u2016\u2017\u2018\u2019\u201a\u201b\u201c\u201d\u201e\u201f\u2020\u2021\u2022\u2026\u2032\u2033\u2034\u2039\u203a\u20a4\u20ac\u20b5\u2105\u2113\u2116\u2117\u2122\u25a0\u25a1\u25aa\u25ab\u25ca\u25cb\u25cc\u25cf\u25e6-]+$/i.test(a)},
"Please enter latin symbols only!");jQuery.validator.addMethod("twodigitsandtwoletters",function(a,b,c){return!0},"Password must have at least 2 digits and 2 letters!");jQuery.validator.addMethod("notequalto",function(a,b,c){return a!=$(c).val()},"Must be different fields!");jQuery.validator.addMethod("float",function(a,b,c){return""==a?!0:/^-?[0-9]+([.][0-9]+)?$/.test(a)},"Please enter float!");
jQuery.validator.addMethod("pcode",function(a,b,c){return""==a?!0:/^[\u0430-\u044f\u0456\u0454\u0457\u0491a-z\u00C0-\u02AF][\d]{5}$/iu.test(a)},"Please enter valid pcode");
function processXml(a,b,c){var d=$("#"+b);$("[id^=error_]",d).hide();var e=0;$("e",a).each(function(a){e++;a=$("c",$(this)).text();var c=$("m",$(this)).text();setTimeout("$('#"+b+"').data('validator').showErrors({'"+a.substring(b.length+1)+"':'"+c.replace(/'/g,"&#039;")+"'})",10)});e?$("#"+b+"_secretkey_img").length&&refreshSecretkey(b):"function"==typeof c&&c(b);clearTimeout(timeout);hideLoadingBlock();$("action",a).each(function(){try{eval($(this).text())}catch(f){alert($(this).text())}})}
function formHighlight(a,b,c){$("#"+b).parents(".form-group").addClass("has-error")}function formUnHighlight(a,b,c){$("#"+b).parents(".form-group").removeClass("has-error")}formAfterSubmitDestination=!1;$("body").on("click",".formSubmitButton",function(a){formAfterSubmitDestination=$(this).attr("data-formAfterSubmitDestination")});
;
/*
 jQuery UI - v1.11.4+CommonJS - 2015-08-28
 http://jqueryui.com
 Includes: widget.js
 Copyright 2015 jQuery Foundation and other contributors; Licensed MIT  jQuery UI Widget 1.11.4
 http://jqueryui.com

 Copyright jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license

 http://api.jqueryui.com/jQuery.widget/
*/
(function(b){"function"===typeof define&&define.amd?define(["jquery"],b):"object"===typeof exports?b(require("jquery")):b(jQuery)})(function(b){var n=0,m=Array.prototype.slice;b.cleanData=function(a){return function(c){var f,d,e;for(e=0;null!=(d=c[e]);e++)try{(f=b._data(d,"events"))&&f.remove&&b(d).triggerHandler("remove")}catch(g){}a(c)}}(b.cleanData);b.widget=function(a,c,f){var d={},e=a.split(".")[0];a=a.split(".")[1];var g=e+"-"+a;f||(f=c,c=b.Widget);b.expr[":"][g.toLowerCase()]=function(a){return!!b.data(a,
g)};b[e]=b[e]||{};var h=b[e][a];var l=b[e][a]=function(a,b){if(!this._createWidget)return new l(a,b);arguments.length&&this._createWidget(a,b)};b.extend(l,h,{version:f.version,_proto:b.extend({},f),_childConstructors:[]});var k=new c;k.options=b.widget.extend({},k.options);b.each(f,function(a,f){b.isFunction(f)?d[a]=function(){var b=function(){return c.prototype[a].apply(this,arguments)},d=function(b){return c.prototype[a].apply(this,b)};return function(){var a=this._super,c=this._superApply;this._super=
b;this._superApply=d;var e=f.apply(this,arguments);this._super=a;this._superApply=c;return e}}():d[a]=f});l.prototype=b.widget.extend(k,{widgetEventPrefix:h?k.widgetEventPrefix||a:a},d,{constructor:l,namespace:e,widgetName:a,widgetFullName:g});h?(b.each(h._childConstructors,function(a,c){a=c.prototype;b.widget(a.namespace+"."+a.widgetName,l,c._proto)}),delete h._childConstructors):c._childConstructors.push(l);b.widget.bridge(a,l);return l};b.widget.extend=function(a){for(var c=m.call(arguments,1),
f=0,d=c.length,e,g;f<d;f++)for(e in c[f])g=c[f][e],c[f].hasOwnProperty(e)&&void 0!==g&&(b.isPlainObject(g)?a[e]=b.isPlainObject(a[e])?b.widget.extend({},a[e],g):b.widget.extend({},g):a[e]=g);return a};b.widget.bridge=function(a,c){var f=c.prototype.widgetFullName||a;b.fn[a]=function(d){var e="string"===typeof d,g=m.call(arguments,1),h=this;e?this.each(function(){var c=b.data(this,f);if("instance"===d)return h=c,!1;if(!c)return b.error("cannot call methods on "+a+" prior to initialization; attempted to call method '"+
d+"'");if(!b.isFunction(c[d])||"_"===d.charAt(0))return b.error("no such method '"+d+"' for "+a+" widget instance");var e=c[d].apply(c,g);if(e!==c&&void 0!==e)return h=e&&e.jquery?h.pushStack(e.get()):e,!1}):(g.length&&(d=b.widget.extend.apply(null,[d].concat(g))),this.each(function(){var a=b.data(this,f);a?(a.option(d||{}),a._init&&a._init()):b.data(this,f,new c(d,this))}));return h}};b.Widget=function(){};b.Widget._childConstructors=[];b.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",
defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(a,c){c=b(c||this.defaultElement||this)[0];this.element=b(c);this.uuid=n++;this.eventNamespace="."+this.widgetName+this.uuid;this.bindings=b();this.hoverable=b();this.focusable=b();c!==this&&(b.data(c,this.widgetFullName,this),this._on(!0,this.element,{remove:function(a){a.target===c&&this.destroy()}}),this.document=b(c.style?c.ownerDocument:c.document||c),this.window=b(this.document[0].defaultView||this.document[0].parentWindow));
this.options=b.widget.extend({},this.options,this._getCreateOptions(),a);this._create();this._trigger("create",null,this._getCreateEventData());this._init()},_getCreateOptions:b.noop,_getCreateEventData:b.noop,_create:b.noop,_init:b.noop,destroy:function(){this._destroy();this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(b.camelCase(this.widgetFullName));this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled");
this.bindings.unbind(this.eventNamespace);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")},_destroy:b.noop,widget:function(){return this.element},option:function(a,c){var f=a,d;if(0===arguments.length)return b.widget.extend({},this.options);if("string"===typeof a){f={};var e=a.split(".");a=e.shift();if(e.length){var g=f[a]=b.widget.extend({},this.options[a]);for(d=0;d<e.length-1;d++)g[e[d]]=g[e[d]]||{},g=g[e[d]];a=e.pop();if(1===arguments.length)return void 0===
g[a]?null:g[a];g[a]=c}else{if(1===arguments.length)return void 0===this.options[a]?null:this.options[a];f[a]=c}}this._setOptions(f);return this},_setOptions:function(a){for(var c in a)this._setOption(c,a[c]);return this},_setOption:function(a,c){this.options[a]=c;"disabled"===a&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!c),c&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")));return this},enable:function(){return this._setOptions({disabled:!1})},
disable:function(){return this._setOptions({disabled:!0})},_on:function(a,c,f){var d,e=this;"boolean"!==typeof a&&(f=c,c=a,a=!1);f?(c=d=b(c),this.bindings=this.bindings.add(c)):(f=c,c=this.element,d=this.widget());b.each(f,function(f,h){function g(){if(a||!0!==e.options.disabled&&!b(this).hasClass("ui-state-disabled"))return("string"===typeof h?e[h]:h).apply(e,arguments)}"string"!==typeof h&&(g.guid=h.guid=h.guid||g.guid||b.guid++);var k=f.match(/^([\w:-]*)\s*(.*)$/);f=k[1]+e.eventNamespace;(k=k[2])?
d.delegate(k,f,g):c.bind(f,g)})},_off:function(a,c){c=(c||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace;a.unbind(c).undelegate(c);this.bindings=b(this.bindings.not(a).get());this.focusable=b(this.focusable.not(a).get());this.hoverable=b(this.hoverable.not(a).get())},_delay:function(a,c){var b=this;return setTimeout(function(){return("string"===typeof a?b[a]:a).apply(b,arguments)},c||0)},_hoverable:function(a){this.hoverable=this.hoverable.add(a);this._on(a,{mouseenter:function(a){b(a.currentTarget).addClass("ui-state-hover")},
mouseleave:function(a){b(a.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(a){this.focusable=this.focusable.add(a);this._on(a,{focusin:function(a){b(a.currentTarget).addClass("ui-state-focus")},focusout:function(a){b(a.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(a,c,f){var d,e=this.options[a];f=f||{};c=b.Event(c);c.type=(a===this.widgetEventPrefix?a:this.widgetEventPrefix+a).toLowerCase();c.target=this.element[0];if(a=c.originalEvent)for(d in a)d in c||
(c[d]=a[d]);this.element.trigger(c,f);return!(b.isFunction(e)&&!1===e.apply(this.element[0],[c].concat(f))||c.isDefaultPrevented())}};b.each({show:"fadeIn",hide:"fadeOut"},function(a,c){b.Widget.prototype["_"+a]=function(f,d,e){"string"===typeof d&&(d={effect:d});var g=d?!0===d||"number"===typeof d?c:d.effect||c:a;d=d||{};"number"===typeof d&&(d={duration:d});var h=!b.isEmptyObject(d);d.complete=e;d.delay&&f.delay(d.delay);if(h&&b.effects&&b.effects.effect[g])f[a](d);else if(g!==a&&f[g])f[g](d.duration,
d.easing,e);else f.queue(function(c){b(this)[a]();e&&e.call(f[0]);c()})}})});
;
!function(e){"use strict";var t=function(e,i,a){var o,r,n=document.createElement("img");if(n.onerror=i,n.onload=function(){!r||a&&a.noRevoke||t.revokeObjectURL(r),i&&i(t.scale(n,a))},t.isInstanceOf("Blob",e)||t.isInstanceOf("File",e))o=r=t.createObjectURL(e),n._type=e.type;else{if("string"!=typeof e)return!1;o=e,a&&a.crossOrigin&&(n.crossOrigin=a.crossOrigin)}return o?(n.src=o,n):t.readFile(e,function(e){var t=e.target;t&&t.result?n.src=t.result:i&&i(e)})},i=window.createObjectURL&&window||window.URL&&URL.revokeObjectURL&&URL||window.webkitURL&&webkitURL;t.isInstanceOf=function(e,t){return Object.prototype.toString.call(t)==="[object "+e+"]"},t.transformCoordinates=function(){},t.getTransformedOptions=function(e,t){var i,a,o,r,n=t.aspectRatio;if(!n)return t;i={};for(a in t)t.hasOwnProperty(a)&&(i[a]=t[a]);return i.crop=!0,o=e.naturalWidth||e.width,r=e.naturalHeight||e.height,o/r>n?(i.maxWidth=r*n,i.maxHeight=r):(i.maxWidth=o,i.maxHeight=o/n),i},t.renderImageToCanvas=function(e,t,i,a,o,r,n,s,l,d){return e.getContext("2d").drawImage(t,i,a,o,r,n,s,l,d),e},t.hasCanvasOption=function(e){return e.canvas||e.crop||!!e.aspectRatio},t.scale=function(e,i){function a(){var e=Math.max((s||y)/y,(l||v)/v);e>1&&(y*=e,v*=e)}function o(){var e=Math.min((r||y)/y,(n||v)/v);1>e&&(y*=e,v*=e)}i=i||{};var r,n,s,l,d,u,c,g,f,h,m,p=document.createElement("canvas"),S=e.getContext||t.hasCanvasOption(i)&&p.getContext,b=e.naturalWidth||e.width,x=e.naturalHeight||e.height,y=b,v=x;if(S&&(i=t.getTransformedOptions(e,i),c=i.left||0,g=i.top||0,i.sourceWidth?(d=i.sourceWidth,void 0!==i.right&&void 0===i.left&&(c=b-d-i.right)):d=b-c-(i.right||0),i.sourceHeight?(u=i.sourceHeight,void 0!==i.bottom&&void 0===i.top&&(g=x-u-i.bottom)):u=x-g-(i.bottom||0),y=d,v=u),r=i.maxWidth,n=i.maxHeight,s=i.minWidth,l=i.minHeight,S&&r&&n&&i.crop?(y=r,v=n,m=d/u-r/n,0>m?(u=n*d/r,void 0===i.top&&void 0===i.bottom&&(g=(x-u)/2)):m>0&&(d=r*u/n,void 0===i.left&&void 0===i.right&&(c=(b-d)/2))):((i.contain||i.cover)&&(s=r=r||s,l=n=n||l),i.cover?(o(),a()):(a(),o())),S){if(f=i.pixelRatio,f>1&&(p.style.width=y+"px",p.style.height=v+"px",y*=f,v*=f,p.getContext("2d").scale(f,f)),h=i.downsamplingRatio,h>0&&1>h&&d>y&&u>v)for(;d*h>y;)p.width=d*h,p.height=u*h,t.renderImageToCanvas(p,e,c,g,d,u,0,0,p.width,p.height),d=p.width,u=p.height,e=document.createElement("canvas"),e.width=d,e.height=u,t.renderImageToCanvas(e,p,0,0,d,u,0,0,d,u);return p.width=y,p.height=v,t.transformCoordinates(p,i),t.renderImageToCanvas(p,e,c,g,d,u,0,0,y,v)}return e.width=y,e.height=v,e},t.createObjectURL=function(e){return i?i.createObjectURL(e):!1},t.revokeObjectURL=function(e){return i?i.revokeObjectURL(e):!1},t.readFile=function(e,t,i){if(window.FileReader){var a=new FileReader;if(a.onload=a.onerror=t,i=i||"readAsDataURL",a[i])return a[i](e),a}return!1},"function"==typeof define&&define.amd?define(function(){return t}):"object"==typeof module&&module.exports?module.exports=t:e.loadImage=t}(window),function(e){"use strict";"function"==typeof define&&define.amd?define(["./load-image"],e):e("object"==typeof module&&module.exports?require("./load-image"):window.loadImage)}(function(e){"use strict";var t=e.hasCanvasOption,i=e.transformCoordinates,a=e.getTransformedOptions;e.hasCanvasOption=function(i){return!!i.orientation||t.call(e,i)},e.transformCoordinates=function(t,a){i.call(e,t,a);var o=t.getContext("2d"),r=t.width,n=t.height,s=t.style.width,l=t.style.height,d=a.orientation;if(d&&!(d>8))switch(d>4&&(t.width=n,t.height=r,t.style.width=l,t.style.height=s),d){case 2:o.translate(r,0),o.scale(-1,1);break;case 3:o.translate(r,n),o.rotate(Math.PI);break;case 4:o.translate(0,n),o.scale(1,-1);break;case 5:o.rotate(.5*Math.PI),o.scale(1,-1);break;case 6:o.rotate(.5*Math.PI),o.translate(0,-n);break;case 7:o.rotate(.5*Math.PI),o.translate(r,-n),o.scale(-1,1);break;case 8:o.rotate(-.5*Math.PI),o.translate(-r,0)}},e.getTransformedOptions=function(t,i){var o,r,n=a.call(e,t,i),s=n.orientation;if(!s||s>8||1===s)return n;o={};for(r in n)n.hasOwnProperty(r)&&(o[r]=n[r]);switch(n.orientation){case 2:o.left=n.right,o.right=n.left;break;case 3:o.left=n.right,o.top=n.bottom,o.right=n.left,o.bottom=n.top;break;case 4:o.top=n.bottom,o.bottom=n.top;break;case 5:o.left=n.top,o.top=n.left,o.right=n.bottom,o.bottom=n.right;break;case 6:o.left=n.top,o.top=n.right,o.right=n.bottom,o.bottom=n.left;break;case 7:o.left=n.bottom,o.top=n.right,o.right=n.top,o.bottom=n.left;break;case 8:o.left=n.bottom,o.top=n.left,o.right=n.top,o.bottom=n.right}return n.orientation>4&&(o.maxWidth=n.maxHeight,o.maxHeight=n.maxWidth,o.minWidth=n.minHeight,o.minHeight=n.minWidth,o.sourceWidth=n.sourceHeight,o.sourceHeight=n.sourceWidth),o}}),function(e){"use strict";"function"==typeof define&&define.amd?define(["./load-image"],e):e("object"==typeof module&&module.exports?require("./load-image"):window.loadImage)}(function(e){"use strict";var t=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice);e.blobSlice=t&&function(){var e=this.slice||this.webkitSlice||this.mozSlice;return e.apply(this,arguments)},e.metaDataParsers={jpeg:{65505:[]}},e.parseMetaData=function(t,i,a){a=a||{};var o=this,r=a.maxMetaDataSize||262144,n={},s=!(window.DataView&&t&&t.size>=12&&"image/jpeg"===t.type&&e.blobSlice);(s||!e.readFile(e.blobSlice.call(t,0,r),function(t){if(t.target.error)return console.log(t.target.error),void i(n);var r,s,l,d,u=t.target.result,c=new DataView(u),g=2,f=c.byteLength-4,h=g;if(65496===c.getUint16(0)){for(;f>g&&(r=c.getUint16(g),r>=65504&&65519>=r||65534===r);){if(s=c.getUint16(g+2)+2,g+s>c.byteLength){console.log("Invalid meta data: Invalid segment size.");break}if(l=e.metaDataParsers.jpeg[r])for(d=0;d<l.length;d+=1)l[d].call(o,c,g,s,n,a);g+=s,h=g}!a.disableImageHead&&h>6&&(u.slice?n.imageHead=u.slice(0,h):n.imageHead=new Uint8Array(u).subarray(0,h))}else console.log("Invalid JPEG file: Missing JPEG marker.");i(n)},"readAsArrayBuffer"))&&i(n)}}),function(e){"use strict";"function"==typeof define&&define.amd?define(["./load-image","./load-image-meta"],e):"object"==typeof module&&module.exports?e(require("./load-image"),require("./load-image-meta")):e(window.loadImage)}(function(e){"use strict";e.ExifMap=function(){return this},e.ExifMap.prototype.map={Orientation:274},e.ExifMap.prototype.get=function(e){return this[e]||this[this.map[e]]},e.getExifThumbnail=function(e,t,i){var a,o,r;if(!i||t+i>e.byteLength)return void console.log("Invalid Exif data: Invalid thumbnail data.");for(a=[],o=0;i>o;o+=1)r=e.getUint8(t+o),a.push((16>r?"0":"")+r.toString(16));return"data:image/jpeg,%"+a.join("%")},e.exifTagTypes={1:{getValue:function(e,t){return e.getUint8(t)},size:1},2:{getValue:function(e,t){return String.fromCharCode(e.getUint8(t))},size:1,ascii:!0},3:{getValue:function(e,t,i){return e.getUint16(t,i)},size:2},4:{getValue:function(e,t,i){return e.getUint32(t,i)},size:4},5:{getValue:function(e,t,i){return e.getUint32(t,i)/e.getUint32(t+4,i)},size:8},9:{getValue:function(e,t,i){return e.getInt32(t,i)},size:4},10:{getValue:function(e,t,i){return e.getInt32(t,i)/e.getInt32(t+4,i)},size:8}},e.exifTagTypes[7]=e.exifTagTypes[1],e.getExifValue=function(t,i,a,o,r,n){var s,l,d,u,c,g,f=e.exifTagTypes[o];if(!f)return void console.log("Invalid Exif data: Invalid tag type.");if(s=f.size*r,l=s>4?i+t.getUint32(a+8,n):a+8,l+s>t.byteLength)return void console.log("Invalid Exif data: Invalid data offset.");if(1===r)return f.getValue(t,l,n);for(d=[],u=0;r>u;u+=1)d[u]=f.getValue(t,l+u*f.size,n);if(f.ascii){for(c="",u=0;u<d.length&&(g=d[u],"\x00"!==g);u+=1)c+=g;return c}return d},e.parseExifTag=function(t,i,a,o,r){var n=t.getUint16(a,o);r.exif[n]=e.getExifValue(t,i,a,t.getUint16(a+2,o),t.getUint32(a+4,o),o)},e.parseExifTags=function(e,t,i,a,o){var r,n,s;if(i+6>e.byteLength)return void console.log("Invalid Exif data: Invalid directory offset.");if(r=e.getUint16(i,a),n=i+2+12*r,n+4>e.byteLength)return void console.log("Invalid Exif data: Invalid directory size.");for(s=0;r>s;s+=1)this.parseExifTag(e,t,i+2+12*s,a,o);return e.getUint32(n,a)},e.parseExifData=function(t,i,a,o,r){if(!r.disableExif){var n,s,l,d=i+10;if(1165519206===t.getUint32(i+4)){if(d+8>t.byteLength)return void console.log("Invalid Exif data: Invalid segment size.");if(0!==t.getUint16(i+8))return void console.log("Invalid Exif data: Missing byte alignment offset.");switch(t.getUint16(d)){case 18761:n=!0;break;case 19789:n=!1;break;default:return void console.log("Invalid Exif data: Invalid byte alignment marker.")}if(42!==t.getUint16(d+2,n))return void console.log("Invalid Exif data: Missing TIFF marker.");s=t.getUint32(d+4,n),o.exif=new e.ExifMap,s=e.parseExifTags(t,d,d+s,n,o),s&&!r.disableExifThumbnail&&(l={exif:{}},s=e.parseExifTags(t,d,d+s,n,l),l.exif[513]&&(o.exif.Thumbnail=e.getExifThumbnail(t,d+l.exif[513],l.exif[514]))),o.exif[34665]&&!r.disableExifSub&&e.parseExifTags(t,d,d+o.exif[34665],n,o),o.exif[34853]&&!r.disableExifGps&&e.parseExifTags(t,d,d+o.exif[34853],n,o)}}},e.metaDataParsers.jpeg[65505].push(e.parseExifData)}),function(e){"use strict";"function"==typeof define&&define.amd?define(["./load-image","./load-image-exif"],e):"object"==typeof module&&module.exports?e(require("./load-image"),require("./load-image-exif")):e(window.loadImage)}(function(e){"use strict";e.ExifMap.prototype.tags={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright",36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",42240:"Gamma",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubSecTime",37521:"SubSecTimeOriginal",37522:"SubSecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"PhotographicSensitivity",34856:"OECF",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"CameraOwnerName",42033:"BodySerialNumber",42034:"LensSpecification",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber",0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"},e.ExifMap.prototype.stringValues={ExposureProgram:{0:"Undefined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Undefined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},ComponentsConfiguration:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"},Orientation:{1:"top-left",2:"top-right",3:"bottom-right",4:"bottom-left",5:"left-top",6:"right-top",7:"right-bottom",8:"left-bottom"}},e.ExifMap.prototype.getText=function(e){var t=this.get(e);switch(e){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":case"Orientation":return this.stringValues[e][t];case"ExifVersion":case"FlashpixVersion":return String.fromCharCode(t[0],t[1],t[2],t[3]);case"ComponentsConfiguration":return this.stringValues[e][t[0]]+this.stringValues[e][t[1]]+this.stringValues[e][t[2]]+this.stringValues[e][t[3]];case"GPSVersionID":return t[0]+"."+t[1]+"."+t[2]+"."+t[3]}return String(t)},function(e){var t,i=e.tags,a=e.map;for(t in i)i.hasOwnProperty(t)&&(a[i[t]]=t)}(e.ExifMap.prototype),e.ExifMap.prototype.getAll=function(){var e,t,i={};for(e in this)this.hasOwnProperty(e)&&(t=this.tags[e],t&&(i[t]=this.getText(t)));return i}});
//# source MappingURL=load-image.all.min.js.map;
!function(t){"use strict";var e=t.HTMLCanvasElement&&t.HTMLCanvasElement.prototype,o=t.Blob&&function(){try{return Boolean(new Blob)}catch(t){return!1}}(),n=o&&t.Uint8Array&&function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch(t){return!1}}(),r=t.BlobBuilder||t.WebKitBlobBuilder||t.MozBlobBuilder||t.MSBlobBuilder,a=/^data:((.*?)(;charset=.*?)?)(;base64)?,/,i=(o||r)&&t.atob&&t.ArrayBuffer&&t.Uint8Array&&function(t){var e,i,l,u,b,c,d,B,f;if(e=t.match(a),!e)throw new Error("invalid data URI");for(i=e[2]?e[1]:"text/plain"+(e[3]||";charset=US-ASCII"),l=!!e[4],u=t.slice(e[0].length),b=l?atob(u):decodeURIComponent(u),c=new ArrayBuffer(b.length),d=new Uint8Array(c),B=0;B<b.length;B+=1)d[B]=b.charCodeAt(B);return o?new Blob([n?d:c],{type:i}):(f=new r,f.append(c),f.getBlob(i))};t.HTMLCanvasElement&&!e.toBlob&&(e.mozGetAsFile?e.toBlob=function(t,o,n){t(n&&e.toDataURL&&i?i(this.toDataURL(o,n)):this.mozGetAsFile("blob",o))}:e.toDataURL&&i&&(e.toBlob=function(t,e,o){t(i(this.toDataURL(e,o)))})),"function"==typeof define&&define.amd?define(function(){return i}):"object"==typeof module&&module.exports?module.exports=i:t.dataURLtoBlob=i}(window);
//# source MappingURL=canvas-to-blob.min.js.map;
(function(b){"function"===typeof define&&define.amd?define(["jquery"],b):"object"===typeof exports?b(require("jquery")):b(window.jQuery)})(function(b){var h=0;b.ajaxTransport("iframe",function(a){if(a.async){var g=a.initialIframeSrc||"javascript:false;",c,d,e;return{send:function(l,k){c=b('<form style="display:none;"></form>');c.attr("accept-charset",a.formAcceptCharset);e=/\?/.test(a.url)?"&":"?";"DELETE"===a.type?(a.url=a.url+e+"_method=DELETE",a.type="POST"):"PUT"===a.type?(a.url=a.url+e+"_method=PUT",
a.type="POST"):"PATCH"===a.type&&(a.url=a.url+e+"_method=PATCH",a.type="POST");h+=1;d=b('<iframe src="'+g+'" name="iframe-transport-'+h+'"></iframe>').bind("load",function(){var e=b.isArray(a.paramName)?a.paramName:[a.paramName];d.unbind("load").bind("load",function(){try{var a=d.contents();if(!a.length||!a[0].firstChild)throw Error();}catch(m){a=void 0}k(200,"success",{iframe:a});b('<iframe src="'+g+'"></iframe>').appendTo(c);window.setTimeout(function(){c.remove()},0)});c.prop("target",d.prop("name")).prop("action",
a.url).prop("method",a.type);a.formData&&b.each(a.formData,function(a,d){b('<input type="hidden"/>').prop("name",d.name).val(d.value).appendTo(c)});if(a.fileInput&&a.fileInput.length&&"POST"===a.type){var f=a.fileInput.clone();a.fileInput.after(function(a){return f[a]});a.paramName&&a.fileInput.each(function(c){b(this).prop("name",e[c]||a.paramName)});c.append(a.fileInput).prop("enctype","multipart/form-data").prop("encoding","multipart/form-data");a.fileInput.removeAttr("form")}c.submit();f&&f.length&&
a.fileInput.each(function(a,c){a=b(f[a]);b(c).prop("name",a.prop("name")).attr("form",a.attr("form"));a.replaceWith(c)})});c.append(d).appendTo(document.body)},abort:function(){d&&d.unbind("load").prop("src",g);c&&c.remove()}}}});b.ajaxSetup({converters:{"iframe text":function(a){return a&&b(a[0].body).text()},"iframe json":function(a){return a&&b.parseJSON(b(a[0].body).text())},"iframe html":function(a){return a&&b(a[0].body).html()},"iframe xml":function(a){return(a=a&&a[0])&&b.isXMLDoc(a)?a:b.parseXML(a.XMLDocument&&
a.XMLDocument.xml||b(a.body).html())},"iframe script":function(a){return a&&b.globalEval(b(a[0].body).text())}}})});
;
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(c,h,a){c instanceof String&&(c=String(c));for(var b=c.length,d=0;d<b;d++){var e=c[d];if(h.call(a,e,d,c))return{i:d,v:e}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(c,h,a){c!=Array.prototype&&c!=Object.prototype&&(c[h]=a.value)};$jscomp.getGlobal=function(c){c=["object"==typeof globalThis&&globalThis,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,c];for(var h=0;h<c.length;++h){var a=c[h];if(a&&a.Math==Math)return a}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(c,h,a,b){if(h){a=$jscomp.global;c=c.split(".");for(b=0;b<c.length-1;b++){var d=c[b];d in a||(a[d]={});a=a[d]}c=c[c.length-1];b=a[c];h=h(b);h!=b&&null!=h&&$jscomp.defineProperty(a,c,{configurable:!0,writable:!0,value:h})}};$jscomp.polyfill("Array.prototype.find",function(c){return c?c:function(c,a){return $jscomp.findInternal(this,c,a).v}},"es6","es3");
(function(c){"function"===typeof define&&define.amd?define(["jquery","jquery.ui.widget"],c):"object"===typeof exports?c(require("jquery"),require("./vendor/jquery.ui.widget")):c(window.jQuery)})(function(c){function h(a){var b="dragover"===a;return function(d){d.dataTransfer=d.originalEvent&&d.originalEvent.dataTransfer;var e=d.dataTransfer;e&&-1!==c.inArray("Files",e.types)&&!1!==this._trigger(a,c.Event(a,{delegatedEvent:d}))&&(d.preventDefault(),b&&(e.dropEffect="copy"))}}c.support.fileInput=!(/(Android (1\.[0156]|2\.[01]))|(Windows Phone (OS 7|8\.0))|(XBLWP)|(ZuneWP)|(WPDesktop)|(w(eb)?OSBrowser)|(webOS)|(Kindle\/(1\.0|2\.[05]|3\.0))/.test(window.navigator.userAgent)||
c('<input type="file">').prop("disabled"));c.support.xhrFileUpload=!(!window.ProgressEvent||!window.FileReader);c.support.xhrFormDataFileUpload=!!window.FormData;c.support.blobSlice=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice);c.widget("blueimp.fileupload",{options:{dropZone:c(document),pasteZone:void 0,fileInput:void 0,replaceFileInput:!0,paramName:void 0,singleFileUploads:!0,limitMultiFileUploads:void 0,limitMultiFileUploadSize:void 0,limitMultiFileUploadSizeOverhead:512,
sequentialUploads:!1,limitConcurrentUploads:void 0,forceIframeTransport:!1,redirect:void 0,redirectParamName:void 0,postMessage:void 0,multipart:!0,maxChunkSize:void 0,uploadedBytes:void 0,recalculateProgress:!0,progressInterval:100,bitrateInterval:500,autoUpload:!0,messages:{uploadedBytes:"Uploaded bytes exceed file size"},i18n:function(a,b){a=this.messages[a]||a.toString();b&&c.each(b,function(b,c){a=a.replace("{"+b+"}",c)});return a},formData:function(a){return a.serializeArray()},add:function(a,
b){if(a.isDefaultPrevented())return!1;(b.autoUpload||!1!==b.autoUpload&&c(this).fileupload("option","autoUpload"))&&b.process().done(function(){b.submit()})},processData:!1,contentType:!1,cache:!1,timeout:0},_specialOptions:["fileInput","dropZone","pasteZone","multipart","forceIframeTransport"],_blobSlice:c.support.blobSlice&&function(){return(this.slice||this.webkitSlice||this.mozSlice).apply(this,arguments)},_BitrateTimer:function(){this.timestamp=Date.now?Date.now():(new Date).getTime();this.bitrate=
this.loaded=0;this.getBitrate=function(a,b,d){var c=a-this.timestamp;if(!this.bitrate||!d||c>d)this.bitrate=1E3/c*(b-this.loaded)*8,this.loaded=b,this.timestamp=a;return this.bitrate}},_isXHRUpload:function(a){return!a.forceIframeTransport&&(!a.multipart&&c.support.xhrFileUpload||c.support.xhrFormDataFileUpload)},_getFormData:function(a){if("function"===c.type(a.formData))return a.formData(a.form);if(c.isArray(a.formData))return a.formData;if("object"===c.type(a.formData)){var b=[];c.each(a.formData,
function(a,c){b.push({name:a,value:c})});return b}return[]},_getTotal:function(a){var b=0;c.each(a,function(a,c){b+=c.size||1});return b},_initProgressObject:function(a){var b={loaded:0,total:0,bitrate:0};a._progress?c.extend(a._progress,b):a._progress=b},_initResponseObject:function(a){var b;if(a._response)for(b in a._response)a._response.hasOwnProperty(b)&&delete a._response[b];else a._response={}},_onProgress:function(a,b){if(a.lengthComputable){var d=Date.now?Date.now():(new Date).getTime();if(!(b._time&&
b.progressInterval&&d-b._time<b.progressInterval&&a.loaded!==a.total)){b._time=d;var e=Math.floor(a.loaded/a.total*(b.chunkSize||b._progress.total))+(b.uploadedBytes||0);this._progress.loaded+=e-b._progress.loaded;this._progress.bitrate=this._bitrateTimer.getBitrate(d,this._progress.loaded,b.bitrateInterval);b._progress.loaded=b.loaded=e;b._progress.bitrate=b.bitrate=b._bitrateTimer.getBitrate(d,e,b.bitrateInterval);this._trigger("progress",c.Event("progress",{delegatedEvent:a}),b);this._trigger("progressall",
c.Event("progressall",{delegatedEvent:a}),this._progress)}}},_initProgressListener:function(a){var b=this,d=a.xhr?a.xhr():c.ajaxSettings.xhr();d.upload&&(c(d.upload).bind("progress",function(d){var c=d.originalEvent;d.lengthComputable=c.lengthComputable;d.loaded=c.loaded;d.total=c.total;b._onProgress(d,a)}),a.xhr=function(){return d})},_isInstanceOf:function(a,b){return Object.prototype.toString.call(b)==="[object "+a+"]"},_initXHRData:function(a){var b=this,d=a.files[0],e=a.multipart||!c.support.xhrFileUpload,
f="array"===c.type(a.paramName)?a.paramName[0]:a.paramName;a.headers=c.extend({},a.headers);a.contentRange&&(a.headers["Content-Range"]=a.contentRange);e&&!a.blob&&this._isInstanceOf("File",d)||(a.headers["Content-Disposition"]='attachment; filename="'+encodeURI(d.name)+'"');if(!e)a.contentType=d.type||"application/octet-stream",a.data=a.blob||d;else if(c.support.xhrFormDataFileUpload){if(a.postMessage){var g=this._getFormData(a);a.blob?g.push({name:f,value:a.blob}):c.each(a.files,function(b,d){g.push({name:"array"===
c.type(a.paramName)&&a.paramName[b]||f,value:d})})}else b._isInstanceOf("FormData",a.formData)?g=a.formData:(g=new FormData,c.each(this._getFormData(a),function(a,b){g.append(b.name,b.value)})),a.blob?g.append(f,a.blob,d.name):c.each(a.files,function(d,e){(b._isInstanceOf("File",e)||b._isInstanceOf("Blob",e))&&g.append("array"===c.type(a.paramName)&&a.paramName[d]||f,e,e.uploadName||e.name)});a.data=g}a.blob=null},_initIframeSettings:function(a){var b=c("<a></a>").prop("href",a.url).prop("host");
a.dataType="iframe "+(a.dataType||"");a.formData=this._getFormData(a);a.redirect&&b&&b!==location.host&&a.formData.push({name:a.redirectParamName||"redirect",value:a.redirect})},_initDataSettings:function(a){this._isXHRUpload(a)?(this._chunkedUpload(a,!0)||(a.data||this._initXHRData(a),this._initProgressListener(a)),a.postMessage&&(a.dataType="postmessage "+(a.dataType||""))):this._initIframeSettings(a)},_getParamName:function(a){var b=c(a.fileInput),d=a.paramName;d?c.isArray(d)||(d=[d]):(d=[],b.each(function(){var a=
c(this),b=a.prop("name")||"files[]";for(a=(a.prop("files")||[1]).length;a;)d.push(b),--a}),d.length||(d=[b.prop("name")||"files[]"]));return d},_initFormSettings:function(a){a.form&&a.form.length||(a.form=c(a.fileInput.prop("form")),a.form.length||(a.form=c(this.options.fileInput.prop("form"))));a.paramName=this._getParamName(a);a.url||(a.url=a.form.prop("action")||location.href);a.type=(a.type||"string"===c.type(a.form.prop("method"))&&a.form.prop("method")||"").toUpperCase();"POST"!==a.type&&"PUT"!==
a.type&&"PATCH"!==a.type&&(a.type="POST");a.formAcceptCharset||(a.formAcceptCharset=a.form.attr("accept-charset"))},_getAJAXSettings:function(a){a=c.extend({},this.options,a);this._initFormSettings(a);this._initDataSettings(a);return a},_getDeferredState:function(a){return a.state?a.state():a.isResolved()?"resolved":a.isRejected()?"rejected":"pending"},_enhancePromise:function(a){a.success=a.done;a.error=a.fail;a.complete=a.always;return a},_getXHRPromise:function(a,b,d){var e=c.Deferred(),f=e.promise();
b=b||this.options.context||f;!0===a?e.resolveWith(b,d):!1===a&&e.rejectWith(b,d);f.abort=e.promise;return this._enhancePromise(f)},_addConvenienceMethods:function(a,b){var d=this,e=function(a){return c.Deferred().resolveWith(d,a).promise()};b.process=function(a,g){if(a||g)b._processQueue=this._processQueue=(this._processQueue||e([this])).then(function(){return b.errorThrown?c.Deferred().rejectWith(d,[b]).promise():e(arguments)}).then(a,g);return this._processQueue||e([this])};b.submit=function(){"pending"!==
this.state()&&(b.jqXHR=this.jqXHR=!1!==d._trigger("submit",c.Event("submit",{delegatedEvent:a}),this)&&d._onSend(a,this));return this.jqXHR||d._getXHRPromise()};b.abort=function(){if(this.jqXHR)return this.jqXHR.abort();this.errorThrown="abort";d._trigger("fail",null,this);return d._getXHRPromise(!1)};b.state=function(){if(this.jqXHR)return d._getDeferredState(this.jqXHR);if(this._processQueue)return d._getDeferredState(this._processQueue)};b.processing=function(){return!this.jqXHR&&this._processQueue&&
"pending"===d._getDeferredState(this._processQueue)};b.progress=function(){return this._progress};b.response=function(){return this._response}},_getUploadedBytes:function(a){return(a=(a=(a=a.getResponseHeader("Range"))&&a.split("-"))&&1<a.length&&parseInt(a[1],10))&&a+1},_chunkedUpload:function(a,b){a.uploadedBytes=a.uploadedBytes||0;var d=this,e=a.files[0],f=e.size,g=a.uploadedBytes,u=a.maxChunkSize||f,k=this._blobSlice,m=c.Deferred(),n=m.promise(),l;if(!(this._isXHRUpload(a)&&k&&(g||u<f))||a.data)return!1;
if(b)return!0;if(g>=f)return e.error=a.i18n("uploadedBytes"),this._getXHRPromise(!1,a.context,[null,"error",e.error]);var h=function(){var b=c.extend({},a),n=b._progress.loaded;b.blob=k.call(e,g,g+u,e.type);b.chunkSize=b.blob.size;b.contentRange="bytes "+g+"-"+(g+b.chunkSize-1)+"/"+f;d._initXHRData(b);d._initProgressListener(b);l=(!1!==d._trigger("chunksend",null,b)&&c.ajax(b)||d._getXHRPromise(!1,b.context)).done(function(e,k,l){g=d._getUploadedBytes(l)||g+b.chunkSize;n+b.chunkSize-b._progress.loaded&&
d._onProgress(c.Event("progress",{lengthComputable:!0,loaded:g-b.uploadedBytes,total:g-b.uploadedBytes}),b);a.uploadedBytes=b.uploadedBytes=g;b.result=e;b.textStatus=k;b.jqXHR=l;d._trigger("chunkdone",null,b);d._trigger("chunkalways",null,b);g<f?h():m.resolveWith(b.context,[e,k,l])}).fail(function(a,c,e){b.jqXHR=a;b.textStatus=c;b.errorThrown=e;d._trigger("chunkfail",null,b);d._trigger("chunkalways",null,b);m.rejectWith(b.context,[a,c,e])})};this._enhancePromise(n);n.abort=function(){return l.abort()};
h();return n},_beforeSend:function(a,b){0===this._active&&(this._trigger("start"),this._bitrateTimer=new this._BitrateTimer,this._progress.loaded=this._progress.total=0,this._progress.bitrate=0);this._initResponseObject(b);this._initProgressObject(b);b._progress.loaded=b.loaded=b.uploadedBytes||0;b._progress.total=b.total=this._getTotal(b.files)||1;b._progress.bitrate=b.bitrate=0;this._active+=1;this._progress.loaded+=b.loaded;this._progress.total+=b.total},_onDone:function(a,b,d,e){var f=e._progress.total,
g=e._response;e._progress.loaded<f&&this._onProgress(c.Event("progress",{lengthComputable:!0,loaded:f,total:f}),e);g.result=e.result=a;g.textStatus=e.textStatus=b;g.jqXHR=e.jqXHR=d;this._trigger("done",null,e)},_onFail:function(a,b,d,c){var e=c._response;c.recalculateProgress&&(this._progress.loaded-=c._progress.loaded,this._progress.total-=c._progress.total);e.jqXHR=c.jqXHR=a;e.textStatus=c.textStatus=b;e.errorThrown=c.errorThrown=d;this._trigger("fail",null,c)},_onAlways:function(a,b,c,e){this._trigger("always",
null,e)},_onSend:function(a,b){b.submit||this._addConvenienceMethods(a,b);var d=this,e,f,g=d._getAJAXSettings(b),h=function(){d._sending+=1;g._bitrateTimer=new d._BitrateTimer;return e=e||((f||!1===d._trigger("send",c.Event("send",{delegatedEvent:a}),g))&&d._getXHRPromise(!1,g.context,f)||d._chunkedUpload(g)||c.ajax(g)).done(function(a,b,c){d._onDone(a,b,c,g)}).fail(function(a,b,c){d._onFail(a,b,c,g)}).always(function(a,b,c){d._onAlways(a,b,c,g);--d._sending;--d._active;if(g.limitConcurrentUploads&&
g.limitConcurrentUploads>d._sending)for(a=d._slots.shift();a;){if("pending"===d._getDeferredState(a)){a.resolve();break}a=d._slots.shift()}0===d._active&&d._trigger("stop")})};this._beforeSend(a,g);if(this.options.sequentialUploads||this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending){if(1<this.options.limitConcurrentUploads){var k=c.Deferred();this._slots.push(k);b=k.then(h)}else b=this._sequence=this._sequence.then(h,h);b.abort=function(){f=[void 0,"abort","abort"];
return e?e.abort():(k&&k.rejectWith(g.context,f),h())};return this._enhancePromise(b)}return h()},_onAdd:function(a,b){var d=this,e=!0,f=c.extend({},this.options,b),g=b.files,h=g.length,k=f.limitMultiFileUploads,m=f.limitMultiFileUploadSize,n=f.limitMultiFileUploadSizeOverhead,l=0,r=this._getParamName(f),t=0;if(!h)return!1;m&&void 0===g[0].size&&(m=void 0);if((f.singleFileUploads||k||m)&&this._isXHRUpload(f))if(f.singleFileUploads||m||!k)if(!f.singleFileUploads&&m){var p=[];var q=[];for(f=0;f<h;f+=
1)if(l+=g[f].size+n,f+1===h||l+g[f+1].size+n>m||k&&f+1-t>=k)p.push(g.slice(t,f+1)),l=r.slice(t,f+1),l.length||(l=r),q.push(l),t=f+1,l=0}else q=r;else for(p=[],q=[],f=0;f<h;f+=k)p.push(g.slice(f,f+k)),l=r.slice(f,f+k),l.length||(l=r),q.push(l);else p=[g],q=[r];b.originalFiles=g;c.each(p||g,function(f,g){var h=c.extend({},b);h.files=p?g:[g];h.paramName=q[f];d._initResponseObject(h);d._initProgressObject(h);d._addConvenienceMethods(a,h);return e=d._trigger("add",c.Event("add",{delegatedEvent:a}),h)});
return e},_replaceFileInput:function(a){var b=a.fileInput,d=b.clone(!0),e=b.is(document.activeElement);a.fileInputClone=d;c("<form></form>").append(d)[0].reset();b.after(d).detach();e&&d.focus();c.cleanData(b.unbind("remove"));this.options.fileInput=this.options.fileInput.map(function(a,c){return c===b[0]?d[0]:c});b[0]===this.element[0]&&(this.element=d)},_handleFileTreeEntry:function(a,b){var d=this,e=c.Deferred(),f=function(b){b&&!b.entry&&(b.entry=a);e.resolve([b])},g=function(c){d._handleFileTreeEntries(c,
b+a.name+"/").done(function(a){e.resolve(a)}).fail(f)},h=function(){m.readEntries(function(a){a.length?(k=k.concat(a),h()):g(k)},f)},k=[];b=b||"";if(a.isFile)a._file?(a._file.relativePath=b,e.resolve(a._file)):a.file(function(a){a.relativePath=b;e.resolve(a)},f);else if(a.isDirectory){var m=a.createReader();h()}else e.resolve([]);return e.promise()},_handleFileTreeEntries:function(a,b){var d=this;return c.when.apply(c,c.map(a,function(a){return d._handleFileTreeEntry(a,b)})).then(function(){return Array.prototype.concat.apply([],
arguments)})},_getDroppedFiles:function(a){a=a||{};var b=a.items;return b&&b.length&&(b[0].webkitGetAsEntry||b[0].getAsEntry)?this._handleFileTreeEntries(c.map(b,function(a){var b;if(a.webkitGetAsEntry){if(b=a.webkitGetAsEntry())b._file=a.getAsFile();return b}return a.getAsEntry()})):c.Deferred().resolve(c.makeArray(a.files)).promise()},_getSingleFileInputFiles:function(a){a=c(a);var b=[];if(b&&b.length)return this._handleFileTreeEntries(b);b=c.makeArray(a.prop("files"));if(b.length)void 0===b[0].name&&
b[0].fileName&&c.each(b,function(a,b){b.name=b.fileName;b.size=b.fileSize});else{a=a.prop("value");if(!a)return c.Deferred().resolve([]).promise();b=[{name:a.replace(/^.*\\/,"")}]}return c.Deferred().resolve(b).promise()},_getFileInputFiles:function(a){return a instanceof c&&1!==a.length?c.when.apply(c,c.map(a,this._getSingleFileInputFiles)).then(function(){return Array.prototype.concat.apply([],arguments)}):this._getSingleFileInputFiles(a)},_onChange:function(a){var b=this,d={fileInput:c(a.target),
form:c(a.target.form)};this._getFileInputFiles(d.fileInput).always(function(e){d.files=e;b.options.replaceFileInput&&b._replaceFileInput(d);!1!==b._trigger("change",c.Event("change",{delegatedEvent:a}),d)&&b._onAdd(a,d)})},_onPaste:function(a){var b=a.originalEvent&&a.originalEvent.clipboardData&&a.originalEvent.clipboardData.items,d={files:[]};b&&b.length&&(c.each(b,function(a,b){(a=b.getAsFile&&b.getAsFile())&&d.files.push(a)}),!1!==this._trigger("paste",c.Event("paste",{delegatedEvent:a}),d)&&
this._onAdd(a,d))},_onDrop:function(a){a.dataTransfer=a.originalEvent&&a.originalEvent.dataTransfer;var b=this,d=a.dataTransfer,e={};d&&d.files&&d.files.length&&(a.preventDefault(),this._getDroppedFiles(d).always(function(d){e.files=d;!1!==b._trigger("drop",c.Event("drop",{delegatedEvent:a}),e)&&b._onAdd(a,e)}))},_onDragOver:h("dragover"),_onDragEnter:h("dragenter"),_onDragLeave:h("dragleave"),_initEventHandlers:function(){this._isXHRUpload(this.options)&&(this._on(this.options.dropZone,{dragover:this._onDragOver,
drop:this._onDrop,dragenter:this._onDragEnter,dragleave:this._onDragLeave}),this._on(this.options.pasteZone,{paste:this._onPaste}));c.support.fileInput&&this._on(this.options.fileInput,{change:this._onChange})},_destroyEventHandlers:function(){this._off(this.options.dropZone,"dragenter dragleave dragover drop");this._off(this.options.pasteZone,"paste");this._off(this.options.fileInput,"change")},_setOption:function(a,b){var d=-1!==c.inArray(a,this._specialOptions);d&&this._destroyEventHandlers();
this._super(a,b);d&&(this._initSpecialOptions(),this._initEventHandlers())},_initSpecialOptions:function(){var a=this.options;void 0===a.fileInput?a.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]'):a.fileInput instanceof c||(a.fileInput=c(a.fileInput));a.dropZone instanceof c||(a.dropZone=c(a.dropZone));a.pasteZone instanceof c||(a.pasteZone=c(a.pasteZone))},_getRegExp:function(a){a=a.split("/");var b=a.pop();a.shift();return new RegExp(a.join("/"),
b)},_isRegExpOption:function(a,b){return"url"!==a&&"string"===c.type(b)&&/^\/.*\/[igm]{0,3}$/.test(b)},_initDataAttributes:function(){var a=this,b=this.options,d=this.element.data();c.each(this.element[0].attributes,function(c,f){c=f.name.toLowerCase();/^data-/.test(c)&&(c=c.slice(5).replace(/-[a-z]/g,function(a){return a.charAt(1).toUpperCase()}),f=d[c],a._isRegExpOption(c,f)&&(f=a._getRegExp(f)),b[c]=f)})},_create:function(){this._initDataAttributes();this._initSpecialOptions();this._slots=[];this._sequence=
this._getXHRPromise(!0);this._sending=this._active=0;this._initProgressObject(this);this._initEventHandlers()},active:function(){return this._active},progress:function(){return this._progress},add:function(a){var b=this;a&&!this.options.disabled&&(a.fileInput&&!a.files?this._getFileInputFiles(a.fileInput).always(function(c){a.files=c;b._onAdd(null,a)}):(a.files=c.makeArray(a.files),this._onAdd(null,a)))},send:function(a){if(a&&!this.options.disabled){if(a.fileInput&&!a.files){var b=this,d=c.Deferred(),
e=d.promise(),f,g;e.abort=function(){g=!0;if(f)return f.abort();d.reject(null,"abort","abort");return e};this._getFileInputFiles(a.fileInput).always(function(c){g||(c.length?(a.files=c,f=b._onSend(null,a),f.then(function(a,b,c){d.resolve(a,b,c)},function(a,b,c){d.reject(a,b,c)})):d.reject())});return this._enhancePromise(e)}a.files=c.makeArray(a.files);if(a.files.length)return this._onSend(null,a)}return this._getXHRPromise(!1,a&&a.context)}})});
;
(function(d){"function"===typeof define&&define.amd?define(["jquery","./jquery.fileupload"],d):"object"===typeof exports?d(require("jquery")):d(window.jQuery)})(function(d){var h=d.blueimp.fileupload.prototype.options.add;d.widget("blueimp.fileupload",d.blueimp.fileupload,{options:{processQueue:[],add:function(a,b){var c=d(this);b.process(function(){return c.fileupload("process",b)});h.call(this,a,b)}},processActions:{},_processFile:function(a,b){var c=this,e=d.Deferred().resolveWith(c,[a]).promise();
this._trigger("process",null,a);d.each(a.processQueue,function(a,f){a=function(a){return b.errorThrown?d.Deferred().rejectWith(c,[b]).promise():c.processActions[f.action].call(c,a,f)};e=e.then(a,f.always&&a)});e.done(function(){c._trigger("processdone",null,a);c._trigger("processalways",null,a)}).fail(function(){c._trigger("processfail",null,a);c._trigger("processalways",null,a)});return e},_transformProcessQueue:function(a){var b=[];d.each(a.processQueue,function(){var c={},e=this.action,g=!0===
this.prefix?e:this.prefix;d.each(this,function(b,e){"string"===d.type(e)&&"@"===e.charAt(0)?c[b]=a[e.slice(1)||(g?g+b.charAt(0).toUpperCase()+b.slice(1):b)]:c[b]=e});b.push(c)});a.processQueue=b},processing:function(){return this._processing},process:function(a){var b=this,c=d.extend({},this.options,a);c.processQueue&&c.processQueue.length&&(this._transformProcessQueue(c),0===this._processing&&this._trigger("processstart"),d.each(a.files,function(e){var g=e?d.extend({},c):c,f=function(){return a.errorThrown?
d.Deferred().rejectWith(b,[a]).promise():b._processFile(g,a)};g.index=e;b._processing+=1;b._processingQueue=b._processingQueue.then(f,f).always(function(){--b._processing;0===b._processing&&b._trigger("processstop")})}));return this._processingQueue},_create:function(){this._super();this._processing=0;this._processingQueue=d.Deferred().resolveWith(this).promise()}})});
;
(function(c){"function"===typeof define&&define.amd?define("jquery load-image load-image-meta load-image-exif canvas-to-blob ./jquery.fileupload-process".split(" "),c):"object"===typeof exports?c(require("jquery"),require("blueimp-load-image/js/load-image"),require("blueimp-load-image/js/load-image-meta"),require("blueimp-load-image/js/load-image-exif"),require("blueimp-canvas-to-blob"),require("./jquery.fileupload-process")):c(window.jQuery,window.loadImage)})(function(c,g){c.blueimp.fileupload.prototype.options.processQueue.unshift({action:"loadImageMetaData",
disableImageHead:"@",disableExif:"@",disableExifThumbnail:"@",disableExifSub:"@",disableExifGps:"@",disabled:"@disableImageMetaDataLoad"},{action:"loadImage",prefix:!0,fileTypes:"@",maxFileSize:"@",noRevoke:"@",disabled:"@disableImageLoad"},{action:"resizeImage",prefix:"image",maxWidth:"@",maxHeight:"@",minWidth:"@",minHeight:"@",crop:"@",orientation:"@",forceResize:"@",disabled:"@disableImageResize"},{action:"saveImage",quality:"@imageQuality",type:"@imageType",disabled:"@disableImageResize"},{action:"saveImageMetaData",
disabled:"@disableImageMetaDataSave"},{action:"resizeImage",prefix:"preview",maxWidth:"@",maxHeight:"@",minWidth:"@",minHeight:"@",crop:"@",orientation:"@",thumbnail:"@",canvas:"@",disabled:"@disableImagePreview"},{action:"setImage",name:"@imagePreviewName",disabled:"@disableImagePreview"},{action:"deleteImageReferences",disabled:"@disableImageReferencesDeletion"});c.widget("blueimp.fileupload",c.blueimp.fileupload,{options:{loadImageFileTypes:/^image\/(gif|jpeg|png|svg\+xml)$/,loadImageMaxFileSize:1E7,
imageMaxWidth:1920,imageMaxHeight:1080,imageOrientation:!1,imageCrop:!1,disableImageResize:!0,previewMaxWidth:80,previewMaxHeight:80,previewOrientation:!0,previewThumbnail:!0,previewCrop:!1,previewCanvas:!0},processActions:{loadImage:function(a,b){if(b.disabled)return a;var f=this,d=a.files[a.index],e=c.Deferred();return"number"===c.type(b.maxFileSize)&&d.size>b.maxFileSize||b.fileTypes&&!b.fileTypes.test(d.type)||!g(d,function(b){b.src&&(a.img=b);e.resolveWith(f,[a])},b)?a:e.promise()},resizeImage:function(a,
b){if(b.disabled||!a.canvas&&!a.img)return a;b=c.extend({canvas:!0},b);var f=this,d=c.Deferred(),e=b.canvas&&a.canvas||a.img,h=function(c){c&&(c.width!==e.width||c.height!==e.height||b.forceResize)&&(a[c.getContext?"canvas":"img"]=c);a.preview=c;d.resolveWith(f,[a])},k;if(a.exif){!0===b.orientation&&(b.orientation=a.exif.get("Orientation"));if(b.thumbnail&&(k=a.exif.get("Thumbnail")))return g(k,h,b),d.promise();a.orientation?delete b.orientation:a.orientation=b.orientation}return e?(h(g.scale(e,b)),
d.promise()):a},saveImage:function(a,b){if(!a.canvas||b.disabled)return a;var f=this,d=a.files[a.index],e=c.Deferred();if(a.canvas.toBlob)a.canvas.toBlob(function(b){b.name||(d.type===b.type?b.name=d.name:d.name&&(b.name=d.name.replace(/\.\w+$/,"."+b.type.substr(6))));d.type!==b.type&&delete a.imageHead;a.files[a.index]=b;e.resolveWith(f,[a])},b.type||d.type,b.quality);else return a;return e.promise()},loadImageMetaData:function(a,b){if(b.disabled)return a;var f=this,d=c.Deferred();g.parseMetaData(a.files[a.index],
function(b){c.extend(a,b);d.resolveWith(f,[a])},b);return d.promise()},saveImageMetaData:function(a,b){if(!(a.imageHead&&a.canvas&&a.canvas.toBlob)||b.disabled)return a;b=a.files[a.index];var c=new Blob([a.imageHead,this._blobSlice.call(b,20)],{type:b.type});c.name=b.name;a.files[a.index]=c;return a},setImage:function(a,b){a.preview&&!b.disabled&&(a.files[a.index][b.name||"preview"]=a.preview);return a},deleteImageReferences:function(a,b){b.disabled||(delete a.img,delete a.canvas,delete a.preview,
delete a.imageHead);return a}}})});
;
var uploadId=0;var uploadFileN=0;var jqXHR=[];var uploadFiles=[];var UPLOADER_FILE_STATUS_UNPROCESSED=1;var UPLOADER_FILE_STATUS_LAMBDA_PROCESSED_SUCCESS=5;var UPLOADER_FILE_STATUS_PROCESSED_SUCCESS=2;var UPLOADER_FILE_STATUS_PROCESSED_FAILED=3;var UPLOADER_FILE_STATUS_PROCESSED_FAILED_COMPLETELY=6;var UPLOADER_FILE_STATUS_RELOADED=10;var progressStatus=0;var fileUploadDataLoaded=0;var fileUploadDataTotal=0;var processUploadedFileAjaxRequestAborted=false;var s3RetryTimers=[];
var lambdaRetryTimers=[];var uploaderRetryTimers=[];var failedUploadsDuToFileSizeLimitInFreeVersion=[];var lambdaMaxWidthOrHeight=2E3;var previewRendererStarted=false;var previewsFiles=[];var previews=[];
function initializeStandardUploader(imageFieldId,parameters){var currentUploadQuality=quality;if(!parameters.proTarget)currentUploadQuality=1;if(currentUploadQuality==1)lambdaMaxWidthOrHeight=2E3;if(currentUploadQuality==2)lambdaMaxWidthOrHeight=4E3;if(currentUploadQuality==3)lambdaMaxWidthOrHeight=7E3;var imageMaxWidthOrHeight=currentUploadQuality==1?2E3:4E3;var dropZone=null;if(!isMobileDevice){if(typeof parameters.stageId!="undefined")var dropZone=$("#"+imageFieldId).closest(".stageAddCommentBlock");
    if(typeof parameters.commentId!="undefined")var dropZone=$("#"+imageFieldId).closest(".commentWrap");if(parameters.destination==1)var dropZone=$("#"+imageFieldId).closest(".page-content")}$("#"+imageFieldId).fileupload({url:"https://uploadercliniccards.s3-accelerate.amazonaws.com",type:"post",datatype:"xml",autoUpload:true,disableImageResize:true,imageMaxWidth:imageMaxWidthOrHeight,imageMaxHeight:imageMaxWidthOrHeight,limitConcurrentUploads:5,sequentialUploads:false,dropZone:dropZone}).on("fileuploadsubmit",
    function(e,data){if(typeof data.uploadedFileN=="undefined"){try{if(s3FormDetails.inputs["Content-Type"].length===0&&/\.dcm$/i.test(data.files[0].name))s3FormDetails.inputs["Content-Type"]="application/dicom";else s3FormDetails.inputs["Content-Type"]=""}catch(e$0){s3FormDetails.inputs["Content-Type"]="";if(typeof Sentry!="undefined"&&Sentry)Sentry.captureException(e$0)}uploadFileN++;uploadFiles[uploadFileN]={status:UPLOADER_FILE_STATUS_UNPROCESSED,name:data.files[0].name,size:data.files[0].size,ccAjaxRequest:false,
        tryCount:0,jqXHRData:data};$("#"+imageFieldId).fileupload("option","formData",$.extend({key:s3FormDetails.uploaderBucketDirectory+"/"+uploadId+"/"+uploadFileN},s3FormDetails.inputs))}else $("#"+imageFieldId).fileupload("option","formData",$.extend({key:s3FormDetails.uploaderBucketDirectory+"/"+uploadId+"/"+data.uploadedFileN},s3FormDetails.inputs))}).on("fileuploadadd",function(e,data){if(data.files[0]["name"].indexOf(".stl")!==-1&&data.files[0]["size"]<=64E6){previewsFiles.push(data.files[0]);runRenderer()}if(pro==
    1&&parameters.proTarget){if(data.files[0]["size"]>5E9){data.tryCount=1E3;data.abort();alert(data.files[0]["name"]+" - "+T["file must be less than X"]);return}}else{var fileIsImage=fileIsImageByExtension(data.files[0]["name"]);var allowedSize=fileIsImage?35E6:1E7;if(data.files[0]["size"]>allowedSize){data.tryCount=1E3;failedUploadsDuToFileSizeLimitInFreeVersion.push(data.files[0].name);data.abort();return}}jqXHR.push(data);$(".progress-bar").parent().removeClass("progress-striped active");$(".progress").show();
    $(".progress-bar").css("width","0%");$("#uploadedImages").html("");$("#closeImageUploadModal").show();$("#imageUploaderImage").removeClass("imageUploaderProgressColor1 imageUploaderProgressColor2 imageUploaderProgressColor3").addClass("imageUploaderProgressColor"+currentUploadQuality).modal("show")}).on("fileuploadprogressall",function(e,data){updateUploadProgress(data)}).on("fileuploaddone",function(e,data){var original=data.files[0];var s3Result=data.result.documentElement.children;if(typeof s3Result==
    "undefined")s3Result=data.result.documentElement.childNodes;var s3_key=s3Result[2].innerHTML;var uploadMetadata=JSON.stringify($.extend({uploadId:uploadId,"original_name":original.name,"s3_key":s3_key},parameters));var uploadedFileN=s3Result[2].innerHTML.split("/")[2];var fileIsImage=fileIsImageByExtension(original.name);data.jqXHRStatus="success";if(typeof uploadFiles[uploadedFileN]!="undefined"){uploadFiles[uploadedFileN].uploadMetadata=uploadMetadata;uploadFiles[uploadedFileN].lambdaResponse="";
    uploadFiles[uploadedFileN].tryCount=0;if(fileIsImage)uploadFiles[uploadedFileN].lambdaRequest=lambdaCropRequest(uploadedFileN);else uploadFiles[uploadedFileN].ccAjaxRequest=ajaxFileUploaderRequest(uploadedFileN)}}).on("fileuploadfail",function(e,data){data.jqXHRStatus="fail";if(typeof data.tryCount=="undefined"||data.tryCount<4){if(typeof data.tryCount=="undefined"){data.tryCount=1;for(var k in uploadFiles)if(uploadFiles[k].name==data.files[0].name){data.uploadedFileN=k;break}}else data.tryCount++;
    s3RetryTimers.push(setTimeout(function(){data.submit()},3E3))}else{for(var k in uploadFiles)if(uploadFiles[k].name==data.files[0].name)uploadFiles[k].status=UPLOADER_FILE_STATUS_PROCESSED_FAILED;endUploadIfFinished()}}).prop("disabled",!$.support.fileInput).parent().addClass($.support.fileInput?undefined:"disabled")}
function lambdaCropRequest(uploadedFileN){AWS.config.region="eu-central-1";AWS.config.credentials=new AWS.CognitoIdentityCredentials({IdentityPoolId:"eu-central-1:6dfce518-a03c-487e-a34b-3d499c449a18"});var lambda=new AWS.Lambda({region:"eu-central-1",apiVersion:"2015-03-31"});var pullParams={FunctionName:"go-test",InvocationType:"RequestResponse",LogType:"None",Payload:JSON.stringify({"maxWidthOrHeight":lambdaMaxWidthOrHeight,"file":"/"+s3FormDetails.uploaderBucketDirectory+"/"+uploadId+"/"+uploadedFileN})};
    return lambda.invoke(pullParams,function(error,data){if(error){var signatureExpired=error.message.indexOf("Signature expired")!==-1||error.message.indexOf("Signature not yet current")!==-1;if(signatureExpired){alert(T["Set correct time and timezone"]);$("#closeImageUploadModal").trigger("click");return}if(processUploadedFileAjaxRequestAborted)return;uploadFiles[uploadedFileN].tryCount++;if(uploadFiles[uploadedFileN].tryCount<=7)lambdaRetryTimers.push(setTimeout(function(){uploadFiles[uploadedFileN].lambdaRequest=
        lambdaCropRequest(uploadedFileN)},2E3));else{uploadFiles[uploadedFileN].status=UPLOADER_FILE_STATUS_PROCESSED_FAILED;updateUploadProgress();endUploadIfFinished()}}else{var lambdaFunctionResponse=JSON.parse(data.Payload);if(typeof lambdaFunctionResponse!="undefined"&&typeof lambdaFunctionResponse.success!="undefined"&&lambdaFunctionResponse.success===true){uploadFiles[uploadedFileN].status=UPLOADER_FILE_STATUS_LAMBDA_PROCESSED_SUCCESS;uploadFiles[uploadedFileN].lambdaResponse=data;uploadFiles[uploadedFileN].ccAjaxRequest=
        ajaxFileUploaderRequest(uploadedFileN)}else{uploadFiles[uploadedFileN].status=UPLOADER_FILE_STATUS_PROCESSED_FAILED_COMPLETELY;updateUploadProgress();endUploadIfFinished()}}})}
function ajaxFileUploaderRequest(uploadedFileN){var file=uploadFiles[uploadedFileN];var fileSize=file.size;var fileName=file.name;var preview=null;if($.active>9||fileName.indexOf(".stl")!==-1&&fileSize<=64E6&&previews[fileName]===undefined){setTimeout(function(){ajaxFileUploaderRequest(uploadedFileN)},1E3);return}if(previews[fileName]!=="error")preview=previews[fileName];return $.ajax({url:"/cabinet/uploader",data:{uploadMetadata:uploadFiles[uploadedFileN].uploadMetadata,currentClinicId:currentClinicId,
        lambdaResponse:uploadFiles[uploadedFileN].lambdaResponse,preview:preview},type:"POST",timeout:1E3*60*20,error:function(request,error){if(processUploadedFileAjaxRequestAborted)return;uploadFiles[uploadedFileN].tryCount++;if(uploadFiles[uploadedFileN].tryCount<=7)uploaderRetryTimers.push(setTimeout(function(){uploadFiles[uploadedFileN].ccAjaxRequest=ajaxFileUploaderRequest(uploadedFileN)},2E3));else{uploadFiles[uploadedFileN].status=UPLOADER_FILE_STATUS_PROCESSED_FAILED;updateUploadProgress();endUploadIfFinished()}},
    success:function(data_){if(data_==="success")uploadFiles[uploadedFileN].status=UPLOADER_FILE_STATUS_PROCESSED_SUCCESS;else uploadFiles[uploadedFileN].status=UPLOADER_FILE_STATUS_PROCESSED_FAILED_COMPLETELY;updateUploadProgress();endUploadIfFinished()}})}
function updateUploadProgress(data){if(typeof data!="undefined"){fileUploadDataLoaded=data.loaded;fileUploadDataTotal=data.total}var processedCount=0;for(var k in uploadFiles)if(uploadFiles[k].status==UPLOADER_FILE_STATUS_PROCESSED_SUCCESS)processedCount++;var totalCount=jqXHR.length;if(totalCount>7){var loadedCount=0;for(var i=0;i<jqXHR.length;i++)if(typeof jqXHR[i].jqXHR!="undefined"&&jqXHR[i].jqXHR.state()!="pending")loadedCount++;var progress=parseInt(loadedCount/totalCount*100)*.8+parseInt(processedCount/
    uploadFiles.length*100)*.2}else var progress=parseInt(fileUploadDataLoaded/fileUploadDataTotal*100,10)*.8+parseInt(processedCount/uploadFiles.length*100)*.2;if(progress>progressStatus)progressStatus=progress;else return;$(".progress-bar").css("width",progress+"%")}
function endUploadIfFinished(){setTimeout(function(){for(var k in uploadFiles)if(uploadFiles[k].status==UPLOADER_FILE_STATUS_UNPROCESSED||uploadFiles[k].status==UPLOADER_FILE_STATUS_RELOADED||uploadFiles[k].status==UPLOADER_FILE_STATUS_LAMBDA_PROCESSED_SUCCESS)return;for(var i=0;i<jqXHR.length;i++)if(typeof jqXHR[i].jqXHR=="undefined")return;var failedUploadsPossiblyBecauseofBadConnection="";var failedUploadsCompletely="";for(var k in uploadFiles){if(uploadFiles[k].status==UPLOADER_FILE_STATUS_PROCESSED_FAILED)failedUploadsPossiblyBecauseofBadConnection+=
    uploadFiles[k].name+" ";if(uploadFiles[k].status==UPLOADER_FILE_STATUS_PROCESSED_FAILED_COMPLETELY)failedUploadsCompletely+=uploadFiles[k].name+" "}if(failedUploadsDuToFileSizeLimitInFreeVersion.length)$("#someFilesWerentUploadedInFreeVersionModal .fileList").html(failedUploadsDuToFileSizeLimitInFreeVersion.join(", "));if(failedUploadsPossiblyBecauseofBadConnection!=""||failedUploadsCompletely!=""){$("#notLoadedFilesList").html(failedUploadsPossiblyBecauseofBadConnection);$("#notLoadedFilesCompletelyList").html(failedUploadsCompletely);
    if(failedUploadsPossiblyBecauseofBadConnection==""){$("#notLoadedFilesListContainer").hide();$("#reloadNotLoadedFiles").hide()}else{$("#notLoadedFilesListContainer").show();$("#reloadNotLoadedFiles").show()}if(failedUploadsCompletely=="")$("#notLoadedFilesCompletelyListContainer").hide();else $("#notLoadedFilesCompletelyListContainer").show();$("#notLoadedFilesModal").modal("show");if(failedUploadsDuToFileSizeLimitInFreeVersion.length){$("#someFilesWerentUploadedInFreeVersionModal .subscriptionLink").attr("href",
        "#subscription/index/1");$("#someFilesWerentUploadedInFreeVersionModal").modal("show")}}else{if(failedUploadsDuToFileSizeLimitInFreeVersion.length){$("#someFilesWerentUploadedInFreeVersionModal .subscriptionLink").attr("href","#subscription");$("#someFilesWerentUploadedInFreeVersionModal").modal("show")}endUpload()}},200)}
function endUpload(){$("#imageUploaderImage").modal("hide");jqXHR=[];uploadFiles=[];fileUploadDataLoaded=0;fileUploadDataTotal=0;progressStatus=0;uploaderRetryTimers=[];s3RetryTimers=[];failedUploadsDuToFileSizeLimitInFreeVersion=[];if(location.hash=="#flow")locationHashChanged(false);else{ajax({url:"/cabinet/comments/add-upload-patient-event",data:{uploadId:uploadId},success:function(data){inserCommentFromAjax(data)}});setColleaguesOnlineStatusOnPatientPage(CC_ONLINE_USER_IDS)}}
function fileIsImageByExtension(filename){var e=filename.split(".");var ext=e.pop().toLowerCase();return["jpg","jpeg","png","bmp"].indexOf(ext)!=-1&&e.length>=1}
$(document).ready(function(){$("#closeImageUploadModal").click(function(event){processUploadedFileAjaxRequestAborted=true;for(var k in s3RetryTimers)clearTimeout(s3RetryTimers[k]);s3RetryTimers=[];for(var k in uploaderRetryTimers)clearTimeout(uploaderRetryTimers[k]);uploaderRetryTimers=[];for(var k in uploadFiles)if(uploadFiles[k].ccAjaxRequest&&typeof uploadFiles[k].ccAjaxRequest!="undefined"&&typeof uploadFiles[k].ccAjaxRequest.state!="undefined")uploadFiles[k].ccAjaxRequest.abort();jqXHR=[];uploadFiles=
    [];fileUploadDataLoaded=0;fileUploadDataTotal=0;progressStatus=0;$("#closeImageUploadModal").hide();$(".progress-bar").parent().addClass("progress-striped active");$(".progress-bar").css("width",97+"%");$("#imageUploaderImage").modal("hide");for(var i=0;i<jqXHR.length;i++)jqXHR[i].abort();location.reload()});$("body").on("click",".fileinput-button",function(event){jqXHR=new Array;uploadId=Math.ceil(new Date/10);processUploadedFileAjaxRequestAborted=false});if(!isMobileDevice)$("body").on("drop",".commentWrap, .stageAddCommentBlock, .flowDropzoneWrap",
    function(event){jqXHR=new Array;uploadId=Math.ceil(new Date/10);processUploadedFileAjaxRequestAborted=false});$("body").on("click","#reloadNotLoadedFiles",function(event){$("#notLoadedFilesModal").modal("hide");for(var k in uploadFiles)if(uploadFiles[k].jqXHRData.state()!="resolved"||uploadFiles[k].status==UPLOADER_FILE_STATUS_PROCESSED_FAILED)uploadFiles[k].status=UPLOADER_FILE_STATUS_RELOADED;for(var k in uploadFiles)if(uploadFiles[k].jqXHRData.state()!="resolved"){uploadFiles[k].jqXHRData.uploadedFileN=
    k;uploadFiles[k].jqXHRData.submit()}else if(uploadFiles[k].status==UPLOADER_FILE_STATUS_RELOADED){uploadFiles[k].tryCount=0;uploadFiles[k].ccAjaxRequest=ajaxFileUploaderRequest(k)}});$("body").on("click",".closeNotLoadedFilesModal",function(event){endUpload();$("#notLoadedFilesModal").modal("hide")})});$(document).bind("drop dragover",function(e){e.preventDefault()});
$(document).bind("dragover",function(e){if(isMobileDevice)return;var dropZone=$(".commentWrap, .stageAddCommentBlock, .flowDropzoneWrap"),foundDropzone,timeout=window.dropZoneTimeout;if(!timeout)dropZone.addClass("in");else clearTimeout(timeout);var found=false,node=e.target;do{if($(node).hasClass("commentWrap")||$(node).hasClass("stageAddCommentBlock")||$(node).hasClass("flowDropzoneWrap")){found=true;foundDropzone=$(node);break}node=node.parentNode}while(node!=null);dropZone.removeClass("in hover");
    if(found)foundDropzone.addClass("hover");window.dropZoneTimeout=setTimeout(function(){window.dropZoneTimeout=null;dropZone.removeClass("in hover")},100)});function runRenderer(){if(!previewRendererStarted)renderPreviews();previewRendererStarted=true}function canvasToBase64(canvas){return canvas.toDataURL("img/png").replace(/^data:image\/\w+;base64,/,"")}
function resizeRenderer(renderer,width,height){renderer.camera.aspect=width/height;renderer.camera.updateProjectionMatrix();renderer.renderer.setSize(width,height)}
function renderPreviews(){var file=previewsFiles.shift();if(!file){previewRendererStarted=false;return}var el=document.createElement("div");var hash=(new Array(5)).join().replace(/(.|$)/g,function(){return(Math.random()*36|0).toString(36)});var id="stl-viewer-hidden"+hash;el.id=id;el.style.width="290px";el.style.height="169px";el.style.margin="0 auto";el.style.visibility="hidden";document.getElementById("main_content").append(el);new StlViewer(document.getElementById(id),{load_three_files:"c/js/stl-viewer/",
    models:[{local_file:file}],load_error_callback:function(error,state){console.log("load_error_callback");var el=document.getElementById(id);previews[file["name"]]="error";el.parentNode.removeChild(el);renderPreviews()},model_loaded_callback:function(state){console.log("model_loaded_callback");var el=document.getElementById(id);var canvas=el.getElementsByTagName("canvas")[0];var preview={small:null,large:null};resizeRenderer(state,285,164);state.renderer.render(state.scene,state.camera);preview.small=
        canvasToBase64(canvas);resizeRenderer(state,1024,768);state.renderer.render(state.scene,state.camera);preview.large=canvasToBase64(canvas);previews[file["name"]]=preview;el.parentNode.removeChild(el);state.detach();renderPreviews()}})};
;
/**
 * jquery.Jcrop.min.js v0.9.10 (build:20120429)
 * jQuery Image Cropping Plugin - released under MIT License
 * Copyright (c) 2008-2012 Tapmodo Interactive LLC
 * https://github.com/tapmodo/Jcrop
 */
(function(a){a.Jcrop=function(b,c){function h(a){return a+"px"}function i(a){return d.baseClass+"-"+a}function j(){return a.fx.step.hasOwnProperty("backgroundColor")}function k(b){var c=a(b).offset();return[c.left,c.top]}function l(a){return[a.pageX-e[0],a.pageY-e[1]]}function m(b){typeof b!="object"&&(b={}),d=a.extend(d,b),a.each(["onChange","onSelect","onRelease","onDblClick"],function(a,b){typeof d[b]!="function"&&(d[b]=function(){})})}function n(a,b){e=k(E),bd.setCursor(a==="move"?a:a+"-resize");if(a==="move")return bd.activateHandlers(p(b),u);var c=ba.getFixed(),d=q(a),f=ba.getCorner(q(d));ba.setPressed(ba.getCorner(d)),ba.setCurrent(f),bd.activateHandlers(o(a,c),u)}function o(a,b){return function(c){if(!d.aspectRatio)switch(a){case"e":c[1]=b.y2;break;case"w":c[1]=b.y2;break;case"n":c[0]=b.x2;break;case"s":c[0]=b.x2}else switch(a){case"e":c[1]=b.y+1;break;case"w":c[1]=b.y+1;break;case"n":c[0]=b.x+1;break;case"s":c[0]=b.x+1}ba.setCurrent(c),bc.update()}}function p(a){var b=a;return be.watchKeys(),function(
a){ba.moveOffset([a[0]-b[0],a[1]-b[1]]),b=a,bc.update()}}function q(a){switch(a){case"n":return"sw";case"s":return"nw";case"e":return"nw";case"w":return"ne";case"ne":return"sw";case"nw":return"se";case"se":return"nw";case"sw":return"ne"}}function r(a){return function(b){return d.disabled?!1:a==="move"&&!d.allowMove?!1:(e=k(E),X=!0,n(a,l(b)),b.stopPropagation(),b.preventDefault(),!1)}}function s(a,b,c){var d=a.width(),e=a.height();d>b&&b>0&&(d=b,e=b/a.width()*a.height()),e>c&&c>0&&(e=c,d=c/a.height()*a.width()),U=a.width()/d,V=a.height()/e,a.width(d).height(e)}function t(a){return{x:a.x*U,y:a.y*V,x2:a.x2*U,y2:a.y2*V,w:a.w*U,h:a.h*V}}function u(a){var b=ba.getFixed();b.w>d.minSelect[0]&&b.h>d.minSelect[1]?(bc.enableHandles(),bc.done()):bc.release(),bd.setCursor(d.allowSelect?"crosshair":"default")}function v(a){if(d.disabled)return!1;if(!d.allowSelect)return!1;X=!0,e=k(E),bc.disableHandles(),bd.setCursor("crosshair");var b=l(a);return ba.setPressed(b),bc.update(),bd.activateHandlers(w,u),be.watchKeys(),a.stopPropagation
(),a.preventDefault(),!1}function w(a){ba.setCurrent(a),bc.update()}function z(){var b=a("<div></div>").addClass(i("tracker"));return a.browser.msie&&b.css({opacity:0,backgroundColor:"white"}),b}function bf(a){H.removeClass().addClass(i("holder")).addClass(a)}function bg(a,b){function t(){window.setTimeout(u,l)}var c=a[0]/U,e=a[1]/V,f=a[2]/U,g=a[3]/V;if(Y)return;var h=ba.flipCoords(c,e,f,g),i=ba.getFixed(),j=[i.x,i.y,i.x2,i.y2],k=j,l=d.animationDelay,m=h[0]-j[0],n=h[1]-j[1],o=h[2]-j[2],p=h[3]-j[3],q=0,r=d.swingSpeed;x=k[0],y=k[1],f=k[2],g=k[3],bc.animMode(!0);var s,u=function(){return function(){q+=(100-q)/r,k[0]=x+q/100*m,k[1]=y+q/100*n,k[2]=f+q/100*o,k[3]=g+q/100*p,q>=99.8&&(q=100),q<100?(bi(k),t()):(bc.done(),typeof b=="function"&&b.call(bt))}}();t()}function bh(a){bi([a[0]/U,a[1]/V,a[2]/U,a[3]/V]),d.onSelect.call(bt,t(ba.getFixed())),bc.enableHandles()}function bi(a){ba.setPressed([a[0],a[1]]),ba.setCurrent([a[2],a[3]]),bc.update()}function bj(){return t(ba.getFixed())}function bk(){return ba.getFixed()}function bl
(a){m(a),bs()}function bm(){d.disabled=!0,bc.disableHandles(),bc.setCursor("default"),bd.setCursor("default")}function bn(){d.disabled=!1,bs()}function bo(){bc.done(),bd.activateHandlers(null,null)}function bp(){H.remove(),B.show(),a(b).removeData("Jcrop")}function bq(a,b){bc.release(),bm();var c=new Image;c.onload=function(){var e=c.width,f=c.height,g=d.boxWidth,h=d.boxHeight;E.width(e).height(f),E.attr("src",a),I.attr("src",a),s(E,g,h),F=E.width(),G=E.height(),I.width(F).height(G),N.width(F+M*2).height(G+M*2),H.width(F).height(G),bb.resize(F,G),bn(),typeof b=="function"&&b.call(bt)},c.src=a}function br(a,b,c){var e=b||d.bgColor;d.bgFade&&j()&&d.fadeTime&&!c?a.animate({backgroundColor:e},{queue:!1,duration:d.fadeTime}):a.css("backgroundColor",e)}function bs(a){d.allowResize?a?bc.enableOnly():bc.enableHandles():bc.disableHandles(),bd.setCursor(d.allowSelect?"crosshair":"default"),bc.setCursor(d.allowMove?"move":"default"),d.hasOwnProperty("trueSize")&&(U=d.trueSize[0]/F,V=d.trueSize[1]/G),d.hasOwnProperty("setSelect"
)&&(bh(d.setSelect),bc.done(),delete d.setSelect),bb.refresh(),d.bgColor!=O&&(br(d.shade?bb.getShades():H,d.shade?d.shadeColor||d.bgColor:d.bgColor),O=d.bgColor),P!=d.bgOpacity&&(P=d.bgOpacity,d.shade?bb.refresh():bc.setBgOpacity(P)),Q=d.maxSize[0]||0,R=d.maxSize[1]||0,S=d.minSize[0]||0,T=d.minSize[1]||0,d.hasOwnProperty("outerImage")&&(E.attr("src",d.outerImage),delete d.outerImage),bc.refresh()}var d=a.extend({},a.Jcrop.defaults),e,f,g=!1;a.browser.msie&&a.browser.version.split(".")[0]==="6"&&(g=!0),typeof b!="object"&&(b=a(b)[0]),typeof c!="object"&&(c={}),m(c);var A={border:"none",visibility:"visible",margin:0,padding:0,position:"absolute",top:0,left:0},B=a(b),C=!0;if(b.tagName=="IMG"){if(B[0].width!=0&&B[0].height!=0)B.width(B[0].width),B.height(B[0].height);else{var D=new Image;D.src=B[0].src,B.width(D.width),B.height(D.height)}var E=B.clone().removeAttr("id").css(A).show();E.width(B.width()),E.height(B.height()),B.after(E).hide()}else E=B.css(A).show(),C=!1,d.shade===null&&(d.shade=!0);s(E,d.boxWidth,d.
boxHeight);var F=E.width(),G=E.height(),H=a("<div />").width(F).height(G).addClass(i("holder")).css({position:"relative",backgroundColor:d.bgColor}).insertAfter(B).append(E);d.addClass&&H.addClass(d.addClass);var I=a("<div />"),J=a("<div />").width("100%").height("100%").css({zIndex:310,position:"absolute",overflow:"hidden"}),K=a("<div />").width("100%").height("100%").css("zIndex",320),L=a("<div />").css({position:"absolute",zIndex:600}).dblclick(function(){var a=ba.getFixed();d.onDblClick.call(bt,a)}).insertBefore(E).append(J,K);C&&(I=a("<img />").attr("src",E.attr("src")).css(A).width(F).height(G),J.append(I)),g&&L.css({overflowY:"hidden"});var M=d.boundary,N=z().width(F+M*2).height(G+M*2).css({position:"absolute",top:h(-M),left:h(-M),zIndex:290}).mousedown(v),O=d.bgColor,P=d.bgOpacity,Q,R,S,T,U,V,W=!0,X,Y,Z;e=k(E);var _=function(){function a(){var a={},b=["touchstart","touchmove","touchend"],c=document.createElement("div"),d;try{for(d=0;d<b.length;d++){var e=b[d];e="on"+e;var f=e in c;f||(c.setAttribute(e,"return;"
),f=typeof c[e]=="function"),a[b[d]]=f}return a.touchstart&&a.touchend&&a.touchmove}catch(g){return!1}}function b(){return d.touchSupport===!0||d.touchSupport===!1?d.touchSupport:a()}return{createDragger:function(a){return function(b){return b.pageX=b.originalEvent.changedTouches[0].pageX,b.pageY=b.originalEvent.changedTouches[0].pageY,d.disabled?!1:a==="move"&&!d.allowMove?!1:(X=!0,n(a,l(b)),b.stopPropagation(),b.preventDefault(),!1)}},newSelection:function(a){return a.pageX=a.originalEvent.changedTouches[0].pageX,a.pageY=a.originalEvent.changedTouches[0].pageY,v(a)},isSupported:a,support:b()}}(),ba=function(){function h(d){d=n(d),c=a=d[0],e=b=d[1]}function i(a){a=n(a),f=a[0]-c,g=a[1]-e,c=a[0],e=a[1]}function j(){return[f,g]}function k(d){var f=d[0],g=d[1];0>a+f&&(f-=f+a),0>b+g&&(g-=g+b),G<e+g&&(g+=G-(e+g)),F<c+f&&(f+=F-(c+f)),a+=f,c+=f,b+=g,e+=g}function l(a){var b=m();switch(a){case"ne":return[b.x2,b.y];case"nw":return[b.x,b.y];case"se":return[b.x2,b.y2];case"sw":return[b.x,b.y2]}}function m(){if(!d.aspectRatio
)return p();var f=d.aspectRatio,g=d.minSize[0]/U,h=d.maxSize[0]/U,i=d.maxSize[1]/V,j=c-a,k=e-b,l=Math.abs(j),m=Math.abs(k),n=l/m,r,s,t,u;return h===0&&(h=F*10),i===0&&(i=G*10),n<f?(s=e,t=m*f,r=j<0?a-t:t+a,r<0?(r=0,u=Math.abs((r-a)/f),s=k<0?b-u:u+b):r>F&&(r=F,u=Math.abs((r-a)/f),s=k<0?b-u:u+b)):(r=c,u=l/f,s=k<0?b-u:b+u,s<0?(s=0,t=Math.abs((s-b)*f),r=j<0?a-t:t+a):s>G&&(s=G,t=Math.abs(s-b)*f,r=j<0?a-t:t+a)),r>a?(r-a<g?r=a+g:r-a>h&&(r=a+h),s>b?s=b+(r-a)/f:s=b-(r-a)/f):r<a&&(a-r<g?r=a-g:a-r>h&&(r=a-h),s>b?s=b+(a-r)/f:s=b-(a-r)/f),r<0?(a-=r,r=0):r>F&&(a-=r-F,r=F),s<0?(b-=s,s=0):s>G&&(b-=s-G,s=G),q(o(a,b,r,s))}function n(a){return a[0]<0&&(a[0]=0),a[1]<0&&(a[1]=0),a[0]>F&&(a[0]=F),a[1]>G&&(a[1]=G),[a[0],a[1]]}function o(a,b,c,d){var e=a,f=c,g=b,h=d;return c<a&&(e=c,f=a),d<b&&(g=d,h=b),[e,g,f,h]}function p(){var d=c-a,f=e-b,g;return Q&&Math.abs(d)>Q&&(c=d>0?a+Q:a-Q),R&&Math.abs(f)>R&&(e=f>0?b+R:b-R),T/V&&Math.abs(f)<T/V&&(e=f>0?b+T/V:b-T/V),S/U&&Math.abs(d)<S/U&&(c=d>0?a+S/U:a-S/U),a<0&&(c-=a,a-=a),b<0&&(e-=b,b-=b),c<0&&
(a-=c,c-=c),e<0&&(b-=e,e-=e),c>F&&(g=c-F,a-=g,c-=g),e>G&&(g=e-G,b-=g,e-=g),a>F&&(g=a-G,e-=g,b-=g),b>G&&(g=b-G,e-=g,b-=g),q(o(a,b,c,e))}function q(a){return{x:a[0],y:a[1],x2:a[2],y2:a[3],w:a[2]-a[0],h:a[3]-a[1]}}var a=0,b=0,c=0,e=0,f,g;return{flipCoords:o,setPressed:h,setCurrent:i,getOffset:j,moveOffset:k,getCorner:l,getFixed:m}}(),bb=function(){function f(a,b){e.left.css({height:h(b)}),e.right.css({height:h(b)})}function g(){return i(ba.getFixed())}function i(a){e.top.css({left:h(a.x),width:h(a.w),height:h(a.y)}),e.bottom.css({top:h(a.y2),left:h(a.x),width:h(a.w),height:h(G-a.y2)}),e.right.css({left:h(a.x2),width:h(F-a.x2)}),e.left.css({width:h(a.x)})}function j(){return a("<div />").css({position:"absolute",backgroundColor:d.shadeColor||d.bgColor}).appendTo(c)}function k(){b||(b=!0,c.insertBefore(E),g(),bc.setBgOpacity(1,0,1),I.hide(),l(d.shadeColor||d.bgColor,1),bc.isAwake()?n(d.bgOpacity,1):n(1,1))}function l(a,b){br(p(),a,b)}function m(){b&&(c.remove(),I.show(),b=!1,bc.isAwake()?bc.setBgOpacity(d.bgOpacity
,1,1):(bc.setBgOpacity(1,1,1),bc.disableHandles()),br(H,0,1))}function n(a,e){b&&(d.bgFade&&!e?c.animate({opacity:1-a},{queue:!1,duration:d.fadeTime}):c.css({opacity:1-a}))}function o(){d.shade?k():m(),bc.isAwake()&&n(d.bgOpacity)}function p(){return c.children()}var b=!1,c=a("<div />").css({position:"absolute",zIndex:240,opacity:0}),e={top:j(),left:j().height(G),right:j().height(G),bottom:j()};return{update:g,updateRaw:i,getShades:p,setBgColor:l,enable:k,disable:m,resize:f,refresh:o,opacity:n}}(),bc=function(){function k(b){var c=a("<div />").css({position:"absolute",opacity:d.borderOpacity}).addClass(i(b));return J.append(c),c}function l(b,c){var d=a("<div />").mousedown(r(b)).css({cursor:b+"-resize",position:"absolute",zIndex:c}).addClass("ord-"+b);return _.support&&d.bind("touchstart.jcrop",_.createDragger(b)),K.append(d),d}function m(a){var b=d.handleSize;return l(a,c++).css({opacity:d.handleOpacity}).width(b).height(b).addClass(i("handle"))}function n(a){return l(a,c++).addClass("jcrop-dragbar")}function o
(a){var b;for(b=0;b<a.length;b++)g[a[b]]=n(a[b])}function p(a){var b,c;for(c=0;c<a.length;c++){switch(a[c]){case"n":b="hline";break;case"s":b="hline bottom";break;case"e":b="vline right";break;case"w":b="vline"}e[a[c]]=k(b)}}function q(a){var b;for(b=0;b<a.length;b++)f[a[b]]=m(a[b])}function s(a,b){d.shade||I.css({top:h(-b),left:h(-a)}),L.css({top:h(b),left:h(a)})}function u(a,b){L.width(a).height(b)}function v(){var a=ba.getFixed();ba.setPressed([a.x,a.y]),ba.setCurrent([a.x2,a.y2]),w()}function w(a){if(b)return x(a)}function x(a){var c=ba.getFixed();u(c.w,c.h),s(c.x,c.y),d.shade&&bb.updateRaw(c),b||A(),a?d.onSelect.call(bt,t(c)):d.onChange.call(bt,t(c))}function y(a,c,e){if(!b&&!c)return;d.bgFade&&!e?E.animate({opacity:a},{queue:!1,duration:d.fadeTime}):E.css("opacity",a)}function A(){L.show(),d.shade?bb.opacity(P):y(P,!0),b=!0}function B(){F(),L.hide(),d.shade?bb.opacity(1):y(1),b=!1,d.onRelease.call(bt)}function C(){j&&K.show()}function D(){j=!0;if(d.allowResize)return K.show(),!0}function F(){j=!1,K.hide(
)}function G(a){Y===a?F():D()}function H(){G(!1),v()}var b,c=370,e={},f={},g={},j=!1;d.dragEdges&&a.isArray(d.createDragbars)&&o(d.createDragbars),a.isArray(d.createHandles)&&q(d.createHandles),d.drawBorders&&a.isArray(d.createBorders)&&p(d.createBorders),a(document).bind("touchstart.jcrop-ios",function(b){a(b.currentTarget).hasClass("jcrop-tracker")&&b.stopPropagation()});var M=z().mousedown(r("move")).css({cursor:"move",position:"absolute",zIndex:360});return _.support&&M.bind("touchstart.jcrop",_.createDragger("move")),J.append(M),F(),{updateVisible:w,update:x,release:B,refresh:v,isAwake:function(){return b},setCursor:function(a){M.css("cursor",a)},enableHandles:D,enableOnly:function(){j=!0},showHandles:C,disableHandles:F,animMode:G,setBgOpacity:y,done:H}}(),bd=function(){function f(){N.css({zIndex:450}),_.support&&a(document).bind("touchmove.jcrop",k).bind("touchend.jcrop",m),e&&a(document).bind("mousemove.jcrop",h).bind("mouseup.jcrop",i)}function g(){N.css({zIndex:290}),a(document).unbind(".jcrop")}function h
(a){return b(l(a)),!1}function i(a){return a.preventDefault(),a.stopPropagation(),X&&(X=!1,c(l(a)),bc.isAwake()&&d.onSelect.call(bt,t(ba.getFixed())),g(),b=function(){},c=function(){}),!1}function j(a,d){return X=!0,b=a,c=d,f(),!1}function k(a){return a.pageX=a.originalEvent.changedTouches[0].pageX,a.pageY=a.originalEvent.changedTouches[0].pageY,h(a)}function m(a){return a.pageX=a.originalEvent.changedTouches[0].pageX,a.pageY=a.originalEvent.changedTouches[0].pageY,i(a)}function n(a){N.css("cursor",a)}var b=function(){},c=function(){},e=d.trackDocument;return e||N.mousemove(h).mouseup(i).mouseout(i),E.before(N),{activateHandlers:j,setCursor:n}}(),be=function(){function e(){d.keySupport&&(b.show(),b.focus())}function f(a){b.hide()}function h(a,b,c){d.allowMove&&(ba.moveOffset([b,c]),bc.updateVisible(!0)),a.preventDefault(),a.stopPropagation()}function i(a){if(a.ctrlKey||a.metaKey)return!0;Z=a.shiftKey?!0:!1;var b=Z?10:1;switch(a.keyCode){case 37:h(a,-b,0);break;case 39:h(a,b,0);break;case 38:h(a,0,-b);break;case 40
:h(a,0,b);break;case 27:d.allowSelect&&bc.release();break;case 9:return!0}return!1}var b=a('<input type="radio" />').css({position:"fixed",left:"-120px",width:"12px"}),c=a("<div />").css({position:"absolute",overflow:"hidden"}).append(b);return d.keySupport&&(b.keydown(i).blur(f),g||!d.fixedSupport?(b.css({position:"absolute",left:"-20px"}),c.append(b).insertBefore(E)):b.insertBefore(E)),{watchKeys:e}}();_.support&&N.bind("touchstart.jcrop",_.newSelection),K.hide(),bs(!0);var bt={setImage:bq,animateTo:bg,setSelect:bh,setOptions:bl,tellSelect:bj,tellScaled:bk,setClass:bf,disable:bm,enable:bn,cancel:bo,release:bc.release,destroy:bp,focus:be.watchKeys,getBounds:function(){return[F*U,G*V]},getWidgetSize:function(){return[F,G]},getScaleFactor:function(){return[U,V]},getOptions:function(){return d},ui:{holder:H,selection:L}};return a.browser.msie&&H.bind("selectstart",function(){return!1}),B.data("Jcrop",bt),bt},a.fn.Jcrop=function(b,c){var d;return this.each(function(){if(a(this).data("Jcrop")){if(b==="api")return a
(this).data("Jcrop");a(this).data("Jcrop").setOptions(b)}else this.tagName=="IMG"?a.Jcrop.Loader(this,function(){a(this).css({display:"block",visibility:"hidden"}),d=a.Jcrop(this,b),a.isFunction(c)&&c.call(d)}):(a(this).css({display:"block",visibility:"hidden"}),d=a.Jcrop(this,b),a.isFunction(c)&&c.call(d))}),this},a.Jcrop.Loader=function(b,c,d){function g(){f.complete?(e.unbind(".jcloader"),a.isFunction(c)&&c.call(f)):window.setTimeout(g,50)}var e=a(b),f=e[0];e.bind("load.jcloader",g).bind("error.jcloader",function(b){e.unbind(".jcloader"),a.isFunction(d)&&d.call(f)}),f.complete&&a.isFunction(c)&&(e.unbind(".jcloader"),c.call(f))},a.Jcrop.defaults={allowSelect:!0,allowMove:!0,allowResize:!0,trackDocument:!0,baseClass:"jcrop",addClass:null,bgColor:"black",bgOpacity:.6,bgFade:!1,borderOpacity:.4,handleOpacity:.5,handleSize:7,aspectRatio:0,keySupport:!0,createHandles:["n","s","e","w","nw","ne","se","sw"],createDragbars:["n","s","e","w"],createBorders:["n","s","e","w"],drawBorders:!0,dragEdges:!0,fixedSupport:!0,
touchSupport:null,shade:null,boxWidth:0,boxHeight:0,boundary:2,fadeTime:400,animationDelay:20,swingSpeed:3,minSelect:[0,0],maxSize:[0,0],minSize:[0,0],onChange:function(){},onSelect:function(){},onDblClick:function(){},onRelease:function(){}}})(jQuery);;
var initialZoomData; //!
var doubletapTimer = false; //!
/*
 Smooth Zoom Pan - jQuery Image Viewer
 Copyright (c) 2011-14 Ramesh Kumar
 http://codecanyon.net/user/VF

 Version:	1.7.0
 RELEASE:	09 SEP 2011
 UPDATE:		27 May 2014

 Built using:
 jQuery 		version: 1.7.0+		http://jquery.com/
 Modernizr 	version: 2.8.2		http://www.modernizr.com/
 MouseWheel	version: 3.1.11		http://brandon.aaron.sh

 */

(function ($, window, document) {

	/*****************************************************************************
     Default settings:
     For detailed description of individual parameters, see the help document
	 ******************************************************************************/
	var defaults = {

		width: '',									//Width of the view area [480, '480px', '100%']
		height: '',									//Height of the view area [480, '480px', '100%']

		initial_ZOOM: '',							//Initial zoom level to start with (in percentage) [100]
		initial_POSITION: '',						//Initial location to be focused in pixel value [150,150 or 150 150]

		animation_SMOOTHNESS: 5.5,					//Ease or smoothness of all movements [Any number from 0]
		animation_SPEED_ZOOM: 5.5,					//Speed of zoom movements [Any number from 0]
		animation_SPEED_PAN: 5.5,					//Speed of pan movements [Any number from 0]

		zoom_MAX: 800,								//Maximum limit for zooming (in percentage)
		zoom_MIN: '',								//Minimum limit for zooming (in percentage)
		zoom_SINGLE_STEP: false,					//To reach maximum and minimum zoom levels in single click
		zoom_OUT_TO_FIT: true,						//To allow image to be zoomed out with whitespace on sides
		zoom_BUTTONS_SHOW: true,					//To enable/disable the + and - buttons

		pan_BUTTONS_SHOW: true,						//To enable/disable the arrow and reset buttons
		pan_LIMIT_BOUNDARY: true,					//To allow/restrict moving the image beyond boundaries
		pan_REVERSE: false,

		reset_ALIGN_TO: 'center center', 			//Image can be aligned to desired position on reset. Example: 'Top Left'
		reset_TO_ZOOM_MIN: true,					//How it should behave if zoom_MIN value set and while clicking reset button,

		button_SIZE: 18,							//Button width and height (in pixels)
		button_SIZE_TOUCH_DEVICE: 30,				//Button width and height (in pixels) on touch devices
		button_COLOR: '#FFFFFF',					//Button color in hexadecimal
		button_BG_COLOR: '#000000',					//Button set's background color in hexadecimal
		button_BG_TRANSPARENCY: 55,					//Background transparency (in percentage)
		button_AUTO_HIDE: false,					//To hide the button set when mouse moved outside the view area
		button_AUTO_HIDE_DELAY: 1,					//Auto hide delay time in seconds
		button_ALIGN: 'bottom right',				//Button set can be aligned to any side or center
		button_MARGIN: 10,							//Space between button set and view port's edge
		button_ROUND_CORNERS: false,					//To enable disable roundness of button corner

		touch_DRAG: true,							//Enable/disable the dragability of image (touch)
		mouse_DRAG: true,							//Enable/disable the dragability of image (mouse)
		mouse_WHEEL: true,							//Enable/disable mousewheel zoom
		mouse_WHEEL_CURSOR_POS: true,				//Enable/disable position sensitive mousewheel zoom
		mouse_DOUBLE_CLICK: true,					//Enable/disable zoom action with double click

		background_COLOR: '#FFFFFF',				//Background colour of image container
		border_SIZE: 1,								//Border size of view area
		border_COLOR: '#000000',					//Border color of view area
		border_TRANSPARENCY: 10,					//Border transparency of view area

		image_url: '',								//Set url or image to be zoomed
		image_original_width: '',					//Original width of main image
		image_original_height: '',					//Original height of main image
		container: '',								//Set container element of image (id of container)

		on_IMAGE_LOAD: '',							//To Call external function immediatly after image loaded
		on_ZOOM_PAN_UPDATE: '',						//To Call external function for each zoom, pan animation frame
		on_ZOOM_PAN_COMPLETE: '',					//To Call external function whenever zoom, pan animation completes
		on_LANDMARK_STATE_CHANGE: '',				//To Call external function whenever the zoom leval crosses global "data-show-at-zoom" value

		use_3D_Transform: true,						//To enable / disable Hardware acceleration on webkit browsers

		responsive: false,							//To enable / disable Responsive / fluid layout
		responsive_maintain_ratio: true,			//To maintain view area width/height ratio or not
		max_WIDTH: '',								//Maximum allowed width of view area (helpful when 'width' parameter set with % and need limit)
		max_HEIGHT: ''								//Maximum allowed height of view area (helpful when 'height' parameter set with % and need limit)
	};

	function Zoomer($elem, params) {

		var self = this,
			op = $.extend({}, defaults, params);
		this.$elem = $elem;
		this.hasTouch = this.checkTouchSupport();

		this.lastMouseWheelEventTime = 0, //!

			/**********************************************************
             Option values verified and formated if needed
			 **********************************************************/
			this.sW = op.width;
		this.sH = op.height;

		this.init_zoom = op.initial_ZOOM / 100;
		this.init_pos = op.initial_POSITION.replace(/,/g, ' ').replace(/\s{2,}/g, ' ').split(' ');

		this.zoom_max = op.zoom_MAX / 100;
		this.zoom_min = op.zoom_MIN / 100;

		this.zoom_single = checkBoolean(op.zoom_SINGLE_STEP);
		this.zoom_fit = checkBoolean(op.zoom_OUT_TO_FIT);
		this.zoom_speed = 1 + (((op.animation_SPEED === 0 || op.animation_SPEED ? op.animation_SPEED : op.animation_SPEED_ZOOM) + 1) / 20);
//                this.zoom_speed = 10;
//                console.log(this.zoom_speed, 'zoom_speed');
		this.zoom_show = checkBoolean(op.zoom_BUTTONS_SHOW);

		this.pan_speed_o = (op.animation_SPEED === 0 || op.animation_SPEED ? op.animation_SPEED : op.animation_SPEED_PAN);
		this.pan_show = checkBoolean(op.pan_BUTTONS_SHOW);
		this.pan_limit = checkBoolean(op.pan_LIMIT_BOUNDARY);
		this.pan_rev = checkBoolean(op.pan_REVERSE);

		this.reset_align = op.reset_ALIGN_TO.toLowerCase().split(' ');
		this.reset_to_zmin = checkBoolean(op.reset_TO_ZOOM_MIN);

		this.bu_size = parseInt((this.hasTouch ? op.button_SIZE_TOUCH_DEVICE : op.button_SIZE) / 2) * 2;
		this.bu_color = op.button_COLOR;
		this.bu_bg = op.button_BG_COLOR;
		this.bu_bg_alpha = op.button_BG_TRANSPARENCY / 100;
		this.bu_icon = op.button_ICON_IMAGE;
		this.bu_auto = checkBoolean(op.button_AUTO_HIDE);

		this.bu_delay = op.button_AUTO_HIDE_DELAY * 1000;
		this.bu_align = op.button_ALIGN.toLowerCase().split(' ');
		this.bu_margin = op.button_MARGIN;
		this.bu_round = checkBoolean(op.button_ROUND_CORNERS);

		this.touch_drag = checkBoolean(op.touch_DRAG);
		this.mouse_drag = checkBoolean(op.mouse_DRAG);
		this.mouse_wheel = checkBoolean(op.mouse_WHEEL);
		this.mouse_wheel_cur = checkBoolean(op.mouse_WHEEL_CURSOR_POS);
		this.mouse_dbl_click = checkBoolean(op.mouse_DOUBLE_CLICK);

		this.ani_smooth = Math.max(1, (op.animation_SMOOTHNESS + 1) / 1.45);

		this.bg_color = op.background_COLOR;
		this.bord_size = op.border_SIZE;
		this.bord_color = op.border_COLOR;
		this.bord_alpha = op.border_TRANSPARENCY / 100;

		this.container = op.container;
		this.image_url = op.image_url;
		this.image_width = op.image_original_width;
		this.image_height = op.image_original_height;

		this.responsive = checkBoolean(op.responsive);
		this.maintain_ratio = checkBoolean(op.responsive_maintain_ratio);
		this.w_max = op.max_WIDTH;
		this.h_max = op.max_HEIGHT;

		this.onLOAD = op.on_IMAGE_LOAD;
		this.onUPDATE = op.on_ZOOM_PAN_UPDATE;
		this.onZOOM_PAN = op.on_ZOOM_PAN_COMPLETE;
		this.onLANDMARK = op.on_LANDMARK_STATE_CHANGE;

		/***********************************************************
         Variables for inner operation.
         x, y, width, height and scale value of image
		 ***********************************************************/
		this._x;
		this._y;
		this._w;
		this._h;
		this._sc = 0;

		this.rA = 1;
		this.rF = 1;
		this.rR = 1;
		this.iW = 0;
		this.iH = 0;
		this.tX = 0;
		this.tY = 0;
		this.oX = 0;
		this.oY = 0;
		this.fX = 0;
		this.fY = 0;
		this.dX = 0;
		this.dY = 0;
		this.cX = 0;
		this.cY = 0;

		this.transOffX = 0;
		this.transOffY = 0;
		this.focusOffX = 0;
		this.focusOffY = 0;
		this.offX = 0;
		this.offY = 0;

		/***********************************************************
         Flags that convey current states and events
		 ***********************************************************/
		this._playing = false;
		this._dragging = false;
		this._onfocus = false;
		this._moveCursor = false;
		this._wheel = false;
		this._recent = 'zoomOut';
		this._pinching = false;
		this._landmark = false;
		this._rA;
		this._centx;
		this._centy;
		this._onButton = false;
		this._onHitArea = false;
		this.cFlag = {
			_zi: false,
			_zo: false,
			_ml: false,
			_mr: false,
			_mu: false,
			_md: false,
			_rs: false,
			_nd: false
		};

		/***********************************************************
         Elements and arrays that references elements
		 ***********************************************************/
		this.$holder;
		this.$hitArea;
		this.$controls;
		this.$loc_cont;
		this.map_coordinates = [];
		this.locations = [];
		this.buttons = [];
		this.border = [];

		/***********************************************************
         miscellaneous
		 ***********************************************************/
		this.buttons_total = 7;
		this.cButtId = 0;
		this.pan_speed;
		this.auto_timer;
		this.ani_timer;
		this.ani_end;
		this.focusSpeed = this.reduction = .5;
		this.orig_style;
		this.mapAreas;
		this.icons;
		this.show_at_zoom;
		this.assetsLoaded = false;
		this.zStep = 0;
		this.sRed = 300;
		this.use3D = op.use_3D_Transform && supportsTrans3D;

		// Set events to support pointer / touch / mouse
		if (navigator.pointerEnabled || navigator.msPointerEnabled) {
			//Pointer
			if (navigator.pointerEnabled) {
				this.pointerDown = 'pointerdown';
				this.pointerUp = 'pointerup';
				this.pointerMove = 'pointermove';

			} else if (navigator.msPointerEnabled) {
				this.pointerDown = 'MSPointerDown';
				this.pointerUp = 'MSPointerUp';
				this.pointerMove = 'MSPointerMove';

			}
			this.event_down = this.pointerDown + '.sz';
			this.event_up = this.pointerUp + '.sz';
			this.event_move = this.pointerMove + '.sz';

			this.supportsPointer = true;
			this.pointers = [];

		} else if (this.hasTouch) {
			//Touch	only
			this.event_down = 'touchstart' + '.sz';
			this.event_up = 'touchend' + '.sz';
			this.event_move = 'touchmove' + '.sz';

		} else {
			//Mouse only
			this.event_down = 'mousedown' + '.sz';
			this.event_up = 'mouseup' + '.sz';
			this.event_move = 'mousemove' + '.sz';
		}

		//Case 1: Image specificed (possibly) through img tag:
		if (this.image_url == '') {
			this.$image = $elem;
			this.id = this.$image.attr('id');

			//Case 2: Image url specificed through parameter:
		} else {
			var img = new Image();
			if (this.image_width) {
				img.width = this.image_width;
			}
			if (this.image_height) {
				img.height = this.image_height;
			}
			img.src = this.image_url;
			this.$image = $(img).appendTo($elem);
		}


		//Prepare container div (Basically the element that masks image with overflow hidden)
		this.setContainer();

		//Get button icon image's url
		var testOb;
		if (!this.bu_icon) {
			var regx = /url\(["']?([^'")]+)['"]?\)/;
			testOb = $('<div class="smooth_zoom_icons"></div>');
			this.$holder.append(testOb);
			this.bu_icon = testOb.css("background-image").replace(regx, '$1');
			if (this.bu_icon == 'none') {
				this.bu_icon = '/c/js/zoom-viewer/zoom_assets/icons.png';
			}
			testOb.remove();
		}

		//Firefox feature checkup
		if (this.$image.css('-moz-transform') && prop_transform) {
			testOb = $('<div style="-moz-transform: translate(1px, 1px)"></div>');
			this.$holder.append(testOb);
			this.fixMoz = testOb.position().left === 1 ? false : true;
			testOb.remove();
		} else {
			this.fixMoz = false;
		}

		//Preload icons and main image.
		this.$image.hide();
		this.imgList = [
			{loaded: false, src: this.bu_icon || 'zoom_assets/icons.png'}, //Icon image
			{loaded: false, src: this.image_url == '' ? this.$image.attr('src') : this.image_url} // Main image
		];

		$.each(this.imgList, function (i) {
			var _img = new Image();
			$(_img).bind('load', {id: i, self: self}, self.loadComplete)
				.bind('error', {id: i, self: self}, self.loadComplete); //Allow initiation even if image is not there :(
			_img.src = self.imgList[i].src;
		});

	}

	Zoomer.prototype = {

		/*Preload the icon and main image
		 *********************************************************************************************************************/
		loadComplete: function (e) {
			var self = e.data.self,
				complete = true;

			self.imgList[e.data.id].loaded = true;
			for (var j = 0; j < self.imgList.length; j++) {
				if (!self.imgList[j].loaded) {
					complete = false;
				}
			}
			if (complete) {
				self.assetsLoaded = true;
				if (self.onLOAD !== '') {
					self.onLOAD();
				}

				//Assets loaded, initiate plugin
				self.init();
				//!
				clearTimeout(zoomBgTimeout);
				$('#zoom_container').css('background-image', 'none');
				initialZoomData = $('#zoom_container').smoothZoom('getZoomData');
			}
		},


		/*Make sure the device has touch screen support
		 *********************************************************************************************************************/
		checkTouchSupport: function () {
			var touch = 'ontouchstart' in window || 'createTouch' in document;
			if (navigator.pointerEnabled) {
				touch = Boolean(touch || navigator.maxTouchPoints);
			} else if (navigator.msPointerEnabled) {
				touch = Boolean(touch || navigator.msMaxTouchPoints);
			}
			return touch;
		},


		/*Initiate after assets loaded
		 ***********************************************************************************************************************/
		init: function () {
			var self = this,
				$image = self.$image,
				sW = self.sW,
				sH = self.sH,
				container = self.container,
				cBW, cBH, pan_show = self.pan_show,
				zoom_show = self.zoom_show,
				$controls = self.$controls,
				buttons = self.buttons,
				cFlag = self.cFlag,
				bu_align = self.bu_align,
				bu_margin = self.bu_margin,
				$holder = self.$holder;

			//Store the default image properties so that it can be reverted back when plugin needs to be destroyed
			self.orig_style = self.getStyle();

			//IE 6 Image tool bar disabled
			$image.attr('galleryimg', 'no');

			if (!navigator.userAgent.toLowerCase().match(/(iphone|ipod|ipad)/)) {
				$image.removeAttr('width');
				$image.removeAttr('height');
			}

			//In case parent element's display property set to 'none', we need to first set them 'block', measure the width and height and then set them back to 'none'
			var temp = $image,
				dispArray = [];
			for (var i = 0; i < 5; i++) {
				if (temp && temp[0].tagName !== 'BODY' && temp[0].tagName !== 'HTML') {
					if (temp.css('display') == 'none') {
						temp.css('display', 'block');
						dispArray.push(temp);
					}
					temp = temp.parent();
				} else {
					break;
				}
			}

			self.iW = $image.width();
			self.iH = $image.height();

			for (var i = 0; i < dispArray.length; i++) {
				dispArray[i].css('display', 'none');
			}

			//Initially the image needs to be resized to fit container. To do so, first measure the scaledown ratio
			self.rF = self.rR = self.checkRatio(sW, sH, self.iW, self.iH, self.zoom_fit);

			//If NO Minimum zoom value set
			if (self.zoom_min == 0 || self.init_zoom != 0) {
				if (self.init_zoom != '') {
					self.rA = self._sc = self.init_zoom;
				} else {
					self.rA = self._sc = self.rF;
				}
				if (self.zoom_min != 0) {
					self.rF = self.zoom_min;
					if (self.reset_to_zmin) {
						self.rR = self.zoom_min
					}
				}

				//If Minimum zoom value set
			} else {
				if (self.rF < self.zoom_min) {
					self.rF = self.zoom_min;
					if (self.reset_to_zmin) {
						self.rR = self.zoom_min
					}
					self.rA = self._sc = self.zoom_min;
				} else {
					self.rA = self._sc = self.rR;
				}
			}

			//Width and Height to be applied to the image
			self._w = self._sc * self.iW;
			self._h = self._sc * self.iH;

			//Resize the image and position it centered inside the wrapper
			if (self.init_pos == '') {
				self._x = self.tX = (sW - self._w) / 2;
				self._y = self.tY = (sH - self._h) / 2;
			} else {
				self._x = self.tX = (sW / 2) - parseInt(self.init_pos[0]) * self._sc;
				self._y = self.tY = (sH / 2) - parseInt(self.init_pos[1]) * self._sc;
				self.oX = (self.tX - ((sW - self._w) / 2)) / (self._w / sW);
				self.oY = (self.tY - ((sH - self._h) / 2)) / (self._h / sH);
			}

			if ((!self.pan_limit || self._moveCursor || self.init_zoom != self.rF) && self.mouse_drag) {
				$image.css('cursor', 'move');
				self.$hitArea.css('cursor', 'move');
			}


			if (prop_transform) {
				self.$image.css(prop_origin, '0 0');
			}
			if (self.use3D) {
				$image.css({
					'-webkit-backface-visibility': 'hidden',
					'-webkit-perspective': 1000
				});
			}

			//Start displaying the image
			$image.css({
				position: 'absolute',
				'z-index': 2,
				left: '0px',
				top: '0px',
				'-webkit-box-shadow': '1px 1px rgba(0,0,0,0)'
			})
				.hide()
				.fadeIn(10, function () { //! was 500
					//alert(1);
					$holder.css('background-image', 'none');
				});

			//Create Control buttons and events
			var self = self,
				bs = self.bu_size,
				iSize = 50,
				sDiff = 2,
				bSpace = 3,
				mSize = Math.ceil(self.bu_size / 4),
				iconOff = bs < 16 ? 50 : 0,
				bsDiff = bs - sDiff;

			//Show all buttons
			if (pan_show) {
				if (zoom_show) {
					cBW = parseInt(bs + (bs * .85) + (bsDiff * 3) + (bSpace * 2) + (mSize * 2));
				} else {
					cBW = parseInt((bsDiff * 3) + (bSpace * 2) + (mSize * 2));
				}
				cBH = parseInt((bsDiff * 3) + (bSpace * 2) + (mSize * 2));

				//Show zoom buttons only
			} else {
				if (zoom_show) {
					cBW = parseInt(bs + mSize * 2);
					cBH = parseInt(bs * 2 + mSize * 3);
					cBW = parseInt(cBW / 2) * 2;
					cBH = parseInt(cBH / 2) * 2;
				} else {
					cBW = 0;
					cBH = 0;
				}
			}

			var pOff = (iSize - bs) / 2,
				resetCenterX = cBW - ((bs - (pan_show ? sDiff : 0)) * 2) - mSize - bSpace,
				resetCenterY = (cBH / 2) - ((bs - (pan_show ? sDiff : 0)) / 2);

			var hProp, vProp, hVal, vVal;
			//Align button set as per settings
			if (bu_align[0] == 'top') {
				vProp = 'top';
				vVal = bu_margin;
			} else if (bu_align[0] == 'center') {
				vProp = 'top';
				vVal = parseInt((sH - cBH) / 2);
			} else {
				vProp = 'bottom';
				vVal = bu_margin;
			}
			if (bu_align[1] == 'right') {
				hProp = 'right';
				hVal = bu_margin;
			} else if (bu_align[1] == 'center') {
				hProp = 'right';
				hVal = parseInt((sW - cBW) / 2);
			} else {
				hProp = 'left';
				hVal = bu_margin;
			}

			//Buttons Container
			$controls = $(
				'<div style="position: absolute; ' + hProp + ':' + hVal + 'px; ' + vProp + ': ' + vVal + 'px; width: ' + cBW + 'px; height: ' + cBH + 'px; z-index: 20;" class="noSel"><div class="noSel controlsBg" style="position: relative; width: 100%; height: 100%; z-index: 1;"></div></div>'
			);
			/*!
			 $controls = $(
			 '<div style="position: absolute; ' + hProp + ':' + hVal + 'px; ' + vProp + ': ' + vVal + 'px; width: ' + cBW + 'px; height: ' + cBH + 'px; z-index: 20;" class="noSel">\
			 <div class="noSel controlsBg" style="position: relative; width: 100%; height: 100%; z-index: 1;">\
			 </div>\
			 </div>'
			 );
			 */

			$holder.append($controls);
			var $controlsBg = $controls.find('.controlsBg');

			//Make the corners rounded
			if (self.bu_round) {
				if (prop_radius) {
					$controlsBg
						.css(prop_radius, (iconOff > 0 ? 4 : 5) + 'px')
						.css('background-color', self.bu_bg);
				} else {
					self.roundBG(
						$controlsBg,
						'cBg',
						cBW,
						cBH,
						iconOff > 0 ? 4 : 5,
						375,
						self.bu_bg,
						self.bu_icon,
						1,
						iconOff ? 50 : 0
					);
				}
			} else {
				$controlsBg.css('background-color', self.bu_bg);
			}

			$controlsBg.css('opacity', self.bu_bg_alpha);

			//Generating Button properties	(7 buttons)
			buttons[0] = {
				_var: '_zi',
				l: mSize,
				t: pan_show ? (cBH - (bs * 2) - (bSpace * 2) + 2) / 2 : mSize,
				w: bs,
				h: bs,
				bx: -pOff,
				by: -pOff - iconOff
			};

			buttons[1] = {
				_var: '_zo',
				l: mSize,
				t: pan_show ? ((cBH - (bs * 2) - (bSpace * 2) + 2) / 2) + bs + (bSpace * 2) - 2 : cBH - bs - mSize,
				w: bs,
				h: bs,
				bx: -iSize - pOff,
				by: -pOff - iconOff
			};

			buttons[2] = {
				_var: self.pan_rev ? '_ml' : '_mr',
				l: resetCenterX - bsDiff - bSpace,
				t: resetCenterY,
				w: bsDiff,
				h: bsDiff,
				bx: -(sDiff / 2) - iSize * 2 - pOff,
				by: -(sDiff / 2) - pOff - iconOff
			};

			buttons[3] = {
				_var: self.pan_rev ? '_mr' : '_ml',
				l: resetCenterX + bsDiff + bSpace,
				t: resetCenterY,
				w: bsDiff,
				h: bsDiff,
				bx: -(sDiff / 2) - iSize * 3 - pOff,
				by: -(sDiff / 2) - pOff - iconOff
			};

			buttons[4] = {
				_var: self.pan_rev ? '_md' : '_mu',
				l: resetCenterX,
				t: resetCenterY + bsDiff + bSpace,
				w: bsDiff,
				h: bsDiff,
				bx: -(sDiff / 2) - iSize * 4 - pOff,
				by: -(sDiff / 2) - pOff - iconOff
			};

			buttons[5] = {
				_var: self.pan_rev ? '_mu' : '_md',
				l: resetCenterX,
				t: resetCenterY - bsDiff - bSpace,
				w: bsDiff,
				h: bsDiff,
				bx: -(sDiff / 2) - iSize * 5 - pOff,
				by: -(sDiff / 2) - pOff - iconOff
			};

			buttons[6] = {
				_var: '_rs',
				l: resetCenterX,
				t: resetCenterY,
				w: bsDiff,
				h: bsDiff,
				bx: -(sDiff / 2) - iSize * 6 - pOff,
				by: -(sDiff / 2) - pOff - iconOff
			};

			for (var i = 0; i < 7; i++) {
				buttons[i].$ob = $(
					'<div style="position: absolute; display: ' + (i < 2 ? zoom_show ? 'block' : 'none' : pan_show ? 'block' : 'none') + '; left: ' + (buttons[i].l - 1) + 'px; top: ' + (buttons[i].t - 1) + 'px; width: ' + (buttons[i].w + 2) + 'px; height: ' + (buttons[i].h + 2) + 'px; z-index:' + (i + 1) + ';" class="noSel"></div>'
				)
					.css('opacity', .7)
					.bind('mouseover.sz mouseout.sz ' + self.event_down, {
						id: i

					}, function (e) {
						self._onfocus = false;
						var $this = $(this);

						//Button over
						if (e.type == 'mouseover') {
							if ($this.css('opacity') > .5) {
								$this.css('opacity', 1);
							}

							//Button out
						} else if (e.type == 'mouseout') {
							if ($this.css('opacity') > .5) {
								$this.css('opacity', .7);
							}

							//Button press/down
						} else if (e.type == 'mousedown' || e.type == 'touchstart' || e.type == self.pointerDown) {
							self.cButtId = e.data.id;
							self._onButton = true;
							self._wheel = false;

							//If NOT already down..
							if ($this.css('opacity') > .5) {
								$this.css('opacity', 1);
								$holder.find('#' + buttons[self.cButtId]._var + 'norm').hide();
								$holder.find('#' + buttons[self.cButtId]._var + 'over').show();

								//CASE 1: If zoomIn pressed and single step zoom enabled
								if (self.cButtId <= 1 && self.zoom_single) {
									if (!cFlag[buttons[self.cButtId]._var]) {
										self.sRed = 300;
										cFlag[buttons[self.cButtId]._var] = true;
									}

									//CASE 2: If any button except RESET pressed
								} else if (self.cButtId < 6) {
									cFlag[buttons[self.cButtId]._var] = true;

									//CASE 3: RESET pressed
								} else {
									cFlag._rs = true;
									self.rA = self.rR;
									if (self.reset_align[0] == 'top') {
										self.fY = (self.sH / 2) * (self.rA / 2);
									} else if (self.reset_align[0] == 'bottom') {
										self.fY = -(self.sH / 2) * (self.rA / 2);
									} else {
										self.fY = 0;
									}
									if (self.reset_align[1] == 'left') {
										self.fX = (self.sW / 2) * (self.rA / 2);
									} else if (self.reset_align[1] == 'right') {
										self.fX = -(self.sW / 2) * (self.rA / 2);
									} else {
										self.fX = 0;
									}
								}

								self.focusOffX = self.focusOffY = 0;
								self.changeOffset(true, true);
								if (!self._playing) {
									self.Animate();
								}
							}
							e.preventDefault();
							e.stopPropagation();
						}
					});

				//Make 2 BGs for Button Normal and Over state
				//Button BG normal
				var tpm = $(
					'<div id="' + buttons[i]._var + 'norm" style="position: absolute; left: 1px; top: 1px; width: ' + buttons[i].w + 'px; height: ' + buttons[i].h + 'px; ' + (prop_radius || !self.bu_round ? 'background:' + self.bu_color : '') + '"></div>'
				);

				//Button BG hover
				var tpmo = $(
					'<div id="' + buttons[i]._var + 'over" style="position: absolute; left: 0px; top: 0px; width: ' + (buttons[i].w + 2) + 'px; height: ' + (buttons[i].h + 2) + 'px; display: none; ' + (prop_radius || !self.bu_round ? 'background:' + self.bu_color : '') + '"></div>'
				);

				//Add the button icons
				var cont = $(
					'<div id="' + buttons[i]._var + '_icon" style="position: absolute; left: 1px; top: 1px; width: ' + buttons[i].w + 'px; height: ' + buttons[i].h + 'px; background: transparent url(' + self.bu_icon + ') ' + buttons[i].bx + 'px ' + buttons[i].by + 'px no-repeat;" ></div>'
				);

				buttons[i].$ob.append(tpm, tpmo, cont);
				$controls.append(buttons[i].$ob);

				//Apply corner radius
				if (self.bu_round) {
					if (prop_radius) {
						tpm.css(prop_radius, '2px');
						tpmo.css(prop_radius, '2px');
					} else {
						self.roundBG(
							tpm,
							buttons[i]._var + "norm",
							buttons[i].w,
							buttons[i].h,
							2,
							425,
							self.bu_color,
							self.bu_icon,
							i + 1,
							iconOff ? 50 : 0
						);
						self.roundBG(
							tpmo,
							buttons[i]._var + "over",
							buttons[i].w + 2,
							buttons[i].h + 2,
							2,
							425,
							self.bu_color,
							self.bu_icon,
							i + 1,
							iconOff ? 50 : 0
						);
					}
				}
			}

			//Add Events for mouse drag / touch swipe action
			$(document).bind(self.event_up + self.id, {self: self}, self.mouseUp);

			if ((self.mouse_drag && !self.hasTouch) || (self.touch_drag && self.hasTouch)) {
				self.$holder.bind(self.event_down, {self: self}, self.mouseDown);
				if (self.hasTouch) {
					$(document).bind(self.event_move + self.id, {self: self}, self.mouseDrag);
				}
			}

			//Add Double click / Double tap zoom
			if (self.mouse_dbl_click) {
				var dClickedX,
					dClickedY,
					dbl_click_dir = 1;

				self.$holder.bind('dblclick.sz', function (e) {
					self.focusOffX = e.pageX - $holder.offset().left - (self.sW / 2);
					self.focusOffY = e.pageY - $holder.offset().top - (self.sH / 2);
					self.changeOffset(true, true);
					self._wheel = false;

					if (self.rA < self.zoom_max && dbl_click_dir == -1 && dClickedX != self.focusOffX && dClickedY != self.focusOffY) {
						dbl_click_dir = 1;
					}

					dClickedX = self.focusOffX;
					dClickedY = self.focusOffY;

					if (self.rA >= self.zoom_max && dbl_click_dir == 1) {
						dbl_click_dir = -1;
					}
					if (self.rA <= self.rF && dbl_click_dir == -1) {
						dbl_click_dir = 1;
					}
					if (dbl_click_dir > 0) {
						self.rA *= 2;
						self.rA = self.rA > self.zoom_max ? self.zoom_max : self.rA;
						cFlag._zi = true;
						clearTimeout(self.ani_timer);
						self._playing = true;
						self.Animate();
						cFlag._zi = false;

					} else {
						self.rA /= 2;
						self.rA = self.rA < self.rF ? self.rF : self.rA;
						cFlag._zo = true;
						clearTimeout(self.ani_timer);
						self._playing = true;
						self.Animate();
						cFlag._zo = false;
					}
					e.preventDefault();
					e.stopPropagation();
				});
			}

			//Add mouse wheel event if enabled
			if (self.mouse_wheel) {
				$holder.bind('mousewheel.sz', {self: this}, self.mouseWheel);
			}

			//Auto Hide the control buttons if enabled
			if (self.bu_auto) {
				$holder.bind('mouseleave.sz', {self: this}, self.autoHide);
			}

			//Prevent Controls Bg from start dragging image
			$controls.bind(self.event_down, function (e) {
				e.preventDefault();
				e.stopPropagation();
			});

			//Prevent Controls Bg from double click zoom
			if (self.mouse_dbl_click) {
				$controls.bind('dblclick.sz', function (e) {
					e.preventDefault();
					e.stopPropagation();
				});
			}

			//Prevent text selection for smoother dragging and button focus
			$('.noSel').each(function () {
				this.onselectstart = function () {
					return false;
				};
			});

			self.$holder = $holder;
			self.$controls = $controls;
			self.sW = sW;
			self.sH = sH;
			self.cBW = cBW;
			self.cBH = cBH;

			//Apply initial transformation
			self.Animate();
		},


		/*Prepare the container (holder) element and get landmarks if available
		 ***********************************************************************************************************************/
		setContainer: function () {
			var self = this,
				$image = self.$image,
				bord_size = self.bord_size,
				border = self.border,
				$holder = self.$holder;

			//Wrap a container for image or get the container if specified through options:
			if (self.container == '' && self.image_url == '') {
				$holder = self.$image.wrap(
					'<div class="noSel smooth_zoom_preloader"></div>'
				).parent();

			} else {
				if (self.image_url == '') {
					$holder = $('#' + self.container);
				} else {
					$holder = self.$elem;
				}
				$holder.addClass('noSel smooth_zoom_preloader');
				self.locations = [];
				self.$loc_cont = $holder.find('.landmarks');
				if (self.$loc_cont[0]) {
					var locs = self.$loc_cont.children('.item');
					self.loc_clone = self.$loc_cont.clone();
					self.show_at_zoom = parseInt(self.$loc_cont.data('show-at-zoom'), 10) / 100;
					self.allow_scale = checkBoolean(self.$loc_cont.data('allow-scale'));
					self.allow_drag = checkBoolean(self.$loc_cont.data('allow-drag'));
					locs.each(function () {
						self.setLocation($(this));
					});
				}
			}

			$holder.css({
				'position': 'relative',
				'overflow': 'hidden',
				'text-align': 'left',
				'-moz-user-select': 'none',
				'-khtml-user-select': 'none',
				'-webkit-user-select': 'none',
				'user-select': 'none',
				'-webkit-touch-callout': 'none',
				'-ms-touch-action': 'none',
				'-webkit-tap-highlight-color': 'rgba(255, 255, 255, 0)',
				'background-color': self.bg_color,
				'background-position': 'center center',
				'background-repeat': 'no-repeat'
			})

			self.$hitArea = $('<div style="position: absolute; z-index: 1; top: 0px; left: 0px; width: 100%; height: 100%;" ></div>').appendTo($holder);

			self.getContainerSize(self.sW, self.sH, $holder, self.w_max, self.h_max);

			if (self.responsive) {
				$(window).bind("orientationchange.sz" + self.id + " resize.sz" + self.id, {self: self}, self.resize);
			}
			var sW = self.sW;
			var sH = self.sH;

			//Add Image container properties
			$holder.css({
				'width': sW,
				'height': sH
			});

			//Add border if needed
			if (bord_size > 0) {
				border[0] = $('<div style="position: absolute;	width: ' + bord_size + 'px; height: ' + sH + 'px;	top: 0px; left: 0px; z-index: 3; background-color: ' + self.bord_color + ';"></div>').css('opacity', self.bord_alpha);
				border[1] = $('<div style="position: absolute;	width: ' + bord_size + 'px; height: ' + sH + 'px;	top: 0px; left: ' + (sW - bord_size) + 'px; z-index: 4; background-color: ' + self.bord_color + ';"></div>').css('opacity', self.bord_alpha);
				border[2] = $('<div style="position: absolute;	width: ' + (sW - (bord_size * 2)) + 'px; height: ' + bord_size + 'px; top: 0px; left: ' + bord_size + 'px; z-index: 5; background-color: ' + self.bord_color + '; line-height: 1px;"></div>').css('opacity', self.bord_alpha);
				border[3] = $('<div style="position: absolute;	width: ' + (sW - (bord_size * 2)) + 'px; height: ' + bord_size + 'px; top: ' + (sH - bord_size) + 'px; left: ' + bord_size + 'px; z-index: 6; background-color: ' + self.bord_color + '; line-height: 1px;"></div>').css('opacity', self.bord_alpha);
				$holder.append(border[0], border[1], border[2], border[3]);
			}

			//Get Image maps if exists
			if ($image.attr('usemap') != undefined) {
				self.mapAreas = $("map[name='" + ($image.attr('usemap').split('#').join('')) + "']").children('area');
				self.mapAreas.each(function (i) {
					var area = $(this);
					area.css('cursor', 'pointer');
					if (self.mouse_drag) {
						area.bind(self.event_down, {self: self}, self.mouseDown);
					}
					if (self.mouse_wheel) {
						area.bind('mousewheel.sz', {self: self}, self.mouseWheel);
					}
					self.map_coordinates.push(area.attr('coords').split(','));
				});
			}

			self.$holder = $holder;
			self.sW = sW;
			self.sH = sH;
		},

		getContainerSize: function (sW, sH, $holder, w_max, h_max) {
			if (sW === '' || sW === 0) {
				if (this.image_url == '') {
					sW = Math.max($holder.parent().width(), 100);
				} else {
					sW = Math.max($holder.width(), 100);
				}

			} else if (!isNaN(sW) || String(sW).indexOf('px') > -1) {
				sW = this.oW = parseInt(sW);
				if (this.responsive) {
					sW = Math.min($holder.parent().width(), sW);
				}
			} else if (String(sW).indexOf('%') > -1) {
				sW = $holder.parent().width() * (sW.split('%')[0] / 100);
			} else {
				sW = 100;
			}
			if (w_max !== 0 && w_max !== '') {
				sW = Math.min(sW, w_max);
			}
			if (sH === '' || sH === 0) {
				if (this.image_url == '') {
					sH = Math.max($holder.parent().height(), 100);
				} else {
					sH = Math.max($holder.height(), 100);
				}
			} else if (!isNaN(sH) || String(sH).indexOf('px') > -1) {
				sH = this.oH = parseInt(sH);

			} else if (String(sH).indexOf('%') > -1) {
				sH = $holder.parent().height() * (sH.split('%')[0] / 100);
			} else {
				sH = 100;
			}
			if (h_max !== 0 && h_max !== '') {
				sH = Math.min(sH, h_max);
			}

			if (this.oW && sW !== this.oW) {
				if (this.oH && this.maintain_ratio) {
					sH = sW / (this.oW / this.oH);
				}
			}

			this.sW = sW;
			this.sH = sH;
		},


		/*Each landmark / location / lable initiated here
		 ***********************************************************************************************************************/
		setLocation: function (lc) {
			var self = this,
				ob = lc,
				w2, h2, pos, sc;

			if (prop_origin) {
				ob.css(prop_origin, '0 0');
			}

			ob.css({
				'display': 'block',
				'z-index': 2
			})
			if (self.use3D) {
				ob.css({
					'-webkit-backface-visibility': 'hidden',
					'-webkit-perspective': 1000
				});
			}

			w2 = ob.outerWidth() / 2;
			h2 = ob.outerHeight() / 2;
			pos = ob.data('position').split(',');
			sc = ob.data('allow-scale');
			if (sc == undefined) {
				sc = self.allow_scale;
			} else {
				sc = checkBoolean(sc);
			}

			if (ob.hasClass('mark')) {
				var imgw = ob.find('img').css('vertical-align', 'bottom').width();
				$(ob.children()[0]).css({
					'position': 'absolute',
					'left': (-ob.width() / 2),
					'bottom': parseInt(ob.css('padding-bottom')) * 2
				});
				var txt = ob.find('.text');
				self.locations.push({
					ob: ob,
					x: parseInt(pos[0]),
					y: parseInt(pos[1]),
					w2: w2,
					h2: h2,
					w2pad: w2 + (txt[0] ? parseInt(txt.css('padding-left')) : 0),
					vis: false,
					lab: false,
					lpx: '0',
					lpy: '0',
					showAt: isNaN(ob.data('show-at-zoom')) ? self.show_at_zoom : parseInt(ob.data('show-at-zoom'), 10) / 100,
					scale: sc
				});

			} else if (ob.hasClass('lable')) {
				var bg = ob.data('bg-color'),
					opacity = ob.data('bg-opacity'),
					cont = $(ob.eq(0).children()[0])
						.css({
							'position': 'absolute',
							'z-index': 2,
							left: -w2,
							top: -h2
						});

				self.locations.push({
					ob: ob,
					x: parseInt(pos[0]),
					y: parseInt(pos[1]),
					w2: w2,
					h2: h2,
					w2pad: w2,
					vis: false,
					lab: true,
					lpx: '0',
					lpy: '0',
					showAt: isNaN(ob.data('show-at-zoom')) ? self.show_at_zoom : parseInt(ob.data('show-at-zoom'), 10) / 100,
					scale: sc
				});

				if (bg !== "") {
					if (!bg) {
						bg = "#000000";
						opacity = .7;
					}
					var bgob = $('<div style="position: absolute; left: ' + (-w2) + 'px; top: ' + (-h2) + 'px; width: ' + ((w2 - parseInt(cont.css('padding-left'))) * 2) + 'px; height:' + ((h2 - parseInt(cont.css('padding-top'))) * 2) + 'px; background-color: ' + bg + ';"></div>').appendTo(ob);
					if (opacity) {
						bgob.css('opacity', opacity);
					}
				}
			}
			ob.hide();
			if (prop_transform) {
				ob.css('opacity', 0);
			}
			if (!self.allow_drag) {
				ob.bind(self.event_down, function (e) {
					//e.preventDefault();
					e.stopPropagation();
				})
			}
		},

		/*Storing the original style of image (needed only when destroying)
		 ***********************************************************************************************************************/
		getStyle: function () {
			var el = this.$image;
			return {
				prop_origin: [prop_origin, prop_origin !== false && prop_origin !== undefined ? el.css(prop_origin) : null],
				prop_transform: [prop_transform, prop_transform !== false && prop_transform !== undefined ? el.css(prop_transform) : null],
				'position': ['position', el.css('position')],
				'z-index': ['z-index', el.css('z-index')],
				'cursor': ['cursor', el.css('cursor')],
				'left': ['left', el.css('left')],
				'top': ['top', el.css('top')],
				'width': ['width', el.css('width')],
				'height': ['height', el.css('height')]
			};
		},

		/*Find the scale ratios
		 ***********************************************************************************************************************/
		checkRatio: function (sW, sH, iW, iH, zoom_fit) {
			var rF;
			if (iW == sW && iH == sH) {
				rF = 1;
			} else if (iW < sW && iH < sH) {
				rF = sW / iW;
				if (zoom_fit) {
					if (rF * iH > sH) {
						rF = sH / iH;
					}
				} else {
					if (rF * iH < sH) {
						rF = sH / iH;
					}
					if (sW / iW !== sH / iH && this.mouse_drag) {
						this._moveCursor = true;
						this.$image.css('cursor', 'move');
						this.$hitArea.css('cursor', 'move');
					}
				}
			} else {

				rF = sW / iW;
				if (zoom_fit) {
					if (rF * iH > sH) {
						rF = sH / iH;
					}
					if (rF < this.init_zoom && this.mouse_drag) {
						this._moveCursor = true;
						this.$image.css('cursor', 'move');
						this.$hitArea.css('cursor', 'move');
					}
				} else {
					if (rF * iH < sH) {
						rF = sH / iH;
					}
					if (sW / iW !== sH / iH && this.mouse_drag) {
						this._moveCursor = true;
						this.$image.css('cursor', 'move');
						this.$hitArea.css('cursor', 'move');
					}
				}
			}
			return rF;
		},


		/*Returns distance between 2 points (used for touch gesture)
		 ***********************************************************************************************************************/
		getDistance: function (x1, y1, x2, y2) {
			return Math.sqrt(Math.abs(((x2 - x1) * (x2 - x1)) + ((y2 - y1) * (y2 - y1))));
		},


		/*Image Events for Dragging and Mouse Wheel
		 ***********************************************************************************************************************/
		mouseDown: function (e) {
			var self = e.data.self,
				te = e.originalEvent,
				touches, fingers, pointerMouse;
			self._onfocus = self._dragging = false;

			if (self.cFlag._nd) {
				self._onHitArea = true;
				self.samePointRelease = false;
				if (self.fixMoz) {
					self.correctTransValue();
				}
				if (e.type == self.pointerDown) {
					pointerMouse = (te.MSPOINTER_TYPE_MOUSE && te.pointerType === te.MSPOINTER_TYPE_MOUSE) || te.pointerType == 'mouse';
					self.pointers.push({pageX: te.pageX, pageY: te.pageY, id: te.pointerId});
					fingers = self.pointers.length;
					touches = self.pointers;
				}
				if (e.type == 'mousedown' || pointerMouse) {
					self.stX = te.pageX || e.pageX;
					self.stY = te.pageY || e.pageY;
					self.offX = self.stX - self.$holder.offset().left - self.$image.position().left;
					self.offY = self.stY - self.$holder.offset().top - self.$image.position().top;
					$(document).bind(self.event_move + self.id, {self: self}, self.mouseDrag);

				} else {
					if (e.type == 'touchstart') {
						fingers = te.targetTouches.length;
						touches = te.touches;
					}
					if (fingers > 1) {
						self._pinching = true;
						self._rA = self.rA;
						self.dStart = self.getDistance(touches[0].pageX, touches[0].pageY, touches[1].pageX, touches[1].pageY);
					} else {
						self.customPageXDrugStart = touches[0].pageX;//!
						self.customPageYDrugStart = touches[0].pageY;//!
						self.offX = touches[fingers - 1].pageX - self.$holder.offset().left - self.$image.position().left;
						self.offY = touches[fingers - 1].pageY - self.$holder.offset().top - self.$image.position().top;
						self.setDraggedPos(touches[fingers - 1].pageX - self.$holder.offset().left - self.offX, touches[fingers - 1].pageY - self.$holder.offset().top - self.offY, self._sc);
						self._recent = 'drag';
						self._dragging = true;
					}
				}

			}
			if (e.type == 'mousedown' || e.type == self.pointerDown) {
				e.preventDefault();
			}
		},


		/*Mouse Drag / Touch swipe operations handled here
		 ***********************************************************************************************************************/
		mouseDrag: function (e) {
			var self = e.data.self,
				te = e.originalEvent,
				touches, fingers;

			//Mouse
			if (e.type == 'mousemove') {
				self.setDraggedPos(e.pageX - self.$holder.offset().left - self.offX, e.pageY - self.$holder.offset().top - self.offY, self._sc);
				self._recent = 'drag';
				self._dragging = true;
				if (!self._playing) {
					self.Animate();
				}
				return false;

				//Touch and pointer
			} else {
				if (self._dragging || self._pinching) {
					e.preventDefault();
				}
				if (self._onHitArea) {

					//Pointer
					if (e.type == self.pointerMove) {
						for (var j = 0; j < self.pointers.length; j++) {
							if (te.pointerId == self.pointers[j].id) {
								self.pointers[j].pageX = te.pageX;
								self.pointers[j].pageY = te.pageY;
							}
						}
						touches = self.pointers;
						fingers = self.pointers.length;

						//Touch
					} else {
						touches = te.touches;
						fingers = touches.length;
					}

					//Multi finger movement / pinch zoom
					if (fingers > 1) {
						if (!self._pinching) {
							self._pinching = true;
							self._rA = self.rA;
							self.dStart = self.getDistance(touches[0].pageX, touches[0].pageY, touches[1].pageX, touches[1].pageY);
						}
						self._centx = (touches[0].pageX + touches[1].pageX) / 2;
						self._centy = (touches[0].pageY + touches[1].pageY) / 2;
						self.focusOffX = self._centx - self.$holder.offset().left - (self.sW / 2);
						self.focusOffY = self._centy - self.$holder.offset().top - (self.sH / 2);
						self.changeOffset(true, true);
						self._wheel = true;
						self._dragging = false;
						if (self.zoom_single) {
							self.sRed = 300;
						} else {
							self.dEnd = self.getDistance(touches[0].pageX, touches[0].pageY, touches[1].pageX, touches[1].pageY);
							self.rA = self._rA * (self.dEnd / self.dStart);
							self.rA = self.rA > self.zoom_max ? self.zoom_max : self.rA;
							self.rA = self.rA < self.rF ? self.rF : self.rA;
						}
						if (self._sc < self.rA) {
							self.cFlag._zo = false;
							self.cFlag._zi = true;
						} else {
							self.cFlag._zi = false;
							self.cFlag._zo = true;
						}
						if (!self._playing) {
							self.Animate();
						}

						//Single finer / pointer Drag
					} else {
						self.customPageXDrugEnd = touches[0].pageX;//!
						self.customPageYDrugEnd = touches[0].pageY;//!

						self.setDraggedPos(touches[0].pageX - self.$holder.offset().left - self.offX, touches[0].pageY - self.$holder.offset().top - self.offY, self._sc);
						self._recent = 'drag';
						self._dragging = true;
						if (!self._playing) {
							self.Animate();
						}
						return false;
					}
				}

			}
		},


		/*Global Mouse Up / Touch End
		 ***********************************************************************************************************************/
		mouseUp: function (e) {
			var self = e.data.self;
			self.pointers = [];
			//If one of the buttons released
			if (self._onButton) {
				self.$holder.find('#' + self.buttons[self.cButtId]._var + 'norm').show();
				self.$holder.find('#' + self.buttons[self.cButtId]._var + 'over').hide();
				if (self.cButtId !== 6) {
					self.cFlag[self.buttons[self.cButtId]._var] = false;
				}
				if (e.type == 'touchend' && self.buttons[self.cButtId].$ob.css('opacity') > .5) {
					self.buttons[self.cButtId].$ob.css('opacity', .7);
				}
				self._onButton = false;
				e.stopPropagation();
				return false;

				//If the mouse drag or touch swipe completed
			} else if (self._onHitArea) {
				if (!self.hasTouch) {
					$(document).unbind(self.event_move + self.id);
				}
				if (self.mouse_drag || self.touch_drag) {

					//Mouse
					if (e.type == 'mouseup') {
						if (self.stX == e.pageX && self.stY == e.pageY) {
							self.samePointRelease = true;
						}
						self._recent = 'drag';
						self._dragging = false;
						if (!self._playing) {
							self.Animate();
						}

						//Touch & Pointers
					} else {
						e.preventDefault();
						self._dragging = false;

						if (self._pinching) {
							self._pinching = false;
							self._wheel = false;
							self.cFlag._nd = true;
							self.cFlag._zi = false;
							self.cFlag._zo = false;
						} else {
							self._recent = 'drag';
							if (!self._playing) {
								self.Animate();
							}
							//!
							if (self.rA == self.rF && Math.abs(self.customPageXDrugStart - self.customPageXDrugEnd) > Math.abs(self.customPageYDrugStart - self.customPageYDrugEnd)) { //!
								if (self.customPageXDrugStart > self.customPageXDrugEnd) {
									$('#nextZoomImage').trigger('click');
								} else {
									$('#prevZoomImage').trigger('click');
								}
							}
							if (typeof(self.customPageXDrugEnd) == 'undefined' || (self.customPageXDrugStart == self.customPageXDrugEnd)) { // touch
								if (isMobileDevice) {
									if (!doubletapTimer) { //if tap is not set, set up single tap
										doubletapTimer = setTimeout(function () {
											doubletapTimer = null
											//insert things you want to do when single tapped
											$('#zoomButtons').toggleClass('zoomButtonsShown');
											$('#closeZoomImage').toggleClass('zoomButtonsShown');
										}, 200);   //wait 300ms then run single click code
									} else {    //tapped within 300ms of last tap. double tap
										clearTimeout(doubletapTimer); //stop single tap callback
										doubletapTimer = null
										//insert things you want to do when double tapped
										//if (currentCabinetUserId == 1) {
										var currentZoomRatio = $('#zoom_container').smoothZoom('getZoomData').ratio;
										;
										var zoomData = $('#zoom_container').smoothZoom('getZoomData');
										if (initialZoomData.ratio < currentZoomRatio)
											//$('#zoom_container').smoothZoom('zoomOut');
											$('#zoom_container').smoothZoom('focusTo', {
												x: initialZoomData.centerX,
												y: initialZoomData.centerY,
												zoom: initialZoomData.ratio * 100,
												speed: 10
											});
										else
											$('#zoom_container').smoothZoom('focusTo', {
												x: zoomData.centerX,
												y: zoomData.centerY,
												zoom: 70,
												speed: 10
											});
//                                                                        if (initialZoomRatio < currentZoomRatio)
//                                                                            $('#zoom_container').smoothZoom('zoomOut');
//                                                                        else $('#zoom_container').smoothZoom('zoomIn');
										//}
										//alert('dbl custom');
									}
								}
								//$('#zoomButtons').toggleClass('zoomButtonsShown');
								//$('#closeZoomImage').toggleClass('zoomButtonsShown');
							}
							delete self.customPageXDrugEnd;
							//! END
						}
					}
					self._onHitArea = false;
				}
			}
		},


		/*Mouse wheel zoom in-out
		 ***********************************************************************************************************************/
		mouseWheel: function (e, delta) {
			//!
			var d = new Date();
			var time = d.getTime();
			if (time - this.lastMouseWheelEventTime < 150)
				return false;
			this.lastMouseWheelEventTime = time;
//                        console.log(delta, 'delta');
//                        console.log(e, 'e');//!
			var self = e.data.self;
			self._onfocus = self._dragging = false;
			if (self.mouse_wheel_cur) {
				self.focusOffX = e.pageX - self.$holder.offset().left - (self.sW / 2);
				self.focusOffY = e.pageY - self.$holder.offset().top - (self.sH / 2);
				self.changeOffset(true, true);
			}

			self._dragging = false;
			if (delta > 0) {
				delta = 1;//!
				if (self.rA != self.zoom_max) {
					if (self.zoom_single) {
						if (!self._wheel) {
							self.sRed = 300;
						}
					} else {
						self.rA *= delta < 1 ? 1 + (.3 * delta) : 1.3;
						self.rA = self.rA > self.zoom_max ? self.zoom_max : self.rA;
					}
					self._wheel = true;
					self.cFlag._zi = true;
					clearTimeout(self.ani_timer);
					self._playing = true;
					self.Animate();
					self.cFlag._zi = false;
				}
			} else {
				delta = -1;//!
				if (self.rA != self.rF) {
					if (self.zoom_single) {
						if (!self._wheel) {
							self.sRed = 300;
						}
					} else {
						self.rA /= delta > -1 ? 1 + (.3 * -delta) : 1.3;
						self.rA = self.rA < self.rF ? self.rF : self.rA;
					}
					self._wheel = true;
					self.cFlag._zo = true;
					clearTimeout(self.ani_timer);
					self._playing = true;
					self.Animate();
					self.cFlag._zo = false;
				}
			}
			return false;
		},


		/*Control buttons Auto hide
		 ***********************************************************************************************************************/
		autoHide: function (e) {
			var self = e.data.self;

			clearTimeout(self.auto_timer);
			self.auto_timer = setTimeout(function () {
				self.$controls.fadeOut(600);
			}, self.bu_delay);

			self.$holder.bind('mouseenter.sz', function (e) {
				clearTimeout(self.auto_timer);
				self.$controls.fadeIn(300);
			});
		},


		/*Mozilla works differently than others when getting translated positions. So this correction needed
		 ***********************************************************************************************************************/
		correctTransValue: function () {
			var v = this.$image.css('-moz-transform').toString().replace(')', '').split(',');
			this.transOffX = parseInt(v[4]);
			this.transOffY = parseInt(v[5]);
		},


		/*Make sure the dragged position obeying limits
		 ***********************************************************************************************************************/
		setDraggedPos: function (xp, yp, s) {
			var self = this;

			if (xp !== '') {
				self.dX = xp + self.transOffX;
				if (self.pan_limit) {
					self.dX = self.dX + (s * self.iW) < self.sW ? self.sW - (s * self.iW) : self.dX;
					self.dX = self.dX > 0 ? 0 : self.dX;
					if ((s * self.iW) < self.sW) {
						self.dX = (self.sW - (s * self.iW)) / 2;
					}
				} else {
					self.dX = self.dX + (s * self.iW) < self.sW / 2 ? (self.sW / 2) - (s * self.iW) : self.dX;
					self.dX = self.dX > self.sW / 2 ? self.sW / 2 : self.dX;
				}
			}
			if (yp !== '') {
				self.dY = yp + self.transOffY;
				if (self.pan_limit) {
					self.dY = self.dY + (s * self.iH) < self.sH ? self.sH - (s * self.iH) : self.dY;
					self.dY = self.dY > 0 ? 0 : self.dY;
					if ((s * self.iH) < self.sH) {
						self.dY = (self.sH - (s * self.iH)) / 2;
					}
				} else {
					self.dY = self.dY + (s * self.iH) < self.sH / 2 ? (self.sH / 2) - (s * self.iH) : self.dY;
					self.dY = self.dY > self.sH / 2 ? self.sH / 2 : self.dY;
				}
			}
		},

		/*Called to animate image transformation whenever the navigation events occur
		 ***********************************************************************************************************************/
		Animate: function () {

			var self = this;
			var pixTol = .5;

			self.cFlag._nd = true;
			self.ani_end = false;

			//Zoom In
			if (self.cFlag._zi) {
				if (!self._wheel && !self.zoom_single) {
					self.rA *= self.zoom_speed;
				}
				if (self.rA > self.zoom_max) {
					self.rA = self.zoom_max;
				}
				self.cFlag._nd = false;
				self.cFlag._rs = false;
				self._recent = 'zoomIn';
				self._onfocus = self._dragging = false;
			}

			//Zoom Out
			if (self.cFlag._zo) {
				if (!self._wheel && !self.zoom_single) {
					self.rA /= self.zoom_speed;
				}
				if (self.zoom_min != 0) {
					if (self.rA < self.zoom_min) {
						self.rA = self.zoom_min;
					}
				} else {
					if (self.rA < self.rF) {
						self.rA = self.rF;
					}
				}

				self.cFlag._nd = false;
				self.cFlag._rs = false;
				self._recent = 'zoomOut';
				self._onfocus = self._dragging = false;
			}

			//Zoom In or Out - Single Step
			if (self.zoom_single && !self.cFlag._rs) {
				if (self._recent == 'zoomIn') {
					self.sRed += (10 - self.sRed) / 6;
					self.rA += (self.zoom_max - self.rA) / (((1 / (self.pan_speed_o + 1)) * self.sRed) + 1);

				} else if (self._recent == 'zoomOut') {
					self.sRed += (3 - self.sRed) / 3;
					self.rA += (self.rF - self.rA) / (((1 / self.pan_speed_o + 1) * self.sRed) + 1);
				}
			}

			//Pan speed needs to adjust according to application dimension and zoom level
			self.pan_speed = (Math.max(1, 1 + ((self.sW + self.sH) / 500)) + (self.pan_speed_o * self.pan_speed_o / 4)) / Math.max(1, self.rA / 2);

			//Move Left
			if (self.cFlag._ml) {
				self.oX -= self.pan_speed;
				self.cFlag._nd = false;
				self.cFlag._rs = false;
				self._recent = 'left';
				self._onfocus = self._dragging = false;
			}

			//Move Right
			if (self.cFlag._mr) {
				self.oX += self.pan_speed;
				self.cFlag._nd = false;
				self.cFlag._rs = false;
				self._recent = 'right';
				self._onfocus = self._dragging = false;
			}

			//Move Up
			if (self.cFlag._mu) {
				self.oY -= self.pan_speed;
				self.cFlag._nd = false;
				self.cFlag._rs = false;
				self._recent = 'up';
				self._onfocus = self._dragging = false;
			}

			//Move Down
			if (self.cFlag._md) {
				self.oY += self.pan_speed;
				self.cFlag._nd = false;
				self.cFlag._rs = false;
				self._recent = 'down';
				self._onfocus = self._dragging = false;
			}

			//Reset
			if (self.cFlag._rs) {
				self.oX += (self.fX - self.oX) / 8;
				self.oY += (self.fY - self.oY) / 8;
				self.cFlag._nd = false;
				self._recent = 'reset';
				self._onfocus = self._dragging = false;
			}

			//Find scale value, width and height
			//Case 1: Single Step Zoom
			if (self.zoom_single && (self._recent !== 'reset')) {
				if (self._onfocus) {
					self._sc += (self.rA - self._sc) / self.reduction;
				} else {
					self._sc = self.rA;
				}

				//Case 2: Normal Zoom
			} else {
				self._sc += (self.rA - self._sc) / (self.ani_smooth / (self._onfocus ? self.reduction : 1));
			}

			self._w = self._sc * self.iW;
			self._h = self._sc * self.iH;

			//Dragging
			if (self._dragging) {
				self.tX = self.dX;
				self.tY = self.dY;
				self.changeOffset(true, true);
			}

			//Check if Zoom In completed
			if (self._recent == "zoomIn") {
				if (self._w > (self.rA * self.iW) - pixTol && !self.zoom_single) {
					if (self.cFlag._nd) {
						self.ani_end = true;
					}
					self._sc = self.rA;
				} else if (self._w > (self.zoom_max * self.iW) - pixTol && self.zoom_single) {
					if (self.cFlag._nd) {
						self.ani_end = true;
					}
					self._sc = self.rA = self.zoom_max;
				}
				if (self.ani_end) {
					self._w = self._sc * self.iW;
					self._h = self._sc * self.iH;
				}

				//Check if Zoom Out completed
			} else if (self._recent == "zoomOut") {
				if (self._w < (self.rA * self.iW) + pixTol && !self.zoom_single) {
					if (self.cFlag._nd) {
						self.ani_end = true;
					}
					self._sc = self.rA;
				} else if (self._w < (self.rF * self.iW) + pixTol && self.zoom_single) {
					if (self.cFlag._nd) {
						self.ani_end = true;
					}
					self._sc = self.rA = self.rF;
				}
				if (self.ani_end) {
					self._w = self._sc * self.iW;
					self._h = self._sc * self.iH;
				}
			}

			//Move image according to boundary limits
			self.limitX = (((self._w - self.sW) / (self._w / self.sW)) / 2);
			self.limitY = (((self._h - self.sH) / (self._h / self.sH)) / 2);

			if (!self._dragging) {
				if (self.pan_limit) {
					if (self.oX < -self.limitX - self.focusOffX) {
						self.oX = -self.limitX - self.focusOffX;
					}
					if (self.oX > self.limitX - self.focusOffX) {
						self.oX = self.limitX - self.focusOffX;
					}
					if (self._w < self.sW) {
						self.tX = (self.sW - self._w) / 2;
						self.changeOffset(true, false);
					}
					if (self.oY < -self.limitY - self.focusOffY) {
						self.oY = -self.limitY - self.focusOffY;
					}
					if (self.oY > self.limitY - self.focusOffY) {
						self.oY = self.limitY - self.focusOffY;
					}
					if (self._h < self.sH) {
						self.tY = (self.sH - self._h) / 2;
						self.changeOffset(false, true);
					}
				} else {
					if (self.oX < -self.limitX - (self.focusOffX / self._w * self.sW) - ((self.sW / 2) / (self._w / self.sW))) {
						self.oX = -self.limitX - (self.focusOffX / self._w * self.sW) - ((self.sW / 2) / (self._w / self.sW));
					}

					if (self.oX > self.limitX - (self.focusOffX / self._w * self.sW) + ((self.sW / 2) / (self._w / self.sW))) {
						self.oX = self.limitX - (self.focusOffX / self._w * self.sW) + ((self.sW / 2) / (self._w / self.sW));
					}

					if (self.oY < -self.limitY - (self.focusOffY / self._h * self.sH) - (self.sH / (self._h / self.sH * 2))) {
						self.oY = -self.limitY - (self.focusOffY / self._h * self.sH) - (self.sH / (self._h / self.sH * 2));
					}

					if (self.oY > self.limitY - (self.focusOffY / self._h * self.sH) + (self.sH / (self._h / self.sH * 2))) {
						self.oY = self.limitY - (self.focusOffY / self._h * self.sH) + (self.sH / (self._h / self.sH * 2));
					}
				}
			}
			if (!self._dragging && self._recent != "drag") {
				self.tX = ((self.sW - self._w) / 2) + self.focusOffX + (self.oX * (self._w / self.sW));
				self.tY = ((self.sH - self._h) / 2) + self.focusOffY + (self.oY * (self._h / self.sH));
				if (self.ani_smooth === 1) {
					self.cFlag._nd = true;
					self.ani_end = true;
				}
			}
			if (self._recent == "zoomIn" || self._recent == "zoomOut" || self.cFlag._rs) {
				self._x = self.tX;
				self._y = self.tY;
			} else {
				self._x += (self.tX - self._x) / (self.ani_smooth / (self._onfocus ? self.reduction : 1));
				self._y += (self.tY - self._y) / (self.ani_smooth / (self._onfocus ? self.reduction : 1));
			}

			//Check if Left movement completed
			if (self._recent == "left") {
				if (self._x < self.tX + pixTol || self.ani_smooth === 1) {
					self.cFlag._nd ? self.ani_end = true : "";
					self._recent = '';
					self._x = self.tX;
				}

				//Check if Right  movement completed
			} else if (self._recent == "right") {
				if (self._x > self.tX - pixTol || self.ani_smooth === 1) {
					self.cFlag._nd ? self.ani_end = true : "";
					self._recent = '';
					self._x = self.tX;
				}

				//Check if Up movement completed
			} else if (self._recent == "up") {
				if (self._y < self.tY + pixTol || self.ani_smooth === 1) {
					self.cFlag._nd ? self.ani_end = true : "";
					self._recent = '';
					self._y = self.tY;
				}

				//Check if Down movement completed
			} else if (self._recent == "down") {
				if (self._y > self.tY - pixTol || self.ani_smooth === 1) {
					self.cFlag._nd ? self.ani_end = true : "";
					self._recent = '';
					self._y = self.tY;
				}

				//Check if Dragging completed
			} else if (self._recent == "drag") {
				if (self._x + pixTol >= self.tX && self._x - pixTol <= self.tX && self._y + pixTol >= self.tY && self._y - pixTol <= self.tY || self.ani_smooth === 1) {
					if (self._onfocus) {
						self._dragging = false;
					}
					self.cFlag._nd ? self.ani_end = true : "";
					self._recent = '';
					self._x = self.tX;
					self._y = self.tY;
				}
			}

			//Check if Reset completed
			if (self.cFlag._rs && self._w + pixTol >= (self.rA * self.iW) && self._w - pixTol <= (self.rA * self.iW) && self.oX <= self.fX + pixTol && self.oX >= self.fX - pixTol && self.oY <= self.fY + pixTol && self.oY >= self.fY - pixTol) {
				self.ani_end = true;
				self._recent = '';
				self.cFlag._rs = false;
				self.cFlag._nd = true;
				self._x = self.tX;
				self._y = self.tY;
				self._sc = self.rA;
				self._w = self._sc * self.iW;
				self._h = self._sc * self.iH;
			}

			//When the image fits exactly to container size, disable the pan, zoom out and reset buttons
			if (self.rA == self.rF && self.iW * self.rA <= self.sW && self.iH * self.rA <= self.sH) {
				if (self.buttons[1].$ob.css('opacity') > .5) {
					if (self.rA >= self.rF && (self.init_zoom == '' || self.rA < self.init_zoom) && (self.zoom_min == '' || self.rA < self.zoom_min)) {
						if (self.pan_limit && self._moveCursor && !self._moveCursor) {
							self.$image.css('cursor', 'default');
							self.$hitArea.css('cursor', 'default');
						}
						for (var bEn = 1; bEn < (self.pan_limit && !self._moveCursor ? self.buttons_total : 2); bEn++) {
							self.buttons[bEn].$ob.css({
								'opacity': .4
							});
							self._wheel = false;
							self.$holder.find('#' + self.buttons[bEn]._var + 'norm').show();
							self.$holder.find('#' + self.buttons[bEn]._var + 'over').hide();
						}
					}
				}

			} else {
				if (self.buttons[1].$ob.css('opacity') < .5) {
					if (self._moveCursor && self.mouse_drag) {
						self.$image.css('cursor', 'move');
						self.$hitArea.css('cursor', 'move');
					}
					for (var bEn = 1; bEn < self.buttons_total; bEn++) {
						self.buttons[bEn].$ob.css('opacity', .7);
					}
				}
			}

			//When the image reaches max zoom, disable the zoom button
			if (self.rA == self.zoom_max) {
				if (self.buttons[0].$ob.css('opacity') > .5) {
					self.buttons[0].$ob.css('opacity', .4);
					self._wheel = false;
					self.$holder.find('#' + self.buttons[0]._var + 'norm').show();
					self.$holder.find('#' + self.buttons[0]._var + 'over').hide();
				}

			} else {
				if (self.buttons[0].$ob.css('opacity') < .5) {
					self.buttons[0].$ob.css('opacity', .7);
				}
			}

			//Apply Scale and position to the image:
			if (prop_transform) {
				self.$image.css(prop_transform, 'translate(' + self._x.toFixed(14) + 'px,' + self._y.toFixed(14) + 'px) scale(' + self._sc + ')');

			} else {
				self.$image.css({
					left: self._x,
					top: self._y,
					width: self._w,
					height: self._h
				});
			}

			if (self.$loc_cont) {
				self.updateLocations(self._x, self._y, self._sc, self.locations);
			}

			//In case image Maps used, update them
			if (!prop_transform && self.map_coordinates.length > 0) {
				self.updateMap();
			}
			//If the animation completed, stop running; else continue
			if (self.ani_end && !self._dragging && self._recent != "drag") {
				self._playing = false;
				self._recent = '';
				self.cX = (-self._x + (self.sW / 2)) / self.rA;
				self.cY = (-self._y + (self.sH / 2)) / self.rA;
				if (self.onUPDATE) {
					self.onUPDATE(self.getZoomData(), false);
				}
				if (self.onZOOM_PAN) {
					self.onZOOM_PAN(self.getZoomData());
				}
				clearTimeout(self.ani_timer);
			} else {
				self._playing = true;
				if (self.onUPDATE) {
					self.onUPDATE(self.getZoomData(), true);
				}
				self.ani_timer = setTimeout(function () {
					self.Animate();
				}, 28);
			}
		},


		/*Relocate the landmarks according to main image's position
		 ***********************************************************************************************************************/
		updateLocations: function (_x, _y, _sc, loc) {

			if (this.onLANDMARK !== '') {
				if (_sc >= this.show_at_zoom) {
					if (!this._landmark) {
						this._landmark = true
						this.onLANDMARK(true);
					}
				} else {
					if (this._landmark) {
						this._landmark = false;
						this.onLANDMARK(false);
					}
				}
			}

			for (var p = 0; p < loc.length; p++) {
				var wScaled,
					hScaled,
					lpx = (loc[p].x * _sc) + _x,
					lpy = (loc[p].y * _sc) + _y;

				if (_sc >= loc[p].showAt) {
					if (loc[p].scale && prop_transform) {
						wScaled = loc[p].w2pad * this._sc;
						hScaled = loc[p].h2 * this._sc;
					} else {
						wScaled = loc[p].w2pad;
						hScaled = loc[p].h2;
					}
					if (lpx > -wScaled && lpx < this.sW + wScaled && ((lpy > -hScaled && lpy < this.sH + hScaled && loc[p].lab) || (lpy > 0 && lpy < this.sH + (hScaled * 2) && !loc[p].lab))) {
						if (!loc[p].vis) {
							loc[p].vis = true;
							if (prop_transform) {
								loc[p].ob.stop()
									.css('display', 'block')
									.animate({
										opacity: 1
									}, 300);
							} else {
								loc[p].ob.show();
							}
						}
					} else {
						if (loc[p].vis) {
							loc[p].vis = false;
							if (prop_transform) {
								loc[p].ob.stop()
									.animate({
										opacity: 0
									}, 200, function () {
										$(this).hide();
									});
							} else {
								loc[p].ob.hide();
							}
						}
					}
				} else {
					if (loc[p].vis) {
						loc[p].vis = false;
						if (prop_transform) {
							loc[p].ob.stop()
								.animate({
									opacity: 0
								}, 200, function () {
									$(this).hide();
								});
						} else {
							loc[p].ob.hide();
						}
					}
				}
				if (lpx !== loc[p].lpx || lpy !== loc[p].lpy && loc[p].vis) {
					if (prop_transform) {
						loc[p].ob.css(prop_transform, 'translate(' + lpx.toFixed(14) + 'px,' + lpy.toFixed(14) + 'px)' + (loc[p].scale ? ' scale(' + this._sc + ')' : ''));
					} else {
						loc[p].ob.css({
							left: lpx,
							top: lpy
						});
					}
				}
				loc[p].lpx = lpx;
				loc[p].lpy = lpy;
			}
		},


		/*If the broswer doesn't supports css border radius, we need to go with old school png image for rounded corner
		 ***********************************************************************************************************************/
		roundBG: function (el, _name, _w, _h, _r, _p, _c, _i, _z, _yoff) {
			var w = 50 / 2;

			el.append($(
				'<div class="bgi' + _name + '" style="background-position:' + (-(_p - _r)) + 'px ' + (-(w - _r) - _yoff) + 'px"></div>' +
				'<div class="bgh' + _name + '"></div>' +
				'<div class="bgi' + _name + '" style="background-position:' + (-_p) + 'px ' + (-(w - _r) - _yoff) + 'px; left:' + (_w - _r) + 'px"></div>' +
				'<div class="bgi' + _name + '" style="background-position:' + (-(_p - _r)) + 'px ' + (-w - _yoff) + 'px; top:' + (_h - _r) + 'px"></div>' +
				'<div class="bgh' + _name + '" style = "top:' + (_h - _r) + 'px; left:' + _r + 'px"></div>' +
				'<div class="bgi' + _name + '" style="background-position:' + (-_p) + 'px ' + (-w - _yoff) + 'px; top:' + (_h - _r) + 'px; left:' + (_w - _r) + 'px"></div>' +
				'<div class="bgc' + _name + '"></div>'
			));
			$('.bgi' + _name).css({
				position: 'absolute',
				width: _r,
				height: _r,
				'background-image': 'url(' + _i + ')',
				'background-repeat': 'no-repeat',
				'-ms-filter': 'progid:DXImageTransform.Microsoft.gradient(startColorstr=#00FFFFFF,endColorstr=#00FFFFFF)',
				'filter': 'progid:DXImageTransform.Microsoft.gradient(startColorstr=#00FFFFFF,endColorstr=#00FFFFFF)',
				'zoom': 1
			});
			$('.bgh' + _name).css({
				position: 'absolute',
				width: _w - _r * 2,
				height: _r,
				'background-color': _c,
				left: _r
			});
			$('.bgc' + _name).css({
				position: 'absolute',
				width: _w,
				height: _h - _r * 2,
				'background-color': _c,
				top: _r,
				left: 0
			});
		},


		/*To calibrate position offset when navigation events supposed to be overlapped
		 ***********************************************************************************************************************/
		changeOffset: function (x, y) {
			if (x) this.oX = (this.tX - ((this.sW - this._w) / 2) - this.focusOffX) / (this._w / this.sW);
			if (y) this.oY = (this.tY - ((this.sH - this._h) / 2) - this.focusOffY) / (this._h / this.sH);
		},


		/*Transform Image Maps (hot spots) if any
		 ***********************************************************************************************************************/
		updateMap: function () {
			var self = this,
				mapId = 0;

			self.mapAreas.each(function () {
				var new_vals = [];
				for (var i = 0; i < self.map_coordinates[mapId].length; i++) {
					new_vals[i] = self.map_coordinates[mapId][i] * self._sc;
				}
				new_vals = new_vals.join(",");
				$(this).attr('coords', new_vals);
				mapId++;
			});
		},


		/*To stop the timer loops immediatly
		 ***********************************************************************************************************************/
		haltAnimation: function () {
			clearTimeout(this.ani_timer);
			this._playing = false;
			this._recent = '';
		},


		/*Method to Remove the plugin instance
		 ***********************************************************************************************************************/
		destroy: function () {
			var self = this;

			if (self.assetsLoaded) {
				self.haltAnimation();
				for (prop in self.orig_style) {
					if (self.orig_style[prop][0] !== false && self.orig_style[prop][0] !== undefined) {
						if (self.orig_style[prop][0] === 'width' || self.orig_style[prop][0] === 'height') {
							if (parseInt(self.orig_style[prop][1]) !== 0) {
								self.$image.css(self.orig_style[prop][0], self.orig_style[prop][1]);
							}
						} else {
							self.$image.css(self.orig_style[prop][0], self.orig_style[prop][1]);
						}
					}
				}
				clearTimeout(self.auto_timer);
				$(document).unbind('.sz' + self.id);
				$(window).unbind('.sz' + self.id);
				self.$holder.unbind('.sz');
				self.$controls = undefined;
			} else {
				self.$image.show();
			}

			if (self.container == '') {
				if (self.image_url == '') {
					self.$image.insertBefore(self.$holder);
					if (self.$holder !== undefined) {
						self.$holder.remove();
					}
				} else {
					self.$elem.empty();
					if (self.$loc_cont[0]) {
						self.$elem.append(self.loc_clone);
					}
				}
			} else {
				self.$image.insertBefore(self.$holder);
				self.$holder.empty();
				self.$image.wrap(self.$holder);
				if (self.$loc_cont[0]) {
					self.$holder.append(self.loc_clone);
				}
			}
			self.$elem.removeData('smoothZoom');
			self.$holder = undefined;
			self.Buttons = undefined;
			self.op = undefined;
			self.$image = undefined;
		},


		/*Method to change focus point and level
		 ***********************************************************************************************************************/
		focusTo: function (params) {
			var self = this;

			if (self.assetsLoaded) {
				if (params.zoom === undefined || params.zoom === '' || params.zoom == 0) {
					params.zoom = self.rA;
				} else {
					params.zoom /= 100;
				}
				self._onfocus = true;
				if (params.zoom > self.rA && self.rA != self.zoom_max) {
					self.rA = params.zoom;
					self.rA = self.rA > self.zoom_max ? self.zoom_max : self.rA;
				} else if (params.zoom < self.rA && self.rA != self.rF) {
					self.rA = params.zoom;
					self.rA = self.rA < self.rF ? self.rF : self.rA;
				}
				self.transOffX = self.transOffY = 0;
				self.setDraggedPos(params.x === undefined || params.x === '' ? "" : (-params.x * self.rA) + (self.sW / 2), params.y === undefined || params.y === '' ? "" : (-params.y * self.rA) + (self.sH / 2), self.rA);
				self.reduction = params.speed ? params.speed / 10 : self.focusSpeed;
				self._recent = 'drag';
				self._dragging = true;
				if (!self._playing) {
					self.Animate();
				}
			}
		},

		zoomIn: function (params) {
			this.buttons[0].$ob.trigger(this.event_down, {
				id: 0
			});
		},

		zoomOut: function (params) {
			this.buttons[1].$ob.trigger(this.event_down, {
				id: 1
			});
		},

		moveRight: function (params) {
			this.buttons[2].$ob.trigger(this.event_down, {
				id: 2
			});
		},

		moveLeft: function (params) {
			this.buttons[3].$ob.trigger(this.event_down, {
				id: 3
			});
		},

		moveUp: function (params) {
			this.buttons[4].$ob.trigger(this.event_down, {
				id: 4
			});
		},

		moveDown: function (params) {
			this.buttons[5].$ob.trigger(this.event_down, {
				id: 5
			});
		},

		Reset: function (params) {
			this.buttons[6].$ob.trigger(this.event_down, {
				id: 6
			});
		},

		getZoomData: function (params) {
			return {
				//x offset (without scale ratio multiplied)
				normX: (-this._x / this.rA).toFixed(14),

				//y offset (without scale ratio multiplied)
				normY: (-this._y / this.rA).toFixed(14),

				//Original image Width
				normWidth: this.iW,

				//Original image height
				normHeight: this.iH,

				//x offset (with scale ratio multiplied)
				scaledX: -this._x.toFixed(14),

				//y offset (with scale ratio multiplied)
				scaledY: -this._y.toFixed(14),

				//Scaled image width
				scaledWidth: this._w,

				//Scaled image height
				scaledHeight: this._h,

				//The X location on image which is currently on center of canvas
				centerX: (-this._x.toFixed(14) + (this.sW / 2)) / this.rA,

				//The Y location on image which is currently on center of canvas
				centerY: (-this._y.toFixed(14) + (this.sH / 2)) / this.rA,

				//Scale ratio
				ratio: this.rA
			};
		},

		addLandmark: function (loc) {
			if (this.$loc_cont) {
				var total = loc.length;

				for (var i = 0; i < total; i++) {
					var $loc = $(loc[i]);
					this.$loc_cont.append($loc);
					this.setLocation($loc);
				}

				if (total > 0) {
					this.updateLocations(this._x, this._y, this._sc, this.locations);
				}
			}
		},

		attachLandmark: function (loc) {
			if (this.$loc_cont) {
				var total = loc.length;
				for (var i = 0; i < total; i++) {
					this.setLocation(loc[i] instanceof jQuery ? loc[i] : $('#' + loc[i]));
				}
				if (total > 0) {
					this.updateLocations(this._x, this._y, this._sc, this.locations);
				}
			}
		},

		removeLandmark: function (loc) {
			if (this.$loc_cont) {
				if (loc) {
					var total = loc.length;
					for (var i = 0; i < total; i++) {
						for (var j = 0; j < this.locations.length; j++) {
							if ((loc[i] instanceof jQuery && this.locations[j].ob[0] == loc[i][0]) || (!(loc[i] instanceof jQuery) && this.locations[j].ob.attr('id') == loc[i])) {
								this.locations[j].ob.remove();
								this.locations.splice(j, 1);
								j--;
							}
						}
					}
				} else {
					if (this.locations.length > 0) {
						this.locations[this.locations.length - 1].ob.remove();
						this.locations.pop();
					}
				}
				if (total > 0) {
					this.updateLocations(this._x, this._y, this._sc, this.locations);
				}
			}
		},

		refreshAllLandmarks: function () {
			var self = this;
			var locs = self.$loc_cont.children('.item');
			self.show_at_zoom = parseInt(self.$loc_cont.data('show-at-zoom'), 10) / 100;
			self.allow_scale = checkBoolean(self.$loc_cont.data('allow-scale'));
			self.allow_drag = checkBoolean(self.$loc_cont.data('allow-drag'));

			//Step 1: Remove records for which the elements no longer exist
			for (var i = 0; i < self.locations.length; i++) {
				var exists = false;
				locs.each(function () {
					if (self.locations[i].ob[0] == $(this)[0]) {
						exists = true;
					}
				});
				if (!exists) {
					self.locations.splice(i, 1);
					i--;
				}
			}

			//Step 2: Add new elements to record
			locs.each(function () {
				var exists = false;
				for (var i = 0; i < self.locations.length; i++) {
					if (self.locations[i].ob[0] == $(this)[0]) {
						exists = true;
						break;
					}
				}
				if (!exists) {
					self.setLocation($(this));
				}

			});
			this.updateLocations(this._x, this._y, this._sc, this.locations);
		},


		/*On windows resize, adjust some defaults
		 ***********************************************************************************************************************/
		resize: function (e) {
			var self;

			if (e.data) {
				e.preventDefault();
				self = e.data.self;
				var pw = self.$holder.parent().width();
				var ph = self.$holder.parent().height();

				if (self.oW) {
					pw = Math.min(pw, self.oW);
				}
				self.sW = pw;

				if (self.oH) {
					if (self.oW && self.maintain_ratio) {
						self.sH = pw / (self.oW / self.oH);
					}
				} else {
					self.sH = ph;
				}


			} else {
				self = this;
				if (e.width) {
					self.sW = e.width;
				}
				if (e.height) {
					self.sH = e.height;
				}
				if (e.max_WIDTH) {
					self.w_max = e.max_WIDTH;
				}
				if (e.max_HEIGHT) {
					self.h_max = e.max_HEIGHT;
				}
			}
			if (self.w_max !== 0 && self.w_max !== '') {
				self.sW = Math.min(self.sW, self.w_max);
			}
			if (self.h_max !== 0 && self.h_max !== '') {
				self.sH = Math.min(self.sH, self.h_max);
			}
			self.$holder.css({
				'width': self.sW,
				'height': self.sH
			});
			if (self.bord_size > 0) {
				self.border[0].height(self.sH);
				self.border[1].css({
					height: self.sH,
					left: self.sW - self.bord_size
				});
				self.border[2].width(self.sW - (self.bord_size * 2));
				self.border[3].css({
					width: self.sW - (self.bord_size * 2),
					top: self.sH - self.bord_size
				});
			}
			if (self.bu_align[1] == 'center') {
				self.$controls.css('left', parseInt((self.sW - self.cBW) / 2));
			}
			if (self.bu_align[0] == 'center') {
				self.$controls.css('top', parseInt((self.sH - self.cBH) / 2));
			}
			self.rF = self.rR = self.checkRatio(self.sW, self.sH, self.iW, self.iH, self.zoom_fit);
			if (self.zoom_min == 0) {
				if (self.rA < self.rF) {
					self.rA = self.rF;
				}
			}

			self.focusTo({
				x: self.cX,
				y: self.cY,
				zoom: '',
				speed: 10
			});
		}
	}


	$.fn.smoothZoom = function (params) {
		var self = this;
		var l = self.length;

		//For single or more than one plugin instance
		for (var i = 0; i < l; i++) {
			var $elem = $(self[i]);
			var instance = $elem.data('smoothZoom');

			// Case 1: Initiate the plugin if not already have an instance
			if (!instance) {

				if (typeof params === 'object' || !params) {
					$elem.data('smoothZoom', new Zoomer($elem, params));
				}

				// Case 2: If the instance already available - Check for method call
			} else {

				// getZoomData - Returns {sourceX, sourceY, sourceWidth, sourceHeight, distX, distY, distWidth, distHeight, centerX, centerY, ratio}
				if (params == "getZoomData") {
					return instance[params].apply(instance, Array.prototype.slice.call(arguments, 1));

					// destroy | focusTo | zoomIn | zoomOut | moveRight| moveLeft | moveUp | moveDown | Reset | addLandmark | removeLandmark | attachLandmark | refreshAllLandmarks
				} else if (instance[params]) {
					instance[params].apply(instance, Array.prototype.slice.call(arguments, 1));
				}
			}
		}

		//return for chainability for possible cases
		if (params !== "getZoomData") {
			return this;
		}
	};

	function checkBoolean(_var) {
		if (_var === true) {
			return true;
		} else if (_var) {
			_var = _var.toLowerCase();
			if (_var == 'yes' || _var == 'true') {
				return true;
			}
		}
		return false;
	}


	//...................................................................................................................
	//Using Modernizr to check browser capabilities and property names prefixed

	/* Modernizr 2.8.2 (Custom Build) | MIT & BSD
	 * Build: http://modernizr.com/download/#-borderradius-csstransforms-csstransforms3d-prefixed-teststyles-testprop-testallprops-prefixes-domprefixes
	 */
	window.Modernizr = function (a, b, c) {
		function y(a) {i.cssText = a}

		function z(a, b) {return y(l.join(a + ";") + (b || ""))}

		function A(a, b) {return typeof a === b}

		function B(a, b) {return !!~("" + a).indexOf(b)}

		function C(a, b) {
			for (var d in a) {
				var e = a[d];
				if (!B(e, "-") && i[e] !== c)return b == "pfx" ? e : !0
			}
			return !1
		}

		function D(a, b, d) {
			for (var e in a) {
				var f = b[a[e]];
				if (f !== c)return d === !1 ? a[e] : A(f, "function") ? f.bind(d || b) : f
			}
			return !1
		}

		function E(a, b, c) {
			var d = a.charAt(0).toUpperCase() + a.slice(1), e = (a + " " + n.join(d + " ") + d).split(" ");
			return A(b, "string") || A(b, "undefined") ? C(e, b) : (e = (a + " " + o.join(d + " ") + d).split(" "), D(e, b, c))
		}

		var d = "2.8.2", e = {}, f = b.documentElement, g = "modernizr", h = b.createElement(g), i = h.style, j, k = {}.toString, l = " -webkit- -moz- -o- -ms- ".split(" "), m = "Webkit Moz O ms", n = m.split(" "), o = m.toLowerCase().split(" "), p = {}, q = {}, r = {}, s = [], t = s.slice, u, v = function (a, c, d, e) {
			var h, i, j, k, l = b.createElement("div"), m = b.body, n = m || b.createElement("body");
			if (parseInt(d, 10))while (d--)j = b.createElement("div"), j.id = e ? e[d] : g + (d + 1), l.appendChild(j);
			return h = ["&#173;", '<style id="s', g, '">', a, "</style>"].join(""), l.id = g, (m ? l : n).innerHTML += h, n.appendChild(l), m || (n.style.background = "", n.style.overflow = "hidden", k = f.style.overflow, f.style.overflow = "hidden", f.appendChild(n)), i = c(l, a), m ? l.parentNode.removeChild(l) : (n.parentNode.removeChild(n), f.style.overflow = k), !!i
		}, w = {}.hasOwnProperty, x;
		!A(w, "undefined") && !A(w.call, "undefined") ? x = function (a, b) {return w.call(a, b)} : x = function (a, b) {return b in a && A(a.constructor.prototype[b], "undefined")}, Function.prototype.bind || (Function.prototype.bind = function (b) {
			var c = this;
			if (typeof c != "function")throw new TypeError;
			var d = t.call(arguments, 1), e = function () {
				if (this instanceof e) {
					var a = function () {};
					a.prototype = c.prototype;
					var f = new a, g = c.apply(f, d.concat(t.call(arguments)));
					return Object(g) === g ? g : f
				}
				return c.apply(b, d.concat(t.call(arguments)))
			};
			return e
		}), p.borderradius = function () {return E("borderRadius")}, p.csstransforms = function () {return !!E("transform")}, p.csstransforms3d = function () {
			var a = !!E("perspective");
			return a && "webkitPerspective" in f.style && v("@media (transform-3d),(-webkit-transform-3d){#modernizr{left:9px;position:absolute;height:3px;}}", function (b, c) {a = b.offsetLeft === 9 && b.offsetHeight === 3}), a
		};
		for (var F in p)x(p, F) && (u = F.toLowerCase(), e[u] = p[F](), s.push((e[u] ? "" : "no-") + u));
		return e.addTest = function (a, b) {
			if (typeof a == "object")for (var d in a)x(a, d) && e.addTest(d, a[d]); else {
				a = a.toLowerCase();
				if (e[a] !== c)return e;
				b = typeof b == "function" ? b() : b, typeof enableClasses != "undefined" && enableClasses && (f.className += " " + (b ? "" : "no-") + a), e[a] = b
			}
			return e
		}, y(""), h = j = null, e._version = d, e._prefixes = l, e._domPrefixes = o, e._cssomPrefixes = n, e.testProp = function (a) {return C([a])}, e.testAllProps = E, e.testStyles = v, e.prefixed = function (a, b, c) {return b ? E(a, b, c) : E(a, "pfx")}, e
	}(this, document);

	var prop_transform = Modernizr.prefixed('transform');
	var prop_origin = Modernizr.prefixed('transformOrigin');
	var prop_radius = Modernizr.prefixed('borderRadius');
	var supportsTrans3D = Modernizr.csstransforms3d;

})(jQuery, window, document);

//End - smoothZoom

//...................................................................................................................
//For mouse wheel support

/*! Copyright (c) 2013 Brandon Aaron (http://brandon.aaron.sh)
 * Licensed under the MIT License (LICENSE.txt).
 *
 * Version: 3.1.11
 *
 * Requires: jQuery 1.2.2+
 */
!function (a) {"function" == typeof define && define.amd ? define(["jquery"], a) : "object" == typeof exports ? module.exports = a : a(jQuery)}(function (a) {
	function b(b) {
		var g = b || window.event, h = i.call(arguments, 1), j = 0, l = 0, m = 0, n = 0, o = 0, p = 0;
		if (b = a.event.fix(g), b.type = "mousewheel", "detail" in g && (m = -1 * g.detail), "wheelDelta" in g && (m = g.wheelDelta), "wheelDeltaY" in g && (m = g.wheelDeltaY), "wheelDeltaX" in g && (l = -1 * g.wheelDeltaX), "axis" in g && g.axis === g.HORIZONTAL_AXIS && (l = -1 * m, m = 0), j = 0 === m ? l : m, "deltaY" in g && (m = -1 * g.deltaY, j = m), "deltaX" in g && (l = g.deltaX, 0 === m && (j = -1 * l)), 0 !== m || 0 !== l) {
			if (1 === g.deltaMode) {
				var q = a.data(this, "mousewheel-line-height");
				j *= q, m *= q, l *= q
			} else if (2 === g.deltaMode) {
				var r = a.data(this, "mousewheel-page-height");
				j *= r, m *= r, l *= r
			}
			if (n = Math.max(Math.abs(m), Math.abs(l)), (!f || f > n) && (f = n, d(g, n) && (f /= 40)), d(g, n) && (j /= 40, l /= 40, m /= 40), j = Math[j >= 1 ? "floor" : "ceil"](j / f), l = Math[l >= 1 ? "floor" : "ceil"](l / f), m = Math[m >= 1 ? "floor" : "ceil"](m / f), k.settings.normalizeOffset && this.getBoundingClientRect) {
				var s = this.getBoundingClientRect();
				o = b.clientX - s.left, p = b.clientY - s.top
			}
			return b.deltaX = l, b.deltaY = m, b.deltaFactor = f, b.offsetX = o, b.offsetY = p, b.deltaMode = 0, h.unshift(b, j, l, m), e && clearTimeout(e), e = setTimeout(c, 200), (a.event.dispatch || a.event.handle).apply(this, h)
		}
	}

	function c() {f = null}

	function d(a, b) {return k.settings.adjustOldDeltas && "mousewheel" === a.type && b % 120 === 0}

	var e, f, g = ["wheel", "mousewheel", "DOMMouseScroll", "MozMousePixelScroll"], h = "onwheel" in document || document.documentMode >= 9 ? ["wheel"] : ["mousewheel", "DomMouseScroll", "MozMousePixelScroll"], i = Array.prototype.slice;
	if (a.event.fixHooks)for (var j = g.length; j;)a.event.fixHooks[g[--j]] = a.event.mouseHooks;
	var k = a.event.special.mousewheel = {
		version: "3.1.11",
		setup: function () {
			if (this.addEventListener)for (var c = h.length; c;)this.addEventListener(h[--c], b, !1); else this.onmousewheel = b;
			a.data(this, "mousewheel-line-height", k.getLineHeight(this)), a.data(this, "mousewheel-page-height", k.getPageHeight(this))
		},
		teardown: function () {
			if (this.removeEventListener)for (var c = h.length; c;)this.removeEventListener(h[--c], b, !1); else this.onmousewheel = null;
			a.removeData(this, "mousewheel-line-height"), a.removeData(this, "mousewheel-page-height")
		},
		getLineHeight: function (b) {
			var c = a(b)["offsetParent" in a.fn ? "offsetParent" : "parent"]();
			return c.length || (c = a("body")), parseInt(c.css("fontSize"), 10)
		},
		getPageHeight: function (b) {return a(b).height()},
		settings: {adjustOldDeltas: !0, normalizeOffset: !0}
	};
	a.fn.extend({
		mousewheel: function (a) {return a ? this.bind("mousewheel", a) : this.trigger("mousewheel")},
		unmousewheel: function (a) {return this.unbind("mousewheel", a)}
	})
});

//...................................................................................................................;
var accessType=0,stageId=0,patientId=0,accessData=!1;
$(document).ready(function(){$("body").on("click",".giveAccess",function(a){if(_SUPERUZZA){accessType=$(this).attr("data-accessType");patientId=stageId=0;1==accessType&&(stageId=$(this).attr("data-stageId"));if(2==accessType||1==accessType)patientId=$(this).attr("data-patientId");accessData={accessType:accessType,stageId:stageId,patientId:patientId};getUsersWithAccessListForAccessPopup(accessType,stageId,patientId,function(){$("#shareModal").modal("show");isMobileDevice||$("#accessUserSearch").focus()})}else alert("\u041d\u0435\u043c\u0430\u0454 \u0434\u043e\u0441\u0442\u0443\u043f\u0443")});
$("body").on("click",".userToGiveAccessTo:not(.clinicUserAgreementSelectButton)",function(a){a=$(this).attr("data-cabinetUserId");isNaN(a)||(20!=accessType?ajax({url:"/cabinet/access-management/set-access",data:{cabinetUserId:a,accessType:accessType,stageId:stageId,patientId:patientId},success:function(a){20==accessType?(changeLocationHash("#clinic-access"),$("#shareModal").modal("hide")):($.cookie("forceGoToStages",1),locationHashChanged(!1),getUsersWithAccessListForAccessPopup(accessType,stageId,
patientId))}}):ajax({url:"/cabinet/access-management/get-clinic-access-invite-modal",data:{cabinetUserId:a},success:function(a){"undefined"==typeof a.alreadyAMember?($("#clinicAccessInviteModal").remove(),$("body").append(a.html),$("#clinicAccessInviteModal").modal("show")):confirmDialog({cancelButtonText:"Ok",text:a.message})}}))});$("body").on("click",".userToGiveAccessTo.clinicUserAgreementSelectButton",function(a){a=$(this).attr("data-agreement");var b=$(this).attr("data-cabinetUserId"),d=$("#roleSelect2").val();
ajax({url:"/cabinet/access-management/set-access",data:{cabinetUserId:b,accessType:accessType,agreement:a,role:d},success:function(a){$("#clinicAccessInviteModal").modal("hide");$("#shareModal").modal("hide");changeLocationHash("#clinic-access")}})});$("body").on("click",".removeAccess",function(a){var b=$(this).attr("data-accessType"),d=$(this).attr("data-stageId"),c=$(this).attr("data-patientId"),e=parseInt($(this).attr("data-cabinetUserId")),f=$(this).attr("data-clinicId");$(this).attr("data-userElementToRemoveId");
confirmDialog({buttonText:T["Remove access conf btn"],text:T["Remove access?"],buttonColor:"red",action:function(){ajax({url:"/cabinet/access-management/remove-access",data:{cabinetUserId:e,accessType:b,stageId:d,patientId:c,clinicId:f},success:function(a){"success"==a.status&&($("#shareModal").is(":visible")&&getUsersWithAccessListForAccessPopup(accessData.accessType,accessData.stageId,accessData.patientId),$("#cabinetUserProfileModal").modal("hide"),$.cookie("forceGoToStages",1),locationHashChanged(!1))}})}})});
$("body").on("click",".removeConfirmation",function(a){a=$(this).attr("data-confirmationsId");ajax({url:"/cabinet/access-management/remove-access-confirmation",data:{confirmationsId:a},success:function(a){"success"==a.status&&($("#shareModal").is(":visible")&&getUsersWithAccessListForAccessPopup(accessData.accessType,accessData.stageId,accessData.patientId),$("#cabinetUserProfileModal").modal("hide"),$.cookie("forceGoToStages",1),locationHashChanged(!1))}})});$("body").on("click",".removeAccessInvite",
function(a){a=$(this).attr("data-accessInvitesId");ajax({url:"/cabinet/access-management/remove-access-invite",data:{accessInvitesId:a},success:function(a){"success"==a.status&&getUsersWithAccessListForAccessPopup(accessData.accessType,accessData.stageId,accessData.patientId)}})});$("body").on("click",".hideStage",function(a){var b=$(this).attr("data-stageId");confirmDialog({buttonText:T.Hide,text:T["Hide stage confirm text"],action:function(){ajax({url:"/cabinet/access-management/hide-stage/"+b,
success:function(a){"undefined"!=typeof a.status&&"success"==a.status&&($("#shareModal").modal("hide"),locationHashChanged(!1))}})}})});$("body").on("click",".unhideStage",function(a){var b=$(this).attr("data-stageId");confirmDialog({buttonText:T.Unhide,text:T["Unhide stage confirm text"],action:function(){ajax({url:"/cabinet/access-management/unhide-stage/"+b,success:function(a){"undefined"!=typeof a.status&&"success"==a.status&&locationHashChanged(!1)}})}})});$("#accessUserSearch").on("input",function(){3>
$("#accessUserSearch").val().length?($("#cabusersSearchResults").html(""),$("#cabusersSearchNoResults").hide()):$.ajax({type:"POST",timeout:15E3,url:"/cabinet/access-management/search-for-sharing",data:{q:$("#accessUserSearch").val()},error:function(a,b){},success:function(a){try{a=eval("("+a+")")}catch(e){messageBoard(a,"warning")}if("undefined"!=typeof a.status&&"success"==a.status)if(a.users.length){$("#cabusersSearchNoResults").hide();var b="",d;for(d in a.users){var c=a.users[d];b+=$("#cabusersShareSearchResultPrototype").html().replace(/{#CABINET_USER_ID#}/g,
c.id).replace(/{#CABINET_USER_NAME#}/g,c.fio).replace(/{# CABINET_USER_NAME #}/g,c.fio).replace(/{#CABINET_USER_AVATAR#}/gi,'src="'+c.avatar+'"')}$("#cabusersSearchResults").html(b)}else $("#cabusersSearchResults").html(""),$("#cabusersSearchNoResults").show(),10==accessType?$("#cabusersSearchNoResultsSendInvite").hide():$("#cabusersSearchNoResultsSendInvite").show()}})})});
function getUsersWithAccessListForAccessPopup(a,b,d,c){ajax({url:"/cabinet/access-management/get-user-access-list",data:{accessType:a,stageId:b,patientId:d},success:function(a){$("#user-access-list").html(a.html);$("#cabusersSearchResults").html("");$("#cabusersSearchNoResults").hide();$("#accessUserSearch").val("");"undefined"!=typeof a.showHideStageButton?$(".hideStage").attr("data-stageId",b).show():$(".hideStage").hide();"undefined"!=typeof a.customButtons?$("#shareModalCustomButtonsContainer").html(a.customButtons):
$("#shareModalCustomButtonsContainer").html("");typeof("undefined"!=a.title)&&$("#shareModal .modal-title").html(a.title);"undefined"!=typeof c?c():($("#shareModal").modal("hide"),$("#shareModal").modal("show"))}})};
;
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,c,b){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var f=a[e];if(c.call(b,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,b){a!=Array.prototype&&a!=Object.prototype&&(a[c]=b.value)};$jscomp.getGlobal=function(a){a=["object"==typeof globalThis&&globalThis,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,a];for(var c=0;c<a.length;++c){var b=a[c];if(b&&b.Math==Math)return b}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,c,b,d){if(c){b=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in b||(b[e]={});b=b[e]}a=a[a.length-1];d=b[a];c=c(d);c!=d&&null!=c&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:c})}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,b){return $jscomp.findInternal(this,a,b).v}},"es6","es3");var focusOnEmptyStageComment=0;
$(document).ready(function(){var a="";$("body").on("click",".stageTitle",function(c){var b=$(this).attr("data-stageId");c=$(this).text();$(this).hide();var d=$("#stageTitleInputPrototype").html().replace(/{#STAGE_ID#}/g,b);$(this).parent().prepend(d);d=$(".stage-title-input-input-group[data-stageId="+b+"]");b=$(".stage-title-input[data-stageId="+b+"]");b.val(c);d.show();b.focus();c==T["New stage"]?(b.prop("selectionStart",0),b.prop("selectionEnd",999)):b.putCursorAtEnd();a=c});$("body").on("click",
".stage-title-save-button",function(c){var b=$(this).attr("data-stageId");c=$(".stage-title-input[data-stageId="+b+"]").val();a!=c?ajax({url:"/cabinet/stages/edit-stage-name",data:{stageId:b,text:c},success:function(a){$(".stage-title-input-input-group[data-stageId="+b+"]").remove();$(".stageTitle[data-stageId="+b+"]").html(a.stageName).show();0==a.stageName.length&&$(".stageTitle[data-stageId="+b+"]").html("&nbsp;");$("#stage"+b).find(".stageDate").html(a.stageDate);0<focusOnEmptyStageComment&&0==
$("#stage"+b+" .commentWrap").length&&$(".stageComment[data-stageId="+b+"]").focus();focusOnEmptyStageComment=0}}):cancelEditingStageName(b)});$("body").on("keydown",".stage-title-input",function(a){var b=$(this).attr("data-stageId");13==a.keyCode&&(focusOnEmptyStageComment=b,$(".stage-title-save-button[data-stageId="+b+"]").trigger("click"));27==a.keyCode&&cancelEditingStageName(b)});$("body").on("focusout",".stage-title-input",function(a){a=$(this).attr("data-stageId");$(".stage-title-save-button[data-stageId="+
a+"]").trigger("click")});$("body").on("click",".deleteStage",function(a){if(_SUPERUZZA){var b=$(this).closest(".stage").attr("data-stageId");confirmDialog({buttonText:T.Delete,text:T["Delete stage?"],buttonColor:"red",action:function(){ajax({url:"/cabinet/stages/delete-stage/"+b,success:function(a){"undefined"!=typeof a.status&&"success"==a.status&&deleteStage(b)}})}})}else alert("\u041d\u0435\u043c\u0430\u0454 \u0434\u043e\u0441\u0442\u0443\u043f\u0443")});$("body").on("click",".deletePatient",
function(a){if(_SUPERUZZA){var b=$(this).attr("data-patientId");confirmDialog({buttonText:T.Delete,text:T["Delete patient?"],buttonColor:"red",action:function(){ajax({url:"/cabinet/patients/delete-patient/"+b,success:function(a){"undefined"!=typeof a.status&&"success"==a.status&&(document.location.hash="#patients")}})}})}else alert("\u041d\u0435\u043c\u0430\u0454 \u0434\u043e\u0441\u0442\u0443\u043f\u0443")})});
function cancelEditingStageName(a){$(".stage-title-save-button[data-stageId="+a+"]").remove();var c=$(".stage-title-input-input-group[data-stageId="+a+"]");c.length&&c.remove();$(".stageTitle[data-stageId="+a+"]").show()}jQuery.fn.putCursorAtEnd=function(){return this.each(function(){$(this).focus();if(this.setSelectionRange){var a=2*$(this).val().length;this.setSelectionRange(a,a)}else $(this).val($(this).val());this.scrollTop=999999})};
;
$("body").on("click","#newStageName",function(a){a=$(this);a.focus();a.val()==T["New stage"]&&(a.prop("selectionStart",0),a.prop("selectionEnd",999))});$("body").on("keydown","#newStageName",function(a){13==a.keyCode&&$("#addStage").trigger("click")});var stageIsAdding=!1;
$("body").on("click","#addStage",function(a){if(!stageIsAdding){a=$("#newStageName").val();var b=$("#newStageVisibilityButton").hasClass("locked")?1:0;stageIsAdding=!0;ajax({url:"/cabinet/stages/add-stage/"+stagePatientId,data:{newStageName:a,newStageIsHidden:b},success:function(a){"undefined"!=typeof a.status&&"success"==a.status&&($("#stages").append(a.stageHtml),$("#newStageName").val(T["New stage"]),$("#newStageVisibilityButton").removeClass("locked").addClass("unlocked"),stageIsAdding=!1,initTooltips(),
checkNotifications(),document.getElementById("stageCommentTextarea"+a.stageId).innerHTML="")}})}});$("body").on("click","#newStageVisibilityButton",function(a){$(this).hasClass("locked")?$(this).removeClass("locked").addClass("unlocked"):$(this).removeClass("unlocked").addClass("locked")});
;
$(document).ready(function(){var dateAndTimeModalStageId;var dateAndTimeModalCommentId;var dateAndTimeModalDatePickerInitialized=false;$("body").on("click",".stageTime",function(event){dateAndTimeModalCommentId=false;var stageDate=$(this).attr("data-stageDate");dateAndTimeModalStageId=$(this).attr("data-stageId");if(dateAndTimeModalDatePickerInitialized)$("#datetimepickerInModal").data("DateTimePicker").destroy();$("#datetimepickerInModal").datetimepicker({inline:true,sideBySide:true,format:"YYYY-DD-MM HH mm",
    defaultDate:stageDate,icons:{time:"glyphicon glyphicon-time",date:"glyphicon glyphicon-calendar",up:"fa fa-angle-up",down:"fa fa-angle-down",previous:"fa fa-angle-left",next:"fa fa-angle-right",today:"glyphicon glyphicon-screenshot",clear:"glyphicon glyphicon-trash",close:"glyphicon glyphicon-remove"}});dateAndTimeModalDatePickerInitialized=true;$("#dateTimePickerModal").modal("show");$("#dateTimePickerModal").on("hidden.bs.modal",function(){$(".bootstrap-datetimepicker-widget").remove()})});$("body").on("click",
    ".commentTime",function(event){dateAndTimeModalStageId=false;var commentDate=$(this).attr("data-commentDate");dateAndTimeModalCommentId=$(this).attr("data-commentId");if(dateAndTimeModalDatePickerInitialized)$("#datetimepickerInModal").data("DateTimePicker").destroy();$("#datetimepickerInModal").datetimepicker({inline:true,sideBySide:true,format:"YYYY-DD-MM HH mm",defaultDate:commentDate,icons:{time:"glyphicon glyphicon-time",date:"glyphicon glyphicon-calendar",up:"fa fa-angle-up",down:"fa fa-angle-down",
            previous:"fa fa-angle-left",next:"fa fa-angle-right",today:"glyphicon glyphicon-screenshot",clear:"glyphicon glyphicon-trash",close:"glyphicon glyphicon-remove"}});dateAndTimeModalDatePickerInitialized=true;$("#dateTimePickerModal").modal("show");$("#dateTimePickerModal").on("hidden.bs.modal",function(){$(".bootstrap-datetimepicker-widget").remove()})});$("body").on("click","#saveDateAndTimeButton",function(event){var newDate=$("#datetimepickerInModal").data("DateTimePicker").date().format("YYYY-MM-DD HH:mm:00");
    if(dateAndTimeModalStageId)ajax({url:"/cabinet/stages/edit-stage-date",data:{newDate:newDate,stageId:dateAndTimeModalStageId},success:function(data){$("#dateTimePickerModal").modal("hide");locationHashChanged(false)}});if(dateAndTimeModalCommentId)ajax({url:"/cabinet/stages/edit-comment-date",data:{newDate:newDate,commentId:dateAndTimeModalCommentId},success:function(data){$("#dateTimePickerModal").modal("hide");locationHashChanged(false)}})})});
;
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,c,b){a instanceof String&&(a=String(a));for(var e=a.length,d=0;d<e;d++){var f=a[d];if(c.call(b,f,d,a))return{i:d,v:f}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,b){if(a==Array.prototype||a==Object.prototype)return a;a[c]=b.value;return a};$jscomp.getGlobal=function(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var c=0;c<a.length;++c){var b=a[c];if(b&&b.Math==Math)return b}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(a,c){var b=$jscomp.propertyToPolyfillSymbol[c];if(null==b)return a[c];b=a[b];return void 0!==b?b:a[c]};
$jscomp.polyfill=function(a,c,b,e){c&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(a,c,b,e):$jscomp.polyfillUnisolated(a,c,b,e))};$jscomp.polyfillUnisolated=function(a,c,b,e){b=$jscomp.global;a=a.split(".");for(e=0;e<a.length-1;e++){var d=a[e];d in b||(b[d]={});b=b[d]}a=a[a.length-1];e=b[a];c=c(e);c!=e&&null!=c&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:c})};
$jscomp.polyfillIsolated=function(a,c,b,e){var d=a.split(".");a=1===d.length;e=d[0];e=!a&&e in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var f=0;f<d.length-1;f++){var g=d[f];g in e||(e[g]={});e=e[g]}d=d[d.length-1];b=$jscomp.IS_SYMBOL_NATIVE&&"es6"===b?e[d]:null;c=c(b);null!=c&&(a?$jscomp.defineProperty($jscomp.polyfills,d,{configurable:!0,writable:!0,value:c}):c!==b&&($jscomp.propertyToPolyfillSymbol[d]=$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(d):$jscomp.POLYFILL_PREFIX+d,d=$jscomp.propertyToPolyfillSymbol[d],
$jscomp.defineProperty(e,d,{configurable:!0,writable:!0,value:c})))};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,b){return $jscomp.findInternal(this,a,b).v}},"es6","es3");
$(document).ready(function(){function a(a){$("#comment"+a).fadeTo("slow",.01,function(){$(this).slideUp("slow",function(){$(this).remove()})})}$("body").append('<img class="ap ap-grinning" style="opacity: 0; display: none"/>');$("body").on("click",".commentText.myCommentCommentText",function(a){$("body").hasClass("selectionMode")||window.initQuill(this)});$("body").on("click",".editCommentText",function(){$("body").hasClass("selectionMode")||window.initQuill($(this).closest("[data-comment-wrap]").find(".myCommentCommentText")[0])});
$("body").on("click",".dentbook-previews-raw",function(){$(this).closest("[data-comment-wrap]").find(".commentText").click()});$("body").on("click",".fileItem.stop-propagation",function(a){a.stopPropagation()});$("body").on("click",".deleteComment",function(c){if(_SUPERUZZA){var b=$(this).attr("data-commentId");confirmDialog({buttonText:T.Delete,text:T["Delete comment?"],buttonColor:"red",action:function(){ajax({url:"/cabinet/comments/delete-comment/"+b,success:function(c){"undefined"!=typeof c.status&&
"success"==c.status&&a(b)}})}})}else alert("\u041d\u0435\u043c\u0430\u0454 \u0434\u043e\u0441\u0442\u0443\u043f\u0443")});window.deleteCommentWithConfirm=function(a){var c=$(a).data("commentid");confirmDialog({buttonText:T.Delete,text:T["Delete comment?"],buttonColor:"red",action:function(){ajax({url:"/cabinet/comments/delete-comment/"+c,success:function(b){"undefined"!=typeof b.status&&"success"==b.status&&$("#comment"+c).fadeTo("slow",.01,function(){$(this).slideUp("slow",function(){$(this).remove();
window.exitComment(a)})})}})}})};$("body").on("click",".deleteImageTrigger",function(a){_SUPERUZZA?(a=$(this).attr("data-fileId"),deleteFiles([a])):alert("\u041d\u0435\u043c\u0430\u0454 \u0434\u043e\u0441\u0442\u0443\u043f\u0443")});$("body").on("click",".getFileInfo",function(a){a=$(this).attr("data-fileId");getFileInfo(a)});$("body").on("click",".minimizeStages",function(a){$(".minimizeStages").hide();$(".maximizeStages").show();$(".collapse").trigger("click")});$("body").on("click",".maximizeStages",
function(a){$(".maximizeStages").hide();$(".minimizeStages").show();$(".expand").trigger("click")});$("body").on("click",".openCollapsedComments",function(a){var b=$(this).closest(".stage");$(this).hasClass("collapsedCommentStateOpened")?(b.find(".collapsedComments").slideUp(),b.find(".collapsedFirstComment .fileBlock").slideUp("slow",function(){setTimeout(function(){b.find(".commentWrap:first-child").addClass("collapsedFirstComment")},50)}),$(this).removeClass("collapsedCommentStateOpened")):(b.find(".collapsedComments").slideDown(),
b.find(".collapsedFirstComment .fileBlock").slideDown("slow",function(){setTimeout(function(){b.find(".collapsedFirstComment").removeClass("collapsedFirstComment")},50)}),$(this).addClass("collapsedCommentStateOpened"))});$(window).on("resize",function(a){a.target==this&&handleCollapseCommentsButton()});$("body").on("click",".cloneFile",function(a){a=$(this).attr("data-fileId");ajax({url:"/cabinet/files/clone-file/"+a,data:{},timeout:3E5,success:function(a){"success"==a.status&&("#flow"==location.hash?
locationHashChanged(!1):($("#closeZoomImage").trigger("click"),inserCommentFromAjax(a)),$("#exifModal .close").trigger("click"))}})})});function handleCollapseCommentsButton(){var a=$(".collapsedFirstComment.oneCommentInStage");if(a.length){var c=$(window).width(),b=8;768<c&&1200>c&&(b=12);1200<=c&&(b=16);a.each(function(a,c){a=$(this).closest(".stage");$(this).find(".fileBlock").length>b?a.find(".openCollapsedComments").show():a.find(".openCollapsedComments").hide()})}}
function deleteStage(a){$("#addNewStagePortletWrap").slideDown();$("#stage"+a).fadeTo("slow",.01,function(){$(this).slideUp("slow",function(){$(this).remove();$("body").removeClass("hideNewStage")})})}
function deleteFiles(a){ajax({url:"/cabinet/files/delete-files",data:{fileIds:a.join(",")},success:function(c){if("undefined"!=typeof c.status&&"success"==c.status)for(var b in a)$("#fileBlock"+a[b]).fadeTo("fast",.001,function(){$(this).slideUp("slow",function(){var a=$(this).closest(".flowDateDiv");$(this).remove();0==a.find(".dentbookThumbnail").length&&a.remove()})})}})}
function getFileInfo(a){ajax({url:"/cabinet/files/get-file-info/"+a,success:function(a){"undefined"!=typeof a.status&&"success"==a.status&&($("#exifModalBody").html(a.info),$("#exifModal").modal("show"),$("#exifModal").modal("show"))}})}
function insertAtCaret(a,c){a=document.getElementById(a);var b=a.scrollTop,e=0,d=a.selectionStart||"0"==a.selectionStart?"ff":document.selection?"ie":!1;if("ie"==d){a.focus();var f=document.selection.createRange();f.moveStart("character",-a.value.length);e=f.text.length}else"ff"==d&&(e=a.selectionStart);f=a.value.substring(0,e);var g=a.value.substring(e,a.value.length);a.value=f+c+g;e+=c.length;"ie"==d?(a.focus(),f=document.selection.createRange(),f.moveStart("character",-a.value.length),f.moveStart("character",
e),f.moveEnd("character",0),f.select()):"ff"==d&&(a.selectionStart=e,a.selectionEnd=e,a.focus());a.scrollTop=b}function inserCommentFromAjax(a){var c=$("#comment"+a.commentId),b=a.stageId,e=$(".stageComment[data-stageId="+b+"]");a=a.commentHtml;c.length?c.after(a).remove():($("#stage"+b+" .commentsEnd").before(a),e.val("").focusout(),autosize.update(e),initTooltips());setColleaguesOnlineStatusOnPatientPage(CC_ONLINE_USER_IDS);checkNotifications()}
$.fn.focusToEnd=function(){return this.each(function(){var a=$(this).val();$(this).focus().val("").val(a)})};
window.commentFromTemplateStageButton=function(a,c){"object"==typeof a&&(window.insertInto=a);window.stageIdForTemplate=parseInt(a);window.commentIdForTemplate=parseInt(c);ajax({url:"/cabinet/templates/get-templates-for-modal",success:function(a){"undefined"!=typeof a.status&&"success"==a.status&&($("#templateModal").html(a.html),$("#templateModal ._scroller").css("height",$(window).height()-(isMobileDevice?100:200)),$("#templateModal").modal("show"),$("#templateSearch").focus())}})};
window.saveComment=function(a){var c=$(a).data("stageid"),b=$(a).data("commentid"),e=$(a).find(":first-child").html(),d=$(a).closest("[data-comment-wrap]");$(".tooltipster").not(".tooltipstered").tooltipster({theme:"tooltipster-shadow"});if(0===$(a).find(":first-child").text().length&&0==(d.data("comment-files")||0)&&0===$(a).find(":first-child").find("img").length)0<b?window.deleteCommentWithConfirm(a):window.exitComment(a);else{var f=[];d.find("[data-mention-member-id]").each(function(){f.push(this.dataset.mentionMemberId)});
ajax({url:0<b?"/cabinet/comments/edit-comment":"/cabinet/comments/add-comment",data:{stageId:c,commentId:b,text:e,mentions:f},success:function(b){inserCommentFromAjax(b);window.exitComment(a)}})}};
var keyActions=function(a){(a.ctrlKey||a.metaKey)&&13==a.keyCode?(a.preventDefault(),window.saveComment($('[data-commentId="'+a.data.commentId+'"][data-stageId="'+a.data.stageId+'"]')[0]),$(document).off("keydown",keyActions)):27==a.keyCode&&(a.preventDefault(),window.exitComment($('[data-commentId="'+a.data.commentId+'"][data-stageId="'+a.data.stageId+'"]')[0]),$(document).off("keydown",keyActions))},keyTab=function(a){9===(a.keyCode||a.which)&&-1<window.location.hash.indexOf("patients/stages")&&
(a.preventDefault(),$("[data-commentId]:last").click())};$(document).off("keydown",keyTab);$(document).on("keydown",keyTab);window.exitComment=function(a){$(document).off("keydown",keyActions);$(a).html(a.__quill._initHTML);$(a).closest("[data-comment-wrap]").find("[data-mentions-comment]").html(a.__quill._mentions);a.__quill=null;$(a).parent().find(".ql-toolbar,[data-mentions-editor]").remove();$(a).removeClass("ql-container ql-snow");$("body").removeClass("hideNewStage")};
window.initQuill=function(a){if(!a.__quill)if($("body").hasClass("hideNewStage"))$([document.documentElement,document.body]).animate({scrollTop:$(".ql-editor:first").offset().top-$(".ql-editor:first").closest("[data-comment-wrap]").height()-50},{always:function(){confirmDialog({cancelButtonText:"Ok",text:T["You are already editing a comment"]})}});else{var c=function(){$(document).on("keydown",{stageId:a.dataset.stageid,commentId:a.dataset.commentid},keyActions);var b=a.innerHTML,c=$(a).closest("[data-comment-wrap]").find("[data-mentions-comment]").html(),
d=new Quill(a,{modules:{toolbar:["bold","underline",{list:"ordered"},{background:"#BFEDD2 #FBEEB8 #F8CAC6 #ECCAFA #C2E0F4 transparent".split(" ")}],"emoji-module":{emojiData:window.emojis,preventDrag:!0,showTitle:!1,indicator:"*",convertEmoticons:!1,convertShortNames:!1,backgroundImageFn:function(){return"/c/js/quill/64.png"}}},theme:"snow",formats:["emoji","bold","underline","list","background"],placeholder:a.dataset.placeholder});d.focus();d._initHTML=b;d._mentions=c;$(a).siblings(".ql-toolbar").find(".ql-formats").append(2==
currentClinicType?'<button type="button" onclick="window.commentFromTemplateStageButton('+a.dataset.stageid+", "+a.dataset.commentid+')"><i class="fa fa-file-text-o"></i></button>':"").append('<button type="button" onclick="window.showEmoji('+a.dataset.stageid+", "+a.dataset.commentid+')"><i class="fa fa-smile-o"></i></button>').append(2==currentClinicType?'<button type="button" class="mentionButtonInQuill" onclick="window.showMentionPopup(this)"><i class="fa fa-at"></i></button>':"");d.clipboard.addMatcher(Node.ELEMENT_NODE,
function(a,b){var c=[];b.ops.forEach(function(a){a.insert&&"string"===typeof a.insert&&c.push({insert:a.insert})});b.ops=c;return b});d.on("text-change",function(a,b,c){6E3<d.getLength()&&(d.deleteText(6E3,d.getLength()),confirmDialog({cancelButtonText:"Ok",text:T["Comment is too long"]}))});$(a).closest("[data-comment-wrap]").find("[data-mentions-comment]").html("");$('<div data-mentions-editor class="mentionsEditor">'+c+"</div>").insertAfter($(a).siblings(".ql-toolbar:first"));$("body").addClass("hideNewStage")};
"undefined"===typeof Quill?$.getScriptCached("/c/js/quill/bundle.js",function(){c()}):c()}};
window.showMentionPopup=function(a){ajax({url:"/cabinet/patients/get-user-for-mention",success:function(c){$("#mentions-list").html(c.html);$("#mentions-list").modal("show");$("#mentions-list").on("hidden.bs.modal",function(){$(a).closest("[data-comment-wrap]").find(".ql-container")[0].__quill.focus()});$(a).closest("[data-comment-wrap]").find("[data-mention-member-id]").each(function(){$('#mentions-list [data-mention-member-id="'+$(this).data("mention-member-id")+'"]').addClass("mentionAdded")});
$("[data-mention-member-add]").click(function(){$container=$(a).closest("[data-comment-wrap]").find("[data-mentions-editor]");$container.find("[data-mention-member-id="+this.dataset.mentionMemberId+"]").length?($container.find("[data-mention-member-id="+this.dataset.mentionMemberId+"]").remove(),$(this).removeClass("mentionAdded")):($container.append(mentionHtml(this.dataset)),$(this).addClass("mentionAdded"))})}})};
var mentionHtml=function(a){return'<span class="mentionDoctor" data-mention-member-id="'+a.mentionMemberId+'">'+a.mentionMemberName+"</span> "};
$("body").on("click",".templateText",function(a){a=$(this).attr("data-id");if(isNaN(commentIdForTemplate)&&isNaN(window.stageIdForTemplate)&&"object"===typeof window.insertInto){a=$(window.insertInto).closest("[data-043-field]").find("input");var c=$(this).text();0<a.val().length&&(c=a.val()+" "+c);a.val(c);$("#templateModal").modal("hide");a.focus()}else ajax({url:"/cabinet/comments/replace-zones",data:{commentId:commentIdForTemplate,templateId:a,stageId:window.stageIdForTemplate},success:function(a){if("undefined"!=
typeof a.text){$("#templateModal").modal("hide");$("#templateModal").text("");var b=$("[data-commentId="+window.commentIdForTemplate+"][data-stageid="+window.stageIdForTemplate+"]")[0].__quill,c=b.getSelection(!0);b.clipboard.dangerouslyPasteHTML(c.index,a.text)}else throw Error("Wrong insert place.");}})});$(document).on("click","[data-mentions-editor] [data-mention-member-id]","click",function(){$(this).remove()});
window.showEmoji=function(a,c){window.commentIdForTemplate=c;window.stageIdForTemplate=a;if(0===$("#emoji-list .modal-body").html().length){a="";for(var b in window.emojis)c=100/51,a+='<img onclick="window.insertEmoji('+b+'); " class="ql-emoji ql-emoji-big" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" draggable="false" alt="?" title="'+window.emojis[b].name+'" style="display: inline-block;background-size: 5200%;background-position: '+(c*window.emojis[b].s[0]+
"% "+c*window.emojis[b].s[1]+'%; font-size: inherit;">');$("#emoji-list .modal-body").html(a)}$("#emoji-list").modal("show")};window.insertEmoji=function(a){$("#emoji-list").modal("hide");var c=$("[data-commentId="+window.commentIdForTemplate+"][data-stageid="+window.stageIdForTemplate+"]")[0].__quill,b=c.selection.savedRange;b&&0===b.length&&(b=b.index,c.insertEmbed(b,"emoji",window.emojis[a],Quill.sources.API),c.setSelection(b+1,Quill.sources.API))};
;
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,b,c){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var f=a[e];if(b.call(c,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){a=["object"==typeof globalThis&&globalThis,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,a];for(var b=0;b<a.length;++b){var c=a[b];if(c&&c.Math==Math)return c}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6","es3");var notificationCheckPeriod=3E5,notificationsTimeout,notificationsRequestIsOpen=!1,newNotificationsCount=0;
function checkNotifications(){uploadFiles.length||notificationsRequestIsOpen||(notificationsRequestIsOpen=!0,clearTimeout(notificationsTimeout),notificationsTimeout=setTimeout(function(){checkNotifications()},notificationCheckPeriod),$.ajax({type:"POST",timeout:15E3,url:"/cabinet/notifications/get-updates",data:{hash:document.location.hash},error:function(a,b){notificationsTimeout=setTimeout(function(){notificationsRequestIsOpen=!1;checkNotifications()},notificationCheckPeriod)},success:function(a){try{if(a=
eval("("+a+")"),"success"==a.status){showNewNotificationsCount(a.newNotificationsCount);if(void 0!=a.editedComments){for(var b in a.editedComments){var c=a.editedComments[b],d=$("#comment"+c.id);d.length?d.after(c.html).remove():$("#stage"+c.stageId+" .commentsEnd").before(c.html)}animateNewComments();initTooltips()}if(void 0!=a.commentsToDelete)for(b in a.commentsToDelete)deleteComment(a.commentsToDelete[b]);if(void 0!=a.editedStages){for(b in a.editedStages){var e=a.editedStages[b],f=$("#stage"+
e.id);f.length?f.find(".stageTitle").html(e.name):($("#stages").append(e.html),autosize($(".stageComment")))}animateNewStages();initTooltips()}if(void 0!=a.stagesToDelete)for(b in a.stagesToDelete)deleteStage(a.stagesToDelete[b]);/#patients\/stages\/[0-9]+/.test(document.location.hash)&&void 0!=a.upToDateColleagues&&setColleaguesUpToDateStatusOnPatientPage(a.upToDateColleagues);if("#patients"==document.location.hash&&($(".patientNotificationCount").remove(),void 0!=a.newNotificationsCountPerPatient))for(var g in a.newNotificationsCountPerPatient){var h=
a.newNotificationsCountPerPatient[g];$(".patientsListItem[data-patientid="+g+"] .patientName").append('<span class="badge badge-danger patientNotificationCount">'+h+"</span>")}}else"auth"==a.error&&errorHandler(a)}catch(k){}clearTimeout(notificationsTimeout);notificationsRequestIsOpen=!1;notificationsTimeout=setTimeout(function(){checkNotifications()},notificationCheckPeriod)}}))}
function getNotificationsForPopup(a){ajax({url:"/cabinet/notifications/get-notifications-list",success:function(b){if("success"==b.status){showNewNotificationsCount(b.newNotificationsCount);$("#notificationList").html(b.notificationsHtml);$("#notificationsPopup").show();setNotificationsArrow();var c=parseInt($("#notificationsPopup").css("top"));if(576<$(window).width()){var d=$("#notificationsWrap").height()+2;d>$(window).height()-c-20&&(d=$(window).height()-c-20)}else d=$(window).height()-c,$("#main_content").css("max-height",
"1px"),$("#startSelection").hide();$("#notificationsPopup").css("height",d);"undefined"!=typeof a&&a&&0==b.newNotificationsCount&&closeNotificationsPopup()}}})}
function setNotificationsArrow(){var a=$("#showNotificationsButton").offset().left,b=$(window).width();a=b-a;var c=576<b?58:30;855<b&&991>b?($("#notificationsPopup").css("right","130px"),c=160):$("#notificationsPopup").css("right","30px");$("#notificationsPopup .arrowtop").css("right",Math.round(a-c));$("#notificationsPopup .arrowbottom").css("right",Math.round(a-c)+1)}function closeNotificationsPopup(){$("#notificationsPopup").fadeOut("fast");$("#main_content").css("max-height","inherit")}
function showNewNotificationsCount(a){newNotificationsCount=a;a=document.title.match(/\([0-9]+\)(.*)/);a=null!=a&&"undefined"!=typeof a&&1<a.length?a[1]:document.title;0<newNotificationsCount?($("#newNotificationsCount").html(newNotificationsCount).show(),document.title="("+newNotificationsCount+") "+a):($("#newNotificationsCount").html(newNotificationsCount).hide(),document.title=a);try{webkit.messageHandlers.callbackHandler.postMessage("setIosBadgeNumber:"+newNotificationsCount)}catch(b){}}
function animateToStage(a){$("#stage"+a).length&&($("#stage"+a+" .portlet.light.stage-portlet").css({backgroundColor:"rgb(211, 253, 184)"}),$("body, html").animate({scrollTop:$("#stage"+a).offset().top-60},800))}function animateToComment(a){$("#comment"+a).length&&($("#comment"+a).css({backgroundColor:"rgb(211, 253, 184)"}),$("body, html").animate({scrollTop:$("#comment"+a).offset().top-60},800))}
function scrollToNewWhatever(){$("#main_content").imagesLoaded(function(){$(".newStage, .newComment").length&&$("body, html").animate({scrollTop:$(".newStage, .newComment").first().offset().top-60},800)})}function animateNewComments(){$(".newComment").animate({backgroundColor:"#F9F9F9"},4E3,function(){$(".newComment").removeClass("newComment")})}function animateNewStages(){$(".newStage").animate({backgroundColor:"white"},4E3,function(){$(".newStage").removeClass("newStage")})}
$(document).ready(function(){clearTimeout(notificationsTimeout);notificationsTimeout=setTimeout(function(){checkNotifications()},notificationCheckPeriod);$("body").on("click",".notificationLink",function(a){3!=a.isTrigger&&(closeNotificationsPopup(),scrollToNewWhateverNeeded=!0)});$("body").on("click",".confirmAccess",function(a){a.preventDefault();a=$(this).attr("data-confirmationsId");ajax({url:"/cabinet/access-management/confirm-access",data:{confirmationsId:a},success:function(a){"success"==a.status&&
closeNotificationsPopup()}})});$("body").on("click",".rejectAccess",function(a){a.preventDefault();a=$(this).attr("data-confirmationsId");$(this).closest(".notoficationItem");ajax({url:"/cabinet/access-management/reject-access",data:{confirmationsId:a},success:function(a){getNotificationsForPopup(!0)}})});$("#header_inbox_bar a").on("click",function(a){$("#notificationsPopup").is(":visible")?closeNotificationsPopup():getNotificationsForPopup()});$("body").on("click",".deleteNotificationButton",function(a){a=
$(this).attr("href");"undefined"!=typeof a&&(changeLocationHash(a),closeNotificationsPopup());ajax({url:"/cabinet/notifications/remove-notification",data:{notificationId:$(this).attr("data-notificationsId")},success:function(){getNotificationsForPopup(!0)}})});$("body").on("click",function(a){a=$(a.target);a.parents("#notificationsPopup").length||a.parents("#header_inbox_bar").length||closeNotificationsPopup();a.parents("#remindersPopup").length||a.parents("#header_reminders_bar").length||closeRemindersPopup();
a.parents("#waitingsPopup").length||a.parents("#header_waitings_bar").length||closeWaitingsPopup()});$("body").on("click","#closeNotificationPopup, .notoficationItemButton",function(a){closeNotificationsPopup()});$("body").on("click",".removeAllNotifications",function(a){confirmDialog({buttonText:T["delete"],text:T["Remove all notifications?"],buttonColor:"red",action:function(){ajax({url:"/cabinet/notifications/remove-all-notifications",success:function(a){showNewNotificationsCount(0);closeNotificationsPopup()}})}})})});
function setColleaguesOnlineStatusOnPatientPage(a){$(".onlineColleagueIndicator").remove();for(var b in a)$(".cabuserAvatarWithStatus[data-cabinetUsersId="+a[b]+"]").after('<span class="onlineColleagueIndicator"></span>');$(".cabuserAvatarWithStatus[data-cabinetUsersId="+currentCabinetUserId+"]").after('<span class="onlineColleagueIndicator"></span>')}
function setColleaguesUpToDateStatusOnPatientPage(a,b){("undefined"==typeof b||b)&&$(".upToDateColleagueIndicator").remove();b=$(".unconfirmedUserAvatar").length;for(var c in a){var d=a[c];$(".cabuserAvatarWithStatus[data-cabinetUsersId="+d+"]").after('<span class="upToDateColleagueIndicator"></span>');b&&($(".avatarImage[data-cabinetUsersId="+d+"]").hasClass("unconfirmedUserAvatar")&&$(".avatarImage[data-cabinetUsersId="+d+"]").removeClass("unconfirmedUserAvatar"),$(".menuAvatarImage[data-cabinetUsersId="+
d+"]").hasClass("unconfirmedUserAvatar")&&$(".menuAvatarImage[data-cabinetUsersId="+d+"]").removeClass("unconfirmedUserAvatar"))}$(".cabuserAvatarWithStatus[data-cabinetUsersId="+currentCabinetUserId+"]").after('<span class="upToDateColleagueIndicator"></span>')};
;
var patientsListQFilter=0;
$(document).ready(function(){$("body").on("click",".patientsListItem",function(event){if($(event.target).hasClass("patientsListItem")||$(event.target).hasClass("col-md-12")){var patientBlock=$(this).closest(".patientsListItem");document.location.hash="patients/stages/"+patientBlock.attr("data-patientId")}});$("body").on("change","#cabinetUsersFilterSelect",function(event){goToPatientsListCabinetUserFilterLink($("#cabinetUsersFilterSelect").val())});$("body").on("click",".patientsListCabinetUserFilterLink",function(event){var cabinetUserId=
    $(this).attr("data-cabinetUsersId");goToPatientsListCabinetUserFilterLink(cabinetUserId)});$("body").on("click",".patientsListCabinetUserFilterLinkLI",function(event){if(!$(event.target).hasClass("listItem"))return;var cabinetUserId=$(this).attr("data-cabinetUsersId");goToPatientsListCabinetUserFilterLink(cabinetUserId)});$("body").on("submit","#headerSearch",function(event){event.preventDefault();$.cookie("patientListQ",$("#patientsFilter_").val());if(document.location.hash=="#patients")locationHashChanged();
else document.location.hash="#patients"});$("body").on("submit","#mobilePatientSearchForm",function(event){event.preventDefault();$.cookie("patientListQ",$("#patientsSearchOnMobile").val());if(document.location.hash=="#patients")locationHashChanged();else document.location.hash="#patients"});$("body").on("click",".patientsStatusFilterContainer .patientStatusSelect",function(event){var status=$(this).attr("data-status");if(status==-1)$.removeCookie("patientStatusFilter");else{$.cookie("patientStatusFilter",
    $(this).attr("data-status"));$.removeCookie("patientListQ");$("#patientsFilter_").val("")}locationHashChanged()});$("body").on("click",".patientStatus",function(event){var patientStatusInlineSelectHtml=$("#patientStatusInlineSelectPrototype").html();var $container=$(this).closest(".patientHeader, .patientsListItem");var statuses=$container.data("status");$(".patientHeader, .listWrap").find(".patientStatusInlineSelect").remove();$container.prepend(patientStatusInlineSelectHtml);for(var i=0;i<statuses.length;i++)$container.find('.patientStatusInlineSelect [data-status="'+
    statuses[i]+'"]').addClass("active");patientStatusSelectIsOpened=true;event.stopPropagation()});$("body").on("click",".patientStatusInlineSelect .patientStatusSelect",function(event){var $container=$(this).closest(".patientHeader, .patientsListItem");var statuses=$container.data("status");var patientId=$container.attr("data-patientId");var status=$(this).data("status");var colorCode=$(this).data("color");var active=$(this).hasClass("active");var url="/cabinet/patients/{action}/"+patientId;if(!active)url=
    url.replace("{action}","set-patient-status");else url=url.replace("{action}","delete-patient-status");var that=$(this);ajax({url:url,data:{statusId:status},success:function(data){if(data.status!=="success")return;if(!active)statuses.push(status);else for(var i=0;i<statuses.length;i++)if(status===statuses[i])statuses.splice(i,1);that.toggleClass("active");$container.attr("data-status","["+statuses.join(", ")+"]");var statusLine=$container.find(".statusLine");var statusHeight=100/statuses.length;var statusLineHtml=
        "";$container.find(".patientStatusInlineSelect .active").each(function(e){var el=$(this);statusLineHtml+='<div data-status="'+el.data("status")+'" style="height: '+statusHeight+"%; background: "+el.data("color")+';"></div>'});statusLine.html(statusLineHtml);$(".patientHeaderFixed .statusLine").html(statusLineHtml);patientStatusSelectIsOpened=true}})});$("body").on("blur","#patientsFilter_",function(event){$("#headerSearch").trigger("submit")});$("body").on("blur","#patientsSearchOnMobile",function(event){$("#mobilePatientSearchForm").trigger("submit")});
    function goToPatientsListCabinetUserFilterLink(cabinetUserId){if(cabinetUserId==currentCabinetUserId||cabinetUserId==-1)$.removeCookie("patientsListCabinetUserFilter");else{$.cookie("patientsListCabinetUserFilter",cabinetUserId);$.cookie("patientsListCabinetUserFilterClinic",currentClinicId)}if(document.location.hash=="#patients")locationHashChanged();else document.location.hash="#patients";$("#cabinetUserProfileModal").modal("hide")}function loadMorePatients(){ajax({url:"/cabinet/patients/get-more-patients",
        data:{patientListPage:patientListPage,q:$("#patientsFilter_").val()},success:function(data){if(data.html.length){patientListPage++;$("#patientsListContainer").append(data.html);$(".listItem").css("margin-bottom","3px");if(data.lastPage)$(".loadMorePatients").fadeOut()}else $(".loadMorePatients").fadeOut()}})}$("body").on("click",".loadMorePatients",function(event){loadMorePatients()});$("body").on("click",".forceGoToStagesLink",function(event){$.cookie("forceGoToStages",1)})});
var getOnlineCabinetUsersTimeout=false;function getOnlineCabinetUsers(){return;try{data=eval("("+data+")");$(".cabinetUsersListItem").removeClass("online");for(var k in data.onlineCabinetUsers){var v=data.onlineCabinetUsers[k];$("#cabinetUser"+v).addClass("online")}if(document.location.hash=="#colleagues"){clearTimeout(getOnlineCabinetUsersTimeout);getOnlineCabinetUsersTimeout=setTimeout(function(){getOnlineCabinetUsers()},5E3)}}catch(err){}};
;
$("body").on("click","#patientListAlphabetOrder",function(a){"#patients"==document.location.hash?($.cookie("patientsListOrder",1),locationHashChanged(),$("#patientListAlphabetOrder").hide(),$("#patientListLastViewedOrder").show()):document.location.hash="#patients"});
$("body").on("click","#patientListLastViewedOrder",function(a){"#patients"==document.location.hash?($.cookie("patientsListOrder",2),locationHashChanged(),$("#patientListLastViewedOrder").hide(),$("#patientListAlphabetOrder").show()):document.location.hash="#patients"});
;
$("body").on("click",".showCabinetUserProfileModal",function(a){a.preventDefault();a=$(this).attr("data-cabinetUsersId");var c=$(this).closest(".stage");c=c.length?c.attr("data-stageId"):0;var b=0;$(".patientHeader").length&&(b=$(".patientHeader").attr("data-patientId"));showCabinetUserProfileModal(a,b,c)});$("body").on("click",".showCabinetUserProfileModalLI",function(a){$(a.target).hasClass("listItem")&&(a=$(this).attr("data-cabinetUsersId"),showCabinetUserProfileModal(a))});
$("body").on("click","#deleteMyself",function(a){confirmDialog({text:T["profile removal confirm text"],buttonText:T.Yes,buttonColor:"red",action:function(){ajax({url:"/cabinet/i-me-mine/check-if-has-password/",success:function(a){var b=function(){ajax({url:"/cabinet/i-me-mine/harakiri-request/",success:function(a){"undefined"!=typeof a.harakiriAllowed&&confirmDialog({text:T["profile removal email sent"],cancelButtonText:"Ok"})}})};1==a.hasPassword?confirmByPassword(b):b()}})}})});
function showCabinetUserProfileModal(a,c,b){"undefined"==typeof c&&(c=0);"undefined"==typeof b&&(b=0);ajax({url:"/cabinet/i-me-mine/getProfileForModal",data:{cabinetUserId:a,patientId:c,stageId:b},success:function(a){$("#cabinetUserProfileModalBody").html(a.html);$("#cabinetUserProfileModal").modal("show")}})};
;
var resizers=[];var currentResizingParameters=false;function destroyJcropResizers(){for(var cropId in resizers){var resizer=resizers[cropId];resizer.jcrop_api.destroy()}resizers=[]}
function initializeResizer(imageFieldId,parameters){destroyJcropResizers();currentResizingParameters=parameters;currentResizingImageFieldId=imageFieldId;boxWidth=$(window).width()-180;boxHeight=$(window).height()-180;$("#resizerModal .nav-tabs a").hide();$("#resizerModal .nav-tabs li").removeClass("active");$("#resizerModal .tab-pane").removeClass("active");var firstCrop=false;for(var cropId in parameters.crops){var crop=parameters.crops[cropId];if(typeof crop.resizer!="undefined"){if(!firstCrop)firstCrop=
    cropId;$('#resizerModal a[href="#resizerTab'+cropId+'"]').show().html(crop.cropName);$("#resizerTab"+cropId+" img").attr("src","/uploads/"+currentCabinetUserId+"/"+uploadedFile.folder+"/"+uploadedFile.fileName);if(firstCrop==cropId){$('#resizerModal a[href="#resizerTab'+cropId+'"]').parent().addClass("active");$("#resizerTab"+cropId).addClass("active")}resizer=[];resizer.resizeWidth=Math.min(crop.width,uploadedFile.width);resizer.resizeHeight=Math.min(crop.height,uploadedFile.height);resizer.crop=
    crop;switch(crop.resize){case "crop":var minSize=[resizer.resizeWidth,resizer.resizeHeight];var aspectRatio=resizer.resizeWidth/resizer.resizeHeight;break;case "width":var minSize=[resizer.resizeWidth,1];var aspectRatio=false;break;case "height":var minSize=[1,resizer.resizeHeight];var aspectRatio=false;break}$("#jcropTarget"+cropId).Jcrop({boxWidth:boxWidth,boxHeight:boxHeight,minSize:minSize,setSelect:[0,0,resizer.resizeWidth*100,resizer.resizeHeight*100],aspectRatio:aspectRatio,allowSelect:false,
    jcropCropId:cropId,resizer:resizer},function(){var bounds=this.getBounds();var resizer=this.getOptions().resizer;resizer.boundx=bounds[0];resizer.boundy=bounds[1];resizer.jcrop_api=this;var jcropCropId=resizer.jcrop_api.getOptions().jcropCropId;var selection=resizer.jcrop_api.tellSelect();var x=0,y=0,x2=selection.x2,y2=selection.y2;if(resizer.boundx>x2){x=Math.round((resizer.boundx-x2)/2);x2+=x}if(resizer.boundy>y2){y=Math.round((resizer.boundy-y2)/2);y2+=y}if(x!=0||y!=0)resizer.jcrop_api.setSelect([x,
    y,x2,y2]);resizers[jcropCropId]=resizer;$("#uploadedFileInfoContainer"+imageFieldId).hide();$("#uploadedFileProgressBarContainer"+imageFieldId).hide();$(".avatarImageResizingComplete").hide();$(".imageResizingComplete").show();$("#resizerModal").modal("show")})}}}
$("body").on("click",".imageResizingComplete",function(event){var parameters=currentResizingParameters;var imageFieldId=currentResizingImageFieldId;var imageData=uploadedFile;var resizeInfo=[];for(var cropId in resizers){var resizer=resizers[cropId];resizeInfo[cropId]=resizer.jcrop_api.tellSelect()}imageData["resizeInfo"]=resizeInfo;$("#"+imageFieldId).val(JSON.stringify(imageData));if(typeof resizers[parameters.previewCropIndex]!="undefined"){var resizer=resizers[parameters.previewCropIndex];$("#uploadedFileInfoContainer"+
    imageFieldId).hide();$("#uploadedFileProgressBarContainer"+imageFieldId).hide();$("#resizedImagePreview"+imageFieldId).attr("src","/uploads/"+currentCabinetUserId+"/"+uploadedFile.folder+"/"+uploadedFile.fileName).parent().parent().show();var coords=resizer.jcrop_api.tellSelect();if(parseInt(coords.w)>0){var rx=resizer.resizeWidth/coords.w;var ry=resizer.resizeHeight/coords.h;switch(resizer.crop.resize){case "crop":$("#resizedImagePreviewDiv"+imageFieldId).css({width:resizer.resizeWidth,height:resizer.resizeHeight});
    break;case "width":ry=rx;$("#resizedImagePreviewDiv"+imageFieldId).css({width:resizer.resizeWidth,height:Math.round(ry*coords.h)});break;case "height":rx=ry;$("#resizedImagePreviewDiv"+imageFieldId).css({width:Math.round(rx*coords.w),height:resizer.resizeHeight});break}$("#resizedImagePreview"+imageFieldId).css({width:Math.round(rx*resizer.boundx)+"px",height:Math.round(ry*resizer.boundy)+"px",marginLeft:"-"+Math.round(rx*coords.x)+"px",marginTop:"-"+Math.round(ry*coords.y)+"px"})}}else{showUploadedImagePreview(imageFieldId);
    $("#"+imageFieldId).val(JSON.stringify(uploadedFile))}$("#resizerModal").modal("hide");destroyJcropResizers();$(".removeAvatar").show()});
function initializeUploaderForField(imageFieldId,parameters){$("#commentUploadInput"+imageFieldId).fileupload({url:"/cabinet/upload-simple/uploadImage",dataType:"json",autoUpload:true,disableImageResize:true||/Android(?!.*Chrome)|Opera/.test(window.navigator.userAgent),imageMaxWidth:1E3,imageMaxHeight:1E3,limitConcurrentUploads:1,sequentialUploads:true}).on("fileuploadadd",function(e,data){var acceptFileTypes=/^image\/(jpe?g|png|bmp)$/i;if(!acceptFileTypes.test(data.originalFiles[0]["type"])){data.abort();
    alert(T["Select an image"]);return}if(data.originalFiles[0]["size"]>2E7){data.abort();alert(T["File size is too big"]);return}$("#commentUploadInput"+imageFieldId).fileupload("option","formData",{uploadMetadata:JSON.stringify($.extend({uploadId:uploadId},parameters))});$("#uploadedFileName"+imageFieldId).html(data.files[0].name);$("#uploadedFileProgress"+imageFieldId).html("").show();$("#uploadedFileInfoContainer"+imageFieldId).show();$("#uploadedFileProgressBar"+imageFieldId).css("width","0%");$("#uploadedFileProgressBarContainer"+
    imageFieldId).show()}).on("fileuploadprogressall",function(e,data){var progress=parseInt(data.loaded/data.total*100,10);$("#uploadedFileProgress"+imageFieldId).html(progress+"%");$("#uploadedFileProgressBar"+imageFieldId).css("width",progress+"%")}).on("fileuploaddone",function(e,data){uploadedFile=data.result;if(parameters.resizer)initializeResizer(imageFieldId,parameters);else{showUploadedImagePreview(imageFieldId);$("#"+imageFieldId).val(JSON.stringify(uploadedFile))}}).prop("disabled",!$.support.fileInput).parent().addClass($.support.fileInput?
    undefined:"disabled")}$("body").on("click",".deleteImageFile",function(event){var imageFieldId=$(this).attr("data-image-field-id");$("#uploadedImagePreview"+imageFieldId).attr("src","").parent().hide();$("#resizedImagePreview"+imageFieldId).attr("src","").parent().parent().hide();$("#"+imageFieldId).val("");$(this).hide()});
;
/*!
	Autosize 3.0.15
	license: MIT
	http://www.jacklmoore.com/autosize
*/
!function(e,t){if("function"==typeof define&&define.amd)define(["exports","module"],t);else if("undefined"!=typeof exports&&"undefined"!=typeof module)t(exports,module);else{var n={exports:{}};t(n.exports,n),e.autosize=n.exports}}(this,function(e,t){"use strict";function n(e){function t(){var t=window.getComputedStyle(e,null);p=t.overflowY,"vertical"===t.resize?e.style.resize="none":"both"===t.resize&&(e.style.resize="horizontal"),c="content-box"===t.boxSizing?-(parseFloat(t.paddingTop)+parseFloat(t.paddingBottom)):parseFloat(t.borderTopWidth)+parseFloat(t.borderBottomWidth),isNaN(c)&&(c=0),i()}function n(t){var n=e.style.width;e.style.width="0px",e.offsetWidth,e.style.width=n,p=t,f&&(e.style.overflowY=t),o()}function o(){var t=window.pageYOffset,n=document.body.scrollTop,o=e.style.height;e.style.height="auto";var i=e.scrollHeight+c;return 0===e.scrollHeight?void(e.style.height=o):(e.style.height=(i+1)+"px",v=e.clientWidth,document.documentElement.scrollTop=t,void(document.body.scrollTop=n))}function i(){var t=e.style.height;o();var i=window.getComputedStyle(e,null);if(i.height!==e.style.height?"visible"!==p&&n("visible"):"hidden"!==p&&n("hidden"),t!==e.style.height){var r=d("autosize:resized");e.dispatchEvent(r)}}var s=void 0===arguments[1]?{}:arguments[1],a=s.setOverflowX,l=void 0===a?!0:a,u=s.setOverflowY,f=void 0===u?!0:u;if(e&&e.nodeName&&"TEXTAREA"===e.nodeName&&!r.has(e)){var c=null,p=null,v=e.clientWidth,h=function(){e.clientWidth!==v&&i()},y=function(t){window.removeEventListener("resize",h,!1),e.removeEventListener("input",i,!1),e.removeEventListener("keyup",i,!1),e.removeEventListener("autosize:destroy",y,!1),e.removeEventListener("autosize:update",i,!1),r["delete"](e),Object.keys(t).forEach(function(n){e.style[n]=t[n]})}.bind(e,{height:e.style.height,resize:e.style.resize,overflowY:e.style.overflowY,overflowX:e.style.overflowX,wordWrap:e.style.wordWrap});e.addEventListener("autosize:destroy",y,!1),"onpropertychange"in e&&"oninput"in e&&e.addEventListener("keyup",i,!1),window.addEventListener("resize",h,!1),e.addEventListener("input",i,!1),e.addEventListener("autosize:update",i,!1),r.add(e),l&&(e.style.overflowX="hidden",e.style.wordWrap="break-word"),t()}}function o(e){if(e&&e.nodeName&&"TEXTAREA"===e.nodeName){var t=d("autosize:destroy");e.dispatchEvent(t)}}function i(e){if(e&&e.nodeName&&"TEXTAREA"===e.nodeName){var t=d("autosize:update");e.dispatchEvent(t)}}var r="function"==typeof Set?new Set:function(){var e=[];return{has:function(t){return Boolean(e.indexOf(t)>-1)},add:function(t){e.push(t)},"delete":function(t){e.splice(e.indexOf(t),1)}}}(),d=function(e){return new Event(e)};try{new Event("test")}catch(s){d=function(e){var t=document.createEvent("Event");return t.initEvent(e,!0,!1),t}}var a=null;"undefined"==typeof window||"function"!=typeof window.getComputedStyle?(a=function(e){return e},a.destroy=function(e){return e},a.update=function(e){return e}):(a=function(e,t){return e&&Array.prototype.forEach.call(e.length?e:[e],function(e){return n(e,t)}),e},a.destroy=function(e){return e&&Array.prototype.forEach.call(e.length?e:[e],o),e},a.update=function(e){return e&&Array.prototype.forEach.call(e.length?e:[e],i),e}),t.exports=a});;
var selectionMode = false;
var lastSelectionClicked = 0;
var filesSelectionOrder = [];


function handleSelectionButtons(_selectionMode) {
    if (typeof (_selectionMode) != 'undefined')
        selectionMode = _selectionMode;
    var hash = document.location.hash;
    var isFlowPage = hash == '#flow';
    var isPatientPage = /#patients\/stages\/[0-9]+/.test(hash);
    var showSelectionButtons = false;
    var visibleButtons = [];

    if (hash == '#flow' && selectionMode != false) {
        selectionMode = 'flow';
    }

    if (isPatientPage) {
        if ($("#flowModal").is(':visible')) {
            selectionMode = 'flowModal';
        } else {
            // Hide upload and flow buttons
            if (selectionMode && selectionMode != 'flowModal') {
                $('.stageAddCommentBlock .commentBlock .input-group-btn').hide();
                $('.commentButtons').addClass('displayNoneImportant');
            } else {
                $('.stageAddCommentBlock .commentBlock .input-group-btn').show();
                $('.commentButtons').removeClass('displayNoneImportant');
            }
        }
    }

    var selectedCount = $('body .selectedDentbookThumbnail').length;
    switch (selectionMode) {
        case 'flowModal':
            $('.selectionButtons').hide();
            break;
        case 'flow':
            handleSelectionButtonsOpacity(selectedCount);
            visibleButtons = ['massDelete', 'downloadTrigger', 'addToPatientFromFlow', 'cancelSelectionButton'];
            $('body').addClass('selectionMode');//!
            $('.selectionButtons').show();
            $('.startSelection').hide();
            break;
        case 'patient':
            handleSelectionButtonsOpacity(selectedCount);
            if (selectedCount == 1 && $('body .selectedDentbookThumbnail a').hasClass('imageToZoom'))
                visibleButtons = ['makeAvatarFromSelected', 'massDelete', 'downloadTrigger', 'moveToFlow', 'cancelSelectionButton', 'makeCollageFromSelected'];
            else visibleButtons = ['massDelete', 'downloadTrigger', 'moveToFlow', 'cancelSelectionButton', 'makeCollageFromSelected'];
            $('body').addClass('selectionMode');
            $('.selectionButtons').show();
            $('.startSelection').hide();
            break;
        case false:
            $('.selectionButtons').hide();
            $('body').removeClass('selectionMode');
            $('.selectedDentbookThumbnail').removeClass('selectedDentbookThumbnail');
            if (isPatientPage || isFlowPage)
                $('.startSelection').show();
            break;
    }

    $('.selectionButtons button').hide();
    if (visibleButtons.length) {
        if (selectionMode != 'flow')
            $('.page-sidebar-menu li:not(#leftSelectionButtonsLi):not(#createPatientMenuButtonLi)').css('opacity', 0.5);
        for (var k in visibleButtons) {
            var v = visibleButtons[k];
            if (isMobileDevice && v == 'downloadTrigger')
                continue;
            $('.' + v).show();
        }
        //$('.scroll-to-top .icon-arrow-up').hide();
    } else {
        $('.page-sidebar-menu li:not(#leftSelectionButtonsLi):not(#createPatientMenuButtonLi)').css('opacity', 1);
        //$('.scroll-to-top .icon-arrow-up').show();
    }
}

function handleSelectionButtonsOpacity(selectedCount) {
    if (selectedCount)
        $('.selectionButtons button').not('.cancelSelectionButton').css('opacity', 1);
    else $('.selectionButtons button').not('.cancelSelectionButton').css('opacity', 0.3);
}

//$('#selectionModeTrigger').click(function (event) {
//    handleSelectionButtons(selectionMode == false ? 'patient' : false);
//});
$('.cancelSelectionButton').click(function (event) {
    filesSelectionOrder = [];
    handleSelectionButtons(false);
    $('.selectedFlowDate').removeClass('selectedFlowDate');
});
$('.startSelection').click(function (event) {
    filesSelectionOrder = [];
    handleSelectionButtons('patient');
});


$('body').on('click', '.selectionButton', function (event) {
    var dentbookThumbnail = $(this).closest('.dentbookThumbnail');
    var selectedFileId = dentbookThumbnail.attr('data-fileId');
    dentbookThumbnail.toggleClass('selectedDentbookThumbnail');

    // Shift select
    if (lastSelectionClicked != 0 && event.shiftKey) {
        var selectionType = false;
        if (dentbookThumbnail.hasClass('selectedDentbookThumbnail') && $('.dentbookThumbnail[data-fileId=' + lastSelectionClicked + ']').hasClass('selectedDentbookThumbnail'))
            selectionType = 'on';
        if (!dentbookThumbnail.hasClass('selectedDentbookThumbnail') && !$('.dentbookThumbnail[data-fileId=' + lastSelectionClicked + ']').hasClass('selectedDentbookThumbnail'))
            selectionType = 'off';
        if (selectionType) {
            var files = [];
            dentbookThumbnail.closest('.selectionMode').find('.dentbookThumbnail').each(function () {
                files.push($(this).attr('data-fileId'));
            });
            if (files.length) {
                var start = files.indexOf(lastSelectionClicked);
                var end = files.indexOf(selectedFileId);
                while (start != end) {
                    if (start < end)
                        start++
                    else start--;
                    if (selectionType == 'on')
                        $('.dentbookThumbnail[data-fileId=' + files[start] + ']').addClass('selectedDentbookThumbnail');
                    else $('.dentbookThumbnail[data-fileId=' + files[start] + ']').removeClass('selectedDentbookThumbnail');

                    var _selectedFileId = files[start];
                    var index = filesSelectionOrder.indexOf(_selectedFileId);
                    if (selectionType == 'on') {
                        if (index == -1)
                            filesSelectionOrder.push(_selectedFileId);
                    } else {
                        if (index != -1) {
                            filesSelectionOrder.splice(index, 1);
                        }
                    }
                }
            }
        }
    }
    var index = filesSelectionOrder.indexOf(selectedFileId);
    if (dentbookThumbnail.hasClass('selectedDentbookThumbnail')) {
        if (index == -1)
            filesSelectionOrder.push(selectedFileId);
    } else {
        if (index != -1) {
            filesSelectionOrder.splice(index, 1);
        }
    }

    lastSelectionClicked = selectedFileId;

    // Handle flowDates' checkboxes
    $('.flowDateDiv').each(function () {
        if ($(this).find('.dentbookThumbnail').not('.selectedDentbookThumbnail').length)
            $(this).find('.flowDate').removeClass('selectedFlowDate');
        else $(this).find('.flowDate').addClass('selectedFlowDate');
    });

    handleSelectionButtons();
});

$('body').on('click', '.flowDate', function (event) {
    if (!selectionMode)
        return;
    var flowDateDiv = $(this).closest('.flowDateDiv');
    if (flowDateDiv.find('.dentbookThumbnail').not('.selectedDentbookThumbnail').length) {
        flowDateDiv.find('.dentbookThumbnail').addClass('selectedDentbookThumbnail');
        $(this).addClass('selectedFlowDate');
    } else {
        flowDateDiv.find('.dentbookThumbnail').removeClass('selectedDentbookThumbnail');
        $(this).removeClass('selectedFlowDate');
    }
    lastSelectionClicked = 0;
    handleSelectionButtons();
});

$('body').on('click', '.fileItem', function (event) {
    if (selectionMode)
        event.preventDefault();
});

$('.downloadTrigger').click(function (event) {
    var fileIds = [];
    $('.selectedDentbookThumbnail .fileItem, .selectedDentbookThumbnail .imageToZoom').each(function () {
        fileIds.push($(this).attr('data-fileId'));
    });
    if (!fileIds.length) {
        alert(T['Select files!']);
        return;
    }
    ajax({
        timeout: 120000,
        url: '/cabinet/downloads/prepare-download',
        data: {fileIds: fileIds},
        doNotHideLoadingBlockOnSuccess: true,
        success: function (data) {
            if (typeof (data.status) != 'undefined' && data.status == 'success') {
                handleSelectionButtons(false);

                if (typeof (data.oneFile) != 'undefined') {
                    window.location.href = data.link;
                    hideLoadingBlock();
                } else {
                    showLoadingBlock();
                    AWS.config.region = 'eu-central-1';
                    AWS.config.credentials = new AWS.CognitoIdentityCredentials({
                        IdentityPoolId: 'eu-central-1:6bdda7dc-dc49-417a-bb45-4a1731b26fd2',
                    });

                    var lambda = new AWS.Lambda({region: 'eu-central-1', apiVersion: '2015-03-31'});
                    var pullParams = {
                        FunctionName: 'go-zip',
                        InvocationType: 'RequestResponse',
                        LogType: 'None',
                        Payload: JSON.stringify(data),
                    };
                    var downloadLink = data.dstFile;
                    lambda.invoke(pullParams, function (error, data) {
                        hideLoadingBlock();
                        var showErrorMessage = false;
                        if (error) {
                            showErrorMessage = true;
                        } else {
                            var lambdaFunctionResponse = JSON.parse(data.Payload);
                            if (typeof (lambdaFunctionResponse) != 'undefined' && typeof (lambdaFunctionResponse.success) != 'undefined' && lambdaFunctionResponse.success === true) {
                                window.location.href = "https://s3.eu-central-1.amazonaws.com/uploadercliniccards/" + downloadLink;
                            } else {
                                showErrorMessage = true;
                                if (typeof (lambdaFunctionResponse) != 'undefined' && typeof (lambdaFunctionResponse.errorMessage) != 'undefined' && lambdaFunctionResponse.errorMessage === "limit reached") {
                                    showErrorMessage = false;
                                    alert("Downloads limit is reached. Try again later.");
                                }

                            }
                        }
                        if (showErrorMessage) {
                            alert('Unable to prepare zip');
                        }
                    });
                }
            } else {
                alert('Unable to prepare zip');
            }
        }
    });
});

$('.makeCollageFromSelected').click(function (event) {
    var fileIds = [];
    $('.selectedDentbookThumbnail .fileItem, .selectedDentbookThumbnail .imageToZoom').each(function () {
        fileIds.push($(this).attr('data-fileId'));
    });
    if (!fileIds.length) {
        alert(T['Select files!']);
        return;
    }

    ajax({
        timeout: 120000,
        url: '/cabinet/collage',
        data: {fileIds: fileIds, filesSelectionOrder: filesSelectionOrder},
        success: function (data) {
            if (data.status == 'success') {
                // if (location.hash == '#flow') {
                //     locationHashChanged(false);
                // } else {
                $('.cancelSelectionButton').trigger('click');
                inserCommentFromAjax(data);
                $('#comment' + data.commentId + ' .dentbook-previews-raw .fileBlock').last().find('a').trigger('click');
                // }
            }
        }
    });
});

$('.moveToFlow').click(function (event) {
    var fileIds = [];
    var error = false;
    $('.selectedDentbookThumbnail .fileItem, .selectedDentbookThumbnail .imageToZoom').each(function () {
        if ($(this).attr('data-fileIsMine')) {
            fileIds.push($(this).attr('data-fileId'));
        } else {
            error = true;
        }
    });
    if (error) {
        alert(T['Only your files to flow']);
        return;
    }
    if (!fileIds.length) {
        alert(T['Select files!']);
        return;
    }
    ajax({
        url: '/cabinet/flow/move-to-flow',
        data: {fileIds: fileIds},
        success: function (data) {
            if (typeof (data.status) != 'undefined' && data.status == 'success') {
                // locationHashChanged(false)
                for (var k in fileIds) {
                    fileId = fileIds[k];
                    $('#fileBlock' + fileId).remove();
                }
                $('.cancelSelectionButton').trigger('click');
                $('.flowUploadCommentButtonWrap, .flowUploadStageButton').show();
            } else {
                confirmDialog({text: data.text});
            }
        }
    });
});

$('.massDelete').click(function (event) {
    if (!_SUPERUZZA) {
        alert(' ');
        return;
    }
    var fileIds = [];
    var error = false;
    $('.selectedDentbookThumbnail .fileItem, .selectedDentbookThumbnail .imageToZoom').each(function () {
        if ($(this).attr('data-deletable')) {
            fileIds.push($(this).attr('data-fileId'));
        } else {
            error = true;
        }
    });
    if (error) {
        alert(T['Only my files are deletable warning']);
        return;
    }
    if (!fileIds.length) {
        alert(T['Select files!']);
        return;
    }
    confirmDialog({
        buttonText: T['Delete'],
        text: T['Delete files?'],
        buttonColor: 'red',
        action: function () {
            deleteFiles(fileIds);
            handleSelectionButtons(false);
        }
    });
});;
var currentZoomedImage;
var photoEditingIsGoingOn = false;
var showSmallerImageInZoom = $.cookie('showSmallerImageInZoom') == 1 ? true : false;

$(document).ready(function () {
    //
    $('body').on('click', '#downloadFileSource', function (e) {
        e.preventDefault();
        window.open(
            $(currentZoomedImage).attr('href').replace('_2.png', '.stl'),
            '_blank'
        );
    });
    $('body').on('click', '#openFileViewer', function (e) {
        e.preventDefault();
        window.open(
            '/cabinet/viewer/' + $(currentZoomedImage).data('fileid'),
            '_blank'
        );
    });
    $('body').on('click', '#openDokaImageEditor', function (e) {
        e.preventDefault();
        openDokaImageEditorHandlerLazyDecorator();
    });
    //
    $('body').on('click', '.imageToZoom', function (event) {
        event.preventDefault();
        if ($(this).hasClass('stop-propagation')) {
            event.stopPropagation();
        }
        currentZoomedImage = $(this);
        showZoomedImage();
    });
    $('#nextZoomImage, #floatingViewerNextZoomImage').click(function (event) {
        currentZoomedImage = getPrevOrNextImage('next');
        showZoomedImage();
    });
    $('#prevZoomImage, #floatingViewerPrevZoomImage').click(function (event) {
        currentZoomedImage = getPrevOrNextImage('prev');
        showZoomedImage();
    });

    $("#imageZoom").keydown(function (event) {
        if (event.altKey && event.keyCode == 37) { // left
            event.preventDefault(); // Windows fix
            event.stopPropagation(); // Windows fix
            $('#rotateLeftZoomImage').trigger('click');
            return;
        }
        if (event.altKey && event.keyCode == 39) { // right
            $('#rotateRightZoomImage').trigger('click');
            return;
        }
        if (event.shiftKey && (event.keyCode == 37 || event.keyCode == 39)) {
            $('#mirrorHorizontalZoomImage').trigger('click');
            return;
        }
        if (event.shiftKey && (event.keyCode == 38 || event.keyCode == 40)) {
            $('#mirrorVerticalZoomImage').trigger('click');
            return;
        }
        if (event.keyCode == 37) { // left
            $('#prevZoomImage').trigger('click');
        }
        if (event.keyCode == 39) { // right
            $('#nextZoomImage').trigger('click');
        }
        if (event.keyCode == 46 || event.keyCode == 8) { // Delete or Backspace
            event.preventDefault();
            $('#deleteZoomImage').trigger('click');
        }
        if (event.keyCode == 73) { // i
            $('#infoZoomImage').trigger('click');
        }
        /*if (event.keyCode == 107 || event.keyCode == 187) { // plus or equal
         $('#zoom_container').smoothZoom('zoomIn');
         }
         if (event.keyCode == 109 || event.keyCode == 189) { // minus or dash
         $('#zoom_container').smoothZoom('Reset');
         }*/
    });
    $('#imageZoom').on('shown.bs.modal', function (e) {
        $('.modal-backdrop.in').css('cssText', "background-color: black !important;");
        $('.modal-backdrop.in').css('opacity', 1);
    });

    $('#deleteZoomImage').click(function (event) {
        if (!_SUPERUZZA) {
            alert(' ');
            return;
        }
        confirmDialog({
            buttonText: T['Delete'],
            text: T['Do you confirm removal?'],
            buttonColor: 'red',
            action: function () {
                var imageId = currentZoomedImage.attr('data-fileId');
                var elements = $('.imageToZoom');
                if (elements.length > 1) {

                    $('#nextZoomImage').trigger('click');

                    var fileId = imageId;
                    var flowDateDiv = $('#fileBlock' + fileId).closest('.flowDateDiv');
                    $('#fileBlock' + fileId).remove();
                    if (flowDateDiv.find('.dentbookThumbnail').length == 0)
                        flowDateDiv.remove();

                    setTimeout(function () {
                        deleteFiles([imageId]);
                    }, 30);

                } else {
                    deleteFiles([imageId]);
                    $('#closeZoomImage').trigger('click');
                }
            }
        });
    });

    $('#infoZoomImage').click(function (event) {
        var imageId = currentZoomedImage.attr('data-fileId');
        getFileInfo(imageId);
    });

    /* EDITING */
    // jQuery.fn.single_double_click = function (single_click_callback, double_click_callback, timeout) {
    //     return this.each(function () {
    //         var clicks = 0, self = this;
    //         jQuery(this).click(function (event) {
    //             clicks++;
    //             if (clicks == 1) {
    //                 setTimeout(function () {
    //                     if (clicks == 1) {
    //                         single_click_callback.call(self, event);
    //                     } else {
    //                         double_click_callback.call(self, event);
    //                     }
    //                     clicks = 0;
    //                 }, timeout || 300);
    //             }
    //         });
    //     });
    // }

    var rotate180ZoomImage = function () {
            simpleImageEdit('rotate_180');
        },
        rotateLeftZoomImage = function () {
            simpleImageEdit('rotate_left')
        },
        rotateRightZoomImage = function () {
            simpleImageEdit('rotate_right');
        };
    // $('#rotateRightZoomImage').single_double_click(rotateRightZoomImage, rotate180ZoomImage);
    // $('#rotateLeftZoomImage').single_double_click(rotateLeftZoomImage, rotate180ZoomImage);


    // var DELAY = 700, clicks = 0, timer = null;
    /*
        // $(function () {
            $("#rotateRightZoomImage").click(function (e) {
                clicks++;  //count clicks
                if (clicks === 1) {
                    timer = setTimeout(function () {
                        rotateRightZoomImage();  //perform single-click action
                        clicks = 0;             //after action performed, reset counter
                    }, DELAY);
                } else {
                    clearTimeout(timer);    //prevent single-click action
                    rotate180ZoomImage();  //perform double-click action
                    clicks = 0;             //after action performed, reset counter
                }
            })
                // .on("dblclick", function (e) {
                //     e.preventDefault();  //cancel system double-click event
                // });

            $("#rotateLeftZoomImage").click(function (e) {
                clicks++;  //count clicks
                if (clicks === 1) {
                    timer = setTimeout(function () {
                        rotateLeftZoomImage();  //perform single-click action
                        clicks = 0;             //after action performed, reset counter
                    }, DELAY);
                } else {
                    clearTimeout(timer);    //prevent single-click action
                    rotate180ZoomImage();  //perform double-click action
                    clicks = 0;             //after action performed, reset counter
                }
            })
                // .on("dblclick", function (e) {
                //     e.preventDefault();  //cancel system double-click event
                // });
        // });
    */
    $("#rotateRightZoomImage").click(function (e) {
        var $this = $(this);
        if ($this.hasClass('clicked')) {
            $this.removeClass('clicked');
            rotate180ZoomImage();
            //here is your code for double click
        } else {
            $this.addClass('clicked');
            setTimeout(function () {
                if ($this.hasClass('clicked')) {
                    $this.removeClass('clicked');
                    rotateRightZoomImage();
                    //your code for single click
                }
            }, 500);
        }
    });

    $("#rotateLeftZoomImage").click(function (e) {
        var $this = $(this);
        if ($this.hasClass('clicked')) {
            $this.removeClass('clicked');
            rotate180ZoomImage();
            //here is your code for double click
        } else {
            $this.addClass('clicked');
            setTimeout(function () {
                if ($this.hasClass('clicked')) {
                    $this.removeClass('clicked');
                    rotateLeftZoomImage();
                    //your code for single click
                }
            }, 500);
        }
    });


    // $('#rotateRightZoomImage').click(function (event) {
    //     simpleImageEdit('rotate_right');
    // });
    // $('#rotateLeftZoomImage').click(function (event) {
    //     simpleImageEdit('rotate_left');
    // });
    $('#mirrorVerticalZoomImage').click(function (event) {
        simpleImageEdit('mirror_verical');
    });
    $('#mirrorHorizontalZoomImage').click(function (event) {
        simpleImageEdit('mirror_hozinontal');
    });


    /* Close black image loading overlay if it takes forever to load */
    /*!!  $('body').on('click', '#zoom_container', function (event) {
     if ($('#zoom_container').css('background-image') != 'none') {
     $('#imageZoom').modal('hide');
     }
     });*/

    // Zoom quality toggle
    $('body').on('change', '.showSmallerImageInZoomToggle', function (event) {
        // It's inverted somehow
        showSmallerImageInZoom = !showSmallerImageInZoom;
        $.cookie('showSmallerImageInZoom', showSmallerImageInZoom ? 1 : 0);
    });
    new Switchery(document.querySelector('.showSmallerImageInZoomToggle'), {size: 'small'});

    if (document.getElementsByClassName('showBinotelClinicMemberSwitcherToggle').length) {
        $('body').on('change', '.showBinotelClinicMemberSwitcherToggle', function (event) {
            // It's inverted somehow
            var cookie_name = 'binotel_' + currentClinicId + '_' + currentClinicMemberId;
            if ($(this).get(0).checked) {
                currentClinicMemberBinotelOperatorNumber=$('.showBinotelClinicMemberSwitcherToggle').val();
                $.cookie(cookie_name, currentClinicMemberBinotelOperatorNumber);

            } else {
                currentClinicMemberBinotelOperatorNumber=0;
                $.cookie(cookie_name, null, {expires: -1 * 24 * 3600});
            }
            if (location.hash=='#patients'){
                locationHashChanged();
            }
        });
        new Switchery(document.querySelector('.showBinotelClinicMemberSwitcherToggle'), {size: 'small'});
    }
});


function simpleImageEdit(action) {
    if (photoEditingIsGoingOn)
        return;
    photoEditingIsGoingOn = true;
    clearTimeout(timeout);
    timeout = setTimeout("showLoadingBlock()", 500);
    var imageId = currentZoomedImage.attr('data-fileId');
    ajax({
        url: '/cabinet/files/simple-image-edit/' + imageId,
        data: {action: action},
        success: function (data) {
            if (typeof (data.status) != 'undefined' && data.status == 'success') {
                showNewlyEditedImage(data);
            }
        }
    });

}

function showNewlyEditedImage(data) {
    currentZoomedImage.attr('href', data.main_url);
    currentZoomedImage.attr('data-width', data.width);
    currentZoomedImage.attr('data-height', data.height);
    currentZoomedImage.attr('data-mirror', data.mirror);
    currentZoomedImage.find('img').attr('src', data.thumb_url);
    if (typeof (data.original) != 'undefined' && data.original != null) {
        currentZoomedImage.data('fileoriginal', data.original);
    }
    if (typeof (data.medium_url) != 'undefined' && data.medium_url != null) {
        currentZoomedImage.attr('data-preview2', data.medium_url);
    }
    showZoomedImage();
    photoEditingIsGoingOn = false;
    clearTimeout(timeout);
    hideLoadingBlock();

    var mirror = data.mirror;

    // Mirror
    $('#mirrorVerticalZoomImage, #mirrorHorizontalZoomImage').removeClass('mirroredButton');

    if (mirror & 1) {
        $('#mirrorHorizontalZoomImage').addClass('mirroredButton');
    }

    if (mirror & 2) {
        $('#mirrorVerticalZoomImage').addClass('mirroredButton');
    }
    console.log('showNewlyEditedImage');
    console.log(currentZoomedImage);
}

function showZoomedImage() {
    //
    setUpButtons();
    //
    if (!$("#imageZoom").is(':visible')) {
        //$('#zoomButtons').removeClass('zoomButtonsShown');
        $('#zoomButtons').removeClass('zoomButtonsShown');
        $('#closeZoomImage').removeClass('zoomButtonsShown');
    }
    var imageUrl = getImageUrlToZoom(currentZoomedImage);
    var deletable = currentZoomedImage.attr('data-deletable') != undefined ? true : false;
    var fileismine = currentZoomedImage.attr('data-fileismine') != undefined ? true : false;
    var imageId = currentZoomedImage.attr('data-fileId');
    var mirror = currentZoomedImage.attr('data-mirror') != undefined ? currentZoomedImage.attr('data-mirror') : 0;
    if (!$('#floatingViewer').is(':visible')) {
        $('#phoneRotationFixOverlay').show();
        $('#imageZoom').modal().on('shown', function () {
            $('body').addClass('overflowYHidden');
            //$('body').css('cssText', "overflow-y: hidden !important;");
        }).on('hidden', function () {
            $('body').removeClass('overflowYHidden');
//            $('body').css('overflow-y', 'auto');
            $('#phoneRotationFixOverlay').hide();
            // Select last viewd image
            $('.lastViewedImage').removeClass('lastViewedImage');
            currentZoomedImage.parent().parent().addClass('lastViewedImage').pulsate({
                repeat: false,
                reach: 20,
                speed: 1600,
                color: '#a7e872'
            });
            try {
                webkit.messageHandlers.callbackHandler.postMessage("disableRotation");
            } catch (err) {
            }
        })
        $('body').addClass('overflowYHidden');
        // $('body').css('cssText', "overflow-y: hidden !important;");
        //$('#editButtons').hide();
        $('#zoomButtons').removeClass('c7buttons c6buttons');
        if (deletable) {
            $('#deleteZoomImage').attr('data-fileId', imageId).show();
            $('#zoomButtons').addClass('c7buttons');
//        if (fileismine)
//            $('#editButtons').show();
        } else {
            $('#deleteZoomImage').hide();
            $('#zoomButtons').addClass('c6buttons');
        }
        $('#editButtons').show();
        $('#imageZoom').modal('show');

        //$('#zoom_container').css('background-image', 'url(/c/js/zoom-viewer/zoom_assets/preloader3.gif)');
        $('#zoom_container').css('background-image', '');
        $('#zoom_container')
            .smoothZoom('destroy')
            //.css('background-image', 'url(/c/js/zoom-viewer/zoom_assets/preloader3.gif)')
            .smoothZoom({
                width: '100%',
                height: '100%',
                responsive: true,
                zoom_MAX: 200,
                background_COLOR: 'black',
                border_SIZE: 0,
                zoom_BUTTONS_SHOW: false,
                pan_BUTTONS_SHOW: false,
                //zoom_OUT_TO_FIT: true,
                image_url: imageUrl,
                animation_SPEED_ZOOM: 10,
                animation_SMOOTHNESS: 10
            });
        zoomBgTimeout = setTimeout(function () {
            $('#zoom_container').css('background-image', 'url(/c/js/zoom-viewer/zoom_assets/preloader3.gif)')
        }, 400);

        // Mirror
        $('#mirrorVerticalZoomImage, #mirrorHorizontalZoomImage').removeClass('mirroredButton');
        if (mirror & 1)
            $('#mirrorHorizontalZoomImage').addClass('mirroredButton');
        if (mirror & 2)
            $('#mirrorVerticalZoomImage').addClass('mirroredButton');

    } else {
        $('#zoom_container_floating').show()

            .smoothZoom('destroy')
            //.css('background-image', 'url(/c/js/zoom-viewer/zoom_assets/preloader3.gif)')
            .smoothZoom({
                width: '100%',
                height: '100%',
                responsive: true,
                zoom_MAX: 200,
                background_COLOR: 'black',
                border_SIZE: 0,
                zoom_BUTTONS_SHOW: false,
                pan_BUTTONS_SHOW: false,
                //zoom_OUT_TO_FIT: true,
                image_url: imageUrl,
                animation_SPEED_ZOOM: 10,
                animation_SMOOTHNESS: 10,
                animation_SPEED_PAN: 20,

            });
        zoomBgTimeout = setTimeout(function () {
            $('#zoom_container_floating').css('background-image', 'url(/c/js/zoom-viewer/zoom_assets/preloader3.gif)')
        }, 400);
        handleFloatingViewerButtons();
    }


    // Preload
    setTimeout(function () {
        var nextImage = getPrevOrNextImage('next');
        preloadImage(getImageUrlToZoom(nextImage));
        var prevImage = getPrevOrNextImage('prev');
        preloadImage(getImageUrlToZoom(prevImage));
    }, 200);

    try {
        webkit.messageHandlers.callbackHandler.postMessage("enableRotation");
    } catch (err) {
    }
}

function getPrevOrNextImage(prevOrNext) {
    if ($('#flowModal').is(':visible')) {
        var elements = $('#flowModal .imageToZoom');
    } else {
        var elements = $('.imageToZoom');
    }

    var currentIndex = elements.index(currentZoomedImage);
    var image;
    if (prevOrNext == 'prev') {
        if (currentIndex - 1 >= 0)
            image = $(elements[currentIndex - 1]);
        else
            image = $(elements[elements.length - 1]);
    } else {
        if (currentIndex + 1 < elements.length)
            image = $(elements[currentIndex + 1]);
        else
            image = $(elements[0]);
    }
    return image;
}

function preloadFirstZoomImage() {
    var elements = $('.imageToZoom');
    if (elements.length) {
        preloadImage(getImageUrlToZoom($(elements[0])));
    }
}

function preloadImage(imageUrl) {
    var preloadImage = new Image();
    preloadImage.src = imageUrl;
}

function getImageUrlToZoom(element) {
    if (element.attr('data-preview2') !== undefined) {
        //if (showSmallerImageInZoom || $(window).width() < 1000)
        if (showSmallerImageInZoom || isMobileDevice || $(window).width() < 1000)
            return element.attr('data-preview2');
        else return element.attr('href');
        // if ($(window).width() > 1000)
        //     return element.attr('href');
        // return element.attr('data-preview2');
    } else {
        return element.attr('href');
    }
}

var iosOrientationChangedTimeout;

function iosOrientationChanged(orientation) {
    clearTimeout(iosOrientationChangedTimeout)
    if ($("#imageZoom").is(':visible'))
        iosOrientationChangedTimeout = setTimeout(function () {
            showZoomedImage();
        }, 200);
}

function setUpButtons() {
    if (
        'stl' !== currentZoomedImage.data('fileext')
    ) {
        $('.zoomButton').show();
        $('#openFileViewer').hide();
        $('#downloadFileSource').hide();
    } else {
        $('.zoomButton').hide();
        $('#openFileViewer').show();
        $('#downloadFileSource').show();
        $('#infoZoomImage').show();
    }
}

function openDokaImageEditorHandlerLazyDecorator() {
    if (
        !window.openDokaEditor &&
        !window.openDokaEditorFromState
    ) {
        Promise.all([
            lazyLoadLinkStylesheet('c/js/doka/doka.css'),
            lazyLoadLinkStylesheet('c/js/doka/index.css'),
            lazyLoadModuleScript('c/js/doka/index.js')
        ]).then((values) => {
            console.log(values);

            openDokaImageEditorHandler();
        });
    } else {
        openDokaImageEditorHandler();
    }
}

function openDokaImageEditorHandler() {
    var image = $(currentZoomedImage);

    var imageId = image.data('fileid');
    var imageName = image.data('filename');
    var imageExt = image.data('fileext');
    var imageOriginal = parseInt(image.data('fileoriginal'));

    var base = window.configS3.url + '/' + window.configS3.bucket + '/';

    var processCb = function (r) {
        showNewlyEditedImage({
            width: r.image_width,
            height: r.image_height,
            mirror: r.image_mirror,
            original: r.image_original,
            main_url: r.image_url,
            medium_url: r.image_medium,
            thumb_url: r.image_thumbnail,
        });
    };

    var processStartCb = function () {
        showLoadingBlock();
    };

    if (imageOriginal) {
        openDokaEditorFromState(
            imageId,
            base + imageName + '_o' + '.' + imageExt,
            base + imageName + '.' + 'json',
            processCb,
            processStartCb
        );
    } else {
        openDokaEditor({
            id: imageId,
            src: base + imageName + '.' + imageExt,
            state: undefined,
        }, processCb, processStartCb);
    }
}

function lazyLoadModuleScript(src) {
    return new Promise(function(resolve, reject) {
        var script = document.createElement('script');

        script.src = src;
        script.type = 'module';

        script.onload = function () {
            resolve(src);
        };

        script.onerror = function () {
            reject();
        };

        document.head.appendChild(script);
    });
}

function lazyLoadLinkStylesheet(href) {
    return new Promise(function(resolve, reject) {
        var link = document.createElement('link');

        link.href = href;
        link.rel = 'stylesheet';
        link.type = 'text/css';

        link.onload = function () {
            resolve(href);
        };

        link.onerror = function () {
            reject();
        };

        document.head.appendChild(link);
    });
}
;
cssFix=function(){var b=navigator.userAgent.toLowerCase(),a=function(a){return-1!=b.indexOf(a)};(function(a,b){a.className=a.className?a.className+(" "+b):b})(document.getElementsByTagName("html")[0],[!/opera|webtv/i.test(b)&&/msie (\d)/.test(b)?"ie ie"+RegExp.$1:a("firefox/2")?"gecko firefox2":a("firefox/3")?"gecko firefox3":a("gecko/")?"gecko":a("chrome/")?"chrome":a("opera/9")?"opera opera9":/opera (\d)/.test(b)?"opera opera"+RegExp.$1:a("konqueror")?"konqueror":a("applewebkit/")?"webkit safari":
a("mozilla/")?"gecko":"",a("x11")||a("linux")?" linux":a("mac")?" mac":a("win")?" win":""].join(" "))}();
var artEventHelper={bind:function(b,a,c){b.addEventListener?b.addEventListener(a,c,!1):b.attachEvent?b.attachEvent("on"+a,c):b["on"+a]=c}},_userAgent=navigator.userAgent.toLowerCase(),browser={version:(_userAgent.match(/.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[])[1],safari:/webkit/.test(_userAgent)&&!/chrome/.test(_userAgent),chrome:/chrome/.test(_userAgent),opera:/opera/.test(_userAgent),msie:/msie/.test(_userAgent)&&!/opera/.test(_userAgent),mozilla:/mozilla/.test(_userAgent)&&!/(compatible|webkit)/.test(_userAgent)},
artLoadEvent=function(){var b=[],a=!1,c=function(){if(!a){a=!0;for(var c=0;c<b.length;c++)b[c]()}};document.addEventListener&&!browser.opera&&document.addEventListener("DOMContentLoaded",c,!1);browser.msie&&window==top&&function(){try{document.documentElement.doScroll("left")}catch(f){setTimeout(arguments.callee,10);return}c()}();browser.opera&&document.addEventListener("DOMContentLoaded",function(){for(var a=0;a<document.styleSheets.length;a++)if(document.styleSheets[a].disabled){setTimeout(arguments.callee,
10);return}c()},!1);if(browser.safari||browser.chrome){var h;(function(){if("loaded"!=document.readyState&&"complete"!=document.readyState)setTimeout(arguments.callee,10);else{if("undefined"==typeof h){h=document.getElementsByTagName("style").length;for(var a=document.getElementsByTagName("link"),b=0;b<a.length;b++)h+="stylesheet"==a[b].getAttribute("rel")?1:0;if(document.styleSheets.length!=h){setTimeout(arguments.callee,0);return}}c()}})()}artEventHelper.bind(window,"load",c);return{add:function(a){b.push(a)}}}();
(function(){var b=document.uniqueID&&document.compatMode&&!window.XMLHttpRequest&&document.execCommand;try{b&&b("BackgroundImageCache",!1,!0)}catch(a){}})();function xGetElementsByClassName(b,a,c){return[]}var styleUrlCached=null;
function GetStyleUrl(){if(null==styleUrlCached){styleUrlCached="";var b=document.getElementsByTagName("link");for(var a=0;a<b.length;a++){var c=b[a];if(c.href&&/style\.ie6\.css(\?.*)?$/.test(c.href))return styleUrlCached=c.href.replace(/style\.ie6\.css(\?.*)?$/,"")}b=document.getElementsByTagName("style");for(a=0;a<b.length;a++)if(c=/import\s+"([^"]+\/)style\.ie6\.css"/.exec(b[a].innerHTML),null!=c&&0<c.length)return styleUrlCached=c[1]}return styleUrlCached}
function fixPNG(b){if(/MSIE (5\.5|6).+Win/.test(navigator.userAgent)){if("IMG"==b.tagName){if(/\.png$/.test(b.src)){var a=b.src;b.src=GetStyleUrl()+"images/spacer.gif"}}else if(a=b.currentStyle.backgroundImage.match(/url\("(.+\.png)"\)/i))a=a[1],b.runtimeStyle.backgroundImage="none";a&&(b.runtimeStyle.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+a+"')")}}function artHasClass(b,a){return b&&b.className&&-1!=(" "+b.className+" ").indexOf(" "+a+" ")}
function gTranslateFix(){for(var b=xGetElementsByClassName("art-menu",document),a=0;a<b.length;a++){for(var c=b[a].childNodes,h=[],f=0;f<c.length;f++){var d=c[f];"li"==String(d.tagName).toLowerCase()&&h.push(d)}for(f=0;f<h.length;f++){var e=h[f];d=c=null;for(var g=0;g<e.childNodes.length;g++){var k=e.childNodes[g];k&&k.tagName&&("a"==String(k.tagName).toLowerCase()&&(c=k),"span"==String(k.tagName).toLowerCase()&&(d=k))}if(d&&c){for(e=0;e<d.childNodes.length;e++)if((g=d.childNodes[e])&&g.tagName&&
("a"==String(g.tagName).toLowerCase()&&g.firstChild&&(g=g.firstChild),g&&g.className&&"t"==g.className)){e=g;if(e.firstChild&&e.firstChild.tagName&&"a"==String(e.firstChild.tagName).toLowerCase()){for(;e.firstChild.firstChild;)e.appendChild(e.firstChild.firstChild);e.removeChild(e.firstChild)}c.appendChild(e);break}d.parentNode.removeChild(d)}}}}artLoadEvent.add(gTranslateFix);
function Insert_Separators(){for(var b=xGetElementsByClassName("art-menu",document),a=0;a<b.length;a++){for(var c=b[a].childNodes,h=[],f=0;f<c.length;f++){var d=c[f];"li"==String(d.tagName).toLowerCase()&&h.push(d)}for(f=0;f<h.length-1;f++){c=h[f];d=document.createElement("span");d.className="art-menu-separator";var e=document.createElement("li");e.appendChild(d);c.parentNode.insertBefore(e,c.nextSibling)}}}artLoadEvent.add(Insert_Separators);
function Menu_IE6Setup(){if(-1!=navigator.userAgent.toLowerCase().indexOf("msie")&&-1==navigator.userAgent.toLowerCase().indexOf("msie 7")){var b,a,c,h=xGetElementsByClassName("art-menu",document,"ul");for(b=0;b<h.length;b++){var f=h[b].getElementsByTagName("li");for(a=0;a<f.length;a++){var d=f[a];(c=d.getElementsByTagName("ul"))&&c.length&&(d.UL=c[0],(c=d.getElementsByTagName("a"))&&c.length&&(d.A=c[0]),d.onmouseenter=function(){this.className+=" art-menuhover";this.UL.className+=" art-menuhoverUL";
this.A&&(this.A.className+=" art-menuhoverA")},d.onmouseleave=function(){this.className=this.className.replace(/art-menuhover/,"");this.UL.className=this.UL.className.replace(/art-menuhoverUL/,"");this.A&&(this.A.className=this.A.className.replace(/art-menuhoverA/,""))})}}}}artLoadEvent.add(Menu_IE6Setup);
function artButtonsSetupJsHover(b){for(var a=["input","a","button"],c=0;c<a.length;c++)for(var h=xGetElementsByClassName(b,document,a[c]),f=0;f<h.length;f++){var d=h[f];if(!d.tagName||!d.parentNode)return;if(!artHasClass(d.parentNode,"art-button-wrapper")){artHasClass(d,"art-button")||(d.className+=" art-button");var e=document.createElement("span");e.className="art-button-wrapper";artHasClass(d,"active")&&(e.className+=" active");var g=document.createElement("span");g.className="l";g.innerHTML=" ";
e.appendChild(g);g=document.createElement("span");g.className="r";g.innerHTML=" ";e.appendChild(g);d.parentNode.insertBefore(e,d);e.appendChild(d)}artEventHelper.bind(d,"mouseover",function(a){a=a||window.event;e=(a.target||a.srcElement).parentNode;e.className+=" hover"});artEventHelper.bind(d,"mouseout",function(a){a=a||window.event;d=a.target||a.srcElement;e=d.parentNode;e.className=e.className.replace(/hover/,"");artHasClass(d,"active")||(e.className=e.className.replace(/active/,""))});artEventHelper.bind(d,
"mousedown",function(a){a=a||window.event;d=a.target||a.srcElement;e=d.parentNode;artHasClass(d,"active")||(e.className+=" active")});artEventHelper.bind(d,"mouseup",function(a){a=a||window.event;d=a.target||a.srcElement;e=d.parentNode;artHasClass(d,"active")||(e.className=e.className.replace(/active/,""))})}}artLoadEvent.add(function(){artButtonsSetupJsHover("art-button")});
;
/*! jQuery UI - v1.12.1 - 2016-09-14
* http://jqueryui.com
* Includes: widget.js, position.js, data.js, disable-selection.js, effect.js, effects/effect-blind.js, effects/effect-bounce.js, effects/effect-clip.js, effects/effect-drop.js, effects/effect-explode.js, effects/effect-fade.js, effects/effect-fold.js, effects/effect-highlight.js, effects/effect-puff.js, effects/effect-pulsate.js, effects/effect-scale.js, effects/effect-shake.js, effects/effect-size.js, effects/effect-slide.js, effects/effect-transfer.js, focusable.js, form-reset-mixin.js, jquery-1-7.js, keycode.js, labels.js, scroll-parent.js, tabbable.js, unique-id.js, widgets/accordion.js, widgets/autocomplete.js, widgets/button.js, widgets/checkboxradio.js, widgets/controlgroup.js, widgets/datepicker.js, widgets/dialog.js, widgets/draggable.js, widgets/droppable.js, widgets/menu.js, widgets/mouse.js, widgets/progressbar.js, widgets/resizable.js, widgets/selectable.js, widgets/selectmenu.js, widgets/slider.js, widgets/sortable.js, widgets/spinner.js, widgets/tabs.js, widgets/tooltip.js
* Copyright jQuery Foundation and other contributors; Licensed MIT */

(function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)})(function(t){function e(t){for(var e=t.css("visibility");"inherit"===e;)t=t.parent(),e=t.css("visibility");return"hidden"!==e}function i(t){for(var e,i;t.length&&t[0]!==document;){if(e=t.css("position"),("absolute"===e||"relative"===e||"fixed"===e)&&(i=parseInt(t.css("zIndex"),10),!isNaN(i)&&0!==i))return i;t=t.parent()}return 0}function s(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},t.extend(this._defaults,this.regional[""]),this.regional.en=t.extend(!0,{},this.regional[""]),this.regional["en-US"]=t.extend(!0,{},this.regional.en),this.dpDiv=n(t("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function n(e){var i="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return e.on("mouseout",i,function(){t(this).removeClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&t(this).removeClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&t(this).removeClass("ui-datepicker-next-hover")}).on("mouseover",i,o)}function o(){t.datepicker._isDisabledDatepicker(m.inline?m.dpDiv.parent()[0]:m.input[0])||(t(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),t(this).addClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&t(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&t(this).addClass("ui-datepicker-next-hover"))}function a(e,i){t.extend(e,i);for(var s in i)null==i[s]&&(e[s]=i[s]);return e}function r(t){return function(){var e=this.element.val();t.apply(this,arguments),this._refresh(),e!==this.element.val()&&this._trigger("change")}}t.ui=t.ui||{},t.ui.version="1.12.1";var h=0,l=Array.prototype.slice;t.cleanData=function(e){return function(i){var s,n,o;for(o=0;null!=(n=i[o]);o++)try{s=t._data(n,"events"),s&&s.remove&&t(n).triggerHandler("remove")}catch(a){}e(i)}}(t.cleanData),t.widget=function(e,i,s){var n,o,a,r={},h=e.split(".")[0];e=e.split(".")[1];var l=h+"-"+e;return s||(s=i,i=t.Widget),t.isArray(s)&&(s=t.extend.apply(null,[{}].concat(s))),t.expr[":"][l.toLowerCase()]=function(e){return!!t.data(e,l)},t[h]=t[h]||{},n=t[h][e],o=t[h][e]=function(t,e){return this._createWidget?(arguments.length&&this._createWidget(t,e),void 0):new o(t,e)},t.extend(o,n,{version:s.version,_proto:t.extend({},s),_childConstructors:[]}),a=new i,a.options=t.widget.extend({},a.options),t.each(s,function(e,s){return t.isFunction(s)?(r[e]=function(){function t(){return i.prototype[e].apply(this,arguments)}function n(t){return i.prototype[e].apply(this,t)}return function(){var e,i=this._super,o=this._superApply;return this._super=t,this._superApply=n,e=s.apply(this,arguments),this._super=i,this._superApply=o,e}}(),void 0):(r[e]=s,void 0)}),o.prototype=t.widget.extend(a,{widgetEventPrefix:n?a.widgetEventPrefix||e:e},r,{constructor:o,namespace:h,widgetName:e,widgetFullName:l}),n?(t.each(n._childConstructors,function(e,i){var s=i.prototype;t.widget(s.namespace+"."+s.widgetName,o,i._proto)}),delete n._childConstructors):i._childConstructors.push(o),t.widget.bridge(e,o),o},t.widget.extend=function(e){for(var i,s,n=l.call(arguments,1),o=0,a=n.length;a>o;o++)for(i in n[o])s=n[o][i],n[o].hasOwnProperty(i)&&void 0!==s&&(e[i]=t.isPlainObject(s)?t.isPlainObject(e[i])?t.widget.extend({},e[i],s):t.widget.extend({},s):s);return e},t.widget.bridge=function(e,i){var s=i.prototype.widgetFullName||e;t.fn[e]=function(n){var o="string"==typeof n,a=l.call(arguments,1),r=this;return o?this.length||"instance"!==n?this.each(function(){var i,o=t.data(this,s);return"instance"===n?(r=o,!1):o?t.isFunction(o[n])&&"_"!==n.charAt(0)?(i=o[n].apply(o,a),i!==o&&void 0!==i?(r=i&&i.jquery?r.pushStack(i.get()):i,!1):void 0):t.error("no such method '"+n+"' for "+e+" widget instance"):t.error("cannot call methods on "+e+" prior to initialization; "+"attempted to call method '"+n+"'")}):r=void 0:(a.length&&(n=t.widget.extend.apply(null,[n].concat(a))),this.each(function(){var e=t.data(this,s);e?(e.option(n||{}),e._init&&e._init()):t.data(this,s,new i(n,this))})),r}},t.Widget=function(){},t.Widget._childConstructors=[],t.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{classes:{},disabled:!1,create:null},_createWidget:function(e,i){i=t(i||this.defaultElement||this)[0],this.element=t(i),this.uuid=h++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=t(),this.hoverable=t(),this.focusable=t(),this.classesElementLookup={},i!==this&&(t.data(i,this.widgetFullName,this),this._on(!0,this.element,{remove:function(t){t.target===i&&this.destroy()}}),this.document=t(i.style?i.ownerDocument:i.document||i),this.window=t(this.document[0].defaultView||this.document[0].parentWindow)),this.options=t.widget.extend({},this.options,this._getCreateOptions(),e),this._create(),this.options.disabled&&this._setOptionDisabled(this.options.disabled),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:function(){return{}},_getCreateEventData:t.noop,_create:t.noop,_init:t.noop,destroy:function(){var e=this;this._destroy(),t.each(this.classesElementLookup,function(t,i){e._removeClass(i,t)}),this.element.off(this.eventNamespace).removeData(this.widgetFullName),this.widget().off(this.eventNamespace).removeAttr("aria-disabled"),this.bindings.off(this.eventNamespace)},_destroy:t.noop,widget:function(){return this.element},option:function(e,i){var s,n,o,a=e;if(0===arguments.length)return t.widget.extend({},this.options);if("string"==typeof e)if(a={},s=e.split("."),e=s.shift(),s.length){for(n=a[e]=t.widget.extend({},this.options[e]),o=0;s.length-1>o;o++)n[s[o]]=n[s[o]]||{},n=n[s[o]];if(e=s.pop(),1===arguments.length)return void 0===n[e]?null:n[e];n[e]=i}else{if(1===arguments.length)return void 0===this.options[e]?null:this.options[e];a[e]=i}return this._setOptions(a),this},_setOptions:function(t){var e;for(e in t)this._setOption(e,t[e]);return this},_setOption:function(t,e){return"classes"===t&&this._setOptionClasses(e),this.options[t]=e,"disabled"===t&&this._setOptionDisabled(e),this},_setOptionClasses:function(e){var i,s,n;for(i in e)n=this.classesElementLookup[i],e[i]!==this.options.classes[i]&&n&&n.length&&(s=t(n.get()),this._removeClass(n,i),s.addClass(this._classes({element:s,keys:i,classes:e,add:!0})))},_setOptionDisabled:function(t){this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!!t),t&&(this._removeClass(this.hoverable,null,"ui-state-hover"),this._removeClass(this.focusable,null,"ui-state-focus"))},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_classes:function(e){function i(i,o){var a,r;for(r=0;i.length>r;r++)a=n.classesElementLookup[i[r]]||t(),a=e.add?t(t.unique(a.get().concat(e.element.get()))):t(a.not(e.element).get()),n.classesElementLookup[i[r]]=a,s.push(i[r]),o&&e.classes[i[r]]&&s.push(e.classes[i[r]])}var s=[],n=this;return e=t.extend({element:this.element,classes:this.options.classes||{}},e),this._on(e.element,{remove:"_untrackClassesElement"}),e.keys&&i(e.keys.match(/\S+/g)||[],!0),e.extra&&i(e.extra.match(/\S+/g)||[]),s.join(" ")},_untrackClassesElement:function(e){var i=this;t.each(i.classesElementLookup,function(s,n){-1!==t.inArray(e.target,n)&&(i.classesElementLookup[s]=t(n.not(e.target).get()))})},_removeClass:function(t,e,i){return this._toggleClass(t,e,i,!1)},_addClass:function(t,e,i){return this._toggleClass(t,e,i,!0)},_toggleClass:function(t,e,i,s){s="boolean"==typeof s?s:i;var n="string"==typeof t||null===t,o={extra:n?e:i,keys:n?t:e,element:n?this.element:t,add:s};return o.element.toggleClass(this._classes(o),s),this},_on:function(e,i,s){var n,o=this;"boolean"!=typeof e&&(s=i,i=e,e=!1),s?(i=n=t(i),this.bindings=this.bindings.add(i)):(s=i,i=this.element,n=this.widget()),t.each(s,function(s,a){function r(){return e||o.options.disabled!==!0&&!t(this).hasClass("ui-state-disabled")?("string"==typeof a?o[a]:a).apply(o,arguments):void 0}"string"!=typeof a&&(r.guid=a.guid=a.guid||r.guid||t.guid++);var h=s.match(/^([\w:-]*)\s*(.*)$/),l=h[1]+o.eventNamespace,c=h[2];c?n.on(l,c,r):i.on(l,r)})},_off:function(e,i){i=(i||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.off(i).off(i),this.bindings=t(this.bindings.not(e).get()),this.focusable=t(this.focusable.not(e).get()),this.hoverable=t(this.hoverable.not(e).get())},_delay:function(t,e){function i(){return("string"==typeof t?s[t]:t).apply(s,arguments)}var s=this;return setTimeout(i,e||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e),this._on(e,{mouseenter:function(e){this._addClass(t(e.currentTarget),null,"ui-state-hover")},mouseleave:function(e){this._removeClass(t(e.currentTarget),null,"ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e),this._on(e,{focusin:function(e){this._addClass(t(e.currentTarget),null,"ui-state-focus")},focusout:function(e){this._removeClass(t(e.currentTarget),null,"ui-state-focus")}})},_trigger:function(e,i,s){var n,o,a=this.options[e];if(s=s||{},i=t.Event(i),i.type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase(),i.target=this.element[0],o=i.originalEvent)for(n in o)n in i||(i[n]=o[n]);return this.element.trigger(i,s),!(t.isFunction(a)&&a.apply(this.element[0],[i].concat(s))===!1||i.isDefaultPrevented())}},t.each({show:"fadeIn",hide:"fadeOut"},function(e,i){t.Widget.prototype["_"+e]=function(s,n,o){"string"==typeof n&&(n={effect:n});var a,r=n?n===!0||"number"==typeof n?i:n.effect||i:e;n=n||{},"number"==typeof n&&(n={duration:n}),a=!t.isEmptyObject(n),n.complete=o,n.delay&&s.delay(n.delay),a&&t.effects&&t.effects.effect[r]?s[e](n):r!==e&&s[r]?s[r](n.duration,n.easing,o):s.queue(function(i){t(this)[e](),o&&o.call(s[0]),i()})}}),t.widget,function(){function e(t,e,i){return[parseFloat(t[0])*(u.test(t[0])?e/100:1),parseFloat(t[1])*(u.test(t[1])?i/100:1)]}function i(e,i){return parseInt(t.css(e,i),10)||0}function s(e){var i=e[0];return 9===i.nodeType?{width:e.width(),height:e.height(),offset:{top:0,left:0}}:t.isWindow(i)?{width:e.width(),height:e.height(),offset:{top:e.scrollTop(),left:e.scrollLeft()}}:i.preventDefault?{width:0,height:0,offset:{top:i.pageY,left:i.pageX}}:{width:e.outerWidth(),height:e.outerHeight(),offset:e.offset()}}var n,o=Math.max,a=Math.abs,r=/left|center|right/,h=/top|center|bottom/,l=/[\+\-]\d+(\.[\d]+)?%?/,c=/^\w+/,u=/%$/,d=t.fn.position;t.position={scrollbarWidth:function(){if(void 0!==n)return n;var e,i,s=t("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),o=s.children()[0];return t("body").append(s),e=o.offsetWidth,s.css("overflow","scroll"),i=o.offsetWidth,e===i&&(i=s[0].clientWidth),s.remove(),n=e-i},getScrollInfo:function(e){var i=e.isWindow||e.isDocument?"":e.element.css("overflow-x"),s=e.isWindow||e.isDocument?"":e.element.css("overflow-y"),n="scroll"===i||"auto"===i&&e.width<e.element[0].scrollWidth,o="scroll"===s||"auto"===s&&e.height<e.element[0].scrollHeight;return{width:o?t.position.scrollbarWidth():0,height:n?t.position.scrollbarWidth():0}},getWithinInfo:function(e){var i=t(e||window),s=t.isWindow(i[0]),n=!!i[0]&&9===i[0].nodeType,o=!s&&!n;return{element:i,isWindow:s,isDocument:n,offset:o?t(e).offset():{left:0,top:0},scrollLeft:i.scrollLeft(),scrollTop:i.scrollTop(),width:i.outerWidth(),height:i.outerHeight()}}},t.fn.position=function(n){if(!n||!n.of)return d.apply(this,arguments);n=t.extend({},n);var u,p,f,g,m,_,v=t(n.of),b=t.position.getWithinInfo(n.within),y=t.position.getScrollInfo(b),w=(n.collision||"flip").split(" "),k={};return _=s(v),v[0].preventDefault&&(n.at="left top"),p=_.width,f=_.height,g=_.offset,m=t.extend({},g),t.each(["my","at"],function(){var t,e,i=(n[this]||"").split(" ");1===i.length&&(i=r.test(i[0])?i.concat(["center"]):h.test(i[0])?["center"].concat(i):["center","center"]),i[0]=r.test(i[0])?i[0]:"center",i[1]=h.test(i[1])?i[1]:"center",t=l.exec(i[0]),e=l.exec(i[1]),k[this]=[t?t[0]:0,e?e[0]:0],n[this]=[c.exec(i[0])[0],c.exec(i[1])[0]]}),1===w.length&&(w[1]=w[0]),"right"===n.at[0]?m.left+=p:"center"===n.at[0]&&(m.left+=p/2),"bottom"===n.at[1]?m.top+=f:"center"===n.at[1]&&(m.top+=f/2),u=e(k.at,p,f),m.left+=u[0],m.top+=u[1],this.each(function(){var s,r,h=t(this),l=h.outerWidth(),c=h.outerHeight(),d=i(this,"marginLeft"),_=i(this,"marginTop"),x=l+d+i(this,"marginRight")+y.width,C=c+_+i(this,"marginBottom")+y.height,D=t.extend({},m),I=e(k.my,h.outerWidth(),h.outerHeight());"right"===n.my[0]?D.left-=l:"center"===n.my[0]&&(D.left-=l/2),"bottom"===n.my[1]?D.top-=c:"center"===n.my[1]&&(D.top-=c/2),D.left+=I[0],D.top+=I[1],s={marginLeft:d,marginTop:_},t.each(["left","top"],function(e,i){t.ui.position[w[e]]&&t.ui.position[w[e]][i](D,{targetWidth:p,targetHeight:f,elemWidth:l,elemHeight:c,collisionPosition:s,collisionWidth:x,collisionHeight:C,offset:[u[0]+I[0],u[1]+I[1]],my:n.my,at:n.at,within:b,elem:h})}),n.using&&(r=function(t){var e=g.left-D.left,i=e+p-l,s=g.top-D.top,r=s+f-c,u={target:{element:v,left:g.left,top:g.top,width:p,height:f},element:{element:h,left:D.left,top:D.top,width:l,height:c},horizontal:0>i?"left":e>0?"right":"center",vertical:0>r?"top":s>0?"bottom":"middle"};l>p&&p>a(e+i)&&(u.horizontal="center"),c>f&&f>a(s+r)&&(u.vertical="middle"),u.important=o(a(e),a(i))>o(a(s),a(r))?"horizontal":"vertical",n.using.call(this,t,u)}),h.offset(t.extend(D,{using:r}))})},t.ui.position={fit:{left:function(t,e){var i,s=e.within,n=s.isWindow?s.scrollLeft:s.offset.left,a=s.width,r=t.left-e.collisionPosition.marginLeft,h=n-r,l=r+e.collisionWidth-a-n;e.collisionWidth>a?h>0&&0>=l?(i=t.left+h+e.collisionWidth-a-n,t.left+=h-i):t.left=l>0&&0>=h?n:h>l?n+a-e.collisionWidth:n:h>0?t.left+=h:l>0?t.left-=l:t.left=o(t.left-r,t.left)},top:function(t,e){var i,s=e.within,n=s.isWindow?s.scrollTop:s.offset.top,a=e.within.height,r=t.top-e.collisionPosition.marginTop,h=n-r,l=r+e.collisionHeight-a-n;e.collisionHeight>a?h>0&&0>=l?(i=t.top+h+e.collisionHeight-a-n,t.top+=h-i):t.top=l>0&&0>=h?n:h>l?n+a-e.collisionHeight:n:h>0?t.top+=h:l>0?t.top-=l:t.top=o(t.top-r,t.top)}},flip:{left:function(t,e){var i,s,n=e.within,o=n.offset.left+n.scrollLeft,r=n.width,h=n.isWindow?n.scrollLeft:n.offset.left,l=t.left-e.collisionPosition.marginLeft,c=l-h,u=l+e.collisionWidth-r-h,d="left"===e.my[0]?-e.elemWidth:"right"===e.my[0]?e.elemWidth:0,p="left"===e.at[0]?e.targetWidth:"right"===e.at[0]?-e.targetWidth:0,f=-2*e.offset[0];0>c?(i=t.left+d+p+f+e.collisionWidth-r-o,(0>i||a(c)>i)&&(t.left+=d+p+f)):u>0&&(s=t.left-e.collisionPosition.marginLeft+d+p+f-h,(s>0||u>a(s))&&(t.left+=d+p+f))},top:function(t,e){var i,s,n=e.within,o=n.offset.top+n.scrollTop,r=n.height,h=n.isWindow?n.scrollTop:n.offset.top,l=t.top-e.collisionPosition.marginTop,c=l-h,u=l+e.collisionHeight-r-h,d="top"===e.my[1],p=d?-e.elemHeight:"bottom"===e.my[1]?e.elemHeight:0,f="top"===e.at[1]?e.targetHeight:"bottom"===e.at[1]?-e.targetHeight:0,g=-2*e.offset[1];0>c?(s=t.top+p+f+g+e.collisionHeight-r-o,(0>s||a(c)>s)&&(t.top+=p+f+g)):u>0&&(i=t.top-e.collisionPosition.marginTop+p+f+g-h,(i>0||u>a(i))&&(t.top+=p+f+g))}},flipfit:{left:function(){t.ui.position.flip.left.apply(this,arguments),t.ui.position.fit.left.apply(this,arguments)},top:function(){t.ui.position.flip.top.apply(this,arguments),t.ui.position.fit.top.apply(this,arguments)}}}}(),t.ui.position,t.extend(t.expr[":"],{data:t.expr.createPseudo?t.expr.createPseudo(function(e){return function(i){return!!t.data(i,e)}}):function(e,i,s){return!!t.data(e,s[3])}}),t.fn.extend({disableSelection:function(){var t="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.on(t+".ui-disableSelection",function(t){t.preventDefault()})}}(),enableSelection:function(){return this.off(".ui-disableSelection")}});var c="ui-effects-",u="ui-effects-style",d="ui-effects-animated",p=t;t.effects={effect:{}},function(t,e){function i(t,e,i){var s=u[e.type]||{};return null==t?i||!e.def?null:e.def:(t=s.floor?~~t:parseFloat(t),isNaN(t)?e.def:s.mod?(t+s.mod)%s.mod:0>t?0:t>s.max?s.max:t)}function s(i){var s=l(),n=s._rgba=[];return i=i.toLowerCase(),f(h,function(t,o){var a,r=o.re.exec(i),h=r&&o.parse(r),l=o.space||"rgba";return h?(a=s[l](h),s[c[l].cache]=a[c[l].cache],n=s._rgba=a._rgba,!1):e}),n.length?("0,0,0,0"===n.join()&&t.extend(n,o.transparent),s):o[i]}function n(t,e,i){return i=(i+1)%1,1>6*i?t+6*(e-t)*i:1>2*i?e:2>3*i?t+6*(e-t)*(2/3-i):t}var o,a="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",r=/^([\-+])=\s*(\d+\.?\d*)/,h=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(t){return[t[1],t[2],t[3],t[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(t){return[2.55*t[1],2.55*t[2],2.55*t[3],t[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(t){return[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(t){return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(t){return[t[1],t[2]/100,t[3]/100,t[4]]}}],l=t.Color=function(e,i,s,n){return new t.Color.fn.parse(e,i,s,n)},c={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},u={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},d=l.support={},p=t("<p>")[0],f=t.each;p.style.cssText="background-color:rgba(1,1,1,.5)",d.rgba=p.style.backgroundColor.indexOf("rgba")>-1,f(c,function(t,e){e.cache="_"+t,e.props.alpha={idx:3,type:"percent",def:1}}),l.fn=t.extend(l.prototype,{parse:function(n,a,r,h){if(n===e)return this._rgba=[null,null,null,null],this;(n.jquery||n.nodeType)&&(n=t(n).css(a),a=e);var u=this,d=t.type(n),p=this._rgba=[];return a!==e&&(n=[n,a,r,h],d="array"),"string"===d?this.parse(s(n)||o._default):"array"===d?(f(c.rgba.props,function(t,e){p[e.idx]=i(n[e.idx],e)}),this):"object"===d?(n instanceof l?f(c,function(t,e){n[e.cache]&&(u[e.cache]=n[e.cache].slice())}):f(c,function(e,s){var o=s.cache;f(s.props,function(t,e){if(!u[o]&&s.to){if("alpha"===t||null==n[t])return;u[o]=s.to(u._rgba)}u[o][e.idx]=i(n[t],e,!0)}),u[o]&&0>t.inArray(null,u[o].slice(0,3))&&(u[o][3]=1,s.from&&(u._rgba=s.from(u[o])))}),this):e},is:function(t){var i=l(t),s=!0,n=this;return f(c,function(t,o){var a,r=i[o.cache];return r&&(a=n[o.cache]||o.to&&o.to(n._rgba)||[],f(o.props,function(t,i){return null!=r[i.idx]?s=r[i.idx]===a[i.idx]:e})),s}),s},_space:function(){var t=[],e=this;return f(c,function(i,s){e[s.cache]&&t.push(i)}),t.pop()},transition:function(t,e){var s=l(t),n=s._space(),o=c[n],a=0===this.alpha()?l("transparent"):this,r=a[o.cache]||o.to(a._rgba),h=r.slice();return s=s[o.cache],f(o.props,function(t,n){var o=n.idx,a=r[o],l=s[o],c=u[n.type]||{};null!==l&&(null===a?h[o]=l:(c.mod&&(l-a>c.mod/2?a+=c.mod:a-l>c.mod/2&&(a-=c.mod)),h[o]=i((l-a)*e+a,n)))}),this[n](h)},blend:function(e){if(1===this._rgba[3])return this;var i=this._rgba.slice(),s=i.pop(),n=l(e)._rgba;return l(t.map(i,function(t,e){return(1-s)*n[e]+s*t}))},toRgbaString:function(){var e="rgba(",i=t.map(this._rgba,function(t,e){return null==t?e>2?1:0:t});return 1===i[3]&&(i.pop(),e="rgb("),e+i.join()+")"},toHslaString:function(){var e="hsla(",i=t.map(this.hsla(),function(t,e){return null==t&&(t=e>2?1:0),e&&3>e&&(t=Math.round(100*t)+"%"),t});return 1===i[3]&&(i.pop(),e="hsl("),e+i.join()+")"},toHexString:function(e){var i=this._rgba.slice(),s=i.pop();return e&&i.push(~~(255*s)),"#"+t.map(i,function(t){return t=(t||0).toString(16),1===t.length?"0"+t:t}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),l.fn.parse.prototype=l.fn,c.hsla.to=function(t){if(null==t[0]||null==t[1]||null==t[2])return[null,null,null,t[3]];var e,i,s=t[0]/255,n=t[1]/255,o=t[2]/255,a=t[3],r=Math.max(s,n,o),h=Math.min(s,n,o),l=r-h,c=r+h,u=.5*c;return e=h===r?0:s===r?60*(n-o)/l+360:n===r?60*(o-s)/l+120:60*(s-n)/l+240,i=0===l?0:.5>=u?l/c:l/(2-c),[Math.round(e)%360,i,u,null==a?1:a]},c.hsla.from=function(t){if(null==t[0]||null==t[1]||null==t[2])return[null,null,null,t[3]];var e=t[0]/360,i=t[1],s=t[2],o=t[3],a=.5>=s?s*(1+i):s+i-s*i,r=2*s-a;return[Math.round(255*n(r,a,e+1/3)),Math.round(255*n(r,a,e)),Math.round(255*n(r,a,e-1/3)),o]},f(c,function(s,n){var o=n.props,a=n.cache,h=n.to,c=n.from;l.fn[s]=function(s){if(h&&!this[a]&&(this[a]=h(this._rgba)),s===e)return this[a].slice();var n,r=t.type(s),u="array"===r||"object"===r?s:arguments,d=this[a].slice();return f(o,function(t,e){var s=u["object"===r?t:e.idx];null==s&&(s=d[e.idx]),d[e.idx]=i(s,e)}),c?(n=l(c(d)),n[a]=d,n):l(d)},f(o,function(e,i){l.fn[e]||(l.fn[e]=function(n){var o,a=t.type(n),h="alpha"===e?this._hsla?"hsla":"rgba":s,l=this[h](),c=l[i.idx];return"undefined"===a?c:("function"===a&&(n=n.call(this,c),a=t.type(n)),null==n&&i.empty?this:("string"===a&&(o=r.exec(n),o&&(n=c+parseFloat(o[2])*("+"===o[1]?1:-1))),l[i.idx]=n,this[h](l)))})})}),l.hook=function(e){var i=e.split(" ");f(i,function(e,i){t.cssHooks[i]={set:function(e,n){var o,a,r="";if("transparent"!==n&&("string"!==t.type(n)||(o=s(n)))){if(n=l(o||n),!d.rgba&&1!==n._rgba[3]){for(a="backgroundColor"===i?e.parentNode:e;(""===r||"transparent"===r)&&a&&a.style;)try{r=t.css(a,"backgroundColor"),a=a.parentNode}catch(h){}n=n.blend(r&&"transparent"!==r?r:"_default")}n=n.toRgbaString()}try{e.style[i]=n}catch(h){}}},t.fx.step[i]=function(e){e.colorInit||(e.start=l(e.elem,i),e.end=l(e.end),e.colorInit=!0),t.cssHooks[i].set(e.elem,e.start.transition(e.end,e.pos))}})},l.hook(a),t.cssHooks.borderColor={expand:function(t){var e={};return f(["Top","Right","Bottom","Left"],function(i,s){e["border"+s+"Color"]=t}),e}},o=t.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(p),function(){function e(e){var i,s,n=e.ownerDocument.defaultView?e.ownerDocument.defaultView.getComputedStyle(e,null):e.currentStyle,o={};if(n&&n.length&&n[0]&&n[n[0]])for(s=n.length;s--;)i=n[s],"string"==typeof n[i]&&(o[t.camelCase(i)]=n[i]);else for(i in n)"string"==typeof n[i]&&(o[i]=n[i]);return o}function i(e,i){var s,o,a={};for(s in i)o=i[s],e[s]!==o&&(n[s]||(t.fx.step[s]||!isNaN(parseFloat(o)))&&(a[s]=o));return a}var s=["add","remove","toggle"],n={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};t.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(e,i){t.fx.step[i]=function(t){("none"!==t.end&&!t.setAttr||1===t.pos&&!t.setAttr)&&(p.style(t.elem,i,t.end),t.setAttr=!0)}}),t.fn.addBack||(t.fn.addBack=function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}),t.effects.animateClass=function(n,o,a,r){var h=t.speed(o,a,r);return this.queue(function(){var o,a=t(this),r=a.attr("class")||"",l=h.children?a.find("*").addBack():a;l=l.map(function(){var i=t(this);return{el:i,start:e(this)}}),o=function(){t.each(s,function(t,e){n[e]&&a[e+"Class"](n[e])})},o(),l=l.map(function(){return this.end=e(this.el[0]),this.diff=i(this.start,this.end),this}),a.attr("class",r),l=l.map(function(){var e=this,i=t.Deferred(),s=t.extend({},h,{queue:!1,complete:function(){i.resolve(e)}});return this.el.animate(this.diff,s),i.promise()}),t.when.apply(t,l.get()).done(function(){o(),t.each(arguments,function(){var e=this.el;t.each(this.diff,function(t){e.css(t,"")})}),h.complete.call(a[0])})})},t.fn.extend({addClass:function(e){return function(i,s,n,o){return s?t.effects.animateClass.call(this,{add:i},s,n,o):e.apply(this,arguments)}}(t.fn.addClass),removeClass:function(e){return function(i,s,n,o){return arguments.length>1?t.effects.animateClass.call(this,{remove:i},s,n,o):e.apply(this,arguments)}}(t.fn.removeClass),toggleClass:function(e){return function(i,s,n,o,a){return"boolean"==typeof s||void 0===s?n?t.effects.animateClass.call(this,s?{add:i}:{remove:i},n,o,a):e.apply(this,arguments):t.effects.animateClass.call(this,{toggle:i},s,n,o)}}(t.fn.toggleClass),switchClass:function(e,i,s,n,o){return t.effects.animateClass.call(this,{add:i,remove:e},s,n,o)}})}(),function(){function e(e,i,s,n){return t.isPlainObject(e)&&(i=e,e=e.effect),e={effect:e},null==i&&(i={}),t.isFunction(i)&&(n=i,s=null,i={}),("number"==typeof i||t.fx.speeds[i])&&(n=s,s=i,i={}),t.isFunction(s)&&(n=s,s=null),i&&t.extend(e,i),s=s||i.duration,e.duration=t.fx.off?0:"number"==typeof s?s:s in t.fx.speeds?t.fx.speeds[s]:t.fx.speeds._default,e.complete=n||i.complete,e}function i(e){return!e||"number"==typeof e||t.fx.speeds[e]?!0:"string"!=typeof e||t.effects.effect[e]?t.isFunction(e)?!0:"object"!=typeof e||e.effect?!1:!0:!0}function s(t,e){var i=e.outerWidth(),s=e.outerHeight(),n=/^rect\((-?\d*\.?\d*px|-?\d+%|auto),?\s*(-?\d*\.?\d*px|-?\d+%|auto),?\s*(-?\d*\.?\d*px|-?\d+%|auto),?\s*(-?\d*\.?\d*px|-?\d+%|auto)\)$/,o=n.exec(t)||["",0,i,s,0];return{top:parseFloat(o[1])||0,right:"auto"===o[2]?i:parseFloat(o[2]),bottom:"auto"===o[3]?s:parseFloat(o[3]),left:parseFloat(o[4])||0}}t.expr&&t.expr.filters&&t.expr.filters.animated&&(t.expr.filters.animated=function(e){return function(i){return!!t(i).data(d)||e(i)}}(t.expr.filters.animated)),t.uiBackCompat!==!1&&t.extend(t.effects,{save:function(t,e){for(var i=0,s=e.length;s>i;i++)null!==e[i]&&t.data(c+e[i],t[0].style[e[i]])},restore:function(t,e){for(var i,s=0,n=e.length;n>s;s++)null!==e[s]&&(i=t.data(c+e[s]),t.css(e[s],i))},setMode:function(t,e){return"toggle"===e&&(e=t.is(":hidden")?"show":"hide"),e},createWrapper:function(e){if(e.parent().is(".ui-effects-wrapper"))return e.parent();var i={width:e.outerWidth(!0),height:e.outerHeight(!0),"float":e.css("float")},s=t("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),n={width:e.width(),height:e.height()},o=document.activeElement;try{o.id}catch(a){o=document.body}return e.wrap(s),(e[0]===o||t.contains(e[0],o))&&t(o).trigger("focus"),s=e.parent(),"static"===e.css("position")?(s.css({position:"relative"}),e.css({position:"relative"})):(t.extend(i,{position:e.css("position"),zIndex:e.css("z-index")}),t.each(["top","left","bottom","right"],function(t,s){i[s]=e.css(s),isNaN(parseInt(i[s],10))&&(i[s]="auto")}),e.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),e.css(n),s.css(i).show()},removeWrapper:function(e){var i=document.activeElement;return e.parent().is(".ui-effects-wrapper")&&(e.parent().replaceWith(e),(e[0]===i||t.contains(e[0],i))&&t(i).trigger("focus")),e}}),t.extend(t.effects,{version:"1.12.1",define:function(e,i,s){return s||(s=i,i="effect"),t.effects.effect[e]=s,t.effects.effect[e].mode=i,s},scaledDimensions:function(t,e,i){if(0===e)return{height:0,width:0,outerHeight:0,outerWidth:0};var s="horizontal"!==i?(e||100)/100:1,n="vertical"!==i?(e||100)/100:1;return{height:t.height()*n,width:t.width()*s,outerHeight:t.outerHeight()*n,outerWidth:t.outerWidth()*s}},clipToBox:function(t){return{width:t.clip.right-t.clip.left,height:t.clip.bottom-t.clip.top,left:t.clip.left,top:t.clip.top}},unshift:function(t,e,i){var s=t.queue();e>1&&s.splice.apply(s,[1,0].concat(s.splice(e,i))),t.dequeue()},saveStyle:function(t){t.data(u,t[0].style.cssText)},restoreStyle:function(t){t[0].style.cssText=t.data(u)||"",t.removeData(u)},mode:function(t,e){var i=t.is(":hidden");return"toggle"===e&&(e=i?"show":"hide"),(i?"hide"===e:"show"===e)&&(e="none"),e},getBaseline:function(t,e){var i,s;switch(t[0]){case"top":i=0;break;case"middle":i=.5;break;case"bottom":i=1;break;default:i=t[0]/e.height}switch(t[1]){case"left":s=0;break;case"center":s=.5;break;case"right":s=1;break;default:s=t[1]/e.width}return{x:s,y:i}},createPlaceholder:function(e){var i,s=e.css("position"),n=e.position();return e.css({marginTop:e.css("marginTop"),marginBottom:e.css("marginBottom"),marginLeft:e.css("marginLeft"),marginRight:e.css("marginRight")}).outerWidth(e.outerWidth()).outerHeight(e.outerHeight()),/^(static|relative)/.test(s)&&(s="absolute",i=t("<"+e[0].nodeName+">").insertAfter(e).css({display:/^(inline|ruby)/.test(e.css("display"))?"inline-block":"block",visibility:"hidden",marginTop:e.css("marginTop"),marginBottom:e.css("marginBottom"),marginLeft:e.css("marginLeft"),marginRight:e.css("marginRight"),"float":e.css("float")}).outerWidth(e.outerWidth()).outerHeight(e.outerHeight()).addClass("ui-effects-placeholder"),e.data(c+"placeholder",i)),e.css({position:s,left:n.left,top:n.top}),i},removePlaceholder:function(t){var e=c+"placeholder",i=t.data(e);i&&(i.remove(),t.removeData(e))},cleanUp:function(e){t.effects.restoreStyle(e),t.effects.removePlaceholder(e)},setTransition:function(e,i,s,n){return n=n||{},t.each(i,function(t,i){var o=e.cssUnit(i);o[0]>0&&(n[i]=o[0]*s+o[1])}),n}}),t.fn.extend({effect:function(){function i(e){function i(){r.removeData(d),t.effects.cleanUp(r),"hide"===s.mode&&r.hide(),a()}function a(){t.isFunction(h)&&h.call(r[0]),t.isFunction(e)&&e()}var r=t(this);s.mode=c.shift(),t.uiBackCompat===!1||o?"none"===s.mode?(r[l](),a()):n.call(r[0],s,i):(r.is(":hidden")?"hide"===l:"show"===l)?(r[l](),a()):n.call(r[0],s,a)}var s=e.apply(this,arguments),n=t.effects.effect[s.effect],o=n.mode,a=s.queue,r=a||"fx",h=s.complete,l=s.mode,c=[],u=function(e){var i=t(this),s=t.effects.mode(i,l)||o;i.data(d,!0),c.push(s),o&&("show"===s||s===o&&"hide"===s)&&i.show(),o&&"none"===s||t.effects.saveStyle(i),t.isFunction(e)&&e()};return t.fx.off||!n?l?this[l](s.duration,h):this.each(function(){h&&h.call(this)}):a===!1?this.each(u).each(i):this.queue(r,u).queue(r,i)},show:function(t){return function(s){if(i(s))return t.apply(this,arguments);var n=e.apply(this,arguments);return n.mode="show",this.effect.call(this,n)
	}}(t.fn.show),hide:function(t){return function(s){if(i(s))return t.apply(this,arguments);var n=e.apply(this,arguments);return n.mode="hide",this.effect.call(this,n)}}(t.fn.hide),toggle:function(t){return function(s){if(i(s)||"boolean"==typeof s)return t.apply(this,arguments);var n=e.apply(this,arguments);return n.mode="toggle",this.effect.call(this,n)}}(t.fn.toggle),cssUnit:function(e){var i=this.css(e),s=[];return t.each(["em","px","%","pt"],function(t,e){i.indexOf(e)>0&&(s=[parseFloat(i),e])}),s},cssClip:function(t){return t?this.css("clip","rect("+t.top+"px "+t.right+"px "+t.bottom+"px "+t.left+"px)"):s(this.css("clip"),this)},transfer:function(e,i){var s=t(this),n=t(e.to),o="fixed"===n.css("position"),a=t("body"),r=o?a.scrollTop():0,h=o?a.scrollLeft():0,l=n.offset(),c={top:l.top-r,left:l.left-h,height:n.innerHeight(),width:n.innerWidth()},u=s.offset(),d=t("<div class='ui-effects-transfer'></div>").appendTo("body").addClass(e.className).css({top:u.top-r,left:u.left-h,height:s.innerHeight(),width:s.innerWidth(),position:o?"fixed":"absolute"}).animate(c,e.duration,e.easing,function(){d.remove(),t.isFunction(i)&&i()})}}),t.fx.step.clip=function(e){e.clipInit||(e.start=t(e.elem).cssClip(),"string"==typeof e.end&&(e.end=s(e.end,e.elem)),e.clipInit=!0),t(e.elem).cssClip({top:e.pos*(e.end.top-e.start.top)+e.start.top,right:e.pos*(e.end.right-e.start.right)+e.start.right,bottom:e.pos*(e.end.bottom-e.start.bottom)+e.start.bottom,left:e.pos*(e.end.left-e.start.left)+e.start.left})}}(),function(){var e={};t.each(["Quad","Cubic","Quart","Quint","Expo"],function(t,i){e[i]=function(e){return Math.pow(e,t+2)}}),t.extend(e,{Sine:function(t){return 1-Math.cos(t*Math.PI/2)},Circ:function(t){return 1-Math.sqrt(1-t*t)},Elastic:function(t){return 0===t||1===t?t:-Math.pow(2,8*(t-1))*Math.sin((80*(t-1)-7.5)*Math.PI/15)},Back:function(t){return t*t*(3*t-2)},Bounce:function(t){for(var e,i=4;((e=Math.pow(2,--i))-1)/11>t;);return 1/Math.pow(4,3-i)-7.5625*Math.pow((3*e-2)/22-t,2)}}),t.each(e,function(e,i){t.easing["easeIn"+e]=i,t.easing["easeOut"+e]=function(t){return 1-i(1-t)},t.easing["easeInOut"+e]=function(t){return.5>t?i(2*t)/2:1-i(-2*t+2)/2}})}();var f=t.effects;t.effects.define("blind","hide",function(e,i){var s={up:["bottom","top"],vertical:["bottom","top"],down:["top","bottom"],left:["right","left"],horizontal:["right","left"],right:["left","right"]},n=t(this),o=e.direction||"up",a=n.cssClip(),r={clip:t.extend({},a)},h=t.effects.createPlaceholder(n);r.clip[s[o][0]]=r.clip[s[o][1]],"show"===e.mode&&(n.cssClip(r.clip),h&&h.css(t.effects.clipToBox(r)),r.clip=a),h&&h.animate(t.effects.clipToBox(r),e.duration,e.easing),n.animate(r,{queue:!1,duration:e.duration,easing:e.easing,complete:i})}),t.effects.define("bounce",function(e,i){var s,n,o,a=t(this),r=e.mode,h="hide"===r,l="show"===r,c=e.direction||"up",u=e.distance,d=e.times||5,p=2*d+(l||h?1:0),f=e.duration/p,g=e.easing,m="up"===c||"down"===c?"top":"left",_="up"===c||"left"===c,v=0,b=a.queue().length;for(t.effects.createPlaceholder(a),o=a.css(m),u||(u=a["top"===m?"outerHeight":"outerWidth"]()/3),l&&(n={opacity:1},n[m]=o,a.css("opacity",0).css(m,_?2*-u:2*u).animate(n,f,g)),h&&(u/=Math.pow(2,d-1)),n={},n[m]=o;d>v;v++)s={},s[m]=(_?"-=":"+=")+u,a.animate(s,f,g).animate(n,f,g),u=h?2*u:u/2;h&&(s={opacity:0},s[m]=(_?"-=":"+=")+u,a.animate(s,f,g)),a.queue(i),t.effects.unshift(a,b,p+1)}),t.effects.define("clip","hide",function(e,i){var s,n={},o=t(this),a=e.direction||"vertical",r="both"===a,h=r||"horizontal"===a,l=r||"vertical"===a;s=o.cssClip(),n.clip={top:l?(s.bottom-s.top)/2:s.top,right:h?(s.right-s.left)/2:s.right,bottom:l?(s.bottom-s.top)/2:s.bottom,left:h?(s.right-s.left)/2:s.left},t.effects.createPlaceholder(o),"show"===e.mode&&(o.cssClip(n.clip),n.clip=s),o.animate(n,{queue:!1,duration:e.duration,easing:e.easing,complete:i})}),t.effects.define("drop","hide",function(e,i){var s,n=t(this),o=e.mode,a="show"===o,r=e.direction||"left",h="up"===r||"down"===r?"top":"left",l="up"===r||"left"===r?"-=":"+=",c="+="===l?"-=":"+=",u={opacity:0};t.effects.createPlaceholder(n),s=e.distance||n["top"===h?"outerHeight":"outerWidth"](!0)/2,u[h]=l+s,a&&(n.css(u),u[h]=c+s,u.opacity=1),n.animate(u,{queue:!1,duration:e.duration,easing:e.easing,complete:i})}),t.effects.define("explode","hide",function(e,i){function s(){b.push(this),b.length===u*d&&n()}function n(){p.css({visibility:"visible"}),t(b).remove(),i()}var o,a,r,h,l,c,u=e.pieces?Math.round(Math.sqrt(e.pieces)):3,d=u,p=t(this),f=e.mode,g="show"===f,m=p.show().css("visibility","hidden").offset(),_=Math.ceil(p.outerWidth()/d),v=Math.ceil(p.outerHeight()/u),b=[];for(o=0;u>o;o++)for(h=m.top+o*v,c=o-(u-1)/2,a=0;d>a;a++)r=m.left+a*_,l=a-(d-1)/2,p.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-a*_,top:-o*v}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:_,height:v,left:r+(g?l*_:0),top:h+(g?c*v:0),opacity:g?0:1}).animate({left:r+(g?0:l*_),top:h+(g?0:c*v),opacity:g?1:0},e.duration||500,e.easing,s)}),t.effects.define("fade","toggle",function(e,i){var s="show"===e.mode;t(this).css("opacity",s?0:1).animate({opacity:s?1:0},{queue:!1,duration:e.duration,easing:e.easing,complete:i})}),t.effects.define("fold","hide",function(e,i){var s=t(this),n=e.mode,o="show"===n,a="hide"===n,r=e.size||15,h=/([0-9]+)%/.exec(r),l=!!e.horizFirst,c=l?["right","bottom"]:["bottom","right"],u=e.duration/2,d=t.effects.createPlaceholder(s),p=s.cssClip(),f={clip:t.extend({},p)},g={clip:t.extend({},p)},m=[p[c[0]],p[c[1]]],_=s.queue().length;h&&(r=parseInt(h[1],10)/100*m[a?0:1]),f.clip[c[0]]=r,g.clip[c[0]]=r,g.clip[c[1]]=0,o&&(s.cssClip(g.clip),d&&d.css(t.effects.clipToBox(g)),g.clip=p),s.queue(function(i){d&&d.animate(t.effects.clipToBox(f),u,e.easing).animate(t.effects.clipToBox(g),u,e.easing),i()}).animate(f,u,e.easing).animate(g,u,e.easing).queue(i),t.effects.unshift(s,_,4)}),t.effects.define("highlight","show",function(e,i){var s=t(this),n={backgroundColor:s.css("backgroundColor")};"hide"===e.mode&&(n.opacity=0),t.effects.saveStyle(s),s.css({backgroundImage:"none",backgroundColor:e.color||"#ffff99"}).animate(n,{queue:!1,duration:e.duration,easing:e.easing,complete:i})}),t.effects.define("size",function(e,i){var s,n,o,a=t(this),r=["fontSize"],h=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],l=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],c=e.mode,u="effect"!==c,d=e.scale||"both",p=e.origin||["middle","center"],f=a.css("position"),g=a.position(),m=t.effects.scaledDimensions(a),_=e.from||m,v=e.to||t.effects.scaledDimensions(a,0);t.effects.createPlaceholder(a),"show"===c&&(o=_,_=v,v=o),n={from:{y:_.height/m.height,x:_.width/m.width},to:{y:v.height/m.height,x:v.width/m.width}},("box"===d||"both"===d)&&(n.from.y!==n.to.y&&(_=t.effects.setTransition(a,h,n.from.y,_),v=t.effects.setTransition(a,h,n.to.y,v)),n.from.x!==n.to.x&&(_=t.effects.setTransition(a,l,n.from.x,_),v=t.effects.setTransition(a,l,n.to.x,v))),("content"===d||"both"===d)&&n.from.y!==n.to.y&&(_=t.effects.setTransition(a,r,n.from.y,_),v=t.effects.setTransition(a,r,n.to.y,v)),p&&(s=t.effects.getBaseline(p,m),_.top=(m.outerHeight-_.outerHeight)*s.y+g.top,_.left=(m.outerWidth-_.outerWidth)*s.x+g.left,v.top=(m.outerHeight-v.outerHeight)*s.y+g.top,v.left=(m.outerWidth-v.outerWidth)*s.x+g.left),a.css(_),("content"===d||"both"===d)&&(h=h.concat(["marginTop","marginBottom"]).concat(r),l=l.concat(["marginLeft","marginRight"]),a.find("*[width]").each(function(){var i=t(this),s=t.effects.scaledDimensions(i),o={height:s.height*n.from.y,width:s.width*n.from.x,outerHeight:s.outerHeight*n.from.y,outerWidth:s.outerWidth*n.from.x},a={height:s.height*n.to.y,width:s.width*n.to.x,outerHeight:s.height*n.to.y,outerWidth:s.width*n.to.x};n.from.y!==n.to.y&&(o=t.effects.setTransition(i,h,n.from.y,o),a=t.effects.setTransition(i,h,n.to.y,a)),n.from.x!==n.to.x&&(o=t.effects.setTransition(i,l,n.from.x,o),a=t.effects.setTransition(i,l,n.to.x,a)),u&&t.effects.saveStyle(i),i.css(o),i.animate(a,e.duration,e.easing,function(){u&&t.effects.restoreStyle(i)})})),a.animate(v,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){var e=a.offset();0===v.opacity&&a.css("opacity",_.opacity),u||(a.css("position","static"===f?"relative":f).offset(e),t.effects.saveStyle(a)),i()}})}),t.effects.define("scale",function(e,i){var s=t(this),n=e.mode,o=parseInt(e.percent,10)||(0===parseInt(e.percent,10)?0:"effect"!==n?0:100),a=t.extend(!0,{from:t.effects.scaledDimensions(s),to:t.effects.scaledDimensions(s,o,e.direction||"both"),origin:e.origin||["middle","center"]},e);e.fade&&(a.from.opacity=1,a.to.opacity=0),t.effects.effect.size.call(this,a,i)}),t.effects.define("puff","hide",function(e,i){var s=t.extend(!0,{},e,{fade:!0,percent:parseInt(e.percent,10)||150});t.effects.effect.scale.call(this,s,i)}),t.effects.define("pulsate","show",function(e,i){var s=t(this),n=e.mode,o="show"===n,a="hide"===n,r=o||a,h=2*(e.times||5)+(r?1:0),l=e.duration/h,c=0,u=1,d=s.queue().length;for((o||!s.is(":visible"))&&(s.css("opacity",0).show(),c=1);h>u;u++)s.animate({opacity:c},l,e.easing),c=1-c;s.animate({opacity:c},l,e.easing),s.queue(i),t.effects.unshift(s,d,h+1)}),t.effects.define("shake",function(e,i){var s=1,n=t(this),o=e.direction||"left",a=e.distance||20,r=e.times||3,h=2*r+1,l=Math.round(e.duration/h),c="up"===o||"down"===o?"top":"left",u="up"===o||"left"===o,d={},p={},f={},g=n.queue().length;for(t.effects.createPlaceholder(n),d[c]=(u?"-=":"+=")+a,p[c]=(u?"+=":"-=")+2*a,f[c]=(u?"-=":"+=")+2*a,n.animate(d,l,e.easing);r>s;s++)n.animate(p,l,e.easing).animate(f,l,e.easing);n.animate(p,l,e.easing).animate(d,l/2,e.easing).queue(i),t.effects.unshift(n,g,h+1)}),t.effects.define("slide","show",function(e,i){var s,n,o=t(this),a={up:["bottom","top"],down:["top","bottom"],left:["right","left"],right:["left","right"]},r=e.mode,h=e.direction||"left",l="up"===h||"down"===h?"top":"left",c="up"===h||"left"===h,u=e.distance||o["top"===l?"outerHeight":"outerWidth"](!0),d={};t.effects.createPlaceholder(o),s=o.cssClip(),n=o.position()[l],d[l]=(c?-1:1)*u+n,d.clip=o.cssClip(),d.clip[a[h][1]]=d.clip[a[h][0]],"show"===r&&(o.cssClip(d.clip),o.css(l,d[l]),d.clip=s,d[l]=n),o.animate(d,{queue:!1,duration:e.duration,easing:e.easing,complete:i})});var f;t.uiBackCompat!==!1&&(f=t.effects.define("transfer",function(e,i){t(this).transfer(e,i)})),t.ui.focusable=function(i,s){var n,o,a,r,h,l=i.nodeName.toLowerCase();return"area"===l?(n=i.parentNode,o=n.name,i.href&&o&&"map"===n.nodeName.toLowerCase()?(a=t("img[usemap='#"+o+"']"),a.length>0&&a.is(":visible")):!1):(/^(input|select|textarea|button|object)$/.test(l)?(r=!i.disabled,r&&(h=t(i).closest("fieldset")[0],h&&(r=!h.disabled))):r="a"===l?i.href||s:s,r&&t(i).is(":visible")&&e(t(i)))},t.extend(t.expr[":"],{focusable:function(e){return t.ui.focusable(e,null!=t.attr(e,"tabindex"))}}),t.ui.focusable,t.fn.form=function(){return"string"==typeof this[0].form?this.closest("form"):t(this[0].form)},t.ui.formResetMixin={_formResetHandler:function(){var e=t(this);setTimeout(function(){var i=e.data("ui-form-reset-instances");t.each(i,function(){this.refresh()})})},_bindFormResetHandler:function(){if(this.form=this.element.form(),this.form.length){var t=this.form.data("ui-form-reset-instances")||[];t.length||this.form.on("reset.ui-form-reset",this._formResetHandler),t.push(this),this.form.data("ui-form-reset-instances",t)}},_unbindFormResetHandler:function(){if(this.form.length){var e=this.form.data("ui-form-reset-instances");e.splice(t.inArray(this,e),1),e.length?this.form.data("ui-form-reset-instances",e):this.form.removeData("ui-form-reset-instances").off("reset.ui-form-reset")}}},"1.7"===t.fn.jquery.substring(0,3)&&(t.each(["Width","Height"],function(e,i){function s(e,i,s,o){return t.each(n,function(){i-=parseFloat(t.css(e,"padding"+this))||0,s&&(i-=parseFloat(t.css(e,"border"+this+"Width"))||0),o&&(i-=parseFloat(t.css(e,"margin"+this))||0)}),i}var n="Width"===i?["Left","Right"]:["Top","Bottom"],o=i.toLowerCase(),a={innerWidth:t.fn.innerWidth,innerHeight:t.fn.innerHeight,outerWidth:t.fn.outerWidth,outerHeight:t.fn.outerHeight};t.fn["inner"+i]=function(e){return void 0===e?a["inner"+i].call(this):this.each(function(){t(this).css(o,s(this,e)+"px")})},t.fn["outer"+i]=function(e,n){return"number"!=typeof e?a["outer"+i].call(this,e):this.each(function(){t(this).css(o,s(this,e,!0,n)+"px")})}}),t.fn.addBack=function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}),t.ui.keyCode={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38},t.ui.escapeSelector=function(){var t=/([!"#$%&'()*+,.\/:;<=>?@[\]^`{|}~])/g;return function(e){return e.replace(t,"\\$1")}}(),t.fn.labels=function(){var e,i,s,n,o;return this[0].labels&&this[0].labels.length?this.pushStack(this[0].labels):(n=this.eq(0).parents("label"),s=this.attr("id"),s&&(e=this.eq(0).parents().last(),o=e.add(e.length?e.siblings():this.siblings()),i="label[for='"+t.ui.escapeSelector(s)+"']",n=n.add(o.find(i).addBack(i))),this.pushStack(n))},t.fn.scrollParent=function(e){var i=this.css("position"),s="absolute"===i,n=e?/(auto|scroll|hidden)/:/(auto|scroll)/,o=this.parents().filter(function(){var e=t(this);return s&&"static"===e.css("position")?!1:n.test(e.css("overflow")+e.css("overflow-y")+e.css("overflow-x"))}).eq(0);return"fixed"!==i&&o.length?o:t(this[0].ownerDocument||document)},t.extend(t.expr[":"],{tabbable:function(e){var i=t.attr(e,"tabindex"),s=null!=i;return(!s||i>=0)&&t.ui.focusable(e,s)}}),t.fn.extend({uniqueId:function(){var t=0;return function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++t)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&t(this).removeAttr("id")})}}),t.widget("ui.accordion",{version:"1.12.1",options:{active:0,animate:{},classes:{"ui-accordion-header":"ui-corner-top","ui-accordion-header-collapsed":"ui-corner-all","ui-accordion-content":"ui-corner-bottom"},collapsible:!1,event:"click",header:"> li > :first-child, > :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},hideProps:{borderTopWidth:"hide",borderBottomWidth:"hide",paddingTop:"hide",paddingBottom:"hide",height:"hide"},showProps:{borderTopWidth:"show",borderBottomWidth:"show",paddingTop:"show",paddingBottom:"show",height:"show"},_create:function(){var e=this.options;this.prevShow=this.prevHide=t(),this._addClass("ui-accordion","ui-widget ui-helper-reset"),this.element.attr("role","tablist"),e.collapsible||e.active!==!1&&null!=e.active||(e.active=0),this._processPanels(),0>e.active&&(e.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():t()}},_createIcons:function(){var e,i,s=this.options.icons;s&&(e=t("<span>"),this._addClass(e,"ui-accordion-header-icon","ui-icon "+s.header),e.prependTo(this.headers),i=this.active.children(".ui-accordion-header-icon"),this._removeClass(i,s.header)._addClass(i,null,s.activeHeader)._addClass(this.headers,"ui-accordion-icons"))},_destroyIcons:function(){this._removeClass(this.headers,"ui-accordion-icons"),this.headers.children(".ui-accordion-header-icon").remove()},_destroy:function(){var t;this.element.removeAttr("role"),this.headers.removeAttr("role aria-expanded aria-selected aria-controls tabIndex").removeUniqueId(),this._destroyIcons(),t=this.headers.next().css("display","").removeAttr("role aria-hidden aria-labelledby").removeUniqueId(),"content"!==this.options.heightStyle&&t.css("height","")},_setOption:function(t,e){return"active"===t?(this._activate(e),void 0):("event"===t&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(e)),this._super(t,e),"collapsible"!==t||e||this.options.active!==!1||this._activate(0),"icons"===t&&(this._destroyIcons(),e&&this._createIcons()),void 0)},_setOptionDisabled:function(t){this._super(t),this.element.attr("aria-disabled",t),this._toggleClass(null,"ui-state-disabled",!!t),this._toggleClass(this.headers.add(this.headers.next()),null,"ui-state-disabled",!!t)},_keydown:function(e){if(!e.altKey&&!e.ctrlKey){var i=t.ui.keyCode,s=this.headers.length,n=this.headers.index(e.target),o=!1;switch(e.keyCode){case i.RIGHT:case i.DOWN:o=this.headers[(n+1)%s];break;case i.LEFT:case i.UP:o=this.headers[(n-1+s)%s];break;case i.SPACE:case i.ENTER:this._eventHandler(e);break;case i.HOME:o=this.headers[0];break;case i.END:o=this.headers[s-1]}o&&(t(e.target).attr("tabIndex",-1),t(o).attr("tabIndex",0),t(o).trigger("focus"),e.preventDefault())}},_panelKeyDown:function(e){e.keyCode===t.ui.keyCode.UP&&e.ctrlKey&&t(e.currentTarget).prev().trigger("focus")},refresh:function(){var e=this.options;this._processPanels(),e.active===!1&&e.collapsible===!0||!this.headers.length?(e.active=!1,this.active=t()):e.active===!1?this._activate(0):this.active.length&&!t.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(e.active=!1,this.active=t()):this._activate(Math.max(0,e.active-1)):e.active=this.headers.index(this.active),this._destroyIcons(),this._refresh()},_processPanels:function(){var t=this.headers,e=this.panels;this.headers=this.element.find(this.options.header),this._addClass(this.headers,"ui-accordion-header ui-accordion-header-collapsed","ui-state-default"),this.panels=this.headers.next().filter(":not(.ui-accordion-content-active)").hide(),this._addClass(this.panels,"ui-accordion-content","ui-helper-reset ui-widget-content"),e&&(this._off(t.not(this.headers)),this._off(e.not(this.panels)))},_refresh:function(){var e,i=this.options,s=i.heightStyle,n=this.element.parent();this.active=this._findActive(i.active),this._addClass(this.active,"ui-accordion-header-active","ui-state-active")._removeClass(this.active,"ui-accordion-header-collapsed"),this._addClass(this.active.next(),"ui-accordion-content-active"),this.active.next().show(),this.headers.attr("role","tab").each(function(){var e=t(this),i=e.uniqueId().attr("id"),s=e.next(),n=s.uniqueId().attr("id");e.attr("aria-controls",n),s.attr("aria-labelledby",i)}).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}).next().attr({"aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}).next().attr({"aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._createIcons(),this._setupEvents(i.event),"fill"===s?(e=n.height(),this.element.siblings(":visible").each(function(){var i=t(this),s=i.css("position");"absolute"!==s&&"fixed"!==s&&(e-=i.outerHeight(!0))}),this.headers.each(function(){e-=t(this).outerHeight(!0)}),this.headers.next().each(function(){t(this).height(Math.max(0,e-t(this).innerHeight()+t(this).height()))}).css("overflow","auto")):"auto"===s&&(e=0,this.headers.next().each(function(){var i=t(this).is(":visible");i||t(this).show(),e=Math.max(e,t(this).css("height","").height()),i||t(this).hide()}).height(e))},_activate:function(e){var i=this._findActive(e)[0];i!==this.active[0]&&(i=i||this.active[0],this._eventHandler({target:i,currentTarget:i,preventDefault:t.noop}))},_findActive:function(e){return"number"==typeof e?this.headers.eq(e):t()},_setupEvents:function(e){var i={keydown:"_keydown"};e&&t.each(e.split(" "),function(t,e){i[e]="_eventHandler"}),this._off(this.headers.add(this.headers.next())),this._on(this.headers,i),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(e){var i,s,n=this.options,o=this.active,a=t(e.currentTarget),r=a[0]===o[0],h=r&&n.collapsible,l=h?t():a.next(),c=o.next(),u={oldHeader:o,oldPanel:c,newHeader:h?t():a,newPanel:l};e.preventDefault(),r&&!n.collapsible||this._trigger("beforeActivate",e,u)===!1||(n.active=h?!1:this.headers.index(a),this.active=r?t():a,this._toggle(u),this._removeClass(o,"ui-accordion-header-active","ui-state-active"),n.icons&&(i=o.children(".ui-accordion-header-icon"),this._removeClass(i,null,n.icons.activeHeader)._addClass(i,null,n.icons.header)),r||(this._removeClass(a,"ui-accordion-header-collapsed")._addClass(a,"ui-accordion-header-active","ui-state-active"),n.icons&&(s=a.children(".ui-accordion-header-icon"),this._removeClass(s,null,n.icons.header)._addClass(s,null,n.icons.activeHeader)),this._addClass(a.next(),"ui-accordion-content-active")))},_toggle:function(e){var i=e.newPanel,s=this.prevShow.length?this.prevShow:e.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=i,this.prevHide=s,this.options.animate?this._animate(i,s,e):(s.hide(),i.show(),this._toggleComplete(e)),s.attr({"aria-hidden":"true"}),s.prev().attr({"aria-selected":"false","aria-expanded":"false"}),i.length&&s.length?s.prev().attr({tabIndex:-1,"aria-expanded":"false"}):i.length&&this.headers.filter(function(){return 0===parseInt(t(this).attr("tabIndex"),10)}).attr("tabIndex",-1),i.attr("aria-hidden","false").prev().attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_animate:function(t,e,i){var s,n,o,a=this,r=0,h=t.css("box-sizing"),l=t.length&&(!e.length||t.index()<e.index()),c=this.options.animate||{},u=l&&c.down||c,d=function(){a._toggleComplete(i)};return"number"==typeof u&&(o=u),"string"==typeof u&&(n=u),n=n||u.easing||c.easing,o=o||u.duration||c.duration,e.length?t.length?(s=t.show().outerHeight(),e.animate(this.hideProps,{duration:o,easing:n,step:function(t,e){e.now=Math.round(t)}}),t.hide().animate(this.showProps,{duration:o,easing:n,complete:d,step:function(t,i){i.now=Math.round(t),"height"!==i.prop?"content-box"===h&&(r+=i.now):"content"!==a.options.heightStyle&&(i.now=Math.round(s-e.outerHeight()-r),r=0)}}),void 0):e.animate(this.hideProps,o,n,d):t.animate(this.showProps,o,n,d)},_toggleComplete:function(t){var e=t.oldPanel,i=e.prev();this._removeClass(e,"ui-accordion-content-active"),this._removeClass(i,"ui-accordion-header-active")._addClass(i,"ui-accordion-header-collapsed"),e.length&&(e.parent()[0].className=e.parent()[0].className),this._trigger("activate",null,t)}}),t.ui.safeActiveElement=function(t){var e;try{e=t.activeElement}catch(i){e=t.body}return e||(e=t.body),e.nodeName||(e=t.body),e},t.widget("ui.menu",{version:"1.12.1",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-caret-1-e"},items:"> *",menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().attr({role:this.options.role,tabIndex:0}),this._addClass("ui-menu","ui-widget ui-widget-content"),this._on({"mousedown .ui-menu-item":function(t){t.preventDefault()},"click .ui-menu-item":function(e){var i=t(e.target),s=t(t.ui.safeActiveElement(this.document[0]));!this.mouseHandled&&i.not(".ui-state-disabled").length&&(this.select(e),e.isPropagationStopped()||(this.mouseHandled=!0),i.has(".ui-menu").length?this.expand(e):!this.element.is(":focus")&&s.closest(".ui-menu").length&&(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(e){if(!this.previousFilter){var i=t(e.target).closest(".ui-menu-item"),s=t(e.currentTarget);i[0]===s[0]&&(this._removeClass(s.siblings().children(".ui-state-active"),null,"ui-state-active"),this.focus(e,s))}},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(t,e){var i=this.active||this.element.find(this.options.items).eq(0);e||this.focus(t,i)},blur:function(e){this._delay(function(){var i=!t.contains(this.element[0],t.ui.safeActiveElement(this.document[0]));i&&this.collapseAll(e)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(t){this._closeOnDocumentClick(t)&&this.collapseAll(t),this.mouseHandled=!1}})},_destroy:function(){var e=this.element.find(".ui-menu-item").removeAttr("role aria-disabled"),i=e.children(".ui-menu-item-wrapper").removeUniqueId().removeAttr("tabIndex role aria-haspopup");this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeAttr("role aria-labelledby aria-expanded aria-hidden aria-disabled tabIndex").removeUniqueId().show(),i.children().each(function(){var e=t(this);e.data("ui-menu-submenu-caret")&&e.remove()})},_keydown:function(e){var i,s,n,o,a=!0;switch(e.keyCode){case t.ui.keyCode.PAGE_UP:this.previousPage(e);break;case t.ui.keyCode.PAGE_DOWN:this.nextPage(e);break;case t.ui.keyCode.HOME:this._move("first","first",e);break;case t.ui.keyCode.END:this._move("last","last",e);break;case t.ui.keyCode.UP:this.previous(e);break;case t.ui.keyCode.DOWN:this.next(e);break;case t.ui.keyCode.LEFT:this.collapse(e);break;case t.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(e);break;case t.ui.keyCode.ENTER:case t.ui.keyCode.SPACE:this._activate(e);break;case t.ui.keyCode.ESCAPE:this.collapse(e);break;default:a=!1,s=this.previousFilter||"",o=!1,n=e.keyCode>=96&&105>=e.keyCode?""+(e.keyCode-96):String.fromCharCode(e.keyCode),clearTimeout(this.filterTimer),n===s?o=!0:n=s+n,i=this._filterMenuItems(n),i=o&&-1!==i.index(this.active.next())?this.active.nextAll(".ui-menu-item"):i,i.length||(n=String.fromCharCode(e.keyCode),i=this._filterMenuItems(n)),i.length?(this.focus(e,i),this.previousFilter=n,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter}a&&e.preventDefault()},_activate:function(t){this.active&&!this.active.is(".ui-state-disabled")&&(this.active.children("[aria-haspopup='true']").length?this.expand(t):this.select(t))},refresh:function(){var e,i,s,n,o,a=this,r=this.options.icons.submenu,h=this.element.find(this.options.menus);this._toggleClass("ui-menu-icons",null,!!this.element.find(".ui-icon").length),s=h.filter(":not(.ui-menu)").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var e=t(this),i=e.prev(),s=t("<span>").data("ui-menu-submenu-caret",!0);a._addClass(s,"ui-menu-icon","ui-icon "+r),i.attr("aria-haspopup","true").prepend(s),e.attr("aria-labelledby",i.attr("id"))}),this._addClass(s,"ui-menu","ui-widget ui-widget-content ui-front"),e=h.add(this.element),i=e.find(this.options.items),i.not(".ui-menu-item").each(function(){var e=t(this);a._isDivider(e)&&a._addClass(e,"ui-menu-divider","ui-widget-content")}),n=i.not(".ui-menu-item, .ui-menu-divider"),o=n.children().not(".ui-menu").uniqueId().attr({tabIndex:-1,role:this._itemRole()}),this._addClass(n,"ui-menu-item")._addClass(o,"ui-menu-item-wrapper"),i.filter(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!t.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(t,e){if("icons"===t){var i=this.element.find(".ui-menu-icon");this._removeClass(i,null,this.options.icons.submenu)._addClass(i,null,e.submenu)}this._super(t,e)},_setOptionDisabled:function(t){this._super(t),this.element.attr("aria-disabled",t+""),this._toggleClass(null,"ui-state-disabled",!!t)},focus:function(t,e){var i,s,n;this.blur(t,t&&"focus"===t.type),this._scrollIntoView(e),this.active=e.first(),s=this.active.children(".ui-menu-item-wrapper"),this._addClass(s,null,"ui-state-active"),this.options.role&&this.element.attr("aria-activedescendant",s.attr("id")),n=this.active.parent().closest(".ui-menu-item").children(".ui-menu-item-wrapper"),this._addClass(n,null,"ui-state-active"),t&&"keydown"===t.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),i=e.children(".ui-menu"),i.length&&t&&/^mouse/.test(t.type)&&this._startOpening(i),this.activeMenu=e.parent(),this._trigger("focus",t,{item:e})},_scrollIntoView:function(e){var i,s,n,o,a,r;this._hasScroll()&&(i=parseFloat(t.css(this.activeMenu[0],"borderTopWidth"))||0,s=parseFloat(t.css(this.activeMenu[0],"paddingTop"))||0,n=e.offset().top-this.activeMenu.offset().top-i-s,o=this.activeMenu.scrollTop(),a=this.activeMenu.height(),r=e.outerHeight(),0>n?this.activeMenu.scrollTop(o+n):n+r>a&&this.activeMenu.scrollTop(o+n-a+r))},blur:function(t,e){e||clearTimeout(this.timer),this.active&&(this._removeClass(this.active.children(".ui-menu-item-wrapper"),null,"ui-state-active"),this._trigger("blur",t,{item:this.active}),this.active=null)},_startOpening:function(t){clearTimeout(this.timer),"true"===t.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(t)},this.delay))},_open:function(e){var i=t.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(e.parents(".ui-menu")).hide().attr("aria-hidden","true"),e.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(i)},collapseAll:function(e,i){clearTimeout(this.timer),this.timer=this._delay(function(){var s=i?this.element:t(e&&e.target).closest(this.element.find(".ui-menu"));s.length||(s=this.element),this._close(s),this.blur(e),this._removeClass(s.find(".ui-state-active"),null,"ui-state-active"),this.activeMenu=s},this.delay)},_close:function(t){t||(t=this.active?this.active.parent():this.element),t.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false")},_closeOnDocumentClick:function(e){return!t(e.target).closest(".ui-menu").length},_isDivider:function(t){return!/[^\-\u2014\u2013\s]/.test(t.text())},collapse:function(t){var e=this.active&&this.active.parent().closest(".ui-menu-item",this.element);e&&e.length&&(this._close(),this.focus(t,e))},expand:function(t){var e=this.active&&this.active.children(".ui-menu ").find(this.options.items).first();e&&e.length&&(this._open(e.parent()),this._delay(function(){this.focus(t,e)}))},next:function(t){this._move("next","first",t)},previous:function(t){this._move("prev","last",t)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(t,e,i){var s;this.active&&(s="first"===t||"last"===t?this.active["first"===t?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[t+"All"](".ui-menu-item").eq(0)),s&&s.length&&this.active||(s=this.activeMenu.find(this.options.items)[e]()),this.focus(i,s)},nextPage:function(e){var i,s,n;return this.active?(this.isLastItem()||(this._hasScroll()?(s=this.active.offset().top,n=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return i=t(this),0>i.offset().top-s-n}),this.focus(e,i)):this.focus(e,this.activeMenu.find(this.options.items)[this.active?"last":"first"]())),void 0):(this.next(e),void 0)},previousPage:function(e){var i,s,n;return this.active?(this.isFirstItem()||(this._hasScroll()?(s=this.active.offset().top,n=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return i=t(this),i.offset().top-s+n>0}),this.focus(e,i)):this.focus(e,this.activeMenu.find(this.options.items).first())),void 0):(this.next(e),void 0)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(e){this.active=this.active||t(e.target).closest(".ui-menu-item");var i={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(e,!0),this._trigger("select",e,i)},_filterMenuItems:function(e){var i=e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),s=RegExp("^"+i,"i");return this.activeMenu.find(this.options.items).filter(".ui-menu-item").filter(function(){return s.test(t.trim(t(this).children(".ui-menu-item-wrapper").text()))})}}),t.widget("ui.autocomplete",{version:"1.12.1",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,_create:function(){var e,i,s,n=this.element[0].nodeName.toLowerCase(),o="textarea"===n,a="input"===n;
		this.isMultiLine=o||!a&&this._isContentEditable(this.element),this.valueMethod=this.element[o||a?"val":"text"],this.isNewMenu=!0,this._addClass("ui-autocomplete-input"),this.element.attr("autocomplete","off"),this._on(this.element,{keydown:function(n){if(this.element.prop("readOnly"))return e=!0,s=!0,i=!0,void 0;e=!1,s=!1,i=!1;var o=t.ui.keyCode;switch(n.keyCode){case o.PAGE_UP:e=!0,this._move("previousPage",n);break;case o.PAGE_DOWN:e=!0,this._move("nextPage",n);break;case o.UP:e=!0,this._keyEvent("previous",n);break;case o.DOWN:e=!0,this._keyEvent("next",n);break;case o.ENTER:this.menu.active&&(e=!0,n.preventDefault(),this.menu.select(n));break;case o.TAB:this.menu.active&&this.menu.select(n);break;case o.ESCAPE:this.menu.element.is(":visible")&&(this.isMultiLine||this._value(this.term),this.close(n),n.preventDefault());break;default:i=!0,this._searchTimeout(n)}},keypress:function(s){if(e)return e=!1,(!this.isMultiLine||this.menu.element.is(":visible"))&&s.preventDefault(),void 0;if(!i){var n=t.ui.keyCode;switch(s.keyCode){case n.PAGE_UP:this._move("previousPage",s);break;case n.PAGE_DOWN:this._move("nextPage",s);break;case n.UP:this._keyEvent("previous",s);break;case n.DOWN:this._keyEvent("next",s)}}},input:function(t){return s?(s=!1,t.preventDefault(),void 0):(this._searchTimeout(t),void 0)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(t){return this.cancelBlur?(delete this.cancelBlur,void 0):(clearTimeout(this.searching),this.close(t),this._change(t),void 0)}}),this._initSource(),this.menu=t("<ul>").appendTo(this._appendTo()).menu({role:null}).hide().menu("instance"),this._addClass(this.menu.element,"ui-autocomplete","ui-front"),this._on(this.menu.element,{mousedown:function(e){e.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,this.element[0]!==t.ui.safeActiveElement(this.document[0])&&this.element.trigger("focus")})},menufocus:function(e,i){var s,n;return this.isNewMenu&&(this.isNewMenu=!1,e.originalEvent&&/^mouse/.test(e.originalEvent.type))?(this.menu.blur(),this.document.one("mousemove",function(){t(e.target).trigger(e.originalEvent)}),void 0):(n=i.item.data("ui-autocomplete-item"),!1!==this._trigger("focus",e,{item:n})&&e.originalEvent&&/^key/.test(e.originalEvent.type)&&this._value(n.value),s=i.item.attr("aria-label")||n.value,s&&t.trim(s).length&&(this.liveRegion.children().hide(),t("<div>").text(s).appendTo(this.liveRegion)),void 0)},menuselect:function(e,i){var s=i.item.data("ui-autocomplete-item"),n=this.previous;this.element[0]!==t.ui.safeActiveElement(this.document[0])&&(this.element.trigger("focus"),this.previous=n,this._delay(function(){this.previous=n,this.selectedItem=s})),!1!==this._trigger("select",e,{item:s})&&this._value(s.value),this.term=this._value(),this.close(e),this.selectedItem=s}}),this.liveRegion=t("<div>",{role:"status","aria-live":"assertive","aria-relevant":"additions"}).appendTo(this.document[0].body),this._addClass(this.liveRegion,null,"ui-helper-hidden-accessible"),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(t,e){this._super(t,e),"source"===t&&this._initSource(),"appendTo"===t&&this.menu.element.appendTo(this._appendTo()),"disabled"===t&&e&&this.xhr&&this.xhr.abort()},_isEventTargetInWidget:function(e){var i=this.menu.element[0];return e.target===this.element[0]||e.target===i||t.contains(i,e.target)},_closeOnClickOutside:function(t){this._isEventTargetInWidget(t)||this.close()},_appendTo:function(){var e=this.options.appendTo;return e&&(e=e.jquery||e.nodeType?t(e):this.document.find(e).eq(0)),e&&e[0]||(e=this.element.closest(".ui-front, dialog")),e.length||(e=this.document[0].body),e},_initSource:function(){var e,i,s=this;t.isArray(this.options.source)?(e=this.options.source,this.source=function(i,s){s(t.ui.autocomplete.filter(e,i.term))}):"string"==typeof this.options.source?(i=this.options.source,this.source=function(e,n){s.xhr&&s.xhr.abort(),s.xhr=t.ajax({url:i,data:e,dataType:"json",success:function(t){n(t)},error:function(){n([])}})}):this.source=this.options.source},_searchTimeout:function(t){clearTimeout(this.searching),this.searching=this._delay(function(){var e=this.term===this._value(),i=this.menu.element.is(":visible"),s=t.altKey||t.ctrlKey||t.metaKey||t.shiftKey;(!e||e&&!i&&!s)&&(this.selectedItem=null,this.search(null,t))},this.options.delay)},search:function(t,e){return t=null!=t?t:this._value(),this.term=this._value(),t.length<this.options.minLength?this.close(e):this._trigger("search",e)!==!1?this._search(t):void 0},_search:function(t){this.pending++,this._addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:t},this._response())},_response:function(){var e=++this.requestIndex;return t.proxy(function(t){e===this.requestIndex&&this.__response(t),this.pending--,this.pending||this._removeClass("ui-autocomplete-loading")},this)},__response:function(t){t&&(t=this._normalize(t)),this._trigger("response",null,{content:t}),!this.options.disabled&&t&&t.length&&!this.cancelSearch?(this._suggest(t),this._trigger("open")):this._close()},close:function(t){this.cancelSearch=!0,this._close(t)},_close:function(t){this._off(this.document,"mousedown"),this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",t))},_change:function(t){this.previous!==this._value()&&this._trigger("change",t,{item:this.selectedItem})},_normalize:function(e){return e.length&&e[0].label&&e[0].value?e:t.map(e,function(e){return"string"==typeof e?{label:e,value:e}:t.extend({},e,{label:e.label||e.value,value:e.value||e.label})})},_suggest:function(e){var i=this.menu.element.empty();this._renderMenu(i,e),this.isNewMenu=!0,this.menu.refresh(),i.show(),this._resizeMenu(),i.position(t.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next(),this._on(this.document,{mousedown:"_closeOnClickOutside"})},_resizeMenu:function(){var t=this.menu.element;t.outerWidth(Math.max(t.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(e,i){var s=this;t.each(i,function(t,i){s._renderItemData(e,i)})},_renderItemData:function(t,e){return this._renderItem(t,e).data("ui-autocomplete-item",e)},_renderItem:function(e,i){return t("<li>").append(t("<div>").text(i.label)).appendTo(e)},_move:function(t,e){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(t)||this.menu.isLastItem()&&/^next/.test(t)?(this.isMultiLine||this._value(this.term),this.menu.blur(),void 0):(this.menu[t](e),void 0):(this.search(null,e),void 0)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(t,e){(!this.isMultiLine||this.menu.element.is(":visible"))&&(this._move(t,e),e.preventDefault())},_isContentEditable:function(t){if(!t.length)return!1;var e=t.prop("contentEditable");return"inherit"===e?this._isContentEditable(t.parent()):"true"===e}}),t.extend(t.ui.autocomplete,{escapeRegex:function(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(e,i){var s=RegExp(t.ui.autocomplete.escapeRegex(i),"i");return t.grep(e,function(t){return s.test(t.label||t.value||t)})}}),t.widget("ui.autocomplete",t.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(t){return t+(t>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(e){var i;this._superApply(arguments),this.options.disabled||this.cancelSearch||(i=e&&e.length?this.options.messages.results(e.length):this.options.messages.noResults,this.liveRegion.children().hide(),t("<div>").text(i).appendTo(this.liveRegion))}}),t.ui.autocomplete;var g=/ui-corner-([a-z]){2,6}/g;t.widget("ui.controlgroup",{version:"1.12.1",defaultElement:"<div>",options:{direction:"horizontal",disabled:null,onlyVisible:!0,items:{button:"input[type=button], input[type=submit], input[type=reset], button, a",controlgroupLabel:".ui-controlgroup-label",checkboxradio:"input[type='checkbox'], input[type='radio']",selectmenu:"select",spinner:".ui-spinner-input"}},_create:function(){this._enhance()},_enhance:function(){this.element.attr("role","toolbar"),this.refresh()},_destroy:function(){this._callChildMethod("destroy"),this.childWidgets.removeData("ui-controlgroup-data"),this.element.removeAttr("role"),this.options.items.controlgroupLabel&&this.element.find(this.options.items.controlgroupLabel).find(".ui-controlgroup-label-contents").contents().unwrap()},_initWidgets:function(){var e=this,i=[];t.each(this.options.items,function(s,n){var o,a={};return n?"controlgroupLabel"===s?(o=e.element.find(n),o.each(function(){var e=t(this);e.children(".ui-controlgroup-label-contents").length||e.contents().wrapAll("<span class='ui-controlgroup-label-contents'></span>")}),e._addClass(o,null,"ui-widget ui-widget-content ui-state-default"),i=i.concat(o.get()),void 0):(t.fn[s]&&(a=e["_"+s+"Options"]?e["_"+s+"Options"]("middle"):{classes:{}},e.element.find(n).each(function(){var n=t(this),o=n[s]("instance"),r=t.widget.extend({},a);if("button"!==s||!n.parent(".ui-spinner").length){o||(o=n[s]()[s]("instance")),o&&(r.classes=e._resolveClassesValues(r.classes,o)),n[s](r);var h=n[s]("widget");t.data(h[0],"ui-controlgroup-data",o?o:n[s]("instance")),i.push(h[0])}})),void 0):void 0}),this.childWidgets=t(t.unique(i)),this._addClass(this.childWidgets,"ui-controlgroup-item")},_callChildMethod:function(e){this.childWidgets.each(function(){var i=t(this),s=i.data("ui-controlgroup-data");s&&s[e]&&s[e]()})},_updateCornerClass:function(t,e){var i="ui-corner-top ui-corner-bottom ui-corner-left ui-corner-right ui-corner-all",s=this._buildSimpleOptions(e,"label").classes.label;this._removeClass(t,null,i),this._addClass(t,null,s)},_buildSimpleOptions:function(t,e){var i="vertical"===this.options.direction,s={classes:{}};return s.classes[e]={middle:"",first:"ui-corner-"+(i?"top":"left"),last:"ui-corner-"+(i?"bottom":"right"),only:"ui-corner-all"}[t],s},_spinnerOptions:function(t){var e=this._buildSimpleOptions(t,"ui-spinner");return e.classes["ui-spinner-up"]="",e.classes["ui-spinner-down"]="",e},_buttonOptions:function(t){return this._buildSimpleOptions(t,"ui-button")},_checkboxradioOptions:function(t){return this._buildSimpleOptions(t,"ui-checkboxradio-label")},_selectmenuOptions:function(t){var e="vertical"===this.options.direction;return{width:e?"auto":!1,classes:{middle:{"ui-selectmenu-button-open":"","ui-selectmenu-button-closed":""},first:{"ui-selectmenu-button-open":"ui-corner-"+(e?"top":"tl"),"ui-selectmenu-button-closed":"ui-corner-"+(e?"top":"left")},last:{"ui-selectmenu-button-open":e?"":"ui-corner-tr","ui-selectmenu-button-closed":"ui-corner-"+(e?"bottom":"right")},only:{"ui-selectmenu-button-open":"ui-corner-top","ui-selectmenu-button-closed":"ui-corner-all"}}[t]}},_resolveClassesValues:function(e,i){var s={};return t.each(e,function(n){var o=i.options.classes[n]||"";o=t.trim(o.replace(g,"")),s[n]=(o+" "+e[n]).replace(/\s+/g," ")}),s},_setOption:function(t,e){return"direction"===t&&this._removeClass("ui-controlgroup-"+this.options.direction),this._super(t,e),"disabled"===t?(this._callChildMethod(e?"disable":"enable"),void 0):(this.refresh(),void 0)},refresh:function(){var e,i=this;this._addClass("ui-controlgroup ui-controlgroup-"+this.options.direction),"horizontal"===this.options.direction&&this._addClass(null,"ui-helper-clearfix"),this._initWidgets(),e=this.childWidgets,this.options.onlyVisible&&(e=e.filter(":visible")),e.length&&(t.each(["first","last"],function(t,s){var n=e[s]().data("ui-controlgroup-data");if(n&&i["_"+n.widgetName+"Options"]){var o=i["_"+n.widgetName+"Options"](1===e.length?"only":s);o.classes=i._resolveClassesValues(o.classes,n),n.element[n.widgetName](o)}else i._updateCornerClass(e[s](),s)}),this._callChildMethod("refresh"))}}),t.widget("ui.checkboxradio",[t.ui.formResetMixin,{version:"1.12.1",options:{disabled:null,label:null,icon:!0,classes:{"ui-checkboxradio-label":"ui-corner-all","ui-checkboxradio-icon":"ui-corner-all"}},_getCreateOptions:function(){var e,i,s=this,n=this._super()||{};return this._readType(),i=this.element.labels(),this.label=t(i[i.length-1]),this.label.length||t.error("No label found for checkboxradio widget"),this.originalLabel="",this.label.contents().not(this.element[0]).each(function(){s.originalLabel+=3===this.nodeType?t(this).text():this.outerHTML}),this.originalLabel&&(n.label=this.originalLabel),e=this.element[0].disabled,null!=e&&(n.disabled=e),n},_create:function(){var t=this.element[0].checked;this._bindFormResetHandler(),null==this.options.disabled&&(this.options.disabled=this.element[0].disabled),this._setOption("disabled",this.options.disabled),this._addClass("ui-checkboxradio","ui-helper-hidden-accessible"),this._addClass(this.label,"ui-checkboxradio-label","ui-button ui-widget"),"radio"===this.type&&this._addClass(this.label,"ui-checkboxradio-radio-label"),this.options.label&&this.options.label!==this.originalLabel?this._updateLabel():this.originalLabel&&(this.options.label=this.originalLabel),this._enhance(),t&&(this._addClass(this.label,"ui-checkboxradio-checked","ui-state-active"),this.icon&&this._addClass(this.icon,null,"ui-state-hover")),this._on({change:"_toggleClasses",focus:function(){this._addClass(this.label,null,"ui-state-focus ui-visual-focus")},blur:function(){this._removeClass(this.label,null,"ui-state-focus ui-visual-focus")}})},_readType:function(){var e=this.element[0].nodeName.toLowerCase();this.type=this.element[0].type,"input"===e&&/radio|checkbox/.test(this.type)||t.error("Can't create checkboxradio on element.nodeName="+e+" and element.type="+this.type)},_enhance:function(){this._updateIcon(this.element[0].checked)},widget:function(){return this.label},_getRadioGroup:function(){var e,i=this.element[0].name,s="input[name='"+t.ui.escapeSelector(i)+"']";return i?(e=this.form.length?t(this.form[0].elements).filter(s):t(s).filter(function(){return 0===t(this).form().length}),e.not(this.element)):t([])},_toggleClasses:function(){var e=this.element[0].checked;this._toggleClass(this.label,"ui-checkboxradio-checked","ui-state-active",e),this.options.icon&&"checkbox"===this.type&&this._toggleClass(this.icon,null,"ui-icon-check ui-state-checked",e)._toggleClass(this.icon,null,"ui-icon-blank",!e),"radio"===this.type&&this._getRadioGroup().each(function(){var e=t(this).checkboxradio("instance");e&&e._removeClass(e.label,"ui-checkboxradio-checked","ui-state-active")})},_destroy:function(){this._unbindFormResetHandler(),this.icon&&(this.icon.remove(),this.iconSpace.remove())},_setOption:function(t,e){return"label"!==t||e?(this._super(t,e),"disabled"===t?(this._toggleClass(this.label,null,"ui-state-disabled",e),this.element[0].disabled=e,void 0):(this.refresh(),void 0)):void 0},_updateIcon:function(e){var i="ui-icon ui-icon-background ";this.options.icon?(this.icon||(this.icon=t("<span>"),this.iconSpace=t("<span> </span>"),this._addClass(this.iconSpace,"ui-checkboxradio-icon-space")),"checkbox"===this.type?(i+=e?"ui-icon-check ui-state-checked":"ui-icon-blank",this._removeClass(this.icon,null,e?"ui-icon-blank":"ui-icon-check")):i+="ui-icon-blank",this._addClass(this.icon,"ui-checkboxradio-icon",i),e||this._removeClass(this.icon,null,"ui-icon-check ui-state-checked"),this.icon.prependTo(this.label).after(this.iconSpace)):void 0!==this.icon&&(this.icon.remove(),this.iconSpace.remove(),delete this.icon)},_updateLabel:function(){var t=this.label.contents().not(this.element[0]);this.icon&&(t=t.not(this.icon[0])),this.iconSpace&&(t=t.not(this.iconSpace[0])),t.remove(),this.label.append(this.options.label)},refresh:function(){var t=this.element[0].checked,e=this.element[0].disabled;this._updateIcon(t),this._toggleClass(this.label,"ui-checkboxradio-checked","ui-state-active",t),null!==this.options.label&&this._updateLabel(),e!==this.options.disabled&&this._setOptions({disabled:e})}}]),t.ui.checkboxradio,t.widget("ui.button",{version:"1.12.1",defaultElement:"<button>",options:{classes:{"ui-button":"ui-corner-all"},disabled:null,icon:null,iconPosition:"beginning",label:null,showLabel:!0},_getCreateOptions:function(){var t,e=this._super()||{};return this.isInput=this.element.is("input"),t=this.element[0].disabled,null!=t&&(e.disabled=t),this.originalLabel=this.isInput?this.element.val():this.element.html(),this.originalLabel&&(e.label=this.originalLabel),e},_create:function(){!this.option.showLabel&!this.options.icon&&(this.options.showLabel=!0),null==this.options.disabled&&(this.options.disabled=this.element[0].disabled||!1),this.hasTitle=!!this.element.attr("title"),this.options.label&&this.options.label!==this.originalLabel&&(this.isInput?this.element.val(this.options.label):this.element.html(this.options.label)),this._addClass("ui-button","ui-widget"),this._setOption("disabled",this.options.disabled),this._enhance(),this.element.is("a")&&this._on({keyup:function(e){e.keyCode===t.ui.keyCode.SPACE&&(e.preventDefault(),this.element[0].click?this.element[0].click():this.element.trigger("click"))}})},_enhance:function(){this.element.is("button")||this.element.attr("role","button"),this.options.icon&&(this._updateIcon("icon",this.options.icon),this._updateTooltip())},_updateTooltip:function(){this.title=this.element.attr("title"),this.options.showLabel||this.title||this.element.attr("title",this.options.label)},_updateIcon:function(e,i){var s="iconPosition"!==e,n=s?this.options.iconPosition:i,o="top"===n||"bottom"===n;this.icon?s&&this._removeClass(this.icon,null,this.options.icon):(this.icon=t("<span>"),this._addClass(this.icon,"ui-button-icon","ui-icon"),this.options.showLabel||this._addClass("ui-button-icon-only")),s&&this._addClass(this.icon,null,i),this._attachIcon(n),o?(this._addClass(this.icon,null,"ui-widget-icon-block"),this.iconSpace&&this.iconSpace.remove()):(this.iconSpace||(this.iconSpace=t("<span> </span>"),this._addClass(this.iconSpace,"ui-button-icon-space")),this._removeClass(this.icon,null,"ui-wiget-icon-block"),this._attachIconSpace(n))},_destroy:function(){this.element.removeAttr("role"),this.icon&&this.icon.remove(),this.iconSpace&&this.iconSpace.remove(),this.hasTitle||this.element.removeAttr("title")},_attachIconSpace:function(t){this.icon[/^(?:end|bottom)/.test(t)?"before":"after"](this.iconSpace)},_attachIcon:function(t){this.element[/^(?:end|bottom)/.test(t)?"append":"prepend"](this.icon)},_setOptions:function(t){var e=void 0===t.showLabel?this.options.showLabel:t.showLabel,i=void 0===t.icon?this.options.icon:t.icon;e||i||(t.showLabel=!0),this._super(t)},_setOption:function(t,e){"icon"===t&&(e?this._updateIcon(t,e):this.icon&&(this.icon.remove(),this.iconSpace&&this.iconSpace.remove())),"iconPosition"===t&&this._updateIcon(t,e),"showLabel"===t&&(this._toggleClass("ui-button-icon-only",null,!e),this._updateTooltip()),"label"===t&&(this.isInput?this.element.val(e):(this.element.html(e),this.icon&&(this._attachIcon(this.options.iconPosition),this._attachIconSpace(this.options.iconPosition)))),this._super(t,e),"disabled"===t&&(this._toggleClass(null,"ui-state-disabled",e),this.element[0].disabled=e,e&&this.element.blur())},refresh:function(){var t=this.element.is("input, button")?this.element[0].disabled:this.element.hasClass("ui-button-disabled");t!==this.options.disabled&&this._setOptions({disabled:t}),this._updateTooltip()}}),t.uiBackCompat!==!1&&(t.widget("ui.button",t.ui.button,{options:{text:!0,icons:{primary:null,secondary:null}},_create:function(){this.options.showLabel&&!this.options.text&&(this.options.showLabel=this.options.text),!this.options.showLabel&&this.options.text&&(this.options.text=this.options.showLabel),this.options.icon||!this.options.icons.primary&&!this.options.icons.secondary?this.options.icon&&(this.options.icons.primary=this.options.icon):this.options.icons.primary?this.options.icon=this.options.icons.primary:(this.options.icon=this.options.icons.secondary,this.options.iconPosition="end"),this._super()},_setOption:function(t,e){return"text"===t?(this._super("showLabel",e),void 0):("showLabel"===t&&(this.options.text=e),"icon"===t&&(this.options.icons.primary=e),"icons"===t&&(e.primary?(this._super("icon",e.primary),this._super("iconPosition","beginning")):e.secondary&&(this._super("icon",e.secondary),this._super("iconPosition","end"))),this._superApply(arguments),void 0)}}),t.fn.button=function(e){return function(){return!this.length||this.length&&"INPUT"!==this[0].tagName||this.length&&"INPUT"===this[0].tagName&&"checkbox"!==this.attr("type")&&"radio"!==this.attr("type")?e.apply(this,arguments):(t.ui.checkboxradio||t.error("Checkboxradio widget missing"),0===arguments.length?this.checkboxradio({icon:!1}):this.checkboxradio.apply(this,arguments))}}(t.fn.button),t.fn.buttonset=function(){return t.ui.controlgroup||t.error("Controlgroup widget missing"),"option"===arguments[0]&&"items"===arguments[1]&&arguments[2]?this.controlgroup.apply(this,[arguments[0],"items.button",arguments[2]]):"option"===arguments[0]&&"items"===arguments[1]?this.controlgroup.apply(this,[arguments[0],"items.button"]):("object"==typeof arguments[0]&&arguments[0].items&&(arguments[0].items={button:arguments[0].items}),this.controlgroup.apply(this,arguments))}),t.ui.button,t.extend(t.ui,{datepicker:{version:"1.12.1"}});var m;t.extend(s.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(t){return a(this._defaults,t||{}),this},_attachDatepicker:function(e,i){var s,n,o;s=e.nodeName.toLowerCase(),n="div"===s||"span"===s,e.id||(this.uuid+=1,e.id="dp"+this.uuid),o=this._newInst(t(e),n),o.settings=t.extend({},i||{}),"input"===s?this._connectDatepicker(e,o):n&&this._inlineDatepicker(e,o)},_newInst:function(e,i){var s=e[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:s,input:e,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:i,dpDiv:i?n(t("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(e,i){var s=t(e);i.append=t([]),i.trigger=t([]),s.hasClass(this.markerClassName)||(this._attachments(s,i),s.addClass(this.markerClassName).on("keydown",this._doKeyDown).on("keypress",this._doKeyPress).on("keyup",this._doKeyUp),this._autoSize(i),t.data(e,"datepicker",i),i.settings.disabled&&this._disableDatepicker(e))},_attachments:function(e,i){var s,n,o,a=this._get(i,"appendText"),r=this._get(i,"isRTL");i.append&&i.append.remove(),a&&(i.append=t("<span class='"+this._appendClass+"'>"+a+"</span>"),e[r?"before":"after"](i.append)),e.off("focus",this._showDatepicker),i.trigger&&i.trigger.remove(),s=this._get(i,"showOn"),("focus"===s||"both"===s)&&e.on("focus",this._showDatepicker),("button"===s||"both"===s)&&(n=this._get(i,"buttonText"),o=this._get(i,"buttonImage"),i.trigger=t(this._get(i,"buttonImageOnly")?t("<img/>").addClass(this._triggerClass).attr({src:o,alt:n,title:n}):t("<button type='button'></button>").addClass(this._triggerClass).html(o?t("<img/>").attr({src:o,alt:n,title:n}):n)),e[r?"before":"after"](i.trigger),i.trigger.on("click",function(){return t.datepicker._datepickerShowing&&t.datepicker._lastInput===e[0]?t.datepicker._hideDatepicker():t.datepicker._datepickerShowing&&t.datepicker._lastInput!==e[0]?(t.datepicker._hideDatepicker(),t.datepicker._showDatepicker(e[0])):t.datepicker._showDatepicker(e[0]),!1}))},_autoSize:function(t){if(this._get(t,"autoSize")&&!t.inline){var e,i,s,n,o=new Date(2009,11,20),a=this._get(t,"dateFormat");a.match(/[DM]/)&&(e=function(t){for(i=0,s=0,n=0;t.length>n;n++)t[n].length>i&&(i=t[n].length,s=n);return s},o.setMonth(e(this._get(t,a.match(/MM/)?"monthNames":"monthNamesShort"))),o.setDate(e(this._get(t,a.match(/DD/)?"dayNames":"dayNamesShort"))+20-o.getDay())),t.input.attr("size",this._formatDate(t,o).length)}},_inlineDatepicker:function(e,i){var s=t(e);s.hasClass(this.markerClassName)||(s.addClass(this.markerClassName).append(i.dpDiv),t.data(e,"datepicker",i),this._setDate(i,this._getDefaultDate(i),!0),this._updateDatepicker(i),this._updateAlternate(i),i.settings.disabled&&this._disableDatepicker(e),i.dpDiv.css("display","block"))},_dialogDatepicker:function(e,i,s,n,o){var r,h,l,c,u,d=this._dialogInst;return d||(this.uuid+=1,r="dp"+this.uuid,this._dialogInput=t("<input type='text' id='"+r+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.on("keydown",this._doKeyDown),t("body").append(this._dialogInput),d=this._dialogInst=this._newInst(this._dialogInput,!1),d.settings={},t.data(this._dialogInput[0],"datepicker",d)),a(d.settings,n||{}),i=i&&i.constructor===Date?this._formatDate(d,i):i,this._dialogInput.val(i),this._pos=o?o.length?o:[o.pageX,o.pageY]:null,this._pos||(h=document.documentElement.clientWidth,l=document.documentElement.clientHeight,c=document.documentElement.scrollLeft||document.body.scrollLeft,u=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[h/2-100+c,l/2-150+u]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),d.settings.onSelect=s,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),t.blockUI&&t.blockUI(this.dpDiv),t.data(this._dialogInput[0],"datepicker",d),this},_destroyDatepicker:function(e){var i,s=t(e),n=t.data(e,"datepicker");s.hasClass(this.markerClassName)&&(i=e.nodeName.toLowerCase(),t.removeData(e,"datepicker"),"input"===i?(n.append.remove(),n.trigger.remove(),s.removeClass(this.markerClassName).off("focus",this._showDatepicker).off("keydown",this._doKeyDown).off("keypress",this._doKeyPress).off("keyup",this._doKeyUp)):("div"===i||"span"===i)&&s.removeClass(this.markerClassName).empty(),m===n&&(m=null))},_enableDatepicker:function(e){var i,s,n=t(e),o=t.data(e,"datepicker");n.hasClass(this.markerClassName)&&(i=e.nodeName.toLowerCase(),"input"===i?(e.disabled=!1,o.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):("div"===i||"span"===i)&&(s=n.children("."+this._inlineClass),s.children().removeClass("ui-state-disabled"),s.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=t.map(this._disabledInputs,function(t){return t===e?null:t}))},_disableDatepicker:function(e){var i,s,n=t(e),o=t.data(e,"datepicker");n.hasClass(this.markerClassName)&&(i=e.nodeName.toLowerCase(),"input"===i?(e.disabled=!0,o.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):("div"===i||"span"===i)&&(s=n.children("."+this._inlineClass),s.children().addClass("ui-state-disabled"),s.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=t.map(this._disabledInputs,function(t){return t===e?null:t}),this._disabledInputs[this._disabledInputs.length]=e)},_isDisabledDatepicker:function(t){if(!t)return!1;for(var e=0;this._disabledInputs.length>e;e++)if(this._disabledInputs[e]===t)return!0;return!1},_getInst:function(e){try{return t.data(e,"datepicker")}catch(i){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(e,i,s){var n,o,r,h,l=this._getInst(e);return 2===arguments.length&&"string"==typeof i?"defaults"===i?t.extend({},t.datepicker._defaults):l?"all"===i?t.extend({},l.settings):this._get(l,i):null:(n=i||{},"string"==typeof i&&(n={},n[i]=s),l&&(this._curInst===l&&this._hideDatepicker(),o=this._getDateDatepicker(e,!0),r=this._getMinMaxDate(l,"min"),h=this._getMinMaxDate(l,"max"),a(l.settings,n),null!==r&&void 0!==n.dateFormat&&void 0===n.minDate&&(l.settings.minDate=this._formatDate(l,r)),null!==h&&void 0!==n.dateFormat&&void 0===n.maxDate&&(l.settings.maxDate=this._formatDate(l,h)),"disabled"in n&&(n.disabled?this._disableDatepicker(e):this._enableDatepicker(e)),this._attachments(t(e),l),this._autoSize(l),this._setDate(l,o),this._updateAlternate(l),this._updateDatepicker(l)),void 0)},_changeDatepicker:function(t,e,i){this._optionDatepicker(t,e,i)},_refreshDatepicker:function(t){var e=this._getInst(t);e&&this._updateDatepicker(e)},_setDateDatepicker:function(t,e){var i=this._getInst(t);i&&(this._setDate(i,e),this._updateDatepicker(i),this._updateAlternate(i))},_getDateDatepicker:function(t,e){var i=this._getInst(t);return i&&!i.inline&&this._setDateFromField(i,e),i?this._getDate(i):null},_doKeyDown:function(e){var i,s,n,o=t.datepicker._getInst(e.target),a=!0,r=o.dpDiv.is(".ui-datepicker-rtl");if(o._keyEvent=!0,t.datepicker._datepickerShowing)switch(e.keyCode){case 9:t.datepicker._hideDatepicker(),a=!1;break;case 13:return n=t("td."+t.datepicker._dayOverClass+":not(."+t.datepicker._currentClass+")",o.dpDiv),n[0]&&t.datepicker._selectDay(e.target,o.selectedMonth,o.selectedYear,n[0]),i=t.datepicker._get(o,"onSelect"),i?(s=t.datepicker._formatDate(o),i.apply(o.input?o.input[0]:null,[s,o])):t.datepicker._hideDatepicker(),!1;case 27:t.datepicker._hideDatepicker();break;case 33:t.datepicker._adjustDate(e.target,e.ctrlKey?-t.datepicker._get(o,"stepBigMonths"):-t.datepicker._get(o,"stepMonths"),"M");break;case 34:t.datepicker._adjustDate(e.target,e.ctrlKey?+t.datepicker._get(o,"stepBigMonths"):+t.datepicker._get(o,"stepMonths"),"M");break;case 35:(e.ctrlKey||e.metaKey)&&t.datepicker._clearDate(e.target),a=e.ctrlKey||e.metaKey;break;case 36:(e.ctrlKey||e.metaKey)&&t.datepicker._gotoToday(e.target),a=e.ctrlKey||e.metaKey;break;case 37:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,r?1:-1,"D"),a=e.ctrlKey||e.metaKey,e.originalEvent.altKey&&t.datepicker._adjustDate(e.target,e.ctrlKey?-t.datepicker._get(o,"stepBigMonths"):-t.datepicker._get(o,"stepMonths"),"M");break;case 38:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,-7,"D"),a=e.ctrlKey||e.metaKey;break;case 39:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,r?-1:1,"D"),a=e.ctrlKey||e.metaKey,e.originalEvent.altKey&&t.datepicker._adjustDate(e.target,e.ctrlKey?+t.datepicker._get(o,"stepBigMonths"):+t.datepicker._get(o,"stepMonths"),"M");break;case 40:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,7,"D"),a=e.ctrlKey||e.metaKey;break;default:a=!1}else 36===e.keyCode&&e.ctrlKey?t.datepicker._showDatepicker(this):a=!1;a&&(e.preventDefault(),e.stopPropagation())},_doKeyPress:function(e){var i,s,n=t.datepicker._getInst(e.target);return t.datepicker._get(n,"constrainInput")?(i=t.datepicker._possibleChars(t.datepicker._get(n,"dateFormat")),s=String.fromCharCode(null==e.charCode?e.keyCode:e.charCode),e.ctrlKey||e.metaKey||" ">s||!i||i.indexOf(s)>-1):void 0},_doKeyUp:function(e){var i,s=t.datepicker._getInst(e.target);if(s.input.val()!==s.lastVal)try{i=t.datepicker.parseDate(t.datepicker._get(s,"dateFormat"),s.input?s.input.val():null,t.datepicker._getFormatConfig(s)),i&&(t.datepicker._setDateFromField(s),t.datepicker._updateAlternate(s),t.datepicker._updateDatepicker(s))}catch(n){}return!0},_showDatepicker:function(e){if(e=e.target||e,"input"!==e.nodeName.toLowerCase()&&(e=t("input",e.parentNode)[0]),!t.datepicker._isDisabledDatepicker(e)&&t.datepicker._lastInput!==e){var s,n,o,r,h,l,c;s=t.datepicker._getInst(e),t.datepicker._curInst&&t.datepicker._curInst!==s&&(t.datepicker._curInst.dpDiv.stop(!0,!0),s&&t.datepicker._datepickerShowing&&t.datepicker._hideDatepicker(t.datepicker._curInst.input[0])),n=t.datepicker._get(s,"beforeShow"),o=n?n.apply(e,[e,s]):{},o!==!1&&(a(s.settings,o),s.lastVal=null,t.datepicker._lastInput=e,t.datepicker._setDateFromField(s),t.datepicker._inDialog&&(e.value=""),t.datepicker._pos||(t.datepicker._pos=t.datepicker._findPos(e),t.datepicker._pos[1]+=e.offsetHeight),r=!1,t(e).parents().each(function(){return r|="fixed"===t(this).css("position"),!r}),h={left:t.datepicker._pos[0],top:t.datepicker._pos[1]},t.datepicker._pos=null,s.dpDiv.empty(),s.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),t.datepicker._updateDatepicker(s),h=t.datepicker._checkOffset(s,h,r),s.dpDiv.css({position:t.datepicker._inDialog&&t.blockUI?"static":r?"fixed":"absolute",display:"none",left:h.left+"px",top:h.top+"px"}),s.inline||(l=t.datepicker._get(s,"showAnim"),c=t.datepicker._get(s,"duration"),s.dpDiv.css("z-index",i(t(e))+1),t.datepicker._datepickerShowing=!0,t.effects&&t.effects.effect[l]?s.dpDiv.show(l,t.datepicker._get(s,"showOptions"),c):s.dpDiv[l||"show"](l?c:null),t.datepicker._shouldFocusInput(s)&&s.input.trigger("focus"),t.datepicker._curInst=s))
	}},_updateDatepicker:function(e){this.maxRows=4,m=e,e.dpDiv.empty().append(this._generateHTML(e)),this._attachHandlers(e);var i,s=this._getNumberOfMonths(e),n=s[1],a=17,r=e.dpDiv.find("."+this._dayOverClass+" a");r.length>0&&o.apply(r.get(0)),e.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),n>1&&e.dpDiv.addClass("ui-datepicker-multi-"+n).css("width",a*n+"em"),e.dpDiv[(1!==s[0]||1!==s[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),e.dpDiv[(this._get(e,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),e===t.datepicker._curInst&&t.datepicker._datepickerShowing&&t.datepicker._shouldFocusInput(e)&&e.input.trigger("focus"),e.yearshtml&&(i=e.yearshtml,setTimeout(function(){i===e.yearshtml&&e.yearshtml&&e.dpDiv.find("select.ui-datepicker-year:first").replaceWith(e.yearshtml),i=e.yearshtml=null},0))},_shouldFocusInput:function(t){return t.input&&t.input.is(":visible")&&!t.input.is(":disabled")&&!t.input.is(":focus")},_checkOffset:function(e,i,s){var n=e.dpDiv.outerWidth(),o=e.dpDiv.outerHeight(),a=e.input?e.input.outerWidth():0,r=e.input?e.input.outerHeight():0,h=document.documentElement.clientWidth+(s?0:t(document).scrollLeft()),l=document.documentElement.clientHeight+(s?0:t(document).scrollTop());return i.left-=this._get(e,"isRTL")?n-a:0,i.left-=s&&i.left===e.input.offset().left?t(document).scrollLeft():0,i.top-=s&&i.top===e.input.offset().top+r?t(document).scrollTop():0,i.left-=Math.min(i.left,i.left+n>h&&h>n?Math.abs(i.left+n-h):0),i.top-=Math.min(i.top,i.top+o>l&&l>o?Math.abs(o+r):0),i},_findPos:function(e){for(var i,s=this._getInst(e),n=this._get(s,"isRTL");e&&("hidden"===e.type||1!==e.nodeType||t.expr.filters.hidden(e));)e=e[n?"previousSibling":"nextSibling"];return i=t(e).offset(),[i.left,i.top]},_hideDatepicker:function(e){var i,s,n,o,a=this._curInst;!a||e&&a!==t.data(e,"datepicker")||this._datepickerShowing&&(i=this._get(a,"showAnim"),s=this._get(a,"duration"),n=function(){t.datepicker._tidyDialog(a)},t.effects&&(t.effects.effect[i]||t.effects[i])?a.dpDiv.hide(i,t.datepicker._get(a,"showOptions"),s,n):a.dpDiv["slideDown"===i?"slideUp":"fadeIn"===i?"fadeOut":"hide"](i?s:null,n),i||n(),this._datepickerShowing=!1,o=this._get(a,"onClose"),o&&o.apply(a.input?a.input[0]:null,[a.input?a.input.val():"",a]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),t.blockUI&&(t.unblockUI(),t("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(t){t.dpDiv.removeClass(this._dialogClass).off(".ui-datepicker-calendar")},_checkExternalClick:function(e){if(t.datepicker._curInst){var i=t(e.target),s=t.datepicker._getInst(i[0]);(i[0].id!==t.datepicker._mainDivId&&0===i.parents("#"+t.datepicker._mainDivId).length&&!i.hasClass(t.datepicker.markerClassName)&&!i.closest("."+t.datepicker._triggerClass).length&&t.datepicker._datepickerShowing&&(!t.datepicker._inDialog||!t.blockUI)||i.hasClass(t.datepicker.markerClassName)&&t.datepicker._curInst!==s)&&t.datepicker._hideDatepicker()}},_adjustDate:function(e,i,s){var n=t(e),o=this._getInst(n[0]);this._isDisabledDatepicker(n[0])||(this._adjustInstDate(o,i+("M"===s?this._get(o,"showCurrentAtPos"):0),s),this._updateDatepicker(o))},_gotoToday:function(e){var i,s=t(e),n=this._getInst(s[0]);this._get(n,"gotoCurrent")&&n.currentDay?(n.selectedDay=n.currentDay,n.drawMonth=n.selectedMonth=n.currentMonth,n.drawYear=n.selectedYear=n.currentYear):(i=new Date,n.selectedDay=i.getDate(),n.drawMonth=n.selectedMonth=i.getMonth(),n.drawYear=n.selectedYear=i.getFullYear()),this._notifyChange(n),this._adjustDate(s)},_selectMonthYear:function(e,i,s){var n=t(e),o=this._getInst(n[0]);o["selected"+("M"===s?"Month":"Year")]=o["draw"+("M"===s?"Month":"Year")]=parseInt(i.options[i.selectedIndex].value,10),this._notifyChange(o),this._adjustDate(n)},_selectDay:function(e,i,s,n){var o,a=t(e);t(n).hasClass(this._unselectableClass)||this._isDisabledDatepicker(a[0])||(o=this._getInst(a[0]),o.selectedDay=o.currentDay=t("a",n).html(),o.selectedMonth=o.currentMonth=i,o.selectedYear=o.currentYear=s,this._selectDate(e,this._formatDate(o,o.currentDay,o.currentMonth,o.currentYear)))},_clearDate:function(e){var i=t(e);this._selectDate(i,"")},_selectDate:function(e,i){var s,n=t(e),o=this._getInst(n[0]);i=null!=i?i:this._formatDate(o),o.input&&o.input.val(i),this._updateAlternate(o),s=this._get(o,"onSelect"),s?s.apply(o.input?o.input[0]:null,[i,o]):o.input&&o.input.trigger("change"),o.inline?this._updateDatepicker(o):(this._hideDatepicker(),this._lastInput=o.input[0],"object"!=typeof o.input[0]&&o.input.trigger("focus"),this._lastInput=null)},_updateAlternate:function(e){var i,s,n,o=this._get(e,"altField");o&&(i=this._get(e,"altFormat")||this._get(e,"dateFormat"),s=this._getDate(e),n=this.formatDate(i,s,this._getFormatConfig(e)),t(o).val(n))},noWeekends:function(t){var e=t.getDay();return[e>0&&6>e,""]},iso8601Week:function(t){var e,i=new Date(t.getTime());return i.setDate(i.getDate()+4-(i.getDay()||7)),e=i.getTime(),i.setMonth(0),i.setDate(1),Math.floor(Math.round((e-i)/864e5)/7)+1},parseDate:function(e,i,s){if(null==e||null==i)throw"Invalid arguments";if(i="object"==typeof i?""+i:i+"",""===i)return null;var n,o,a,r,h=0,l=(s?s.shortYearCutoff:null)||this._defaults.shortYearCutoff,c="string"!=typeof l?l:(new Date).getFullYear()%100+parseInt(l,10),u=(s?s.dayNamesShort:null)||this._defaults.dayNamesShort,d=(s?s.dayNames:null)||this._defaults.dayNames,p=(s?s.monthNamesShort:null)||this._defaults.monthNamesShort,f=(s?s.monthNames:null)||this._defaults.monthNames,g=-1,m=-1,_=-1,v=-1,b=!1,y=function(t){var i=e.length>n+1&&e.charAt(n+1)===t;return i&&n++,i},w=function(t){var e=y(t),s="@"===t?14:"!"===t?20:"y"===t&&e?4:"o"===t?3:2,n="y"===t?s:1,o=RegExp("^\\d{"+n+","+s+"}"),a=i.substring(h).match(o);if(!a)throw"Missing number at position "+h;return h+=a[0].length,parseInt(a[0],10)},k=function(e,s,n){var o=-1,a=t.map(y(e)?n:s,function(t,e){return[[e,t]]}).sort(function(t,e){return-(t[1].length-e[1].length)});if(t.each(a,function(t,e){var s=e[1];return i.substr(h,s.length).toLowerCase()===s.toLowerCase()?(o=e[0],h+=s.length,!1):void 0}),-1!==o)return o+1;throw"Unknown name at position "+h},x=function(){if(i.charAt(h)!==e.charAt(n))throw"Unexpected literal at position "+h;h++};for(n=0;e.length>n;n++)if(b)"'"!==e.charAt(n)||y("'")?x():b=!1;else switch(e.charAt(n)){case"d":_=w("d");break;case"D":k("D",u,d);break;case"o":v=w("o");break;case"m":m=w("m");break;case"M":m=k("M",p,f);break;case"y":g=w("y");break;case"@":r=new Date(w("@")),g=r.getFullYear(),m=r.getMonth()+1,_=r.getDate();break;case"!":r=new Date((w("!")-this._ticksTo1970)/1e4),g=r.getFullYear(),m=r.getMonth()+1,_=r.getDate();break;case"'":y("'")?x():b=!0;break;default:x()}if(i.length>h&&(a=i.substr(h),!/^\s+/.test(a)))throw"Extra/unparsed characters found in date: "+a;if(-1===g?g=(new Date).getFullYear():100>g&&(g+=(new Date).getFullYear()-(new Date).getFullYear()%100+(c>=g?0:-100)),v>-1)for(m=1,_=v;;){if(o=this._getDaysInMonth(g,m-1),o>=_)break;m++,_-=o}if(r=this._daylightSavingAdjust(new Date(g,m-1,_)),r.getFullYear()!==g||r.getMonth()+1!==m||r.getDate()!==_)throw"Invalid date";return r},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:1e7*60*60*24*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925)),formatDate:function(t,e,i){if(!e)return"";var s,n=(i?i.dayNamesShort:null)||this._defaults.dayNamesShort,o=(i?i.dayNames:null)||this._defaults.dayNames,a=(i?i.monthNamesShort:null)||this._defaults.monthNamesShort,r=(i?i.monthNames:null)||this._defaults.monthNames,h=function(e){var i=t.length>s+1&&t.charAt(s+1)===e;return i&&s++,i},l=function(t,e,i){var s=""+e;if(h(t))for(;i>s.length;)s="0"+s;return s},c=function(t,e,i,s){return h(t)?s[e]:i[e]},u="",d=!1;if(e)for(s=0;t.length>s;s++)if(d)"'"!==t.charAt(s)||h("'")?u+=t.charAt(s):d=!1;else switch(t.charAt(s)){case"d":u+=l("d",e.getDate(),2);break;case"D":u+=c("D",e.getDay(),n,o);break;case"o":u+=l("o",Math.round((new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime()-new Date(e.getFullYear(),0,0).getTime())/864e5),3);break;case"m":u+=l("m",e.getMonth()+1,2);break;case"M":u+=c("M",e.getMonth(),a,r);break;case"y":u+=h("y")?e.getFullYear():(10>e.getFullYear()%100?"0":"")+e.getFullYear()%100;break;case"@":u+=e.getTime();break;case"!":u+=1e4*e.getTime()+this._ticksTo1970;break;case"'":h("'")?u+="'":d=!0;break;default:u+=t.charAt(s)}return u},_possibleChars:function(t){var e,i="",s=!1,n=function(i){var s=t.length>e+1&&t.charAt(e+1)===i;return s&&e++,s};for(e=0;t.length>e;e++)if(s)"'"!==t.charAt(e)||n("'")?i+=t.charAt(e):s=!1;else switch(t.charAt(e)){case"d":case"m":case"y":case"@":i+="0123456789";break;case"D":case"M":return null;case"'":n("'")?i+="'":s=!0;break;default:i+=t.charAt(e)}return i},_get:function(t,e){return void 0!==t.settings[e]?t.settings[e]:this._defaults[e]},_setDateFromField:function(t,e){if(t.input.val()!==t.lastVal){var i=this._get(t,"dateFormat"),s=t.lastVal=t.input?t.input.val():null,n=this._getDefaultDate(t),o=n,a=this._getFormatConfig(t);try{o=this.parseDate(i,s,a)||n}catch(r){s=e?"":s}t.selectedDay=o.getDate(),t.drawMonth=t.selectedMonth=o.getMonth(),t.drawYear=t.selectedYear=o.getFullYear(),t.currentDay=s?o.getDate():0,t.currentMonth=s?o.getMonth():0,t.currentYear=s?o.getFullYear():0,this._adjustInstDate(t)}},_getDefaultDate:function(t){return this._restrictMinMax(t,this._determineDate(t,this._get(t,"defaultDate"),new Date))},_determineDate:function(e,i,s){var n=function(t){var e=new Date;return e.setDate(e.getDate()+t),e},o=function(i){try{return t.datepicker.parseDate(t.datepicker._get(e,"dateFormat"),i,t.datepicker._getFormatConfig(e))}catch(s){}for(var n=(i.toLowerCase().match(/^c/)?t.datepicker._getDate(e):null)||new Date,o=n.getFullYear(),a=n.getMonth(),r=n.getDate(),h=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,l=h.exec(i);l;){switch(l[2]||"d"){case"d":case"D":r+=parseInt(l[1],10);break;case"w":case"W":r+=7*parseInt(l[1],10);break;case"m":case"M":a+=parseInt(l[1],10),r=Math.min(r,t.datepicker._getDaysInMonth(o,a));break;case"y":case"Y":o+=parseInt(l[1],10),r=Math.min(r,t.datepicker._getDaysInMonth(o,a))}l=h.exec(i)}return new Date(o,a,r)},a=null==i||""===i?s:"string"==typeof i?o(i):"number"==typeof i?isNaN(i)?s:n(i):new Date(i.getTime());return a=a&&"Invalid Date"==""+a?s:a,a&&(a.setHours(0),a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0)),this._daylightSavingAdjust(a)},_daylightSavingAdjust:function(t){return t?(t.setHours(t.getHours()>12?t.getHours()+2:0),t):null},_setDate:function(t,e,i){var s=!e,n=t.selectedMonth,o=t.selectedYear,a=this._restrictMinMax(t,this._determineDate(t,e,new Date));t.selectedDay=t.currentDay=a.getDate(),t.drawMonth=t.selectedMonth=t.currentMonth=a.getMonth(),t.drawYear=t.selectedYear=t.currentYear=a.getFullYear(),n===t.selectedMonth&&o===t.selectedYear||i||this._notifyChange(t),this._adjustInstDate(t),t.input&&t.input.val(s?"":this._formatDate(t))},_getDate:function(t){var e=!t.currentYear||t.input&&""===t.input.val()?null:this._daylightSavingAdjust(new Date(t.currentYear,t.currentMonth,t.currentDay));return e},_attachHandlers:function(e){var i=this._get(e,"stepMonths"),s="#"+e.id.replace(/\\\\/g,"\\");e.dpDiv.find("[data-handler]").map(function(){var e={prev:function(){t.datepicker._adjustDate(s,-i,"M")},next:function(){t.datepicker._adjustDate(s,+i,"M")},hide:function(){t.datepicker._hideDatepicker()},today:function(){t.datepicker._gotoToday(s)},selectDay:function(){return t.datepicker._selectDay(s,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return t.datepicker._selectMonthYear(s,this,"M"),!1},selectYear:function(){return t.datepicker._selectMonthYear(s,this,"Y"),!1}};t(this).on(this.getAttribute("data-event"),e[this.getAttribute("data-handler")])})},_generateHTML:function(t){var e,i,s,n,o,a,r,h,l,c,u,d,p,f,g,m,_,v,b,y,w,k,x,C,D,I,T,P,M,S,H,z,O,A,N,W,E,F,L,R=new Date,B=this._daylightSavingAdjust(new Date(R.getFullYear(),R.getMonth(),R.getDate())),Y=this._get(t,"isRTL"),j=this._get(t,"showButtonPanel"),q=this._get(t,"hideIfNoPrevNext"),K=this._get(t,"navigationAsDateFormat"),U=this._getNumberOfMonths(t),V=this._get(t,"showCurrentAtPos"),$=this._get(t,"stepMonths"),X=1!==U[0]||1!==U[1],G=this._daylightSavingAdjust(t.currentDay?new Date(t.currentYear,t.currentMonth,t.currentDay):new Date(9999,9,9)),Q=this._getMinMaxDate(t,"min"),J=this._getMinMaxDate(t,"max"),Z=t.drawMonth-V,te=t.drawYear;if(0>Z&&(Z+=12,te--),J)for(e=this._daylightSavingAdjust(new Date(J.getFullYear(),J.getMonth()-U[0]*U[1]+1,J.getDate())),e=Q&&Q>e?Q:e;this._daylightSavingAdjust(new Date(te,Z,1))>e;)Z--,0>Z&&(Z=11,te--);for(t.drawMonth=Z,t.drawYear=te,i=this._get(t,"prevText"),i=K?this.formatDate(i,this._daylightSavingAdjust(new Date(te,Z-$,1)),this._getFormatConfig(t)):i,s=this._canAdjustMonth(t,-1,te,Z)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(Y?"e":"w")+"'>"+i+"</span></a>":q?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(Y?"e":"w")+"'>"+i+"</span></a>",n=this._get(t,"nextText"),n=K?this.formatDate(n,this._daylightSavingAdjust(new Date(te,Z+$,1)),this._getFormatConfig(t)):n,o=this._canAdjustMonth(t,1,te,Z)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(Y?"w":"e")+"'>"+n+"</span></a>":q?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(Y?"w":"e")+"'>"+n+"</span></a>",a=this._get(t,"currentText"),r=this._get(t,"gotoCurrent")&&t.currentDay?G:B,a=K?this.formatDate(a,r,this._getFormatConfig(t)):a,h=t.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(t,"closeText")+"</button>",l=j?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(Y?h:"")+(this._isInRange(t,r)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+a+"</button>":"")+(Y?"":h)+"</div>":"",c=parseInt(this._get(t,"firstDay"),10),c=isNaN(c)?0:c,u=this._get(t,"showWeek"),d=this._get(t,"dayNames"),p=this._get(t,"dayNamesMin"),f=this._get(t,"monthNames"),g=this._get(t,"monthNamesShort"),m=this._get(t,"beforeShowDay"),_=this._get(t,"showOtherMonths"),v=this._get(t,"selectOtherMonths"),b=this._getDefaultDate(t),y="",k=0;U[0]>k;k++){for(x="",this.maxRows=4,C=0;U[1]>C;C++){if(D=this._daylightSavingAdjust(new Date(te,Z,t.selectedDay)),I=" ui-corner-all",T="",X){if(T+="<div class='ui-datepicker-group",U[1]>1)switch(C){case 0:T+=" ui-datepicker-group-first",I=" ui-corner-"+(Y?"right":"left");break;case U[1]-1:T+=" ui-datepicker-group-last",I=" ui-corner-"+(Y?"left":"right");break;default:T+=" ui-datepicker-group-middle",I=""}T+="'>"}for(T+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+I+"'>"+(/all|left/.test(I)&&0===k?Y?o:s:"")+(/all|right/.test(I)&&0===k?Y?s:o:"")+this._generateMonthYearHeader(t,Z,te,Q,J,k>0||C>0,f,g)+"</div><table class='ui-datepicker-calendar'><thead>"+"<tr>",P=u?"<th class='ui-datepicker-week-col'>"+this._get(t,"weekHeader")+"</th>":"",w=0;7>w;w++)M=(w+c)%7,P+="<th scope='col'"+((w+c+6)%7>=5?" class='ui-datepicker-week-end'":"")+">"+"<span title='"+d[M]+"'>"+p[M]+"</span></th>";for(T+=P+"</tr></thead><tbody>",S=this._getDaysInMonth(te,Z),te===t.selectedYear&&Z===t.selectedMonth&&(t.selectedDay=Math.min(t.selectedDay,S)),H=(this._getFirstDayOfMonth(te,Z)-c+7)%7,z=Math.ceil((H+S)/7),O=X?this.maxRows>z?this.maxRows:z:z,this.maxRows=O,A=this._daylightSavingAdjust(new Date(te,Z,1-H)),N=0;O>N;N++){for(T+="<tr>",W=u?"<td class='ui-datepicker-week-col'>"+this._get(t,"calculateWeek")(A)+"</td>":"",w=0;7>w;w++)E=m?m.apply(t.input?t.input[0]:null,[A]):[!0,""],F=A.getMonth()!==Z,L=F&&!v||!E[0]||Q&&Q>A||J&&A>J,W+="<td class='"+((w+c+6)%7>=5?" ui-datepicker-week-end":"")+(F?" ui-datepicker-other-month":"")+(A.getTime()===D.getTime()&&Z===t.selectedMonth&&t._keyEvent||b.getTime()===A.getTime()&&b.getTime()===D.getTime()?" "+this._dayOverClass:"")+(L?" "+this._unselectableClass+" ui-state-disabled":"")+(F&&!_?"":" "+E[1]+(A.getTime()===G.getTime()?" "+this._currentClass:"")+(A.getTime()===B.getTime()?" ui-datepicker-today":""))+"'"+(F&&!_||!E[2]?"":" title='"+E[2].replace(/'/g,"&#39;")+"'")+(L?"":" data-handler='selectDay' data-event='click' data-month='"+A.getMonth()+"' data-year='"+A.getFullYear()+"'")+">"+(F&&!_?"&#xa0;":L?"<span class='ui-state-default'>"+A.getDate()+"</span>":"<a class='ui-state-default"+(A.getTime()===B.getTime()?" ui-state-highlight":"")+(A.getTime()===G.getTime()?" ui-state-active":"")+(F?" ui-priority-secondary":"")+"' href='#'>"+A.getDate()+"</a>")+"</td>",A.setDate(A.getDate()+1),A=this._daylightSavingAdjust(A);T+=W+"</tr>"}Z++,Z>11&&(Z=0,te++),T+="</tbody></table>"+(X?"</div>"+(U[0]>0&&C===U[1]-1?"<div class='ui-datepicker-row-break'></div>":""):""),x+=T}y+=x}return y+=l,t._keyEvent=!1,y},_generateMonthYearHeader:function(t,e,i,s,n,o,a,r){var h,l,c,u,d,p,f,g,m=this._get(t,"changeMonth"),_=this._get(t,"changeYear"),v=this._get(t,"showMonthAfterYear"),b="<div class='ui-datepicker-title'>",y="";if(o||!m)y+="<span class='ui-datepicker-month'>"+a[e]+"</span>";else{for(h=s&&s.getFullYear()===i,l=n&&n.getFullYear()===i,y+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",c=0;12>c;c++)(!h||c>=s.getMonth())&&(!l||n.getMonth()>=c)&&(y+="<option value='"+c+"'"+(c===e?" selected='selected'":"")+">"+r[c]+"</option>");y+="</select>"}if(v||(b+=y+(!o&&m&&_?"":"&#xa0;")),!t.yearshtml)if(t.yearshtml="",o||!_)b+="<span class='ui-datepicker-year'>"+i+"</span>";else{for(u=this._get(t,"yearRange").split(":"),d=(new Date).getFullYear(),p=function(t){var e=t.match(/c[+\-].*/)?i+parseInt(t.substring(1),10):t.match(/[+\-].*/)?d+parseInt(t,10):parseInt(t,10);return isNaN(e)?d:e},f=p(u[0]),g=Math.max(f,p(u[1]||"")),f=s?Math.max(f,s.getFullYear()):f,g=n?Math.min(g,n.getFullYear()):g,t.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";g>=f;f++)t.yearshtml+="<option value='"+f+"'"+(f===i?" selected='selected'":"")+">"+f+"</option>";t.yearshtml+="</select>",b+=t.yearshtml,t.yearshtml=null}return b+=this._get(t,"yearSuffix"),v&&(b+=(!o&&m&&_?"":"&#xa0;")+y),b+="</div>"},_adjustInstDate:function(t,e,i){var s=t.selectedYear+("Y"===i?e:0),n=t.selectedMonth+("M"===i?e:0),o=Math.min(t.selectedDay,this._getDaysInMonth(s,n))+("D"===i?e:0),a=this._restrictMinMax(t,this._daylightSavingAdjust(new Date(s,n,o)));t.selectedDay=a.getDate(),t.drawMonth=t.selectedMonth=a.getMonth(),t.drawYear=t.selectedYear=a.getFullYear(),("M"===i||"Y"===i)&&this._notifyChange(t)},_restrictMinMax:function(t,e){var i=this._getMinMaxDate(t,"min"),s=this._getMinMaxDate(t,"max"),n=i&&i>e?i:e;return s&&n>s?s:n},_notifyChange:function(t){var e=this._get(t,"onChangeMonthYear");e&&e.apply(t.input?t.input[0]:null,[t.selectedYear,t.selectedMonth+1,t])},_getNumberOfMonths:function(t){var e=this._get(t,"numberOfMonths");return null==e?[1,1]:"number"==typeof e?[1,e]:e},_getMinMaxDate:function(t,e){return this._determineDate(t,this._get(t,e+"Date"),null)},_getDaysInMonth:function(t,e){return 32-this._daylightSavingAdjust(new Date(t,e,32)).getDate()},_getFirstDayOfMonth:function(t,e){return new Date(t,e,1).getDay()},_canAdjustMonth:function(t,e,i,s){var n=this._getNumberOfMonths(t),o=this._daylightSavingAdjust(new Date(i,s+(0>e?e:n[0]*n[1]),1));return 0>e&&o.setDate(this._getDaysInMonth(o.getFullYear(),o.getMonth())),this._isInRange(t,o)},_isInRange:function(t,e){var i,s,n=this._getMinMaxDate(t,"min"),o=this._getMinMaxDate(t,"max"),a=null,r=null,h=this._get(t,"yearRange");return h&&(i=h.split(":"),s=(new Date).getFullYear(),a=parseInt(i[0],10),r=parseInt(i[1],10),i[0].match(/[+\-].*/)&&(a+=s),i[1].match(/[+\-].*/)&&(r+=s)),(!n||e.getTime()>=n.getTime())&&(!o||e.getTime()<=o.getTime())&&(!a||e.getFullYear()>=a)&&(!r||r>=e.getFullYear())},_getFormatConfig:function(t){var e=this._get(t,"shortYearCutoff");return e="string"!=typeof e?e:(new Date).getFullYear()%100+parseInt(e,10),{shortYearCutoff:e,dayNamesShort:this._get(t,"dayNamesShort"),dayNames:this._get(t,"dayNames"),monthNamesShort:this._get(t,"monthNamesShort"),monthNames:this._get(t,"monthNames")}},_formatDate:function(t,e,i,s){e||(t.currentDay=t.selectedDay,t.currentMonth=t.selectedMonth,t.currentYear=t.selectedYear);var n=e?"object"==typeof e?e:this._daylightSavingAdjust(new Date(s,i,e)):this._daylightSavingAdjust(new Date(t.currentYear,t.currentMonth,t.currentDay));return this.formatDate(this._get(t,"dateFormat"),n,this._getFormatConfig(t))}}),t.fn.datepicker=function(e){if(!this.length)return this;t.datepicker.initialized||(t(document).on("mousedown",t.datepicker._checkExternalClick),t.datepicker.initialized=!0),0===t("#"+t.datepicker._mainDivId).length&&t("body").append(t.datepicker.dpDiv);var i=Array.prototype.slice.call(arguments,1);return"string"!=typeof e||"isDisabled"!==e&&"getDate"!==e&&"widget"!==e?"option"===e&&2===arguments.length&&"string"==typeof arguments[1]?t.datepicker["_"+e+"Datepicker"].apply(t.datepicker,[this[0]].concat(i)):this.each(function(){"string"==typeof e?t.datepicker["_"+e+"Datepicker"].apply(t.datepicker,[this].concat(i)):t.datepicker._attachDatepicker(this,e)}):t.datepicker["_"+e+"Datepicker"].apply(t.datepicker,[this[0]].concat(i))},t.datepicker=new s,t.datepicker.initialized=!1,t.datepicker.uuid=(new Date).getTime(),t.datepicker.version="1.12.1",t.datepicker,t.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase());var _=!1;t(document).on("mouseup",function(){_=!1}),t.widget("ui.mouse",{version:"1.12.1",options:{cancel:"input, textarea, button, select, option",distance:1,delay:0},_mouseInit:function(){var e=this;this.element.on("mousedown."+this.widgetName,function(t){return e._mouseDown(t)}).on("click."+this.widgetName,function(i){return!0===t.data(i.target,e.widgetName+".preventClickEvent")?(t.removeData(i.target,e.widgetName+".preventClickEvent"),i.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.off("."+this.widgetName),this._mouseMoveDelegate&&this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(e){if(!_){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(e),this._mouseDownEvent=e;var i=this,s=1===e.which,n="string"==typeof this.options.cancel&&e.target.nodeName?t(e.target).closest(this.options.cancel).length:!1;return s&&!n&&this._mouseCapture(e)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){i.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=this._mouseStart(e)!==!1,!this._mouseStarted)?(e.preventDefault(),!0):(!0===t.data(e.target,this.widgetName+".preventClickEvent")&&t.removeData(e.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(t){return i._mouseMove(t)},this._mouseUpDelegate=function(t){return i._mouseUp(t)},this.document.on("mousemove."+this.widgetName,this._mouseMoveDelegate).on("mouseup."+this.widgetName,this._mouseUpDelegate),e.preventDefault(),_=!0,!0)):!0}},_mouseMove:function(e){if(this._mouseMoved){if(t.ui.ie&&(!document.documentMode||9>document.documentMode)&&!e.button)return this._mouseUp(e);if(!e.which)if(e.originalEvent.altKey||e.originalEvent.ctrlKey||e.originalEvent.metaKey||e.originalEvent.shiftKey)this.ignoreMissingWhich=!0;else if(!this.ignoreMissingWhich)return this._mouseUp(e)}return(e.which||e.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(e),e.preventDefault()):(this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,e)!==!1,this._mouseStarted?this._mouseDrag(e):this._mouseUp(e)),!this._mouseStarted)},_mouseUp:function(e){this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,e.target===this._mouseDownEvent.target&&t.data(e.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(e)),this._mouseDelayTimer&&(clearTimeout(this._mouseDelayTimer),delete this._mouseDelayTimer),this.ignoreMissingWhich=!1,_=!1,e.preventDefault()},_mouseDistanceMet:function(t){return Math.max(Math.abs(this._mouseDownEvent.pageX-t.pageX),Math.abs(this._mouseDownEvent.pageY-t.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}}),t.ui.plugin={add:function(e,i,s){var n,o=t.ui[e].prototype;for(n in s)o.plugins[n]=o.plugins[n]||[],o.plugins[n].push([i,s[n]])},call:function(t,e,i,s){var n,o=t.plugins[e];if(o&&(s||t.element[0].parentNode&&11!==t.element[0].parentNode.nodeType))for(n=0;o.length>n;n++)t.options[o[n][0]]&&o[n][1].apply(t.element,i)}},t.ui.safeBlur=function(e){e&&"body"!==e.nodeName.toLowerCase()&&t(e).trigger("blur")},t.widget("ui.draggable",t.ui.mouse,{version:"1.12.1",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&this._setPositionRelative(),this.options.addClasses&&this._addClass("ui-draggable"),this._setHandleClassName(),this._mouseInit()},_setOption:function(t,e){this._super(t,e),"handle"===t&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){return(this.helper||this.element).is(".ui-draggable-dragging")?(this.destroyOnClear=!0,void 0):(this._removeHandleClassName(),this._mouseDestroy(),void 0)},_mouseCapture:function(e){var i=this.options;return this.helper||i.disabled||t(e.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(e),this.handle?(this._blurActiveElement(e),this._blockFrames(i.iframeFix===!0?"iframe":i.iframeFix),!0):!1)},_blockFrames:function(e){this.iframeBlocks=this.document.find(e).map(function(){var e=t(this);return t("<div>").css("position","absolute").appendTo(e.parent()).outerWidth(e.outerWidth()).outerHeight(e.outerHeight()).offset(e.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(e){var i=t.ui.safeActiveElement(this.document[0]),s=t(e.target);s.closest(i).length||t.ui.safeBlur(i)},_mouseStart:function(e){var i=this.options;return this.helper=this._createHelper(e),this._addClass(this.helper,"ui-draggable-dragging"),this._cacheHelperProportions(),t.ui.ddmanager&&(t.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=this.helper.parents().filter(function(){return"fixed"===t(this).css("position")}).length>0,this.positionAbs=this.element.offset(),this._refreshOffsets(e),this.originalPosition=this.position=this._generatePosition(e,!1),this.originalPageX=e.pageX,this.originalPageY=e.pageY,i.cursorAt&&this._adjustOffsetFromHelper(i.cursorAt),this._setContainment(),this._trigger("start",e)===!1?(this._clear(),!1):(this._cacheHelperProportions(),t.ui.ddmanager&&!i.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e),this._mouseDrag(e,!0),t.ui.ddmanager&&t.ui.ddmanager.dragStart(this,e),!0)},_refreshOffsets:function(t){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()},this.offset.click={left:t.pageX-this.offset.left,top:t.pageY-this.offset.top}},_mouseDrag:function(e,i){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(e,!0),this.positionAbs=this._convertPositionTo("absolute"),!i){var s=this._uiHash();if(this._trigger("drag",e,s)===!1)return this._mouseUp(new t.Event("mouseup",e)),!1;this.position=s.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",t.ui.ddmanager&&t.ui.ddmanager.drag(this,e),!1},_mouseStop:function(e){var i=this,s=!1;return t.ui.ddmanager&&!this.options.dropBehaviour&&(s=t.ui.ddmanager.drop(this,e)),this.dropped&&(s=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!s||"valid"===this.options.revert&&s||this.options.revert===!0||t.isFunction(this.options.revert)&&this.options.revert.call(this.element,s)?t(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){i._trigger("stop",e)!==!1&&i._clear()}):this._trigger("stop",e)!==!1&&this._clear(),!1},_mouseUp:function(e){return this._unblockFrames(),t.ui.ddmanager&&t.ui.ddmanager.dragStop(this,e),this.handleElement.is(e.target)&&this.element.trigger("focus"),t.ui.mouse.prototype._mouseUp.call(this,e)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp(new t.Event("mouseup",{target:this.element[0]})):this._clear(),this},_getHandle:function(e){return this.options.handle?!!t(e.target).closest(this.element.find(this.options.handle)).length:!0},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this._addClass(this.handleElement,"ui-draggable-handle")},_removeHandleClassName:function(){this._removeClass(this.handleElement,"ui-draggable-handle")},_createHelper:function(e){var i=this.options,s=t.isFunction(i.helper),n=s?t(i.helper.apply(this.element[0],[e])):"clone"===i.helper?this.element.clone().removeAttr("id"):this.element;return n.parents("body").length||n.appendTo("parent"===i.appendTo?this.element[0].parentNode:i.appendTo),s&&n[0]===this.element[0]&&this._setPositionRelative(),n[0]===this.element[0]||/(fixed|absolute)/.test(n.css("position"))||n.css("position","absolute"),n},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),t.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_isRootNode:function(t){return/(html|body)/i.test(t.tagName)||t===this.document[0]},_getParentOffset:function(){var e=this.offsetParent.offset(),i=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==i&&t.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var t=this.element.position(),e=this._isRootNode(this.scrollParent[0]);return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+(e?0:this.scrollParent.scrollTop()),left:t.left-(parseInt(this.helper.css("left"),10)||0)+(e?0:this.scrollParent.scrollLeft())}
	},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,i,s,n=this.options,o=this.document[0];return this.relativeContainer=null,n.containment?"window"===n.containment?(this.containment=[t(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,t(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,t(window).scrollLeft()+t(window).width()-this.helperProportions.width-this.margins.left,t(window).scrollTop()+(t(window).height()||o.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top],void 0):"document"===n.containment?(this.containment=[0,0,t(o).width()-this.helperProportions.width-this.margins.left,(t(o).height()||o.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top],void 0):n.containment.constructor===Array?(this.containment=n.containment,void 0):("parent"===n.containment&&(n.containment=this.helper[0].parentNode),i=t(n.containment),s=i[0],s&&(e=/(scroll|auto)/.test(i.css("overflow")),this.containment=[(parseInt(i.css("borderLeftWidth"),10)||0)+(parseInt(i.css("paddingLeft"),10)||0),(parseInt(i.css("borderTopWidth"),10)||0)+(parseInt(i.css("paddingTop"),10)||0),(e?Math.max(s.scrollWidth,s.offsetWidth):s.offsetWidth)-(parseInt(i.css("borderRightWidth"),10)||0)-(parseInt(i.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(e?Math.max(s.scrollHeight,s.offsetHeight):s.offsetHeight)-(parseInt(i.css("borderBottomWidth"),10)||0)-(parseInt(i.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=i),void 0):(this.containment=null,void 0)},_convertPositionTo:function(t,e){e||(e=this.position);var i="absolute"===t?1:-1,s=this._isRootNode(this.scrollParent[0]);return{top:e.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.offset.scroll.top:s?0:this.offset.scroll.top)*i,left:e.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.offset.scroll.left:s?0:this.offset.scroll.left)*i}},_generatePosition:function(t,e){var i,s,n,o,a=this.options,r=this._isRootNode(this.scrollParent[0]),h=t.pageX,l=t.pageY;return r&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),e&&(this.containment&&(this.relativeContainer?(s=this.relativeContainer.offset(),i=[this.containment[0]+s.left,this.containment[1]+s.top,this.containment[2]+s.left,this.containment[3]+s.top]):i=this.containment,t.pageX-this.offset.click.left<i[0]&&(h=i[0]+this.offset.click.left),t.pageY-this.offset.click.top<i[1]&&(l=i[1]+this.offset.click.top),t.pageX-this.offset.click.left>i[2]&&(h=i[2]+this.offset.click.left),t.pageY-this.offset.click.top>i[3]&&(l=i[3]+this.offset.click.top)),a.grid&&(n=a.grid[1]?this.originalPageY+Math.round((l-this.originalPageY)/a.grid[1])*a.grid[1]:this.originalPageY,l=i?n-this.offset.click.top>=i[1]||n-this.offset.click.top>i[3]?n:n-this.offset.click.top>=i[1]?n-a.grid[1]:n+a.grid[1]:n,o=a.grid[0]?this.originalPageX+Math.round((h-this.originalPageX)/a.grid[0])*a.grid[0]:this.originalPageX,h=i?o-this.offset.click.left>=i[0]||o-this.offset.click.left>i[2]?o:o-this.offset.click.left>=i[0]?o-a.grid[0]:o+a.grid[0]:o),"y"===a.axis&&(h=this.originalPageX),"x"===a.axis&&(l=this.originalPageY)),{top:l-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:r?0:this.offset.scroll.top),left:h-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:r?0:this.offset.scroll.left)}},_clear:function(){this._removeClass(this.helper,"ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_trigger:function(e,i,s){return s=s||this._uiHash(),t.ui.plugin.call(this,e,[i,s,this],!0),/^(drag|start|stop)/.test(e)&&(this.positionAbs=this._convertPositionTo("absolute"),s.offset=this.positionAbs),t.Widget.prototype._trigger.call(this,e,i,s)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),t.ui.plugin.add("draggable","connectToSortable",{start:function(e,i,s){var n=t.extend({},i,{item:s.element});s.sortables=[],t(s.options.connectToSortable).each(function(){var i=t(this).sortable("instance");i&&!i.options.disabled&&(s.sortables.push(i),i.refreshPositions(),i._trigger("activate",e,n))})},stop:function(e,i,s){var n=t.extend({},i,{item:s.element});s.cancelHelperRemoval=!1,t.each(s.sortables,function(){var t=this;t.isOver?(t.isOver=0,s.cancelHelperRemoval=!0,t.cancelHelperRemoval=!1,t._storedCSS={position:t.placeholder.css("position"),top:t.placeholder.css("top"),left:t.placeholder.css("left")},t._mouseStop(e),t.options.helper=t.options._helper):(t.cancelHelperRemoval=!0,t._trigger("deactivate",e,n))})},drag:function(e,i,s){t.each(s.sortables,function(){var n=!1,o=this;o.positionAbs=s.positionAbs,o.helperProportions=s.helperProportions,o.offset.click=s.offset.click,o._intersectsWith(o.containerCache)&&(n=!0,t.each(s.sortables,function(){return this.positionAbs=s.positionAbs,this.helperProportions=s.helperProportions,this.offset.click=s.offset.click,this!==o&&this._intersectsWith(this.containerCache)&&t.contains(o.element[0],this.element[0])&&(n=!1),n})),n?(o.isOver||(o.isOver=1,s._parent=i.helper.parent(),o.currentItem=i.helper.appendTo(o.element).data("ui-sortable-item",!0),o.options._helper=o.options.helper,o.options.helper=function(){return i.helper[0]},e.target=o.currentItem[0],o._mouseCapture(e,!0),o._mouseStart(e,!0,!0),o.offset.click.top=s.offset.click.top,o.offset.click.left=s.offset.click.left,o.offset.parent.left-=s.offset.parent.left-o.offset.parent.left,o.offset.parent.top-=s.offset.parent.top-o.offset.parent.top,s._trigger("toSortable",e),s.dropped=o.element,t.each(s.sortables,function(){this.refreshPositions()}),s.currentItem=s.element,o.fromOutside=s),o.currentItem&&(o._mouseDrag(e),i.position=o.position)):o.isOver&&(o.isOver=0,o.cancelHelperRemoval=!0,o.options._revert=o.options.revert,o.options.revert=!1,o._trigger("out",e,o._uiHash(o)),o._mouseStop(e,!0),o.options.revert=o.options._revert,o.options.helper=o.options._helper,o.placeholder&&o.placeholder.remove(),i.helper.appendTo(s._parent),s._refreshOffsets(e),i.position=s._generatePosition(e,!0),s._trigger("fromSortable",e),s.dropped=!1,t.each(s.sortables,function(){this.refreshPositions()}))})}}),t.ui.plugin.add("draggable","cursor",{start:function(e,i,s){var n=t("body"),o=s.options;n.css("cursor")&&(o._cursor=n.css("cursor")),n.css("cursor",o.cursor)},stop:function(e,i,s){var n=s.options;n._cursor&&t("body").css("cursor",n._cursor)}}),t.ui.plugin.add("draggable","opacity",{start:function(e,i,s){var n=t(i.helper),o=s.options;n.css("opacity")&&(o._opacity=n.css("opacity")),n.css("opacity",o.opacity)},stop:function(e,i,s){var n=s.options;n._opacity&&t(i.helper).css("opacity",n._opacity)}}),t.ui.plugin.add("draggable","scroll",{start:function(t,e,i){i.scrollParentNotHidden||(i.scrollParentNotHidden=i.helper.scrollParent(!1)),i.scrollParentNotHidden[0]!==i.document[0]&&"HTML"!==i.scrollParentNotHidden[0].tagName&&(i.overflowOffset=i.scrollParentNotHidden.offset())},drag:function(e,i,s){var n=s.options,o=!1,a=s.scrollParentNotHidden[0],r=s.document[0];a!==r&&"HTML"!==a.tagName?(n.axis&&"x"===n.axis||(s.overflowOffset.top+a.offsetHeight-e.pageY<n.scrollSensitivity?a.scrollTop=o=a.scrollTop+n.scrollSpeed:e.pageY-s.overflowOffset.top<n.scrollSensitivity&&(a.scrollTop=o=a.scrollTop-n.scrollSpeed)),n.axis&&"y"===n.axis||(s.overflowOffset.left+a.offsetWidth-e.pageX<n.scrollSensitivity?a.scrollLeft=o=a.scrollLeft+n.scrollSpeed:e.pageX-s.overflowOffset.left<n.scrollSensitivity&&(a.scrollLeft=o=a.scrollLeft-n.scrollSpeed))):(n.axis&&"x"===n.axis||(e.pageY-t(r).scrollTop()<n.scrollSensitivity?o=t(r).scrollTop(t(r).scrollTop()-n.scrollSpeed):t(window).height()-(e.pageY-t(r).scrollTop())<n.scrollSensitivity&&(o=t(r).scrollTop(t(r).scrollTop()+n.scrollSpeed))),n.axis&&"y"===n.axis||(e.pageX-t(r).scrollLeft()<n.scrollSensitivity?o=t(r).scrollLeft(t(r).scrollLeft()-n.scrollSpeed):t(window).width()-(e.pageX-t(r).scrollLeft())<n.scrollSensitivity&&(o=t(r).scrollLeft(t(r).scrollLeft()+n.scrollSpeed)))),o!==!1&&t.ui.ddmanager&&!n.dropBehaviour&&t.ui.ddmanager.prepareOffsets(s,e)}}),t.ui.plugin.add("draggable","snap",{start:function(e,i,s){var n=s.options;s.snapElements=[],t(n.snap.constructor!==String?n.snap.items||":data(ui-draggable)":n.snap).each(function(){var e=t(this),i=e.offset();this!==s.element[0]&&s.snapElements.push({item:this,width:e.outerWidth(),height:e.outerHeight(),top:i.top,left:i.left})})},drag:function(e,i,s){var n,o,a,r,h,l,c,u,d,p,f=s.options,g=f.snapTolerance,m=i.offset.left,_=m+s.helperProportions.width,v=i.offset.top,b=v+s.helperProportions.height;for(d=s.snapElements.length-1;d>=0;d--)h=s.snapElements[d].left-s.margins.left,l=h+s.snapElements[d].width,c=s.snapElements[d].top-s.margins.top,u=c+s.snapElements[d].height,h-g>_||m>l+g||c-g>b||v>u+g||!t.contains(s.snapElements[d].item.ownerDocument,s.snapElements[d].item)?(s.snapElements[d].snapping&&s.options.snap.release&&s.options.snap.release.call(s.element,e,t.extend(s._uiHash(),{snapItem:s.snapElements[d].item})),s.snapElements[d].snapping=!1):("inner"!==f.snapMode&&(n=g>=Math.abs(c-b),o=g>=Math.abs(u-v),a=g>=Math.abs(h-_),r=g>=Math.abs(l-m),n&&(i.position.top=s._convertPositionTo("relative",{top:c-s.helperProportions.height,left:0}).top),o&&(i.position.top=s._convertPositionTo("relative",{top:u,left:0}).top),a&&(i.position.left=s._convertPositionTo("relative",{top:0,left:h-s.helperProportions.width}).left),r&&(i.position.left=s._convertPositionTo("relative",{top:0,left:l}).left)),p=n||o||a||r,"outer"!==f.snapMode&&(n=g>=Math.abs(c-v),o=g>=Math.abs(u-b),a=g>=Math.abs(h-m),r=g>=Math.abs(l-_),n&&(i.position.top=s._convertPositionTo("relative",{top:c,left:0}).top),o&&(i.position.top=s._convertPositionTo("relative",{top:u-s.helperProportions.height,left:0}).top),a&&(i.position.left=s._convertPositionTo("relative",{top:0,left:h}).left),r&&(i.position.left=s._convertPositionTo("relative",{top:0,left:l-s.helperProportions.width}).left)),!s.snapElements[d].snapping&&(n||o||a||r||p)&&s.options.snap.snap&&s.options.snap.snap.call(s.element,e,t.extend(s._uiHash(),{snapItem:s.snapElements[d].item})),s.snapElements[d].snapping=n||o||a||r||p)}}),t.ui.plugin.add("draggable","stack",{start:function(e,i,s){var n,o=s.options,a=t.makeArray(t(o.stack)).sort(function(e,i){return(parseInt(t(e).css("zIndex"),10)||0)-(parseInt(t(i).css("zIndex"),10)||0)});a.length&&(n=parseInt(t(a[0]).css("zIndex"),10)||0,t(a).each(function(e){t(this).css("zIndex",n+e)}),this.css("zIndex",n+a.length))}}),t.ui.plugin.add("draggable","zIndex",{start:function(e,i,s){var n=t(i.helper),o=s.options;n.css("zIndex")&&(o._zIndex=n.css("zIndex")),n.css("zIndex",o.zIndex)},stop:function(e,i,s){var n=s.options;n._zIndex&&t(i.helper).css("zIndex",n._zIndex)}}),t.ui.draggable,t.widget("ui.resizable",t.ui.mouse,{version:"1.12.1",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,classes:{"ui-resizable-se":"ui-icon ui-icon-gripsmall-diagonal-se"},containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(t){return parseFloat(t)||0},_isNumber:function(t){return!isNaN(parseFloat(t))},_hasScroll:function(e,i){if("hidden"===t(e).css("overflow"))return!1;var s=i&&"left"===i?"scrollLeft":"scrollTop",n=!1;return e[s]>0?!0:(e[s]=1,n=e[s]>0,e[s]=0,n)},_create:function(){var e,i=this.options,s=this;this._addClass("ui-resizable"),t.extend(this,{_aspectRatio:!!i.aspectRatio,aspectRatio:i.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:i.helper||i.ghost||i.animate?i.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/^(canvas|textarea|input|select|button|img)$/i)&&(this.element.wrap(t("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.resizable("instance")),this.elementIsWrapper=!0,e={marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom"),marginLeft:this.originalElement.css("marginLeft")},this.element.css(e),this.originalElement.css("margin",0),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css(e),this._proportionallyResize()),this._setupHandles(),i.autoHide&&t(this.element).on("mouseenter",function(){i.disabled||(s._removeClass("ui-resizable-autohide"),s._handles.show())}).on("mouseleave",function(){i.disabled||s.resizing||(s._addClass("ui-resizable-autohide"),s._handles.hide())}),this._mouseInit()},_destroy:function(){this._mouseDestroy();var e,i=function(e){t(e).removeData("resizable").removeData("ui-resizable").off(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(i(this.element),e=this.element,this.originalElement.css({position:e.css("position"),width:e.outerWidth(),height:e.outerHeight(),top:e.css("top"),left:e.css("left")}).insertAfter(e),e.remove()),this.originalElement.css("resize",this.originalResizeStyle),i(this.originalElement),this},_setOption:function(t,e){switch(this._super(t,e),t){case"handles":this._removeHandles(),this._setupHandles();break;default:}},_setupHandles:function(){var e,i,s,n,o,a=this.options,r=this;if(this.handles=a.handles||(t(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this._handles=t(),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),s=this.handles.split(","),this.handles={},i=0;s.length>i;i++)e=t.trim(s[i]),n="ui-resizable-"+e,o=t("<div>"),this._addClass(o,"ui-resizable-handle "+n),o.css({zIndex:a.zIndex}),this.handles[e]=".ui-resizable-"+e,this.element.append(o);this._renderAxis=function(e){var i,s,n,o;e=e||this.element;for(i in this.handles)this.handles[i].constructor===String?this.handles[i]=this.element.children(this.handles[i]).first().show():(this.handles[i].jquery||this.handles[i].nodeType)&&(this.handles[i]=t(this.handles[i]),this._on(this.handles[i],{mousedown:r._mouseDown})),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/^(textarea|input|select|button)$/i)&&(s=t(this.handles[i],this.element),o=/sw|ne|nw|se|n|s/.test(i)?s.outerHeight():s.outerWidth(),n=["padding",/ne|nw|n/.test(i)?"Top":/se|sw|s/.test(i)?"Bottom":/^e$/.test(i)?"Right":"Left"].join(""),e.css(n,o),this._proportionallyResize()),this._handles=this._handles.add(this.handles[i])},this._renderAxis(this.element),this._handles=this._handles.add(this.element.find(".ui-resizable-handle")),this._handles.disableSelection(),this._handles.on("mouseover",function(){r.resizing||(this.className&&(o=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),r.axis=o&&o[1]?o[1]:"se")}),a.autoHide&&(this._handles.hide(),this._addClass("ui-resizable-autohide"))},_removeHandles:function(){this._handles.remove()},_mouseCapture:function(e){var i,s,n=!1;for(i in this.handles)s=t(this.handles[i])[0],(s===e.target||t.contains(s,e.target))&&(n=!0);return!this.options.disabled&&n},_mouseStart:function(e){var i,s,n,o=this.options,a=this.element;return this.resizing=!0,this._renderProxy(),i=this._num(this.helper.css("left")),s=this._num(this.helper.css("top")),o.containment&&(i+=t(o.containment).scrollLeft()||0,s+=t(o.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:i,top:s},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:a.width(),height:a.height()},this.originalSize=this._helper?{width:a.outerWidth(),height:a.outerHeight()}:{width:a.width(),height:a.height()},this.sizeDiff={width:a.outerWidth()-a.width(),height:a.outerHeight()-a.height()},this.originalPosition={left:i,top:s},this.originalMousePosition={left:e.pageX,top:e.pageY},this.aspectRatio="number"==typeof o.aspectRatio?o.aspectRatio:this.originalSize.width/this.originalSize.height||1,n=t(".ui-resizable-"+this.axis).css("cursor"),t("body").css("cursor","auto"===n?this.axis+"-resize":n),this._addClass("ui-resizable-resizing"),this._propagate("start",e),!0},_mouseDrag:function(e){var i,s,n=this.originalMousePosition,o=this.axis,a=e.pageX-n.left||0,r=e.pageY-n.top||0,h=this._change[o];return this._updatePrevProperties(),h?(i=h.apply(this,[e,a,r]),this._updateVirtualBoundaries(e.shiftKey),(this._aspectRatio||e.shiftKey)&&(i=this._updateRatio(i,e)),i=this._respectSize(i,e),this._updateCache(i),this._propagate("resize",e),s=this._applyChanges(),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),t.isEmptyObject(s)||(this._updatePrevProperties(),this._trigger("resize",e,this.ui()),this._applyChanges()),!1):!1},_mouseStop:function(e){this.resizing=!1;var i,s,n,o,a,r,h,l=this.options,c=this;return this._helper&&(i=this._proportionallyResizeElements,s=i.length&&/textarea/i.test(i[0].nodeName),n=s&&this._hasScroll(i[0],"left")?0:c.sizeDiff.height,o=s?0:c.sizeDiff.width,a={width:c.helper.width()-o,height:c.helper.height()-n},r=parseFloat(c.element.css("left"))+(c.position.left-c.originalPosition.left)||null,h=parseFloat(c.element.css("top"))+(c.position.top-c.originalPosition.top)||null,l.animate||this.element.css(t.extend(a,{top:h,left:r})),c.helper.height(c.size.height),c.helper.width(c.size.width),this._helper&&!l.animate&&this._proportionallyResize()),t("body").css("cursor","auto"),this._removeClass("ui-resizable-resizing"),this._propagate("stop",e),this._helper&&this.helper.remove(),!1},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,left:this.position.left},this.prevSize={width:this.size.width,height:this.size.height}},_applyChanges:function(){var t={};return this.position.top!==this.prevPosition.top&&(t.top=this.position.top+"px"),this.position.left!==this.prevPosition.left&&(t.left=this.position.left+"px"),this.size.width!==this.prevSize.width&&(t.width=this.size.width+"px"),this.size.height!==this.prevSize.height&&(t.height=this.size.height+"px"),this.helper.css(t),t},_updateVirtualBoundaries:function(t){var e,i,s,n,o,a=this.options;o={minWidth:this._isNumber(a.minWidth)?a.minWidth:0,maxWidth:this._isNumber(a.maxWidth)?a.maxWidth:1/0,minHeight:this._isNumber(a.minHeight)?a.minHeight:0,maxHeight:this._isNumber(a.maxHeight)?a.maxHeight:1/0},(this._aspectRatio||t)&&(e=o.minHeight*this.aspectRatio,s=o.minWidth/this.aspectRatio,i=o.maxHeight*this.aspectRatio,n=o.maxWidth/this.aspectRatio,e>o.minWidth&&(o.minWidth=e),s>o.minHeight&&(o.minHeight=s),o.maxWidth>i&&(o.maxWidth=i),o.maxHeight>n&&(o.maxHeight=n)),this._vBoundaries=o},_updateCache:function(t){this.offset=this.helper.offset(),this._isNumber(t.left)&&(this.position.left=t.left),this._isNumber(t.top)&&(this.position.top=t.top),this._isNumber(t.height)&&(this.size.height=t.height),this._isNumber(t.width)&&(this.size.width=t.width)},_updateRatio:function(t){var e=this.position,i=this.size,s=this.axis;return this._isNumber(t.height)?t.width=t.height*this.aspectRatio:this._isNumber(t.width)&&(t.height=t.width/this.aspectRatio),"sw"===s&&(t.left=e.left+(i.width-t.width),t.top=null),"nw"===s&&(t.top=e.top+(i.height-t.height),t.left=e.left+(i.width-t.width)),t},_respectSize:function(t){var e=this._vBoundaries,i=this.axis,s=this._isNumber(t.width)&&e.maxWidth&&e.maxWidth<t.width,n=this._isNumber(t.height)&&e.maxHeight&&e.maxHeight<t.height,o=this._isNumber(t.width)&&e.minWidth&&e.minWidth>t.width,a=this._isNumber(t.height)&&e.minHeight&&e.minHeight>t.height,r=this.originalPosition.left+this.originalSize.width,h=this.originalPosition.top+this.originalSize.height,l=/sw|nw|w/.test(i),c=/nw|ne|n/.test(i);return o&&(t.width=e.minWidth),a&&(t.height=e.minHeight),s&&(t.width=e.maxWidth),n&&(t.height=e.maxHeight),o&&l&&(t.left=r-e.minWidth),s&&l&&(t.left=r-e.maxWidth),a&&c&&(t.top=h-e.minHeight),n&&c&&(t.top=h-e.maxHeight),t.width||t.height||t.left||!t.top?t.width||t.height||t.top||!t.left||(t.left=null):t.top=null,t},_getPaddingPlusBorderDimensions:function(t){for(var e=0,i=[],s=[t.css("borderTopWidth"),t.css("borderRightWidth"),t.css("borderBottomWidth"),t.css("borderLeftWidth")],n=[t.css("paddingTop"),t.css("paddingRight"),t.css("paddingBottom"),t.css("paddingLeft")];4>e;e++)i[e]=parseFloat(s[e])||0,i[e]+=parseFloat(n[e])||0;return{height:i[0]+i[2],width:i[1]+i[3]}},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var t,e=0,i=this.helper||this.element;this._proportionallyResizeElements.length>e;e++)t=this._proportionallyResizeElements[e],this.outerDimensions||(this.outerDimensions=this._getPaddingPlusBorderDimensions(t)),t.css({height:i.height()-this.outerDimensions.height||0,width:i.width()-this.outerDimensions.width||0})},_renderProxy:function(){var e=this.element,i=this.options;this.elementOffset=e.offset(),this._helper?(this.helper=this.helper||t("<div style='overflow:hidden;'></div>"),this._addClass(this.helper,this._helper),this.helper.css({width:this.element.outerWidth(),height:this.element.outerHeight(),position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++i.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(t,e){return{width:this.originalSize.width+e}},w:function(t,e){var i=this.originalSize,s=this.originalPosition;return{left:s.left+e,width:i.width-e}},n:function(t,e,i){var s=this.originalSize,n=this.originalPosition;return{top:n.top+i,height:s.height-i}},s:function(t,e,i){return{height:this.originalSize.height+i}},se:function(e,i,s){return t.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[e,i,s]))},sw:function(e,i,s){return t.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[e,i,s]))},ne:function(e,i,s){return t.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[e,i,s]))},nw:function(e,i,s){return t.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[e,i,s]))}},_propagate:function(e,i){t.ui.plugin.call(this,e,[i,this.ui()]),"resize"!==e&&this._trigger(e,i,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),t.ui.plugin.add("resizable","animate",{stop:function(e){var i=t(this).resizable("instance"),s=i.options,n=i._proportionallyResizeElements,o=n.length&&/textarea/i.test(n[0].nodeName),a=o&&i._hasScroll(n[0],"left")?0:i.sizeDiff.height,r=o?0:i.sizeDiff.width,h={width:i.size.width-r,height:i.size.height-a},l=parseFloat(i.element.css("left"))+(i.position.left-i.originalPosition.left)||null,c=parseFloat(i.element.css("top"))+(i.position.top-i.originalPosition.top)||null;i.element.animate(t.extend(h,c&&l?{top:c,left:l}:{}),{duration:s.animateDuration,easing:s.animateEasing,step:function(){var s={width:parseFloat(i.element.css("width")),height:parseFloat(i.element.css("height")),top:parseFloat(i.element.css("top")),left:parseFloat(i.element.css("left"))};n&&n.length&&t(n[0]).css({width:s.width,height:s.height}),i._updateCache(s),i._propagate("resize",e)}})}}),t.ui.plugin.add("resizable","containment",{start:function(){var e,i,s,n,o,a,r,h=t(this).resizable("instance"),l=h.options,c=h.element,u=l.containment,d=u instanceof t?u.get(0):/parent/.test(u)?c.parent().get(0):u;d&&(h.containerElement=t(d),/document/.test(u)||u===document?(h.containerOffset={left:0,top:0},h.containerPosition={left:0,top:0},h.parentData={element:t(document),left:0,top:0,width:t(document).width(),height:t(document).height()||document.body.parentNode.scrollHeight}):(e=t(d),i=[],t(["Top","Right","Left","Bottom"]).each(function(t,s){i[t]=h._num(e.css("padding"+s))}),h.containerOffset=e.offset(),h.containerPosition=e.position(),h.containerSize={height:e.innerHeight()-i[3],width:e.innerWidth()-i[1]},s=h.containerOffset,n=h.containerSize.height,o=h.containerSize.width,a=h._hasScroll(d,"left")?d.scrollWidth:o,r=h._hasScroll(d)?d.scrollHeight:n,h.parentData={element:d,left:s.left,top:s.top,width:a,height:r}))},resize:function(e){var i,s,n,o,a=t(this).resizable("instance"),r=a.options,h=a.containerOffset,l=a.position,c=a._aspectRatio||e.shiftKey,u={top:0,left:0},d=a.containerElement,p=!0;d[0]!==document&&/static/.test(d.css("position"))&&(u=h),l.left<(a._helper?h.left:0)&&(a.size.width=a.size.width+(a._helper?a.position.left-h.left:a.position.left-u.left),c&&(a.size.height=a.size.width/a.aspectRatio,p=!1),a.position.left=r.helper?h.left:0),l.top<(a._helper?h.top:0)&&(a.size.height=a.size.height+(a._helper?a.position.top-h.top:a.position.top),c&&(a.size.width=a.size.height*a.aspectRatio,p=!1),a.position.top=a._helper?h.top:0),n=a.containerElement.get(0)===a.element.parent().get(0),o=/relative|absolute/.test(a.containerElement.css("position")),n&&o?(a.offset.left=a.parentData.left+a.position.left,a.offset.top=a.parentData.top+a.position.top):(a.offset.left=a.element.offset().left,a.offset.top=a.element.offset().top),i=Math.abs(a.sizeDiff.width+(a._helper?a.offset.left-u.left:a.offset.left-h.left)),s=Math.abs(a.sizeDiff.height+(a._helper?a.offset.top-u.top:a.offset.top-h.top)),i+a.size.width>=a.parentData.width&&(a.size.width=a.parentData.width-i,c&&(a.size.height=a.size.width/a.aspectRatio,p=!1)),s+a.size.height>=a.parentData.height&&(a.size.height=a.parentData.height-s,c&&(a.size.width=a.size.height*a.aspectRatio,p=!1)),p||(a.position.left=a.prevPosition.left,a.position.top=a.prevPosition.top,a.size.width=a.prevSize.width,a.size.height=a.prevSize.height)},stop:function(){var e=t(this).resizable("instance"),i=e.options,s=e.containerOffset,n=e.containerPosition,o=e.containerElement,a=t(e.helper),r=a.offset(),h=a.outerWidth()-e.sizeDiff.width,l=a.outerHeight()-e.sizeDiff.height;e._helper&&!i.animate&&/relative/.test(o.css("position"))&&t(this).css({left:r.left-n.left-s.left,width:h,height:l}),e._helper&&!i.animate&&/static/.test(o.css("position"))&&t(this).css({left:r.left-n.left-s.left,width:h,height:l})}}),t.ui.plugin.add("resizable","alsoResize",{start:function(){var e=t(this).resizable("instance"),i=e.options;t(i.alsoResize).each(function(){var e=t(this);e.data("ui-resizable-alsoresize",{width:parseFloat(e.width()),height:parseFloat(e.height()),left:parseFloat(e.css("left")),top:parseFloat(e.css("top"))})})},resize:function(e,i){var s=t(this).resizable("instance"),n=s.options,o=s.originalSize,a=s.originalPosition,r={height:s.size.height-o.height||0,width:s.size.width-o.width||0,top:s.position.top-a.top||0,left:s.position.left-a.left||0};t(n.alsoResize).each(function(){var e=t(this),s=t(this).data("ui-resizable-alsoresize"),n={},o=e.parents(i.originalElement[0]).length?["width","height"]:["width","height","top","left"];t.each(o,function(t,e){var i=(s[e]||0)+(r[e]||0);i&&i>=0&&(n[e]=i||null)}),e.css(n)})},stop:function(){t(this).removeData("ui-resizable-alsoresize")}}),t.ui.plugin.add("resizable","ghost",{start:function(){var e=t(this).resizable("instance"),i=e.size;e.ghost=e.originalElement.clone(),e.ghost.css({opacity:.25,display:"block",position:"relative",height:i.height,width:i.width,margin:0,left:0,top:0}),e._addClass(e.ghost,"ui-resizable-ghost"),t.uiBackCompat!==!1&&"string"==typeof e.options.ghost&&e.ghost.addClass(this.options.ghost),e.ghost.appendTo(e.helper)},resize:function(){var e=t(this).resizable("instance");e.ghost&&e.ghost.css({position:"relative",height:e.size.height,width:e.size.width})},stop:function(){var e=t(this).resizable("instance");e.ghost&&e.helper&&e.helper.get(0).removeChild(e.ghost.get(0))}}),t.ui.plugin.add("resizable","grid",{resize:function(){var e,i=t(this).resizable("instance"),s=i.options,n=i.size,o=i.originalSize,a=i.originalPosition,r=i.axis,h="number"==typeof s.grid?[s.grid,s.grid]:s.grid,l=h[0]||1,c=h[1]||1,u=Math.round((n.width-o.width)/l)*l,d=Math.round((n.height-o.height)/c)*c,p=o.width+u,f=o.height+d,g=s.maxWidth&&p>s.maxWidth,m=s.maxHeight&&f>s.maxHeight,_=s.minWidth&&s.minWidth>p,v=s.minHeight&&s.minHeight>f;s.grid=h,_&&(p+=l),v&&(f+=c),g&&(p-=l),m&&(f-=c),/^(se|s|e)$/.test(r)?(i.size.width=p,i.size.height=f):/^(ne)$/.test(r)?(i.size.width=p,i.size.height=f,i.position.top=a.top-d):/^(sw)$/.test(r)?(i.size.width=p,i.size.height=f,i.position.left=a.left-u):((0>=f-c||0>=p-l)&&(e=i._getPaddingPlusBorderDimensions(this)),f-c>0?(i.size.height=f,i.position.top=a.top-d):(f=c-e.height,i.size.height=f,i.position.top=a.top+o.height-f),p-l>0?(i.size.width=p,i.position.left=a.left-u):(p=l-e.width,i.size.width=p,i.position.left=a.left+o.width-p))}}),t.ui.resizable,t.widget("ui.dialog",{version:"1.12.1",options:{appendTo:"body",autoOpen:!0,buttons:[],classes:{"ui-dialog":"ui-corner-all","ui-dialog-titlebar":"ui-corner-all"},closeOnEscape:!0,closeText:"Close",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(e){var i=t(this).css(e).offset().top;0>i&&t(this).css("top",e.top-i)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},sizeRelatedOptions:{buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},resizableRelatedOptions:{maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),null==this.options.title&&null!=this.originalTitle&&(this.options.title=this.originalTitle),this.options.disabled&&(this.options.disabled=!1),this._createWrapper(),this.element.show().removeAttr("title").appendTo(this.uiDialog),this._addClass("ui-dialog-content","ui-widget-content"),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&t.fn.draggable&&this._makeDraggable(),this.options.resizable&&t.fn.resizable&&this._makeResizable(),this._isOpen=!1,this._trackFocus()},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var e=this.options.appendTo;return e&&(e.jquery||e.nodeType)?t(e):this.document.find(e||"body").eq(0)},_destroy:function(){var t,e=this.originalPosition;this._untrackInstance(),this._destroyOverlay(),this.element.removeUniqueId().css(this.originalCss).detach(),this.uiDialog.remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),t=e.parent.children().eq(e.index),t.length&&t[0]!==this.element[0]?t.before(this.element):e.parent.append(this.element)},widget:function(){return this.uiDialog
	},disable:t.noop,enable:t.noop,close:function(e){var i=this;this._isOpen&&this._trigger("beforeClose",e)!==!1&&(this._isOpen=!1,this._focusedElement=null,this._destroyOverlay(),this._untrackInstance(),this.opener.filter(":focusable").trigger("focus").length||t.ui.safeBlur(t.ui.safeActiveElement(this.document[0])),this._hide(this.uiDialog,this.options.hide,function(){i._trigger("close",e)}))},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(e,i){var s=!1,n=this.uiDialog.siblings(".ui-front:visible").map(function(){return+t(this).css("z-index")}).get(),o=Math.max.apply(null,n);return o>=+this.uiDialog.css("z-index")&&(this.uiDialog.css("z-index",o+1),s=!0),s&&!i&&this._trigger("focus",e),s},open:function(){var e=this;return this._isOpen?(this._moveToTop()&&this._focusTabbable(),void 0):(this._isOpen=!0,this.opener=t(t.ui.safeActiveElement(this.document[0])),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this.overlay&&this.overlay.css("z-index",this.uiDialog.css("z-index")-1),this._show(this.uiDialog,this.options.show,function(){e._focusTabbable(),e._trigger("focus")}),this._makeFocusTarget(),this._trigger("open"),void 0)},_focusTabbable:function(){var t=this._focusedElement;t||(t=this.element.find("[autofocus]")),t.length||(t=this.element.find(":tabbable")),t.length||(t=this.uiDialogButtonPane.find(":tabbable")),t.length||(t=this.uiDialogTitlebarClose.filter(":tabbable")),t.length||(t=this.uiDialog),t.eq(0).trigger("focus")},_keepFocus:function(e){function i(){var e=t.ui.safeActiveElement(this.document[0]),i=this.uiDialog[0]===e||t.contains(this.uiDialog[0],e);i||this._focusTabbable()}e.preventDefault(),i.call(this),this._delay(i)},_createWrapper:function(){this.uiDialog=t("<div>").hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo()),this._addClass(this.uiDialog,"ui-dialog","ui-widget ui-widget-content ui-front"),this._on(this.uiDialog,{keydown:function(e){if(this.options.closeOnEscape&&!e.isDefaultPrevented()&&e.keyCode&&e.keyCode===t.ui.keyCode.ESCAPE)return e.preventDefault(),this.close(e),void 0;if(e.keyCode===t.ui.keyCode.TAB&&!e.isDefaultPrevented()){var i=this.uiDialog.find(":tabbable"),s=i.filter(":first"),n=i.filter(":last");e.target!==n[0]&&e.target!==this.uiDialog[0]||e.shiftKey?e.target!==s[0]&&e.target!==this.uiDialog[0]||!e.shiftKey||(this._delay(function(){n.trigger("focus")}),e.preventDefault()):(this._delay(function(){s.trigger("focus")}),e.preventDefault())}},mousedown:function(t){this._moveToTop(t)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var e;this.uiDialogTitlebar=t("<div>"),this._addClass(this.uiDialogTitlebar,"ui-dialog-titlebar","ui-widget-header ui-helper-clearfix"),this._on(this.uiDialogTitlebar,{mousedown:function(e){t(e.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.trigger("focus")}}),this.uiDialogTitlebarClose=t("<button type='button'></button>").button({label:t("<a>").text(this.options.closeText).html(),icon:"ui-icon-closethick",showLabel:!1}).appendTo(this.uiDialogTitlebar),this._addClass(this.uiDialogTitlebarClose,"ui-dialog-titlebar-close"),this._on(this.uiDialogTitlebarClose,{click:function(t){t.preventDefault(),this.close(t)}}),e=t("<span>").uniqueId().prependTo(this.uiDialogTitlebar),this._addClass(e,"ui-dialog-title"),this._title(e),this.uiDialogTitlebar.prependTo(this.uiDialog),this.uiDialog.attr({"aria-labelledby":e.attr("id")})},_title:function(t){this.options.title?t.text(this.options.title):t.html("&#160;")},_createButtonPane:function(){this.uiDialogButtonPane=t("<div>"),this._addClass(this.uiDialogButtonPane,"ui-dialog-buttonpane","ui-widget-content ui-helper-clearfix"),this.uiButtonSet=t("<div>").appendTo(this.uiDialogButtonPane),this._addClass(this.uiButtonSet,"ui-dialog-buttonset"),this._createButtons()},_createButtons:function(){var e=this,i=this.options.buttons;return this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),t.isEmptyObject(i)||t.isArray(i)&&!i.length?(this._removeClass(this.uiDialog,"ui-dialog-buttons"),void 0):(t.each(i,function(i,s){var n,o;s=t.isFunction(s)?{click:s,text:i}:s,s=t.extend({type:"button"},s),n=s.click,o={icon:s.icon,iconPosition:s.iconPosition,showLabel:s.showLabel,icons:s.icons,text:s.text},delete s.click,delete s.icon,delete s.iconPosition,delete s.showLabel,delete s.icons,"boolean"==typeof s.text&&delete s.text,t("<button></button>",s).button(o).appendTo(e.uiButtonSet).on("click",function(){n.apply(e.element[0],arguments)})}),this._addClass(this.uiDialog,"ui-dialog-buttons"),this.uiDialogButtonPane.appendTo(this.uiDialog),void 0)},_makeDraggable:function(){function e(t){return{position:t.position,offset:t.offset}}var i=this,s=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(s,n){i._addClass(t(this),"ui-dialog-dragging"),i._blockFrames(),i._trigger("dragStart",s,e(n))},drag:function(t,s){i._trigger("drag",t,e(s))},stop:function(n,o){var a=o.offset.left-i.document.scrollLeft(),r=o.offset.top-i.document.scrollTop();s.position={my:"left top",at:"left"+(a>=0?"+":"")+a+" "+"top"+(r>=0?"+":"")+r,of:i.window},i._removeClass(t(this),"ui-dialog-dragging"),i._unblockFrames(),i._trigger("dragStop",n,e(o))}})},_makeResizable:function(){function e(t){return{originalPosition:t.originalPosition,originalSize:t.originalSize,position:t.position,size:t.size}}var i=this,s=this.options,n=s.resizable,o=this.uiDialog.css("position"),a="string"==typeof n?n:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:s.maxWidth,maxHeight:s.maxHeight,minWidth:s.minWidth,minHeight:this._minHeight(),handles:a,start:function(s,n){i._addClass(t(this),"ui-dialog-resizing"),i._blockFrames(),i._trigger("resizeStart",s,e(n))},resize:function(t,s){i._trigger("resize",t,e(s))},stop:function(n,o){var a=i.uiDialog.offset(),r=a.left-i.document.scrollLeft(),h=a.top-i.document.scrollTop();s.height=i.uiDialog.height(),s.width=i.uiDialog.width(),s.position={my:"left top",at:"left"+(r>=0?"+":"")+r+" "+"top"+(h>=0?"+":"")+h,of:i.window},i._removeClass(t(this),"ui-dialog-resizing"),i._unblockFrames(),i._trigger("resizeStop",n,e(o))}}).css("position",o)},_trackFocus:function(){this._on(this.widget(),{focusin:function(e){this._makeFocusTarget(),this._focusedElement=t(e.target)}})},_makeFocusTarget:function(){this._untrackInstance(),this._trackingInstances().unshift(this)},_untrackInstance:function(){var e=this._trackingInstances(),i=t.inArray(this,e);-1!==i&&e.splice(i,1)},_trackingInstances:function(){var t=this.document.data("ui-dialog-instances");return t||(t=[],this.document.data("ui-dialog-instances",t)),t},_minHeight:function(){var t=this.options;return"auto"===t.height?t.minHeight:Math.min(t.minHeight,t.height)},_position:function(){var t=this.uiDialog.is(":visible");t||this.uiDialog.show(),this.uiDialog.position(this.options.position),t||this.uiDialog.hide()},_setOptions:function(e){var i=this,s=!1,n={};t.each(e,function(t,e){i._setOption(t,e),t in i.sizeRelatedOptions&&(s=!0),t in i.resizableRelatedOptions&&(n[t]=e)}),s&&(this._size(),this._position()),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",n)},_setOption:function(e,i){var s,n,o=this.uiDialog;"disabled"!==e&&(this._super(e,i),"appendTo"===e&&this.uiDialog.appendTo(this._appendTo()),"buttons"===e&&this._createButtons(),"closeText"===e&&this.uiDialogTitlebarClose.button({label:t("<a>").text(""+this.options.closeText).html()}),"draggable"===e&&(s=o.is(":data(ui-draggable)"),s&&!i&&o.draggable("destroy"),!s&&i&&this._makeDraggable()),"position"===e&&this._position(),"resizable"===e&&(n=o.is(":data(ui-resizable)"),n&&!i&&o.resizable("destroy"),n&&"string"==typeof i&&o.resizable("option","handles",i),n||i===!1||this._makeResizable()),"title"===e&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))},_size:function(){var t,e,i,s=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),s.minWidth>s.width&&(s.width=s.minWidth),t=this.uiDialog.css({height:"auto",width:s.width}).outerHeight(),e=Math.max(0,s.minHeight-t),i="number"==typeof s.maxHeight?Math.max(0,s.maxHeight-t):"none","auto"===s.height?this.element.css({minHeight:e,maxHeight:i,height:"auto"}):this.element.height(Math.max(0,s.height-t)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var e=t(this);return t("<div>").css({position:"absolute",width:e.outerWidth(),height:e.outerHeight()}).appendTo(e.parent()).offset(e.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(e){return t(e.target).closest(".ui-dialog").length?!0:!!t(e.target).closest(".ui-datepicker").length},_createOverlay:function(){if(this.options.modal){var e=!0;this._delay(function(){e=!1}),this.document.data("ui-dialog-overlays")||this._on(this.document,{focusin:function(t){e||this._allowInteraction(t)||(t.preventDefault(),this._trackingInstances()[0]._focusTabbable())}}),this.overlay=t("<div>").appendTo(this._appendTo()),this._addClass(this.overlay,null,"ui-widget-overlay ui-front"),this._on(this.overlay,{mousedown:"_keepFocus"}),this.document.data("ui-dialog-overlays",(this.document.data("ui-dialog-overlays")||0)+1)}},_destroyOverlay:function(){if(this.options.modal&&this.overlay){var t=this.document.data("ui-dialog-overlays")-1;t?this.document.data("ui-dialog-overlays",t):(this._off(this.document,"focusin"),this.document.removeData("ui-dialog-overlays")),this.overlay.remove(),this.overlay=null}}}),t.uiBackCompat!==!1&&t.widget("ui.dialog",t.ui.dialog,{options:{dialogClass:""},_createWrapper:function(){this._super(),this.uiDialog.addClass(this.options.dialogClass)},_setOption:function(t,e){"dialogClass"===t&&this.uiDialog.removeClass(this.options.dialogClass).addClass(e),this._superApply(arguments)}}),t.ui.dialog,t.widget("ui.droppable",{version:"1.12.1",widgetEventPrefix:"drop",options:{accept:"*",addClasses:!0,greedy:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var e,i=this.options,s=i.accept;this.isover=!1,this.isout=!0,this.accept=t.isFunction(s)?s:function(t){return t.is(s)},this.proportions=function(){return arguments.length?(e=arguments[0],void 0):e?e:e={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight}},this._addToManager(i.scope),i.addClasses&&this._addClass("ui-droppable")},_addToManager:function(e){t.ui.ddmanager.droppables[e]=t.ui.ddmanager.droppables[e]||[],t.ui.ddmanager.droppables[e].push(this)},_splice:function(t){for(var e=0;t.length>e;e++)t[e]===this&&t.splice(e,1)},_destroy:function(){var e=t.ui.ddmanager.droppables[this.options.scope];this._splice(e)},_setOption:function(e,i){if("accept"===e)this.accept=t.isFunction(i)?i:function(t){return t.is(i)};else if("scope"===e){var s=t.ui.ddmanager.droppables[this.options.scope];this._splice(s),this._addToManager(i)}this._super(e,i)},_activate:function(e){var i=t.ui.ddmanager.current;this._addActiveClass(),i&&this._trigger("activate",e,this.ui(i))},_deactivate:function(e){var i=t.ui.ddmanager.current;this._removeActiveClass(),i&&this._trigger("deactivate",e,this.ui(i))},_over:function(e){var i=t.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this._addHoverClass(),this._trigger("over",e,this.ui(i)))},_out:function(e){var i=t.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this._removeHoverClass(),this._trigger("out",e,this.ui(i)))},_drop:function(e,i){var s=i||t.ui.ddmanager.current,n=!1;return s&&(s.currentItem||s.element)[0]!==this.element[0]?(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var i=t(this).droppable("instance");return i.options.greedy&&!i.options.disabled&&i.options.scope===s.options.scope&&i.accept.call(i.element[0],s.currentItem||s.element)&&v(s,t.extend(i,{offset:i.element.offset()}),i.options.tolerance,e)?(n=!0,!1):void 0}),n?!1:this.accept.call(this.element[0],s.currentItem||s.element)?(this._removeActiveClass(),this._removeHoverClass(),this._trigger("drop",e,this.ui(s)),this.element):!1):!1},ui:function(t){return{draggable:t.currentItem||t.element,helper:t.helper,position:t.position,offset:t.positionAbs}},_addHoverClass:function(){this._addClass("ui-droppable-hover")},_removeHoverClass:function(){this._removeClass("ui-droppable-hover")},_addActiveClass:function(){this._addClass("ui-droppable-active")},_removeActiveClass:function(){this._removeClass("ui-droppable-active")}});var v=t.ui.intersect=function(){function t(t,e,i){return t>=e&&e+i>t}return function(e,i,s,n){if(!i.offset)return!1;var o=(e.positionAbs||e.position.absolute).left+e.margins.left,a=(e.positionAbs||e.position.absolute).top+e.margins.top,r=o+e.helperProportions.width,h=a+e.helperProportions.height,l=i.offset.left,c=i.offset.top,u=l+i.proportions().width,d=c+i.proportions().height;switch(s){case"fit":return o>=l&&u>=r&&a>=c&&d>=h;case"intersect":return o+e.helperProportions.width/2>l&&u>r-e.helperProportions.width/2&&a+e.helperProportions.height/2>c&&d>h-e.helperProportions.height/2;case"pointer":return t(n.pageY,c,i.proportions().height)&&t(n.pageX,l,i.proportions().width);case"touch":return(a>=c&&d>=a||h>=c&&d>=h||c>a&&h>d)&&(o>=l&&u>=o||r>=l&&u>=r||l>o&&r>u);default:return!1}}}();t.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(e,i){var s,n,o=t.ui.ddmanager.droppables[e.options.scope]||[],a=i?i.type:null,r=(e.currentItem||e.element).find(":data(ui-droppable)").addBack();t:for(s=0;o.length>s;s++)if(!(o[s].options.disabled||e&&!o[s].accept.call(o[s].element[0],e.currentItem||e.element))){for(n=0;r.length>n;n++)if(r[n]===o[s].element[0]){o[s].proportions().height=0;continue t}o[s].visible="none"!==o[s].element.css("display"),o[s].visible&&("mousedown"===a&&o[s]._activate.call(o[s],i),o[s].offset=o[s].element.offset(),o[s].proportions({width:o[s].element[0].offsetWidth,height:o[s].element[0].offsetHeight}))}},drop:function(e,i){var s=!1;return t.each((t.ui.ddmanager.droppables[e.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&v(e,this,this.options.tolerance,i)&&(s=this._drop.call(this,i)||s),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],e.currentItem||e.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,i)))}),s},dragStart:function(e,i){e.element.parentsUntil("body").on("scroll.droppable",function(){e.options.refreshPositions||t.ui.ddmanager.prepareOffsets(e,i)})},drag:function(e,i){e.options.refreshPositions&&t.ui.ddmanager.prepareOffsets(e,i),t.each(t.ui.ddmanager.droppables[e.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var s,n,o,a=v(e,this,this.options.tolerance,i),r=!a&&this.isover?"isout":a&&!this.isover?"isover":null;r&&(this.options.greedy&&(n=this.options.scope,o=this.element.parents(":data(ui-droppable)").filter(function(){return t(this).droppable("instance").options.scope===n}),o.length&&(s=t(o[0]).droppable("instance"),s.greedyChild="isover"===r)),s&&"isover"===r&&(s.isover=!1,s.isout=!0,s._out.call(s,i)),this[r]=!0,this["isout"===r?"isover":"isout"]=!1,this["isover"===r?"_over":"_out"].call(this,i),s&&"isout"===r&&(s.isout=!1,s.isover=!0,s._over.call(s,i)))}})},dragStop:function(e,i){e.element.parentsUntil("body").off("scroll.droppable"),e.options.refreshPositions||t.ui.ddmanager.prepareOffsets(e,i)}},t.uiBackCompat!==!1&&t.widget("ui.droppable",t.ui.droppable,{options:{hoverClass:!1,activeClass:!1},_addActiveClass:function(){this._super(),this.options.activeClass&&this.element.addClass(this.options.activeClass)},_removeActiveClass:function(){this._super(),this.options.activeClass&&this.element.removeClass(this.options.activeClass)},_addHoverClass:function(){this._super(),this.options.hoverClass&&this.element.addClass(this.options.hoverClass)},_removeHoverClass:function(){this._super(),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass)}}),t.ui.droppable,t.widget("ui.progressbar",{version:"1.12.1",options:{classes:{"ui-progressbar":"ui-corner-all","ui-progressbar-value":"ui-corner-left","ui-progressbar-complete":"ui-corner-right"},max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue(),this.element.attr({role:"progressbar","aria-valuemin":this.min}),this._addClass("ui-progressbar","ui-widget ui-widget-content"),this.valueDiv=t("<div>").appendTo(this.element),this._addClass(this.valueDiv,"ui-progressbar-value","ui-widget-header"),this._refreshValue()},_destroy:function(){this.element.removeAttr("role aria-valuemin aria-valuemax aria-valuenow"),this.valueDiv.remove()},value:function(t){return void 0===t?this.options.value:(this.options.value=this._constrainedValue(t),this._refreshValue(),void 0)},_constrainedValue:function(t){return void 0===t&&(t=this.options.value),this.indeterminate=t===!1,"number"!=typeof t&&(t=0),this.indeterminate?!1:Math.min(this.options.max,Math.max(this.min,t))},_setOptions:function(t){var e=t.value;delete t.value,this._super(t),this.options.value=this._constrainedValue(e),this._refreshValue()},_setOption:function(t,e){"max"===t&&(e=Math.max(this.min,e)),this._super(t,e)},_setOptionDisabled:function(t){this._super(t),this.element.attr("aria-disabled",t),this._toggleClass(null,"ui-state-disabled",!!t)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var e=this.options.value,i=this._percentage();this.valueDiv.toggle(this.indeterminate||e>this.min).width(i.toFixed(0)+"%"),this._toggleClass(this.valueDiv,"ui-progressbar-complete",null,e===this.options.max)._toggleClass("ui-progressbar-indeterminate",null,this.indeterminate),this.indeterminate?(this.element.removeAttr("aria-valuenow"),this.overlayDiv||(this.overlayDiv=t("<div>").appendTo(this.valueDiv),this._addClass(this.overlayDiv,"ui-progressbar-overlay"))):(this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":e}),this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null)),this.oldValue!==e&&(this.oldValue=e,this._trigger("change")),e===this.options.max&&this._trigger("complete")}}),t.widget("ui.selectable",t.ui.mouse,{version:"1.12.1",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var e=this;this._addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){e.elementPos=t(e.element[0]).offset(),e.selectees=t(e.options.filter,e.element[0]),e._addClass(e.selectees,"ui-selectee"),e.selectees.each(function(){var i=t(this),s=i.offset(),n={left:s.left-e.elementPos.left,top:s.top-e.elementPos.top};t.data(this,"selectable-item",{element:this,$element:i,left:n.left,top:n.top,right:n.left+i.outerWidth(),bottom:n.top+i.outerHeight(),startselected:!1,selected:i.hasClass("ui-selected"),selecting:i.hasClass("ui-selecting"),unselecting:i.hasClass("ui-unselecting")})})},this.refresh(),this._mouseInit(),this.helper=t("<div>"),this._addClass(this.helper,"ui-selectable-helper")},_destroy:function(){this.selectees.removeData("selectable-item"),this._mouseDestroy()},_mouseStart:function(e){var i=this,s=this.options;this.opos=[e.pageX,e.pageY],this.elementPos=t(this.element[0]).offset(),this.options.disabled||(this.selectees=t(s.filter,this.element[0]),this._trigger("start",e),t(s.appendTo).append(this.helper),this.helper.css({left:e.pageX,top:e.pageY,width:0,height:0}),s.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var s=t.data(this,"selectable-item");s.startselected=!0,e.metaKey||e.ctrlKey||(i._removeClass(s.$element,"ui-selected"),s.selected=!1,i._addClass(s.$element,"ui-unselecting"),s.unselecting=!0,i._trigger("unselecting",e,{unselecting:s.element}))}),t(e.target).parents().addBack().each(function(){var s,n=t.data(this,"selectable-item");return n?(s=!e.metaKey&&!e.ctrlKey||!n.$element.hasClass("ui-selected"),i._removeClass(n.$element,s?"ui-unselecting":"ui-selected")._addClass(n.$element,s?"ui-selecting":"ui-unselecting"),n.unselecting=!s,n.selecting=s,n.selected=s,s?i._trigger("selecting",e,{selecting:n.element}):i._trigger("unselecting",e,{unselecting:n.element}),!1):void 0}))},_mouseDrag:function(e){if(this.dragged=!0,!this.options.disabled){var i,s=this,n=this.options,o=this.opos[0],a=this.opos[1],r=e.pageX,h=e.pageY;return o>r&&(i=r,r=o,o=i),a>h&&(i=h,h=a,a=i),this.helper.css({left:o,top:a,width:r-o,height:h-a}),this.selectees.each(function(){var i=t.data(this,"selectable-item"),l=!1,c={};i&&i.element!==s.element[0]&&(c.left=i.left+s.elementPos.left,c.right=i.right+s.elementPos.left,c.top=i.top+s.elementPos.top,c.bottom=i.bottom+s.elementPos.top,"touch"===n.tolerance?l=!(c.left>r||o>c.right||c.top>h||a>c.bottom):"fit"===n.tolerance&&(l=c.left>o&&r>c.right&&c.top>a&&h>c.bottom),l?(i.selected&&(s._removeClass(i.$element,"ui-selected"),i.selected=!1),i.unselecting&&(s._removeClass(i.$element,"ui-unselecting"),i.unselecting=!1),i.selecting||(s._addClass(i.$element,"ui-selecting"),i.selecting=!0,s._trigger("selecting",e,{selecting:i.element}))):(i.selecting&&((e.metaKey||e.ctrlKey)&&i.startselected?(s._removeClass(i.$element,"ui-selecting"),i.selecting=!1,s._addClass(i.$element,"ui-selected"),i.selected=!0):(s._removeClass(i.$element,"ui-selecting"),i.selecting=!1,i.startselected&&(s._addClass(i.$element,"ui-unselecting"),i.unselecting=!0),s._trigger("unselecting",e,{unselecting:i.element}))),i.selected&&(e.metaKey||e.ctrlKey||i.startselected||(s._removeClass(i.$element,"ui-selected"),i.selected=!1,s._addClass(i.$element,"ui-unselecting"),i.unselecting=!0,s._trigger("unselecting",e,{unselecting:i.element})))))}),!1}},_mouseStop:function(e){var i=this;return this.dragged=!1,t(".ui-unselecting",this.element[0]).each(function(){var s=t.data(this,"selectable-item");i._removeClass(s.$element,"ui-unselecting"),s.unselecting=!1,s.startselected=!1,i._trigger("unselected",e,{unselected:s.element})}),t(".ui-selecting",this.element[0]).each(function(){var s=t.data(this,"selectable-item");i._removeClass(s.$element,"ui-selecting")._addClass(s.$element,"ui-selected"),s.selecting=!1,s.selected=!0,s.startselected=!0,i._trigger("selected",e,{selected:s.element})}),this._trigger("stop",e),this.helper.remove(),!1}}),t.widget("ui.selectmenu",[t.ui.formResetMixin,{version:"1.12.1",defaultElement:"<select>",options:{appendTo:null,classes:{"ui-selectmenu-button-open":"ui-corner-top","ui-selectmenu-button-closed":"ui-corner-all"},disabled:null,icons:{button:"ui-icon-triangle-1-s"},position:{my:"left top",at:"left bottom",collision:"none"},width:!1,change:null,close:null,focus:null,open:null,select:null},_create:function(){var e=this.element.uniqueId().attr("id");this.ids={element:e,button:e+"-button",menu:e+"-menu"},this._drawButton(),this._drawMenu(),this._bindFormResetHandler(),this._rendered=!1,this.menuItems=t()},_drawButton:function(){var e,i=this,s=this._parseOption(this.element.find("option:selected"),this.element[0].selectedIndex);this.labels=this.element.labels().attr("for",this.ids.button),this._on(this.labels,{click:function(t){this.button.focus(),t.preventDefault()}}),this.element.hide(),this.button=t("<span>",{tabindex:this.options.disabled?-1:0,id:this.ids.button,role:"combobox","aria-expanded":"false","aria-autocomplete":"list","aria-owns":this.ids.menu,"aria-haspopup":"true",title:this.element.attr("title")}).insertAfter(this.element),this._addClass(this.button,"ui-selectmenu-button ui-selectmenu-button-closed","ui-button ui-widget"),e=t("<span>").appendTo(this.button),this._addClass(e,"ui-selectmenu-icon","ui-icon "+this.options.icons.button),this.buttonItem=this._renderButtonItem(s).appendTo(this.button),this.options.width!==!1&&this._resizeButton(),this._on(this.button,this._buttonEvents),this.button.one("focusin",function(){i._rendered||i._refreshMenu()})},_drawMenu:function(){var e=this;this.menu=t("<ul>",{"aria-hidden":"true","aria-labelledby":this.ids.button,id:this.ids.menu}),this.menuWrap=t("<div>").append(this.menu),this._addClass(this.menuWrap,"ui-selectmenu-menu","ui-front"),this.menuWrap.appendTo(this._appendTo()),this.menuInstance=this.menu.menu({classes:{"ui-menu":"ui-corner-bottom"},role:"listbox",select:function(t,i){t.preventDefault(),e._setSelection(),e._select(i.item.data("ui-selectmenu-item"),t)},focus:function(t,i){var s=i.item.data("ui-selectmenu-item");null!=e.focusIndex&&s.index!==e.focusIndex&&(e._trigger("focus",t,{item:s}),e.isOpen||e._select(s,t)),e.focusIndex=s.index,e.button.attr("aria-activedescendant",e.menuItems.eq(s.index).attr("id"))}}).menu("instance"),this.menuInstance._off(this.menu,"mouseleave"),this.menuInstance._closeOnDocumentClick=function(){return!1},this.menuInstance._isDivider=function(){return!1}},refresh:function(){this._refreshMenu(),this.buttonItem.replaceWith(this.buttonItem=this._renderButtonItem(this._getSelectedItem().data("ui-selectmenu-item")||{})),null===this.options.width&&this._resizeButton()},_refreshMenu:function(){var t,e=this.element.find("option");this.menu.empty(),this._parseOptions(e),this._renderMenu(this.menu,this.items),this.menuInstance.refresh(),this.menuItems=this.menu.find("li").not(".ui-selectmenu-optgroup").find(".ui-menu-item-wrapper"),this._rendered=!0,e.length&&(t=this._getSelectedItem(),this.menuInstance.focus(null,t),this._setAria(t.data("ui-selectmenu-item")),this._setOption("disabled",this.element.prop("disabled")))},open:function(t){this.options.disabled||(this._rendered?(this._removeClass(this.menu.find(".ui-state-active"),null,"ui-state-active"),this.menuInstance.focus(null,this._getSelectedItem())):this._refreshMenu(),this.menuItems.length&&(this.isOpen=!0,this._toggleAttr(),this._resizeMenu(),this._position(),this._on(this.document,this._documentClick),this._trigger("open",t)))},_position:function(){this.menuWrap.position(t.extend({of:this.button},this.options.position))},close:function(t){this.isOpen&&(this.isOpen=!1,this._toggleAttr(),this.range=null,this._off(this.document),this._trigger("close",t))},widget:function(){return this.button},menuWidget:function(){return this.menu},_renderButtonItem:function(e){var i=t("<span>");return this._setText(i,e.label),this._addClass(i,"ui-selectmenu-text"),i},_renderMenu:function(e,i){var s=this,n="";t.each(i,function(i,o){var a;o.optgroup!==n&&(a=t("<li>",{text:o.optgroup}),s._addClass(a,"ui-selectmenu-optgroup","ui-menu-divider"+(o.element.parent("optgroup").prop("disabled")?" ui-state-disabled":"")),a.appendTo(e),n=o.optgroup),s._renderItemData(e,o)})},_renderItemData:function(t,e){return this._renderItem(t,e).data("ui-selectmenu-item",e)},_renderItem:function(e,i){var s=t("<li>"),n=t("<div>",{title:i.element.attr("title")});return i.disabled&&this._addClass(s,null,"ui-state-disabled"),this._setText(n,i.label),s.append(n).appendTo(e)},_setText:function(t,e){e?t.text(e):t.html("&#160;")},_move:function(t,e){var i,s,n=".ui-menu-item";this.isOpen?i=this.menuItems.eq(this.focusIndex).parent("li"):(i=this.menuItems.eq(this.element[0].selectedIndex).parent("li"),n+=":not(.ui-state-disabled)"),s="first"===t||"last"===t?i["first"===t?"prevAll":"nextAll"](n).eq(-1):i[t+"All"](n).eq(0),s.length&&this.menuInstance.focus(e,s)},_getSelectedItem:function(){return this.menuItems.eq(this.element[0].selectedIndex).parent("li")},_toggle:function(t){this[this.isOpen?"close":"open"](t)},_setSelection:function(){var t;this.range&&(window.getSelection?(t=window.getSelection(),t.removeAllRanges(),t.addRange(this.range)):this.range.select(),this.button.focus())},_documentClick:{mousedown:function(e){this.isOpen&&(t(e.target).closest(".ui-selectmenu-menu, #"+t.ui.escapeSelector(this.ids.button)).length||this.close(e))}},_buttonEvents:{mousedown:function(){var t;window.getSelection?(t=window.getSelection(),t.rangeCount&&(this.range=t.getRangeAt(0))):this.range=document.selection.createRange()},click:function(t){this._setSelection(),this._toggle(t)},keydown:function(e){var i=!0;switch(e.keyCode){case t.ui.keyCode.TAB:case t.ui.keyCode.ESCAPE:this.close(e),i=!1;break;case t.ui.keyCode.ENTER:this.isOpen&&this._selectFocusedItem(e);break;case t.ui.keyCode.UP:e.altKey?this._toggle(e):this._move("prev",e);break;case t.ui.keyCode.DOWN:e.altKey?this._toggle(e):this._move("next",e);break;case t.ui.keyCode.SPACE:this.isOpen?this._selectFocusedItem(e):this._toggle(e);break;case t.ui.keyCode.LEFT:this._move("prev",e);break;case t.ui.keyCode.RIGHT:this._move("next",e);break;case t.ui.keyCode.HOME:case t.ui.keyCode.PAGE_UP:this._move("first",e);break;case t.ui.keyCode.END:case t.ui.keyCode.PAGE_DOWN:this._move("last",e);break;default:this.menu.trigger(e),i=!1}i&&e.preventDefault()}},_selectFocusedItem:function(t){var e=this.menuItems.eq(this.focusIndex).parent("li");e.hasClass("ui-state-disabled")||this._select(e.data("ui-selectmenu-item"),t)},_select:function(t,e){var i=this.element[0].selectedIndex;this.element[0].selectedIndex=t.index,this.buttonItem.replaceWith(this.buttonItem=this._renderButtonItem(t)),this._setAria(t),this._trigger("select",e,{item:t}),t.index!==i&&this._trigger("change",e,{item:t}),this.close(e)},_setAria:function(t){var e=this.menuItems.eq(t.index).attr("id");this.button.attr({"aria-labelledby":e,"aria-activedescendant":e}),this.menu.attr("aria-activedescendant",e)},_setOption:function(t,e){if("icons"===t){var i=this.button.find("span.ui-icon");this._removeClass(i,null,this.options.icons.button)._addClass(i,null,e.button)}this._super(t,e),"appendTo"===t&&this.menuWrap.appendTo(this._appendTo()),"width"===t&&this._resizeButton()},_setOptionDisabled:function(t){this._super(t),this.menuInstance.option("disabled",t),this.button.attr("aria-disabled",t),this._toggleClass(this.button,null,"ui-state-disabled",t),this.element.prop("disabled",t),t?(this.button.attr("tabindex",-1),this.close()):this.button.attr("tabindex",0)},_appendTo:function(){var e=this.options.appendTo;return e&&(e=e.jquery||e.nodeType?t(e):this.document.find(e).eq(0)),e&&e[0]||(e=this.element.closest(".ui-front, dialog")),e.length||(e=this.document[0].body),e},_toggleAttr:function(){this.button.attr("aria-expanded",this.isOpen),this._removeClass(this.button,"ui-selectmenu-button-"+(this.isOpen?"closed":"open"))._addClass(this.button,"ui-selectmenu-button-"+(this.isOpen?"open":"closed"))._toggleClass(this.menuWrap,"ui-selectmenu-open",null,this.isOpen),this.menu.attr("aria-hidden",!this.isOpen)},_resizeButton:function(){var t=this.options.width;return t===!1?(this.button.css("width",""),void 0):(null===t&&(t=this.element.show().outerWidth(),this.element.hide()),this.button.outerWidth(t),void 0)},_resizeMenu:function(){this.menu.outerWidth(Math.max(this.button.outerWidth(),this.menu.width("").outerWidth()+1))},_getCreateOptions:function(){var t=this._super();return t.disabled=this.element.prop("disabled"),t},_parseOptions:function(e){var i=this,s=[];e.each(function(e,n){s.push(i._parseOption(t(n),e))}),this.items=s},_parseOption:function(t,e){var i=t.parent("optgroup");return{element:t,index:e,value:t.val(),label:t.text(),optgroup:i.attr("label")||"",disabled:i.prop("disabled")||t.prop("disabled")}},_destroy:function(){this._unbindFormResetHandler(),this.menuWrap.remove(),this.button.remove(),this.element.show(),this.element.removeUniqueId(),this.labels.attr("for",this.ids.element)}}]),t.widget("ui.slider",t.ui.mouse,{version:"1.12.1",widgetEventPrefix:"slide",options:{animate:!1,classes:{"ui-slider":"ui-corner-all","ui-slider-handle":"ui-corner-all","ui-slider-range":"ui-corner-all ui-widget-header"},distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},numPages:5,_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this._calculateNewMax(),this._addClass("ui-slider ui-slider-"+this.orientation,"ui-widget ui-widget-content"),this._refresh(),this._animateOff=!1
	},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var e,i,s=this.options,n=this.element.find(".ui-slider-handle"),o="<span tabindex='0'></span>",a=[];for(i=s.values&&s.values.length||1,n.length>i&&(n.slice(i).remove(),n=n.slice(0,i)),e=n.length;i>e;e++)a.push(o);this.handles=n.add(t(a.join("")).appendTo(this.element)),this._addClass(this.handles,"ui-slider-handle","ui-state-default"),this.handle=this.handles.eq(0),this.handles.each(function(e){t(this).data("ui-slider-handle-index",e).attr("tabIndex",0)})},_createRange:function(){var e=this.options;e.range?(e.range===!0&&(e.values?e.values.length&&2!==e.values.length?e.values=[e.values[0],e.values[0]]:t.isArray(e.values)&&(e.values=e.values.slice(0)):e.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?(this._removeClass(this.range,"ui-slider-range-min ui-slider-range-max"),this.range.css({left:"",bottom:""})):(this.range=t("<div>").appendTo(this.element),this._addClass(this.range,"ui-slider-range")),("min"===e.range||"max"===e.range)&&this._addClass(this.range,"ui-slider-range-"+e.range)):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){this._off(this.handles),this._on(this.handles,this._handleEvents),this._hoverable(this.handles),this._focusable(this.handles)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this._mouseDestroy()},_mouseCapture:function(e){var i,s,n,o,a,r,h,l,c=this,u=this.options;return u.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),i={x:e.pageX,y:e.pageY},s=this._normValueFromMouse(i),n=this._valueMax()-this._valueMin()+1,this.handles.each(function(e){var i=Math.abs(s-c.values(e));(n>i||n===i&&(e===c._lastChangedValue||c.values(e)===u.min))&&(n=i,o=t(this),a=e)}),r=this._start(e,a),r===!1?!1:(this._mouseSliding=!0,this._handleIndex=a,this._addClass(o,null,"ui-state-active"),o.trigger("focus"),h=o.offset(),l=!t(e.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=l?{left:0,top:0}:{left:e.pageX-h.left-o.width()/2,top:e.pageY-h.top-o.height()/2-(parseInt(o.css("borderTopWidth"),10)||0)-(parseInt(o.css("borderBottomWidth"),10)||0)+(parseInt(o.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(e,a,s),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(t){var e={x:t.pageX,y:t.pageY},i=this._normValueFromMouse(e);return this._slide(t,this._handleIndex,i),!1},_mouseStop:function(t){return this._removeClass(this.handles,null,"ui-state-active"),this._mouseSliding=!1,this._stop(t,this._handleIndex),this._change(t,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(t){var e,i,s,n,o;return"horizontal"===this.orientation?(e=this.elementSize.width,i=t.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(e=this.elementSize.height,i=t.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),s=i/e,s>1&&(s=1),0>s&&(s=0),"vertical"===this.orientation&&(s=1-s),n=this._valueMax()-this._valueMin(),o=this._valueMin()+s*n,this._trimAlignValue(o)},_uiHash:function(t,e,i){var s={handle:this.handles[t],handleIndex:t,value:void 0!==e?e:this.value()};return this._hasMultipleValues()&&(s.value=void 0!==e?e:this.values(t),s.values=i||this.values()),s},_hasMultipleValues:function(){return this.options.values&&this.options.values.length},_start:function(t,e){return this._trigger("start",t,this._uiHash(e))},_slide:function(t,e,i){var s,n,o=this.value(),a=this.values();this._hasMultipleValues()&&(n=this.values(e?0:1),o=this.values(e),2===this.options.values.length&&this.options.range===!0&&(i=0===e?Math.min(n,i):Math.max(n,i)),a[e]=i),i!==o&&(s=this._trigger("slide",t,this._uiHash(e,i,a)),s!==!1&&(this._hasMultipleValues()?this.values(e,i):this.value(i)))},_stop:function(t,e){this._trigger("stop",t,this._uiHash(e))},_change:function(t,e){this._keySliding||this._mouseSliding||(this._lastChangedValue=e,this._trigger("change",t,this._uiHash(e)))},value:function(t){return arguments.length?(this.options.value=this._trimAlignValue(t),this._refreshValue(),this._change(null,0),void 0):this._value()},values:function(e,i){var s,n,o;if(arguments.length>1)return this.options.values[e]=this._trimAlignValue(i),this._refreshValue(),this._change(null,e),void 0;if(!arguments.length)return this._values();if(!t.isArray(arguments[0]))return this._hasMultipleValues()?this._values(e):this.value();for(s=this.options.values,n=arguments[0],o=0;s.length>o;o+=1)s[o]=this._trimAlignValue(n[o]),this._change(null,o);this._refreshValue()},_setOption:function(e,i){var s,n=0;switch("range"===e&&this.options.range===!0&&("min"===i?(this.options.value=this._values(0),this.options.values=null):"max"===i&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),t.isArray(this.options.values)&&(n=this.options.values.length),this._super(e,i),e){case"orientation":this._detectOrientation(),this._removeClass("ui-slider-horizontal ui-slider-vertical")._addClass("ui-slider-"+this.orientation),this._refreshValue(),this.options.range&&this._refreshRange(i),this.handles.css("horizontal"===i?"bottom":"left","");break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),s=n-1;s>=0;s--)this._change(null,s);this._animateOff=!1;break;case"step":case"min":case"max":this._animateOff=!0,this._calculateNewMax(),this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_setOptionDisabled:function(t){this._super(t),this._toggleClass(null,"ui-state-disabled",!!t)},_value:function(){var t=this.options.value;return t=this._trimAlignValue(t)},_values:function(t){var e,i,s;if(arguments.length)return e=this.options.values[t],e=this._trimAlignValue(e);if(this._hasMultipleValues()){for(i=this.options.values.slice(),s=0;i.length>s;s+=1)i[s]=this._trimAlignValue(i[s]);return i}return[]},_trimAlignValue:function(t){if(this._valueMin()>=t)return this._valueMin();if(t>=this._valueMax())return this._valueMax();var e=this.options.step>0?this.options.step:1,i=(t-this._valueMin())%e,s=t-i;return 2*Math.abs(i)>=e&&(s+=i>0?e:-e),parseFloat(s.toFixed(5))},_calculateNewMax:function(){var t=this.options.max,e=this._valueMin(),i=this.options.step,s=Math.round((t-e)/i)*i;t=s+e,t>this.options.max&&(t-=i),this.max=parseFloat(t.toFixed(this._precision()))},_precision:function(){var t=this._precisionOf(this.options.step);return null!==this.options.min&&(t=Math.max(t,this._precisionOf(this.options.min))),t},_precisionOf:function(t){var e=""+t,i=e.indexOf(".");return-1===i?0:e.length-i-1},_valueMin:function(){return this.options.min},_valueMax:function(){return this.max},_refreshRange:function(t){"vertical"===t&&this.range.css({width:"",left:""}),"horizontal"===t&&this.range.css({height:"",bottom:""})},_refreshValue:function(){var e,i,s,n,o,a=this.options.range,r=this.options,h=this,l=this._animateOff?!1:r.animate,c={};this._hasMultipleValues()?this.handles.each(function(s){i=100*((h.values(s)-h._valueMin())/(h._valueMax()-h._valueMin())),c["horizontal"===h.orientation?"left":"bottom"]=i+"%",t(this).stop(1,1)[l?"animate":"css"](c,r.animate),h.options.range===!0&&("horizontal"===h.orientation?(0===s&&h.range.stop(1,1)[l?"animate":"css"]({left:i+"%"},r.animate),1===s&&h.range[l?"animate":"css"]({width:i-e+"%"},{queue:!1,duration:r.animate})):(0===s&&h.range.stop(1,1)[l?"animate":"css"]({bottom:i+"%"},r.animate),1===s&&h.range[l?"animate":"css"]({height:i-e+"%"},{queue:!1,duration:r.animate}))),e=i}):(s=this.value(),n=this._valueMin(),o=this._valueMax(),i=o!==n?100*((s-n)/(o-n)):0,c["horizontal"===this.orientation?"left":"bottom"]=i+"%",this.handle.stop(1,1)[l?"animate":"css"](c,r.animate),"min"===a&&"horizontal"===this.orientation&&this.range.stop(1,1)[l?"animate":"css"]({width:i+"%"},r.animate),"max"===a&&"horizontal"===this.orientation&&this.range.stop(1,1)[l?"animate":"css"]({width:100-i+"%"},r.animate),"min"===a&&"vertical"===this.orientation&&this.range.stop(1,1)[l?"animate":"css"]({height:i+"%"},r.animate),"max"===a&&"vertical"===this.orientation&&this.range.stop(1,1)[l?"animate":"css"]({height:100-i+"%"},r.animate))},_handleEvents:{keydown:function(e){var i,s,n,o,a=t(e.target).data("ui-slider-handle-index");switch(e.keyCode){case t.ui.keyCode.HOME:case t.ui.keyCode.END:case t.ui.keyCode.PAGE_UP:case t.ui.keyCode.PAGE_DOWN:case t.ui.keyCode.UP:case t.ui.keyCode.RIGHT:case t.ui.keyCode.DOWN:case t.ui.keyCode.LEFT:if(e.preventDefault(),!this._keySliding&&(this._keySliding=!0,this._addClass(t(e.target),null,"ui-state-active"),i=this._start(e,a),i===!1))return}switch(o=this.options.step,s=n=this._hasMultipleValues()?this.values(a):this.value(),e.keyCode){case t.ui.keyCode.HOME:n=this._valueMin();break;case t.ui.keyCode.END:n=this._valueMax();break;case t.ui.keyCode.PAGE_UP:n=this._trimAlignValue(s+(this._valueMax()-this._valueMin())/this.numPages);break;case t.ui.keyCode.PAGE_DOWN:n=this._trimAlignValue(s-(this._valueMax()-this._valueMin())/this.numPages);break;case t.ui.keyCode.UP:case t.ui.keyCode.RIGHT:if(s===this._valueMax())return;n=this._trimAlignValue(s+o);break;case t.ui.keyCode.DOWN:case t.ui.keyCode.LEFT:if(s===this._valueMin())return;n=this._trimAlignValue(s-o)}this._slide(e,a,n)},keyup:function(e){var i=t(e.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(e,i),this._change(e,i),this._removeClass(t(e.target),null,"ui-state-active"))}}}),t.widget("ui.sortable",t.ui.mouse,{version:"1.12.1",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(t,e,i){return t>=e&&e+i>t},_isFloating:function(t){return/left|right/.test(t.css("float"))||/inline|table-cell/.test(t.css("display"))},_create:function(){this.containerCache={},this._addClass("ui-sortable"),this.refresh(),this.offset=this.element.offset(),this._mouseInit(),this._setHandleClassName(),this.ready=!0},_setOption:function(t,e){this._super(t,e),"handle"===t&&this._setHandleClassName()},_setHandleClassName:function(){var e=this;this._removeClass(this.element.find(".ui-sortable-handle"),"ui-sortable-handle"),t.each(this.items,function(){e._addClass(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item,"ui-sortable-handle")})},_destroy:function(){this._mouseDestroy();for(var t=this.items.length-1;t>=0;t--)this.items[t].item.removeData(this.widgetName+"-item");return this},_mouseCapture:function(e,i){var s=null,n=!1,o=this;return this.reverting?!1:this.options.disabled||"static"===this.options.type?!1:(this._refreshItems(e),t(e.target).parents().each(function(){return t.data(this,o.widgetName+"-item")===o?(s=t(this),!1):void 0}),t.data(e.target,o.widgetName+"-item")===o&&(s=t(e.target)),s?!this.options.handle||i||(t(this.options.handle,s).find("*").addBack().each(function(){this===e.target&&(n=!0)}),n)?(this.currentItem=s,this._removeCurrentsFromItems(),!0):!1:!1)},_mouseStart:function(e,i,s){var n,o,a=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(e),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},t.extend(this.offset,{click:{left:e.pageX-this.offset.left,top:e.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(e),this.originalPageX=e.pageX,this.originalPageY=e.pageY,a.cursorAt&&this._adjustOffsetFromHelper(a.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),a.containment&&this._setContainment(),a.cursor&&"auto"!==a.cursor&&(o=this.document.find("body"),this.storedCursor=o.css("cursor"),o.css("cursor",a.cursor),this.storedStylesheet=t("<style>*{ cursor: "+a.cursor+" !important; }</style>").appendTo(o)),a.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",a.opacity)),a.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",a.zIndex)),this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",e,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!s)for(n=this.containers.length-1;n>=0;n--)this.containers[n]._trigger("activate",e,this._uiHash(this));return t.ui.ddmanager&&(t.ui.ddmanager.current=this),t.ui.ddmanager&&!a.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e),this.dragging=!0,this._addClass(this.helper,"ui-sortable-helper"),this._mouseDrag(e),!0},_mouseDrag:function(e){var i,s,n,o,a=this.options,r=!1;for(this.position=this._generatePosition(e),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-e.pageY<a.scrollSensitivity?this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop+a.scrollSpeed:e.pageY-this.overflowOffset.top<a.scrollSensitivity&&(this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop-a.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-e.pageX<a.scrollSensitivity?this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft+a.scrollSpeed:e.pageX-this.overflowOffset.left<a.scrollSensitivity&&(this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft-a.scrollSpeed)):(e.pageY-this.document.scrollTop()<a.scrollSensitivity?r=this.document.scrollTop(this.document.scrollTop()-a.scrollSpeed):this.window.height()-(e.pageY-this.document.scrollTop())<a.scrollSensitivity&&(r=this.document.scrollTop(this.document.scrollTop()+a.scrollSpeed)),e.pageX-this.document.scrollLeft()<a.scrollSensitivity?r=this.document.scrollLeft(this.document.scrollLeft()-a.scrollSpeed):this.window.width()-(e.pageX-this.document.scrollLeft())<a.scrollSensitivity&&(r=this.document.scrollLeft(this.document.scrollLeft()+a.scrollSpeed))),r!==!1&&t.ui.ddmanager&&!a.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),i=this.items.length-1;i>=0;i--)if(s=this.items[i],n=s.item[0],o=this._intersectsWithPointer(s),o&&s.instance===this.currentContainer&&n!==this.currentItem[0]&&this.placeholder[1===o?"next":"prev"]()[0]!==n&&!t.contains(this.placeholder[0],n)&&("semi-dynamic"===this.options.type?!t.contains(this.element[0],n):!0)){if(this.direction=1===o?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(s))break;this._rearrange(e,s),this._trigger("change",e,this._uiHash());break}return this._contactContainers(e),t.ui.ddmanager&&t.ui.ddmanager.drag(this,e),this._trigger("sort",e,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(e,i){if(e){if(t.ui.ddmanager&&!this.options.dropBehaviour&&t.ui.ddmanager.drop(this,e),this.options.revert){var s=this,n=this.placeholder.offset(),o=this.options.axis,a={};o&&"x"!==o||(a.left=n.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollLeft)),o&&"y"!==o||(a.top=n.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,t(this.helper).animate(a,parseInt(this.options.revert,10)||500,function(){s._clear(e)})}else this._clear(e,i);return!1}},cancel:function(){if(this.dragging){this._mouseUp(new t.Event("mouseup",{target:null})),"original"===this.options.helper?(this.currentItem.css(this._storedCSS),this._removeClass(this.currentItem,"ui-sortable-helper")):this.currentItem.show();for(var e=this.containers.length-1;e>=0;e--)this.containers[e]._trigger("deactivate",null,this._uiHash(this)),this.containers[e].containerCache.over&&(this.containers[e]._trigger("out",null,this._uiHash(this)),this.containers[e].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),t.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?t(this.domPosition.prev).after(this.currentItem):t(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(e){var i=this._getItemsAsjQuery(e&&e.connected),s=[];return e=e||{},t(i).each(function(){var i=(t(e.item||this).attr(e.attribute||"id")||"").match(e.expression||/(.+)[\-=_](.+)/);i&&s.push((e.key||i[1]+"[]")+"="+(e.key&&e.expression?i[1]:i[2]))}),!s.length&&e.key&&s.push(e.key+"="),s.join("&")},toArray:function(e){var i=this._getItemsAsjQuery(e&&e.connected),s=[];return e=e||{},i.each(function(){s.push(t(e.item||this).attr(e.attribute||"id")||"")}),s},_intersectsWith:function(t){var e=this.positionAbs.left,i=e+this.helperProportions.width,s=this.positionAbs.top,n=s+this.helperProportions.height,o=t.left,a=o+t.width,r=t.top,h=r+t.height,l=this.offset.click.top,c=this.offset.click.left,u="x"===this.options.axis||s+l>r&&h>s+l,d="y"===this.options.axis||e+c>o&&a>e+c,p=u&&d;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>t[this.floating?"width":"height"]?p:e+this.helperProportions.width/2>o&&a>i-this.helperProportions.width/2&&s+this.helperProportions.height/2>r&&h>n-this.helperProportions.height/2},_intersectsWithPointer:function(t){var e,i,s="x"===this.options.axis||this._isOverAxis(this.positionAbs.top+this.offset.click.top,t.top,t.height),n="y"===this.options.axis||this._isOverAxis(this.positionAbs.left+this.offset.click.left,t.left,t.width),o=s&&n;return o?(e=this._getDragVerticalDirection(),i=this._getDragHorizontalDirection(),this.floating?"right"===i||"down"===e?2:1:e&&("down"===e?2:1)):!1},_intersectsWithSides:function(t){var e=this._isOverAxis(this.positionAbs.top+this.offset.click.top,t.top+t.height/2,t.height),i=this._isOverAxis(this.positionAbs.left+this.offset.click.left,t.left+t.width/2,t.width),s=this._getDragVerticalDirection(),n=this._getDragHorizontalDirection();return this.floating&&n?"right"===n&&i||"left"===n&&!i:s&&("down"===s&&e||"up"===s&&!e)},_getDragVerticalDirection:function(){var t=this.positionAbs.top-this.lastPositionAbs.top;return 0!==t&&(t>0?"down":"up")},_getDragHorizontalDirection:function(){var t=this.positionAbs.left-this.lastPositionAbs.left;return 0!==t&&(t>0?"right":"left")},refresh:function(t){return this._refreshItems(t),this._setHandleClassName(),this.refreshPositions(),this},_connectWith:function(){var t=this.options;return t.connectWith.constructor===String?[t.connectWith]:t.connectWith},_getItemsAsjQuery:function(e){function i(){r.push(this)}var s,n,o,a,r=[],h=[],l=this._connectWith();if(l&&e)for(s=l.length-1;s>=0;s--)for(o=t(l[s],this.document[0]),n=o.length-1;n>=0;n--)a=t.data(o[n],this.widgetFullName),a&&a!==this&&!a.options.disabled&&h.push([t.isFunction(a.options.items)?a.options.items.call(a.element):t(a.options.items,a.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),a]);for(h.push([t.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):t(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),s=h.length-1;s>=0;s--)h[s][0].each(i);return t(r)},_removeCurrentsFromItems:function(){var e=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=t.grep(this.items,function(t){for(var i=0;e.length>i;i++)if(e[i]===t.item[0])return!1;return!0})},_refreshItems:function(e){this.items=[],this.containers=[this];var i,s,n,o,a,r,h,l,c=this.items,u=[[t.isFunction(this.options.items)?this.options.items.call(this.element[0],e,{item:this.currentItem}):t(this.options.items,this.element),this]],d=this._connectWith();if(d&&this.ready)for(i=d.length-1;i>=0;i--)for(n=t(d[i],this.document[0]),s=n.length-1;s>=0;s--)o=t.data(n[s],this.widgetFullName),o&&o!==this&&!o.options.disabled&&(u.push([t.isFunction(o.options.items)?o.options.items.call(o.element[0],e,{item:this.currentItem}):t(o.options.items,o.element),o]),this.containers.push(o));for(i=u.length-1;i>=0;i--)for(a=u[i][1],r=u[i][0],s=0,l=r.length;l>s;s++)h=t(r[s]),h.data(this.widgetName+"-item",a),c.push({item:h,instance:a,width:0,height:0,left:0,top:0})},refreshPositions:function(e){this.floating=this.items.length?"x"===this.options.axis||this._isFloating(this.items[0].item):!1,this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var i,s,n,o;for(i=this.items.length-1;i>=0;i--)s=this.items[i],s.instance!==this.currentContainer&&this.currentContainer&&s.item[0]!==this.currentItem[0]||(n=this.options.toleranceElement?t(this.options.toleranceElement,s.item):s.item,e||(s.width=n.outerWidth(),s.height=n.outerHeight()),o=n.offset(),s.left=o.left,s.top=o.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(i=this.containers.length-1;i>=0;i--)o=this.containers[i].element.offset(),this.containers[i].containerCache.left=o.left,this.containers[i].containerCache.top=o.top,this.containers[i].containerCache.width=this.containers[i].element.outerWidth(),this.containers[i].containerCache.height=this.containers[i].element.outerHeight();return this},_createPlaceholder:function(e){e=e||this;var i,s=e.options;s.placeholder&&s.placeholder.constructor!==String||(i=s.placeholder,s.placeholder={element:function(){var s=e.currentItem[0].nodeName.toLowerCase(),n=t("<"+s+">",e.document[0]);return e._addClass(n,"ui-sortable-placeholder",i||e.currentItem[0].className)._removeClass(n,"ui-sortable-helper"),"tbody"===s?e._createTrPlaceholder(e.currentItem.find("tr").eq(0),t("<tr>",e.document[0]).appendTo(n)):"tr"===s?e._createTrPlaceholder(e.currentItem,n):"img"===s&&n.attr("src",e.currentItem.attr("src")),i||n.css("visibility","hidden"),n},update:function(t,n){(!i||s.forcePlaceholderSize)&&(n.height()||n.height(e.currentItem.innerHeight()-parseInt(e.currentItem.css("paddingTop")||0,10)-parseInt(e.currentItem.css("paddingBottom")||0,10)),n.width()||n.width(e.currentItem.innerWidth()-parseInt(e.currentItem.css("paddingLeft")||0,10)-parseInt(e.currentItem.css("paddingRight")||0,10)))}}),e.placeholder=t(s.placeholder.element.call(e.element,e.currentItem)),e.currentItem.after(e.placeholder),s.placeholder.update(e,e.placeholder)},_createTrPlaceholder:function(e,i){var s=this;e.children().each(function(){t("<td>&#160;</td>",s.document[0]).attr("colspan",t(this).attr("colspan")||1).appendTo(i)})},_contactContainers:function(e){var i,s,n,o,a,r,h,l,c,u,d=null,p=null;for(i=this.containers.length-1;i>=0;i--)if(!t.contains(this.currentItem[0],this.containers[i].element[0]))if(this._intersectsWith(this.containers[i].containerCache)){if(d&&t.contains(this.containers[i].element[0],d.element[0]))continue;d=this.containers[i],p=i}else this.containers[i].containerCache.over&&(this.containers[i]._trigger("out",e,this._uiHash(this)),this.containers[i].containerCache.over=0);if(d)if(1===this.containers.length)this.containers[p].containerCache.over||(this.containers[p]._trigger("over",e,this._uiHash(this)),this.containers[p].containerCache.over=1);else{for(n=1e4,o=null,c=d.floating||this._isFloating(this.currentItem),a=c?"left":"top",r=c?"width":"height",u=c?"pageX":"pageY",s=this.items.length-1;s>=0;s--)t.contains(this.containers[p].element[0],this.items[s].item[0])&&this.items[s].item[0]!==this.currentItem[0]&&(h=this.items[s].item.offset()[a],l=!1,e[u]-h>this.items[s][r]/2&&(l=!0),n>Math.abs(e[u]-h)&&(n=Math.abs(e[u]-h),o=this.items[s],this.direction=l?"up":"down"));if(!o&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[p])return this.currentContainer.containerCache.over||(this.containers[p]._trigger("over",e,this._uiHash()),this.currentContainer.containerCache.over=1),void 0;o?this._rearrange(e,o,null,!0):this._rearrange(e,null,this.containers[p].element,!0),this._trigger("change",e,this._uiHash()),this.containers[p]._trigger("change",e,this._uiHash(this)),this.currentContainer=this.containers[p],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[p]._trigger("over",e,this._uiHash(this)),this.containers[p].containerCache.over=1}},_createHelper:function(e){var i=this.options,s=t.isFunction(i.helper)?t(i.helper.apply(this.element[0],[e,this.currentItem])):"clone"===i.helper?this.currentItem.clone():this.currentItem;return s.parents("body").length||t("parent"!==i.appendTo?i.appendTo:this.currentItem[0].parentNode)[0].appendChild(s[0]),s[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!s[0].style.width||i.forceHelperSize)&&s.width(this.currentItem.width()),(!s[0].style.height||i.forceHelperSize)&&s.height(this.currentItem.height()),s},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),t.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var e=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==this.document[0]&&t.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===this.document[0].body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&t.ui.ie)&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var t=this.currentItem.position();return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:t.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,i,s,n=this.options;"parent"===n.containment&&(n.containment=this.helper[0].parentNode),("document"===n.containment||"window"===n.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,"document"===n.containment?this.document.width():this.window.width()-this.helperProportions.width-this.margins.left,("document"===n.containment?this.document.height()||document.body.parentNode.scrollHeight:this.window.height()||this.document[0].body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(n.containment)||(e=t(n.containment)[0],i=t(n.containment).offset(),s="hidden"!==t(e).css("overflow"),this.containment=[i.left+(parseInt(t(e).css("borderLeftWidth"),10)||0)+(parseInt(t(e).css("paddingLeft"),10)||0)-this.margins.left,i.top+(parseInt(t(e).css("borderTopWidth"),10)||0)+(parseInt(t(e).css("paddingTop"),10)||0)-this.margins.top,i.left+(s?Math.max(e.scrollWidth,e.offsetWidth):e.offsetWidth)-(parseInt(t(e).css("borderLeftWidth"),10)||0)-(parseInt(t(e).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,i.top+(s?Math.max(e.scrollHeight,e.offsetHeight):e.offsetHeight)-(parseInt(t(e).css("borderTopWidth"),10)||0)-(parseInt(t(e).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(e,i){i||(i=this.position);var s="absolute"===e?1:-1,n="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,o=/(html|body)/i.test(n[0].tagName);return{top:i.top+this.offset.relative.top*s+this.offset.parent.top*s-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():o?0:n.scrollTop())*s,left:i.left+this.offset.relative.left*s+this.offset.parent.left*s-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():o?0:n.scrollLeft())*s}},_generatePosition:function(e){var i,s,n=this.options,o=e.pageX,a=e.pageY,r="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,h=/(html|body)/i.test(r[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(e.pageX-this.offset.click.left<this.containment[0]&&(o=this.containment[0]+this.offset.click.left),e.pageY-this.offset.click.top<this.containment[1]&&(a=this.containment[1]+this.offset.click.top),e.pageX-this.offset.click.left>this.containment[2]&&(o=this.containment[2]+this.offset.click.left),e.pageY-this.offset.click.top>this.containment[3]&&(a=this.containment[3]+this.offset.click.top)),n.grid&&(i=this.originalPageY+Math.round((a-this.originalPageY)/n.grid[1])*n.grid[1],a=this.containment?i-this.offset.click.top>=this.containment[1]&&i-this.offset.click.top<=this.containment[3]?i:i-this.offset.click.top>=this.containment[1]?i-n.grid[1]:i+n.grid[1]:i,s=this.originalPageX+Math.round((o-this.originalPageX)/n.grid[0])*n.grid[0],o=this.containment?s-this.offset.click.left>=this.containment[0]&&s-this.offset.click.left<=this.containment[2]?s:s-this.offset.click.left>=this.containment[0]?s-n.grid[0]:s+n.grid[0]:s)),{top:a-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():h?0:r.scrollTop()),left:o-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():h?0:r.scrollLeft())}},_rearrange:function(t,e,i,s){i?i[0].appendChild(this.placeholder[0]):e.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?e.item[0]:e.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var n=this.counter;
		this._delay(function(){n===this.counter&&this.refreshPositions(!s)})},_clear:function(t,e){function i(t,e,i){return function(s){i._trigger(t,s,e._uiHash(e))}}this.reverting=!1;var s,n=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(s in this._storedCSS)("auto"===this._storedCSS[s]||"static"===this._storedCSS[s])&&(this._storedCSS[s]="");this.currentItem.css(this._storedCSS),this._removeClass(this.currentItem,"ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!e&&n.push(function(t){this._trigger("receive",t,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||e||n.push(function(t){this._trigger("update",t,this._uiHash())}),this!==this.currentContainer&&(e||(n.push(function(t){this._trigger("remove",t,this._uiHash())}),n.push(function(t){return function(e){t._trigger("receive",e,this._uiHash(this))}}.call(this,this.currentContainer)),n.push(function(t){return function(e){t._trigger("update",e,this._uiHash(this))}}.call(this,this.currentContainer)))),s=this.containers.length-1;s>=0;s--)e||n.push(i("deactivate",this,this.containers[s])),this.containers[s].containerCache.over&&(n.push(i("out",this,this.containers[s])),this.containers[s].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,e||this._trigger("beforeStop",t,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.cancelHelperRemoval||(this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null),!e){for(s=0;n.length>s;s++)n[s].call(this,t);this._trigger("stop",t,this._uiHash())}return this.fromOutside=!1,!this.cancelHelperRemoval},_trigger:function(){t.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(e){var i=e||this;return{helper:i.helper,placeholder:i.placeholder||t([]),position:i.position,originalPosition:i.originalPosition,offset:i.positionAbs,item:i.currentItem,sender:e?e.element:null}}}),t.widget("ui.spinner",{version:"1.12.1",defaultElement:"<input>",widgetEventPrefix:"spin",options:{classes:{"ui-spinner":"ui-corner-all","ui-spinner-down":"ui-corner-br","ui-spinner-up":"ui-corner-tr"},culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),""!==this.value()&&this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var e=this._super(),i=this.element;return t.each(["min","max","step"],function(t,s){var n=i.attr(s);null!=n&&n.length&&(e[s]=n)}),e},_events:{keydown:function(t){this._start(t)&&this._keydown(t)&&t.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(t){return this.cancelBlur?(delete this.cancelBlur,void 0):(this._stop(),this._refresh(),this.previous!==this.element.val()&&this._trigger("change",t),void 0)},mousewheel:function(t,e){if(e){if(!this.spinning&&!this._start(t))return!1;this._spin((e>0?1:-1)*this.options.step,t),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(t)},100),t.preventDefault()}},"mousedown .ui-spinner-button":function(e){function i(){var e=this.element[0]===t.ui.safeActiveElement(this.document[0]);e||(this.element.trigger("focus"),this.previous=s,this._delay(function(){this.previous=s}))}var s;s=this.element[0]===t.ui.safeActiveElement(this.document[0])?this.previous:this.element.val(),e.preventDefault(),i.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,i.call(this)}),this._start(e)!==!1&&this._repeat(null,t(e.currentTarget).hasClass("ui-spinner-up")?1:-1,e)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(e){return t(e.currentTarget).hasClass("ui-state-active")?this._start(e)===!1?!1:(this._repeat(null,t(e.currentTarget).hasClass("ui-spinner-up")?1:-1,e),void 0):void 0},"mouseleave .ui-spinner-button":"_stop"},_enhance:function(){this.uiSpinner=this.element.attr("autocomplete","off").wrap("<span>").parent().append("<a></a><a></a>")},_draw:function(){this._enhance(),this._addClass(this.uiSpinner,"ui-spinner","ui-widget ui-widget-content"),this._addClass("ui-spinner-input"),this.element.attr("role","spinbutton"),this.buttons=this.uiSpinner.children("a").attr("tabIndex",-1).attr("aria-hidden",!0).button({classes:{"ui-button":""}}),this._removeClass(this.buttons,"ui-corner-all"),this._addClass(this.buttons.first(),"ui-spinner-button ui-spinner-up"),this._addClass(this.buttons.last(),"ui-spinner-button ui-spinner-down"),this.buttons.first().button({icon:this.options.icons.up,showLabel:!1}),this.buttons.last().button({icon:this.options.icons.down,showLabel:!1}),this.buttons.height()>Math.ceil(.5*this.uiSpinner.height())&&this.uiSpinner.height()>0&&this.uiSpinner.height(this.uiSpinner.height())},_keydown:function(e){var i=this.options,s=t.ui.keyCode;switch(e.keyCode){case s.UP:return this._repeat(null,1,e),!0;case s.DOWN:return this._repeat(null,-1,e),!0;case s.PAGE_UP:return this._repeat(null,i.page,e),!0;case s.PAGE_DOWN:return this._repeat(null,-i.page,e),!0}return!1},_start:function(t){return this.spinning||this._trigger("start",t)!==!1?(this.counter||(this.counter=1),this.spinning=!0,!0):!1},_repeat:function(t,e,i){t=t||500,clearTimeout(this.timer),this.timer=this._delay(function(){this._repeat(40,e,i)},t),this._spin(e*this.options.step,i)},_spin:function(t,e){var i=this.value()||0;this.counter||(this.counter=1),i=this._adjustValue(i+t*this._increment(this.counter)),this.spinning&&this._trigger("spin",e,{value:i})===!1||(this._value(i),this.counter++)},_increment:function(e){var i=this.options.incremental;return i?t.isFunction(i)?i(e):Math.floor(e*e*e/5e4-e*e/500+17*e/200+1):1},_precision:function(){var t=this._precisionOf(this.options.step);return null!==this.options.min&&(t=Math.max(t,this._precisionOf(this.options.min))),t},_precisionOf:function(t){var e=""+t,i=e.indexOf(".");return-1===i?0:e.length-i-1},_adjustValue:function(t){var e,i,s=this.options;return e=null!==s.min?s.min:0,i=t-e,i=Math.round(i/s.step)*s.step,t=e+i,t=parseFloat(t.toFixed(this._precision())),null!==s.max&&t>s.max?s.max:null!==s.min&&s.min>t?s.min:t},_stop:function(t){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",t))},_setOption:function(t,e){var i,s,n;return"culture"===t||"numberFormat"===t?(i=this._parse(this.element.val()),this.options[t]=e,this.element.val(this._format(i)),void 0):(("max"===t||"min"===t||"step"===t)&&"string"==typeof e&&(e=this._parse(e)),"icons"===t&&(s=this.buttons.first().find(".ui-icon"),this._removeClass(s,null,this.options.icons.up),this._addClass(s,null,e.up),n=this.buttons.last().find(".ui-icon"),this._removeClass(n,null,this.options.icons.down),this._addClass(n,null,e.down)),this._super(t,e),void 0)},_setOptionDisabled:function(t){this._super(t),this._toggleClass(this.uiSpinner,null,"ui-state-disabled",!!t),this.element.prop("disabled",!!t),this.buttons.button(t?"disable":"enable")},_setOptions:r(function(t){this._super(t)}),_parse:function(t){return"string"==typeof t&&""!==t&&(t=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(t,10,this.options.culture):+t),""===t||isNaN(t)?null:t},_format:function(t){return""===t?"":window.Globalize&&this.options.numberFormat?Globalize.format(t,this.options.numberFormat,this.options.culture):t},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},isValid:function(){var t=this.value();return null===t?!1:t===this._adjustValue(t)},_value:function(t,e){var i;""!==t&&(i=this._parse(t),null!==i&&(e||(i=this._adjustValue(i)),t=this._format(i))),this.element.val(t),this._refresh()},_destroy:function(){this.element.prop("disabled",!1).removeAttr("autocomplete role aria-valuemin aria-valuemax aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:r(function(t){this._stepUp(t)}),_stepUp:function(t){this._start()&&(this._spin((t||1)*this.options.step),this._stop())},stepDown:r(function(t){this._stepDown(t)}),_stepDown:function(t){this._start()&&(this._spin((t||1)*-this.options.step),this._stop())},pageUp:r(function(t){this._stepUp((t||1)*this.options.page)}),pageDown:r(function(t){this._stepDown((t||1)*this.options.page)}),value:function(t){return arguments.length?(r(this._value).call(this,t),void 0):this._parse(this.element.val())},widget:function(){return this.uiSpinner}}),t.uiBackCompat!==!1&&t.widget("ui.spinner",t.ui.spinner,{_enhance:function(){this.uiSpinner=this.element.attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml())},_uiSpinnerHtml:function(){return"<span>"},_buttonHtml:function(){return"<a></a><a></a>"}}),t.ui.spinner,t.widget("ui.tabs",{version:"1.12.1",delay:300,options:{active:null,classes:{"ui-tabs":"ui-corner-all","ui-tabs-nav":"ui-corner-all","ui-tabs-panel":"ui-corner-bottom","ui-tabs-tab":"ui-corner-top"},collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_isLocal:function(){var t=/#.*$/;return function(e){var i,s;i=e.href.replace(t,""),s=location.href.replace(t,"");try{i=decodeURIComponent(i)}catch(n){}try{s=decodeURIComponent(s)}catch(n){}return e.hash.length>1&&i===s}}(),_create:function(){var e=this,i=this.options;this.running=!1,this._addClass("ui-tabs","ui-widget ui-widget-content"),this._toggleClass("ui-tabs-collapsible",null,i.collapsible),this._processTabs(),i.active=this._initialActive(),t.isArray(i.disabled)&&(i.disabled=t.unique(i.disabled.concat(t.map(this.tabs.filter(".ui-state-disabled"),function(t){return e.tabs.index(t)}))).sort()),this.active=this.options.active!==!1&&this.anchors.length?this._findActive(i.active):t(),this._refresh(),this.active.length&&this.load(i.active)},_initialActive:function(){var e=this.options.active,i=this.options.collapsible,s=location.hash.substring(1);return null===e&&(s&&this.tabs.each(function(i,n){return t(n).attr("aria-controls")===s?(e=i,!1):void 0}),null===e&&(e=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),(null===e||-1===e)&&(e=this.tabs.length?0:!1)),e!==!1&&(e=this.tabs.index(this.tabs.eq(e)),-1===e&&(e=i?!1:0)),!i&&e===!1&&this.anchors.length&&(e=0),e},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):t()}},_tabKeydown:function(e){var i=t(t.ui.safeActiveElement(this.document[0])).closest("li"),s=this.tabs.index(i),n=!0;if(!this._handlePageNav(e)){switch(e.keyCode){case t.ui.keyCode.RIGHT:case t.ui.keyCode.DOWN:s++;break;case t.ui.keyCode.UP:case t.ui.keyCode.LEFT:n=!1,s--;break;case t.ui.keyCode.END:s=this.anchors.length-1;break;case t.ui.keyCode.HOME:s=0;break;case t.ui.keyCode.SPACE:return e.preventDefault(),clearTimeout(this.activating),this._activate(s),void 0;case t.ui.keyCode.ENTER:return e.preventDefault(),clearTimeout(this.activating),this._activate(s===this.options.active?!1:s),void 0;default:return}e.preventDefault(),clearTimeout(this.activating),s=this._focusNextTab(s,n),e.ctrlKey||e.metaKey||(i.attr("aria-selected","false"),this.tabs.eq(s).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",s)},this.delay))}},_panelKeydown:function(e){this._handlePageNav(e)||e.ctrlKey&&e.keyCode===t.ui.keyCode.UP&&(e.preventDefault(),this.active.trigger("focus"))},_handlePageNav:function(e){return e.altKey&&e.keyCode===t.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):e.altKey&&e.keyCode===t.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):void 0},_findNextTab:function(e,i){function s(){return e>n&&(e=0),0>e&&(e=n),e}for(var n=this.tabs.length-1;-1!==t.inArray(s(),this.options.disabled);)e=i?e+1:e-1;return e},_focusNextTab:function(t,e){return t=this._findNextTab(t,e),this.tabs.eq(t).trigger("focus"),t},_setOption:function(t,e){return"active"===t?(this._activate(e),void 0):(this._super(t,e),"collapsible"===t&&(this._toggleClass("ui-tabs-collapsible",null,e),e||this.options.active!==!1||this._activate(0)),"event"===t&&this._setupEvents(e),"heightStyle"===t&&this._setupHeightStyle(e),void 0)},_sanitizeSelector:function(t){return t?t.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var e=this.options,i=this.tablist.children(":has(a[href])");e.disabled=t.map(i.filter(".ui-state-disabled"),function(t){return i.index(t)}),this._processTabs(),e.active!==!1&&this.anchors.length?this.active.length&&!t.contains(this.tablist[0],this.active[0])?this.tabs.length===e.disabled.length?(e.active=!1,this.active=t()):this._activate(this._findNextTab(Math.max(0,e.active-1),!1)):e.active=this.tabs.index(this.active):(e.active=!1,this.active=t()),this._refresh()},_refresh:function(){this._setOptionDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-hidden":"true"}),this.active.length?(this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}),this._addClass(this.active,"ui-tabs-active","ui-state-active"),this._getPanelForTab(this.active).show().attr({"aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var e=this,i=this.tabs,s=this.anchors,n=this.panels;this.tablist=this._getList().attr("role","tablist"),this._addClass(this.tablist,"ui-tabs-nav","ui-helper-reset ui-helper-clearfix ui-widget-header"),this.tablist.on("mousedown"+this.eventNamespace,"> li",function(e){t(this).is(".ui-state-disabled")&&e.preventDefault()}).on("focus"+this.eventNamespace,".ui-tabs-anchor",function(){t(this).closest("li").is(".ui-state-disabled")&&this.blur()}),this.tabs=this.tablist.find("> li:has(a[href])").attr({role:"tab",tabIndex:-1}),this._addClass(this.tabs,"ui-tabs-tab","ui-state-default"),this.anchors=this.tabs.map(function(){return t("a",this)[0]}).attr({role:"presentation",tabIndex:-1}),this._addClass(this.anchors,"ui-tabs-anchor"),this.panels=t(),this.anchors.each(function(i,s){var n,o,a,r=t(s).uniqueId().attr("id"),h=t(s).closest("li"),l=h.attr("aria-controls");e._isLocal(s)?(n=s.hash,a=n.substring(1),o=e.element.find(e._sanitizeSelector(n))):(a=h.attr("aria-controls")||t({}).uniqueId()[0].id,n="#"+a,o=e.element.find(n),o.length||(o=e._createPanel(a),o.insertAfter(e.panels[i-1]||e.tablist)),o.attr("aria-live","polite")),o.length&&(e.panels=e.panels.add(o)),l&&h.data("ui-tabs-aria-controls",l),h.attr({"aria-controls":a,"aria-labelledby":r}),o.attr("aria-labelledby",r)}),this.panels.attr("role","tabpanel"),this._addClass(this.panels,"ui-tabs-panel","ui-widget-content"),i&&(this._off(i.not(this.tabs)),this._off(s.not(this.anchors)),this._off(n.not(this.panels)))},_getList:function(){return this.tablist||this.element.find("ol, ul").eq(0)},_createPanel:function(e){return t("<div>").attr("id",e).data("ui-tabs-destroy",!0)},_setOptionDisabled:function(e){var i,s,n;for(t.isArray(e)&&(e.length?e.length===this.anchors.length&&(e=!0):e=!1),n=0;s=this.tabs[n];n++)i=t(s),e===!0||-1!==t.inArray(n,e)?(i.attr("aria-disabled","true"),this._addClass(i,null,"ui-state-disabled")):(i.removeAttr("aria-disabled"),this._removeClass(i,null,"ui-state-disabled"));this.options.disabled=e,this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,e===!0)},_setupEvents:function(e){var i={};e&&t.each(e.split(" "),function(t,e){i[e]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(!0,this.anchors,{click:function(t){t.preventDefault()}}),this._on(this.anchors,i),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(e){var i,s=this.element.parent();"fill"===e?(i=s.height(),i-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each(function(){var e=t(this),s=e.css("position");"absolute"!==s&&"fixed"!==s&&(i-=e.outerHeight(!0))}),this.element.children().not(this.panels).each(function(){i-=t(this).outerHeight(!0)}),this.panels.each(function(){t(this).height(Math.max(0,i-t(this).innerHeight()+t(this).height()))}).css("overflow","auto")):"auto"===e&&(i=0,this.panels.each(function(){i=Math.max(i,t(this).height("").height())}).height(i))},_eventHandler:function(e){var i=this.options,s=this.active,n=t(e.currentTarget),o=n.closest("li"),a=o[0]===s[0],r=a&&i.collapsible,h=r?t():this._getPanelForTab(o),l=s.length?this._getPanelForTab(s):t(),c={oldTab:s,oldPanel:l,newTab:r?t():o,newPanel:h};e.preventDefault(),o.hasClass("ui-state-disabled")||o.hasClass("ui-tabs-loading")||this.running||a&&!i.collapsible||this._trigger("beforeActivate",e,c)===!1||(i.active=r?!1:this.tabs.index(o),this.active=a?t():o,this.xhr&&this.xhr.abort(),l.length||h.length||t.error("jQuery UI Tabs: Mismatching fragment identifier."),h.length&&this.load(this.tabs.index(o),e),this._toggle(e,c))},_toggle:function(e,i){function s(){o.running=!1,o._trigger("activate",e,i)}function n(){o._addClass(i.newTab.closest("li"),"ui-tabs-active","ui-state-active"),a.length&&o.options.show?o._show(a,o.options.show,s):(a.show(),s())}var o=this,a=i.newPanel,r=i.oldPanel;this.running=!0,r.length&&this.options.hide?this._hide(r,this.options.hide,function(){o._removeClass(i.oldTab.closest("li"),"ui-tabs-active","ui-state-active"),n()}):(this._removeClass(i.oldTab.closest("li"),"ui-tabs-active","ui-state-active"),r.hide(),n()),r.attr("aria-hidden","true"),i.oldTab.attr({"aria-selected":"false","aria-expanded":"false"}),a.length&&r.length?i.oldTab.attr("tabIndex",-1):a.length&&this.tabs.filter(function(){return 0===t(this).attr("tabIndex")}).attr("tabIndex",-1),a.attr("aria-hidden","false"),i.newTab.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_activate:function(e){var i,s=this._findActive(e);s[0]!==this.active[0]&&(s.length||(s=this.active),i=s.find(".ui-tabs-anchor")[0],this._eventHandler({target:i,currentTarget:i,preventDefault:t.noop}))},_findActive:function(e){return e===!1?t():this.tabs.eq(e)},_getIndex:function(e){return"string"==typeof e&&(e=this.anchors.index(this.anchors.filter("[href$='"+t.ui.escapeSelector(e)+"']"))),e},_destroy:function(){this.xhr&&this.xhr.abort(),this.tablist.removeAttr("role").off(this.eventNamespace),this.anchors.removeAttr("role tabIndex").removeUniqueId(),this.tabs.add(this.panels).each(function(){t.data(this,"ui-tabs-destroy")?t(this).remove():t(this).removeAttr("role tabIndex aria-live aria-busy aria-selected aria-labelledby aria-hidden aria-expanded")}),this.tabs.each(function(){var e=t(this),i=e.data("ui-tabs-aria-controls");i?e.attr("aria-controls",i).removeData("ui-tabs-aria-controls"):e.removeAttr("aria-controls")}),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(e){var i=this.options.disabled;i!==!1&&(void 0===e?i=!1:(e=this._getIndex(e),i=t.isArray(i)?t.map(i,function(t){return t!==e?t:null}):t.map(this.tabs,function(t,i){return i!==e?i:null})),this._setOptionDisabled(i))},disable:function(e){var i=this.options.disabled;if(i!==!0){if(void 0===e)i=!0;else{if(e=this._getIndex(e),-1!==t.inArray(e,i))return;i=t.isArray(i)?t.merge([e],i).sort():[e]}this._setOptionDisabled(i)}},load:function(e,i){e=this._getIndex(e);var s=this,n=this.tabs.eq(e),o=n.find(".ui-tabs-anchor"),a=this._getPanelForTab(n),r={tab:n,panel:a},h=function(t,e){"abort"===e&&s.panels.stop(!1,!0),s._removeClass(n,"ui-tabs-loading"),a.removeAttr("aria-busy"),t===s.xhr&&delete s.xhr};this._isLocal(o[0])||(this.xhr=t.ajax(this._ajaxSettings(o,i,r)),this.xhr&&"canceled"!==this.xhr.statusText&&(this._addClass(n,"ui-tabs-loading"),a.attr("aria-busy","true"),this.xhr.done(function(t,e,n){setTimeout(function(){a.html(t),s._trigger("load",i,r),h(n,e)},1)}).fail(function(t,e){setTimeout(function(){h(t,e)},1)})))},_ajaxSettings:function(e,i,s){var n=this;return{url:e.attr("href").replace(/#.*$/,""),beforeSend:function(e,o){return n._trigger("beforeLoad",i,t.extend({jqXHR:e,ajaxSettings:o},s))}}},_getPanelForTab:function(e){var i=t(e).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+i))}}),t.uiBackCompat!==!1&&t.widget("ui.tabs",t.ui.tabs,{_processTabs:function(){this._superApply(arguments),this._addClass(this.tabs,"ui-tab")}}),t.ui.tabs,t.widget("ui.tooltip",{version:"1.12.1",options:{classes:{"ui-tooltip":"ui-corner-all ui-widget-shadow"},content:function(){var e=t(this).attr("title")||"";return t("<a>").text(e).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,track:!1,close:null,open:null},_addDescribedBy:function(e,i){var s=(e.attr("aria-describedby")||"").split(/\s+/);s.push(i),e.data("ui-tooltip-id",i).attr("aria-describedby",t.trim(s.join(" ")))},_removeDescribedBy:function(e){var i=e.data("ui-tooltip-id"),s=(e.attr("aria-describedby")||"").split(/\s+/),n=t.inArray(i,s);-1!==n&&s.splice(n,1),e.removeData("ui-tooltip-id"),s=t.trim(s.join(" ")),s?e.attr("aria-describedby",s):e.removeAttr("aria-describedby")},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.liveRegion=t("<div>").attr({role:"log","aria-live":"assertive","aria-relevant":"additions"}).appendTo(this.document[0].body),this._addClass(this.liveRegion,null,"ui-helper-hidden-accessible"),this.disabledTitles=t([])},_setOption:function(e,i){var s=this;this._super(e,i),"content"===e&&t.each(this.tooltips,function(t,e){s._updateContent(e.element)})},_setOptionDisabled:function(t){this[t?"_disable":"_enable"]()},_disable:function(){var e=this;t.each(this.tooltips,function(i,s){var n=t.Event("blur");n.target=n.currentTarget=s.element[0],e.close(n,!0)}),this.disabledTitles=this.disabledTitles.add(this.element.find(this.options.items).addBack().filter(function(){var e=t(this);return e.is("[title]")?e.data("ui-tooltip-title",e.attr("title")).removeAttr("title"):void 0}))},_enable:function(){this.disabledTitles.each(function(){var e=t(this);e.data("ui-tooltip-title")&&e.attr("title",e.data("ui-tooltip-title"))}),this.disabledTitles=t([])},open:function(e){var i=this,s=t(e?e.target:this.element).closest(this.options.items);s.length&&!s.data("ui-tooltip-id")&&(s.attr("title")&&s.data("ui-tooltip-title",s.attr("title")),s.data("ui-tooltip-open",!0),e&&"mouseover"===e.type&&s.parents().each(function(){var e,s=t(this);s.data("ui-tooltip-open")&&(e=t.Event("blur"),e.target=e.currentTarget=this,i.close(e,!0)),s.attr("title")&&(s.uniqueId(),i.parents[this.id]={element:this,title:s.attr("title")},s.attr("title",""))}),this._registerCloseHandlers(e,s),this._updateContent(s,e))},_updateContent:function(t,e){var i,s=this.options.content,n=this,o=e?e.type:null;return"string"==typeof s||s.nodeType||s.jquery?this._open(e,t,s):(i=s.call(t[0],function(i){n._delay(function(){t.data("ui-tooltip-open")&&(e&&(e.type=o),this._open(e,t,i))})}),i&&this._open(e,t,i),void 0)},_open:function(e,i,s){function n(t){l.of=t,a.is(":hidden")||a.position(l)}var o,a,r,h,l=t.extend({},this.options.position);if(s){if(o=this._find(i))return o.tooltip.find(".ui-tooltip-content").html(s),void 0;i.is("[title]")&&(e&&"mouseover"===e.type?i.attr("title",""):i.removeAttr("title")),o=this._tooltip(i),a=o.tooltip,this._addDescribedBy(i,a.attr("id")),a.find(".ui-tooltip-content").html(s),this.liveRegion.children().hide(),h=t("<div>").html(a.find(".ui-tooltip-content").html()),h.removeAttr("name").find("[name]").removeAttr("name"),h.removeAttr("id").find("[id]").removeAttr("id"),h.appendTo(this.liveRegion),this.options.track&&e&&/^mouse/.test(e.type)?(this._on(this.document,{mousemove:n}),n(e)):a.position(t.extend({of:i},this.options.position)),a.hide(),this._show(a,this.options.show),this.options.track&&this.options.show&&this.options.show.delay&&(r=this.delayedShow=setInterval(function(){a.is(":visible")&&(n(l.of),clearInterval(r))},t.fx.interval)),this._trigger("open",e,{tooltip:a})}},_registerCloseHandlers:function(e,i){var s={keyup:function(e){if(e.keyCode===t.ui.keyCode.ESCAPE){var s=t.Event(e);s.currentTarget=i[0],this.close(s,!0)}}};i[0]!==this.element[0]&&(s.remove=function(){this._removeTooltip(this._find(i).tooltip)}),e&&"mouseover"!==e.type||(s.mouseleave="close"),e&&"focusin"!==e.type||(s.focusout="close"),this._on(!0,i,s)},close:function(e){var i,s=this,n=t(e?e.currentTarget:this.element),o=this._find(n);return o?(i=o.tooltip,o.closing||(clearInterval(this.delayedShow),n.data("ui-tooltip-title")&&!n.attr("title")&&n.attr("title",n.data("ui-tooltip-title")),this._removeDescribedBy(n),o.hiding=!0,i.stop(!0),this._hide(i,this.options.hide,function(){s._removeTooltip(t(this))}),n.removeData("ui-tooltip-open"),this._off(n,"mouseleave focusout keyup"),n[0]!==this.element[0]&&this._off(n,"remove"),this._off(this.document,"mousemove"),e&&"mouseleave"===e.type&&t.each(this.parents,function(e,i){t(i.element).attr("title",i.title),delete s.parents[e]}),o.closing=!0,this._trigger("close",e,{tooltip:i}),o.hiding||(o.closing=!1)),void 0):(n.removeData("ui-tooltip-open"),void 0)},_tooltip:function(e){var i=t("<div>").attr("role","tooltip"),s=t("<div>").appendTo(i),n=i.uniqueId().attr("id");return this._addClass(s,"ui-tooltip-content"),this._addClass(i,"ui-tooltip","ui-widget ui-widget-content"),i.appendTo(this._appendTo(e)),this.tooltips[n]={element:e,tooltip:i}},_find:function(t){var e=t.data("ui-tooltip-id");return e?this.tooltips[e]:null},_removeTooltip:function(t){t.remove(),delete this.tooltips[t.attr("id")]},_appendTo:function(t){var e=t.closest(".ui-front, dialog");return e.length||(e=this.document[0].body),e},_destroy:function(){var e=this;t.each(this.tooltips,function(i,s){var n=t.Event("blur"),o=s.element;n.target=n.currentTarget=o[0],e.close(n,!0),t("#"+i).remove(),o.data("ui-tooltip-title")&&(o.attr("title")||o.attr("title",o.data("ui-tooltip-title")),o.removeData("ui-tooltip-title"))}),this.liveRegion.remove()}}),t.uiBackCompat!==!1&&t.widget("ui.tooltip",t.ui.tooltip,{options:{tooltipClass:null},_tooltip:function(){var t=this._superApply(arguments);return this.options.tooltipClass&&t.tooltip.addClass(this.options.tooltipClass),t}}),t.ui.tooltip});;
/*
 jQuery UI Touch Punch 0.2.2

 Copyright 2011, Dave Furfero
 Dual licensed under the MIT or GPL Version 2 licenses.

 Depends:
  jquery.ui.widget.js
  jquery.ui.mouse.js
*/
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(b,e,d){b instanceof String&&(b=String(b));for(var f=b.length,g=0;g<f;g++){var k=b[g];if(e.call(d,k,g,b))return{i:g,v:k}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,e,d){b!=Array.prototype&&b!=Object.prototype&&(b[e]=d.value)};$jscomp.getGlobal=function(b){b=["object"==typeof globalThis&&globalThis,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,b];for(var e=0;e<b.length;++e){var d=b[e];if(d&&d.Math==Math)return d}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(b,e,d,f){if(e){d=$jscomp.global;b=b.split(".");for(f=0;f<b.length-1;f++){var g=b[f];g in d||(d[g]={});d=d[g]}b=b[b.length-1];f=d[b];e=e(f);e!=f&&null!=e&&$jscomp.defineProperty(d,b,{configurable:!0,writable:!0,value:e})}};$jscomp.polyfill("Array.prototype.find",function(b){return b?b:function(b,d){return $jscomp.findInternal(this,b,d).v}},"es6","es3");
(function(b){b.fn.cropzoom=function(e){return this.each(function(){function d(a){0<a.position.top&&(c("image").posY=0);0<a.position.left&&(c("image").posX=0);var b=-(c("image").h-a.helper.parent().parent().height()),l=-(c("image").w-a.helper.parent().parent().width());a.position.top<b&&(c("image").posY=b);a.position.left<l&&(c("image").posX=l);g()}function f(){c("image").scaleX=a.width/c("image").w;c("image").scaleY=a.height/c("image").h}function g(){b(function(){setTimeout(function(){var a=c("options"),
l=a.width;a=a.height;var d=c("grid");b("#canvasGrid").remove();b("#canvas").append('<canvas id="canvasGrid" width="'+l+'" height="'+a+'" style="position:absolute;"></canvas>');var e=document.getElementById("canvasGrid").getContext("2d");try{if(d.size=parseInt(d.size),d.display){e.globalAlpha=d.opacity/100;for(var q=d.size,f=1;f<=l;f+=q)e.moveTo(f,1),e.lineTo(f,a);e.moveTo(l-1,0);e.lineTo(l-1,a);for(f=1;f<a;f+=q)e.moveTo(1,f),e.lineTo(l,f);e.moveTo(0,a-1);e.lineTo(l,a-1);e.strokeStyle=d.color;e.stroke()}}catch(B){}},
100);z();var a="rotate("+c("image").rotation+"deg) ",d=c("image").flipV,e=c("image").flipH;d&&(a+=" scaleY(-1)");e&&(a+=" scaleX(-1)");$css={transform:a,"-webkit-transform":a,"-ms-transform":a,msTransform:a,top:c("image").posY,left:c("image").posX};d&&e?($css["-ms-filter"]="flipv fliph",$css.filter="flipv fliph"):d?($css["-ms-filter"]="flipv",$css.filter="flipv"):e&&($css["-ms-filter"]="fliph",$css.filter="fliph");b(p).css($css)})}function k(){var l=b("<div />").attr("id","zoomContainer").mouseover(function(){b(this).css("opacity",
1)}).mouseout(function(){b(this).css("opacity",.6)}),d=b("<div />").attr("id","zoomMin").html("<b>-</b>"),e=b("<div />").attr("id","zoomMax").html("<b>+</b>"),k=b("<div />").attr("id","zoomSlider");k.slider({orientation:""!=a.expose.zoomElement?a.expose.slidersOrientation:"vertical",value:0!=a.image.startZoom?a.image.startZoom:m(c("image")),min:a.image.useStartZoomAsMinZoom?a.image.startZoom:a.image.minZoom,max:a.image.maxZoom,step:a.zoomSteps>a.image.maxZoom||0>a.zoomSteps?1:a.zoomSteps,slide:function(l,
d){d="vertical"==a.expose.slidersOrientation?a.image.maxZoom-d.value:d.value;l=a.image.width*Math.abs(d)/100;d=a.image.height*Math.abs(d)/100;b(p).css({width:l+"px",height:d+"px"});var e=c("image").w/2-l/2,q=c("image").h/2-d/2;e=0<e?c("image").posX+Math.abs(e):c("image").posX-Math.abs(e);q=0<q?c("image").posY+Math.abs(q):c("image").posY-Math.abs(q);c("image").posX=e;c("image").posY=q;c("image").w=l;c("image").h=d;f();g();if(null!=a.image.onZoom)a.image.onZoom(p,c("image"))}});"vertical"==a.slidersOrientation?
(l.append(e),l.append(k),l.append(d)):(l.append(d),l.append(k),l.append(e));""!=a.expose.zoomElement?(d.addClass(a.expose.slidersOrientation),e.addClass(a.expose.slidersOrientation),k.addClass(a.expose.slidersOrientation),l.addClass(a.expose.slidersOrientation),b(a.expose.zoomElement).empty().append(l)):(d.addClass("vertical"),e.addClass("vertical"),k.addClass("vertical"),l.addClass("vertical"),l.css({position:"absolute",top:5,right:5,opacity:.6}),h.append(l))}function m(){return c("image").w>c("image").h?
a.image.maxZoom-100*c("image").w/a.image.width:a.image.maxZoom-100*c("image").h/a.image.height}function r(){var b=c("selector"),d=a.image;a.debugMode&&(location.hash="selectorX="+Math.round(b.x)+":selectorY="+Math.round(b.y)+":selectorW="+Math.round(b.w)+":selectorH="+Math.round(b.h)+":imageRotate="+d.rotation+":flipH="+d.flipH+":flipV="+d.flipV)}function u(c){h.find("#t").css({display:"block",width:a.width,height:c.position.top,left:0,top:0});h.find("#b").css({display:"block",width:a.width,height:a.height,
top:c.position.top+n.height()+2+"px",left:0});h.find("#l").css({display:"block",left:0,top:c.position.top,width:c.position.left,height:n.height()+2+"px"});h.find("#r").css({display:"block",top:c.position.top,left:c.position.left+n.width()+2+"px",width:a.width,height:n.height()+2+"px"})}function x(){h.find("#t").hide();h.find("#b").hide();h.find("#l").hide();h.find("#r").hide()}function t(a,c){h.data(a,c)}function c(a){return h.data(a)}function z(){var a=c("image").rotation*Math.PI/180,b=Math.sin(a),
d=Math.cos(a),e=d*c("image").w;a=b*c("image").w;var f=-b*c("image").h,k=d*c("image").h,g=d*c("image").w-b*c("image").h;d=b*c("image").w+d*c("image").h;b=Math.min(0,e,f,g);e=Math.max(0,e,f,g);f=Math.min(0,a,k,d);a=Math.max(0,a,k,d);c("image").rotW=e-b;c("image").rotH=a-f;c("image").rotY=f;c("image").rotX=b}function A(){var c=b("<table>                                    <tr>                                    <td></td>                                    <td></td>                                    <td></td>                                    </tr>                                    <tr>                                    <td></td>                                    <td></td>                                    <td></td>                                    </tr>                                    <tr>                                    <td></td>                                    <td></td>                                    <td></td>                                    </tr>                                    </table>"),
d=[];d.push(b("<div />").addClass("mvn_no mvn"));d.push(b("<div />").addClass("mvn_n mvn"));d.push(b("<div />").addClass("mvn_ne mvn"));d.push(b("<div />").addClass("mvn_o mvn"));d.push(b("<div />").addClass("mvn_c"));d.push(b("<div />").addClass("mvn_e mvn"));d.push(b("<div />").addClass("mvn_so mvn"));d.push(b("<div />").addClass("mvn_s mvn"));d.push(b("<div />").addClass("mvn_se mvn"));for(var e=0;e<d.length;e++)d[e].mousedown(function(){y(this)}).mouseup(function(){clearTimeout(w)}).mouseout(function(){clearTimeout(w)}),
c.find("td:eq("+e+")").append(d[e]);b(a.expose.elementMovement).empty().append(c)}function y(d){b(d).hasClass("mvn_no")?(c("image").posX=c("image").posX-a.expose.movementSteps,c("image").posY=c("image").posY-a.expose.movementSteps):b(d).hasClass("mvn_n")?c("image").posY=c("image").posY-a.expose.movementSteps:b(d).hasClass("mvn_ne")?(c("image").posX=c("image").posX+a.expose.movementSteps,c("image").posY=c("image").posY-a.expose.movementSteps):b(d).hasClass("mvn_o")?c("image").posX=c("image").posX-
a.expose.movementSteps:b(d).hasClass("mvn_c")?(c("image").posX=a.width/2-c("image").w/2,c("image").posY=a.height/2-c("image").h/2):b(d).hasClass("mvn_e")?c("image").posX=c("image").posX+a.expose.movementSteps:b(d).hasClass("mvn_so")?(c("image").posX=c("image").posX-a.expose.movementSteps,c("image").posY=c("image").posY+a.expose.movementSteps):b(d).hasClass("mvn_s")?c("image").posY=c("image").posY+a.expose.movementSteps:b(d).hasClass("mvn_se")&&(c("image").posX=c("image").posX+a.expose.movementSteps,
c("image").posY=c("image").posY+a.expose.movementSteps);if(a.image.snapToContainer){0<c("image").posY&&(c("image").posY=0);0<c("image").posX&&(c("image").posX=0);var e=-(c("image").h-h.height()),f=-(c("image").w-h.width());c("image").posY<e&&(c("image").posY=e);c("image").posX<f&&(c("image").posX=f)}g();w=setTimeout(function(){y(d)},100)}var h=null,w=null,n=null,p=null,a=b.extend(!0,{debugMode:!1,width:500,height:751,bgColor:"#000",overlayColor:"#000",selector:{x:0,y:0,w:229,h:100,aspectRatio:!1,
centered:!0,borderColor:"yellow",borderColorHover:"red",bgInfoLayer:"#FFF",infoFontSize:10,infoFontColor:"blue",showPositionsOnDrag:!0,showDimetionsOnDrag:!0,maxHeight:null,maxWidth:null,startWithOverlay:!0,hideOverlayOnDragAndResize:!1,onSelectorDrag:null,onSelectorDragStop:null,onSelectorResize:null,onSelectorResizeStop:null},image:{source:"",rotation:0,flipV:!1,flipH:!1,width:0,height:0,minZoom:10,maxZoom:150,startZoom:0,x:0,y:0,useStartZoomAsMinZoom:!1,snapToContainer:!1,onZoom:null,onRotate:null,
onImageDrag:null},grid:{color:"#ffffff",size:40,display:!0,opacity:20},enableRotation:!0,enableZoom:!0,zoomSteps:1,rotationSteps:1,expose:{slidersOrientation:"vertical",zoomElement:"",rotationElement:"",elementMovement:"",movementSteps:5}},e);if(b.isFunction(b.fn.draggable)&&b.isFunction(b.fn.resizable)&&b.isFunction(b.fn.slider))if(""==a.image.source||0==a.image.width||0==a.image.height)alert("You must set the source, witdth and height of the image element");else{h=b(this);t("options",a);h.empty();
h.css({width:a.width,height:a.height,"background-color":a.bgColor,overflow:"hidden",position:"relative",border:"2px solid #333"});t("image",{h:a.image.height,w:a.image.width,posY:a.image.y,posX:a.image.x,scaleX:0,scaleY:0,rotation:a.image.rotation,flipV:a.image.flipV,flipH:a.image.flipH,source:a.image.source,bounds:[0,0,0,0],id:"image_to_crop_"+h[0].id});t("grid",a.grid);f();(function(){if(0!=a.image.startZoom){var d=a.image.width*Math.abs(a.image.startZoom)/100,b=a.image.height*Math.abs(a.image.startZoom)/
100;c("image").h=b;c("image").w=d;0!=c("image").posY&&0!=c("image").posX&&(c("image").h>a.height?c("image").posY=Math.abs(a.height/2-c("image").h/2):c("image").posY=a.height/2-c("image").h/2,c("image").w>a.width?c("image").posX=Math.abs(a.width/2-c("image").w/2):c("image").posX=a.width/2-c("image").w/2)}else d=c("image").scaleX,b=c("image").scaleY,b<d?(c("image").h=a.height,c("image").w=Math.round(c("image").w*b)):(c("image").h=Math.round(c("image").h*d),c("image").w=a.width);c("image").w<a.width&&
c("image").h<a.height&&(a.image.snapToContainer=!1);g()})();t("selector",{x:a.selector.x,y:a.selector.y,w:null!=a.selector.maxWidth?a.selector.w>a.selector.maxWidth?a.selector.maxWidth:a.selector.w:a.selector.w,h:null!=a.selector.maxHeight?a.selector.h>a.selector.maxHeight?a.selector.maxHeight:a.selector.h:a.selector.h});$container=b("<div />").attr("id","k").css({width:a.width,height:a.height,position:"absolute"});p=b("<img />");p.attr("src",a.image.source);b(p).css({position:"absolute",left:c("image").posX,
top:c("image").posY,width:c("image").w,height:c("image").h});var v=function(){var c=a.image.source.split(".");return c[c.length-1]}();if("png"==v||"gif"==v)p.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+a.image.source+"',sizingMethod='scale');";$container.append(p);h.append($container);h.append('<div id="canvas"></div>');g();b(p).draggable({refreshPositions:!0,drag:function(b,e){c("image").posY=e.position.top;c("image").posX=e.position.left;a.image.snapToContainer?d(e):
g();if(null!=a.image.onImageDrag)a.image.onImageDrag(p)},stop:function(c,b){a.image.snapToContainer&&d(b)}});(function(){a.selector.centered&&(c("selector").y=a.height/2-c("selector").h/2,c("selector").x=a.width/2-c("selector").w/2);n=b("<div/>").attr("id",h[0].id+"_selector").css({width:c("selector").w,height:c("selector").h,top:c("selector").y+"px",left:c("selector").x+"px",border:"1px dashed "+a.selector.borderColor,position:"absolute",cursor:"move"}).mouseover(function(){b(this).css({border:"1px dashed "+
a.selector.borderColorHover})}).mouseout(function(){b(this).css({border:"1px dashed "+a.selector.borderColor})});n.draggable({containment:"parent",iframeFix:!0,refreshPositions:!0,drag:function(b,d){c("selector").x=d.position.left;c("selector").y=d.position.top;c("selector").w=n.width();c("selector").h=n.height();u(d);r();if(null!=a.selector.onSelectorDrag)a.selector.onSelectorDrag(n,c("selector"))},stop:function(d,b){a.selector.hideOverlayOnDragAndResize&&x();if(null!=a.selector.onSelectorDragStop)a.selector.onSelectorDragStop(n,
c("selector"))}});n.resizable({aspectRatio:a.selector.aspectRatio,maxHeight:a.selector.maxHeight,maxWidth:a.selector.maxWidth,minHeight:a.selector.h,minWidth:a.selector.w,handles:"all",containment:"parent",resize:function(d,b){c("selector").x=b.position.left;c("selector").y=b.position.top;c("selector").w=n.width();c("selector").h=n.height();u(b);r();if(null!=a.selector.onSelectorResize)a.selector.onSelectorResize(n,c("selector"))},stop:function(b,d){a.selector.hideOverlayOnDragAndResize&&x();if(null!=
a.selector.onSelectorResizeStop)a.selector.onSelectorResizeStop(n,c("selector"))}});r(n);h.append(n)})();h.find(".ui-icon-gripsmall-diagonal-se").css({background:"#FFF",border:"1px solid #000",width:CROP_POINTER_SIZE,height:CROP_POINTER_SIZE});h.find(".ui-resizable-sw").css({background:"#FFF",border:"1px solid #000",width:CROP_POINTER_SIZE,height:CROP_POINTER_SIZE});h.find(".ui-resizable-ne").css({background:"#FFF",border:"1px solid #000",width:CROP_POINTER_SIZE,height:CROP_POINTER_SIZE});h.find(".ui-resizable-nw").css({background:"#FFF",
border:"1px solid #000",width:CROP_POINTER_SIZE,height:CROP_POINTER_SIZE});(function(){b.each(["t","b","l","r"],function(){var c=b("<div />").attr("id",this).css({overflow:"hidden",background:a.overlayColor,opacity:.6,position:"absolute","z-index":2,visibility:"visible"});h.append(c)})})();a.selector.startWithOverlay&&(v={position:{top:n.position().top,left:n.position().left}},u(v));a.enableZoom&&k();""!=a.expose.elementMovement&&A();h.makeOverlayPositions=u;b.fn.cropzoom.updateOverlayPosition=function(a){h.makeOverlayPositions(a)};
b.fn.cropzoom.refresh=function(a){var b=c("image");b.flipV=a.image.flipV;b.flipH=a.image.flipH;b.rotation=a.image.rotation;t("image",b);b=c("grid");t("grid",b);c("selector").aspectRatio=a.selector.aspectRatio;console.log(a.selector.aspectRatio);g();r()};b.fn.cropzoom.getParameters=function(a,c){var d=a.data("image"),e=a.data("selector");a={viewPortW:a.width(),viewPortH:a.height(),imageX:d.posX,imageY:d.posY,imageRotate:d.rotation,imageW:d.w,imageH:d.h,imageSource:d.source,selectorX:e.x,selectorY:e.y,
selectorW:e.w,selectorH:e.h};return b.extend(a,c)};b.fn.cropzoom.getSelf=function(){return h};return this}else alert("You must include ui.draggable, ui.resizable and ui.slider to use cropZoom")})};b.fn.extend({setSelector:function(e,d,f,g,k){var m=b(this);m.data("selector",{x:e,y:d,w:f,h:g});var r={position:{top:d,left:e}};void 0!=k&&1==k?m.find("#"+m[0].id+"_selector").animate({top:d,left:e,width:f,height:g},"slow",function(){m.data("options").selector.startWithOverlay&&m.cropzoom.updateOverlayPosition(r)}):
(m.find("#"+m[0].id+"_selector").css({top:d,left:e,width:f,height:g}),b(this).data("options").selector.startWithOverlay&&m.cropzoom.updateOverlayPosition(r))},restore:function(){var e=b(this),d=e.data("options");e.empty();e.data("image",{});e.data("selector",{});""!=d.expose.zoomElement&&b(d.expose.zoomElement).empty();""!=d.expose.rotationElement&&b(d.expose.rotationElement).empty();""!=d.expose.elementMovement&&b(d.expose.elementMovement).empty();d.image.flipV=!1;d.image.flipH=!1;e.cropzoom(d)},
rotate:function(e){var d=b(this),f=d.data("options");f.image.rotation+=e;-360>f.image.rotation&&(f.image.rotation=360+f.image.rotation);360<f.image.rotation&&(f.image.rotation-=360);d.cropzoom.refresh(f)},setGrid:function(e,d,f,g){var k=b(this),m=k.data("options");m.grid.size=d;m.grid.display=e;m.grid.color=f;m.grid.opacity=g;k.cropzoom.refresh(m)},flipV:function(){var e=b(this),d=e.data("options");d.image.rotation=-d.image.rotation;d.image.flipV=!d.image.flipV;e.cropzoom.refresh(d)},setRatio:function(e){var d=
b(this),f=d.data("options"),g=d.cropzoom.getParameters(this);f.selector.aspectRatio=e;if(g.viewPortW/e>g.viewPortH){f=g.viewPortH;var k=f*e}else k=g.viewPortW,f=k/e;d.setSelector(Math.floor((g.viewPortW-k)/2),Math.floor((g.viewPortH-f)/2),k-2,f-2,!1);b("#"+d.attr("id")+"_selector").resizable("option","aspectRatio",e).data("ui-resizable")._aspectRatio=e},lock:function(){var e=b(this),d=e.cropzoom.getParameters(this);d=d.selectorW/d.selectorH;b("#"+e.attr("id")+"_selector").resizable("option","aspectRatio",
d).data("ui-resizable")._aspectRatio=d},unlock:function(){var e=b(this);e.data("options").selector.aspectRatio=!1;b("#"+e.attr("id")+"_selector").resizable("option","aspectRatio",!1).data("ui-resizable")._aspectRatio=!1},dim11:function(){b(this).setRatio(1)},dim32:function(){b(this).setRatio(1.5)},flipH:function(){var e=b(this),d=e.data("options");d.image.rotation=-d.image.rotation;d.image.flipH=!d.image.flipH;e.cropzoom.refresh(d)},send:function(e,d,f,g){var k=b(this),m=b(this).data("options");f.flipH=
m.image.flipH?1:0;f.flipV=m.image.flipV?1:0;f.fileId=m.image.fileId;b.ajax({url:e,type:d,data:k.cropzoom.getParameters(k,f),success:function(b){k.data("imageResult",b);void 0!==g&&null!=g&&g(b)}})}})})(jQuery);
(function(b){function e(b,d){if(!(1<b.originalEvent.touches.length)){b.preventDefault();var e=b.originalEvent.changedTouches[0],f=document.createEvent("MouseEvents");f.initMouseEvent(d,!0,!0,window,1,e.screenX,e.screenY,e.clientX,e.clientY,!1,!1,!1,!1,0,null);b.target.dispatchEvent(f)}}b.support.touch="ontouchend"in document;if(b.support.touch){var d=b.ui.mouse.prototype,f=d._mouseInit,g;d._touchStart=function(b){!g&&this._mouseCapture(b.originalEvent.changedTouches[0])&&(g=!0,this._touchMoved=!1,
e(b,"mouseover"),e(b,"mousemove"),e(b,"mousedown"))};d._touchMove=function(b){g&&(this._touchMoved=!0,e(b,"mousemove"))};d._touchEnd=function(b){g&&(e(b,"mouseup"),e(b,"mouseout"),this._touchMoved||e(b,"click"),g=!1)};d._mouseInit=function(){this.element.bind("touchstart",b.proxy(this,"_touchStart")).bind("touchmove",b.proxy(this,"_touchMove")).bind("touchend",b.proxy(this,"_touchEnd"));f.call(this)}}})(jQuery);
;
var CROP_POINTER_SIZE=20,gridShow=!0,currentEditedImage=!1;
$(document).ready(function(){$(window).resize(function(a){a.target==this&&$("#acropModal").is(":visible")&&($("#closeZoomImageAcrop").trigger("click"),$("#openImageEditor").trigger("click"))});$("body").on("click","#openImageEditor",function(a){$("#acropModal").modal("show");$(".acropButton").removeClass("active");$("#PE_dimunlock").hide();$("#PE_dimlock").show();a=isMobileDevice?60:30;$("#crop_container_wrap").css("height",$(window).height()-70-a);$("#crop_container_wrap").css("margin-top",a);currentEditedImage=
currentZoomedImage;var k=$(currentEditedImage).attr("data-fileId"),f=$(currentEditedImage).attr("data-width"),g=$(currentEditedImage).attr("data-height"),m=$(currentEditedImage).attr("href"),b=f,c=g,d=$("#crop_container_wrap").width(),e=$("#crop_container_wrap").height();if(f>d||g>e){var h=f/g,l=d/e;l<=h&&(b=d,c=d/h);l>h&&(c=e,b=e*h)}b<d?$("#crop_container_wrap").css("margin-left",(d-b)/2):$("#crop_container_wrap").css("margin-left",0);c<e&&$("#crop_container_wrap").css("margin-top",a+(e-c)/2);cropzoom=
$("#crop_container").cropzoom({debugMode:!1,width:b,height:c,bgColor:"black",enableRotation:!0,enableZoom:!1,zoomSteps:1,rotationSteps:.5,selector:{centered:!0,w:2*CROP_POINTER_SIZE,h:2*CROP_POINTER_SIZE,startWithOverlay:!0,borderColor:"white",borderColorHover:"red"},image:{source:m,width:f,height:g,fileId:k}});cropzoom.setSelector(0,0,b-2,c-2,!1)});$("#PE_rotateRight").click(function(){cropzoom.rotate(.5)});$("#PE_rotateLeft").click(function(){cropzoom.rotate(-.5)});$("#PE_dimlock").click(function(){cropzoom.lock();
$(".acropButton").removeClass("active");$("#PE_dimlock").hide();$("#PE_dimunlock").show()});$("#PE_dimunlock").click(function(){cropzoom.unlock();$(".acropButton").removeClass("active");$("#PE_dimlock").show();$("#PE_dimunlock").hide()});$("#PE_dim11").click(function(){cropzoom.dim11();$(".acropButton").removeClass("active");$("#PE_dimlock").hide();$("#PE_dimunlock").show();$(this).addClass("active")});$("#PE_dim32").click(function(){cropzoom.dim32();$(".acropButton").removeClass("active");$("#PE_dimlock").hide();
$("#PE_dimunlock").show();$(this).addClass("active")});$("#PE_save").click(function(){photoEditingIsGoingOn||(photoEditingIsGoingOn=!0,clearTimeout(timeout),timeout=setTimeout("showLoadingBlock()",500),setTimeout(function(){cropzoom.send("/cabinet/image-editor/edit","POST",{},function(a){try{a=eval("("+a+")")}catch(k){messageBoard(a,"warning")}"undefined"!=typeof a.status&&"success"==a.status&&($("#acropModal").modal("hide"),showNewlyEditedImage(a));"undefined"!=typeof a.error&&messageBoard(a.error,
"warning");photoEditingIsGoingOn=!1;clearTimeout(timeout);hideLoadingBlock()})},500))});$("#PE_returnToOriginal").click(function(){if(!photoEditingIsGoingOn){photoEditingIsGoingOn=!0;var a=$(currentEditedImage).attr("data-fileId");ajax({url:"/cabinet/image-editor/return-to-original/"+a,success:function(a){"undefined"!=typeof a.status&&"success"==a.status&&($("#acropModal").modal("hide"),"undefined"==typeof a.wasntEdited&&showNewlyEditedImage(a),photoEditingIsGoingOn=!1)}})}});$("#acropModal").keydown(function(a){37==
a.keyCode&&$("#PE_rotateLeft").trigger("click");39==a.keyCode&&$("#PE_rotateRight").trigger("click");13==a.keyCode&&$("#PE_save").trigger("click")})});
;
$("body").on("click","#uploadQualityMenuButton",function(a){_SUPERUZZA?($("#uploadQualityModal input[name=uploadQualityRadio][value="+quality+"]").attr("checked",!0),pro?($("#uploadQualityModal input[name=uploadQualityRadio][value=2]").attr("disabled",!1),$("#uploadQualityModal input[name=uploadQualityRadio][value=3]").attr("disabled",!1)):($("#uploadQualityModal input[name=uploadQualityRadio][value=1]").attr("checked",!0),$("#uploadQualityModal input[name=uploadQualityRadio][value=2]").attr("disabled",
!0),$("#uploadQualityModal input[name=uploadQualityRadio][value=3]").attr("disabled",!0)),$("#uploadQualityModal").modal("show")):alert("\u041d\u0435\u043c\u0430\u0454 \u0434\u043e\u0441\u0442\u0443\u043f\u0443")});
$("body").on("change","#uploadQualityModal input[name=uploadQualityRadio]",function(a){var b=$("#uploadQualityModal input[name=uploadQualityRadio]:checked").val();ajax({url:"/cabinet/i-me-mine/set-quality",data:{quality:b},success:function(a){setQuality(b);$("#uploadQualityModal").modal("hide");locationHashChanged(!1)}})});$(document).ready(function(){$("body").addClass("bodyQualityColor"+quality)});
function setQuality(a){quality=a;$("#uploadQualityMenuButton").removeClass("qualityColor1 qualityColor2 qualityColor3").addClass("qualityColor"+quality);$("body").removeClass("bodyQualityColor1 bodyQualityColor2 bodyQualityColor3").addClass("bodyQualityColor"+quality)};
;
$(document).ready(function(){function e(){ajax({url:"/cabinet/flow/get-html-for-modal",success:function(b){if("undefined"!=typeof b.status&&"success"==b.status){var a=.95*$(window).height()-55-65-30;$("#flowModal .modal-body #modalFlowWrap").css("height",a).html(b.html);$("#flowModal").modal().on("shown",function(){}).on("hidden",function(){$("#flowModal .modal-body #modalFlowWrap").html("");handleSelectionButtons(!1)});$("#flowModal").modal("show");isMobileDevice&&(a=$(window).height()-65-30,$("#flowModal .modal-body #modalFlowWrap").css("height",
a))}}})}function f(b){ajax({url:"/cabinet/stages/upload-from-flow",data:{fileIds:b,flowStageId:c,flowCommentId:d},success:function(a){"undefined"!=typeof a.status&&"success"==a.status?inserCommentFromAjax(a):confirmDialog({text:a.text});$("#flowModal").modal("hide");$(".uploadPreselectedFilesFromFlowToStageButton").remove();$(".uploadPreselectedFilesFromFlowToCommentButton").closest(".commentButtonDiv").remove();$(".flowUploadCommentButton, .commentUploadButton").closest(".commentButtonDiv").show();
$(".stageUploadButton, .flowUploadStageButton").show();$(".flowUploadStageButton").css("display","inline-block");$("#movingFilesToFlowIndicator").hide()}})}function g(b){var a=[];$(".selectedDentbookThumbnail .fileItem, .selectedDentbookThumbnail .imageToZoom").each(function(){a.push($(this).attr("data-fileId"))});a.length?($.cookie("addFilesFromFlow",a),$("#movingFilesToFlowIndicator").show(),document.location.hash=b):alert(T["Select files!"])}var c,d;$("body").on("click",".flowUploadStageButton",
function(b){$(this).closest(".stageBlockedUpload").length||(c=$(this).attr("data-stageId"),d=0,e())});$("body").on("click",".flowUploadCommentButton",function(b){$(this).closest(".stageBlockedUpload").length||(d=$(this).attr("data-commentId"),c=0,e())});$("body").on("click","#selectFilesFromFlowModal",function(b){var a=[];$("#flowModal .selectedDentbookThumbnail .fileItem, #flowModal .selectedDentbookThumbnail .imageToZoom").each(function(){a.push($(this).attr("data-fileId"))});a.length?f(a):alert(T["Select files!"])});
$("body").on("keydown","#flowModal",function(b){13==b.keyCode&&$("#selectFilesFromFlowModal").trigger("click")});$("body").on("click",".uploadPreselectedFilesFromFlowToStageButton, .uploadPreselectedFilesFromFlowToCommentButton",function(b){$(this).closest(".stageBlockedUpload").length||("undefined"!=typeof $(this).attr("data-stageId")?(c=$(this).attr("data-stageId"),d=0):(d=$(this).attr("data-commentId"),c=0),b=$.cookie("addFilesFromFlow").split(","),$.removeCookie("addFilesFromFlow"),f(b))});$.removeCookie("addFilesFromFlow");
$("body").on("click",".addToPatientFromFlow",function(b){g("#patients")});$("body").on("click","#createPatientMenuButton",function(b){if("#flow"==document.location.hash){var a=[];$(".selectedDentbookThumbnail .fileItem, .selectedDentbookThumbnail .imageToZoom").each(function(){a.push($(this).attr("data-fileId"))});a.length&&(b.preventDefault(),g("#create-patient"))}})});
;
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,c,b){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var f=a[e];if(c.call(b,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,b){a!=Array.prototype&&a!=Object.prototype&&(a[c]=b.value)};$jscomp.getGlobal=function(a){a=["object"==typeof globalThis&&globalThis,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,a];for(var c=0;c<a.length;++c){var b=a[c];if(b&&b.Math==Math)return b}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,c,b,d){if(c){b=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in b||(b[e]={});b=b[e]}a=a[a.length-1];d=b[a];c=c(d);c!=d&&null!=c&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:c})}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,b){return $jscomp.findInternal(this,a,b).v}},"es6","es3");var avatarFromSelectedFileId=!1,avatarFromSelectedUrl=!1,avatarFromSelectedWidth,avatarFromSelectedHeight;
$("body").on("click",".makeAvatarFromSelected",function(a){a=$(".selectedDentbookThumbnail").first().find(".imageToZoom");avatarFromSelectedFileId=a.attr("data-fileId");avatarFromSelectedUrl=void 0!==a.attr("data-preview2")?a.attr("data-preview2"):a.attr("href");clearTimeout(timeout);timeout=setTimeout("showLoadingBlock()",200);getMeta(avatarFromSelectedUrl)});
function getMeta(a){$("<img/>",{load:function(){avatarFromSelectedWidth=this.width;avatarFromSelectedHeight=this.height;avatarResizer({mainCropIndex:1,previewCropIndex:1,resizer:!0,crops:{1:{resize:"crop",width:150,height:150,resizer:!0,cropName:T["Profile photo"]}}});clearTimeout(timeout);hideLoadingBlock()},src:a})}
function avatarResizer(a){destroyJcropResizers();$("#resizerModal").modal("show");boxWidth=$("#resizerModal .modal-body").innerWidth()-2*parseInt($("#resizerModal .modal-body").css("padding-left"));boxHeight=$("#resizerModal .modal-body").innerHeight()-70*(isMobileDevice?3:1)-2*parseInt($("#resizerModal .modal-body").css("padding-top"));$("#resizerModal").modal("hide");console.log(boxWidth,"boxWidth");console.log(boxHeight,"boxHeight");$("#resizerModal .nav-tabs a").hide();$("#resizerModal .nav-tabs li").removeClass("active");
$("#resizerModal .tab-pane").removeClass("active");var c=!1,b;for(b in a.crops){var d=a.crops[b];if("undefined"!=typeof d.resizer){c||(c=b);$('#resizerModal a[href="#resizerTab'+b+'"]').show().html(d.cropName);$("#resizerTab"+b+" img").attr("src",avatarFromSelectedUrl);c==b&&($('#resizerModal a[href="#resizerTab'+b+'"]').parent().addClass("active"),$("#resizerTab"+b).addClass("active"));resizer=[];console.log(avatarFromSelectedWidth,"avatarFromSelectedWidth");resizer.resizeWidth=Math.min(d.width,
avatarFromSelectedWidth);resizer.resizeHeight=Math.min(d.height,avatarFromSelectedHeight);resizer.crop=d;switch(d.resize){case "crop":var e=[resizer.resizeWidth,resizer.resizeHeight],f=resizer.resizeWidth/resizer.resizeHeight;break;case "width":e=[resizer.resizeWidth,1];f=!1;break;case "height":e=[1,resizer.resizeHeight],f=!1}$("#jcropTarget"+b).Jcrop({boxWidth:boxWidth,boxHeight:boxHeight,minSize:e,setSelect:[0,0,100*resizer.resizeWidth,100*resizer.resizeHeight],aspectRatio:f,allowSelect:!1,jcropCropId:b,
resizer:resizer},function(){var a=this.getBounds(),b=this.getOptions().resizer;b.boundx=a[0];b.boundy=a[1];b.jcrop_api=this;a=b.jcrop_api.getOptions().jcropCropId;var c=b.jcrop_api.tellSelect(),d=0,e=0,f=c.x2;c=c.y2;b.boundx>f&&(d=Math.round((b.boundx-f)/2),f+=d);b.boundy>c&&(e=Math.round((b.boundy-c)/2),c+=e);0==d&&0==e||b.jcrop_api.setSelect([d,e,f,c]);resizers[a]=b;$(".avatarImageResizingComplete").show();$(".imageResizingComplete").hide();$("#resizerModal").modal("show")})}}}
$("body").on("click",".avatarImageResizingComplete",function(a){a=[];for(var c in resizers)a[c]=resizers[c].jcrop_api.tellSelect();ajax({url:"/cabinet/patients/set-avatar",data:{fileId:avatarFromSelectedFileId,avatar:JSON.stringify(a),patientId:$(".patientHeader").attr("data-patientId")},success:function(a){"undefined"!=typeof a.status&&"success"==a.status&&(locationHashChanged(),$("#resizerModal").modal("hide"),destroyJcropResizers())}})});
;
/*! tooltipster v4.2.6 */!function(a,b){"function"==typeof define&&define.amd?define(["jquery"],function(a){return b(a)}):"object"==typeof exports?module.exports=b(require("jquery")):b(jQuery)}(this,function(a){function b(a){this.$container,this.constraints=null,this.__$tooltip,this.__init(a)}function c(b,c){var d=!0;return a.each(b,function(a,e){return void 0===c[a]||b[a]!==c[a]?(d=!1,!1):void 0}),d}function d(b){var c=b.attr("id"),d=c?h.window.document.getElementById(c):null;return d?d===b[0]:a.contains(h.window.document.body,b[0])}function e(){if(!g)return!1;var a=g.document.body||g.document.documentElement,b=a.style,c="transition",d=["Moz","Webkit","Khtml","O","ms"];if("string"==typeof b[c])return!0;c=c.charAt(0).toUpperCase()+c.substr(1);for(var e=0;e<d.length;e++)if("string"==typeof b[d[e]+c])return!0;return!1}var f={animation:"fade",animationDuration:350,content:null,contentAsHTML:!1,contentCloning:!1,debug:!0,delay:300,delayTouch:[300,500],functionInit:null,functionBefore:null,functionReady:null,functionAfter:null,functionFormat:null,IEmin:6,interactive:!1,multiple:!1,parent:null,plugins:["sideTip"],repositionOnScroll:!1,restoration:"none",selfDestruction:!0,theme:[],timer:0,trackerInterval:500,trackOrigin:!1,trackTooltip:!1,trigger:"hover",triggerClose:{click:!1,mouseleave:!1,originClick:!1,scroll:!1,tap:!1,touchleave:!1},triggerOpen:{click:!1,mouseenter:!1,tap:!1,touchstart:!1},updateAnimation:"rotate",zIndex:9999999},g="undefined"!=typeof window?window:null,h={hasTouchCapability:!(!g||!("ontouchstart"in g||g.DocumentTouch&&g.document instanceof g.DocumentTouch||g.navigator.maxTouchPoints)),hasTransitions:e(),IE:!1,semVer:"4.2.6",window:g},i=function(){this.__$emitterPrivate=a({}),this.__$emitterPublic=a({}),this.__instancesLatestArr=[],this.__plugins={},this._env=h};i.prototype={__bridge:function(b,c,d){if(!c[d]){var e=function(){};e.prototype=b;var g=new e;g.__init&&g.__init(c),a.each(b,function(a,b){0!=a.indexOf("__")&&(c[a]?f.debug&&console.log("The "+a+" method of the "+d+" plugin conflicts with another plugin or native methods"):(c[a]=function(){return g[a].apply(g,Array.prototype.slice.apply(arguments))},c[a].bridged=g))}),c[d]=g}return this},__setWindow:function(a){return h.window=a,this},_getRuler:function(a){return new b(a)},_off:function(){return this.__$emitterPrivate.off.apply(this.__$emitterPrivate,Array.prototype.slice.apply(arguments)),this},_on:function(){return this.__$emitterPrivate.on.apply(this.__$emitterPrivate,Array.prototype.slice.apply(arguments)),this},_one:function(){return this.__$emitterPrivate.one.apply(this.__$emitterPrivate,Array.prototype.slice.apply(arguments)),this},_plugin:function(b){var c=this;if("string"==typeof b){var d=b,e=null;return d.indexOf(".")>0?e=c.__plugins[d]:a.each(c.__plugins,function(a,b){return b.name.substring(b.name.length-d.length-1)=="."+d?(e=b,!1):void 0}),e}if(b.name.indexOf(".")<0)throw new Error("Plugins must be namespaced");return c.__plugins[b.name]=b,b.core&&c.__bridge(b.core,c,b.name),this},_trigger:function(){var a=Array.prototype.slice.apply(arguments);return"string"==typeof a[0]&&(a[0]={type:a[0]}),this.__$emitterPrivate.trigger.apply(this.__$emitterPrivate,a),this.__$emitterPublic.trigger.apply(this.__$emitterPublic,a),this},instances:function(b){var c=[],d=b||".tooltipstered";return a(d).each(function(){var b=a(this),d=b.data("tooltipster-ns");d&&a.each(d,function(a,d){c.push(b.data(d))})}),c},instancesLatest:function(){return this.__instancesLatestArr},off:function(){return this.__$emitterPublic.off.apply(this.__$emitterPublic,Array.prototype.slice.apply(arguments)),this},on:function(){return this.__$emitterPublic.on.apply(this.__$emitterPublic,Array.prototype.slice.apply(arguments)),this},one:function(){return this.__$emitterPublic.one.apply(this.__$emitterPublic,Array.prototype.slice.apply(arguments)),this},origins:function(b){var c=b?b+" ":"";return a(c+".tooltipstered").toArray()},setDefaults:function(b){return a.extend(f,b),this},triggerHandler:function(){return this.__$emitterPublic.triggerHandler.apply(this.__$emitterPublic,Array.prototype.slice.apply(arguments)),this}},a.tooltipster=new i,a.Tooltipster=function(b,c){this.__callbacks={close:[],open:[]},this.__closingTime,this.__Content,this.__contentBcr,this.__destroyed=!1,this.__$emitterPrivate=a({}),this.__$emitterPublic=a({}),this.__enabled=!0,this.__garbageCollector,this.__Geometry,this.__lastPosition,this.__namespace="tooltipster-"+Math.round(1e6*Math.random()),this.__options,this.__$originParents,this.__pointerIsOverOrigin=!1,this.__previousThemes=[],this.__state="closed",this.__timeouts={close:[],open:null},this.__touchEvents=[],this.__tracker=null,this._$origin,this._$tooltip,this.__init(b,c)},a.Tooltipster.prototype={__init:function(b,c){var d=this;if(d._$origin=a(b),d.__options=a.extend(!0,{},f,c),d.__optionsFormat(),!h.IE||h.IE>=d.__options.IEmin){var e=null;if(void 0===d._$origin.data("tooltipster-initialTitle")&&(e=d._$origin.attr("title"),void 0===e&&(e=null),d._$origin.data("tooltipster-initialTitle",e)),null!==d.__options.content)d.__contentSet(d.__options.content);else{var g,i=d._$origin.attr("data-tooltip-content");i&&(g=a(i)),g&&g[0]?d.__contentSet(g.first()):d.__contentSet(e)}d._$origin.removeAttr("title").addClass("tooltipstered"),d.__prepareOrigin(),d.__prepareGC(),a.each(d.__options.plugins,function(a,b){d._plug(b)}),h.hasTouchCapability&&a(h.window.document.body).on("touchmove."+d.__namespace+"-triggerOpen",function(a){d._touchRecordEvent(a)}),d._on("created",function(){d.__prepareTooltip()})._on("repositioned",function(a){d.__lastPosition=a.position})}else d.__options.disabled=!0},__contentInsert:function(){var a=this,b=a._$tooltip.find(".tooltipster-content"),c=a.__Content,d=function(a){c=a};return a._trigger({type:"format",content:a.__Content,format:d}),a.__options.functionFormat&&(c=a.__options.functionFormat.call(a,a,{origin:a._$origin[0]},a.__Content)),"string"!=typeof c||a.__options.contentAsHTML?b.empty().append(c):b.text(c),a},__contentSet:function(b){return b instanceof a&&this.__options.contentCloning&&(b=b.clone(!0)),this.__Content=b,this._trigger({type:"updated",content:b}),this},__destroyError:function(){throw new Error("This tooltip has been destroyed and cannot execute your method call.")},__geometry:function(){var b=this,c=b._$origin,d=b._$origin.is("area");if(d){var e=b._$origin.parent().attr("name");c=a('img[usemap="#'+e+'"]')}var f=c[0].getBoundingClientRect(),g=a(h.window.document),i=a(h.window),j=c,k={available:{document:null,window:null},document:{size:{height:g.height(),width:g.width()}},window:{scroll:{left:h.window.scrollX||h.window.document.documentElement.scrollLeft,top:h.window.scrollY||h.window.document.documentElement.scrollTop},size:{height:i.height(),width:i.width()}},origin:{fixedLineage:!1,offset:{},size:{height:f.bottom-f.top,width:f.right-f.left},usemapImage:d?c[0]:null,windowOffset:{bottom:f.bottom,left:f.left,right:f.right,top:f.top}}};if(d){var l=b._$origin.attr("shape"),m=b._$origin.attr("coords");if(m&&(m=m.split(","),a.map(m,function(a,b){m[b]=parseInt(a)})),"default"!=l)switch(l){case"circle":var n=m[0],o=m[1],p=m[2],q=o-p,r=n-p;k.origin.size.height=2*p,k.origin.size.width=k.origin.size.height,k.origin.windowOffset.left+=r,k.origin.windowOffset.top+=q;break;case"rect":var s=m[0],t=m[1],u=m[2],v=m[3];k.origin.size.height=v-t,k.origin.size.width=u-s,k.origin.windowOffset.left+=s,k.origin.windowOffset.top+=t;break;case"poly":for(var w=0,x=0,y=0,z=0,A="even",B=0;B<m.length;B++){var C=m[B];"even"==A?(C>y&&(y=C,0===B&&(w=y)),w>C&&(w=C),A="odd"):(C>z&&(z=C,1==B&&(x=z)),x>C&&(x=C),A="even")}k.origin.size.height=z-x,k.origin.size.width=y-w,k.origin.windowOffset.left+=w,k.origin.windowOffset.top+=x}}var D=function(a){k.origin.size.height=a.height,k.origin.windowOffset.left=a.left,k.origin.windowOffset.top=a.top,k.origin.size.width=a.width};for(b._trigger({type:"geometry",edit:D,geometry:{height:k.origin.size.height,left:k.origin.windowOffset.left,top:k.origin.windowOffset.top,width:k.origin.size.width}}),k.origin.windowOffset.right=k.origin.windowOffset.left+k.origin.size.width,k.origin.windowOffset.bottom=k.origin.windowOffset.top+k.origin.size.height,k.origin.offset.left=k.origin.windowOffset.left+k.window.scroll.left,k.origin.offset.top=k.origin.windowOffset.top+k.window.scroll.top,k.origin.offset.bottom=k.origin.offset.top+k.origin.size.height,k.origin.offset.right=k.origin.offset.left+k.origin.size.width,k.available.document={bottom:{height:k.document.size.height-k.origin.offset.bottom,width:k.document.size.width},left:{height:k.document.size.height,width:k.origin.offset.left},right:{height:k.document.size.height,width:k.document.size.width-k.origin.offset.right},top:{height:k.origin.offset.top,width:k.document.size.width}},k.available.window={bottom:{height:Math.max(k.window.size.height-Math.max(k.origin.windowOffset.bottom,0),0),width:k.window.size.width},left:{height:k.window.size.height,width:Math.max(k.origin.windowOffset.left,0)},right:{height:k.window.size.height,width:Math.max(k.window.size.width-Math.max(k.origin.windowOffset.right,0),0)},top:{height:Math.max(k.origin.windowOffset.top,0),width:k.window.size.width}};"html"!=j[0].tagName.toLowerCase();){if("fixed"==j.css("position")){k.origin.fixedLineage=!0;break}j=j.parent()}return k},__optionsFormat:function(){return"number"==typeof this.__options.animationDuration&&(this.__options.animationDuration=[this.__options.animationDuration,this.__options.animationDuration]),"number"==typeof this.__options.delay&&(this.__options.delay=[this.__options.delay,this.__options.delay]),"number"==typeof this.__options.delayTouch&&(this.__options.delayTouch=[this.__options.delayTouch,this.__options.delayTouch]),"string"==typeof this.__options.theme&&(this.__options.theme=[this.__options.theme]),null===this.__options.parent?this.__options.parent=a(h.window.document.body):"string"==typeof this.__options.parent&&(this.__options.parent=a(this.__options.parent)),"hover"==this.__options.trigger?(this.__options.triggerOpen={mouseenter:!0,touchstart:!0},this.__options.triggerClose={mouseleave:!0,originClick:!0,touchleave:!0}):"click"==this.__options.trigger&&(this.__options.triggerOpen={click:!0,tap:!0},this.__options.triggerClose={click:!0,tap:!0}),this._trigger("options"),this},__prepareGC:function(){var b=this;return b.__options.selfDestruction?b.__garbageCollector=setInterval(function(){var c=(new Date).getTime();b.__touchEvents=a.grep(b.__touchEvents,function(a,b){return c-a.time>6e4}),d(b._$origin)||b.close(function(){b.destroy()})},2e4):clearInterval(b.__garbageCollector),b},__prepareOrigin:function(){var a=this;if(a._$origin.off("."+a.__namespace+"-triggerOpen"),h.hasTouchCapability&&a._$origin.on("touchstart."+a.__namespace+"-triggerOpen touchend."+a.__namespace+"-triggerOpen touchcancel."+a.__namespace+"-triggerOpen",function(b){a._touchRecordEvent(b)}),a.__options.triggerOpen.click||a.__options.triggerOpen.tap&&h.hasTouchCapability){var b="";a.__options.triggerOpen.click&&(b+="click."+a.__namespace+"-triggerOpen "),a.__options.triggerOpen.tap&&h.hasTouchCapability&&(b+="touchend."+a.__namespace+"-triggerOpen"),a._$origin.on(b,function(b){a._touchIsMeaningfulEvent(b)&&a._open(b)})}if(a.__options.triggerOpen.mouseenter||a.__options.triggerOpen.touchstart&&h.hasTouchCapability){var b="";a.__options.triggerOpen.mouseenter&&(b+="mouseenter."+a.__namespace+"-triggerOpen "),a.__options.triggerOpen.touchstart&&h.hasTouchCapability&&(b+="touchstart."+a.__namespace+"-triggerOpen"),a._$origin.on(b,function(b){!a._touchIsTouchEvent(b)&&a._touchIsEmulatedEvent(b)||(a.__pointerIsOverOrigin=!0,a._openShortly(b))})}if(a.__options.triggerClose.mouseleave||a.__options.triggerClose.touchleave&&h.hasTouchCapability){var b="";a.__options.triggerClose.mouseleave&&(b+="mouseleave."+a.__namespace+"-triggerOpen "),a.__options.triggerClose.touchleave&&h.hasTouchCapability&&(b+="touchend."+a.__namespace+"-triggerOpen touchcancel."+a.__namespace+"-triggerOpen"),a._$origin.on(b,function(b){a._touchIsMeaningfulEvent(b)&&(a.__pointerIsOverOrigin=!1)})}return a},__prepareTooltip:function(){var b=this,c=b.__options.interactive?"auto":"";return b._$tooltip.attr("id",b.__namespace).css({"pointer-events":c,zIndex:b.__options.zIndex}),a.each(b.__previousThemes,function(a,c){b._$tooltip.removeClass(c)}),a.each(b.__options.theme,function(a,c){b._$tooltip.addClass(c)}),b.__previousThemes=a.merge([],b.__options.theme),b},__scrollHandler:function(b){var c=this;if(c.__options.triggerClose.scroll)c._close(b);else if(d(c._$origin)&&d(c._$tooltip)){var e=null;if(b.target===h.window.document)c.__Geometry.origin.fixedLineage||c.__options.repositionOnScroll&&c.reposition(b);else{e=c.__geometry();var f=!1;if("fixed"!=c._$origin.css("position")&&c.__$originParents.each(function(b,c){var d=a(c),g=d.css("overflow-x"),h=d.css("overflow-y");if("visible"!=g||"visible"!=h){var i=c.getBoundingClientRect();if("visible"!=g&&(e.origin.windowOffset.left<i.left||e.origin.windowOffset.right>i.right))return f=!0,!1;if("visible"!=h&&(e.origin.windowOffset.top<i.top||e.origin.windowOffset.bottom>i.bottom))return f=!0,!1}return"fixed"==d.css("position")?!1:void 0}),f)c._$tooltip.css("visibility","hidden");else if(c._$tooltip.css("visibility","visible"),c.__options.repositionOnScroll)c.reposition(b);else{var g=e.origin.offset.left-c.__Geometry.origin.offset.left,i=e.origin.offset.top-c.__Geometry.origin.offset.top;c._$tooltip.css({left:c.__lastPosition.coord.left+g,top:c.__lastPosition.coord.top+i})}}c._trigger({type:"scroll",event:b,geo:e})}return c},__stateSet:function(a){return this.__state=a,this._trigger({type:"state",state:a}),this},__timeoutsClear:function(){return clearTimeout(this.__timeouts.open),this.__timeouts.open=null,a.each(this.__timeouts.close,function(a,b){clearTimeout(b)}),this.__timeouts.close=[],this},__trackerStart:function(){var a=this,b=a._$tooltip.find(".tooltipster-content");return a.__options.trackTooltip&&(a.__contentBcr=b[0].getBoundingClientRect()),a.__tracker=setInterval(function(){if(d(a._$origin)&&d(a._$tooltip)){if(a.__options.trackOrigin){var e=a.__geometry(),f=!1;c(e.origin.size,a.__Geometry.origin.size)&&(a.__Geometry.origin.fixedLineage?c(e.origin.windowOffset,a.__Geometry.origin.windowOffset)&&(f=!0):c(e.origin.offset,a.__Geometry.origin.offset)&&(f=!0)),f||(a.__options.triggerClose.mouseleave?a._close():a.reposition())}if(a.__options.trackTooltip){var g=b[0].getBoundingClientRect();g.height===a.__contentBcr.height&&g.width===a.__contentBcr.width||(a.reposition(),a.__contentBcr=g)}}else a._close()},a.__options.trackerInterval),a},_close:function(b,c,d){var e=this,f=!0;if(e._trigger({type:"close",event:b,stop:function(){f=!1}}),f||d){c&&e.__callbacks.close.push(c),e.__callbacks.open=[],e.__timeoutsClear();var g=function(){a.each(e.__callbacks.close,function(a,c){c.call(e,e,{event:b,origin:e._$origin[0]})}),e.__callbacks.close=[]};if("closed"!=e.__state){var i=!0,j=new Date,k=j.getTime(),l=k+e.__options.animationDuration[1];if("disappearing"==e.__state&&l>e.__closingTime&&e.__options.animationDuration[1]>0&&(i=!1),i){e.__closingTime=l,"disappearing"!=e.__state&&e.__stateSet("disappearing");var m=function(){clearInterval(e.__tracker),e._trigger({type:"closing",event:b}),e._$tooltip.off("."+e.__namespace+"-triggerClose").removeClass("tooltipster-dying"),a(h.window).off("."+e.__namespace+"-triggerClose"),e.__$originParents.each(function(b,c){a(c).off("scroll."+e.__namespace+"-triggerClose")}),e.__$originParents=null,a(h.window.document.body).off("."+e.__namespace+"-triggerClose"),e._$origin.off("."+e.__namespace+"-triggerClose"),e._off("dismissable"),e.__stateSet("closed"),e._trigger({type:"after",event:b}),e.__options.functionAfter&&e.__options.functionAfter.call(e,e,{event:b,origin:e._$origin[0]}),g()};h.hasTransitions?(e._$tooltip.css({"-moz-animation-duration":e.__options.animationDuration[1]+"ms","-ms-animation-duration":e.__options.animationDuration[1]+"ms","-o-animation-duration":e.__options.animationDuration[1]+"ms","-webkit-animation-duration":e.__options.animationDuration[1]+"ms","animation-duration":e.__options.animationDuration[1]+"ms","transition-duration":e.__options.animationDuration[1]+"ms"}),e._$tooltip.clearQueue().removeClass("tooltipster-show").addClass("tooltipster-dying"),e.__options.animationDuration[1]>0&&e._$tooltip.delay(e.__options.animationDuration[1]),e._$tooltip.queue(m)):e._$tooltip.stop().fadeOut(e.__options.animationDuration[1],m)}}else g()}return e},_off:function(){return this.__$emitterPrivate.off.apply(this.__$emitterPrivate,Array.prototype.slice.apply(arguments)),this},_on:function(){return this.__$emitterPrivate.on.apply(this.__$emitterPrivate,Array.prototype.slice.apply(arguments)),this},_one:function(){return this.__$emitterPrivate.one.apply(this.__$emitterPrivate,Array.prototype.slice.apply(arguments)),this},_open:function(b,c){var e=this;if(!e.__destroying&&d(e._$origin)&&e.__enabled){var f=!0;if("closed"==e.__state&&(e._trigger({type:"before",event:b,stop:function(){f=!1}}),f&&e.__options.functionBefore&&(f=e.__options.functionBefore.call(e,e,{event:b,origin:e._$origin[0]}))),f!==!1&&null!==e.__Content){c&&e.__callbacks.open.push(c),e.__callbacks.close=[],e.__timeoutsClear();var g,i=function(){"stable"!=e.__state&&e.__stateSet("stable"),a.each(e.__callbacks.open,function(a,b){b.call(e,e,{origin:e._$origin[0],tooltip:e._$tooltip[0]})}),e.__callbacks.open=[]};if("closed"!==e.__state)g=0,"disappearing"===e.__state?(e.__stateSet("appearing"),h.hasTransitions?(e._$tooltip.clearQueue().removeClass("tooltipster-dying").addClass("tooltipster-show"),e.__options.animationDuration[0]>0&&e._$tooltip.delay(e.__options.animationDuration[0]),e._$tooltip.queue(i)):e._$tooltip.stop().fadeIn(i)):"stable"==e.__state&&i();else{if(e.__stateSet("appearing"),g=e.__options.animationDuration[0],e.__contentInsert(),e.reposition(b,!0),h.hasTransitions?(e._$tooltip.addClass("tooltipster-"+e.__options.animation).addClass("tooltipster-initial").css({"-moz-animation-duration":e.__options.animationDuration[0]+"ms","-ms-animation-duration":e.__options.animationDuration[0]+"ms","-o-animation-duration":e.__options.animationDuration[0]+"ms","-webkit-animation-duration":e.__options.animationDuration[0]+"ms","animation-duration":e.__options.animationDuration[0]+"ms","transition-duration":e.__options.animationDuration[0]+"ms"}),setTimeout(function(){"closed"!=e.__state&&(e._$tooltip.addClass("tooltipster-show").removeClass("tooltipster-initial"),e.__options.animationDuration[0]>0&&e._$tooltip.delay(e.__options.animationDuration[0]),e._$tooltip.queue(i))},0)):e._$tooltip.css("display","none").fadeIn(e.__options.animationDuration[0],i),e.__trackerStart(),a(h.window).on("resize."+e.__namespace+"-triggerClose",function(b){var c=a(document.activeElement);(c.is("input")||c.is("textarea"))&&a.contains(e._$tooltip[0],c[0])||e.reposition(b)}).on("scroll."+e.__namespace+"-triggerClose",function(a){e.__scrollHandler(a)}),e.__$originParents=e._$origin.parents(),e.__$originParents.each(function(b,c){a(c).on("scroll."+e.__namespace+"-triggerClose",function(a){e.__scrollHandler(a)})}),e.__options.triggerClose.mouseleave||e.__options.triggerClose.touchleave&&h.hasTouchCapability){e._on("dismissable",function(a){a.dismissable?a.delay?(m=setTimeout(function(){e._close(a.event)},a.delay),e.__timeouts.close.push(m)):e._close(a):clearTimeout(m)});var j=e._$origin,k="",l="",m=null;e.__options.interactive&&(j=j.add(e._$tooltip)),e.__options.triggerClose.mouseleave&&(k+="mouseenter."+e.__namespace+"-triggerClose ",l+="mouseleave."+e.__namespace+"-triggerClose "),e.__options.triggerClose.touchleave&&h.hasTouchCapability&&(k+="touchstart."+e.__namespace+"-triggerClose",l+="touchend."+e.__namespace+"-triggerClose touchcancel."+e.__namespace+"-triggerClose"),j.on(l,function(a){if(e._touchIsTouchEvent(a)||!e._touchIsEmulatedEvent(a)){var b="mouseleave"==a.type?e.__options.delay:e.__options.delayTouch;e._trigger({delay:b[1],dismissable:!0,event:a,type:"dismissable"})}}).on(k,function(a){!e._touchIsTouchEvent(a)&&e._touchIsEmulatedEvent(a)||e._trigger({dismissable:!1,event:a,type:"dismissable"})})}e.__options.triggerClose.originClick&&e._$origin.on("click."+e.__namespace+"-triggerClose",function(a){e._touchIsTouchEvent(a)||e._touchIsEmulatedEvent(a)||e._close(a)}),(e.__options.triggerClose.click||e.__options.triggerClose.tap&&h.hasTouchCapability)&&setTimeout(function(){if("closed"!=e.__state){var b="",c=a(h.window.document.body);e.__options.triggerClose.click&&(b+="click."+e.__namespace+"-triggerClose "),e.__options.triggerClose.tap&&h.hasTouchCapability&&(b+="touchend."+e.__namespace+"-triggerClose"),c.on(b,function(b){e._touchIsMeaningfulEvent(b)&&(e._touchRecordEvent(b),e.__options.interactive&&a.contains(e._$tooltip[0],b.target)||e._close(b))}),e.__options.triggerClose.tap&&h.hasTouchCapability&&c.on("touchstart."+e.__namespace+"-triggerClose",function(a){e._touchRecordEvent(a)})}},0),e._trigger("ready"),e.__options.functionReady&&e.__options.functionReady.call(e,e,{origin:e._$origin[0],tooltip:e._$tooltip[0]})}if(e.__options.timer>0){var m=setTimeout(function(){e._close()},e.__options.timer+g);e.__timeouts.close.push(m)}}}return e},_openShortly:function(a){var b=this,c=!0;if("stable"!=b.__state&&"appearing"!=b.__state&&!b.__timeouts.open&&(b._trigger({type:"start",event:a,stop:function(){c=!1}}),c)){var d=0==a.type.indexOf("touch")?b.__options.delayTouch:b.__options.delay;d[0]?b.__timeouts.open=setTimeout(function(){b.__timeouts.open=null,b.__pointerIsOverOrigin&&b._touchIsMeaningfulEvent(a)?(b._trigger("startend"),b._open(a)):b._trigger("startcancel")},d[0]):(b._trigger("startend"),b._open(a))}return b},_optionsExtract:function(b,c){var d=this,e=a.extend(!0,{},c),f=d.__options[b];return f||(f={},a.each(c,function(a,b){var c=d.__options[a];void 0!==c&&(f[a]=c)})),a.each(e,function(b,c){void 0!==f[b]&&("object"!=typeof c||c instanceof Array||null==c||"object"!=typeof f[b]||f[b]instanceof Array||null==f[b]?e[b]=f[b]:a.extend(e[b],f[b]))}),e},_plug:function(b){var c=a.tooltipster._plugin(b);if(!c)throw new Error('The "'+b+'" plugin is not defined');return c.instance&&a.tooltipster.__bridge(c.instance,this,c.name),this},_touchIsEmulatedEvent:function(a){for(var b=!1,c=(new Date).getTime(),d=this.__touchEvents.length-1;d>=0;d--){var e=this.__touchEvents[d];if(!(c-e.time<500))break;e.target===a.target&&(b=!0)}return b},_touchIsMeaningfulEvent:function(a){return this._touchIsTouchEvent(a)&&!this._touchSwiped(a.target)||!this._touchIsTouchEvent(a)&&!this._touchIsEmulatedEvent(a)},_touchIsTouchEvent:function(a){return 0==a.type.indexOf("touch")},_touchRecordEvent:function(a){return this._touchIsTouchEvent(a)&&(a.time=(new Date).getTime(),this.__touchEvents.push(a)),this},_touchSwiped:function(a){for(var b=!1,c=this.__touchEvents.length-1;c>=0;c--){var d=this.__touchEvents[c];if("touchmove"==d.type){b=!0;break}if("touchstart"==d.type&&a===d.target)break}return b},_trigger:function(){var b=Array.prototype.slice.apply(arguments);return"string"==typeof b[0]&&(b[0]={type:b[0]}),b[0].instance=this,b[0].origin=this._$origin?this._$origin[0]:null,b[0].tooltip=this._$tooltip?this._$tooltip[0]:null,this.__$emitterPrivate.trigger.apply(this.__$emitterPrivate,b),a.tooltipster._trigger.apply(a.tooltipster,b),this.__$emitterPublic.trigger.apply(this.__$emitterPublic,b),this},_unplug:function(b){var c=this;if(c[b]){var d=a.tooltipster._plugin(b);d.instance&&a.each(d.instance,function(a,d){c[a]&&c[a].bridged===c[b]&&delete c[a]}),c[b].__destroy&&c[b].__destroy(),delete c[b]}return c},close:function(a){return this.__destroyed?this.__destroyError():this._close(null,a),this},content:function(a){var b=this;if(void 0===a)return b.__Content;if(b.__destroyed)b.__destroyError();else if(b.__contentSet(a),null!==b.__Content){if("closed"!==b.__state&&(b.__contentInsert(),b.reposition(),b.__options.updateAnimation))if(h.hasTransitions){var c=b.__options.updateAnimation;b._$tooltip.addClass("tooltipster-update-"+c),setTimeout(function(){"closed"!=b.__state&&b._$tooltip.removeClass("tooltipster-update-"+c)},1e3)}else b._$tooltip.fadeTo(200,.5,function(){"closed"!=b.__state&&b._$tooltip.fadeTo(200,1)})}else b._close();return b},destroy:function(){var b=this;if(b.__destroyed)b.__destroyError();else{"closed"!=b.__state?b.option("animationDuration",0)._close(null,null,!0):b.__timeoutsClear(),b._trigger("destroy"),b.__destroyed=!0,b._$origin.removeData(b.__namespace).off("."+b.__namespace+"-triggerOpen"),a(h.window.document.body).off("."+b.__namespace+"-triggerOpen");var c=b._$origin.data("tooltipster-ns");if(c)if(1===c.length){var d=null;"previous"==b.__options.restoration?d=b._$origin.data("tooltipster-initialTitle"):"current"==b.__options.restoration&&(d="string"==typeof b.__Content?b.__Content:a("<div></div>").append(b.__Content).html()),d&&b._$origin.attr("title",d),b._$origin.removeClass("tooltipstered"),b._$origin.removeData("tooltipster-ns").removeData("tooltipster-initialTitle")}else c=a.grep(c,function(a,c){return a!==b.__namespace}),b._$origin.data("tooltipster-ns",c);b._trigger("destroyed"),b._off(),b.off(),b.__Content=null,b.__$emitterPrivate=null,b.__$emitterPublic=null,b.__options.parent=null,b._$origin=null,b._$tooltip=null,a.tooltipster.__instancesLatestArr=a.grep(a.tooltipster.__instancesLatestArr,function(a,c){return b!==a}),clearInterval(b.__garbageCollector)}return b},disable:function(){return this.__destroyed?(this.__destroyError(),this):(this._close(),this.__enabled=!1,this)},elementOrigin:function(){return this.__destroyed?void this.__destroyError():this._$origin[0]},elementTooltip:function(){return this._$tooltip?this._$tooltip[0]:null},enable:function(){return this.__enabled=!0,this},hide:function(a){return this.close(a)},instance:function(){return this},off:function(){return this.__destroyed||this.__$emitterPublic.off.apply(this.__$emitterPublic,Array.prototype.slice.apply(arguments)),this},on:function(){return this.__destroyed?this.__destroyError():this.__$emitterPublic.on.apply(this.__$emitterPublic,Array.prototype.slice.apply(arguments)),this},one:function(){return this.__destroyed?this.__destroyError():this.__$emitterPublic.one.apply(this.__$emitterPublic,Array.prototype.slice.apply(arguments)),this},open:function(a){return this.__destroyed?this.__destroyError():this._open(null,a),this},option:function(b,c){return void 0===c?this.__options[b]:(this.__destroyed?this.__destroyError():(this.__options[b]=c,this.__optionsFormat(),a.inArray(b,["trigger","triggerClose","triggerOpen"])>=0&&this.__prepareOrigin(),"selfDestruction"===b&&this.__prepareGC()),this)},reposition:function(a,b){var c=this;return c.__destroyed?c.__destroyError():"closed"!=c.__state&&d(c._$origin)&&(b||d(c._$tooltip))&&(b||c._$tooltip.detach(),c.__Geometry=c.__geometry(),c._trigger({type:"reposition",event:a,helper:{geo:c.__Geometry}})),c},show:function(a){return this.open(a)},status:function(){return{destroyed:this.__destroyed,enabled:this.__enabled,open:"closed"!==this.__state,state:this.__state}},triggerHandler:function(){return this.__destroyed?this.__destroyError():this.__$emitterPublic.triggerHandler.apply(this.__$emitterPublic,Array.prototype.slice.apply(arguments)),this}},a.fn.tooltipster=function(){var b=Array.prototype.slice.apply(arguments),c="You are using a single HTML element as content for several tooltips. You probably want to set the contentCloning option to TRUE.";if(0===this.length)return this;if("string"==typeof b[0]){var d="#*$~&";return this.each(function(){var e=a(this).data("tooltipster-ns"),f=e?a(this).data(e[0]):null;if(!f)throw new Error("You called Tooltipster's \""+b[0]+'" method on an uninitialized element');if("function"!=typeof f[b[0]])throw new Error('Unknown method "'+b[0]+'"');this.length>1&&"content"==b[0]&&(b[1]instanceof a||"object"==typeof b[1]&&null!=b[1]&&b[1].tagName)&&!f.__options.contentCloning&&f.__options.debug&&console.log(c);var g=f[b[0]](b[1],b[2]);return g!==f||"instance"===b[0]?(d=g,!1):void 0}),"#*$~&"!==d?d:this}a.tooltipster.__instancesLatestArr=[];var e=b[0]&&void 0!==b[0].multiple,g=e&&b[0].multiple||!e&&f.multiple,h=b[0]&&void 0!==b[0].content,i=h&&b[0].content||!h&&f.content,j=b[0]&&void 0!==b[0].contentCloning,k=j&&b[0].contentCloning||!j&&f.contentCloning,l=b[0]&&void 0!==b[0].debug,m=l&&b[0].debug||!l&&f.debug;return this.length>1&&(i instanceof a||"object"==typeof i&&null!=i&&i.tagName)&&!k&&m&&console.log(c),this.each(function(){var c=!1,d=a(this),e=d.data("tooltipster-ns"),f=null;e?g?c=!0:m&&(console.log("Tooltipster: one or more tooltips are already attached to the element below. Ignoring."),console.log(this)):c=!0,c&&(f=new a.Tooltipster(this,b[0]),e||(e=[]),e.push(f.__namespace),d.data("tooltipster-ns",e),d.data(f.__namespace,f),f.__options.functionInit&&f.__options.functionInit.call(f,f,{origin:this}),f._trigger("init")),a.tooltipster.__instancesLatestArr.push(f)}),this},b.prototype={__init:function(b){this.__$tooltip=b,this.__$tooltip.css({left:0,overflow:"hidden",position:"absolute",top:0}).find(".tooltipster-content").css("overflow","auto"),this.$container=a('<div class="tooltipster-ruler"></div>').append(this.__$tooltip).appendTo(h.window.document.body)},__forceRedraw:function(){var a=this.__$tooltip.parent();this.__$tooltip.detach(),this.__$tooltip.appendTo(a)},constrain:function(a,b){return this.constraints={width:a,height:b},this.__$tooltip.css({display:"block",height:"",overflow:"auto",width:a}),this},destroy:function(){this.__$tooltip.detach().find(".tooltipster-content").css({display:"",overflow:""}),this.$container.remove()},free:function(){return this.constraints=null,this.__$tooltip.css({display:"",height:"",overflow:"visible",width:""}),this},measure:function(){this.__forceRedraw();var a=this.__$tooltip[0].getBoundingClientRect(),b={size:{height:a.height||a.bottom-a.top,width:a.width||a.right-a.left}};if(this.constraints){var c=this.__$tooltip.find(".tooltipster-content"),d=this.__$tooltip.outerHeight(),e=c[0].getBoundingClientRect(),f={height:d<=this.constraints.height,width:a.width<=this.constraints.width&&e.width>=c[0].scrollWidth-1};b.fits=f.height&&f.width}return h.IE&&h.IE<=11&&b.size.width!==h.window.document.documentElement.clientWidth&&(b.size.width=Math.ceil(b.size.width)+1),b}};var j=navigator.userAgent.toLowerCase();-1!=j.indexOf("msie")?h.IE=parseInt(j.split("msie")[1]):-1!==j.toLowerCase().indexOf("trident")&&-1!==j.indexOf(" rv:11")?h.IE=11:-1!=j.toLowerCase().indexOf("edge/")&&(h.IE=parseInt(j.toLowerCase().split("edge/")[1]));var k="tooltipster.sideTip";return a.tooltipster._plugin({name:k,instance:{__defaults:function(){return{arrow:!0,distance:6,functionPosition:null,maxWidth:null,minIntersection:16,minWidth:0,position:null,side:"top",viewportAware:!0}},__init:function(a){var b=this;b.__instance=a,b.__namespace="tooltipster-sideTip-"+Math.round(1e6*Math.random()),b.__previousState="closed",b.__options,b.__optionsFormat(),b.__instance._on("state."+b.__namespace,function(a){"closed"==a.state?b.__close():"appearing"==a.state&&"closed"==b.__previousState&&b.__create(),b.__previousState=a.state}),b.__instance._on("options."+b.__namespace,function(){b.__optionsFormat()}),b.__instance._on("reposition."+b.__namespace,function(a){b.__reposition(a.event,a.helper)})},__close:function(){this.__instance.content()instanceof a&&this.__instance.content().detach(),this.__instance._$tooltip.remove(),this.__instance._$tooltip=null},__create:function(){var b=a('<div class="tooltipster-base tooltipster-sidetip"><div class="tooltipster-box"><div class="tooltipster-content"></div></div><div class="tooltipster-arrow"><div class="tooltipster-arrow-uncropped"><div class="tooltipster-arrow-border"></div><div class="tooltipster-arrow-background"></div></div></div></div>');this.__options.arrow||b.find(".tooltipster-box").css("margin",0).end().find(".tooltipster-arrow").hide(),this.__options.minWidth&&b.css("min-width",this.__options.minWidth+"px"),this.__options.maxWidth&&b.css("max-width",this.__options.maxWidth+"px"),
this.__instance._$tooltip=b,this.__instance._trigger("created")},__destroy:function(){this.__instance._off("."+self.__namespace)},__optionsFormat:function(){var b=this;if(b.__options=b.__instance._optionsExtract(k,b.__defaults()),b.__options.position&&(b.__options.side=b.__options.position),"object"!=typeof b.__options.distance&&(b.__options.distance=[b.__options.distance]),b.__options.distance.length<4&&(void 0===b.__options.distance[1]&&(b.__options.distance[1]=b.__options.distance[0]),void 0===b.__options.distance[2]&&(b.__options.distance[2]=b.__options.distance[0]),void 0===b.__options.distance[3]&&(b.__options.distance[3]=b.__options.distance[1]),b.__options.distance={top:b.__options.distance[0],right:b.__options.distance[1],bottom:b.__options.distance[2],left:b.__options.distance[3]}),"string"==typeof b.__options.side){var c={top:"bottom",right:"left",bottom:"top",left:"right"};b.__options.side=[b.__options.side,c[b.__options.side]],"left"==b.__options.side[0]||"right"==b.__options.side[0]?b.__options.side.push("top","bottom"):b.__options.side.push("right","left")}6===a.tooltipster._env.IE&&b.__options.arrow!==!0&&(b.__options.arrow=!1)},__reposition:function(b,c){var d,e=this,f=e.__targetFind(c),g=[];e.__instance._$tooltip.detach();var h=e.__instance._$tooltip.clone(),i=a.tooltipster._getRuler(h),j=!1,k=e.__instance.option("animation");switch(k&&h.removeClass("tooltipster-"+k),a.each(["window","document"],function(d,k){var l=null;if(e.__instance._trigger({container:k,helper:c,satisfied:j,takeTest:function(a){l=a},results:g,type:"positionTest"}),1==l||0!=l&&0==j&&("window"!=k||e.__options.viewportAware))for(var d=0;d<e.__options.side.length;d++){var m={horizontal:0,vertical:0},n=e.__options.side[d];"top"==n||"bottom"==n?m.vertical=e.__options.distance[n]:m.horizontal=e.__options.distance[n],e.__sideChange(h,n),a.each(["natural","constrained"],function(a,d){if(l=null,e.__instance._trigger({container:k,event:b,helper:c,mode:d,results:g,satisfied:j,side:n,takeTest:function(a){l=a},type:"positionTest"}),1==l||0!=l&&0==j){var h={container:k,distance:m,fits:null,mode:d,outerSize:null,side:n,size:null,target:f[n],whole:null},o="natural"==d?i.free():i.constrain(c.geo.available[k][n].width-m.horizontal,c.geo.available[k][n].height-m.vertical),p=o.measure();if(h.size=p.size,h.outerSize={height:p.size.height+m.vertical,width:p.size.width+m.horizontal},"natural"==d?c.geo.available[k][n].width>=h.outerSize.width&&c.geo.available[k][n].height>=h.outerSize.height?h.fits=!0:h.fits=!1:h.fits=p.fits,"window"==k&&(h.fits?"top"==n||"bottom"==n?h.whole=c.geo.origin.windowOffset.right>=e.__options.minIntersection&&c.geo.window.size.width-c.geo.origin.windowOffset.left>=e.__options.minIntersection:h.whole=c.geo.origin.windowOffset.bottom>=e.__options.minIntersection&&c.geo.window.size.height-c.geo.origin.windowOffset.top>=e.__options.minIntersection:h.whole=!1),g.push(h),h.whole)j=!0;else if("natural"==h.mode&&(h.fits||h.size.width<=c.geo.available[k][n].width))return!1}})}}),e.__instance._trigger({edit:function(a){g=a},event:b,helper:c,results:g,type:"positionTested"}),g.sort(function(a,b){if(a.whole&&!b.whole)return-1;if(!a.whole&&b.whole)return 1;if(a.whole&&b.whole){var c=e.__options.side.indexOf(a.side),d=e.__options.side.indexOf(b.side);return d>c?-1:c>d?1:"natural"==a.mode?-1:1}if(a.fits&&!b.fits)return-1;if(!a.fits&&b.fits)return 1;if(a.fits&&b.fits){var c=e.__options.side.indexOf(a.side),d=e.__options.side.indexOf(b.side);return d>c?-1:c>d?1:"natural"==a.mode?-1:1}return"document"==a.container&&"bottom"==a.side&&"natural"==a.mode?-1:1}),d=g[0],d.coord={},d.side){case"left":case"right":d.coord.top=Math.floor(d.target-d.size.height/2);break;case"bottom":case"top":d.coord.left=Math.floor(d.target-d.size.width/2)}switch(d.side){case"left":d.coord.left=c.geo.origin.windowOffset.left-d.outerSize.width;break;case"right":d.coord.left=c.geo.origin.windowOffset.right+d.distance.horizontal;break;case"top":d.coord.top=c.geo.origin.windowOffset.top-d.outerSize.height;break;case"bottom":d.coord.top=c.geo.origin.windowOffset.bottom+d.distance.vertical}"window"==d.container?"top"==d.side||"bottom"==d.side?d.coord.left<0?c.geo.origin.windowOffset.right-this.__options.minIntersection>=0?d.coord.left=0:d.coord.left=c.geo.origin.windowOffset.right-this.__options.minIntersection-1:d.coord.left>c.geo.window.size.width-d.size.width&&(c.geo.origin.windowOffset.left+this.__options.minIntersection<=c.geo.window.size.width?d.coord.left=c.geo.window.size.width-d.size.width:d.coord.left=c.geo.origin.windowOffset.left+this.__options.minIntersection+1-d.size.width):d.coord.top<0?c.geo.origin.windowOffset.bottom-this.__options.minIntersection>=0?d.coord.top=0:d.coord.top=c.geo.origin.windowOffset.bottom-this.__options.minIntersection-1:d.coord.top>c.geo.window.size.height-d.size.height&&(c.geo.origin.windowOffset.top+this.__options.minIntersection<=c.geo.window.size.height?d.coord.top=c.geo.window.size.height-d.size.height:d.coord.top=c.geo.origin.windowOffset.top+this.__options.minIntersection+1-d.size.height):(d.coord.left>c.geo.window.size.width-d.size.width&&(d.coord.left=c.geo.window.size.width-d.size.width),d.coord.left<0&&(d.coord.left=0)),e.__sideChange(h,d.side),c.tooltipClone=h[0],c.tooltipParent=e.__instance.option("parent").parent[0],c.mode=d.mode,c.whole=d.whole,c.origin=e.__instance._$origin[0],c.tooltip=e.__instance._$tooltip[0],delete d.container,delete d.fits,delete d.mode,delete d.outerSize,delete d.whole,d.distance=d.distance.horizontal||d.distance.vertical;var l=a.extend(!0,{},d);if(e.__instance._trigger({edit:function(a){d=a},event:b,helper:c,position:l,type:"position"}),e.__options.functionPosition){var m=e.__options.functionPosition.call(e,e.__instance,c,l);m&&(d=m)}i.destroy();var n,o;"top"==d.side||"bottom"==d.side?(n={prop:"left",val:d.target-d.coord.left},o=d.size.width-this.__options.minIntersection):(n={prop:"top",val:d.target-d.coord.top},o=d.size.height-this.__options.minIntersection),n.val<this.__options.minIntersection?n.val=this.__options.minIntersection:n.val>o&&(n.val=o);var p;p=c.geo.origin.fixedLineage?c.geo.origin.windowOffset:{left:c.geo.origin.windowOffset.left+c.geo.window.scroll.left,top:c.geo.origin.windowOffset.top+c.geo.window.scroll.top},d.coord={left:p.left+(d.coord.left-c.geo.origin.windowOffset.left),top:p.top+(d.coord.top-c.geo.origin.windowOffset.top)},e.__sideChange(e.__instance._$tooltip,d.side),c.geo.origin.fixedLineage?e.__instance._$tooltip.css("position","fixed"):e.__instance._$tooltip.css("position",""),e.__instance._$tooltip.css({left:d.coord.left,top:d.coord.top,height:d.size.height,width:d.size.width}).find(".tooltipster-arrow").css({left:"",top:""}).css(n.prop,n.val),e.__instance._$tooltip.appendTo(e.__instance.option("parent")),e.__instance._trigger({type:"repositioned",event:b,position:d})},__sideChange:function(a,b){a.removeClass("tooltipster-bottom").removeClass("tooltipster-left").removeClass("tooltipster-right").removeClass("tooltipster-top").addClass("tooltipster-"+b)},__targetFind:function(a){var b={},c=this.__instance._$origin[0].getClientRects();if(c.length>1){var d=this.__instance._$origin.css("opacity");1==d&&(this.__instance._$origin.css("opacity",.99),c=this.__instance._$origin[0].getClientRects(),this.__instance._$origin.css("opacity",1))}if(c.length<2)b.top=Math.floor(a.geo.origin.windowOffset.left+a.geo.origin.size.width/2),b.bottom=b.top,b.left=Math.floor(a.geo.origin.windowOffset.top+a.geo.origin.size.height/2),b.right=b.left;else{var e=c[0];b.top=Math.floor(e.left+(e.right-e.left)/2),e=c.length>2?c[Math.ceil(c.length/2)-1]:c[0],b.right=Math.floor(e.top+(e.bottom-e.top)/2),e=c[c.length-1],b.bottom=Math.floor(e.left+(e.right-e.left)/2),e=c.length>2?c[Math.ceil((c.length+1)/2)-1]:c[c.length-1],b.left=Math.floor(e.top+(e.bottom-e.top)/2)}return b}}}),a});;
/*
 jQuery Birthday Picker: v1.4 - 10/16/2011
 http://abecoffman.com/stuff/birthdaypicker

 Copyright (c) 2010 Abe Coffman
 Dual licensed under the MIT and GPL licenses.

*/
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,g,d){a instanceof String&&(a=String(a));for(var e=a.length,f=0;f<e;f++){var c=a[f];if(g.call(d,c,f,a))return{i:f,v:c}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,g,d){a!=Array.prototype&&a!=Object.prototype&&(a[g]=d.value)};$jscomp.getGlobal=function(a){a=["object"==typeof globalThis&&globalThis,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,a];for(var g=0;g<a.length;++g){var d=a[g];if(d&&d.Math==Math)return d}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,g,d,e){if(g){d=$jscomp.global;a=a.split(".");for(e=0;e<a.length-1;e++){var f=a[e];f in d||(d[f]={});d=d[f]}a=a[a.length-1];e=d[a];g=g(e);g!=e&&null!=g&&$jscomp.defineProperty(d,a,{configurable:!0,writable:!0,value:g})}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,d){return $jscomp.findInternal(this,a,d).v}},"es6","es3");
(function(a){switch(cabinetLanguage){case "en":var g={"short":"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),"long":"January February March April May June July August September October November December".split(" ")};break;case "ua":g={"short":"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),"long":"C\u0456\u0447\u0435\u043d\u044c \u041b\u044e\u0442\u0438\u0439 \u0411\u0435\u0440\u0435\u0437\u0435\u043d\u044c \u041a\u0432\u0456\u0442\u0435\u043d\u044c \u0422\u0440\u0430\u0432\u0435\u043d\u044c \u0427\u0435\u0440\u0432\u0435\u043d\u044c \u041b\u0438\u043f\u0435\u043d\u044c \u0421\u0435\u0440\u043f\u0435\u043d\u044c \u0412\u0435\u0440\u0435\u0441\u0435\u043d\u044c \u0416\u043e\u0432\u0442\u0435\u043d\u044c \u041b\u0438\u0441\u0442\u043e\u043f\u0430\u0434 \u0413\u0440\u0443\u0434\u0435\u043d\u044c".split(" ")};
break;case "ru":g={"short":"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),"long":"\u042f\u043d\u0432\u0430\u0440\u044c \u0424\u0435\u0432\u0440\u0430\u043b\u044c \u041c\u0430\u0440\u0442 \u0410\u043f\u0440\u0435\u043b\u044c \u041c\u0430\u0439 \u0418\u044e\u043d\u044c \u0418\u044e\u043b\u044c \u0410\u0432\u0433\u0443\u0441\u0442 \u0421\u0435\u043d\u0442\u044f\u0431\u0440\u044c \u041e\u043a\u0442\u044f\u0431\u0440\u044c \u041d\u043e\u044f\u0431\u0440\u044c \u0414\u0435\u043a\u0430\u0431\u0440\u044c".split(" ")};
break;case "lt":g={"short":"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),"long":"Sausis Vasaris Kovas Balandis Gegu\u017e\u0117 Bir\u017eelis Liepa Rugpj\u016btis Rugs\u0117jis Spalis Lapkritis Gruodis".split(" ")}}var d=new Date,e=d.getFullYear();d.getMonth();d.getDate();a.fn.birthdaypicker=function(d){var c={maxAge:120,minAge:0,futureDates:!1,maxYear:e,dateFormat:"middleEndian",monthFormat:"short",placeholder:!0,legend:"",defaultDate:!1,fieldName:"birthdate",fieldId:"birthdate",hiddenDate:!0,
onChange:null,tabindex:null};return this.each(function(){d&&a.extend(c,d);var f=a("<fieldset class='birthday-picker'></fieldset>"),n=a("<select class='birth-year' name='birth[year]'></select>"),k=a("<select class='birth-month' name='birth[month]'></select>"),h=a("<select class='birth-day' name='birth[day]'></select>");c.legend&&a("<legend>"+c.legend+"</legend>").appendTo(f);var b=c.tabindex;"bigEndian"==c.dateFormat?(f.append(n).append(k).append(h),null!=b&&(n.attr("tabindex",b),k.attr("tabindex",
b++),h.attr("tabindex",b++))):"littleEndian"==c.dateFormat?(f.append(h).append(k).append(n),null!=b&&(h.attr("tabindex",b),k.attr("tabindex",b++),n.attr("tabindex",b++))):(f.append(k).append(h).append(n),null!=b&&(k.attr("tabindex",b),h.attr("tabindex",b++),n.attr("tabindex",b++)));if(c.placeholder)switch(cabinetLanguage){case "en":a("<option value='0'>Year of birth </option>").appendTo(n);a("<option value='0'>Month </option>").appendTo(k);a("<option value='0'>Day </option>").appendTo(h);break;case "ua":a("<option value='0'>\u0420\u0456\u043a \u043d\u0430\u0440\u043e\u0434\u0436\u0435\u043d\u043d\u044f </option>").appendTo(n);
a("<option value='0'>\u041c\u0456\u0441\u044f\u0446\u044c </option>").appendTo(k);a("<option value='0'>\u0414\u0435\u043d\u044c </option>").appendTo(h);break;case "ru":a("<option value='0'>\u0413\u043e\u0434 \u0440\u043e\u0436\u0434\u0435\u043d\u0438\u044f </option>").appendTo(n),a("<option value='0'>\u041c\u0435\u0441\u044f\u0446 </option>").appendTo(k),a("<option value='0'>\u0414\u0435\u043d\u044c </option>").appendTo(h)}if(c.defaultDate){var m=new Date(c.defaultDate+"T00:00:00");b=m.getFullYear();
var l=m.getMonth()+1;m=m.getDate();10>l&&(l="0"+l);10>m&&(m="0"+m);var r=b+"-"+l+"-"+m}c.hiddenDate&&a("<input type='hidden' name='"+c.fieldName+"'/>").attr("id",c.fieldId).val(r).appendTo(f);var t=e-c.minAge;b=e-c.maxAge;c.futureDates&&c.maxYear!=e&&(t=1E3<c.maxYear?c.maxYear:e+c.maxYear);for(l=t;l>=b;l--)a("<option></option>").attr("value",l).text(l).appendTo(n);for(b=0;12>b;b++)a("<option></option>").attr("value",b+1).text(g[c.monthFormat][b]).appendTo(k);for(b=1;32>b;b++)a("<option></option>").attr("value",
b).text(b).appendTo(h);a(this).append(f);c.defaultDate&&(b=new Date(c.defaultDate+"T00:00:00"),n.val(b.getFullYear()),k.val(b.getMonth()+1),h.val(b.getDate()));f.change(function(){var b=new Date;b.getFullYear();var d=b.getMonth()+1;b=b.getDate();var f=parseInt(n.val(),10),e=parseInt(k.val(),10),l=parseInt(h.val(),10),m=(new Date(f,e,0)).getDate(),q=parseInt(k.children(":last").val()),p=parseInt(h.children(":last").val());if(p>m)for(;p>m;)h.children(":last").remove(),p--;else if(p<m)for(;p<m;)p++,
h.append("<option value="+p+">"+p+"</option>");if(!c.futureDates&&f==t){if(q>d){for(;q>d;)k.children(":last").remove(),q--;h.children(":first").attr("selected","selected")}if(e===d)for(;p>b;)h.children(":last").remove(),--p}if(f!=t&&12!=q)for(;12>q;)k.append("<option value="+(q+1)+">"+g[c.monthFormat][q]+"</option>"),q++;if(0!=f*e*l&&(10>e&&(e="0"+e),10>l&&(l="0"+l),r=f+"-"+e+"-"+l,a(this).find("#"+c.fieldId).val(r),null!=c.onChange))c.onChange(r)})})}})(jQuery);
;
$(document).ready(function(){$(".ccPopupTrigger").on("click",function(a){a=$(this).attr("data-ccPopupId");$("#"+a).is(":visible")?$("#"+a).fadeOut():($(".ccPopup").fadeOut(),$("#"+a).show(),setccPopupArrow())})});
function setccPopupArrow(){if(991>$(window).width()){var a=$(window).width()-$("#cabinetUserAvatarTopRight").offset().left+5;$("#usernamePopup .arrowtop").css("right",Math.round(a-58));$("#usernamePopup .arrowbottom").css("right",Math.round(a-58)+1)}else $("#usernamePopup .arrowtop").css("right",70),$("#usernamePopup .arrowbottom").css("right",71),$("#clinicPopup .arrowtop").css("left",110),$("#clinicPopup .arrowbottom").css("left",111)};
;
$(document).ready(function(){$("body").on("click",function(a){a=$(a.target);a.parents(".showSmallerImageInZoomToggleLi").length||a.parents(".showBinotelClinicMemberSwitcherToggleLi").length||(a.parents(".ccPopupTrigger").length||a.hasClass("ccPopupTrigger")||$(".ccPopup").fadeOut(),"undefined"==typeof patientStatusSelectIsOpened||!patientStatusSelectIsOpened||a.parents(".patientStatusInlineSelect").length||a.hasClass("patientStatusInlineSelect")||(patientStatusSelectIsOpened=!1,$(".patientHeader .patientStatusInlineSelect, .patientsListItem .patientStatusInlineSelect").fadeOut().remove()),
"undefined"==typeof visitImageSelectIsOpened||!visitImageSelectIsOpened||a.parents(".visitImageSelectContainerWrap").length||a.hasClass("visitImageSelectContainerWrap")||(visitImageSelectIsOpened=!1,$(".visitImageSelectPicker").fadeOut("fast"),$("#scheduleFilterModalAddHeight").hide()))})});
;
$(document).ready(function(){var c=0;$("body").on("click",".orderCommentFiles",function(a){$("#fileOrderingContainer").html("...");var b=$(this).attr("data-commentId");ajax({url:"/cabinet/comments/get-ordering-html",data:{commentId:b},success:function(a){c=b;"undefined"!=typeof a.html&&($("#filesOrderModal").css("opacity",.01),$("#fileOrderingContainer").html(a.html),a=Math.floor($(".commentWrap .right").width()/$(".dentbookThumbnail").width()),$("#filesOrderModal").modal("show"),a=($("#fileOrderingContainer").width()-
1)/a-1,$("#sortableCommentFiles li img").not(".fileTypeIcon").css("width",a),window.dispatchEvent(new Event("resize")),$("#sortableCommentFiles").sortable(),$("#sortableCommentFiles").disableSelection(),setTimeout(function(){$("#filesOrderModal").css("opacity",1)},50))}})});$("body").on("click","#fileOrderingOrderingDone",function(a){a=$("#sortableCommentFiles").sortable("toArray");for(var b in a)a[b]=a[b].substring(13);a=a.join(",");ajax({url:"/cabinet/comments/save-files-order",data:{commentId:c,
order:a},success:function(a){$("#filesOrderModal").modal("hide");$("#fileOrderingContainer").html("...");inserCommentFromAjax(a)}})})});
;
$(document).ready(function(){$("body").on("click",".stagesSearchButton",function(a){a=$("#stagesSearchInput").val();ajax({url:"/cabinet/search/ajax",data:{q:a},success:function(a){$("#stagesSearchResults").html(a.results)}})});$("body").on("keyup","#stagesSearchInput",function(a){13==a.keyCode&&$(".stagesSearchButton").trigger("click")});$("body").on("click",".searchStagesLink",function(a){stageIdToScrollTo=$(this).attr("data-stageId")})});
(function(a){a.fn.focusTextToEnd=function(){this.focus();var a=this.val();this.val("").val(a);return this}})(jQuery);
;
$(document).ready(function(){window.showWarning=false;var standalone=window.navigator.standalone,userAgent=window.navigator.userAgent.toLowerCase(),safari=/safari/.test(userAgent),ios=/iphone|ipod|ipad/.test(userAgent);if(ios)if(!standalone&&safari);else if(standalone&&!safari);else{if(!standalone&&!safari)document.location="getiosonesignalplayerid://yes"}else;});
function saveIosOneSignalPlayerId(playerId){if(typeof playerId!="undefined"&&playerId.length>10)ajax({url:"/cabinet/push/save-ios-player-id",data:{playerId:playerId},success:function(data){}})}function callNativeApp(){try{webkit.messageHandlers.callbackHandler.postMessage("getiosonesignalplayerid")}catch(err){}}function changeLocationOnIosNotificationClick(url){}$(document).ready(function(){callNativeApp()});
;
$("body").on("submit","#contactForm",function(a){a.preventDefault();a=$("#contactForm_message").val();a.length?ajax({url:"/cabinet/help/sendMessage",data:{message:a},success:function(a){$(".helpMessageNotSent").remove();$(".helpMessageSent").fadeIn()}}):$("#error_contactForm_message").fadeIn()});
;
(function(){function require(name){var module=require.modules[name];if(!module)throw new Error('failed to require "'+name+'"');if(!("exports"in module)&&typeof module.definition==="function"){module.client=module.component=true;module.definition.call(this,module.exports={},module);delete module.definition}return module.exports}require.loader="component";require.helper={};require.helper.semVerSort=function(a,b){var aArray=a.version.split(".");var bArray=b.version.split(".");for(var i=0;i<aArray.length;++i){var aInt=parseInt(aArray[i],10);var bInt=parseInt(bArray[i],10);if(aInt===bInt){var aLex=aArray[i].substr((""+aInt).length);var bLex=bArray[i].substr((""+bInt).length);if(aLex===""&&bLex!=="")return 1;if(aLex!==""&&bLex==="")return-1;if(aLex!==""&&bLex!=="")return aLex>bLex?1:-1;continue}else if(aInt>bInt){return 1}else{return-1}}return 0};require.latest=function(name,returnPath){function showError(name){throw new Error('failed to find latest module of "'+name+'"')}var versionRegexp=/(.*)~(.*)@v?(\d+\.\d+\.\d+[^\/]*)$/;var remoteRegexp=/(.*)~(.*)/;if(!remoteRegexp.test(name))showError(name);var moduleNames=Object.keys(require.modules);var semVerCandidates=[];var otherCandidates=[];for(var i=0;i<moduleNames.length;i++){var moduleName=moduleNames[i];if(new RegExp(name+"@").test(moduleName)){var version=moduleName.substr(name.length+1);var semVerMatch=versionRegexp.exec(moduleName);if(semVerMatch!=null){semVerCandidates.push({version:version,name:moduleName})}else{otherCandidates.push({version:version,name:moduleName})}}}if(semVerCandidates.concat(otherCandidates).length===0){showError(name)}if(semVerCandidates.length>0){var module=semVerCandidates.sort(require.helper.semVerSort).pop().name;if(returnPath===true){return module}return require(module)}var module=otherCandidates.sort(function(a,b){return a.name>b.name})[0].name;if(returnPath===true){return module}return require(module)};require.modules={};require.register=function(name,definition){require.modules[name]={definition:definition}};require.define=function(name,exports){require.modules[name]={exports:exports}};require.register("abpetkov~transitionize@0.0.3",function(exports,module){module.exports=Transitionize;function Transitionize(element,props){if(!(this instanceof Transitionize))return new Transitionize(element,props);this.element=element;this.props=props||{};this.init()}Transitionize.prototype.isSafari=function(){return/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor)};Transitionize.prototype.init=function(){var transitions=[];for(var key in this.props){transitions.push(key+" "+this.props[key])}this.element.style.transition=transitions.join(", ");if(this.isSafari())this.element.style.webkitTransition=transitions.join(", ")}});require.register("ftlabs~fastclick@v0.6.11",function(exports,module){function FastClick(layer){"use strict";var oldOnClick,self=this;this.trackingClick=false;this.trackingClickStart=0;this.targetElement=null;this.touchStartX=0;this.touchStartY=0;this.lastTouchIdentifier=0;this.touchBoundary=10;this.layer=layer;if(!layer||!layer.nodeType){throw new TypeError("Layer must be a document node")}this.onClick=function(){return FastClick.prototype.onClick.apply(self,arguments)};this.onMouse=function(){return FastClick.prototype.onMouse.apply(self,arguments)};this.onTouchStart=function(){return FastClick.prototype.onTouchStart.apply(self,arguments)};this.onTouchMove=function(){return FastClick.prototype.onTouchMove.apply(self,arguments)};this.onTouchEnd=function(){return FastClick.prototype.onTouchEnd.apply(self,arguments)};this.onTouchCancel=function(){return FastClick.prototype.onTouchCancel.apply(self,arguments)};if(FastClick.notNeeded(layer)){return}if(this.deviceIsAndroid){layer.addEventListener("mouseover",this.onMouse,true);layer.addEventListener("mousedown",this.onMouse,true);layer.addEventListener("mouseup",this.onMouse,true)}layer.addEventListener("click",this.onClick,true);layer.addEventListener("touchstart",this.onTouchStart,false);layer.addEventListener("touchmove",this.onTouchMove,false);layer.addEventListener("touchend",this.onTouchEnd,false);layer.addEventListener("touchcancel",this.onTouchCancel,false);if(!Event.prototype.stopImmediatePropagation){layer.removeEventListener=function(type,callback,capture){var rmv=Node.prototype.removeEventListener;if(type==="click"){rmv.call(layer,type,callback.hijacked||callback,capture)}else{rmv.call(layer,type,callback,capture)}};layer.addEventListener=function(type,callback,capture){var adv=Node.prototype.addEventListener;if(type==="click"){adv.call(layer,type,callback.hijacked||(callback.hijacked=function(event){if(!event.propagationStopped){callback(event)}}),capture)}else{adv.call(layer,type,callback,capture)}}}if(typeof layer.onclick==="function"){oldOnClick=layer.onclick;layer.addEventListener("click",function(event){oldOnClick(event)},false);layer.onclick=null}}FastClick.prototype.deviceIsAndroid=navigator.userAgent.indexOf("Android")>0;FastClick.prototype.deviceIsIOS=/iP(ad|hone|od)/.test(navigator.userAgent);FastClick.prototype.deviceIsIOS4=FastClick.prototype.deviceIsIOS&&/OS 4_\d(_\d)?/.test(navigator.userAgent);FastClick.prototype.deviceIsIOSWithBadTarget=FastClick.prototype.deviceIsIOS&&/OS ([6-9]|\d{2})_\d/.test(navigator.userAgent);FastClick.prototype.needsClick=function(target){"use strict";switch(target.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(target.disabled){return true}break;case"input":if(this.deviceIsIOS&&target.type==="file"||target.disabled){return true}break;case"label":case"video":return true}return/\bneedsclick\b/.test(target.className)};FastClick.prototype.needsFocus=function(target){"use strict";switch(target.nodeName.toLowerCase()){case"textarea":return true;case"select":return!this.deviceIsAndroid;case"input":switch(target.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return false}return!target.disabled&&!target.readOnly;default:return/\bneedsfocus\b/.test(target.className)}};FastClick.prototype.sendClick=function(targetElement,event){"use strict";var clickEvent,touch;if(document.activeElement&&document.activeElement!==targetElement){document.activeElement.blur()}touch=event.changedTouches[0];clickEvent=document.createEvent("MouseEvents");clickEvent.initMouseEvent(this.determineEventType(targetElement),true,true,window,1,touch.screenX,touch.screenY,touch.clientX,touch.clientY,false,false,false,false,0,null);clickEvent.forwardedTouchEvent=true;targetElement.dispatchEvent(clickEvent)};FastClick.prototype.determineEventType=function(targetElement){"use strict";if(this.deviceIsAndroid&&targetElement.tagName.toLowerCase()==="select"){return"mousedown"}return"click"};FastClick.prototype.focus=function(targetElement){"use strict";var length;if(this.deviceIsIOS&&targetElement.setSelectionRange&&targetElement.type.indexOf("date")!==0&&targetElement.type!=="time"){length=targetElement.value.length;targetElement.setSelectionRange(length,length)}else{targetElement.focus()}};FastClick.prototype.updateScrollParent=function(targetElement){"use strict";var scrollParent,parentElement;scrollParent=targetElement.fastClickScrollParent;if(!scrollParent||!scrollParent.contains(targetElement)){parentElement=targetElement;do{if(parentElement.scrollHeight>parentElement.offsetHeight){scrollParent=parentElement;targetElement.fastClickScrollParent=parentElement;break}parentElement=parentElement.parentElement}while(parentElement)}if(scrollParent){scrollParent.fastClickLastScrollTop=scrollParent.scrollTop}};FastClick.prototype.getTargetElementFromEventTarget=function(eventTarget){"use strict";if(eventTarget.nodeType===Node.TEXT_NODE){return eventTarget.parentNode}return eventTarget};FastClick.prototype.onTouchStart=function(event){"use strict";var targetElement,touch,selection;if(event.targetTouches.length>1){return true}targetElement=this.getTargetElementFromEventTarget(event.target);touch=event.targetTouches[0];if(this.deviceIsIOS){selection=window.getSelection();if(selection.rangeCount&&!selection.isCollapsed){return true}if(!this.deviceIsIOS4){if(touch.identifier===this.lastTouchIdentifier){event.preventDefault();return false}this.lastTouchIdentifier=touch.identifier;this.updateScrollParent(targetElement)}}this.trackingClick=true;this.trackingClickStart=event.timeStamp;this.targetElement=targetElement;this.touchStartX=touch.pageX;this.touchStartY=touch.pageY;if(event.timeStamp-this.lastClickTime<200){event.preventDefault()}return true};FastClick.prototype.touchHasMoved=function(event){"use strict";var touch=event.changedTouches[0],boundary=this.touchBoundary;if(Math.abs(touch.pageX-this.touchStartX)>boundary||Math.abs(touch.pageY-this.touchStartY)>boundary){return true}return false};FastClick.prototype.onTouchMove=function(event){"use strict";if(!this.trackingClick){return true}if(this.targetElement!==this.getTargetElementFromEventTarget(event.target)||this.touchHasMoved(event)){this.trackingClick=false;this.targetElement=null}return true};FastClick.prototype.findControl=function(labelElement){"use strict";if(labelElement.control!==undefined){return labelElement.control}if(labelElement.htmlFor){return document.getElementById(labelElement.htmlFor)}return labelElement.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")};FastClick.prototype.onTouchEnd=function(event){"use strict";var forElement,trackingClickStart,targetTagName,scrollParent,touch,targetElement=this.targetElement;if(!this.trackingClick){return true}if(event.timeStamp-this.lastClickTime<200){this.cancelNextClick=true;return true}this.cancelNextClick=false;this.lastClickTime=event.timeStamp;trackingClickStart=this.trackingClickStart;this.trackingClick=false;this.trackingClickStart=0;if(this.deviceIsIOSWithBadTarget){touch=event.changedTouches[0];targetElement=document.elementFromPoint(touch.pageX-window.pageXOffset,touch.pageY-window.pageYOffset)||targetElement;targetElement.fastClickScrollParent=this.targetElement.fastClickScrollParent}targetTagName=targetElement.tagName.toLowerCase();if(targetTagName==="label"){forElement=this.findControl(targetElement);if(forElement){this.focus(targetElement);if(this.deviceIsAndroid){return false}targetElement=forElement}}else if(this.needsFocus(targetElement)){if(event.timeStamp-trackingClickStart>100||this.deviceIsIOS&&window.top!==window&&targetTagName==="input"){this.targetElement=null;return false}this.focus(targetElement);if(!this.deviceIsIOS4||targetTagName!=="select"){this.targetElement=null;event.preventDefault()}return false}if(this.deviceIsIOS&&!this.deviceIsIOS4){scrollParent=targetElement.fastClickScrollParent;if(scrollParent&&scrollParent.fastClickLastScrollTop!==scrollParent.scrollTop){return true}}if(!this.needsClick(targetElement)){event.preventDefault();this.sendClick(targetElement,event)}return false};FastClick.prototype.onTouchCancel=function(){"use strict";this.trackingClick=false;this.targetElement=null};FastClick.prototype.onMouse=function(event){"use strict";if(!this.targetElement){return true}if(event.forwardedTouchEvent){return true}if(!event.cancelable){return true}if(!this.needsClick(this.targetElement)||this.cancelNextClick){if(event.stopImmediatePropagation){event.stopImmediatePropagation()}else{event.propagationStopped=true}event.stopPropagation();event.preventDefault();return false}return true};FastClick.prototype.onClick=function(event){"use strict";var permitted;if(this.trackingClick){this.targetElement=null;this.trackingClick=false;return true}if(event.target.type==="submit"&&event.detail===0){return true}permitted=this.onMouse(event);if(!permitted){this.targetElement=null}return permitted};FastClick.prototype.destroy=function(){"use strict";var layer=this.layer;if(this.deviceIsAndroid){layer.removeEventListener("mouseover",this.onMouse,true);layer.removeEventListener("mousedown",this.onMouse,true);layer.removeEventListener("mouseup",this.onMouse,true)}layer.removeEventListener("click",this.onClick,true);layer.removeEventListener("touchstart",this.onTouchStart,false);layer.removeEventListener("touchmove",this.onTouchMove,false);layer.removeEventListener("touchend",this.onTouchEnd,false);layer.removeEventListener("touchcancel",this.onTouchCancel,false)};FastClick.notNeeded=function(layer){"use strict";var metaViewport;var chromeVersion;if(typeof window.ontouchstart==="undefined"){return true}chromeVersion=+(/Chrome\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1];if(chromeVersion){if(FastClick.prototype.deviceIsAndroid){metaViewport=document.querySelector("meta[name=viewport]");if(metaViewport){if(metaViewport.content.indexOf("user-scalable=no")!==-1){return true}if(chromeVersion>31&&window.innerWidth<=window.screen.width){return true}}}else{return true}}if(layer.style.msTouchAction==="none"){return true}return false};FastClick.attach=function(layer){"use strict";return new FastClick(layer)};if(typeof define!=="undefined"&&define.amd){define(function(){"use strict";return FastClick})}else if(typeof module!=="undefined"&&module.exports){module.exports=FastClick.attach;module.exports.FastClick=FastClick}else{window.FastClick=FastClick}});require.register("component~indexof@0.0.3",function(exports,module){module.exports=function(arr,obj){if(arr.indexOf)return arr.indexOf(obj);for(var i=0;i<arr.length;++i){if(arr[i]===obj)return i}return-1}});require.register("component~classes@1.2.1",function(exports,module){var index=require("component~indexof@0.0.3");var re=/\s+/;var toString=Object.prototype.toString;module.exports=function(el){return new ClassList(el)};function ClassList(el){if(!el)throw new Error("A DOM element reference is required");this.el=el;this.list=el.classList}ClassList.prototype.add=function(name){if(this.list){this.list.add(name);return this}var arr=this.array();var i=index(arr,name);if(!~i)arr.push(name);this.el.className=arr.join(" ");return this};ClassList.prototype.remove=function(name){if("[object RegExp]"==toString.call(name)){return this.removeMatching(name)}if(this.list){this.list.remove(name);return this}var arr=this.array();var i=index(arr,name);if(~i)arr.splice(i,1);this.el.className=arr.join(" ");return this};ClassList.prototype.removeMatching=function(re){var arr=this.array();for(var i=0;i<arr.length;i++){if(re.test(arr[i])){this.remove(arr[i])}}return this};ClassList.prototype.toggle=function(name,force){if(this.list){if("undefined"!==typeof force){if(force!==this.list.toggle(name,force)){this.list.toggle(name)}}else{this.list.toggle(name)}return this}if("undefined"!==typeof force){if(!force){this.remove(name)}else{this.add(name)}}else{if(this.has(name)){this.remove(name)}else{this.add(name)}}return this};ClassList.prototype.array=function(){var str=this.el.className.replace(/^\s+|\s+$/g,"");var arr=str.split(re);if(""===arr[0])arr.shift();return arr};ClassList.prototype.has=ClassList.prototype.contains=function(name){return this.list?this.list.contains(name):!!~index(this.array(),name)}});require.register("component~event@0.1.4",function(exports,module){var bind=window.addEventListener?"addEventListener":"attachEvent",unbind=window.removeEventListener?"removeEventListener":"detachEvent",prefix=bind!=="addEventListener"?"on":"";exports.bind=function(el,type,fn,capture){el[bind](prefix+type,fn,capture||false);return fn};exports.unbind=function(el,type,fn,capture){el[unbind](prefix+type,fn,capture||false);return fn}});require.register("component~query@0.0.3",function(exports,module){function one(selector,el){return el.querySelector(selector)}exports=module.exports=function(selector,el){el=el||document;return one(selector,el)};exports.all=function(selector,el){el=el||document;return el.querySelectorAll(selector)};exports.engine=function(obj){if(!obj.one)throw new Error(".one callback required");if(!obj.all)throw new Error(".all callback required");one=obj.one;exports.all=obj.all;return exports}});require.register("component~matches-selector@0.1.5",function(exports,module){var query=require("component~query@0.0.3");var proto=Element.prototype;var vendor=proto.matches||proto.webkitMatchesSelector||proto.mozMatchesSelector||proto.msMatchesSelector||proto.oMatchesSelector;module.exports=match;function match(el,selector){if(!el||el.nodeType!==1)return false;if(vendor)return vendor.call(el,selector);var nodes=query.all(selector,el.parentNode);for(var i=0;i<nodes.length;++i){if(nodes[i]==el)return true}return false}});require.register("component~closest@0.1.4",function(exports,module){var matches=require("component~matches-selector@0.1.5");module.exports=function(element,selector,checkYoSelf,root){element=checkYoSelf?{parentNode:element}:element;root=root||document;while((element=element.parentNode)&&element!==document){if(matches(element,selector))return element;if(element===root)return}}});require.register("component~delegate@0.2.3",function(exports,module){var closest=require("component~closest@0.1.4"),event=require("component~event@0.1.4");exports.bind=function(el,selector,type,fn,capture){return event.bind(el,type,function(e){var target=e.target||e.srcElement;e.delegateTarget=closest(target,selector,true,el);if(e.delegateTarget)fn.call(el,e)},capture)};exports.unbind=function(el,type,fn,capture){event.unbind(el,type,fn,capture)}});require.register("component~events@1.0.9",function(exports,module){var events=require("component~event@0.1.4");var delegate=require("component~delegate@0.2.3");module.exports=Events;function Events(el,obj){if(!(this instanceof Events))return new Events(el,obj);if(!el)throw new Error("element required");if(!obj)throw new Error("object required");this.el=el;this.obj=obj;this._events={}}Events.prototype.sub=function(event,method,cb){this._events[event]=this._events[event]||{};this._events[event][method]=cb};Events.prototype.bind=function(event,method){var e=parse(event);var el=this.el;var obj=this.obj;var name=e.name;var method=method||"on"+name;var args=[].slice.call(arguments,2);function cb(){var a=[].slice.call(arguments).concat(args);obj[method].apply(obj,a)}if(e.selector){cb=delegate.bind(el,e.selector,name,cb)}else{events.bind(el,name,cb)}this.sub(name,method,cb);return cb};Events.prototype.unbind=function(event,method){if(0==arguments.length)return this.unbindAll();if(1==arguments.length)return this.unbindAllOf(event);var bindings=this._events[event];if(!bindings)return;var cb=bindings[method];if(!cb)return;events.unbind(this.el,event,cb)};Events.prototype.unbindAll=function(){for(var event in this._events){this.unbindAllOf(event)}};Events.prototype.unbindAllOf=function(event){var bindings=this._events[event];if(!bindings)return;for(var method in bindings){this.unbind(event,method)}};function parse(event){var parts=event.split(/ +/);return{name:parts.shift(),selector:parts.join(" ")}}});require.register("switchery",function(exports,module){var transitionize=require("abpetkov~transitionize@0.0.3"),fastclick=require("ftlabs~fastclick@v0.6.11"),classes=require("component~classes@1.2.1"),events=require("component~events@1.0.9");module.exports=Switchery;var defaults={color:"#64bd63",secondaryColor:"#dfdfdf",jackColor:"#fff",jackSecondaryColor:null,className:"switchery",disabled:false,disabledOpacity:.5,speed:"0.4s",size:"default"};function Switchery(element,options){if(!(this instanceof Switchery))return new Switchery(element,options);this.element=element;this.options=options||{};for(var i in defaults){if(this.options[i]==null){this.options[i]=defaults[i]}}if(this.element!=null&&this.element.type=="checkbox")this.init();if(this.isDisabled()===true)this.disable()}Switchery.prototype.hide=function(){this.element.style.display="none"};Switchery.prototype.show=function(){var switcher=this.create();this.insertAfter(this.element,switcher)};Switchery.prototype.create=function(){this.switcher=document.createElement("span");this.jack=document.createElement("small");this.switcher.appendChild(this.jack);this.switcher.className=this.options.className;this.events=events(this.switcher,this);return this.switcher};Switchery.prototype.insertAfter=function(reference,target){reference.parentNode.insertBefore(target,reference.nextSibling)};Switchery.prototype.setPosition=function(clicked){var checked=this.isChecked(),switcher=this.switcher,jack=this.jack;if(clicked&&checked)checked=false;else if(clicked&&!checked)checked=true;if(checked===true){this.element.checked=true;if(window.getComputedStyle)jack.style.left=parseInt(window.getComputedStyle(switcher).width)-parseInt(window.getComputedStyle(jack).width)+"px";else jack.style.left=parseInt(switcher.currentStyle["width"])-parseInt(jack.currentStyle["width"])+"px";if(this.options.color)this.colorize();this.setSpeed()}else{jack.style.left=0;this.element.checked=false;this.switcher.style.boxShadow="inset 0 0 0 0 "+this.options.secondaryColor;this.switcher.style.borderColor=this.options.secondaryColor;this.switcher.style.backgroundColor=this.options.secondaryColor!==defaults.secondaryColor?this.options.secondaryColor:"#fff";this.jack.style.backgroundColor=this.options.jackSecondaryColor!==this.options.jackColor?this.options.jackSecondaryColor:this.options.jackColor;this.setSpeed()}};Switchery.prototype.setSpeed=function(){var switcherProp={},jackProp={"background-color":this.options.speed,left:this.options.speed.replace(/[a-z]/,"")/2+"s"};if(this.isChecked()){switcherProp={border:this.options.speed,"box-shadow":this.options.speed,"background-color":this.options.speed.replace(/[a-z]/,"")*3+"s"}}else{switcherProp={border:this.options.speed,"box-shadow":this.options.speed}}transitionize(this.switcher,switcherProp);transitionize(this.jack,jackProp)};Switchery.prototype.setSize=function(){var small="switchery-small",normal="switchery-default",large="switchery-large";switch(this.options.size){case"small":classes(this.switcher).add(small);break;case"large":classes(this.switcher).add(large);break;default:classes(this.switcher).add(normal);break}};Switchery.prototype.colorize=function(){var switcherHeight=this.switcher.offsetHeight/2;this.switcher.style.backgroundColor=this.options.color;this.switcher.style.borderColor=this.options.color;this.switcher.style.boxShadow="inset 0 0 0 "+switcherHeight+"px "+this.options.color;this.jack.style.backgroundColor=this.options.jackColor};Switchery.prototype.handleOnchange=function(state){if(document.dispatchEvent){var event=document.createEvent("HTMLEvents");event.initEvent("change",true,true);this.element.dispatchEvent(event)}else{this.element.fireEvent("onchange")}};Switchery.prototype.handleChange=function(){var self=this,el=this.element;if(el.addEventListener){el.addEventListener("change",function(){self.setPosition()})}else{el.attachEvent("onchange",function(){self.setPosition()})}};Switchery.prototype.handleClick=function(){var switcher=this.switcher;fastclick(switcher);this.events.bind("click","bindClick")};Switchery.prototype.bindClick=function(){var parent=this.element.parentNode.tagName.toLowerCase(),labelParent=parent==="label"?false:true;this.setPosition(labelParent);this.handleOnchange(this.element.checked)};Switchery.prototype.markAsSwitched=function(){this.element.setAttribute("data-switchery",true)};Switchery.prototype.markedAsSwitched=function(){return this.element.getAttribute("data-switchery")};Switchery.prototype.init=function(){this.hide();this.show();this.setSize();this.setPosition();this.markAsSwitched();this.handleChange();this.handleClick()};Switchery.prototype.isChecked=function(){return this.element.checked};Switchery.prototype.isDisabled=function(){return this.options.disabled||this.element.disabled||this.element.readOnly};Switchery.prototype.destroy=function(){this.events.unbind()};Switchery.prototype.enable=function(){if(!this.options.disabled)return;if(this.options.disabled)this.options.disabled=false;if(this.element.disabled)this.element.disabled=false;if(this.element.readOnly)this.element.readOnly=false;this.switcher.style.opacity=1;this.events.bind("click","bindClick")};Switchery.prototype.disable=function(){if(this.options.disabled)return;if(!this.options.disabled)this.options.disabled=true;if(!this.element.disabled)this.element.disabled=true;if(!this.element.readOnly)this.element.readOnly=true;this.switcher.style.opacity=this.options.disabledOpacity;this.destroy()}});if(typeof exports=="object"){module.exports=require("switchery")}else if(typeof define=="function"&&define.amd){define("Switchery",[],function(){return require("switchery")})}else{(this||window)["Switchery"]=require("switchery")}})();;
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,c,b){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var f=a[e];if(c.call(b,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,b){if(a==Array.prototype||a==Object.prototype)return a;a[c]=b.value;return a};$jscomp.getGlobal=function(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var c=0;c<a.length;++c){var b=a[c];if(b&&b.Math==Math)return b}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(a,c){var b=$jscomp.propertyToPolyfillSymbol[c];if(null==b)return a[c];b=a[b];return void 0!==b?b:a[c]};
$jscomp.polyfill=function(a,c,b,d){c&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(a,c,b,d):$jscomp.polyfillUnisolated(a,c,b,d))};$jscomp.polyfillUnisolated=function(a,c,b,d){b=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in b||(b[e]={});b=b[e]}a=a[a.length-1];d=b[a];c=c(d);c!=d&&null!=c&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:c})};
$jscomp.polyfillIsolated=function(a,c,b,d){var e=a.split(".");a=1===e.length;d=e[0];d=!a&&d in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var f=0;f<e.length-1;f++){var g=e[f];g in d||(d[g]={});d=d[g]}e=e[e.length-1];b=$jscomp.IS_SYMBOL_NATIVE&&"es6"===b?d[e]:null;c=c(b);null!=c&&(a?$jscomp.defineProperty($jscomp.polyfills,e,{configurable:!0,writable:!0,value:c}):c!==b&&($jscomp.propertyToPolyfillSymbol[e]=$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(e):$jscomp.POLYFILL_PREFIX+e,e=$jscomp.propertyToPolyfillSymbol[e],
$jscomp.defineProperty(d,e,{configurable:!0,writable:!0,value:c})))};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,b){return $jscomp.findInternal(this,a,b).v}},"es6","es3");
$(document).ready(function(){$("body").on("click",".clinicChangeButton",function(a){a=$(this).attr("data-clinicId");var c=document.location.hash;"#schedule"!=c&&"#patients"!=c&&(c="#patients");selectCurrentClinic(a,c)});$("body").on("click",".changeClinicButton",function(a){a=$(this).attr("data-clinicId");var c=$(this).attr("data-hash");"undefined"==typeof c&&(c=document.location.hash);selectCurrentClinic(a,c)});$("body").on("click",".clinicAdminLink",function(a){a.preventDefault();changeLocationHash("#clinic")});
$("body").on("click",".menuSubscriptionLabel, .triggerProModal",function(a){changeLocationHash("#subscription")})});
function selectCurrentClinic(a,c){try{"undefined"!=typeof Sentry&&Sentry&&(Sentry.setTag("clinic.id",currentClinicId),Sentry.setTag("clinic.memberId",currentClinicMemberId))}catch(b){}"undefined"!=typeof a&&a!=currentClinicId&&(unsavedChanges?confirmDialog({buttonText:T.Leave,text:T["There're unsaved changes. Leave page?"],buttonColor:"white",cancelButtonText:T["Stay on page"],action:function(){unsavedChanges=!1;selectCurrentClinic(a,c)}}):($.removeCookie("addFilesFromFlow"),$("#movingFilesToFlowIndicator").hide(),
ajax({url:"/cabinet/clinic/select-clinic/"+a,success:function(b){$("#clinicSelectUl").html(b.clinicSelectHtml);currentClinicFinanceModel=parseInt(b.currentClinicFinanceModel);currentClinicMemberAccess=parseInt(b.currentClinicMemberAccess);currentClinicUsesPlans=parseInt(b.currentClinicUsesPlans);currentClinicType=parseInt(b.currentClinicType);currentClinicRounding=parseInt(b.currentClinicRounding);currentClinicShowCashDesksInMenu=parseInt(b.currentClinicShowCashDesksInMenu);for(var d in b.menuItemsVisibility)1==
b.menuItemsVisibility[d]?($("#"+d).removeClass("hide").show(),$("#header_"+d).removeClass("hide").show()):($("#"+d).hide(),$("#header_"+d).hide());currentClinicId=a;currentClinicMemberId=b.clinicMemberId;var e=$(".clinicChangeButton[data-clinicId="+currentClinicId+"]");d=e.attr("data-clinicName");e=e.find("img").attr("src");$(".menuClinicAvatar").attr("src",e);$(".currentClinicName").html(d);currentClinicMemberBinotelOperatorNumber=parseInt(b.currentClinicMemberBinotelOperatorNumber);0<currentClinicMemberBinotelOperatorNumber?
$("#showBinotelClinicMemberSwitcherToggleLi").show():$("#showBinotelClinicMemberSwitcherToggleLi").hide();$("#showBinotelClinicMemberSwitcherToggle").val(currentClinicMemberBinotelOperatorNumber);d=$.cookie("binotel_"+currentClinicId+"_"+currentClinicMemberId);toggleSwitch(".showBinotelClinicMemberSwitcherToggle",0<d?!0:!1);currentClinicShowCashDesksInMenu?$("#menuItemCashflow").show():$("#menuItemCashflow").hide();1==currentClinicType?($("#menuItemColleagues").show(),$("#menuItemColleagues").removeClass("hide")):
$("#menuItemColleagues").hide();$("body").removeClass("proVersion");1==b.pro?($(".menuSubscriptionLabel.free").hide(),$(".menuSubscriptionLabel.pro").show(),$("body").addClass("proVersion"),pro=1):($(".menuSubscriptionLabel.free").show(),$(".menuSubscriptionLabel.pro").hide(),pro=0);setQuality(b.quality);"undefined"!=typeof c?("#schedule"!=c||currentClinicType==CLINIC_TYPE_PUBLIC&&binaryAnd(currentClinicMemberAccess,ACCESS_SCHEDULE)||(c="#patients"),changeLocationHash(c)):(d=document.location.hash,
currentClinicType==CLINIC_TYPE_PUBLIC&&binaryAnd(currentClinicMemberAccess,ACCESS_SCHEDULE)&&"#schedule"==d?changeLocationHash("#schedule"):currentClinicType==CLINIC_TYPE_PUBLIC&&binaryAnd(currentClinicMemberAccess,ACCESS_SCHEDULE_ASSISTANT)&&"#schedule/assistants"==d?changeLocationHash("#schedule/assistants"):currentClinicType==CLINIC_TYPE_PUBLIC&&binaryAnd(currentClinicMemberAccess,ACCESS_SCHEDULE_ADMINISTRATOR)&&"#schedule/administrators"==d&&changeLocationHash("#schedule/administrators"));currentClinicMemberHasAccess(ACCESS_REMINDERS)?
(showNewRemindersCount(b.remindersCount),$("#header_reminders_bar").show()):$("#header_reminders_bar").hide();currentClinicMemberHasAccess(ACCESS_WAITINGS)?(showNewWaitingsCount(b.waitingsCount),$("#header_waitings_bar").show()):$("#header_waitings_bar").hide();closeMobileMenuIfOpened();$.cookie("cl",currentClinicId);currentWebsocketPageType=-1;currentClinicWssHash=b.currentClinicWssHash;updateWsPageType();window.tracking.updateButton(b.isTrackerRunning)}})))}
var CLINIC_TYPE_PRIVATE=1,CLINIC_TYPE_PUBLIC=2,ACCESS_ALL_PATIENTS=1,ACCESS_PLANS=2,ACCESS_PLANS_PRICES=4,ACCESS_PRICE_EDITING=8,ACCESS_PRICES_IN_PLANS_EDIT=8192,ACCESS_ACCESS_EDITING=16,ACCESS_CLINIC_PROFILE=32,ACCESS_PATIENTS_DELETION=128,ACCESS_SCHEDULE=64,ACCESS_SCHEDULE_CLINIC_WORK_TIME=256,ACCESS_SCHEDULE_SEES_EVERYTHING=512,ACCESS_SCHEDULE_VISITS_EDITING=1024,ACCESS_SCHEDULE_SHIFTS_EDITING=2048,ACCESS_FINANCE=4096,ACCESS_MANIPULATION_HISTORY=4194304,ACCESS_REMINDERS=32768,ACCESS_WAITINGS=8388608,
ACCESS_PATIENTS_CONTACTS=33554432,ACCESS_SCHEDULE_ASSISTANT=17179869184,ACCESS_SCHEDULE_ASSISTANT_SHIFTS_EDITING=34359738368,ACCESS_SCHEDULE_ASSISTANT_SEES_EVERYTHING=68719476736,ACCESS_SCHEDULE_ADMINISTRATOR=137438953472,ACCESS_SCHEDULE_ADMINISTRATOR_SHIFTS_EDITING=274877906944,ACCESS_SCHEDULE_ADMINISTRATOR_SEES_EVERYTHING=549755813888,ACCESS_SCHEDULE_DELETE=70368744177664;
function currentClinicMemberHasAccess(a){return!binaryAnd(currentClinicMemberAccess,a)||currentClinicType==CLINIC_TYPE_PRIVATE&&-1!=[ACCESS_PLANS,ACCESS_CLINIC_PROFILE,ACCESS_PRICE_EDITING,ACCESS_SCHEDULE,ACCESS_PLANS_PRICES,ACCESS_FINANCE,ACCESS_REMINDERS,ACCESS_WAITINGS,ACCESS_SCHEDULE_ASSISTANT,ACCESS_SCHEDULE_ASSISTANT_SHIFTS_EDITING,ACCESS_SCHEDULE_ASSISTANT_SEES_EVERYTHING,ACCESS_SCHEDULE_ADMINISTRATOR,ACCESS_SCHEDULE_ADMINISTRATOR_SHIFTS_EDITING,ACCESS_SCHEDULE_ADMINISTRATOR_SEES_EVERYTHING].indexOf(a)||
!currentClinicUsesPlans&&-1!=[ACCESS_PLANS].indexOf(a)?!1:!0}function toggleSwitch(a,c){c?$(a)[0].checked||$(a).trigger("click").attr("checked","checked"):$(a)[0].checked&&$(a).trigger("click").removeAttr("checked")}function binaryAnd(a,c){return 2147483648*(~~(a/2147483648)&~~(c/2147483648))+(a&2147483647&c&2147483647)};
;
var $confirmByPasswordAction="";
function confirmByPassword(a){0==$("#confirmByPasswordModal").length?ajax({url:"/cabinet/confirm-by-password/get-modal",success:function(a){"undefined"!=typeof a.html&&($("body").append(a.html),$("#confirmByPasswordModal").modal("show"),setTimeout(function(){$("#confirmByPasswordModalPassword").focus()},100))}}):($("#confirmByPasswordModalError").hide(),$("#confirmByPasswordModal").modal("show"),$("#confirmByPasswordModalPassword").val("").focus());$confirmByPasswordAction=a}
$("body").on("submit","#confirmByPasswordModalForm",function(a){a.preventDefault();a=$("#confirmByPasswordModalPassword").val();0==a.length?$("#confirmByPasswordModalError").show():ajax({url:"/cabinet/confirm-by-password/check-password",data:{password:a},success:function(a){1==a.result?($("#confirmByPasswordModalPassword").val(""),$("#confirmByPasswordModal").modal("hide"),$confirmByPasswordAction()):($("#confirmByPasswordModalPassword").val("").focus(),$("#confirmByPasswordModalError").show())}})});
;
$(document).ready(function(){$("body").on("click",".transferPatientToClinicButton",function(b){transferPatientModalPatientId=$(this).attr("data-patientId");ajax({url:"/cabinet/transfer-patients/get-transfer-modal-html",success:function(a){$("#transferPatientModalForm").html(a.html);$("#transferPatientsText").html(a.transferPatientsText);$("#transferPatientModal").modal("show")}})});$("body").on("click",".transferPatientModalTransferButton",function(b){b=$("#transferPatientModalClinicSelect").val();
0<b&&ajax({url:"/cabinet/transfer-patients/transfer",data:{patientIds:transferPatientModalPatientId,clinicId:b},success:function(a){"undefined"!=typeof a.status&&"success"==a.status&&("#patients"==document.location.hash?locationHashChanged():changeLocationHash("#patients/stages/"+a.clinicPatientId),$("#transferPatientModal").modal("hide"),confirmDialog({text:T["Patient has been moved"],cancelButtonText:"Ok"}))}})});$("body").on("change","#transferPatientModalClinicSelect",function(b){$(".transferPatientText").hide();
$("#transferPatientText"+$(this).val()).show()})});
;
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,c,b){a instanceof String&&(a=String(a));for(var e=a.length,d=0;d<e;d++){var f=a[d];if(c.call(b,f,d,a))return{i:d,v:f}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,b){if(a==Array.prototype||a==Object.prototype)return a;a[c]=b.value;return a};$jscomp.getGlobal=function(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var c=0;c<a.length;++c){var b=a[c];if(b&&b.Math==Math)return b}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(a,c){var b=$jscomp.propertyToPolyfillSymbol[c];if(null==b)return a[c];b=a[b];return void 0!==b?b:a[c]};
$jscomp.polyfill=function(a,c,b,e){c&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(a,c,b,e):$jscomp.polyfillUnisolated(a,c,b,e))};$jscomp.polyfillUnisolated=function(a,c,b,e){b=$jscomp.global;a=a.split(".");for(e=0;e<a.length-1;e++){var d=a[e];d in b||(b[d]={});b=b[d]}a=a[a.length-1];e=b[a];c=c(e);c!=e&&null!=c&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:c})};
$jscomp.polyfillIsolated=function(a,c,b,e){var d=a.split(".");a=1===d.length;e=d[0];e=!a&&e in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var f=0;f<d.length-1;f++){var g=d[f];g in e||(e[g]={});e=e[g]}d=d[d.length-1];b=$jscomp.IS_SYMBOL_NATIVE&&"es6"===b?e[d]:null;c=c(b);null!=c&&(a?$jscomp.defineProperty($jscomp.polyfills,d,{configurable:!0,writable:!0,value:c}):c!==b&&($jscomp.propertyToPolyfillSymbol[d]=$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(d):$jscomp.POLYFILL_PREFIX+d,d=$jscomp.propertyToPolyfillSymbol[d],
$jscomp.defineProperty(e,d,{configurable:!0,writable:!0,value:c})))};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,b){return $jscomp.findInternal(this,a,b).v}},"es6","es3");function setNavbarToWidth(){$customNavbar=$(".customNavbar");$customNavbar.removeClass("customNavbarCollapsed");if($customNavbar.length){var a=$customNavbar.find(".nav a");a.length&&$customNavbar.height()>a.outerHeight()+10&&$customNavbar.addClass("customNavbarCollapsed")}};
;
$(document).ready(function(){$("body").on("click",".stageBlockedUpload .stageUploadButton, .stageBlockedUpload .commentUploadButton, .stageBlockedUpload .flowUploadStageButton, .stageBlockedUpload .flowUploadCommentButton, .stageBlockedUpload .uploadPreselectedFilesFromFlowToStageButton, .stageBlockedUpload .uploadPreselectedFilesFromFlowToCommentButton ",function(a){a.stopPropagation();a.preventDefault();showBlockedClinicMessage()})});
function showBlockedClinicMessage(){confirmDialog({text:{ua:"\u0417\u0430\u0432\u0430\u043d\u0442\u0430\u0436\u0435\u043d\u043d\u044f \u0437\u0430\u0431\u043b\u043e\u043a\u043e\u0432\u0430\u043d\u043e \u0447\u0435\u0440\u0435\u0437 \u043d\u0435\u0441\u043f\u043b\u0430\u0442\u0443",en:"Upload is blocked due to nonpayment",ru:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0437\u0430\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u043d\u0430 \u0438\u0437-\u0437\u0430 \u043d\u0435\u0443\u043f\u043b\u0430\u0442\u044b"}[cabinetLanguage],
cancelButtonText:"Ok"})};
;
var FORMULA_NONE=1,FORMULA_ONE=2,FORMULA_JAW=3,FORMULA_QUADRANT=4,FORMULA_SEGMENT=5,FORMULA_ALL=6,FORMULA_CHILD_ONE=10,FORMULA_CHILD_JAW=11,FORMULA_CHILD_ALL=12,FORMULAS_ORDER=[-1,FORMULA_JAW,FORMULA_QUADRANT,FORMULA_SEGMENT,FORMULA_ONE,FORMULA_CHILD_JAW,FORMULA_CHILD_ONE,FORMULA_ALL,FORMULA_NONE,FORMULA_CHILD_ALL],FORMULAS={};FORMULAS[FORMULA_NONE]={};FORMULAS[FORMULA_ONE]={};for(var i=1;4>=i;i++)for(var j=1;8>=j;j++)FORMULAS[FORMULA_ONE][10*i+j]=[10*i+j];FORMULAS[FORMULA_JAW]={1:[],2:[]};
for(j=1;8>=j;j++)FORMULAS[FORMULA_JAW][1].push(10+j),FORMULAS[FORMULA_JAW][2].push(30+j);for(j=1;8>=j;j++)FORMULAS[FORMULA_JAW][1].push(20+j),FORMULAS[FORMULA_JAW][2].push(40+j);FORMULAS[FORMULA_QUADRANT]={1:[],2:[],3:[],4:[]};for(j=1;8>=j;j++)FORMULAS[FORMULA_QUADRANT][1].push(10+j),FORMULAS[FORMULA_QUADRANT][2].push(20+j),FORMULAS[FORMULA_QUADRANT][3].push(30+j),FORMULAS[FORMULA_QUADRANT][4].push(40+j);
FORMULAS[FORMULA_SEGMENT]={1:[18,17,16,15,14],2:[13,12,11,21,22,23],3:[24,25,26,27,28],4:[38,37,36,35,34],5:[33,32,31,41,42,43],6:[44,45,46,47,48]};FORMULAS[FORMULA_CHILD_ONE]={};for(i=1;4>=i;i++)for(j=1;5>=j;j++)FORMULAS[FORMULA_CHILD_ONE][40+10*i+j]=[40+10*i+j];FORMULAS[FORMULA_CHILD_JAW]={1:[],2:[]};for(j=1;5>=j;j++)FORMULAS[FORMULA_CHILD_JAW][1].push(50+j),FORMULAS[FORMULA_CHILD_JAW][2].push(70+j);
for(j=1;5>=j;j++)FORMULAS[FORMULA_CHILD_JAW][1].push(60+j),FORMULAS[FORMULA_CHILD_JAW][2].push(80+j);
var stageProtoype={type:"stage",id:0,order:0,items:[],formula:FORMULA_ONE,color:0,name:"",total:0,totalDone:0,totalSelected:0,discount:0,totalWithDiscount:0,totalDoneWithDiscount:0,totalSelectedWithDiscount:0,new:1,status:1,stageClinicsMembersId:0},commentProtoype={type:"comment",id:0,order:0,comment:"",color:0,new:1},itemPrototype={itemId:0,itemPrice:0,itemName:"",formulaValue:0,formula:0,id:0,new:1,status:1,addedOrder:0,selected:0},TEEETH_FOR_SORT=[18,17,16,15,14,13,12,11,21,22,23,24,25,26,27,28,
38,37,36,35,34,33,32,31,41,42,43,44,45,46,47,48,55,54,53,52,51,61,62,63,64,65,75,74,73,72,71,81,82,83,84,85],collapsedMode=!1,openedPlanStages=[],planId=!1,PLAN_STAGE_STATUS_NEW=1,PLAN_STAGE_STATUS_PLANNED_TO_DO=2,PLAN_STAGE_STATUS_DONE=3,PLAN_STAGE_STATUS_MIXED_NEW=10,PLAN_STAGE_STATUS_SELECTED=100,PLAN_ITEM_STATUS_NEW=1,PLAN_ITEM_STATUS_PLANNED_TO_DO=2,PLAN_ITEM_STATUS_DONE=3,PLAN_ITEM_STATUS_INVOICED=4,CLINIC_FINANCE_MODEL_STANDARD=1,CLINIC_FINANCE_MODEL_SIMPLE=2,planStagesStatusClasses={1:"planStageStatusNew",
2:"planStageStatusPlannedToDo",3:"planStageStatusDone",10:"planStageStatusMixed",100:"planStageStatusSelected"},planStagesStatusClassesJoined="planStageStatusNew planStageStatusPlannedToDo planStageStatusDone planStageStatusMixed planStageStatusSelected      planStageHasNewItems planStageHasDoneItems planStageHasPlannedToDoItems ",planItemsStatusClasses={1:"planItemsStatusNew",2:"planItemsStatusPlannedToDo",3:"planItemsStatusDone",4:"planItemsStatusInvoiced"};
;
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(d,g,e){d instanceof String&&(d=String(d));for(var h=d.length,a=0;a<h;a++){var b=d[a];if(g.call(e,b,a,d))return{i:a,v:b}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(d,g,e){if(d==Array.prototype||d==Object.prototype)return d;d[g]=e.value;return d};$jscomp.getGlobal=function(d){d=["object"==typeof globalThis&&globalThis,d,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var g=0;g<d.length;++g){var e=d[g];if(e&&e.Math==Math)return e}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(d,g){var e=$jscomp.propertyToPolyfillSymbol[g];if(null==e)return d[g];e=d[e];return void 0!==e?e:d[g]};
$jscomp.polyfill=function(d,g,e,h){g&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(d,g,e,h):$jscomp.polyfillUnisolated(d,g,e,h))};$jscomp.polyfillUnisolated=function(d,g,e,h){e=$jscomp.global;d=d.split(".");for(h=0;h<d.length-1;h++){var a=d[h];a in e||(e[a]={});e=e[a]}d=d[d.length-1];h=e[d];g=g(h);g!=h&&null!=g&&$jscomp.defineProperty(e,d,{configurable:!0,writable:!0,value:g})};
$jscomp.polyfillIsolated=function(d,g,e,h){var a=d.split(".");d=1===a.length;h=a[0];h=!d&&h in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var b=0;b<a.length-1;b++){var k=a[b];k in h||(h[k]={});h=h[k]}a=a[a.length-1];e=$jscomp.IS_SYMBOL_NATIVE&&"es6"===e?h[a]:null;g=g(e);null!=g&&(d?$jscomp.defineProperty($jscomp.polyfills,a,{configurable:!0,writable:!0,value:g}):g!==e&&($jscomp.propertyToPolyfillSymbol[a]=$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(a):$jscomp.POLYFILL_PREFIX+a,a=$jscomp.propertyToPolyfillSymbol[a],
$jscomp.defineProperty(h,a,{configurable:!0,writable:!0,value:g})))};$jscomp.polyfill("Array.prototype.find",function(d){return d?d:function(d,e){return $jscomp.findInternal(this,d,e).v}},"es6","es3");
$(document).ready(function(){function d(){var a=$(window).width();window.scrollTo(0,bodyScrollTop);$("#planPriceWrap").animate({right:-a},function(){})}var g=function(a){return 0<$(a).closest("[data-plan-template-wrap]").length};$("body").on("click",".planChangeViewMode",function(a){a=$(this).attr("data-viewMode");handlePlanViewMode(a)});$("body").on("click",".savePlan",function(a){savePlan()});$("body").on("click",".savePlanAndMarkAllDone",function(a){$("#markedDoneClinicMemberSelectModalEditView").modal("show");
selectInMarkedDoneClinicMemberSelectModalWhoDid("markAllDone")});$("body").on("click",".addPlanStage",function(a){a="true"==$(this).attr("data-clone");addPlanStage(a,!0)});$("body").on("click",".planEditView #planContainerWrap, .planEditView .clearfix",function(a){if("planContainerWrap"==a.target.id||$(a.target).hasClass("clearfix"))addPlanStage(!1),a.stopPropagation()});isMobileDevice&&($("body").on("focus",".planStageNameInput",function(a){g(this)||$("html, body").animate({scrollTop:$(this).closest(".planStage").offset().top-
5},200)}),$("body").on("focus",".planStageCommentTextarea",function(a){g(this)||$("html, body").animate({scrollTop:$(this).closest(".planStageComment").offset().top-5},200)}));$("body").on("click",".addPlanStageComment",function(a){removeSelectionInFormula();var b=$.extend(!0,{},commentProtoype);maxId++;a=maxId;plan[a]=b;b.id=a;b=$("#planStageCommentPrototype").html();var k=$(".activeStage");if(k.length){k.after(b);var c=k.next()}else $("#planStages").append(b),c=$("#planStages .planStageComment:last-child");
c.attr("data-id",a);c.find("textarea").focus();$(".activeStage").removeClass("activeStage");handleButtonsVisibility();autosize(c.find("textarea"));isMobileDevice&&(iosDevice?setTimeout(function(){$("html, body").animate({scrollTop:c.offset().top-5},200)},150):$("html, body").animate({scrollTop:c.offset().top-5},200))});$("body").on("change",".planStageCommentTextarea",function(a){g(this)||(a=$(this).closest(".planStageComment").attr("data-id"),plan[a].comment=$(this).val())});$("body").on("click",
".planStageFormulaSelect a",function(a){g(this)||(removeSelectionInFormula(),a=$(this).closest(".planStage").attr("data-id"),plan[a].formula=parseInt($(this).attr("data-value")),renderPlanStage(a))});$("body").on("keydown",".planStageNameInput",function(a){g(this)||0==syncronizedPriceSearchStage&&0==$(this).val().length&&(syncronizedPriceSearchStage=$(this).closest(".planStage").attr("data-id"))});$("body").on("keyup",".planStageNameInput",function(a){if(!g(this)&&syncronizedPriceSearchStage){var b=
$(this).val(),k=!1;0<b.length&&$(".planPriceItemName").each(function(a){$(this).closest(".planPriceItem");a=$(this).text();searchCaseInsensitive(a,b)&&(k=!0)});k||(b="");$("#planPriceSearchInput").val(b).trigger("keyup")}});$("body").on("focusout",".planStageNameInput",function(a){});$("body").on("change",".planStageNameInput",function(a){g(this)||(a=$(this).closest(".planStage").attr("data-id"),plan[a].name=$(this).val())});$("body").on("click",".planStage",function(a){var b=$(this);$(this).attr("data-id");
if(!b.hasClass("activeStage")){var k=$(".activeStage");k.length&&(removeSelectionInFormula(),k.removeClass("activeStage"));b.addClass("activeStage");b.hasClass("collapsedPlanStage")&&b.find(".planStageItems").slideDown(function(){b.toggleClass("collapsedPlanStage");$(this).attr("style","")});collapsedMode&&k.length&&k.find(".planStageItems").slideUp(function(){k.addClass("collapsedPlanStage");$(this).attr("style","")});handleDeselectSelectedTeethButton(b)}});$("body").on("click","#planPriceWrap .planPriceItem",
function(a){a=$(".activeStage");var b=a.attr("data-id");"undefined"==typeof b&&(addPlanStage(),a=$(".activeStage"),b=a.attr("data-id"));var k=$(this),c=$.extend(!0,{},itemPrototype);c.itemId=k.attr("data-itemId");c.amount=1;c.itemPrice=k.find(".planPriceItemPrice").attr("data-price");c.itemDiscount=getNewItemDiscount(b);c.itemPriceWithDiscount=c.itemPrice-c.itemDiscount*c.itemPrice/100;c.itemName=k.find(".planPriceItemName").text();lastAddedItemOrder++;c.addedOrder=lastAddedItemOrder;var g=k.closest(".priceGroupDiv").attr("data-color");
0==a.length&&(addPlanStage(!1),a=$(".activeStage"));k=!1;0==plan[b].items.length&&(0==plan[b].color&&(plan[b].color=g),""==plan[b].name&&(plan[b].name=c.itemName,k=!0),syncronizedPriceSearchStage&&$("#planPriceSearchInput").val().length&&(plan[b].name=c.itemName));g=getSelectedInFormulaValues();if(g.length)for(var e in g)c.formulaValue=g[e],c.formula=plan[b].formula,plan[b].items.push($.extend(!0,{},c));else plan[b].formula==FORMULA_ALL||plan[b].formula==FORMULA_CHILD_ALL?plan[b].items.push(c):k?
lastAddedItemOrder--:plan[b].items.push(c);renderPlanStage(b);a.hasClass("collapsedPlanStage")&&a.find(".planStageToggleCollapseButton").trigger("click");isMobileDevice&&$("#planPriceSearchInput").val("").trigger("keyup");k&&a.find(".planStageNameInput").focus().blur();$("#planPriceWrap").hasClass("mobilePlanPriceWrap")&&d()});$("body").on("click",".planFoldAllPriceGroup",function(){$(this).toggleClass("folded");$(this).hasClass("folded")?($("#planPriceContainer .planPriceGroupTable").slideUp("fast"),
$("#planPriceContainer .planFoldPriceGroup, #planPriceContainer .priceGroupDiv").addClass("folded"),$("#planPriceContainer .planPriceGroupTable").each(function(){Cookies.set("is_folded_price_group_"+$(this).data("group-id"),"true",{expires:1E3})})):($("#planPriceContainer .planPriceGroupTable").slideDown("fast"),$("#planPriceContainer .planFoldPriceGroup, #planPriceContainer .priceGroupDiv").removeClass("folded"),$("#planPriceContainer .planPriceGroupTable").each(function(){Cookies.set("is_folded_price_group_"+
$(this).data("group-id"),"false",{expires:1E3})}))});$("body").on("click","#planPriceWrap .planPriceGroup",function(a){var b=$(this).closest(".priceGroupDiv"),k=$(this).text();confirmDialog({buttonText:T["plans.Add group button"],text:T["plans.Add group?"],action:function(){var a=b.attr("data-color"),g=$(".activeStage");0==g.length&&(addPlanStage(!1),g=$(".activeStage"));var e=g.attr("data-id"),h=getSelectedInFormulaValues(),q=[],f=getNewItemDiscount(e);b.find(".planPriceItem").each(function(){var a=
$(this),b=$.extend(!0,{},itemPrototype);b.itemId=a.attr("data-itemId");b.itemPrice=a.find(".planPriceItemPrice").attr("data-price");b.itemName=a.find(".planPriceItemName").text();b.amount=1;b.itemDiscount=f;lastAddedItemOrder++;b.addedOrder=lastAddedItemOrder;if(h.length)for(var c in h)b.formulaValue=h[c],b.formula=plan[e].formula,q.push($.extend(!0,{},b));else q.push(b)});if(0!=q.length){var n=!1;0==plan[e].items.length&&(0==plan[e].color&&(plan[e].color=a),""==plan[e].name&&(plan[e].name=k,n=!0),
syncronizedPriceSearchStage&&$("#planPriceSearchInput").val().length&&(plan[e].name=k));for(var m in q)plan[e].items.push(q[m]);renderPlanStage(e);g.hasClass("collapsedPlanStage")&&g.find(".planStageToggleCollapseButton").trigger("click");$("#planPriceSearchInput").val("").trigger("keyup");n&&g.find(".planStageNameInput").focus().blur();$("#planPriceWrap").hasClass("mobilePlanPriceWrap")&&d()}}})});$("body").on("click","#planPriceWrap .planFoldPriceGroup, #simpleInvoicePriceWrap .planFoldPriceGroup",
function(a){$(this).toggleClass("folded");$(this).parent().toggleClass("folded");$(this).hasClass("folded")?$(this).siblings(".planPriceGroupTable").slideUp("fast"):$(this).siblings(".planPriceGroupTable").slideDown("fast");Cookies.set("is_folded_price_group_"+$(this).data("group-id"),$(this).hasClass("folded"),{expires:1E3})});$("body").on("click",".planStageRemoveButton",function(a){if(!g(this)){var b=$(this).closest(".planStage").attr("data-id");a=!1;for(var k in plan[b].items){var c=plan[b].items[k];
if(c.status==PLAN_ITEM_STATUS_INVOICED||c.status==PLAN_ITEM_STATUS_DONE)a=!0}a?confirmDialog({cancelButtonText:"Ok",text:T["plans.Cant remove stage with done works"]}):confirmDialog({buttonText:T.Delete,buttonColor:"red",text:T.Delete+"?",action:function(){1!=plan[b].new&&planStagesToRemove.push(b);delete plan[b];$(".planStage[data-id="+b+"]").fadeTo("slow",.004,function(){$(this).slideUp("slow",function(){$(this).remove()})});handleButtonsVisibility();renderPlansTotal()}})}});$("body").on("click",
".planStageCommentRemoveButton",function(a){if(!g(this)){var b=$(this).closest(".planStageComment").attr("data-id");confirmDialog({buttonText:T.Delete,buttonColor:"red",action:function(){1!=plan[b].new&&planStagesToRemove.push(b);delete plan[b];$(".planStageComment[data-id="+b+"]").fadeTo("slow",.004,function(){$(this).slideUp("slow",function(){$(this).remove()})});handleButtonsVisibility()}})}});$("body").on("click",".removePlanItem",function(a){if(!g(this)){a=$(this).closest(".planStage");var b=
a.attr("data-id"),k=$(this).closest(".planItem").attr("data-idInPlan");plan[b].items[k].status==PLAN_ITEM_STATUS_DONE||plan[b].items[k].status==PLAN_ITEM_STATUS_INVOICED?confirmDialog({cancelButtonText:"Ok",text:T["plans.To remove done work mark it as new first"]}):(1!=plan[b].items[k].new&&planItemsToRemove.push(plan[b].items[k].id),delete plan[b].items[k],$(this).closest(".planItem").fadeTo("slow",.004,function(){$(this).slideUp("slow",function(){$(this).remove()})}),a.hasClass("activeStage")||
removeSelectionInFormula(),renderPlanStage(b))}});$("body").on("click",".tooth",function(a){if(!g(this)){var b=$(this).closest(".planStage");if(b.hasClass("activeStage")||!b.hasClass("collapsedPlanStage")){var k=b.attr("data-id"),c=plan[k];if(c.formula!=FORMULA_ALL&&c.formula!=FORMULA_CHILD_ALL){var d=b.find(".planStageFormula"),e=parseInt($(this).attr("data-tooth")),h=FORMULAS[c.formula][getFormulaValueByTooth(c.formula,e)],q=elementHasClass($(this),"selectedInFormula");if(a=(c.formula==FORMULA_ONE||
c.formula==FORMULA_CHILD_ONE)&&a.shiftKey){var f=d.data("lastClickedTooth");if("undefinded"!=typeof f){q=d.data("lastClickedToothSelected");var n=Math.floor(f/10),m=Math.floor(e/10);h=n;var p=m;c.formula==FORMULA_ONE?(4==n&&(h=1),3==n&&(h=2),4==m&&(p=1),3==m&&(p=2),n=2>=Math.floor(f/10)?1:2,m=2>=Math.floor(e/10)?1:2):(8==n&&(h=5),7==n&&(h=6),8==m&&(p=5),7==m&&(p=6),n=6>=Math.floor(f/10)?1:2,m=6>=Math.floor(e/10)?1:2);var r=10*p+e%10;p=c.formula==FORMULA_ONE?{1:[18,17,16,15,14,13,12,11,21,22,23,24,
25,26,27,28],2:[48,47,46,45,44,43,42,41,31,32,33,34,35,36,37,38]}:{1:[55,54,53,52,51,61,62,63,64,65],2:[85,84,83,82,81,71,72,73,74,75]};f=p[1].indexOf(10*h+f%10);r=p[1].indexOf(r);f>r&&(f+=r,r=f-r,f-=r);for(h=[];f<=r;f++)h.push(p[n][f],p[m][f])}}if($("#planWrap").hasClass("planEditView")){for(var l in h)n=h[l],q?removeElementsClass(d.find(".tooth[data-tooth="+n+"]"),"selectedInFormula"):addClassToElements(d.find(".tooth[data-tooth="+n+"]"),"selectedInFormula");handleDeselectSelectedTeethButton(b)}else{b=
getFormulaValueByTooth(c.formula,e);m=0;for(l in c.items)if(f=c.items[l],currentClinicFinanceModel==CLINIC_FINANCE_MODEL_STANDARD){if((0==selectingStatus||itemStatusSuitableForSelectingStatus(f.status))&&f.formulaValue==b&&f.status!=PLAN_ITEM_STATUS_INVOICED&&f.formula==c.formula&&0==f.selected){m=1;break}}else if((0==selectingStatus||itemStatusSuitableForSelectingStatus(f.status))&&f.formulaValue==b&&f.formula==c.formula&&0==f.selected){m=1;break}if(0==selectingStatus){p={1:0,2:0,3:0,4:0};if(a&&
h.length)for(var t in h)for(l in n=h[t],c.items)f=c.items[l],currentClinicFinanceModel==CLINIC_FINANCE_MODEL_STANDARD?f.formulaValue==n&&f.status!=PLAN_ITEM_STATUS_INVOICED&&f.formula==c.formula&&p[f.status]++:f.formulaValue==n&&f.formula==c.formula&&p[f.status]++;else for(l in c.items)f=c.items[l],currentClinicFinanceModel==CLINIC_FINANCE_MODEL_STANDARD?f.formulaValue==b&&f.status!=PLAN_ITEM_STATUS_INVOICED&&f.formula==c.formula&&p[f.status]++:f.formulaValue==b&&f.formula==c.formula&&p[f.status]++;
for(l in p)if(p[l]){selectingStatus=l;break}}if(a&&h.length)for(t in h)for(l in n=h[t],c.items)f=c.items[l],currentClinicFinanceModel==CLINIC_FINANCE_MODEL_STANDARD?f.formulaValue==n&&f.status!=PLAN_ITEM_STATUS_INVOICED&&f.formula==c.formula&&(0==m||itemStatusSuitableForSelectingStatus(c.items[l].status)?c.items[l].selected=m:1):f.formulaValue!=n||f.formula!=c.formula||0!=m&&!itemStatusSuitableForSelectingStatus(c.items[l].status)||(c.items[l].selected=m);else for(l in c.items)f=c.items[l],currentClinicFinanceModel==
CLINIC_FINANCE_MODEL_STANDARD?f.formulaValue!=b||f.status==PLAN_ITEM_STATUS_INVOICED||f.formula!=c.formula||0!=m&&!itemStatusSuitableForSelectingStatus(c.items[l].status)||(c.items[l].selected=m):f.formulaValue!=b||f.formula!=c.formula||0!=m&&!itemStatusSuitableForSelectingStatus(c.items[l].status)||(c.items[l].selected=m);renderPlanStage(k)}if(c.formula==FORMULA_ONE||c.formula==FORMULA_CHILD_ONE)d.data("lastClickedTooth",e),d.data("lastClickedToothSelected",q)}}}});$("body").on("click",".sortPlanStages",
function(a){$("#planContainer, #planHeader, #planButtonsWrapEdit, #planPriceWrap").hide();$("#planSortingContainer").fadeIn();a=$("#planStages").sortable("toArray",{attribute:"data-id"});var b=$("#planSortingContainer ul");b.html("");for(var d in a){var c=plan[a[d]];b.append('<li id="planSortableLi'+c.id+'" data-id="'+c.id+'" class="planSortableLiColor'+c.color+'">'+("stage"==c.type?c.name.length?c.name:T["plans.New stage"]:c.comment.length?c.comment:T["plans.Comment"])+"</li>")}b.sortable({placeholder:"ui-sortable-placeholder",
axis:"y"});b.disableSelection()});$("body").on("click",".sortPlanStagesSave",function(a){a=$("#planSortingContainer ul").sortable("toArray",{attribute:"data-id"});for(var b in a)"undefined"!=typeof plan[a[b]]&&(plan[a[b]].order=b);savePlan({getStagesOrderFromList:!1})});$("body").on("click",".sortPlanStagesCancel",function(a){$("#planSortingContainer").hide();$("#planContainer, #planHeader, #planButtonsWrapEdit, #planPriceWrap").fadeIn()});$("body").on("click",".openAllPlanStages",function(a){$("#planStages .planStage.collapsedPlanStage .planStageItems").slideDown(function(){$(this).closest(".collapsedPlanStage").removeClass("collapsedPlanStage");
$(this).attr("style","")});openedPlanStages=[];for(var b in plan)openedPlanStages.push(plan[b].id);rememberPlanCollapseMode("opened");collapsedMode=!1;handleButtonsVisibility()});$("body").on("click",".collapseAllPlanStages",function(a){$("#planStages .planStage .planStageItems").slideUp(function(){$(this).closest(".planStage").addClass("collapsedPlanStage");$(this).attr("style","")});openedPlanStages=[];rememberPlanCollapseMode("collapsed");collapsedMode=!0;handleButtonsVisibility()});$("body").on("click",
".planStageToggleCollapseButton",function(a){var b=$(this).closest(".planStage");if(b.hasClass("activeStage")||"fa fa-angle-up"==a.target.className)b.attr("data-id"),b.hasClass("collapsedPlanStage")?b.find(".planStageItems").slideDown(function(){b.toggleClass("collapsedPlanStage");$(this).attr("style","")}):b.find(".planStageItems").slideUp(function(){b.toggleClass("collapsedPlanStage");$(this).attr("style","")})});$("body").on("keyup","#planPriceSearchInput",function(a){27==a.keyCode&&$(this).val("");
var b=$(this).val(),d=[];if(0<b.length){$("#planPriceContainer .planFoldPriceGroup").each(function(){$(this).siblings(".planPriceGroupTable").show();$(this).addClass("searching")});$("#planPriceContainer .priceGroupDiv").addClass("searching");$(this).parent().addClass("searching");$(".planPriceItem").each(function(a){a=$(this);var c=a.find(".planPriceItemName").text(),e=a.find(".planPriceItemCode").text();searchCaseInsensitive(c,b)||searchCaseInsensitive(e,b)?(a.show(),d.push(a.closest(".priceGroupDiv"))):
a.hide()});$(".priceGroupDiv").hide();for(var c in d)d[c].show();$("#clearPlanPriceSearchInput").show()}else $(".priceGroupDiv").show(),$(".planPriceItem").show(),$("#clearPlanPriceSearchInput").hide(),foldPlanGroups(),$("#planPriceContainer .planFoldPriceGroup, #planPriceContainer .priceGroupDiv").removeClass("searching"),$(this).parent().removeClass("searching")});$("body").on("click","#clearPlanPriceSearchInput",function(a){$("#planPriceSearchInput").val("").trigger("keyup").focus()});$(window).on("resize",
function(a){a.target==this&&positionPlan("resize")});$("body").on("keyup",".planStageItemAmountInput",function(a){13==a.keyCode&&$(this).blur();if(27==a.keyCode){a=$(this).closest(".planStage").attr("data-id");a=plan[a];var b=$(this).closest(".planItem").attr("data-idInPlan");$(this).val(formatPrice(a.items[b].amount))}});$("body").on("focusout",".planStageItemAmountInput",function(a){updatePlanStageItemAmount($(this))});$("body").on("focusin",".planStageItemPriceInput, .planStageItemDiscountInput, .planStageItemAmountInput",
function(a){a=$(this);a.closest(".planEditView").length?(a.prop("selectionStart",0),a.prop("selectionEnd",999)):($(this).closest(".planItem").trigger("click"),a.blur())});$("body").on("keyup",".planStageItemPriceInput",function(a){13==a.keyCode&&$(this).blur();if(27==a.keyCode){a=$(this).closest(".planStage").attr("data-id");a=plan[a];var b=$(this).closest(".planItem").attr("data-idInPlan");$(this).val(formatPrice(a.items[b].itemPrice))}});$("body").on("focusout",".planStageItemPriceInput",function(a){updatePlanStageItemPrice($(this))});
$("body").on("keyup",".planStageItemDiscountInput",function(a){13==a.keyCode&&$(this).blur();if(27==a.keyCode){a=$(this).closest(".planStage").attr("data-id");a=plan[a];var b=$(this).closest(".planItem").attr("data-idInPlan");$(this).val(formatPrice(a.items[b].itemDiscount))}});$("body").on("focusout",".planStageItemDiscountInput",function(a){updatePlanStageItemDiscount($(this))});var e="stage|plan",h=0;$("body").on("click",".planEditView .plansTotalDiv table",function(a){$("#planStages .planItemsStatusInvoiced").length?
confirmDialog({cancelButtonText:"Ok",text:"\u041d\u0435 \u043c\u043e\u0436\u043d\u0430 \u0437\u043c\u0456\u043d\u0438\u0442\u0438 \u0437\u043d\u0438\u0436\u043a\u0443 \u0443 \u043f\u0440\u043e\u0432\u0435\u0434\u0435\u043d\u0456\u0439 \u0440\u043e\u0431\u043e\u0442\u0456"}):(a=$("#discountInputModalDiscountInput"),e="plan",a.val(planDiscount),$("#discountInputModal .modal-title").hide(),$("#discountInputModalTitlePlan").show(),$("#discountInputModal").modal("show"),iosDevice||(a.focus(),a.prop("selectionStart",
0),a.prop("selectionEnd",999)))});$("body").on("click",".planEditView .activeStage .planStageTotalContainer table",function(a){if($($(this).closest(".planStage")[0]).find(".planItemsStatusInvoiced").length)confirmDialog({cancelButtonText:"Ok",text:"\u041d\u0435 \u043c\u043e\u0436\u043d\u0430 \u0437\u043c\u0456\u043d\u0438\u0442\u0438 \u0437\u043d\u0438\u0436\u043a\u0443 \u0443 \u043f\u0440\u043e\u0432\u0435\u0434\u0435\u043d\u0456\u0439 \u0440\u043e\u0431\u043e\u0442\u0456"});else{a=$(this).closest(".planStage").attr("data-id");
var b=$("#discountInputModalDiscountInput");e="stage";h=a;b.val(getNewItemDiscount(a));$("#discountInputModal .modal-title").hide();$("#discountInputModalTitleStage").show();$("#discountInputModal").modal("show");b.focus();b.prop("selectionStart",0);b.prop("selectionEnd",999)}});$("body").on("submit","#discountInputModalForm",function(a){a.preventDefault();a=$("#discountInputModalDiscountInput").val();a=a.replace(",",".");isNaN(a)&&(a=0);if(0>a||100<a)a=0;if("plan"==e){planDiscount=a;for(var b in plan){plan[b].discount=
a;for(var d in plan[b].items)plan[b].items[d].itemDiscount=a;renderPlanStage(plan[b].id)}}else{b=h;plan[b].discount=a;for(d in plan[b].items)plan[b].items[d].itemDiscount=a;renderPlanStage(b)}renderPlansTotal();$("#discountInputModal").modal("hide")});$("body").on("click",".cancelPlanEditing",function(a){getPlanOpenedStages();unsavedChanges=!1;locationHashChanged(!1)});$("body").on("click",".deselectSelectedTeethButton",function(a){removeSelectionInFormula();handleDeselectSelectedTeethButton($(".activeStage"))});
$("body").on("click",".selectTeethButton",function(a){addClassToElements($(".activeStage").find(".usedInFormula"),"selectedInFormula");handleDeselectSelectedTeethButton($(".activeStage"))});$("body").on("click","#planPriceToggle",function(a){0==parseInt($("#planPriceWrap").css("right"))?d():(bodyScrollTop=document.body.scrollTop,$("#planPriceWrap").animate({right:"0px"},function(){window.scrollTo(0,0);$("#planPriceSearchInput").focus().blur()}))});$("body").on("click","#closePlanPrice",function(a){d()});
$("body").on("click",".addPlan",function(a){a=$(this).attr("data-usetemplate");ajax({url:"/cabinet/plans/add-plan/"+currentPatientId,data:{useTemplate:a},success:function(a){"undefined"!=typeof a.status&&"success"==a.status&&(newPlanCreated=!0,document.location.hash="#plans/plan/"+a.planId)}})});$("body").on("click",".deletePlan",function(a){var b=$(this).closest(".planItemWrap"),d=$(this).attr("data-planId");confirmDialog({buttonText:T.Delete,text:DeletePlanText+"?",buttonColor:"red",action:function(){ajax({url:"/cabinet/plans/delete-plan/"+
d,success:function(){b.fadeOut();locationHashChanged(!1)}})}})});$("body").on("click",".clonePlan",function(a){ajax({url:"/cabinet/plans/clone-plan/"+$(this).attr("data-planId"),success:function(a){"undefined"!=typeof a.status&&"success"==a.status&&locationHashChanged()}})});$("body").on("click",".markPlanMain",function(a){ajax({url:"/cabinet/plans/mark-plan-main/"+$(this).attr("data-planId"),success:function(a){"undefined"!=typeof a.status&&"success"==a.status&&locationHashChanged()}})});$("body").on("click",
".planList .timeline-body",function(a){$(a.target).hasClass("preventGoingToPlan")||$(a.target).closest(".preventGoingToPlan").length||(document.location.hash="#plans/plan/"+$(this).attr("data-planId"))});$("body").on("click",".planPricesVisibilityToggleButtonWrap",function(a){$(".planPricesVisibilityToggleButton").is(":checked")?($.removeCookie("hidePlanPrices"),$("#planWrap").removeClass("hiddenPrices")):($.cookie("hidePlanPrices",1),$("#planWrap").addClass("hiddenPrices"))});$("body").on("click",
".planEditView .planStageStatusButtonWithAvatar",function(a){var b=$(this).closest(".planStage").attr("data-id"),d=plan[b];$("#stageClinicMemberModalForm_clinicMemberId").val(d.stageClinicsMembersId);$("#stageClinicMemberModalForm_clinicMemberId").trigger("change");$("#stageClinicMemberModal").modal("show");stageClinicMemberModalStageId=b;a.preventDefault();a.stopImmediatePropagation()});$("body").on("change","#stageClinicMemberModalForm_clinicMemberId",function(a){$("#stageClinicMemberModal").hasClass("in")&&
(plan[stageClinicMemberModalStageId].stageClinicsMembersId=$(this).val(),renderPlanStage(stageClinicMemberModalStageId),$("#stageClinicMemberModal").modal("hide"),delete stageClinicMemberModalStageId)});$("body").on("click",".planSettingsDialogTrigger, .planSettingsDialogTriggerOnAvatar",function(a){a=$(this).attr("data-planId");$("#planSettingsModal .hasDataPlanId").attr("data-planId",a);a=$(this).attr("data-clinicMemberId");$("#planSettingsModalForm_clinicMemberId").val(a);$("#planSettingsModalForm_clinicMemberId").trigger("change");
a=$(this).attr("data-dateCreated");initDateTimePicker($("#planSettingsModalForm_plansDate"));$("#planSettingsModalForm_plansDate").data("DateTimePicker").date(moment(a));$("#planSettingsModalForm_plansDate").on("dp.change",function(a){if($("#planSettingsModal.modal.in").length){var b=a.oldDate.format("YYYY-MM-DD");a=a.date.format("YYYY-MM-DD");b!=a&&ajax({url:"/cabinet/plans/change-plan-date/"+$("#planSettingsModal form").attr("data-planId"),data:{newDate:a},success:function(a){"undefined"!=typeof a.status&&
"success"==a.status&&locationHashChanged()}})}});$("#planSettingsModal").modal("show")})});
;
$(document).ready(function(){$("body").on("click",".planFilter",function(a){a=$(this).attr("data-filter");$("#planWrap").removeClass("planFilterNew planFilterDone planFilterAll planFilterPlanned").addClass("planFilter"+a);$(".planFilter").removeClass("active");$(this).addClass("active");handleButtonsVisibility();$(".planStage:visible").length||$(".openAllPlanStages, .collapseAllPlanStages").hide();"Done"==a?(handleGroupingSelectors(),$(".groupingSelectors").show()):(makeSurePlanGroupingIsStandard(),
$(".groupingSelectors").hide());0==$("#planStages .planStage:visible").length&&"All"!=a&&$("#planWrap").addClass("emptyPlan")})});function removeFilterClasses(){$("#planWrap").removeClass("planFilterNew planFilterDone planFilterAll planFilterPlanned")};
;
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){if(a==Array.prototype||a==Object.prototype)return a;a[b]=c.value;return a};$jscomp.getGlobal=function(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var c=a[b];if(c&&c.Math==Math)return c}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(a,b){var c=$jscomp.propertyToPolyfillSymbol[b];if(null==c)return a[b];c=a[c];return void 0!==c?c:a[b]};
$jscomp.polyfill=function(a,b,c,e){b&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(a,b,c,e):$jscomp.polyfillUnisolated(a,b,c,e))};$jscomp.polyfillUnisolated=function(a,b,c,e){c=$jscomp.global;a=a.split(".");for(e=0;e<a.length-1;e++){var d=a[e];d in c||(c[d]={});c=c[d]}a=a[a.length-1];e=c[a];b=b(e);b!=e&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})};
$jscomp.polyfillIsolated=function(a,b,c,e){var d=a.split(".");a=1===d.length;e=d[0];e=!a&&e in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var g=0;g<d.length-1;g++){var h=d[g];h in e||(e[h]={});e=e[h]}d=d[d.length-1];c=$jscomp.IS_SYMBOL_NATIVE&&"es6"===c?e[d]:null;b=b(c);null!=b&&(a?$jscomp.defineProperty($jscomp.polyfills,d,{configurable:!0,writable:!0,value:b}):b!==c&&($jscomp.propertyToPolyfillSymbol[d]=$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(d):$jscomp.POLYFILL_PREFIX+d,d=$jscomp.propertyToPolyfillSymbol[d],
$jscomp.defineProperty(e,d,{configurable:!0,writable:!0,value:b})))};$jscomp.initSymbol=function(){};
$jscomp.polyfill("Symbol",function(a){if(a)return a;var b=function(a,b){this.$jscomp$symbol$id_=a;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:b})};b.prototype.toString=function(){return this.$jscomp$symbol$id_};var c=0,e=function(a){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return new b("jscomp_symbol_"+(a||"")+"_"+c++,a)};return e},"es6","es3");$jscomp.initSymbolIterator=function(){};
$jscomp.polyfill("Symbol.iterator",function(a){if(a)return a;a=Symbol("Symbol.iterator");for(var b="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),c=0;c<b.length;c++){var e=$jscomp.global[b[c]];"function"===typeof e&&"function"!=typeof e.prototype[a]&&$jscomp.defineProperty(e.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}})}return a},"es6",
"es3");$jscomp.initSymbolAsyncIterator=function(){};$jscomp.iteratorPrototype=function(a){a={next:a};a[Symbol.iterator]=function(){return this};return a};$jscomp.iteratorFromArray=function(a,b){a instanceof String&&(a+="");var c=0,e={next:function(){if(c<a.length){var d=c++;return{value:b(d,a[d]),done:!1}}e.next=function(){return{done:!0,value:void 0}};return e.next()}};e[Symbol.iterator]=function(){return e};return e};
$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");$jscomp.findInternal=function(a,b,c){a instanceof String&&(a=String(a));for(var e=a.length,d=0;d<e;d++){var g=a[d];if(b.call(c,g,d,a))return{i:d,v:g}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6","es3");
var newPlanCreated=!1,syncronizedPriceSearchStage=0,bodyScrollTop=0,planBreakingWidth=1160,planIsSaving=!1,selectingStatus=0;
function savePlan(a){if(!planIsSaving){planIsSaving=!0;"undefined"==typeof a&&(a={});var b="undefined"!=typeof a.getStagesOrderFromList?a.getStagesOrderFromList:!0,c="undefined"!=typeof a.itemsStatus?a.itemsStatus:0,e="undefined"!=typeof a.markAllDone?a.markAllDone:!1,d="/cabinet/plans/save/"+currentPlanId;if(0==("undefined"!=typeof a.setItemsStatus?a.setItemsStatus:!1)){var g=0;c=0}else d="/cabinet/plans/save-items-status/"+currentPlanId,g=$(".planItem.planItemSelected").length;if(b){if(isMobileDevice)h=
[],$("#planStages .planStage, #planStages .planStageComment").each(function(){h.push($(this).attr("data-id"))});else var h=$("#planStages").sortable("toArray",{attribute:"data-id"});for(var k in h)plan[h[k]].order=k}$("#planStages .planStageCommentTextarea").trigger("change");getPlanOpenedStages();a={plan:JSON.stringify(plan),planName:$("#planName").val(),planStagesToRemove:JSON.stringify(planStagesToRemove),planItemsToRemove:JSON.stringify(planItemsToRemove),doneByClinicMemberId:e?$("#markedDoneClinicMemberSelectModalEditViewForm_clinicMemberId").val():
$("#markedDoneClinicMemberSelectModalForm_clinicMemberId").val(),changeStatusDate:e?getDateTimePickerDateInServerFormat("#markedDoneClinicMemberSelectModalEditViewForm_changeStatusDate"):getDateTimePickerDateInServerFormat("#markedDoneClinicMemberSelectModalForm_changeStatusDate"),status:c,selectedCount:g,markAllDone:e?1:0,purpose:a.purpose?a.purpose:null,diagnosis:$("#markedDoneDiagnosis").val()};document.getElementById("markedDoneClinicMemberSelectModalForm_subclinicsId")&&"undefined"==typeof $("#markedDoneClinicMemberSelectModalSubclinicsGroup").attr("disabled")&&
(a.subclinics_id=$("#markedDoneClinicMemberSelectModalForm_subclinicsId").val());ajax({url:d,data:a,success:function(a){if("undefined"!=typeof a.tempToRealNewStagesIds&&Object.keys(a.tempToRealNewStagesIds).length)for(var b in a.tempToRealNewStagesIds){var c=parseInt(a.tempToRealNewStagesIds[b]),d=openedPlanStages.indexOf(parseInt(b));-1!=d&&(openedPlanStages.splice(d,1),openedPlanStages.push(parseInt(c)))}$("#markedDoneClinicMemberSelectModal").modal("hide");$("#planPriceWrap").hide();$(".profile-bar").slideDown("fast",
function(){e&&currentClinicFinanceModel==CLINIC_FINANCE_MODEL_SIMPLE&&"undefined"!=typeof a.simpleInvoiceForMarkedDone?changeLocationHash("#invoices/print-invoice/"+a.simpleInvoiceForMarkedDone):locationHashChanged(!1)});unsavedChanges=planIsSaving=!1}})}}
function handlePlanViewMode(a){var b=$(".profile-bar");"standard"==a?(isMobileDevice||$("#planStages").sortable("disable"),$("#planWrap input, #planWrap textarea").prop("disabled",!0),b.is(":visible")||b.slideDown("fast",function(){$("#planWrap").removeClass("planEditView").addClass("planStandardView");handleButtonsVisibility();$(".planFiltersBlock").fadeIn()})):($patientHeaderFixed&&($patientHeaderFixed.hide(),$patientHeaderFixed=!1),makeSurePlanGroupingIsStandard(),unsavedChanges=!0,removeFilterClasses(),
$("#planWrap input, #planWrap textarea").prop("disabled",!1),b.is(":visible")&&($(window).width()>planBreakingWidth?b.slideUp("fast",function(){$("#planWrap").removeClass("planStandardView").addClass("planEditView");isMobileDevice||$("#planStages").sortable("enable");handleButtonsVisibility();$(".planFiltersBlock").hide()}):($("#planWrap").removeClass("planStandardView").addClass("planEditView"),isMobileDevice||$("#planStages").sortable("enable"),handleButtonsVisibility())),setTimeout(function(){$(".activeStage").length&&
handleDeselectSelectedTeethButton($(".activeStage"))},500),foldPlanGroups());handleButtonsVisibility()}function foldPlanGroups(){$("#planPriceWrap .planFoldPriceGroup, #simpleInvoicePriceWrap .planFoldPriceGroup").each(function(){"true"===Cookies.get("is_folded_price_group_"+$(this).data("group-id"))&&($(this).addClass("folded"),$(this).parent().addClass("folded"),$(this).siblings(".planPriceGroupTable").hide())})}var planIsInitializing=!1,planGrouping;
function initPlan(a){planIsSaving=!1;"dates"==a?"standard"==planGrouping&&($("#planStages").html(""),planBackup=jQuery.extend(!0,{},plan),planStagesOrderBackup=planStagesOrder,createGroupedByDatePlan(),planGrouping="dates",handleGroupingSelectors()):"standard"==a?"dates"==planGrouping&&($("#planStages").html(""),plan=jQuery.extend(!0,{},planBackup),planStagesOrder=planStagesOrderBackup,delete planBackup,delete planStagesOrderBackup,planGrouping="standard",handleGroupingSelectors()):planGrouping="standard";
planIsInitializing=!0;console.time("initPlan");if(currentPlanId!=planId&&(planId=currentPlanId,openedPlanStages=[],!collapsedMode))for(var b in planStagesOrder)openedPlanStages.push(parseInt(planStagesOrder[b]));a=$("#planStagePrototype").html();var c=$("#planStageCommentPrototype").html(),e="";for(b in planStagesOrder){var d=plan[planStagesOrder[b]];if("stage"==d.type){"dates"==planGrouping&&e!=d.stageDate&&($("#planStages").append("<div class='stageDate'>"+readableDate(d.stageDate)+"</div>"),e=
d.stageDate);$("#planStages").append(a);var g=$("#planStages .planStage:last-child");g.attr("data-id",d.id);-1==openedPlanStages.indexOf(d.id)&&g.addClass("collapsedPlanStage");renderPlanStage(d.id)}else $("#planStages").append(c),g=$("#planStages .planStageComment:last-child"),g.attr("data-id",d.id),g.find(".planStageCommentTextarea").val(d.comment),autosize(g.find("textarea")),g.find(".planStageCommentPrint").html(d.comment)}isMobileDevice||$("#planStages").sortable({placeholder:"portlet-placeholder ui-corner-all",
axis:"y",delay:150,stop:function(a,b){a=$("#planStages").sortable("toArray",{attribute:"data-id"});for(var c in a)plan[a[c]].order=c}});positionPlan("init");newPlanCreated?(newPlanCreated=!1,handlePlanViewMode("edit"),$("#planName").val().length||setTimeout(function(){$("#planName").focus()},150)):handlePlanViewMode("standard");handleButtonsVisibility();renderPlansTotal();planIsInitializing=!1;1==openedPlanStages.length&&$(".planStage[data-id="+openedPlanStages[0]+"]").addClass("activeStage")}
function addPlanStage(a,b){"undefined"==typeof b&&(b=!1);var c=$.extend(!0,{},stageProtoype);1!=clinicSpecialization&&(c.formula=FORMULA_NONE);maxId++;var e=maxId;plan[e]=c;c.id=e;c.discount=patientDiscount?patientDiscount:planStagesHaveEqualDiscount?planDiscount:0;c.stageClinicsMembersId=currentClinicMemberId;var d=!1;d=[];if(1==a){a=$(".activeStage");if(a.length)var g=a;else g=$("#planStages .planStage").last(),g.addClass("activeStage");d=parseInt(plan[g.attr("data-id")].formula);c.formula=d;d=
getSelectedInFormulaValues();var h=[];g.find(".usedInFormula").each(function(a,b){h.push($(b).attr("data-tooth"))});for(var k in h)a=h[k],d.push(getFormulaValueByTooth(plan[g.attr("data-id")].formula,a));d=array_unique(d);c.discount=plan[g.attr("data-id")].discount;c.stageClinicsMembersId=plan[g.attr("data-id")].stageClinicsMembersId}removeSelectionInFormula();g=$("#planStagePrototype").html();a=$(".activeStage");b&&a.length?(a.after(g),b=a.next()):($("#planStages").append(g),b=$("#planStages .planStage:last-child"));
b.attr("data-id",e);$(".activeStage").removeClass("activeStage");b.addClass("activeStage");renderPlanStage(e);if(d.length)for(k in d){e=d[k];for(var m in FORMULAS[c.formula][e])a=FORMULAS[c.formula][e][m],addClassToElements(b.find(".tooth[data-tooth="+a+"]"),"selectedInFormula")}collapsedMode&&$("#planStages .planStage:not(.activeStage)").find(".planStageItems").slideUp(function(){$(this).closest(".planStage").addClass("collapsedPlanStage");$(this).attr("style","")});b.find(".planStageNameInput").focus();
handleButtonsVisibility();handleDeselectSelectedTeethButton(b)}function updatePlanStageItemAmount(a){var b=parseFloat(a.val().replace(/,/,".").replace(/[^0-9.]/g,""));isNaN(b)&&(b=0);var c=a.closest(".planStage").attr("data-id"),e=plan[c];a=a.closest(".planItem").attr("data-idInPlan");e.items[a].amount=b;renderPlanStage(c)}
function updatePlanStageItemPrice(a){var b=parseFloat(a.val().replace(/,/,".").replace(/[^0-9.]/g,""));isNaN(b)&&(b=0);var c=a.closest(".planStage").attr("data-id"),e=plan[c];a=a.closest(".planItem").attr("data-idInPlan");e.items[a].itemPrice=b;renderPlanStage(c)}
function updatePlanStageItemDiscount(a){var b=Math.abs(parseFloat(a.val().replace(/,/,".").replace(/[^0-9.]/g,"")));100<b&&(b=0);isNaN(b)&&(b=0);var c=a.closest(".planStage").attr("data-id"),e=plan[c];a=a.closest(".planItem").attr("data-idInPlan");e.items[a].itemDiscount=b;renderPlanStage(c)}var __windowWidth=0;
function positionPlan(a){var b=$("#planContainer");if(b.length){var c=$("#main_content"),e=$("#planPriceWrap"),d=c.offset(),g=c.width();c=$(window).width();var h=$(window).height(),k=d.top+9;d=h-k-30;g=Math.min(450,g-b.width());c>planBreakingWidth?(e.removeClass("mobilePlanPriceWrap"),e.css("top",k),a=25,1200>c&&(a=15,g-=10),e.css("left",b.offset().left+b.width()+a),e.css("width",g),e.css("height",d),$("#planPriceSearchDiv").css("width",g),$("#planPriceContainer").css("height",d-30)):(e.addClass("mobilePlanPriceWrap"),
e.css("top",0),e.css("width","100%"),e.css("height","100%"),e.css("left","inherit"),"init"!=a&&__windowWidth==c||e.css("right",-c),$("#planPriceContainer").css("height",h+12),$("#planPriceSearchDiv").css("width",c-70));__windowWidth=c;$("#planContainerWrap").css("min-height",h-181-(1570<c?79:125))}}
function renderPlanStage(a){var b=$(".planStage[data-id="+a+"]");if(0!=b.length){var c=b.find(".planStageItems"),e=b.find(".planStageFormula"),d=plan[a],g=0,h=0,k=0,m=0,l=0,t=0,A=0,y=0,B=0,q=[],n=getPlanStageStatusByItemsStatusesAndClassesForFilters(a);plan[a].status=n.planStageStatus;b.removeClass(planStagesStatusClassesJoined).addClass(planStagesStatusClasses[plan[a].status]+" "+n.classesForFilters);d.items.sort(function(a,b){var c=a.formulaValue,e=b.formulaValue;0!=c&&0!=e&&a.formula!=b.formula&&
(c=FORMULAS_ORDER.indexOf(a.formula),e=FORMULAS_ORDER.indexOf(b.formula));0==c&&(c=100);0==e&&(e=100);if(d.formula==FORMULA_ONE||d.formula==FORMULA_CHILD_ONE)c=TEEETH_FOR_SORT.indexOf(c),e=TEEETH_FOR_SORT.indexOf(e),-1==c&&(c=100),-1==e&&(e=100);return c!=e?c-e:a.addedOrder>b.addedOrder?1:-1});var u=getSelectedInFormulaValues();n=!0;switch(d.formula){case FORMULA_NONE:e.html($("#formulaPrototypeNone").html());break;case FORMULA_CHILD_ONE:case FORMULA_CHILD_JAW:case FORMULA_CHILD_ALL:e.html($("#formulaPrototypeChild").html());
break;default:e.html($("#formulaPrototype").html())}e.find(".writings:not(.writings"+d.formula+")").remove();e.attr("class","planStageFormula planStageFormula"+d.formula);b.find(".planStageFormulaSelect li").removeClass("active");b.find(".planStageFormulaSelect a[data-value="+d.formula+"]").parent().addClass("active");if(u.length)for(var v in u){var f=u[v];for(p in FORMULAS[d.formula][f])n=FORMULAS[d.formula][f][p],addClassToElements(e.find(".tooth[data-tooth="+n+"]"),"selectedInFormula"),n=!1}var r=
getDoneFormulaValues(a),w=getSelectedFormulaValues(a),z=getPlannedToDoFormulaValues(a);c.html("<table></table>");u=c.find("table");var x="";for(v in d.items){f=d.items[v];f.itemPriceWithDiscount=(f.itemPrice-f.itemDiscount*f.itemPrice/100)*f.amount;var C=currentClinicMemberAccess&ACCESS_PRICES_IN_PLANS_EDIT&&f.status!=PLAN_ITEM_STATUS_INVOICED&&f.status!=PLAN_ITEM_STATUS_DONE;x+='<tr class="planItem '+planItemsStatusClasses[f.status]+(f.selected?" planItemSelected ":"")+'" data-idInPlan="'+v+'"><td><span class="planItemStatusButton planItemStatusButton'+
(f.status+'"><i class="fa fa-'+{1:"circle",2:"circle",3:"check",4:"check"}[f.status]+'"></i></span>')+f.itemName+'</td><td style="width: 5%;">'+getFormulaValueText(d.formula,f.formula,f.formulaValue)+"</td>"+(f.status!=PLAN_ITEM_STATUS_INVOICED||f.status!=PLAN_ITEM_STATUS_DONE?'<td style="width: 5%;"'+(1==f.amount?' class="hideInStandardView" ':"")+'><input class="planStageItemAmountInput" value="'+f.amount+'"/></td>':'<td style="width: 5%;"'+(1==f.amount?' class="hideInStandardView" ':"")+">"+f.amount+
"</td>")+(C?'<td style="width: 10%;"'+(1==f.amount&&0==f.itemDiscount?' class="hideInStandardView" ':"")+'><input class="planStageItemPriceInput" value="'+formatPrice(f.itemPrice)+'"/></td>':'<td style="min-width: 60px;"'+(1==f.amount&&0==f.itemDiscount?' class="hideInStandardView" ':"")+">"+formatPrice(f.itemPrice)+"</td>")+(f.status!=PLAN_ITEM_STATUS_INVOICED&&f.status!=PLAN_ITEM_STATUS_DONE?'<td style="width: 5%;"'+(0==f.itemDiscount?' class="hideInStandardView" ':"")+'><input class="planStageItemDiscountInput" value="'+
f.itemDiscount+'%"/></td>':'<td style="width: 5%;"'+(0==f.itemDiscount?' class="hideInStandardView" ':"")+">"+f.itemDiscount+"%</td>")+'<td style="width: 10%;">'+formatPrice(f.itemPriceWithDiscount)+'</td><td><span class="removePlanItem"><i class="fa fa-times"></i></span></td></tr>';if(0!=f.formulaValue&&d.formula!=FORMULA_ALL&&d.formula!=FORMULA_CHILD_ALL)for(p in FORMULAS[d.formula][f.formulaValue])d.formula==f.formula&&(n=FORMULAS[d.formula][f.formulaValue][p],C="usedInFormula"+(-1!=r.indexOf(f.formulaValue)?
" doneInFormula":"")+(-1!=w.indexOf(f.formulaValue)?" selectedToChangeStatusInFormula":"")+(-1!=z.indexOf(f.formulaValue)?" plannedToDoStatusInFormula":""),addClassToElements(e.find(".tooth[data-tooth="+n+"]"),C),n=!1);g+=parseFloat(f.itemPrice*f.amount);q[f.itemDiscount]=1;h+=parseFloat((f.itemPrice-f.itemDiscount*f.itemPrice/100)*f.amount);k+=f.status==PLAN_ITEM_STATUS_DONE||f.status==PLAN_ITEM_STATUS_INVOICED?parseFloat(f.itemPrice*f.amount):0;m+=f.status==PLAN_ITEM_STATUS_DONE||f.status==PLAN_ITEM_STATUS_INVOICED?
parseFloat(f.itemPriceWithDiscount):0;y+=f.status==PLAN_ITEM_STATUS_PLANNED_TO_DO?parseFloat(f.itemPrice*f.amount):0;B+=f.status==PLAN_ITEM_STATUS_PLANNED_TO_DO?parseFloat(f.itemPriceWithDiscount):0;l+=f.selected?parseFloat(f.itemPrice*f.amount):0;A+=f.selected?f.itemPriceWithDiscount:0;t+=f.status==PLAN_ITEM_STATUS_NEW||f.status==PLAN_ITEM_STATUS_PLANNED_TO_DO?parseFloat(f.itemPriceWithDiscount):0}u.append(x);var p="";r=!0;0==Object.keys(q).length?(f=!1,d.discount=0,r=!1):1==Object.keys(q).length?
(0<Object.keys(q)[0]?(f=!0,p=Object.keys(q)[0],d.discount=Object.keys(q)[0]):(f=!1,d.discount=0),r=!1):(f=!0,p="",d.discount=-1);r||b.addClass("hideExtraColumns");b.find(".planStageAvatar").attr("src",clinicsMembersData[d.stageClinicsMembersId].avatar);b.find(".planStageNameInput").val(d.name);b[0].className=b[0].className.replace(/planStageColor.*?\b/g,"");b.addClass("planStageColor"+d.color);q=g-k;r=b.find(".planStageTotalLeft");w=b.find(".planStageTotalDone");z=b.find(".planStageTotalSelected");
x=b.find(".planStageTotalPlannedToDo");d.total=g;d.totalWithDiscount=h;d.totalDone=k;d.totalDoneWithDiscount=m;d.totalSelected=l;d.totalSelectedWithDiscount=A;d.totalPlannedToDo=y;d.totalPlannedToDoWithDiscount=B;0<l?(z.html('<td><i class="fa fa-circle"></i></td><td>'+formatPrice(l)+"</td>"+(f?"<td>-"+p+"%</td><td>"+formatPrice(A)+"</td>":"")).show(),r.hide(),w.hide(),x.hide()):(z.hide(),r.html('<td><i class="fa fa-circle"></i></td><td>'+formatPrice(q)+"</td>"+(f?"<td>-"+p+"%</td><td>"+formatPrice(t)+
"</td>":"")).show(),w.html('<td><i class="fa fa-check"></i></td><td>'+formatPrice(k)+"</td>"+(f?"<td>-"+p+"%</td><td>"+formatPrice(m)+"</td>":"")).show(),0==q&&r.hide(),0==k&&w.hide(),0<y&&x.html('<td><i class="fa fa-circle"></i></td><td>'+formatPrice(y)+"</td>"+(f?"<td>-"+p+"%</td><td>"+formatPrice(B)+"</td>":"")));0==u.find("tr").length?(c.addClass("display-none"),c.addClass("emptyPlanstageItems")):(c.removeClass("display-none"),c.removeClass("emptyPlanstageItems"));n&&d.formula!=FORMULA_ALL&&d.formula!=
FORMULA_CHILD_ALL&&e.addClass("emptyPlanStageFormula");planIsInitializing||(handleButtonsVisibility(),renderPlansTotal(),handleDeselectSelectedTeethButton(b));isMobileDevice||($("#planContainerWrap .deselectSelectedTeethButton").not(".tooltipstered").tooltipster({theme:"tooltipster-shadow"}),$("#planContainerWrap .selectTeethButton").not(".tooltipstered").tooltipster({theme:"tooltipster-shadow"}));b=!1;for(a in plan)for(v in d=plan[a],d.items)if(f=d.items[v],f.selected){b=!0;break}b||(selectingStatus=
0)}}
function getFormulaValueText(a,b,c){if(0==c)return"";switch(b){case FORMULA_NONE:return"";case FORMULA_ONE:case FORMULA_CHILD_ONE:return c;case FORMULA_JAW:case FORMULA_CHILD_JAW:if("ua"==cabinetLanguage)return 1==c?"\u0432/\u0449":"\u043d/\u0449";if("en"==cabinetLanguage)return 1==c?"t/j":"b/j";if("ru"==cabinetLanguage||"lt"==cabinetLanguage)return 1==c?"\u0432/\u0447":"\u043d/\u0447";break;case FORMULA_SEGMENT:if("ua"==cabinetLanguage)return"\u0441\u0435\u0433\u043c\u0435\u043d\u0442 "+c;if("en"==cabinetLanguage)return"segment "+
c;if("ru"==cabinetLanguage||"lt"==cabinetLanguage)return"\u0441\u0435\u0433\u043c\u0435\u043d\u0442 "+c;break;case FORMULA_QUADRANT:if("ua"==cabinetLanguage)return"\u043a\u0432\u0430\u0434\u0440\u0430\u043d\u0442 "+c;if("en"==cabinetLanguage)return"quadrant "+c;if("ru"==cabinetLanguage||"lt"==cabinetLanguage)return"\u043a\u0432\u0430\u0434\u0440\u0430\u043d\u0442 "+c}}
function renderPlansTotal(){var a=0,b=0,c=0,e=0,d=0,g=0,h=0,k=0,m=[];for(t in plan){var l=plan[t];"stage"==l.type&&(a+=parseFloat(l.total),b+=parseFloat(l.totalDone),c+=parseFloat(l.totalSelected),e+=parseFloat(l.totalPlannedToDo),d+=parseFloat(l.totalWithDiscount),g+=parseFloat(l.totalDoneWithDiscount),h+=parseFloat(l.totalSelectedWithDiscount),k+=parseFloat(l.totalPlannedToDoWithDiscount),-1==m.indexOf(l.discount)&&l.items.length&&m.push(l.discount))}var t=a-b;l=d-g;planDiscount=(planStagesHaveEqualDiscount=
1>=m.length&&(1==m.length?-1!=m[0]:!0))?0==m.length?initialPlanDiscount:m[0]:0;$(".plansTotalLeft").html(formatPrice(t));$(".plansTotalDone").html(formatPrice(b));0<planDiscount?$(".plansTotalDiscount").html("-"+planDiscount+"%").show():$(".plansTotalDiscount").html("").hide();a!=d?($(".plansTotalLeftWithDiscount").html(formatPrice(l)).show(),$(".plansTotalDoneWithDiscount").html(formatPrice(g)).show(),planStagesHaveEqualDiscount||$(".plansTotalDiscount").html("-%").show()):($(".plansTotalLeftWithDiscount").html("").hide(),
$(".plansTotalDoneWithDiscount").html("").hide(),$(".plansTotalSelectedWithDiscount").hide());$(".plansTotalDiscount").is(":visible")?$(".plansTotalDiv").addClass("plansTotalDivWithDiscount"):$(".plansTotalDiv").removeClass("plansTotalDivWithDiscount");$(".plansTotalLeftWrap, .plansTotalDoneWrap").show();0==b&&$(".plansTotalDoneWrap").hide();0==t&&$(".plansTotalLeftWrap").hide();0<c?(0<c&&($(".plansTotalSelectedWrap").show(),$(".plansTotalPlannedToDoWrap").hide(),$(".plansTotalSelected").html(formatPrice(c)),
$(".plansTotalSelectedWithDiscount").html(formatPrice(h))),$(".plansTotalLeftWrap, .plansTotalDoneWrap").hide()):$(".plansTotalSelectedWrap").hide();$(".plansTotalPlannedToDo").html(formatPrice(e));$(".plansTotalPlannedToDoWithDiscount").html(formatPrice(k))}
function getSelectedInFormulaValues(){var a=[],b=[],c=$(".activeStage"),e=parseInt(c.attr("data-id"));c.find(".selectedInFormula").each(function(a,c){b.push($(c).attr("data-tooth"))});for(var d in b)a.push(getFormulaValueByTooth(plan[e].formula,b[d]));return array_unique(a)}
function getFormulaValueByTooth(a,b){a=parseInt(a);b=parseInt(b);if(a==FORMULA_ONE||a==FORMULA_CHILD_ONE)return b;if(a==FORMULA_JAW)return 2>=Math.floor(b/10)?1:2;if(a==FORMULA_CHILD_JAW)return 2>=Math.floor((b-40)/10)?1:2;if(a==FORMULA_QUADRANT)return Math.floor(b/10);for(var c in FORMULAS[a])if(-1!=FORMULAS[a][c].indexOf(b))return parseInt(c)}function removeSelectionInFormula(){removeElementsClass($(".activeStage").find(".selectedInFormula"),"selectedInFormula")}
function handleButtonsVisibility(){var a=$("#planWrap").hasClass("planEditView")?"edit":"standard",b=0,c=0,e=0,d=0,g=0,h=0;"standard"==a&&(e=$(".planItem.planItemSelected").length,d=$(".planItem.planItemsStatusPlannedToDo").length,g=$(".planItem.planItemSelected.planItemsStatusDone").length,h=$(".planItem.planItemSelected.planItemsStatusInvoiced").length);$(".setStatusPlanButtonStatus3").show();g+h&&$(".setStatusPlanButtonStatus3").hide();for(var k in plan)"stage"==plan[k].type?b++:c++;c=b+c;b?$(".addPlanStage[data-clone=true]").fadeIn():
$(".addPlanStage[data-clone=true]").fadeOut();1<c?$(".sortPlanStages").fadeIn():$(".sortPlanStages").fadeOut();collapsedMode?($(".openAllPlanStages").show(),$(".collapseAllPlanStages").hide()):($(".collapseAllPlanStages").show(),$(".openAllPlanStages").hide());0==b&&$(".openAllPlanStages, .collapseAllPlanStages").hide();$("#planButtonsWrapChangeStatus, #planButtonsWrapEditPrint").hide();"edit"==a?($(".planButtonsWrapStandard, .planButtonsWrapChangeStatus").hide(),$(".planButtonsWrapEdit").show()):
($(".planButtonsWrapEdit").hide(),e?($(".planButtonsWrapStandard").hide(),$(".planButtonsWrapChangeStatus, #planButtonsWrapChangeStatus").show()):(d?$(".markDonePlannedToDo").show():$(".markDonePlannedToDo").hide(),$("#planButtonsWrapEditPrint").show(),$(".planButtonsWrapStandard").show(),$(".planButtonsWrapChangeStatus").hide()));$("#planWrap").removeClass("emptyPlan")}function handlePlanButtons(){$("#planWrap").length?$(".planButtons").show():$(".planButtons").hide()}
function handleDeselectSelectedTeethButton(a){isMobileDevice||$("#planWrap").hasClass("planStandardView")||("undefined"==typeof a&&(a=$("activeStage")),a.find(".selectedInFormula").length?(a.find(".deselectSelectedTeethButton").show(),a.find(".selectTeethButton").hide()):(a.find(".deselectSelectedTeethButton").hide(),a.find(".usedInFormula").length?a.find(".selectTeethButton").show():a.find(".selectTeethButton").hide()))}
function getPlanOpenedStages(){openedPlanStages=[];$("#planStages .planStage:not(.collapsedPlanStage)").each(function(){openedPlanStages.push(parseInt($(this).attr("data-id")))})}function formatPrice(a,b,c,e,d){b=2;e=" ";d=".";c="\\d(?=(\\d{3})+"+(0<b?"\\D":"$")+")";a=parseFloat(a);a=a.toFixed(Math.max(0,~~b));return(d?a.replace(".",d):a).replace(new RegExp(c,"g"),"$&"+(e||","))}function array_unique(a){var b=[];for(i=0;i<a.length;i++)"-1"==b.indexOf(a[i])&&b.push(a[i]);return b}
function elementHasClass(a,b){a=a.attr("class").split(" ");for(var c in a)if(a[c]==b)return!0;return!1}function addClassToElements(a,b){a.each(function(){$(this).attr("class");$(this).attr("class",$(this).attr("class")+" "+b)})}function removeElementsClass(a,b){a.each(function(){var a=$(this).attr("class").split(" "),e;for(e in a)a[e]==b&&delete a[e];$(this).attr("class",a.join(" "))})}
function selectInMarkedDoneClinicMemberSelectModalWhoDid(a){var b=0,c;a:for(c in planStagesOrder){var e=plan[planStagesOrder[c]];for(c in e.items){var d=e.items[c];if("selected"==a&&d.selected&&0==b){b=e.stageClinicsMembersId;break a}if("plannedTodo"==a&&d.status==PLAN_ITEM_STATUS_PLANNED_TO_DO&&0==b){b=e.stageClinicsMembersId;break a}if("markAllDone"==a&&(d.status==PLAN_ITEM_STATUS_PLANNED_TO_DO||d.status==PLAN_ITEM_STATUS_NEW)&&0==b){b=e.stageClinicsMembersId;break a}}}0==b&&(b=currentClinicMemberId);
"markAllDone"==a?($("#markedDoneClinicMemberSelectModalEditViewForm_clinicMemberId").val(b),$("#markedDoneClinicMemberSelectModalEditViewForm_clinicMemberId").trigger("change")):($("#markedDoneClinicMemberSelectModalForm_clinicMemberId").val(b),$("#markedDoneClinicMemberSelectModalForm_clinicMemberId").trigger("change"))}function rememberPlanCollapseMode(a){ajax({url:"/cabinet/i-me-mine/save-plans-collapse-mode/"+a,success:function(a){}})}
function handleSelectionRestrictions(a){selectingStatus||(selectingStatus=a);return itemStatusSuitableForSelectingStatus(a)}function itemStatusSuitableForSelectingStatus(a){if(a==selectingStatus||2>=a&&2>=selectingStatus)return!0}function getNewItemDiscount(a){var b=patientDiscount?patientDiscount:planDiscount;a=plan[a];return"undefined"==typeof a||"undefined"==typeof a.items?b:a.items.length?0<a.discount?a.discount:0:b};
;
$(document).ready(function(){function b(a,d){$(".markedDoneClinicMemberSelectModalStatusButton").prop("disabled",!1);$(".purposeSelectorButton").prop("disabled",!1);a&&($(".markedDoneClinicMemberSelectModalStatusButton[data-status="+a+"]").prop("disabled","disabled"),$(".purposeSelectorButton[data-status-purpose="+a+"]").prop("disabled","disabled"));$("#markedDoneClinicMemberSelectModal").modal("show");selectInMarkedDoneClinicMemberSelectModalWhoDid(d)}$("body").on("click",".planStandardView .planStageStatusButton, .planStandardView .planStageStatusButtonWithAvatar",
function(a){a=$(this).closest(".planStage");if(a.hasClass("activeStage")||!a.hasClass("collapsedPlanStage")){a=$(this).closest(".planStage").attr("data-id");var d=plan[a],c=!1;if(0==selectingStatus){var b={1:0,2:0,3:0,4:0},f;for(f in d.items){var e=d.items[f];currentClinicFinanceModel==CLINIC_FINANCE_MODEL_STANDARD?e.status!=PLAN_ITEM_STATUS_INVOICED&&b[e.status]++:b[e.status]++}for(f in b)if(b[f]){selectingStatus=f;break}}for(f in d.items)if(e=d.items[f],currentClinicFinanceModel==CLINIC_FINANCE_MODEL_STANDARD){if(e.status!=
PLAN_ITEM_STATUS_INVOICED&&!e.selected&&itemStatusSuitableForSelectingStatus(e.status)){c=!0;break}}else if(!e.selected&&itemStatusSuitableForSelectingStatus(e.status)){c=!0;break}for(f in d.items)e=d.items[f],currentClinicFinanceModel==CLINIC_FINANCE_MODEL_STANDARD?e.status!=PLAN_ITEM_STATUS_INVOICED&&(d.items[f].selected=c?itemStatusSuitableForSelectingStatus(e.status)?1:0:0):d.items[f].selected=c?itemStatusSuitableForSelectingStatus(e.status)?1:0:0;renderPlanStage(a)}});$("body").on("click",".planStandardView .planItem",
function(a){a=$(this).closest(".planStage").attr("data-id");var b=$(this).closest(".planItem").attr("data-idInPlan");currentClinicFinanceModel==CLINIC_FINANCE_MODEL_STANDARD&&plan[a].items[b].status==PLAN_ITEM_STATUS_INVOICED?confirmDialog({cancelButtonText:"Ok",text:T["Plan to cancel work, remove invoice"]}):handleSelectionRestrictions(plan[a].items[b].status)&&(plan[a].items[b].selected=plan[a].items[b].selected?0:1,renderPlanStage(a))});$("body").on("click",".planEditView .planItemStatusButton, .planEditView  .planStageStatusButton",
function(a){confirmDialog({cancelButtonText:"Ok",text:T["To change manipulation status save the plan please"]})});$("body").on("click",".markDonePlannedToDo",function(a){$("#markedDoneClinicMemberSelectModal").addClass("markDonePlannedToDoItemsModal");b(!1,"plannedTodo")});$("body").on("click",".setPlanStatus",function(a){$("#markedDoneClinicMemberSelectModal").removeClass("markDonePlannedToDoItemsModal");var d=a=0,c=0;for(h in plan){var g=plan[h],f;for(f in g.items){var e=g.items[f];e.selected&&
(e.status==PLAN_ITEM_STATUS_NEW&&a++,e.status==PLAN_ITEM_STATUS_PLANNED_TO_DO&&d++,e.status==PLAN_ITEM_STATUS_DONE&&c++)}}var h=!1;0<a&&0==d&&0==c&&(h=PLAN_ITEM_STATUS_NEW);0==a&&0<d&&0==c&&(h=PLAN_ITEM_STATUS_PLANNED_TO_DO);0==a&&0==d&&0<c&&(h=PLAN_ITEM_STATUS_DONE);b(h,"selected")});$("body").on("click",".markedDoneClinicMemberSelectModalStatusButton",function(a){savePlan({getStagesOrderFromList:!1,setItemsStatus:!0,itemsStatus:$(this).attr("data-status"),purpose:$(this).data("purpose")})});$("body").on("click",
".markedDoneClinicMemberSelectModalStatusButtonEditView",function(a){savePlan({markAllDone:!0})});$("body").on("click",".setStatusPlanButton",function(a){a=$(this).attr("data-status");$("#markedDoneClinicMemberSelectModal").removeClass("markDonePlannedToDoItemsModal");$(".markedDoneClinicMemberSelectModalStatusButton, .markedDoneClinicMemberSelectModalStatusButton_STATUS_PLANNED_TO_DO").hide();$("#markedDoneClinicMemberSelectModal .select2WrapWithAvatars, #markedDoneClinicMemberSelectModalDate").hide();
$(".markedDoneDiagnosisInput").hide();$("#markedDoneClinicMemberSelectModalSubclinicsGroup").hide().attr("disabled","disable");1==a&&($(".markedDoneClinicMemberSelectModalStatusButton_STATUS_NEW").show(),selectInMarkedDoneClinicMemberSelectModalWhoDid("selected"));2==a&&($("#markedDoneClinicMemberSelectModal .select2WrapWithAvatars, #markedDoneClinicMemberSelectModalDate").show(),$(".markedDoneClinicMemberSelectModalStatusButton_STATUS_PLANNED_TO_DO").show(),selectInMarkedDoneClinicMemberSelectModalWhoDid("selected"));
3==a&&($("#markedDoneClinicMemberSelectModal .select2WrapWithAvatars, #markedDoneClinicMemberSelectModalDate").show(),$(".markedDoneClinicMemberSelectModalStatusButton_STATUS_DONE").show(),$(".markedDoneDiagnosisInput").show(),selectInMarkedDoneClinicMemberSelectModalWhoDid("selected"),$("#markedDoneClinicMemberSelectModalSubclinicsGroup").show().removeAttr("disabled"));$("#markedDoneClinicMemberSelectModal").modal("show")})});
function getPlanStageStatusByItemsStatusesAndClassesForFilters(b){var a=plan[b],d=b=0,c=0,g=0,f=0;for(h in a.items){var e=a.items[h];e.status==PLAN_ITEM_STATUS_NEW&&b++;e.status==PLAN_ITEM_STATUS_PLANNED_TO_DO&&d++;e.status==PLAN_ITEM_STATUS_DONE&&c++;e.status==PLAN_ITEM_STATUS_INVOICED&&g++;e.selected&&f++}var h=PLAN_STAGE_STATUS_NEW;0==b&&0==f&&0==c&&(h=PLAN_STAGE_STATUS_NEW);0==b&&0==f&&0<c+g&&(h=PLAN_STAGE_STATUS_DONE);0<b&&0==c&&(h=PLAN_STAGE_STATUS_NEW);0<b&&0<c+g&&(h=PLAN_STAGE_STATUS_MIXED_NEW);
0<d&&(h=PLAN_STAGE_STATUS_PLANNED_TO_DO);0<f&&(h=PLAN_STAGE_STATUS_SELECTED);return{planStageStatus:h,classesForFilters:(0<d?"planStageHasPlannedToDoItems":"")+(0<c+g?" planStageHasDoneItems":"")+(0<b+d?" planStageHasNewItems":"")}}
function getDoneFormulaValues(b){var a=[];b=plan[b];for(var d in b.items){var c=b.items[d],g=a.indexOf(c.formulaValue);c.status!=PLAN_ITEM_STATUS_DONE&&c.status!=PLAN_ITEM_STATUS_INVOICED||c.formula!=b.formula||-1==g&&a.push(c.formulaValue)}for(d in b.items)c=b.items[d],g=a.indexOf(c.formulaValue),c.status!=PLAN_ITEM_STATUS_DONE&&c.status!=PLAN_ITEM_STATUS_INVOICED&&c.formula==b.formula&&-1!=g&&a.splice(g,1);return a}
function getSelectedFormulaValues(b){var a=[];b=plan[b];for(var d in b.items){var c=b.items[d],g=a.indexOf(c.formulaValue);1==c.selected&&c.formula==b.formula&&-1==g&&a.push(c.formulaValue)}return a}function getPlannedToDoFormulaValues(b){var a=[];b=plan[b];for(var d in b.items){var c=b.items[d],g=a.indexOf(c.formulaValue);c.status==PLAN_ITEM_STATUS_PLANNED_TO_DO&&c.formula==b.formula&&-1==g&&a.push(c.formulaValue)}return a};
;
$(document).ready(function(){$("body").on("click",".toggleImageViewer",function(a){var b=$("#floatingViewer"),c=$(".toggleImageViewer");b.is(":visible")?(c.fadeIn(),b.fadeOut()):(a=$(this).attr("data-patientId"),ajax({url:"/cabinet/floating-viewer/get-images/"+a,success:function(a){a.result?($("#floatingViewerContents").html(a.html),$(".floatingViewerNoContent").hide()):($("#floatingViewerContents").html("").show(),$(".floatingViewerNoContent").show());$("#zoom_container_floating").hide();handleFloatingViewerButtons();
setFloatingViewerPositionFromCookie();c.fadeOut();b.fadeIn()}}))});$(window).resize(function(a){a.target==this&&$("#floatingViewer").is(":visible")&&setFloatingViewerPositionFromCookie()});$("body").on("click","#closeFloatingViewerButton",function(a){$("#floatingViewer").fadeOut();$(".toggleImageViewer").show()});$("body").on("click","#closeFloatingZoom",function(a){$(".floatingViewerNavigationButton").fadeOut("fast");$("#zoom_container_floating").fadeOut("fast",function(){handleFloatingViewerButtons()})});
$("#floatingViewer").draggable({handle:".draggableHandle",containment:"parent",stop:function(){saveFloatingViewerPosition()}}).on("click",function(){$(this).focus()}).resizable({handles:"all",minWidth:400,minHeight:270,containment:"parent",stop:function(){saveFloatingViewerPosition()}});$("#floatingViewer").on("keyup",function(a){37==a.keyCode&&$("#floatingViewerPrevZoomImage").trigger("click");39==a.keyCode&&$("#floatingViewerNextZoomImage").trigger("click")})});
function handleFloatingViewerButtons(){$("#zoom_container_floating").is(":visible")?$(".floatingViewerNavigationButton").fadeIn("fast"):$(".floatingViewerNavigationButton").fadeOut("fast")}function saveFloatingViewerPosition(){var a=$("#floatingViewer"),b=a.offset();a=[a.width(),a.height(),b.left,b.top];$.cookie("floatingViewerPosition",a.join(","),{expires:300,path:"/"})}
function setFloatingViewerPositionFromCookie(){$.cookie("floatingViewerPosition");if($.cookie("floatingViewerPosition")){var a=$.cookie("floatingViewerPosition").split(","),b=parseInt(a[0]),c=parseInt(a[1]),d=parseInt(a[2]);a=parseInt(a[3]);var f=$(window).width(),e=$(window).height();f>=b+d&&e>=c&&e>a+30&&0<=d&&0<=a?$("#floatingViewer").css({width:b,height:c,left:d+"px",top:a+"px"}):$("#floatingViewer").css({width:"",height:"",left:"",top:""})}};
;
function createGroupedByDatePlan(){planByDates={};planStagesOrder=[];for(var a in plan){var c=plan[a];if(!c.comment){var e=jQuery.extend(!0,{},c);e.items=[];for(var f in c.items){var d=c.items[f];if(d.status==PLAN_ITEM_STATUS_DONE||d.status==PLAN_ITEM_STATUS_INVOICED){var b=d.done_date.substring(0,10);"undefined"==typeof planByDates[b+"-"+a]&&(planByDates[b+"-"+a]=jQuery.extend(!0,{stageDate:b},e),planByDates[b+"-"+a].id=b+"-"+a,planStagesOrder.push(b+"-"+a));planByDates[b+"-"+a].items.push(d)}}}}planStagesOrder.sort();
console.log("planByDates.items",planByDates);plan=planByDates}function makeSurePlanGroupingIsStandard(){"standard"!=planGrouping&&initPlan("standard")}function handleGroupingSelectors(){$(".planGroupByButton").removeClass("active");console.log("planGrouping",planGrouping);"standard"==planGrouping&&$(".planGroupByButton[data-groupBy=standard]").addClass("active");"dates"==planGrouping&&$(".planGroupByButton[data-groupBy=dates]").addClass("active")}
$("body").on("click",".planGroupByButton",function(a){a=$(this).attr("data-groupBy");"standard"==a&&"standard"!=planGrouping&&initPlan("standard");"dates"==a&&"dates"!=planGrouping&&initPlan("dates");0==$("#planStages .planStage:visible").length&&$("#planWrap").addClass("emptyPlan")});function readableDate(a){a=a.split("-");return a[2]+"."+a[1]+"."+a[0]};
;
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,b,c){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var f=a[e];if(b.call(c,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){if(a==Array.prototype||a==Object.prototype)return a;a[b]=c.value;return a};$jscomp.getGlobal=function(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var c=a[b];if(c&&c.Math==Math)return c}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(a,b){var c=$jscomp.propertyToPolyfillSymbol[b];if(null==c)return a[b];c=a[c];return void 0!==c?c:a[b]};
$jscomp.polyfill=function(a,b,c,d){b&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(a,b,c,d):$jscomp.polyfillUnisolated(a,b,c,d))};$jscomp.polyfillUnisolated=function(a,b,c,d){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})};
$jscomp.polyfillIsolated=function(a,b,c,d){var e=a.split(".");a=1===e.length;d=e[0];d=!a&&d in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var f=0;f<e.length-1;f++){var g=e[f];g in d||(d[g]={});d=d[g]}e=e[e.length-1];c=$jscomp.IS_SYMBOL_NATIVE&&"es6"===c?d[e]:null;b=b(c);null!=b&&(a?$jscomp.defineProperty($jscomp.polyfills,e,{configurable:!0,writable:!0,value:b}):b!==c&&($jscomp.propertyToPolyfillSymbol[e]=$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(e):$jscomp.POLYFILL_PREFIX+e,e=$jscomp.propertyToPolyfillSymbol[e],
$jscomp.defineProperty(d,e,{configurable:!0,writable:!0,value:b})))};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6","es3");
(function(a,b){var c={drawFormula:function(a){var c=b(a).closest("[data-plan-template-item]"),d=c.find("[data-plan-template-formula]");a=b(a).data("value");switch(a){case FORMULA_NONE:d.html(b("#formulaPrototypeNone").html());break;case FORMULA_CHILD_ONE:case FORMULA_CHILD_JAW:case FORMULA_CHILD_ALL:d.html(b("#formulaPrototypeChild").html());break;default:d.html(b("#formulaPrototype").html())}d.find(".writings:not(.writings"+a+")").remove();d.attr("class","planStageFormula planStageFormula"+a);c.find("[data-plan-template-type]").data("plan-template-formula",
a);return!1},remove:function(a){b(a).closest("[data-plan-template-item]").remove()},add:function(a,e){var d=Math.round(1E5*Math.random()),g=b("#planStagePrototype").html();b("#planStages").append(b(g).attr("data-plan-template-item",d));c.drawFormula(b("#planStages").find("[data-plan-template-item="+d+"] [data-value="+e+"]")[0]);b("#planStages").find("[data-plan-template-item="+d+"] [data-plan-template-type]").val(a).focus();return!1},addComment:function(a){var c=Math.round(1E5*Math.random()),d=b("#planStageCommentPrototype").html();
b("#planStages").append(b(d).attr("data-plan-template-item",c));b("#planStages").find("[data-plan-template-item="+c+"] [data-plan-template-type]").val(a).focus();autosize(b("#planStages").find("[data-plan-template-item="+c+"] [data-plan-template-type]"))},removeComment:function(a){b(a).closest("[data-plan-template-item]").remove()}};a.planTemplates=c})(window,jQuery);
$("body").on("click","[data-plan-template-wrap]",function(a){$(a.target).is("[data-plan-template-wrap]")&&(a.stopImmediatePropagation(),window.planTemplates.add("",window.planTemplates.defaultFormula))});$("body").on("click","[data-plan-template-add-button]",function(a){a.stopImmediatePropagation();window.planTemplates.add("",window.planTemplates.defaultFormula)});$("body").on("click","[data-plan-template-add-comment-button]",function(a){a.stopImmediatePropagation();window.planTemplates.addComment()});
$("body").on("click","[data-plan-template-wrap] .planStageFormulaSelect a",function(a){$(this).closest("ul").find("li").removeClass("active");$(this).closest("li").addClass("active");window.planTemplates.drawFormula(this)});$("body").on("click","[data-plan-template-wrap] .planStageRemoveButton",function(a){a.stopImmediatePropagation();window.planTemplates.remove(this)});$("body").on("click","[data-plan-template-wrap] .planStageCommentRemoveButton",function(a){a.stopImmediatePropagation();window.planTemplates.removeComment(this)});
$("body").on("click","[data-plan-template-save]",function(a){var b=[];$("[data-plan-template-wrap] [data-plan-template-type]").each(function(){b.push({item_order:b.length,name:$(this).val(),type:$(this).data("plan-template-type"),formula:$(this).data("plan-template-formula")})});ajax({url:"/cabinet/plans-templates/save/"+($("[data-plan-template-id]").data("plan-template-id")||0),data:{items:b},success:function(){changeLocationHash("#plans-templates")}})});
;
$("body").on("click","#createPatientModalTrigger",function(b){var a=_select2SearchTerm;_select2SearchTerm="";a.length&&(a=a.charAt(0).toUpperCase()+a.slice(1));b.preventDefault();$("#createPatientModalForm_lastname").val(a);$("#createPatientModalForm_firstname").val("");$("#createPatientModalForm_phone").val(defaultPhonePrefix);$("#createPatientModalForm_note").val("");$("#pickerPatientsBirthday .birth-day").val(0).trigger("change");$("#pickerPatientsBirthday .birth-month").val(0).trigger("change");
$("#pickerPatientsBirthday .birth-year").val(0).trigger("change");$("#createPatientModalForm_gender_1").prop("checked",!1);$("#createPatientModalForm_gender_2").prop("checked",!0);$(".createPatientModalForm_gender").uniform();$("#createPatientModal").modal("show");applyPhoneMask("#createPatientModalForm_phone");$("#createPatientModalForm_lastname").focusToEnd()});
$("body").on("submit","#createPatientModalForm",function(b){b.preventDefault();b=$("#createPatientModalForm_lastname").val();var a=$("#createPatientModalForm_firstname").val(),c=$("#createPatientModalForm_phone").val(),d=$(".createPatientModalForm_gender:checked").val(),e=$("#pickerPatientsBirthday .birth-day").val(),f=$("#pickerPatientsBirthday .birth-month").val(),g=$("#pickerPatientsBirthday .birth-year").val();ajax({url:"/cabinet/patients/create-patient-modal-form",data:{lastname:b,firstname:a,
phone:c,gender:d,birthDay:e,birthMonth:f,birthYear:g},success:function(a){if(1==a.saved){$("#createPatientModal").modal("hide");$("#visitForm_patientSelectContainer").html(a.patientSelectHtml);a=T["Primary patient"];4483==currentClinicId&&(a="(1)");var b=$("#visitForm_note").val();b!=a&&$("#visitForm_note").val((b.length?b+" ":"")+a)}}})});var _select2SearchTerm="",_select2SearchTermTimeout=!1;
$("body").on("change",".select2-search__field",function(b){_select2SearchTermTimeout&&clearTimeout(_select2SearchTermTimeout);_select2SearchTerm=$(this).val();setTimeout(function(){_select2SearchTerm=""},7E3)});
;
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,b,c){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var f=a[e];if(b.call(c,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){a=["object"==typeof globalThis&&globalThis,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,a];for(var b=0;b<a.length;++b){var c=a[b];if(c&&c.Math==Math)return c}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6","es3");
clock={initPeriodClock:function(a){},getTime:function(a){var b=a.find(".clockTimeValueHiddenInput").val().split(":");a=Math.abs(parseInt(b[0]));a=Math.min(23,a);b=Math.abs(parseInt(b[1]));b=Math.min(59,b);return{hours:a,minutes:b}},setTime:function(a,b){var c="0"+b.hours;c=c.substr(c.length-2);var d="0"+b.minutes;d=d.substr(d.length-2);a.find(".clockTimeValueHiddenInput").val(c+":"+d);a.find(".clockHours").val(b.hours);a.find(".clockMinutes").val(d);if("undefined"!=typeof a.attr("data-minutesPeriodsContainerId")){c=
clock.getTime($("#visitForm_timeStart"));d=clock.getTime($("#visitForm_timeEnd"));var e=60*(d.hours-c.hours)+(d.minutes-c.minutes);$("#visitModal .periodLength").removeClass("selected");$("#visitModal .periodLength[data-periodMinutes="+e+"]").addClass("selected")}"undefined"!=typeof a.attr("data-minutesSpacePeriodsContainerId")&&(c=clock.getTime($("#visitSpaceForm_timeStart")),d=clock.getTime($("#visitSpaceForm_timeEnd")),e=60*(d.hours-c.hours)+(d.minutes-c.minutes),$("#visitSpaceModal .periodLength").removeClass("selected"),
$("#visitSpaceModal .periodLength[data-periodMinutes="+e+"]").addClass("selected"));"undefined"!=typeof a.attr("data-minutesAssistantPeriodsContainerId")&&(c=clock.getTime($("#visitAssistantForm_timeStart")),d=clock.getTime($("#visitAssistantForm_timeEnd")),e=60*(d.hours-c.hours)+(d.minutes-c.minutes),$("#visitAssistantModal .periodLength").removeClass("selected"),$("#visitAssistantModal .periodLength[data-periodMinutes="+e+"]").addClass("selected"));"undefined"!=typeof a.attr("data-hoursPeriodsContainerId")&&
(c=clock.getTime($("#scheduleShiftForm_timeStart")),d=clock.getTime($("#scheduleShiftForm_timeEnd")),e=60*(d.hours-c.hours)+(d.minutes-c.minutes),$("#scheduleShiftModal .periodLength").removeClass("selected"),0==e%60&&$("#scheduleShiftModal .periodLength[data-periodHours="+e/60+"]").addClass("selected"));a=a.closest(".clockMegaBlock");a.length&&(c=Math.floor(e/60),d=e%60,a.find(".clockReadableTime").html(clock.getReadableTime(c,d)))},clockChangeHours:function(a,b){var c=clock.getTime(a);c.hours+=
b;23<c.hours&&(c.hours=0);0>c.hours&&(c.hours=23);clock.setTime(a,c)},clockChangeMinutes:function(a,b){var c=clock.getTime(a);c.minutes+=b;59<c.minutes&&(c.minutes=0);0>c.minutes&&(c.minutes=55);clock.setTime(a,c)},setTimeString:function(a,b){b=b.split(":");var c=Math.abs(parseInt(b[0]));c=Math.min(23,c);b=Math.abs(parseInt(b[1]));b=Math.min(59,b);clock.setTime(a,{hours:c,minutes:b})},getReadableTime:function(a,b,c,d){a=Math.max(a,0);b=Math.max(b,0);if("ua"==cabinetLanguage)var e=a+" "+declensionByNumber(a,
"\u0433\u043e\u0434\u0438\u043d\u0430","\u0433\u043e\u0434\u0438\u043d\u0438","\u0433\u043e\u0434\u0438\u043d"),f=b+" "+declensionByNumber(b,"\u0445\u0432\u0438\u043b\u0438\u043d\u0430","\u0445\u0432\u0438\u043b\u0438\u043d\u0438","\u0445\u0432\u0438\u043b\u0438\u043d");"en"==cabinetLanguage&&(e=a+" "+declensionByNumber(a,"hour","hours","hours"),f=b+" "+declensionByNumber(b,"minute","minutes","minutes"));"ru"==cabinetLanguage&&(e=a+" "+declensionByNumber(a,"\u0447\u0430\u0441","\u0447\u0430\u0441\u0430",
"\u0447\u0430\u0441\u043e\u0432"),f=b+" "+declensionByNumber(b,"\u043c\u0438\u043d\u0443\u0442\u0430","\u043c\u0438\u043d\u0443\u0442\u044b","\u043c\u0438\u043d\u0443\u0442"));return(a||"undefined"!=typeof c&&c?e+" ":"")+(b||"undefined"!=typeof d&&d?f:"")},setTimeFromInputs:function(a){var b=a.find(".clockHours").val(),c=a.find(".clockMinutes").val();clock.setTimeString(a,b+":"+c)},handleChanges:function(){"#settings-schedule"==location.hash&&(unsavedChanges=!0)}};
$("body").on("click",".clockHoursUp",function(a){clock.handleChanges();a=$(this).closest(".clockContainer");clock.clockChangeHours(a,1)});$("body").on("click",".clockHoursDown",function(a){clock.handleChanges();a=$(this).closest(".clockContainer");clock.clockChangeHours(a,-1)});$("body").on("click",".clockMinutesUp",function(a){clock.handleChanges();a=$(this).closest(".clockContainer");clock.clockChangeMinutes(a,5)});
$("body").on("click",".clockMinutesDown",function(a){clock.handleChanges();a=$(this).closest(".clockContainer");clock.clockChangeMinutes(a,-5)});$("body").on("click",".periodLength",function(a){a=$(this).parent();var b=parseInt($(this).attr("data-periodHours"))||0,c=parseInt($(this).attr("data-periodMinutes"))||0,d=clock.getTime($("#"+a.attr("data-clockIdStart")));b=60*d.hours+d.minutes+60*b+c;b=Math.min(b,1435);clock.setTime($("#"+a.attr("data-clockIdEnd")),{hours:Math.floor(b/60),minutes:b%60})});
function declensionByNumber(a,b,c,d){var e=[2,0,1,1,1,2];return[b,c,d][4<a%100&&20>a%100?2:e[5>a%10?a%10:5]]}function getAgeYearsWord(a){return"ua"==cabinetLanguage?declensionByNumber(a,"\u0440\u0456\u043a","\u0440\u043e\u043a\u0438","\u0440\u043e\u043a\u0456\u0432"):"ru"==cabinetLanguage?declensionByNumber(a,"\u0433\u043e\u0434","\u0433\u043e\u0434\u0430","\u043b\u0435\u0442"):declensionByNumber(a,"year","years","years")}
$("body").on("click",".clockHours, .clockMinutes",function(a){a=$(this);a.prop("selectionStart",0);a.prop("selectionEnd",999)});$("body").on("input",".clockHours",function(a){clock.handleChanges();a=$(this).val();var b=parseInt(a);isNaN(b)&&(b=0);if(2==a.length||2<b)a=$(this).closest(".clockContainer").find(".clockMinutes"),a.focus(),a.prop("selectionStart",0),a.prop("selectionEnd",999)});
$("body").on("focusout",".clockHours",function(a){a=$(this);var b=a.val();b=parseInt(b);isNaN(b)&&(b=0);0>b&&(b=0);23<b&&(b=23);a.val(b);clock.setTimeFromInputs($(this).closest(".clockContainer"))});$("body").on("input",".clockMinutes",function(a){clock.handleChanges();a=$(this);2==a.val().length&&(a=a.attr("nextClockId"),"undefined"!=typeof a?(a=$("#"+a).find(".clockHours"),a.focus(),a.prop("selectionStart",0),a.prop("selectionEnd",999)):clock.setTimeFromInputs($(this).closest(".clockContainer")))});
$("body").on("focusout",".clockMinutes",function(a){a=$(this);var b=a.val();b=parseInt(b);isNaN(b)&&(b=0);0>b&&(b=0);55<b&&(b=55);b=5*Math.ceil(b/5);b="0"+b;b=b.substr(b.length-2);a.val(b);clock.setTimeFromInputs($(this).closest(".clockContainer"))});
;
/*
 Select2 4.0.5 | https://github.com/select2/select2/blob/master/LICENSE.md */
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(l,r,q){l instanceof String&&(l=String(l));for(var h=l.length,e=0;e<h;e++){var f=l[e];if(r.call(q,f,e,l))return{i:e,v:f}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(l,r,q){l!=Array.prototype&&l!=Object.prototype&&(l[r]=q.value)};$jscomp.getGlobal=function(l){l=["object"==typeof globalThis&&globalThis,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,l];for(var r=0;r<l.length;++r){var q=l[r];if(q&&q.Math==Math)return q}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(l,r,q,h){if(r){q=$jscomp.global;l=l.split(".");for(h=0;h<l.length-1;h++){var e=l[h];e in q||(q[e]={});q=q[e]}l=l[l.length-1];h=q[l];r=r(h);r!=h&&null!=r&&$jscomp.defineProperty(q,l,{configurable:!0,writable:!0,value:r})}};$jscomp.polyfill("Array.prototype.find",function(l){return l?l:function(l,q){return $jscomp.findInternal(this,l,q).v}},"es6","es3");
!function(l){"function"==typeof define&&define.amd?define(["jquery"],l):"object"==typeof module&&module.exports?module.exports=function(r,q){return void 0===q&&(q="undefined"!=typeof window?require("jquery"):require("jquery")(r)),l(q),q}:l(jQuery)}(function(l){var r=function(){if(l&&l.fn&&l.fn.select2&&l.fn.select2.amd)var h=l.fn.select2.amd;return function(){if(!h||!h.requirejs){h?f=h:h={};var e,f,d;!function(a){function c(b,c){var a,g,d,m,e,t;c=c&&c.split("/");var f=u.map,p=f&&f["*"]||{};if(b){b=
b.split("/");var n=b.length-1;u.nodeIdCompat&&D.test(b[n])&&(b[n]=b[n].replace(D,""));"."===b[0].charAt(0)&&c&&(e=c.slice(0,c.length-1),b=e.concat(b));for(e=0;e<b.length;e++)"."===(n=b[e])?(b.splice(e,1),--e):".."!==n||0===e||1===e&&".."===b[2]||".."===b[e-1]||0<e&&(b.splice(e-1,2),e-=2);b=b.join("/")}if((c||p)&&f){n=b.split("/");for(e=n.length;0<e;--e){if(a=n.slice(0,e).join("/"),c)for(t=c.length;0<t;--t)if((g=f[c.slice(0,t).join("/")])&&(g=g[a])){var y=g;var h=e;break}if(y)break;!d&&p&&p[a]&&(d=
p[a],m=e)}!y&&d&&(y=d,h=m);y&&(n.splice(0,h,y),b=n.join("/"))}return b}function b(b,c){return function(){var g=E.call(arguments,0);return"string"!=typeof g[0]&&1===g.length&&g.push(null),h.apply(a,g.concat([b,c]))}}function g(b){return function(a){return c(a,b)}}function m(b){return function(c){l[b]=c}}function t(b){if(r.call(q,b)){var c=q[b];delete q[b];A[b]=!0;B.apply(a,c)}if(!r.call(l,b)&&!r.call(A,b))throw Error("No "+b);return l[b]}function p(b){var c,a=b?b.indexOf("!"):-1;return-1<a&&(c=b.substring(0,
a),b=b.substring(a+1,b.length)),[c,b]}function n(b){return function(){return u&&u.config&&u.config[b]||{}}}var h,l={},q={},u={},A={},r=Object.prototype.hasOwnProperty,E=[].slice,D=/\.js$/;var w=function(b,a){var d,m=p(b),e=m[0];a=a[1];return b=m[1],e&&(e=c(e,a),d=t(e)),e?b=d&&d.normalize?d.normalize(b,g(a)):c(b,a):(b=c(b,a),m=p(b),e=m[0],b=m[1],e&&(d=t(e))),{f:e?e+"!"+b:b,n:b,pr:e,p:d}};var x={require:function(c){return b(c)},exports:function(b){var c=l[b];return void 0!==c?c:l[b]={}},module:function(b){return{id:b,
uri:"",exports:l[b],config:n(b)}}};var B=function(c,g,d,e){var f,n,h,v=[];var k=typeof d;if(e=e||c,h=e?p(e):[],"undefined"===k||"function"===k){g=!g.length&&d.length?["require","exports","module"]:g;for(n=0;n<g.length;n+=1)if(f=w(g[n],h),"require"===(k=f.f))v[n]=x.require(c);else if("exports"===k){v[n]=x.exports(c);var u=!0}else if("module"===k)var C=v[n]=x.module(c);else if(r.call(l,k)||r.call(q,k)||r.call(A,k))v[n]=t(k);else{if(!f.p)throw Error(c+" missing "+k);f.p.load(f.n,b(e,!0),m(k),{});v[n]=
l[k]}g=d?d.apply(l[c],v):void 0;c&&(C&&C.exports!==a&&C.exports!==l[c]?l[c]=C.exports:g===a&&u||(l[c]=g))}else c&&(l[c]=d)};e=f=h=function(b,c,g,d,m){if("string"==typeof b)return x[b]?x[b](c):t(w(b,c?p(c):[]).f);if(!b.splice){if(u=b,u.deps&&h(u.deps,u.callback),!c)return;c.splice?(b=c,c=g,g=null):b=a}return c=c||function(){},"function"==typeof g&&(g=d,d=m),d?B(a,b,c,g):setTimeout(function(){B(a,b,c,g)},4),h};h.config=function(b){return h(b)};e._defined=l;d=function(b,c,a){if("string"!=typeof b)throw Error("See almond README: incorrect module build, no module name");
c.splice||(a=c,c=[]);r.call(l,b)||r.call(q,b)||(q[b]=[b,c,a])};d.amd={jQuery:!0}}();h.requirejs=e;h.require=f;h.define=d}}(),h.define("almond",function(){}),h.define("jquery",[],function(){var e=l||$;return null==e&&console&&console.error&&console.error("Select2: An instance of jQuery or a jQuery-compatible library was not found. Make sure that you are including jQuery before Select2 on your web page."),e}),h.define("select2/utils",["jquery"],function(e){function f(c){c=c.prototype;var b=[],a;for(a in c)"function"==
typeof c[a]&&"constructor"!==a&&b.push(a);return b}var d={Extend:function(c,b){function a(){this.constructor=c}var d={}.hasOwnProperty,e;for(e in b)d.call(b,e)&&(c[e]=b[e]);return a.prototype=b.prototype,c.prototype=new a,c.__super__=b.prototype,c},Decorate:function(c,b){function a(){var a=Array.prototype.unshift,g=c.prototype.constructor;0<b.prototype.constructor.length&&(a.call(arguments,c.prototype.constructor),g=b.prototype.constructor);g.apply(this,arguments)}var d=f(b),e=f(c);b.displayName=
c.displayName;a.prototype=new function(){this.constructor=a};for(var p=0;p<e.length;p++){var n=e[p];a.prototype[n]=c.prototype[n]}e=function(c){var g=function(){};c in a.prototype&&(g=a.prototype[c]);var d=b.prototype[c];return function(){return Array.prototype.unshift.call(arguments,g),d.apply(this,arguments)}};for(p=0;p<d.length;p++)n=d[p],a.prototype[n]=e(n);return a}},a=function(){this.listeners={}};return a.prototype.on=function(c,b){this.listeners=this.listeners||{};c in this.listeners?this.listeners[c].push(b):
this.listeners[c]=[b]},a.prototype.trigger=function(c){var b=Array.prototype.slice,a=b.call(arguments,1);this.listeners=this.listeners||{};null==a&&(a=[]);0===a.length&&a.push({});a[0]._type=c;c in this.listeners&&this.invoke(this.listeners[c],b.call(arguments,1));"*"in this.listeners&&this.invoke(this.listeners["*"],arguments)},a.prototype.invoke=function(c,b){for(var a=0,d=c.length;a<d;a++)c[a].apply(this,b)},d.Observable=a,d.generateChars=function(c){for(var b="",a=0;a<c;a++)b+=Math.floor(36*Math.random()).toString(36);
return b},d.bind=function(c,b){return function(){c.apply(b,arguments)}},d._convertData=function(c){for(var b in c){var a=b.split("-"),d=c;if(1!==a.length){for(var e=0;e<a.length;e++){var f=a[e];f=f.substring(0,1).toLowerCase()+f.substring(1);f in d||(d[f]={});e==a.length-1&&(d[f]=c[b]);d=d[f]}delete c[b]}}return c},d.hasScroll=function(c,b){c=e(b);var a=b.style.overflowX,d=b.style.overflowY;return(a!==d||"hidden"!==d&&"visible"!==d)&&("scroll"===a||"scroll"===d||c.innerHeight()<b.scrollHeight||c.innerWidth()<
b.scrollWidth)},d.escapeMarkup=function(c){var b={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};return"string"!=typeof c?c:String(c).replace(/[&<>"'\/\\]/g,function(c){return b[c]})},d.appendMany=function(c,b){if("1.7"===e.fn.jquery.substr(0,3)){var a=e();e.map(b,function(b){a=a.add(b)});b=a}c.append(b)},d}),h.define("select2/results",["jquery","./utils"],function(e,f){function d(a,c,b){this.$element=a;this.data=b;this.options=c;d.__super__.constructor.call(this)}
return f.Extend(d,f.Observable),d.prototype.render=function(){var a=e('<ul class="select2-results__options" role="tree"></ul>');return this.options.get("multiple")&&a.attr("aria-multiselectable","true"),this.$results=a,a},d.prototype.clear=function(){this.$results.empty()},d.prototype.displayMessage=function(a){var c=this.options.get("escapeMarkup");this.clear();this.hideLoading();var b=e('<li role="treeitem" aria-live="assertive" class="select2-results__option"></li>'),g=this.options.get("translations").get(a.message);
b.append(c(g(a.args)));b[0].className+=" select2-results__message";this.$results.append(b)},d.prototype.hideMessages=function(){this.$results.find(".select2-results__message").remove()},d.prototype.append=function(a){this.hideLoading();var c=[];if(null==a.results||0===a.results.length)return void(0===this.$results.children().length&&this.trigger("results:message",{message:"noResults"}));a.results=this.sort(a.results);for(var b=0;b<a.results.length;b++){var g=this.option(a.results[b]);c.push(g)}this.$results.append(c)},
d.prototype.position=function(a,c){c.find(".select2-results").append(a)},d.prototype.sort=function(a){return this.options.get("sorter")(a)},d.prototype.highlightFirstItem=function(){var a=this.$results.find(".select2-results__option[aria-selected]"),c=a.filter("[aria-selected=true]");0<c.length?c.first().trigger("mouseenter"):a.first().trigger("mouseenter");this.ensureHighlightVisible()},d.prototype.setClasses=function(){var a=this;this.data.current(function(c){var b=e.map(c,function(b){return b.id.toString()});
a.$results.find(".select2-results__option[aria-selected]").each(function(){var c=e(this),a=e.data(this,"data"),d=""+a.id;null!=a.element&&a.element.selected||null==a.element&&-1<e.inArray(d,b)?c.attr("aria-selected","true"):c.attr("aria-selected","false")})})},d.prototype.showLoading=function(a){this.hideLoading();a={disabled:!0,loading:!0,text:this.options.get("translations").get("searching")(a)};a=this.option(a);a.className+=" loading-results";this.$results.prepend(a)},d.prototype.hideLoading=function(){this.$results.find(".loading-results").remove()},
d.prototype.option=function(a){var c=document.createElement("li");c.className="select2-results__option";var b={role:"treeitem","aria-selected":"false"};a.disabled&&(delete b["aria-selected"],b["aria-disabled"]="true");null==a.id&&delete b["aria-selected"];null!=a._resultId&&(c.id=a._resultId);a.title&&(c.title=a.title);a.children&&(b.role="group",b["aria-label"]=a.text,delete b["aria-selected"]);for(var g in b)c.setAttribute(g,b[g]);if(a.children){b=e(c);g=document.createElement("strong");g.className=
"select2-results__group";e(g);this.template(a,g);for(var d=[],f=0;f<a.children.length;f++){var p=this.option(a.children[f]);d.push(p)}f=e("<ul></ul>",{class:"select2-results__options select2-results__options--nested"});f.append(d);b.append(g);b.append(f)}else this.template(a,c);return e.data(c,"data",a),c},d.prototype.bind=function(a,c){var b=this;this.$results.attr("id",a.id+"-results");a.on("results:all",function(c){b.clear();b.append(c.data);a.isOpen()&&(b.setClasses(),b.highlightFirstItem())});
a.on("results:append",function(c){b.append(c.data);a.isOpen()&&b.setClasses()});a.on("query",function(c){b.hideMessages();b.showLoading(c)});a.on("select",function(){a.isOpen()&&(b.setClasses(),b.highlightFirstItem())});a.on("unselect",function(){a.isOpen()&&(b.setClasses(),b.highlightFirstItem())});a.on("open",function(){b.$results.attr("aria-expanded","true");b.$results.attr("aria-hidden","false");b.setClasses();b.ensureHighlightVisible()});a.on("close",function(){b.$results.attr("aria-expanded",
"false");b.$results.attr("aria-hidden","true");b.$results.removeAttr("aria-activedescendant")});a.on("results:toggle",function(){var c=b.getHighlightedResults();0!==c.length&&c.trigger("mouseup")});a.on("results:select",function(){var c=b.getHighlightedResults();if(0!==c.length){var a=c.data("data");"true"==c.attr("aria-selected")?b.trigger("close",{}):b.trigger("select",{data:a})}});a.on("results:previous",function(){var c=b.getHighlightedResults(),a=b.$results.find("[aria-selected]"),d=a.index(c);
if(0!==d){--d;0===c.length&&(d=0);a=a.eq(d);a.trigger("mouseenter");c=b.$results.offset().top;a=a.offset().top;var e=b.$results.scrollTop()+(a-c);0===d?b.$results.scrollTop(0):0>a-c&&b.$results.scrollTop(e)}});a.on("results:next",function(){var c=b.getHighlightedResults(),a=b.$results.find("[aria-selected]");c=a.index(c)+1;if(!(c>=a.length)){var d=a.eq(c);d.trigger("mouseenter");a=b.$results.offset().top+b.$results.outerHeight(!1);d=d.offset().top+d.outerHeight(!1);var e=b.$results.scrollTop()+d-
a;0===c?b.$results.scrollTop(0):d>a&&b.$results.scrollTop(e)}});a.on("results:focus",function(b){b.element.addClass("select2-results__option--highlighted")});a.on("results:message",function(c){b.displayMessage(c)});e.fn.mousewheel&&this.$results.on("mousewheel",function(c){var a=b.$results.scrollTop(),d=b.$results.get(0).scrollHeight-a+c.deltaY;a=0<c.deltaY&&0>=a-c.deltaY;d=0>c.deltaY&&d<=b.$results.height();a?(b.$results.scrollTop(0),c.preventDefault(),c.stopPropagation()):d&&(b.$results.scrollTop(b.$results.get(0).scrollHeight-
b.$results.height()),c.preventDefault(),c.stopPropagation())});this.$results.on("mouseup",".select2-results__option[aria-selected]",function(c){var a=e(this),d=a.data("data");if("true"===a.attr("aria-selected"))return void(b.options.get("multiple")?b.trigger("unselect",{originalEvent:c,data:d}):b.trigger("close",{}));b.trigger("select",{originalEvent:c,data:d})});this.$results.on("mouseenter",".select2-results__option[aria-selected]",function(c){c=e(this).data("data");b.getHighlightedResults().removeClass("select2-results__option--highlighted");
b.trigger("results:focus",{data:c,element:e(this)})})},d.prototype.getHighlightedResults=function(){return this.$results.find(".select2-results__option--highlighted")},d.prototype.destroy=function(){this.$results.remove()},d.prototype.ensureHighlightVisible=function(){var a=this.getHighlightedResults();if(0!==a.length){var c=this.$results.find("[aria-selected]").index(a),b=this.$results.offset().top,d=a.offset().top,e=this.$results.scrollTop()+(d-b);b=d-b;e-=2*a.outerHeight(!1);2>=c?this.$results.scrollTop(0):
(b>this.$results.outerHeight()||0>b)&&this.$results.scrollTop(e)}},d.prototype.template=function(a,c){var b=this.options.get("templateResult"),d=this.options.get("escapeMarkup");a=b(a,c);null==a?c.style.display="none":"string"==typeof a?c.innerHTML=d(a):e(c).append(a)},d}),h.define("select2/keys",[],function(){return{BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46}}),h.define("select2/selection/base",
["jquery","../utils","../keys"],function(e,f,d){function a(c,b){this.$element=c;this.options=b;a.__super__.constructor.call(this)}return f.Extend(a,f.Observable),a.prototype.render=function(){var c=e('<span class="select2-selection" role="combobox"  aria-haspopup="true" aria-expanded="false"></span>');return this._tabindex=0,null!=this.$element.data("old-tabindex")?this._tabindex=this.$element.data("old-tabindex"):null!=this.$element.attr("tabindex")&&(this._tabindex=this.$element.attr("tabindex")),
c.attr("title",this.$element.attr("title")),c.attr("tabindex",this._tabindex),this.$selection=c,c},a.prototype.bind=function(c,b){var a=this,e=(c.id,c.id+"-results");this.container=c;this.$selection.on("focus",function(b){a.trigger("focus",b)});this.$selection.on("blur",function(b){a._handleBlur(b)});this.$selection.on("keydown",function(b){a.trigger("keypress",b);b.which===d.SPACE&&b.preventDefault()});c.on("results:focus",function(b){a.$selection.attr("aria-activedescendant",b.data._resultId)});
c.on("selection:update",function(b){a.update(b.data)});c.on("open",function(){a.$selection.attr("aria-expanded","true");a.$selection.attr("aria-owns",e);a._attachCloseHandler(c)});c.on("close",function(){a.$selection.attr("aria-expanded","false");a.$selection.removeAttr("aria-activedescendant");a.$selection.removeAttr("aria-owns");a.$selection.focus();a._detachCloseHandler(c)});c.on("enable",function(){a.$selection.attr("tabindex",a._tabindex)});c.on("disable",function(){a.$selection.attr("tabindex",
"-1")})},a.prototype._handleBlur=function(c){var b=this;window.setTimeout(function(){document.activeElement==b.$selection[0]||e.contains(b.$selection[0],document.activeElement)||b.trigger("blur",c)},1)},a.prototype._attachCloseHandler=function(c){e(document.body).on("mousedown.select2."+c.id,function(b){var c=e(b.target).closest(".select2");e(".select2.select2-container--open").each(function(){var b=e(this);this!=c[0]&&b.data("element").select2("close")})})},a.prototype._detachCloseHandler=function(c){e(document.body).off("mousedown.select2."+
c.id)},a.prototype.position=function(c,b){b.find(".selection").append(c)},a.prototype.destroy=function(){this._detachCloseHandler(this.container)},a.prototype.update=function(c){throw Error("The `update` method must be defined in child classes.");},a}),h.define("select2/selection/single",["jquery","./base","../utils","../keys"],function(e,f,d,a){function c(){c.__super__.constructor.apply(this,arguments)}return d.Extend(c,f),c.prototype.render=function(){var b=c.__super__.render.call(this);return b.addClass("select2-selection--single"),
b.html('<span class="select2-selection__rendered"></span><span class="select2-selection__arrow" role="presentation"><b role="presentation"></b></span>'),b},c.prototype.bind=function(b,a){var d=this;c.__super__.bind.apply(this,arguments);var g=b.id+"-container";this.$selection.find(".select2-selection__rendered").attr("id",g);this.$selection.attr("aria-labelledby",g);this.$selection.on("mousedown",function(b){1===b.which&&d.trigger("toggle",{originalEvent:b})});this.$selection.on("focus",function(b){});
this.$selection.on("blur",function(b){});b.on("focus",function(c){b.isOpen()||d.$selection.focus()});b.on("selection:update",function(b){d.update(b.data)})},c.prototype.clear=function(){this.$selection.find(".select2-selection__rendered").empty()},c.prototype.display=function(b,c){var a=this.options.get("templateSelection");return this.options.get("escapeMarkup")(a(b,c))},c.prototype.selectionContainer=function(){return e("<span></span>")},c.prototype.update=function(b){if(0===b.length)return void this.clear();
b=b[0];var c=this.$selection.find(".select2-selection__rendered"),a=this.display(b,c);c.empty().append(a);c.prop("title",b.title||b.text)},c}),h.define("select2/selection/multiple",["jquery","./base","../utils"],function(e,f,d){function a(c,b){a.__super__.constructor.apply(this,arguments)}return d.Extend(a,f),a.prototype.render=function(){var c=a.__super__.render.call(this);return c.addClass("select2-selection--multiple"),c.html('<ul class="select2-selection__rendered"></ul>'),c},a.prototype.bind=
function(c,b){var d=this;a.__super__.bind.apply(this,arguments);this.$selection.on("click",function(b){d.trigger("toggle",{originalEvent:b})});this.$selection.on("click",".select2-selection__choice__remove",function(b){if(!d.options.get("disabled")){var c=e(this).parent().data("data");d.trigger("unselect",{originalEvent:b,data:c})}})},a.prototype.clear=function(){this.$selection.find(".select2-selection__rendered").empty()},a.prototype.display=function(c,b){var a=this.options.get("templateSelection");
return this.options.get("escapeMarkup")(a(c,b))},a.prototype.selectionContainer=function(){return e('<li class="select2-selection__choice"><span class="select2-selection__choice__remove" role="presentation">&times;</span></li>')},a.prototype.update=function(c){if(this.clear(),0!==c.length){for(var b=[],a=0;a<c.length;a++){var e=c[a],f=this.selectionContainer(),p=this.display(e,f);f.append(p);f.prop("title",e.title||e.text);f.data("data",e);b.push(f)}c=this.$selection.find(".select2-selection__rendered");
d.appendMany(c,b)}},a}),h.define("select2/selection/placeholder",["../utils"],function(e){function f(d,a,c){this.placeholder=this.normalizePlaceholder(c.get("placeholder"));d.call(this,a,c)}return f.prototype.normalizePlaceholder=function(d,a){return"string"==typeof a&&(a={id:"",text:a}),a},f.prototype.createPlaceholder=function(d,a){d=this.selectionContainer();return d.html(this.display(a)),d.addClass("select2-selection__placeholder").removeClass("select2-selection__choice"),d},f.prototype.update=
function(d,a){var c=1==a.length&&a[0].id!=this.placeholder.id;if(1<a.length||c)return d.call(this,a);this.clear();d=this.createPlaceholder(this.placeholder);this.$selection.find(".select2-selection__rendered").append(d)},f}),h.define("select2/selection/allowClear",["jquery","../keys"],function(e,f){function d(){}return d.prototype.bind=function(a,c,b){var d=this;a.call(this,c,b);null==this.placeholder&&this.options.get("debug")&&window.console&&console.error&&console.error("Select2: The `allowClear` option should be used in combination with the `placeholder` option.");
this.$selection.on("mousedown",".select2-selection__clear",function(b){d._handleClear(b)});c.on("keypress",function(b){d._handleKeyboardClear(b,c)})},d.prototype._handleClear=function(a,c){if(!this.options.get("disabled")&&(a=this.$selection.find(".select2-selection__clear"),0!==a.length)){c.stopPropagation();c=a.data("data");for(a=0;a<c.length;a++){var b={data:c[a]};if(this.trigger("unselect",b),b.prevented)return}this.$element.val(this.placeholder.id).trigger("change");this.trigger("toggle",{})}},
d.prototype._handleKeyboardClear=function(a,c,b){b.isOpen()||c.which!=f.DELETE&&c.which!=f.BACKSPACE||this._handleClear(c)},d.prototype.update=function(a,c){(a.call(this,c),0<this.$selection.find(".select2-selection__placeholder").length||0===c.length)||(a=e('<span class="select2-selection__clear">&times;</span>'),a.data("data",c),this.$selection.find(".select2-selection__rendered").prepend(a))},d}),h.define("select2/selection/search",["jquery","../utils","../keys"],function(e,f,d){function a(c,b,
a){c.call(this,b,a)}return a.prototype.render=function(c){var b=e('<li class="select2-search select2-search--inline"><input class="select2-search__field" type="search" tabindex="-1" autocomplete="off" autocorrect="off" autocapitalize="none" spellcheck="false" role="textbox" aria-autocomplete="list" /></li>');this.$searchContainer=b;this.$search=b.find("input");c=c.call(this);return this._transferTabIndex(),c},a.prototype.bind=function(c,b,a){var g=this;c.call(this,b,a);b.on("open",function(){g.$search.trigger("focus")});
b.on("close",function(){g.$search.val("");g.$search.removeAttr("aria-activedescendant");g.$search.trigger("focus")});b.on("enable",function(){g.$search.prop("disabled",!1);g._transferTabIndex()});b.on("disable",function(){g.$search.prop("disabled",!0)});b.on("focus",function(b){g.$search.trigger("focus")});b.on("results:focus",function(b){g.$search.attr("aria-activedescendant",b.id)});this.$selection.on("focusin",".select2-search--inline",function(b){g.trigger("focus",b)});this.$selection.on("focusout",
".select2-search--inline",function(b){g._handleBlur(b)});this.$selection.on("keydown",".select2-search--inline",function(b){if(b.stopPropagation(),g.trigger("keypress",b),g._keyUpPrevented=b.isDefaultPrevented(),b.which===d.BACKSPACE&&""===g.$search.val()){var c=g.$searchContainer.prev(".select2-selection__choice");0<c.length&&(c=c.data("data"),g.searchRemoveChoice(c),b.preventDefault())}});var e=(c=document.documentMode)&&11>=c;this.$selection.on("input.searchcheck",".select2-search--inline",function(b){if(e)return void g.$selection.off("input.search input.searchcheck");
g.$selection.off("keyup.search")});this.$selection.on("keyup.search input.search",".select2-search--inline",function(b){if(e&&"input"===b.type)return void g.$selection.off("input.search input.searchcheck");var c=b.which;c!=d.SHIFT&&c!=d.CTRL&&c!=d.ALT&&c!=d.TAB&&g.handleSearch(b)})},a.prototype._transferTabIndex=function(c){this.$search.attr("tabindex",this.$selection.attr("tabindex"));this.$selection.attr("tabindex","-1")},a.prototype.createPlaceholder=function(c,b){this.$search.attr("placeholder",
b.text)},a.prototype.update=function(c,b){var a=this.$search[0]==document.activeElement;this.$search.attr("placeholder","");c.call(this,b);this.$selection.find(".select2-selection__rendered").append(this.$searchContainer);this.resizeSearch();a&&this.$search.focus()},a.prototype.handleSearch=function(){if(this.resizeSearch(),!this._keyUpPrevented){var c=this.$search.val();this.trigger("query",{term:c})}this._keyUpPrevented=!1},a.prototype.searchRemoveChoice=function(c,b){this.trigger("unselect",{data:b});
this.$search.val(b.text);this.handleSearch()},a.prototype.resizeSearch=function(){this.$search.css("width","25px");var c=""!==this.$search.attr("placeholder")?this.$selection.find(".select2-selection__rendered").innerWidth():.75*(this.$search.val().length+1)+"em";this.$search.css("width",c)},a}),h.define("select2/selection/eventRelay",["jquery"],function(e){function f(){}return f.prototype.bind=function(d,a,c){var b=this,g="open opening close closing select selecting unselect unselecting".split(" "),
f=["opening","closing","selecting","unselecting"];d.call(this,a,c);a.on("*",function(c,a){if(-1!==e.inArray(c,g)){a=a||{};var d=e.Event("select2:"+c,{params:a});b.$element.trigger(d);-1!==e.inArray(c,f)&&(a.prevented=d.isDefaultPrevented())}})},f}),h.define("select2/translation",["jquery","require"],function(e,f){function d(a){this.dict=a||{}}return d.prototype.all=function(){return this.dict},d.prototype.get=function(a){return this.dict[a]},d.prototype.extend=function(a){this.dict=e.extend({},a.all(),
this.dict)},d._cache={},d.loadPath=function(a){if(!(a in d._cache)){var c=f(a);d._cache[a]=c}return new d(d._cache[a])},d}),h.define("select2/diacritics",[],function(){return{"\u24b6":"A","\uff21":"A","\u00c0":"A","\u00c1":"A","\u00c2":"A","\u1ea6":"A","\u1ea4":"A","\u1eaa":"A","\u1ea8":"A","\u00c3":"A","\u0100":"A","\u0102":"A","\u1eb0":"A","\u1eae":"A","\u1eb4":"A","\u1eb2":"A","\u0226":"A","\u01e0":"A","\u00c4":"A","\u01de":"A","\u1ea2":"A","\u00c5":"A","\u01fa":"A","\u01cd":"A","\u0200":"A","\u0202":"A",
"\u1ea0":"A","\u1eac":"A","\u1eb6":"A","\u1e00":"A","\u0104":"A","\u023a":"A","\u2c6f":"A","\ua732":"AA","\u00c6":"AE","\u01fc":"AE","\u01e2":"AE","\ua734":"AO","\ua736":"AU","\ua738":"AV","\ua73a":"AV","\ua73c":"AY","\u24b7":"B","\uff22":"B","\u1e02":"B","\u1e04":"B","\u1e06":"B","\u0243":"B","\u0182":"B","\u0181":"B","\u24b8":"C","\uff23":"C","\u0106":"C","\u0108":"C","\u010a":"C","\u010c":"C","\u00c7":"C","\u1e08":"C","\u0187":"C","\u023b":"C","\ua73e":"C","\u24b9":"D","\uff24":"D","\u1e0a":"D",
"\u010e":"D","\u1e0c":"D","\u1e10":"D","\u1e12":"D","\u1e0e":"D","\u0110":"D","\u018b":"D","\u018a":"D","\u0189":"D","\ua779":"D","\u01f1":"DZ","\u01c4":"DZ","\u01f2":"Dz","\u01c5":"Dz","\u24ba":"E","\uff25":"E","\u00c8":"E","\u00c9":"E","\u00ca":"E","\u1ec0":"E","\u1ebe":"E","\u1ec4":"E","\u1ec2":"E","\u1ebc":"E","\u0112":"E","\u1e14":"E","\u1e16":"E","\u0114":"E","\u0116":"E","\u00cb":"E","\u1eba":"E","\u011a":"E","\u0204":"E","\u0206":"E","\u1eb8":"E","\u1ec6":"E","\u0228":"E","\u1e1c":"E","\u0118":"E",
"\u1e18":"E","\u1e1a":"E","\u0190":"E","\u018e":"E","\u24bb":"F","\uff26":"F","\u1e1e":"F","\u0191":"F","\ua77b":"F","\u24bc":"G","\uff27":"G","\u01f4":"G","\u011c":"G","\u1e20":"G","\u011e":"G","\u0120":"G","\u01e6":"G","\u0122":"G","\u01e4":"G","\u0193":"G","\ua7a0":"G","\ua77d":"G","\ua77e":"G","\u24bd":"H","\uff28":"H","\u0124":"H","\u1e22":"H","\u1e26":"H","\u021e":"H","\u1e24":"H","\u1e28":"H","\u1e2a":"H","\u0126":"H","\u2c67":"H","\u2c75":"H","\ua78d":"H","\u24be":"I","\uff29":"I","\u00cc":"I",
"\u00cd":"I","\u00ce":"I","\u0128":"I","\u012a":"I","\u012c":"I","\u0130":"I","\u00cf":"I","\u1e2e":"I","\u1ec8":"I","\u01cf":"I","\u0208":"I","\u020a":"I","\u1eca":"I","\u012e":"I","\u1e2c":"I","\u0197":"I","\u24bf":"J","\uff2a":"J","\u0134":"J","\u0248":"J","\u24c0":"K","\uff2b":"K","\u1e30":"K","\u01e8":"K","\u1e32":"K","\u0136":"K","\u1e34":"K","\u0198":"K","\u2c69":"K","\ua740":"K","\ua742":"K","\ua744":"K","\ua7a2":"K","\u24c1":"L","\uff2c":"L","\u013f":"L","\u0139":"L","\u013d":"L","\u1e36":"L",
"\u1e38":"L","\u013b":"L","\u1e3c":"L","\u1e3a":"L","\u0141":"L","\u023d":"L","\u2c62":"L","\u2c60":"L","\ua748":"L","\ua746":"L","\ua780":"L","\u01c7":"LJ","\u01c8":"Lj","\u24c2":"M","\uff2d":"M","\u1e3e":"M","\u1e40":"M","\u1e42":"M","\u2c6e":"M","\u019c":"M","\u24c3":"N","\uff2e":"N","\u01f8":"N","\u0143":"N","\u00d1":"N","\u1e44":"N","\u0147":"N","\u1e46":"N","\u0145":"N","\u1e4a":"N","\u1e48":"N","\u0220":"N","\u019d":"N","\ua790":"N","\ua7a4":"N","\u01ca":"NJ","\u01cb":"Nj","\u24c4":"O","\uff2f":"O",
"\u00d2":"O","\u00d3":"O","\u00d4":"O","\u1ed2":"O","\u1ed0":"O","\u1ed6":"O","\u1ed4":"O","\u00d5":"O","\u1e4c":"O","\u022c":"O","\u1e4e":"O","\u014c":"O","\u1e50":"O","\u1e52":"O","\u014e":"O","\u022e":"O","\u0230":"O","\u00d6":"O","\u022a":"O","\u1ece":"O","\u0150":"O","\u01d1":"O","\u020c":"O","\u020e":"O","\u01a0":"O","\u1edc":"O","\u1eda":"O","\u1ee0":"O","\u1ede":"O","\u1ee2":"O","\u1ecc":"O","\u1ed8":"O","\u01ea":"O","\u01ec":"O","\u00d8":"O","\u01fe":"O","\u0186":"O","\u019f":"O","\ua74a":"O",
"\ua74c":"O","\u01a2":"OI","\ua74e":"OO","\u0222":"OU","\u24c5":"P","\uff30":"P","\u1e54":"P","\u1e56":"P","\u01a4":"P","\u2c63":"P","\ua750":"P","\ua752":"P","\ua754":"P","\u24c6":"Q","\uff31":"Q","\ua756":"Q","\ua758":"Q","\u024a":"Q","\u24c7":"R","\uff32":"R","\u0154":"R","\u1e58":"R","\u0158":"R","\u0210":"R","\u0212":"R","\u1e5a":"R","\u1e5c":"R","\u0156":"R","\u1e5e":"R","\u024c":"R","\u2c64":"R","\ua75a":"R","\ua7a6":"R","\ua782":"R","\u24c8":"S","\uff33":"S","\u1e9e":"S","\u015a":"S","\u1e64":"S",
"\u015c":"S","\u1e60":"S","\u0160":"S","\u1e66":"S","\u1e62":"S","\u1e68":"S","\u0218":"S","\u015e":"S","\u2c7e":"S","\ua7a8":"S","\ua784":"S","\u24c9":"T","\uff34":"T","\u1e6a":"T","\u0164":"T","\u1e6c":"T","\u021a":"T","\u0162":"T","\u1e70":"T","\u1e6e":"T","\u0166":"T","\u01ac":"T","\u01ae":"T","\u023e":"T","\ua786":"T","\ua728":"TZ","\u24ca":"U","\uff35":"U","\u00d9":"U","\u00da":"U","\u00db":"U","\u0168":"U","\u1e78":"U","\u016a":"U","\u1e7a":"U","\u016c":"U","\u00dc":"U","\u01db":"U","\u01d7":"U",
"\u01d5":"U","\u01d9":"U","\u1ee6":"U","\u016e":"U","\u0170":"U","\u01d3":"U","\u0214":"U","\u0216":"U","\u01af":"U","\u1eea":"U","\u1ee8":"U","\u1eee":"U","\u1eec":"U","\u1ef0":"U","\u1ee4":"U","\u1e72":"U","\u0172":"U","\u1e76":"U","\u1e74":"U","\u0244":"U","\u24cb":"V","\uff36":"V","\u1e7c":"V","\u1e7e":"V","\u01b2":"V","\ua75e":"V","\u0245":"V","\ua760":"VY","\u24cc":"W","\uff37":"W","\u1e80":"W","\u1e82":"W","\u0174":"W","\u1e86":"W","\u1e84":"W","\u1e88":"W","\u2c72":"W","\u24cd":"X","\uff38":"X",
"\u1e8a":"X","\u1e8c":"X","\u24ce":"Y","\uff39":"Y","\u1ef2":"Y","\u00dd":"Y","\u0176":"Y","\u1ef8":"Y","\u0232":"Y","\u1e8e":"Y","\u0178":"Y","\u1ef6":"Y","\u1ef4":"Y","\u01b3":"Y","\u024e":"Y","\u1efe":"Y","\u24cf":"Z","\uff3a":"Z","\u0179":"Z","\u1e90":"Z","\u017b":"Z","\u017d":"Z","\u1e92":"Z","\u1e94":"Z","\u01b5":"Z","\u0224":"Z","\u2c7f":"Z","\u2c6b":"Z","\ua762":"Z","\u24d0":"a","\uff41":"a","\u1e9a":"a","\u00e0":"a","\u00e1":"a","\u00e2":"a","\u1ea7":"a","\u1ea5":"a","\u1eab":"a","\u1ea9":"a",
"\u00e3":"a","\u0101":"a","\u0103":"a","\u1eb1":"a","\u1eaf":"a","\u1eb5":"a","\u1eb3":"a","\u0227":"a","\u01e1":"a","\u00e4":"a","\u01df":"a","\u1ea3":"a","\u00e5":"a","\u01fb":"a","\u01ce":"a","\u0201":"a","\u0203":"a","\u1ea1":"a","\u1ead":"a","\u1eb7":"a","\u1e01":"a","\u0105":"a","\u2c65":"a","\u0250":"a","\ua733":"aa","\u00e6":"ae","\u01fd":"ae","\u01e3":"ae","\ua735":"ao","\ua737":"au","\ua739":"av","\ua73b":"av","\ua73d":"ay","\u24d1":"b","\uff42":"b","\u1e03":"b","\u1e05":"b","\u1e07":"b",
"\u0180":"b","\u0183":"b","\u0253":"b","\u24d2":"c","\uff43":"c","\u0107":"c","\u0109":"c","\u010b":"c","\u010d":"c","\u00e7":"c","\u1e09":"c","\u0188":"c","\u023c":"c","\ua73f":"c","\u2184":"c","\u24d3":"d","\uff44":"d","\u1e0b":"d","\u010f":"d","\u1e0d":"d","\u1e11":"d","\u1e13":"d","\u1e0f":"d","\u0111":"d","\u018c":"d","\u0256":"d","\u0257":"d","\ua77a":"d","\u01f3":"dz","\u01c6":"dz","\u24d4":"e","\uff45":"e","\u00e8":"e","\u00e9":"e","\u00ea":"e","\u1ec1":"e","\u1ebf":"e","\u1ec5":"e","\u1ec3":"e",
"\u1ebd":"e","\u0113":"e","\u1e15":"e","\u1e17":"e","\u0115":"e","\u0117":"e","\u00eb":"e","\u1ebb":"e","\u011b":"e","\u0205":"e","\u0207":"e","\u1eb9":"e","\u1ec7":"e","\u0229":"e","\u1e1d":"e","\u0119":"e","\u1e19":"e","\u1e1b":"e","\u0247":"e","\u025b":"e","\u01dd":"e","\u24d5":"f","\uff46":"f","\u1e1f":"f","\u0192":"f","\ua77c":"f","\u24d6":"g","\uff47":"g","\u01f5":"g","\u011d":"g","\u1e21":"g","\u011f":"g","\u0121":"g","\u01e7":"g","\u0123":"g","\u01e5":"g","\u0260":"g","\ua7a1":"g","\u1d79":"g",
"\ua77f":"g","\u24d7":"h","\uff48":"h","\u0125":"h","\u1e23":"h","\u1e27":"h","\u021f":"h","\u1e25":"h","\u1e29":"h","\u1e2b":"h","\u1e96":"h","\u0127":"h","\u2c68":"h","\u2c76":"h","\u0265":"h","\u0195":"hv","\u24d8":"i","\uff49":"i","\u00ec":"i","\u00ed":"i","\u00ee":"i","\u0129":"i","\u012b":"i","\u012d":"i","\u00ef":"i","\u1e2f":"i","\u1ec9":"i","\u01d0":"i","\u0209":"i","\u020b":"i","\u1ecb":"i","\u012f":"i","\u1e2d":"i","\u0268":"i","\u0131":"i","\u24d9":"j","\uff4a":"j","\u0135":"j","\u01f0":"j",
"\u0249":"j","\u24da":"k","\uff4b":"k","\u1e31":"k","\u01e9":"k","\u1e33":"k","\u0137":"k","\u1e35":"k","\u0199":"k","\u2c6a":"k","\ua741":"k","\ua743":"k","\ua745":"k","\ua7a3":"k","\u24db":"l","\uff4c":"l","\u0140":"l","\u013a":"l","\u013e":"l","\u1e37":"l","\u1e39":"l","\u013c":"l","\u1e3d":"l","\u1e3b":"l","\u017f":"l","\u0142":"l","\u019a":"l","\u026b":"l","\u2c61":"l","\ua749":"l","\ua781":"l","\ua747":"l","\u01c9":"lj","\u24dc":"m","\uff4d":"m","\u1e3f":"m","\u1e41":"m","\u1e43":"m","\u0271":"m",
"\u026f":"m","\u24dd":"n","\uff4e":"n","\u01f9":"n","\u0144":"n","\u00f1":"n","\u1e45":"n","\u0148":"n","\u1e47":"n","\u0146":"n","\u1e4b":"n","\u1e49":"n","\u019e":"n","\u0272":"n","\u0149":"n","\ua791":"n","\ua7a5":"n","\u01cc":"nj","\u24de":"o","\uff4f":"o","\u00f2":"o","\u00f3":"o","\u00f4":"o","\u1ed3":"o","\u1ed1":"o","\u1ed7":"o","\u1ed5":"o","\u00f5":"o","\u1e4d":"o","\u022d":"o","\u1e4f":"o","\u014d":"o","\u1e51":"o","\u1e53":"o","\u014f":"o","\u022f":"o","\u0231":"o","\u00f6":"o","\u022b":"o",
"\u1ecf":"o","\u0151":"o","\u01d2":"o","\u020d":"o","\u020f":"o","\u01a1":"o","\u1edd":"o","\u1edb":"o","\u1ee1":"o","\u1edf":"o","\u1ee3":"o","\u1ecd":"o","\u1ed9":"o","\u01eb":"o","\u01ed":"o","\u00f8":"o","\u01ff":"o","\u0254":"o","\ua74b":"o","\ua74d":"o","\u0275":"o","\u01a3":"oi","\u0223":"ou","\ua74f":"oo","\u24df":"p","\uff50":"p","\u1e55":"p","\u1e57":"p","\u01a5":"p","\u1d7d":"p","\ua751":"p","\ua753":"p","\ua755":"p","\u24e0":"q","\uff51":"q","\u024b":"q","\ua757":"q","\ua759":"q","\u24e1":"r",
"\uff52":"r","\u0155":"r","\u1e59":"r","\u0159":"r","\u0211":"r","\u0213":"r","\u1e5b":"r","\u1e5d":"r","\u0157":"r","\u1e5f":"r","\u024d":"r","\u027d":"r","\ua75b":"r","\ua7a7":"r","\ua783":"r","\u24e2":"s","\uff53":"s","\u00df":"s","\u015b":"s","\u1e65":"s","\u015d":"s","\u1e61":"s","\u0161":"s","\u1e67":"s","\u1e63":"s","\u1e69":"s","\u0219":"s","\u015f":"s","\u023f":"s","\ua7a9":"s","\ua785":"s","\u1e9b":"s","\u24e3":"t","\uff54":"t","\u1e6b":"t","\u1e97":"t","\u0165":"t","\u1e6d":"t","\u021b":"t",
"\u0163":"t","\u1e71":"t","\u1e6f":"t","\u0167":"t","\u01ad":"t","\u0288":"t","\u2c66":"t","\ua787":"t","\ua729":"tz","\u24e4":"u","\uff55":"u","\u00f9":"u","\u00fa":"u","\u00fb":"u","\u0169":"u","\u1e79":"u","\u016b":"u","\u1e7b":"u","\u016d":"u","\u00fc":"u","\u01dc":"u","\u01d8":"u","\u01d6":"u","\u01da":"u","\u1ee7":"u","\u016f":"u","\u0171":"u","\u01d4":"u","\u0215":"u","\u0217":"u","\u01b0":"u","\u1eeb":"u","\u1ee9":"u","\u1eef":"u","\u1eed":"u","\u1ef1":"u","\u1ee5":"u","\u1e73":"u","\u0173":"u",
"\u1e77":"u","\u1e75":"u","\u0289":"u","\u24e5":"v","\uff56":"v","\u1e7d":"v","\u1e7f":"v","\u028b":"v","\ua75f":"v","\u028c":"v","\ua761":"vy","\u24e6":"w","\uff57":"w","\u1e81":"w","\u1e83":"w","\u0175":"w","\u1e87":"w","\u1e85":"w","\u1e98":"w","\u1e89":"w","\u2c73":"w","\u24e7":"x","\uff58":"x","\u1e8b":"x","\u1e8d":"x","\u24e8":"y","\uff59":"y","\u1ef3":"y","\u00fd":"y","\u0177":"y","\u1ef9":"y","\u0233":"y","\u1e8f":"y","\u00ff":"y","\u1ef7":"y","\u1e99":"y","\u1ef5":"y","\u01b4":"y","\u024f":"y",
"\u1eff":"y","\u24e9":"z","\uff5a":"z","\u017a":"z","\u1e91":"z","\u017c":"z","\u017e":"z","\u1e93":"z","\u1e95":"z","\u01b6":"z","\u0225":"z","\u0240":"z","\u2c6c":"z","\ua763":"z","\u0386":"\u0391","\u0388":"\u0395","\u0389":"\u0397","\u038a":"\u0399","\u03aa":"\u0399","\u038c":"\u039f","\u038e":"\u03a5","\u03ab":"\u03a5","\u038f":"\u03a9","\u03ac":"\u03b1","\u03ad":"\u03b5","\u03ae":"\u03b7","\u03af":"\u03b9","\u03ca":"\u03b9","\u0390":"\u03b9","\u03cc":"\u03bf","\u03cd":"\u03c5","\u03cb":"\u03c5",
"\u03b0":"\u03c5","\u03c9":"\u03c9","\u03c2":"\u03c3"}}),h.define("select2/data/base",["../utils"],function(e){function f(d,a){f.__super__.constructor.call(this)}return e.Extend(f,e.Observable),f.prototype.current=function(d){throw Error("The `current` method must be defined in child classes.");},f.prototype.query=function(d,a){throw Error("The `query` method must be defined in child classes.");},f.prototype.bind=function(d,a){},f.prototype.destroy=function(){},f.prototype.generateResultId=function(d,
a){d=d.id+"-result-";return d+=e.generateChars(4),null!=a.id?d+="-"+a.id.toString():d+="-"+e.generateChars(4),d},f}),h.define("select2/data/select",["./base","../utils","jquery"],function(e,f,d){function a(c,b){this.$element=c;this.options=b;a.__super__.constructor.call(this)}return f.Extend(a,e),a.prototype.current=function(c){var b=[],a=this;this.$element.find(":selected").each(function(){var c=d(this);c=a.item(c);b.push(c)});c(b)},a.prototype.select=function(c){var b=this;if(c.selected=!0,d(c.element).is("option"))return c.element.selected=
!0,void this.$element.trigger("change");this.$element.prop("multiple")?this.current(function(a){var g=[];c=[c];c.push.apply(c,a);for(a=0;a<c.length;a++){var e=c[a].id;-1===d.inArray(e,g)&&g.push(e)}b.$element.val(g);b.$element.trigger("change")}):(this.$element.val(c.id),this.$element.trigger("change"))},a.prototype.unselect=function(c){var b=this;if(this.$element.prop("multiple")){if(c.selected=!1,d(c.element).is("option"))return c.element.selected=!1,void this.$element.trigger("change");this.current(function(a){for(var g=
[],e=0;e<a.length;e++){var f=a[e].id;f!==c.id&&-1===d.inArray(f,g)&&g.push(f)}b.$element.val(g);b.$element.trigger("change")})}},a.prototype.bind=function(c,b){var a=this;this.container=c;c.on("select",function(b){a.select(b.data)});c.on("unselect",function(b){a.unselect(b.data)})},a.prototype.destroy=function(){this.$element.find("*").each(function(){d.removeData(this,"data")})},a.prototype.query=function(c,b){var a=[],e=this;this.$element.children().each(function(){var b=d(this);if(b.is("option")||
b.is("optgroup"))b=e.item(b),b=e.matches(c,b),null!==b&&a.push(b)});b({results:a})},a.prototype.addOptions=function(c){f.appendMany(this.$element,c)},a.prototype.option=function(c){var b;c.children?(b=document.createElement("optgroup"),b.label=c.text):(b=document.createElement("option"),void 0!==b.textContent?b.textContent=c.text:b.innerText=c.text);void 0!==c.id&&(b.value=c.id);c.disabled&&(b.disabled=!0);c.selected&&(b.selected=!0);c.title&&(b.title=c.title);var a=d(b);c=this._normalizeItem(c);
return c.element=b,d.data(b,"data",c),a},a.prototype.item=function(c){var b;if(null!=(b=d.data(c[0],"data")))return b;if(c.is("option"))b={id:c.val(),text:c.text(),disabled:c.prop("disabled"),selected:c.prop("selected"),title:c.prop("title")};else if(c.is("optgroup")){b={text:c.prop("label"),children:[],title:c.prop("title")};for(var a=c.children("option"),e=[],f=0;f<a.length;f++){var p=d(a[f]);p=this.item(p);e.push(p)}b.children=e}return b=this._normalizeItem(b),b.element=c[0],d.data(c[0],"data",
b),b},a.prototype._normalizeItem=function(a){d.isPlainObject(a)||(a={id:a,text:a});a=d.extend({},{text:""},a);return null!=a.id&&(a.id=a.id.toString()),null!=a.text&&(a.text=a.text.toString()),null==a._resultId&&a.id&&null!=this.container&&(a._resultId=this.generateResultId(this.container,a)),d.extend({},{selected:!1,disabled:!1},a)},a.prototype.matches=function(a,b){return this.options.get("matcher")(a,b)},a}),h.define("select2/data/array",["./select","../utils","jquery"],function(e,f,d){function a(c,
b){var d=b.get("data")||[];a.__super__.constructor.call(this,c,b);this.addOptions(this.convertToOptions(d))}return f.Extend(a,e),a.prototype.select=function(c){var b=this.$element.find("option").filter(function(b,a){return a.value==c.id.toString()});0===b.length&&(b=this.option(c),this.addOptions(b));a.__super__.select.call(this,c)},a.prototype.convertToOptions=function(a){function b(b){return function(){return d(this).val()==b.id}}for(var c=this,e=this.$element.find("option"),t=e.map(function(){return c.item(d(this)).id}).get(),
p=[],n=0;n<a.length;n++){var h=this._normalizeItem(a[n]);if(0<=d.inArray(h.id,t)){var l=e.filter(b(h)),q=this.item(l);h=d.extend(!0,{},h,q);h=this.option(h);l.replaceWith(h)}else l=this.option(h),h.children&&(h=this.convertToOptions(h.children),f.appendMany(l,h)),p.push(l)}return p},a}),h.define("select2/data/ajax",["./array","../utils","jquery"],function(e,f,d){function a(c,b){this.ajaxOptions=this._applyDefaults(b.get("ajax"));null!=this.ajaxOptions.processResults&&(this.processResults=this.ajaxOptions.processResults);
a.__super__.constructor.call(this,c,b)}return f.Extend(a,e),a.prototype._applyDefaults=function(a){return d.extend({},{data:function(b){return d.extend({},b,{q:b.term})},transport:function(b,a,c){b=d.ajax(b);return b.then(a),b.fail(c),b}},a,!0)},a.prototype.processResults=function(a){return a},a.prototype.query=function(a,b){function c(){var c=f.transport(f,function(c){c=e.processResults(c,a);e.options.get("debug")&&window.console&&console.error&&(c&&c.results&&d.isArray(c.results)||console.error("Select2: The AJAX results did not return an array in the `results` key of the response."));
b(c)},function(){c.status&&"0"===c.status||e.trigger("results:message",{message:"errorLoading"})});e._request=c}var e=this;null!=this._request&&(d.isFunction(this._request.abort)&&this._request.abort(),this._request=null);var f=d.extend({type:"GET"},this.ajaxOptions);"function"==typeof f.url&&(f.url=f.url.call(this.$element,a));"function"==typeof f.data&&(f.data=f.data.call(this.$element,a));this.ajaxOptions.delay&&null!=a.term?(this._queryTimeout&&window.clearTimeout(this._queryTimeout),this._queryTimeout=
window.setTimeout(c,this.ajaxOptions.delay)):c()},a}),h.define("select2/data/tags",["jquery"],function(e){function f(d,a,c){var b=c.get("tags"),g=c.get("createTag");void 0!==g&&(this.createTag=g);g=c.get("insertTag");if(void 0!==g&&(this.insertTag=g),d.call(this,a,c),e.isArray(b))for(d=0;d<b.length;d++)a=this._normalizeItem(b[d]),a=this.option(a),this.$element.append(a)}return f.prototype.query=function(d,a,c){function b(d,g){for(var f=d.results,m=0;m<f.length;m++){var h=f[m],t=null!=h.children&&
!b({results:h.children},!0);if((h.text||"").toUpperCase()===(a.term||"").toUpperCase()||t)return!g&&(d.data=f,void c(d))}if(g)return!0;g=e.createTag(a);null!=g&&(m=e.option(g),m.attr("data-select2-tag",!0),e.addOptions([m]),e.insertTag(f,g));d.results=f;c(d)}var e=this;if(this._removeOldTags(),null==a.term||null!=a.page)return void d.call(this,a,c);d.call(this,a,b)},f.prototype.createTag=function(d,a){d=e.trim(a.term);return""===d?null:{id:d,text:d}},f.prototype.insertTag=function(d,a,c){a.unshift(c)},
f.prototype._removeOldTags=function(d){this._lastTag;this.$element.find("option[data-select2-tag]").each(function(){this.selected||e(this).remove()})},f}),h.define("select2/data/tokenizer",["jquery"],function(e){function f(d,a,c){var b=c.get("tokenizer");void 0!==b&&(this.tokenizer=b);d.call(this,a,c)}return f.prototype.bind=function(d,a,c){d.call(this,a,c);this.$search=a.dropdown.$search||a.selection.$search||c.find(".select2-search__field")},f.prototype.query=function(d,a,c){var b=this;a.term=a.term||
"";var g=this.tokenizer(a,this.options,function(a){var c=b._normalizeItem(a);b.$element.find("option").filter(function(){return e(this).val()===c.id}).length||(a=b.option(c),a.attr("data-select2-tag",!0),b._removeOldTags(),b.addOptions([a]));b.trigger("select",{data:c})});g.term!==a.term&&(this.$search.length&&(this.$search.val(g.term),this.$search.focus()),a.term=g.term);d.call(this,a,c)},f.prototype.tokenizer=function(d,a,c,b){d=c.get("tokenSeparators")||[];c=a.term;for(var g=0,f=this.createTag||
function(b){return{id:b.term,text:b.term}};g<c.length;)if(-1!==e.inArray(c[g],d)){var h=c.substr(0,g);h=e.extend({},a,{term:h});h=f(h);null!=h?(b(h),c=c.substr(g+1)||"",g=0):g++}else g++;return{term:c}},f}),h.define("select2/data/minimumInputLength",[],function(){function e(e,d,a){this.minimumInputLength=a.get("minimumInputLength");e.call(this,d,a)}return e.prototype.query=function(e,d,a){if(d.term=d.term||"",d.term.length<this.minimumInputLength)return void this.trigger("results:message",{message:"inputTooShort",
args:{minimum:this.minimumInputLength,input:d.term,params:d}});e.call(this,d,a)},e}),h.define("select2/data/maximumInputLength",[],function(){function e(e,d,a){this.maximumInputLength=a.get("maximumInputLength");e.call(this,d,a)}return e.prototype.query=function(e,d,a){if(d.term=d.term||"",0<this.maximumInputLength&&d.term.length>this.maximumInputLength)return void this.trigger("results:message",{message:"inputTooLong",args:{maximum:this.maximumInputLength,input:d.term,params:d}});e.call(this,d,a)},
e}),h.define("select2/data/maximumSelectionLength",[],function(){function e(e,d,a){this.maximumSelectionLength=a.get("maximumSelectionLength");e.call(this,d,a)}return e.prototype.query=function(e,d,a){var c=this;this.current(function(b){b=null!=b?b.length:0;if(0<c.maximumSelectionLength&&b>=c.maximumSelectionLength)return void c.trigger("results:message",{message:"maximumSelected",args:{maximum:c.maximumSelectionLength}});e.call(c,d,a)})},e}),h.define("select2/dropdown",["jquery","./utils"],function(e,
f){function d(a,c){this.$element=a;this.options=c;d.__super__.constructor.call(this)}return f.Extend(d,f.Observable),d.prototype.render=function(){var a=e('<span class="select2-dropdown"><span class="select2-results"></span></span>');return a.attr("dir",this.options.get("dir")),this.$dropdown=a,a},d.prototype.bind=function(){},d.prototype.position=function(a,c){},d.prototype.destroy=function(){this.$dropdown.remove()},d}),h.define("select2/dropdown/search",["jquery","../utils"],function(e,f){function d(){}
return d.prototype.render=function(a){a=a.call(this);var c=e('<span class="select2-search select2-search--dropdown"><input class="select2-search__field" type="search" tabindex="-1" autocomplete="off" autocorrect="off" autocapitalize="none" spellcheck="false" role="textbox" /></span>');return this.$searchContainer=c,this.$search=c.find("input"),a.prepend(c),a},d.prototype.bind=function(a,c,b){var d=this;a.call(this,c,b);this.$search.on("keydown",function(b){d.trigger("keypress",b);d._keyUpPrevented=
b.isDefaultPrevented()});this.$search.on("input",function(b){e(this).off("keyup")});this.$search.on("keyup input",function(b){d.handleSearch(b)});c.on("open",function(){d.$search.attr("tabindex",0);d.$search.focus();window.setTimeout(function(){d.$search.focus()},0)});c.on("close",function(){d.$search.attr("tabindex",-1);d.$search.val("")});c.on("focus",function(){c.isOpen()||d.$search.focus()});c.on("results:all",function(b){if(null==b.query.term||""===b.query.term)d.showSearch(b)?d.$searchContainer.removeClass("select2-search--hide"):
d.$searchContainer.addClass("select2-search--hide")})},d.prototype.handleSearch=function(a){this._keyUpPrevented||(a=this.$search.val(),this.trigger("query",{term:a}));this._keyUpPrevented=!1},d.prototype.showSearch=function(a,c){return!0},d}),h.define("select2/dropdown/hidePlaceholder",[],function(){function e(e,d,a,c){this.placeholder=this.normalizePlaceholder(a.get("placeholder"));e.call(this,d,a,c)}return e.prototype.append=function(e,d){d.results=this.removePlaceholder(d.results);e.call(this,
d)},e.prototype.normalizePlaceholder=function(e,d){return"string"==typeof d&&(d={id:"",text:d}),d},e.prototype.removePlaceholder=function(e,d){e=d.slice(0);for(var a=d.length-1;0<=a;a--)this.placeholder.id===d[a].id&&e.splice(a,1);return e},e}),h.define("select2/dropdown/infiniteScroll",["jquery"],function(e){function f(d,a,c,b){this.lastParams={};d.call(this,a,c,b);this.$loadingMore=this.createLoadingMore();this.loading=!1}return f.prototype.append=function(d,a){this.$loadingMore.remove();this.loading=
!1;d.call(this,a);this.showLoadingMore(a)&&this.$results.append(this.$loadingMore)},f.prototype.bind=function(d,a,c){var b=this;d.call(this,a,c);a.on("query",function(a){b.lastParams=a;b.loading=!0});a.on("query:append",function(a){b.lastParams=a;b.loading=!0});this.$results.on("scroll",function(){var a=e.contains(document.documentElement,b.$loadingMore[0]);!b.loading&&a&&b.$results.offset().top+b.$results.outerHeight(!1)+50>=b.$loadingMore.offset().top+b.$loadingMore.outerHeight(!1)&&b.loadMore()})},
f.prototype.loadMore=function(){this.loading=!0;var d=e.extend({},{page:1},this.lastParams);d.page++;this.trigger("query:append",d)},f.prototype.showLoadingMore=function(d,a){return a.pagination&&a.pagination.more},f.prototype.createLoadingMore=function(){var d=e('<li class="select2-results__option select2-results__option--load-more"role="treeitem" aria-disabled="true"></li>'),a=this.options.get("translations").get("loadingMore");return d.html(a(this.lastParams)),d},f}),h.define("select2/dropdown/attachBody",
["jquery","../utils"],function(e,f){function d(a,c,b){this.$dropdownParent=b.get("dropdownParent")||e(document.body);a.call(this,c,b)}return d.prototype.bind=function(a,c,b){var d=this,e=!1;a.call(this,c,b);c.on("open",function(){d._showDropdown();d._attachPositioningHandler(c);e||(e=!0,c.on("results:all",function(){d._positionDropdown();d._resizeDropdown()}),c.on("results:append",function(){d._positionDropdown();d._resizeDropdown()}))});c.on("close",function(){d._hideDropdown();d._detachPositioningHandler(c)});
this.$dropdownContainer.on("mousedown",function(b){b.stopPropagation()})},d.prototype.destroy=function(a){a.call(this);this.$dropdownContainer.remove()},d.prototype.position=function(a,c,b){c.attr("class",b.attr("class"));c.removeClass("select2");c.addClass("select2-container--open");c.css({position:"absolute",top:-999999});this.$container=b},d.prototype.render=function(a){var c=e("<span></span>");a=a.call(this);return c.append(a),this.$dropdownContainer=c,c},d.prototype._hideDropdown=function(a){this.$dropdownContainer.detach()},
d.prototype._attachPositioningHandler=function(a,c){var b=this;a="scroll.select2."+c.id;var d="resize.select2."+c.id;c="orientationchange.select2."+c.id;var m=this.$container.parents().filter(f.hasScroll);m.each(function(){e(this).data("select2-scroll-position",{x:e(this).scrollLeft(),y:e(this).scrollTop()})});m.on(a,function(b){b=e(this).data("select2-scroll-position");e(this).scrollTop(b.y)});e(window).on(a+" "+d+" "+c,function(a){b._positionDropdown();b._resizeDropdown()})},d.prototype._detachPositioningHandler=
function(a,c){a="scroll.select2."+c.id;var b="resize.select2."+c.id;c="orientationchange.select2."+c.id;this.$container.parents().filter(f.hasScroll).off(a);e(window).off(a+" "+b+" "+c)},d.prototype._positionDropdown=function(){var a=e(window),c=this.$dropdown.hasClass("select2-dropdown--above"),b=this.$dropdown.hasClass("select2-dropdown--below"),d=null,f=this.$container.offset();f.bottom=f.top+this.$container.outerHeight(!1);var h=this.$container.outerHeight(!1);var p=f.top;var n=f.top+h;h=this.$dropdown.outerHeight(!1);
var l=a.scrollTop(),q=a.scrollTop()+a.height();a=l<f.top-h;l=q>f.bottom+h;f={left:f.left,top:n};n=this.$dropdownParent;"static"===n.css("position")&&(n=n.offsetParent());n=n.offset();f.top-=n.top;f.left-=n.left;c||b||(d="below");l||!a||c?!a&&l&&c&&(d="below"):d="above";("above"==d||c&&"below"!==d)&&(f.top=p-n.top-h);null!=d&&(this.$dropdown.removeClass("select2-dropdown--below select2-dropdown--above").addClass("select2-dropdown--"+d),this.$container.removeClass("select2-container--below select2-container--above").addClass("select2-container--"+
d));this.$dropdownContainer.css(f)},d.prototype._resizeDropdown=function(){var a={width:this.$container.outerWidth(!1)+"px"};this.options.get("dropdownAutoWidth")&&(a.minWidth=a.width,a.position="relative",a.width="auto");this.$dropdown.css(a)},d.prototype._showDropdown=function(a){this.$dropdownContainer.appendTo(this.$dropdownParent);this._positionDropdown();this._resizeDropdown()},d}),h.define("select2/dropdown/minimumResultsForSearch",[],function(){function e(d){for(var a=0,c=0;c<d.length;c++){var b=
d[c];b.children?a+=e(b.children):a++}return a}function f(d,a,c,b){this.minimumResultsForSearch=c.get("minimumResultsForSearch");0>this.minimumResultsForSearch&&(this.minimumResultsForSearch=1/0);d.call(this,a,c,b)}return f.prototype.showSearch=function(d,a){return!(e(a.data.results)<this.minimumResultsForSearch)&&d.call(this,a)},f}),h.define("select2/dropdown/selectOnClose",[],function(){function e(){}return e.prototype.bind=function(e,d,a){var c=this;e.call(this,d,a);d.on("close",function(b){c._handleSelectOnClose(b)})},
e.prototype._handleSelectOnClose=function(e,d){if(d&&null!=d.originalSelect2Event&&(e=d.originalSelect2Event,"select"===e._type||"unselect"===e._type))return;e=this.getHighlightedResults();1>e.length||(e=e.data("data"),null!=e.element&&e.element.selected||null==e.element&&e.selected||this.trigger("select",{data:e}))},e}),h.define("select2/dropdown/closeOnSelect",[],function(){function e(){}return e.prototype.bind=function(e,d,a){var c=this;e.call(this,d,a);d.on("select",function(b){c._selectTriggered(b)});
d.on("unselect",function(b){c._selectTriggered(b)})},e.prototype._selectTriggered=function(e,d){(e=d.originalEvent)&&e.ctrlKey||this.trigger("close",{originalEvent:e,originalSelect2Event:d})},e}),h.define("select2/i18n/en",[],function(){if("ua"==cabinetLanguage){var e=function(a,c,b,d){return 10<a%100&&15>a%100?d:1===a%10?c:1<a%10&&5>a%10?b:d};return{errorLoading:function(){return"\u041d\u0435\u043c\u043e\u0436\u043b\u0438\u0432\u043e \u0437\u0430\u0432\u0430\u043d\u0442\u0430\u0436\u0438\u0442\u0438 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0438"},
inputTooLong:function(a){return"\u0411\u0443\u0434\u044c \u043b\u0430\u0441\u043a\u0430, \u0432\u0438\u0434\u0430\u043b\u0456\u0442\u044c "+(a.input.length-a.maximum)+" "+e(a.maximum,"\u043b\u0456\u0442\u0435\u0440\u0443","\u043b\u0456\u0442\u0435\u0440\u0438","\u043b\u0456\u0442\u0435\u0440")},inputTooShort:function(a){return"\u0411\u0443\u0434\u044c \u043b\u0430\u0441\u043a\u0430, \u0432\u0432\u0435\u0434\u0456\u0442\u044c "+(a.minimum-a.input.length)+" \u0430\u0431\u043e \u0431\u0456\u043b\u044c\u0448\u0435 \u043b\u0456\u0442\u0435\u0440"},
loadingMore:function(){return"\u0417\u0430\u0432\u0430\u043d\u0442\u0430\u0436\u0435\u043d\u043d\u044f \u0456\u043d\u0448\u0438\u0445 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0456\u0432\u2026"},maximumSelected:function(a){return"\u0412\u0438 \u043c\u043e\u0436\u0435\u0442\u0435 \u0432\u0438\u0431\u0440\u0430\u0442\u0438 \u043b\u0438\u0448\u0435 "+a.maximum+" "+e(a.maximum,"\u043f\u0443\u043d\u043a\u0442","\u043f\u0443\u043d\u043a\u0442\u0438","\u043f\u0443\u043d\u043a\u0442\u0456\u0432")},
noResults:function(){return"\u041d\u0456\u0447\u043e\u0433\u043e \u043d\u0435 \u0437\u043d\u0430\u0439\u0434\u0435\u043d\u043e"},searching:function(){return"\u041f\u043e\u0448\u0443\u043a\u2026"}}}if("en"==cabinetLanguage)return{errorLoading:function(){return"The results could not be loaded."},inputTooLong:function(a){a=a.input.length-a.maximum;var c="Please delete "+a+" character";1!=a&&(c+="s");return c},inputTooShort:function(a){return"Please enter "+(a.minimum-a.input.length)+" or more characters"},
loadingMore:function(){return"Loading more results\u2026"},maximumSelected:function(a){var c="You can only select "+a.maximum+" item";1!=a.maximum&&(c+="s");return c},noResults:function(){return"No results found"},searching:function(){return"Searching\u2026"}};if("ru"==cabinetLanguage){var f=function(a,c,b,d){if(5>a%10&&0<a%10&&5>a%100||20<a%100){if(1<a%10)return b}else return d;return c};return{errorLoading:function(){return"\u041d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b"},
inputTooLong:function(a){a=a.input.length-a.maximum;a="\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u0430 "+a+" \u0441\u0438\u043c\u0432\u043e\u043b"+f(a,"","a","\u043e\u0432");return a+" \u043c\u0435\u043d\u044c\u0448\u0435"},inputTooShort:function(a){a=a.minimum-a.input.length;return"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u0435\u0449\u0435 \u0445\u043e\u0442\u044f \u0431\u044b "+
a+" \u0441\u0438\u043c\u0432\u043e\u043b"+f(a,"","a","\u043e\u0432")},loadingMore:function(){return"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0434\u0430\u043d\u043d\u044b\u0445\u2026"},maximumSelected:function(a){var c="\u0412\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u0432\u044b\u0431\u0440\u0430\u0442\u044c \u043d\u0435 \u0431\u043e\u043b\u0435\u0435 "+a.maximum+" \u044d\u043b\u0435\u043c\u0435\u043d\u0442";return c+=f(a.maximum,"","a","\u043e\u0432")},noResults:function(){return"\u0421\u043e\u0432\u043f\u0430\u0434\u0435\u043d\u0438\u0439 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e"},
searching:function(){return"\u041f\u043e\u0438\u0441\u043a\u2026"}}}if("lt"==cabinetLanguage){var d=function(a,c,b,d){return 1===a%10&&(11>a%100||19<a%100)?c:2<=a%10&&9>=a%10&&(11>a%100||19<a%100)?b:d};return{inputTooLong:function(a){a=a.input.length-a.maximum;return"Pa\u0161alinkite "+a+" simbol"+d(a,"\u012f","ius","i\u0173")},inputTooShort:function(a){a=a.minimum-a.input.length;return"\u012era\u0161ykite dar "+a+" simbol"+d(a,"\u012f","ius","i\u0173")},loadingMore:function(){return"Kraunama daugiau rezultat\u0173\u2026"},
maximumSelected:function(a){var c="J\u016bs galite pasirinkti tik "+a.maximum+" element";return c+=d(a.maximum,"\u0105","us","\u0173")},noResults:function(){return"Atitikmen\u0173 nerasta"},searching:function(){return"Ie\u0161koma\u2026"}}}}),h.define("select2/defaults","jquery require ./results ./selection/single ./selection/multiple ./selection/placeholder ./selection/allowClear ./selection/search ./selection/eventRelay ./utils ./translation ./diacritics ./data/select ./data/array ./data/ajax ./data/tags ./data/tokenizer ./data/minimumInputLength ./data/maximumInputLength ./data/maximumSelectionLength ./dropdown ./dropdown/search ./dropdown/hidePlaceholder ./dropdown/infiniteScroll ./dropdown/attachBody ./dropdown/minimumResultsForSearch ./dropdown/selectOnClose ./dropdown/closeOnSelect ./i18n/en".split(" "),
function(e,f,d,a,c,b,g,h,l,p,n,v,q,r,u,A,M,E,D,w,x,B,y,G,H,I,J,K,L){function m(){this.reset()}return m.prototype.apply=function(k){if(k=e.extend(!0,{},this.defaults,k),null==k.dataAdapter){if(null!=k.ajax?k.dataAdapter=u:null!=k.data?k.dataAdapter=r:k.dataAdapter=q,0<k.minimumInputLength&&(k.dataAdapter=p.Decorate(k.dataAdapter,E)),0<k.maximumInputLength&&(k.dataAdapter=p.Decorate(k.dataAdapter,D)),0<k.maximumSelectionLength&&(k.dataAdapter=p.Decorate(k.dataAdapter,w)),k.tags&&(k.dataAdapter=p.Decorate(k.dataAdapter,
A)),null==k.tokenSeparators&&null==k.tokenizer||(k.dataAdapter=p.Decorate(k.dataAdapter,M)),null!=k.query){var m=f(k.amdBase+"compat/query");k.dataAdapter=p.Decorate(k.dataAdapter,m)}null!=k.initSelection&&(m=f(k.amdBase+"compat/initSelection"),k.dataAdapter=p.Decorate(k.dataAdapter,m))}if(null==k.resultsAdapter&&(k.resultsAdapter=d,null!=k.ajax&&(k.resultsAdapter=p.Decorate(k.resultsAdapter,G)),null!=k.placeholder&&(k.resultsAdapter=p.Decorate(k.resultsAdapter,y)),k.selectOnClose&&(k.resultsAdapter=
p.Decorate(k.resultsAdapter,J))),null==k.dropdownAdapter){k.multiple?k.dropdownAdapter=x:(m=p.Decorate(x,B),k.dropdownAdapter=m);if(0!==k.minimumResultsForSearch&&(k.dropdownAdapter=p.Decorate(k.dropdownAdapter,I)),k.closeOnSelect&&(k.dropdownAdapter=p.Decorate(k.dropdownAdapter,K)),null!=k.dropdownCssClass||null!=k.dropdownCss||null!=k.adaptDropdownCssClass)m=f(k.amdBase+"compat/dropdownCss"),k.dropdownAdapter=p.Decorate(k.dropdownAdapter,m);k.dropdownAdapter=p.Decorate(k.dropdownAdapter,H)}if(null==
k.selectionAdapter){if(k.multiple?k.selectionAdapter=c:k.selectionAdapter=a,null!=k.placeholder&&(k.selectionAdapter=p.Decorate(k.selectionAdapter,b)),k.allowClear&&(k.selectionAdapter=p.Decorate(k.selectionAdapter,g)),k.multiple&&(k.selectionAdapter=p.Decorate(k.selectionAdapter,h)),null!=k.containerCssClass||null!=k.containerCss||null!=k.adaptContainerCssClass)m=f(k.amdBase+"compat/containerCss"),k.selectionAdapter=p.Decorate(k.selectionAdapter,m);k.selectionAdapter=p.Decorate(k.selectionAdapter,
l)}"string"==typeof k.language&&(0<k.language.indexOf("-")?(m=k.language.split("-")[0],k.language=[k.language,m]):k.language=[k.language]);if(e.isArray(k.language)){m=new n;k.language.push("en");for(var t=k.language,v=0;v<t.length;v++){var z=t[v],F={};try{F=n.loadPath(z)}catch(N){try{z=this.defaults.amdLanguageBase+z,F=n.loadPath(z)}catch(O){k.debug&&window.console&&console.warn&&console.warn('Select2: The language file for "'+z+'" could not be automatically loaded. A fallback will be used instead.');
continue}}m.extend(F)}k.translations=m}else m=n.loadPath(this.defaults.amdLanguageBase+"en"),t=new n(k.language),t.extend(m),k.translations=t;return k},m.prototype.reset=function(){function b(b){return b.replace(/[^\u0000-\u007E]/g,function(b){return v[b]||b})}function a(c,d){if(""===e.trim(c.term))return d;if(d.children&&0<d.children.length){for(var g=e.extend(!0,{},d),f=d.children.length-1;0<=f;f--)null==a(c,d.children[f])&&g.children.splice(f,1);return 0<g.children.length?g:a(c,g)}g=b(d.text).toUpperCase();
c=b(c.term).toUpperCase();return-1<g.indexOf(c)?d:null}this.defaults={amdBase:"./",amdLanguageBase:"./i18n/",closeOnSelect:!0,debug:!1,dropdownAutoWidth:!1,escapeMarkup:p.escapeMarkup,language:L,matcher:a,minimumInputLength:0,maximumInputLength:0,maximumSelectionLength:0,minimumResultsForSearch:0,selectOnClose:!1,sorter:function(b){return b},templateResult:function(b){return b.text},templateSelection:function(b){return b.text},theme:"default",width:"resolve"}},m.prototype.set=function(b,a){b=e.camelCase(b);
var c={};c[b]=a;a=p._convertData(c);e.extend(this.defaults,a)},new m}),h.define("select2/options",["require","jquery","./defaults","./utils"],function(e,f,d,a){function c(b,c){if(this.options=b,null!=c&&this.fromElement(c),this.options=d.apply(this.options),c&&c.is("input"))b=e(this.get("amdBase")+"compat/inputData"),this.options.dataAdapter=a.Decorate(this.options.dataAdapter,b)}return c.prototype.fromElement=function(b){var c=["select2"];null==this.options.multiple&&(this.options.multiple=b.prop("multiple"));
null==this.options.disabled&&(this.options.disabled=b.prop("disabled"));null==this.options.language&&(b.prop("lang")?this.options.language=b.prop("lang").toLowerCase():b.closest("[lang]").prop("lang")&&(this.options.language=b.closest("[lang]").prop("lang")));null==this.options.dir&&(b.prop("dir")?this.options.dir=b.prop("dir"):b.closest("[dir]").prop("dir")?this.options.dir=b.closest("[dir]").prop("dir"):this.options.dir="ltr");b.prop("disabled",this.options.disabled);b.prop("multiple",this.options.multiple);
b.data("select2Tags")&&(this.options.debug&&window.console&&console.warn&&console.warn('Select2: The `data-select2-tags` attribute has been changed to use the `data-data` and `data-tags="true"` attributes and will be removed in future versions of Select2.'),b.data("data",b.data("select2Tags")),b.data("tags",!0));b.data("ajaxUrl")&&(this.options.debug&&window.console&&console.warn&&console.warn("Select2: The `data-ajax-url` attribute has been changed to `data-ajax--url` and support for the old attribute will be removed in future versions of Select2."),
b.attr("ajax--url",b.data("ajaxUrl")),b.data("ajax--url",b.data("ajaxUrl")));b=f.fn.jquery&&"1."==f.fn.jquery.substr(0,2)&&b[0].dataset?f.extend(!0,{},b[0].dataset,b.data()):b.data();b=f.extend(!0,{},b);b=a._convertData(b);for(var d in b)-1<f.inArray(d,c)||(f.isPlainObject(this.options[d])?f.extend(this.options[d],b[d]):this.options[d]=b[d]);return this},c.prototype.get=function(b){return this.options[b]},c.prototype.set=function(b,a){this.options[b]=a},c}),h.define("select2/core",["jquery","./options",
"./utils","./keys"],function(e,f,d,a){var c=function(b,a){null!=b.data("select2")&&b.data("select2").destroy();this.$element=b;this.id=this._generateId(b);a=a||{};this.options=new f(a,b);c.__super__.constructor.call(this);a=b.attr("tabindex")||0;b.data("old-tabindex",a);b.attr("tabindex","-1");this.dataAdapter=new (this.options.get("dataAdapter"))(b,this.options);a=this.render();this._placeContainer(a);this.selection=new (this.options.get("selectionAdapter"))(b,this.options);this.$selection=this.selection.render();
this.selection.position(this.$selection,a);this.dropdown=new (this.options.get("dropdownAdapter"))(b,this.options);this.$dropdown=this.dropdown.render();this.dropdown.position(this.$dropdown,a);this.results=new (this.options.get("resultsAdapter"))(b,this.options,this.dataAdapter);this.$results=this.results.render();this.results.position(this.$results,this.$dropdown);var d=this;this._bindAdapters();this._registerDomEvents();this._registerDataEvents();this._registerSelectionEvents();this._registerDropdownEvents();
this._registerResultsEvents();this._registerEvents();this.dataAdapter.current(function(b){d.trigger("selection:update",{data:b})});b.addClass("select2-hidden-accessible");b.attr("aria-hidden","true");this._syncAttributes();b.data("select2",this)};return d.Extend(c,d.Observable),c.prototype._generateId=function(b){var a="";return a=null!=b.attr("id")?b.attr("id"):null!=b.attr("name")?b.attr("name")+"-"+d.generateChars(2):d.generateChars(4),a=a.replace(/(:|\.|\[|\]|,)/g,""),"select2-"+a},c.prototype._placeContainer=
function(b){b.insertAfter(this.$element);var a=this._resolveWidth(this.$element,this.options.get("width"));null!=a&&b.css("width",a)},c.prototype._resolveWidth=function(b,a){var c=/^width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i;if("resolve"==a)return c=this._resolveWidth(b,"style"),null!=c?c:this._resolveWidth(b,"element");if("element"==a)return c=b.outerWidth(!1),0>=c?"auto":c+"px";if("style"==a){b=b.attr("style");if("string"!=typeof b)return null;b=b.split(";");a=0;for(var d=b.length;a<
d;a+=1){var e=b[a].replace(/\s/g,"").match(c);if(null!==e&&1<=e.length)return e[1]}return null}return a},c.prototype._bindAdapters=function(){this.dataAdapter.bind(this,this.$container);this.selection.bind(this,this.$container);this.dropdown.bind(this,this.$container);this.results.bind(this,this.$container)},c.prototype._registerDomEvents=function(){var b=this;this.$element.on("change.select2",function(){b.dataAdapter.current(function(a){b.trigger("selection:update",{data:a})})});this.$element.on("focus.select2",
function(a){b.trigger("focus",a)});this._syncA=d.bind(this._syncAttributes,this);this._syncS=d.bind(this._syncSubtree,this);this.$element[0].attachEvent&&this.$element[0].attachEvent("onpropertychange",this._syncA);var a=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;null!=a?(this._observer=new a(function(a){e.each(a,b._syncA);e.each(a,b._syncS)}),this._observer.observe(this.$element[0],{attributes:!0,childList:!0,subtree:!1})):this.$element[0].addEventListener&&
(this.$element[0].addEventListener("DOMAttrModified",b._syncA,!1),this.$element[0].addEventListener("DOMNodeInserted",b._syncS,!1),this.$element[0].addEventListener("DOMNodeRemoved",b._syncS,!1))},c.prototype._registerDataEvents=function(){var a=this;this.dataAdapter.on("*",function(b,c){a.trigger(b,c)})},c.prototype._registerSelectionEvents=function(){var a=this,c=["toggle","focus"];this.selection.on("toggle",function(){a.toggleDropdown()});this.selection.on("focus",function(b){a.focus(b)});this.selection.on("*",
function(b,d){-1===e.inArray(b,c)&&a.trigger(b,d)})},c.prototype._registerDropdownEvents=function(){var a=this;this.dropdown.on("*",function(b,c){a.trigger(b,c)})},c.prototype._registerResultsEvents=function(){var a=this;this.results.on("*",function(b,c){a.trigger(b,c)})},c.prototype._registerEvents=function(){var b=this;this.on("open",function(){b.$container.addClass("select2-container--open")});this.on("close",function(){b.$container.removeClass("select2-container--open")});this.on("enable",function(){b.$container.removeClass("select2-container--disabled")});
this.on("disable",function(){b.$container.addClass("select2-container--disabled")});this.on("blur",function(){b.$container.removeClass("select2-container--focus")});this.on("query",function(a){b.isOpen()||b.trigger("open",{});this.dataAdapter.query(a,function(c){b.trigger("results:all",{data:c,query:a})})});this.on("query:append",function(a){this.dataAdapter.query(a,function(c){b.trigger("results:append",{data:c,query:a})})});this.on("keypress",function(c){var d=c.which;b.isOpen()?d===a.ESC||d===
a.TAB||d===a.UP&&c.altKey?(b.close(),c.preventDefault()):d===a.ENTER?(b.trigger("results:select",{}),c.preventDefault()):d===a.SPACE&&c.ctrlKey?(b.trigger("results:toggle",{}),c.preventDefault()):d===a.UP?(b.trigger("results:previous",{}),c.preventDefault()):d===a.DOWN&&(b.trigger("results:next",{}),c.preventDefault()):(d===a.ENTER||d===a.SPACE||d===a.DOWN&&c.altKey)&&(b.open(),c.preventDefault())})},c.prototype._syncAttributes=function(){this.options.set("disabled",this.$element.prop("disabled"));
this.options.get("disabled")?(this.isOpen()&&this.close(),this.trigger("disable",{})):this.trigger("enable",{})},c.prototype._syncSubtree=function(a,c){var b=!1,d=this;if(!a||!a.target||"OPTION"===a.target.nodeName||"OPTGROUP"===a.target.nodeName){if(c)if(c.addedNodes&&0<c.addedNodes.length)for(a=0;a<c.addedNodes.length;a++)c.addedNodes[a].selected&&(b=!0);else c.removedNodes&&0<c.removedNodes.length&&(b=!0);else b=!0;b&&this.dataAdapter.current(function(a){d.trigger("selection:update",{data:a})})}},
c.prototype.trigger=function(a,d){var b=c.__super__.trigger,e={open:"opening",close:"closing",select:"selecting",unselect:"unselecting"};if(void 0===d&&(d={}),a in e){var f={prevented:!1,name:a,args:d};if(b.call(this,e[a],f),f.prevented)return void(d.prevented=!0)}b.call(this,a,d)},c.prototype.toggleDropdown=function(){this.options.get("disabled")||(this.isOpen()?this.close():this.open())},c.prototype.open=function(){this.isOpen()||this.trigger("query",{})},c.prototype.close=function(){this.isOpen()&&
this.trigger("close",{})},c.prototype.isOpen=function(){return this.$container.hasClass("select2-container--open")},c.prototype.hasFocus=function(){return this.$container.hasClass("select2-container--focus")},c.prototype.focus=function(a){this.hasFocus()||(this.$container.addClass("select2-container--focus"),this.trigger("focus",{}))},c.prototype.enable=function(a){this.options.get("debug")&&window.console&&console.warn&&console.warn('Select2: The `select2("enable")` method has been deprecated and will be removed in later Select2 versions. Use $element.prop("disabled") instead.');
null!=a&&0!==a.length||(a=[!0]);this.$element.prop("disabled",!a[0])},c.prototype.data=function(){this.options.get("debug")&&0<arguments.length&&window.console&&console.warn&&console.warn('Select2: Data can no longer be set using `select2("data")`. You should consider setting the value instead using `$element.val()`.');var a=[];return this.dataAdapter.current(function(b){a=b}),a},c.prototype.val=function(a){if(this.options.get("debug")&&window.console&&console.warn&&console.warn('Select2: The `select2("val")` method has been deprecated and will be removed in later Select2 versions. Use $element.val() instead.'),
null==a||0===a.length)return this.$element.val();a=a[0];e.isArray(a)&&(a=e.map(a,function(a){return a.toString()}));this.$element.val(a).trigger("change")},c.prototype.destroy=function(){this.$container.remove();this.$element[0].detachEvent&&this.$element[0].detachEvent("onpropertychange",this._syncA);null!=this._observer?(this._observer.disconnect(),this._observer=null):this.$element[0].removeEventListener&&(this.$element[0].removeEventListener("DOMAttrModified",this._syncA,!1),this.$element[0].removeEventListener("DOMNodeInserted",
this._syncS,!1),this.$element[0].removeEventListener("DOMNodeRemoved",this._syncS,!1));this._syncS=this._syncA=null;this.$element.off(".select2");this.$element.attr("tabindex",this.$element.data("old-tabindex"));this.$element.removeClass("select2-hidden-accessible");this.$element.attr("aria-hidden","false");this.$element.removeData("select2");this.dataAdapter.destroy();this.selection.destroy();this.dropdown.destroy();this.results.destroy();this.results=this.dropdown=this.selection=this.dataAdapter=
null},c.prototype.render=function(){var a=e('<span class="select2 select2-container"><span class="selection"></span><span class="dropdown-wrapper" aria-hidden="true"></span></span>');return a.attr("dir",this.options.get("dir")),this.$container=a,this.$container.addClass("select2-container--"+this.options.get("theme")),a.data("element",this.$element),a},c}),h.define("select2/compat/utils",["jquery"],function(e){return{syncCssClasses:function(f,d,a){var c,b,g=[];(c=e.trim(f.attr("class")))&&(c=""+c,
e(c.split(/\s+/)).each(function(){0===this.indexOf("select2-")&&g.push(this)}));(c=e.trim(d.attr("class")))&&(c=""+c,e(c.split(/\s+/)).each(function(){0!==this.indexOf("select2-")&&null!=(b=a(this))&&g.push(b)}));f.attr("class",g.join(" "))}}}),h.define("select2/compat/containerCss",["jquery","./utils"],function(e,f){function d(a){return null}function a(){}return a.prototype.render=function(a){a=a.call(this);var b=this.options.get("containerCssClass")||"";e.isFunction(b)&&(b=b(this.$element));var c=
this.options.get("adaptContainerCssClass");if(c=c||d,-1!==b.indexOf(":all:")){b=b.replace(":all:","");var h=c;c=function(a){var b=h(a);return null!=b?b+" "+a:a}}var l=this.options.get("containerCss")||{};return e.isFunction(l)&&(l=l(this.$element)),f.syncCssClasses(a,this.$element,c),a.css(l),a.addClass(b),a},a}),h.define("select2/compat/dropdownCss",["jquery","./utils"],function(e,f){function d(a){return null}function a(){}return a.prototype.render=function(a){a=a.call(this);var b=this.options.get("dropdownCssClass")||
"";e.isFunction(b)&&(b=b(this.$element));var c=this.options.get("adaptDropdownCssClass");if(c=c||d,-1!==b.indexOf(":all:")){b=b.replace(":all:","");var h=c;c=function(a){var b=h(a);return null!=b?b+" "+a:a}}var l=this.options.get("dropdownCss")||{};return e.isFunction(l)&&(l=l(this.$element)),f.syncCssClasses(a,this.$element,c),a.css(l),a.addClass(b),a},a}),h.define("select2/compat/initSelection",["jquery"],function(e){function f(d,a,c){c.get("debug")&&window.console&&console.warn&&console.warn("Select2: The `initSelection` option has been deprecated in favor of a custom data adapter that overrides the `current` method. This method is now called multiple times instead of a single time when the instance is initialized. Support will be removed for the `initSelection` option in future versions of Select2");
this.initSelection=c.get("initSelection");this._isInitialized=!1;d.call(this,a,c)}return f.prototype.current=function(d,a){var c=this;if(this._isInitialized)return void d.call(this,a);this.initSelection.call(null,this.$element,function(b){c._isInitialized=!0;e.isArray(b)||(b=[b]);a(b)})},f}),h.define("select2/compat/inputData",["jquery"],function(e){function f(d,a,c){this._currentData=[];this._valueSeparator=c.get("valueSeparator")||",";"hidden"===a.prop("type")&&c.get("debug")&&console&&console.warn&&
console.warn("Select2: Using a hidden input with Select2 is no longer supported and may stop working in the future. It is recommended to use a `<select>` element instead.");d.call(this,a,c)}return f.prototype.current=function(d,a){function c(a,b){var d=[];return a.selected||-1!==e.inArray(a.id,b)?(a.selected=!0,d.push(a)):a.selected=!1,a.children&&d.push.apply(d,c(a.children,b)),d}d=[];for(var b=0;b<this._currentData.length;b++)d.push.apply(d,c(this._currentData[b],this.$element.val().split(this._valueSeparator)));
a(d)},f.prototype.select=function(d,a){this.options.get("multiple")?(d=this.$element.val(),d+=this._valueSeparator+a.id,this.$element.val(d)):(this.current(function(a){e.map(a,function(a){a.selected=!1})}),this.$element.val(a.id));this.$element.trigger("change")},f.prototype.unselect=function(d,a){var c=this;a.selected=!1;this.current(function(b){for(var d=[],e=0;e<b.length;e++){var f=b[e];a.id!=f.id&&d.push(f.id)}c.$element.val(d.join(c._valueSeparator));c.$element.trigger("change")})},f.prototype.query=
function(d,a,c){d=[];for(var b=0;b<this._currentData.length;b++){var e=this.matches(a,this._currentData[b]);null!==e&&d.push(e)}c({results:d})},f.prototype.addOptions=function(d,a){d=e.map(a,function(a){return e.data(a[0],"data")});this._currentData.push.apply(this._currentData,d)},f}),h.define("select2/compat/matcher",["jquery"],function(e){return function(f){return function(d,a){var c=e.extend(!0,{},a);if(null==d.term||""===e.trim(d.term))return c;if(a.children){for(var b=a.children.length-1;0<=
b;b--){var g=a.children[b];f(d.term,g.text,g)||c.children.splice(b,1)}if(0<c.children.length)return c}return f(d.term,a.text,a)?c:null}}}),h.define("select2/compat/query",[],function(){function e(e,d,a){a.get("debug")&&window.console&&console.warn&&console.warn("Select2: The `query` option has been deprecated in favor of a custom data adapter that overrides the `query` method. Support will be removed for the `query` option in future versions of Select2.");e.call(this,d,a)}return e.prototype.query=
function(e,d,a){d.callback=a;this.options.get("query").call(null,d)},e}),h.define("select2/dropdown/attachContainer",[],function(){function e(e,d,a){e.call(this,d,a)}return e.prototype.position=function(e,d,a){a.find(".dropdown-wrapper").append(d);d.addClass("select2-dropdown--below");a.addClass("select2-container--below")},e}),h.define("select2/dropdown/stopPropagation",[],function(){function e(){}return e.prototype.bind=function(e,d,a){e.call(this,d,a);this.$dropdown.on("blur change click dblclick focus focusin focusout input keydown keyup keypress mousedown mouseenter mouseleave mousemove mouseover mouseup search touchend touchstart",
function(a){a.stopPropagation()})},e}),h.define("select2/selection/stopPropagation",[],function(){function e(){}return e.prototype.bind=function(e,d,a){e.call(this,d,a);this.$selection.on("blur change click dblclick focus focusin focusout input keydown keyup keypress mousedown mouseenter mouseleave mousemove mouseover mouseup search touchend touchstart",function(a){a.stopPropagation()})},e}),function(e){"function"==typeof h.define&&h.define.amd?h.define("jquery-mousewheel",["jquery"],e):"object"==
typeof exports?module.exports=e:e(l)}(function(e){function f(b){var f=b||window.event,g=h.call(arguments,1),l,n=0,m=0,q=0,r=0,t=0;if(b=e.event.fix(f),b.type="mousewheel","detail"in f&&(m=-1*f.detail),"wheelDelta"in f&&(m=f.wheelDelta),"wheelDeltaY"in f&&(m=f.wheelDeltaY),"wheelDeltaX"in f&&(n=-1*f.wheelDeltaX),"axis"in f&&f.axis===f.HORIZONTAL_AXIS&&(n=-1*m,m=0),l=0===m?n:m,"deltaY"in f&&(m=-1*f.deltaY,l=m),"deltaX"in f&&(n=f.deltaX,0===m&&(l=-1*n)),0!==m||0!==n){if(1===f.deltaMode){var w=e.data(this,
"mousewheel-line-height");l*=w;m*=w;n*=w}else 2===f.deltaMode&&(w=e.data(this,"mousewheel-page-height"),l*=w,m*=w,n*=w);if(q=Math.max(Math.abs(m),Math.abs(n)),(!c||q<c)&&(c=q,p.settings.adjustOldDeltas&&"mousewheel"===f.type&&0==q%120&&(c/=40)),p.settings.adjustOldDeltas&&"mousewheel"===f.type&&0==q%120&&(l/=40,n/=40,m/=40),l=Math[1<=l?"floor":"ceil"](l/c),n=Math[1<=n?"floor":"ceil"](n/c),m=Math[1<=m?"floor":"ceil"](m/c),p.settings.normalizeOffset&&this.getBoundingClientRect)f=this.getBoundingClientRect(),
r=b.clientX-f.left,t=b.clientY-f.top;return b.deltaX=n,b.deltaY=m,b.deltaFactor=c,b.offsetX=r,b.offsetY=t,b.deltaMode=0,g.unshift(b,l,n,m),a&&clearTimeout(a),a=setTimeout(d,200),(e.event.dispatch||e.event.handle).apply(this,g)}}function d(){c=null}var a,c,b=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],g="onwheel"in document||9<=document.documentMode?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],h=Array.prototype.slice;if(e.event.fixHooks)for(var l=b.length;l;)e.event.fixHooks[b[--l]]=
e.event.mouseHooks;var p=e.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var a=g.length;a;)this.addEventListener(g[--a],f,!1);else this.onmousewheel=f;e.data(this,"mousewheel-line-height",p.getLineHeight(this));e.data(this,"mousewheel-page-height",p.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var a=g.length;a;)this.removeEventListener(g[--a],f,!1);else this.onmousewheel=null;e.removeData(this,"mousewheel-line-height");e.removeData(this,
"mousewheel-page-height")},getLineHeight:function(a){a=e(a);var b=a["offsetParent"in e.fn?"offsetParent":"parent"]();return b.length||(b=e("body")),parseInt(b.css("fontSize"),10)||parseInt(a.css("fontSize"),10)||16},getPageHeight:function(a){return e(a).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};e.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})}),h.define("jquery.select2",
["jquery","jquery-mousewheel","./select2/core","./select2/defaults"],function(e,f,d,a){if(null==e.fn.select2){var c=["open","close","destroy"];e.fn.select2=function(a){if("object"==typeof(a=a||{}))return this.each(function(){var b=e.extend(!0,{},a);new d(e(this),b)}),this;if("string"==typeof a){var b,f=Array.prototype.slice.call(arguments,1);return this.each(function(){var c=e(this).data("select2");null==c&&window.console&&console.error&&console.error("The select2('"+a+"') method was called on an element that is not using Select2.");
b=c[a].apply(c,f)}),-1<e.inArray(a,c)?this:b}throw Error("Invalid arguments for Select2: "+a);}}return null==e.fn.select2.defaults&&(e.fn.select2.defaults=a),d}),{define:h.define,require:h.require}}(),q=r.require("jquery.select2");return l.fn.select2.amd=r,q});
;
$.fn.select2.defaults.set("theme","bootstrap");
function formatCustomItemInSelect(a){if(a.loading)return a.text;var b=0<a.highlight,c=a.text;a.selectableGroup&&(c='<strong style="line-height: 1.1; margin-top: 9px; font-size: 16px; font-weight: 500;">'+a.text+"</strong>");return"<div class='select2-result-custom clearfix "+(b?"inactive":"")+"'><div class='select2-result-custom__avatar'>"+("undefined"!=typeof a.avatar&&a.avatar.length?"<img src='"+a.avatar+"'>":"")+"</div><div class='select2-result-custom__meta'><div class='select2-result-custom__title'>"+c+
"</div></div></div>"}function formatCustomStockItemInSelect(a){return a.loading?a.text:"<div class='select2-result-custom clearfix'><div class='select2-result-custom__avatar'>"+("undefined"!=typeof a.photo&&a.photo.length?"<img src='"+a.photo+"'>":"")+"</div><div class='select2-result-custom__meta'><div class='select2-result-custom__title'>"+a.text+"</div></div></div>"}
function formatCustomSelectedItem(a){if(parseInt(a.id)||a.selectableGroup){var b=$(a.element).attr("data-avatar");"undefined"==typeof b&&(b=a.avatar);var c=a.text;a.selectableGroup&&(c="<strong style='line-height: 2.3; margin-top: 9px; font-weight: 500;'>"+c+"</strong>");return("undefined"!=typeof b?"<img class='select2SelectedAvatar' src='"+b+"'>":"")+"<span class='select2SelectedText'>"+c+"</span>"}return""}
function formatCustomSelectedItemWithNonEmptyNullOption(a){var b=$(a.element).attr("data-avatar");"undefined"==typeof b&&(b=a.avatar);return("undefined"!=typeof b?"<img class='select2SelectedAvatar' src='"+b+"'>":"")+"<span class='select2SelectedText'>"+a.text+"</span>"}function formatColoredItemInSelect(a){return a.loading?a.text:"<div class='select2-result-colored clearfix' style='background-color:"+$(a.element).attr("data-bgColor")+";'>"+a.text+"</div>"}
function formatCustomStockSelectedItem(a){if(parseInt(a.id)){var b=$(a.element).attr("data-photo");"undefined"==typeof b&&(b=a.photo);return("undefined"!=typeof b?"<img class='select2SelectedAvatar' src='"+b+"'>":"")+"<span class='select2SelectedText'>"+a.text+"</span>"}return""}function formatColoredSelectedItem(a){return parseInt(a.id)?"<span class='select2SelectedColored' style='background-color:"+a.element.dataset.bgcolor+";'>"+a.text+"</span>":""};
;
$("body").on("click","#scheduleFilterMobileIcon",function(event){if(currentClinicMemberHasAccess(ACCESS_SCHEDULE_CLINIC_WORK_TIME))$(".scheduleSettingsLink").show();else $(".scheduleSettingsLink").hide();$("#scheduleFilterModal").modal("show")});$("body").on("click","#saveScheduleFiltersBtn",function(event){calendar.set_filters();$("#scheduleFilterModal").modal("hide")});
$("body").on("click","#scheduleFilterModalRestoreDefaults",function(event){$(".cheduleSearchForm_cabitet:not(:checked)").click();$("#scheduleSearchForm_clinicMemberId").val(-1);$("#scheduleSearchForm_clinicMemberId").trigger("change");$("#scheduleSearchForm_countDays").val($(".cheduleSearchForm_cabitet").length>3?1:5);$("#scheduleSearchForm_countDays").trigger("change");$("#saveScheduleFiltersBtn").trigger("click")});;
var calendarPreselectedPatientId=false;$("body").on("click",".editScheduleVisitButton",function(event){loadScheduleVisitFormFromServerAndShow({scheduleVisitId:$(this).attr("data-scheduleVisitId")})});
function loadScheduleVisitFormFromServerAndShow(data){ajax({url:"/cabinet/schedule-visits/get-form",data:{scheduleVisitId:typeof data.scheduleVisitId!="undefined"?data.scheduleVisitId:0},success:function(response){if(typeof response.formHtml!="undefined"){calendarPreselectedPatientId=false;$("#visitModal").html(response.formHtml);$("#visitModal").modal("show");if(!isMobileDevice)$("#visitForm_note").focusToEnd()}}})}
function showAssistantForm(data){var data=typeof data!="undefined"?data:false;var scheduleAssistantId=typeof data.scheduleAssistantId!="undefined"?data.scheduleAssistantId:0;if(typeof data.clinicMemberId=="undefined")data["clinicMemberId"]=currentClinicMemberId;if(typeof data.cabinetId=="undefined")data["cabinetId"]=0;if(typeof data.date=="undefined")data["date"]=moment().format("YYYY-MM-DD");if(typeof data.timeStart=="undefined")data["timeStart"]="09:00";if(typeof data.timeEnd=="undefined")data["timeEnd"]=
    "10:00";if(typeof data.status=="undefined")data["status"]=1;$("#visitAssistantForm .deleteScheduleAssistant").hide();if(scheduleAssistantId&&currentClinicMemberHasAccess(ACCESS_SCHEDULE_ASSISTANT_SHIFTS_EDITING))$("#visitAssistantForm .deleteScheduleAssistant").show().attr("data-scheduleAssistantId",scheduleAssistantId);if(!currentClinicMemberHasAccess(ACCESS_SCHEDULE_ASSISTANT_SHIFTS_EDITING)){$(".disbaledVisitModalDoctorAvatar").attr("src",calendar.options.doctors[data.clinicMemberId].img);$(".disbaledVisitModalDoctorName").html(calendar.options.doctors[data.clinicMemberId].name);
    $(".disbaledVisitModalCabinet").html(calendar.options.cabinets[data.cabinetId].name);$(".disbaledVisitModalDateAndTime").html(calendar.options.days[data.date.replace(/-/g,"")].title+" "+data.timeStart+" - "+data.timeEnd);$("#visitAssistantModal").modal("show");return}$("#visitAssistantForm_scheduleAssistantId").val(scheduleAssistantId);$("#visitAssistantForm_refresh_location").val(data&&typeof data.refresh_location!="undefined"?data.refresh_location:1);$("#visitAssistantForm_cabinetId").val(data.cabinetId).trigger("change");
    $("#hourRateForShift").val(data.rate).trigger("change");$("#visitAssistantForm_clinicMemberId").val(data.clinicMemberId).trigger("change");$("#visitAssistantForm_date").data("DateTimePicker").date(moment(data.date));clock.setTimeString($("#visitAssistantForm_timeStart"),data.timeStart);clock.setTimeString($("#visitAssistantForm_timeEnd"),data.timeEnd);$("#visitAssistantForm_status").val(data.status).trigger("change");$("#visitAssistantForm_authorsBlock").html(editedText).hide();if(typeof calendar.options.assistantSchedule[data.scheduleAssistantId]!=
        "undefined"){var date_created=calendar.options.assistantSchedule[data.scheduleAssistantId].date_created;var date_edited=calendar.options.assistantSchedule[data.scheduleAssistantId].date_edited;var creator=calendar.options.doctors[calendar.options.assistantSchedule[data.scheduleAssistantId].creator_id].name;if(typeof date_edited!="undefined"){var editor=calendar.options.doctors[calendar.options.assistantSchedule[data.scheduleAssistantId].editor_id].name;var edited=true}else var edited=false;if(edited)var editedText=
        "<table><tr><td>"+T["Created"]+":</td><td>"+date_created+"</td><td>"+creator+"</td></tr><tr><td> "+T["Edited"]+": </td><td>"+date_edited+"</td><td>"+editor+"</td></tr></table>";else var editedText="<table><tr><td>"+T["Created"]+":</td><td>"+date_created+"</td><td>"+creator+"</td></tr></table>";$("#visitAssistantForm_authorsBlock").html(editedText).show()}if(typeof data.event=="undefined")$("#visitAssistantModal").modal("show");else if(isMobileDevice){calendar.needRefreshOnCloseModal=true;$("#visitAssistantModal").modal("show")}else $("#visitAssistantForm").submit()}
function showAdministratorForm(data){var data=typeof data!="undefined"?data:false;var scheduleAdministratorId=typeof data.scheduleAdministratorId!="undefined"?data.scheduleAdministratorId:0;if(typeof data.clinicMemberId=="undefined")data["clinicMemberId"]=currentClinicMemberId;if(typeof data.cabinetId=="undefined")data["cabinetId"]=0;if(typeof data.date=="undefined")data["date"]=moment().format("YYYY-MM-DD");if(typeof data.timeStart=="undefined")data["timeStart"]="09:00";if(typeof data.timeEnd=="undefined")data["timeEnd"]=
    "10:00";if(typeof data.status=="undefined")data["status"]=1;$("#visitAdministratorForm .deleteScheduleAdministrator").hide();if(scheduleAdministratorId&&currentClinicMemberHasAccess(ACCESS_SCHEDULE_ADMINISTRATOR_SHIFTS_EDITING))$("#visitAdministratorForm .deleteScheduleAdministrator").show().attr("data-scheduleAdministratorId",scheduleAdministratorId);if(!currentClinicMemberHasAccess(ACCESS_SCHEDULE_ADMINISTRATOR_SHIFTS_EDITING)){$(".disbaledVisitModalDoctorAvatar").attr("src",calendar.options.doctors[data.clinicMemberId].img);
    $(".disbaledVisitModalDoctorName").html(calendar.options.doctors[data.clinicMemberId].name);$(".disbaledVisitModalCabinet").html(calendar.options.cabinets[data.cabinetId].name);$(".disbaledVisitModalDateAndTime").html(calendar.options.days[data.date.replace(/-/g,"")].title+" "+data.timeStart+" - "+data.timeEnd);$("#visitAdministratorModal").modal("show");return}$("#visitAdministratorForm_scheduleAdministratorId").val(scheduleAdministratorId);$("#visitAdministratorForm_refresh_location").val(data&&
typeof data.refresh_location!="undefined"?data.refresh_location:1);$("#visitAdministratorForm_cabinetId").val(data.cabinetId).trigger("change");$("#hourRateForShift").val(data.rate).trigger("change");$("#visitAdministratorForm_clinicMemberId").val(data.clinicMemberId).trigger("change");$("#visitAdministratorForm_date").data("DateTimePicker").date(moment(data.date));clock.setTimeString($("#visitAdministratorForm_timeStart"),data.timeStart);clock.setTimeString($("#visitAdministratorForm_timeEnd"),data.timeEnd);
    $("#visitAdministratorForm_status").val(data.status).trigger("change");$("#visitAdministratorForm_authorsBlock").html(editedText).hide();if(typeof calendar.options.assistantSchedule[data.scheduleAdministratorId]!="undefined"){var date_created=calendar.options.assistantSchedule[data.scheduleAdministratorId].date_created;var date_edited=calendar.options.assistantSchedule[data.scheduleAdministratorId].date_edited;var creator=calendar.options.doctors[calendar.options.assistantSchedule[data.scheduleAdministratorId].creator_id].name;
        if(typeof date_edited!="undefined"){var editor=calendar.options.doctors[calendar.options.assistantSchedule[data.scheduleAdministratorId].editor_id].name;var edited=true}else var edited=false;if(edited)var editedText="<table><tr><td>"+T["Created"]+":</td><td>"+date_created+"</td><td>"+creator+"</td></tr><tr><td> "+T["Edited"]+": </td><td>"+date_edited+"</td><td>"+editor+"</td></tr></table>";else var editedText="<table><tr><td>"+T["Created"]+":</td><td>"+date_created+"</td><td>"+creator+"</td></tr></table>";
        $("#visitAdministratorForm_authorsBlock").html(editedText).show()}if(typeof data.event=="undefined")$("#visitAdministratorModal").modal("show");else if(isMobileDevice){calendar.needRefreshOnCloseModal=true;$("#visitAdministratorModal").modal("show")}else $("#visitAdministratorForm").submit()}
function showVisitForm(data){var data=typeof data!="undefined"?data:false;var patientId=typeof data.patientId!="undefined"?data.patientId:calendarPreselectedPatientId?calendarPreselectedPatientId:0;var scheduleVisitId=typeof data.scheduleVisitId!="undefined"?data.scheduleVisitId:0;if(typeof data.clinicMemberId=="undefined")data["clinicMemberId"]=currentClinicMemberId;if(typeof data.cabinetId=="undefined")data["cabinetId"]=0;if(typeof data.date=="undefined")data["date"]=moment().format("YYYY-MM-DD");
    if(typeof data.timeStart=="undefined")data["timeStart"]="09:00";if(typeof data.timeEnd=="undefined")data["timeEnd"]="10:00";if(typeof data.status=="undefined")data["status"]=1;if(typeof data.note=="undefined")data.note="";if(typeof data.visit_image=="undefined")data.visit_image=0;if(typeof data.visit_image2=="undefined")data.visit_image2=0;$("#visitForm .deleteScheduleVisit").hide();if(scheduleVisitId&&currentClinicMemberHasAccess(ACCESS_SCHEDULE_VISITS_EDITING))$("#visitForm .deleteScheduleVisit").show().attr("data-scheduleVisitId",
        scheduleVisitId);if(!currentClinicMemberHasAccess(ACCESS_SCHEDULE_VISITS_EDITING)){if(patientId==0)return;$(".disbaledVisitModalPatientAvatar").attr("src",calendar.options.patients[patientId].img);$(".disbaledVisitModalPatientName").html(calendar.options.patients[patientId].name);$(".disbaledVisitModalDoctorAvatar").attr("src",calendar.options.doctors[data.clinicMemberId].img);$(".disbaledVisitModalDoctorName").html(calendar.options.doctors[data.clinicMemberId].name);$(".disbaledVisitModalCabinet").html(calendar.options.cabinets[data.cabinetId].name);
        $(".disbaledVisitModalDateAndTime").html(calendar.options.days[data.date.replace(/-/g,"")].title+" "+data.timeStart+" - "+data.timeEnd);$(".disbaledVisitModalComment").html(data.note);if(data.note.length)$(".disbaledVisitModalCommentFormGroup").show();else $(".disbaledVisitModalCommentFormGroup").hide();$(".disbaledVisitModalPatientLink").attr("href","#patients/stages/"+patientId);$("#visitModal").modal("show");return}$("#visitForm_patientId").text("");$("#visitForm_patientId").select2({width:null,
        minimumInputLength:0,ajax:{url:"/cabinet/select-values/patients/0",dataType:"json",delay:100,data:function(params){return{q:params.term}},cache:false},placeholder:"Search",escapeMarkup:function(markup){return markup},templateResult:formatCustomItemInSelect,templateSelection:formatCustomSelectedItem,dropdownCssClass:"patientsSelect2DropdownCssClass",disabled:patientId>0&&!calendarPreselectedPatientId});if(patientId){var newOption=new Option(calendar.options.patients[patientId].name,patientId,false,
        true);$("#visitForm_patientId").append(newOption);newOption.setAttribute("data-avatar",calendar.options.patients[patientId].img);$("#visitForm_patientId").trigger("change");$("#visitFormNePatientButtonTd").hide()}else{$("#visitForm_patientId").val(null).trigger("change");$("#visitFormNePatientButtonTd").show()}if(calendarPreselectedPatientId&&calendarPreselectedAnnotationtId)$("#visitForm_annotationId").val(calendarPreselectedAnnotationtId);else $("#visitForm_annotationId").val("");calendarPreselectedPatientId=
        false;calendarPreselectedAnnotationtId=false;$("#visitForm_scheduleVisitId").val(scheduleVisitId);$("#visitForm_refresh_location").val(data&&typeof data.refresh_location!="undefined"?data.refresh_location:1);$("#visitForm_cabinetId").val(data.cabinetId).trigger("change");$("#visitForm_clinicMemberId").val(data.clinicMemberId).trigger("change");$("#visitForm_date").data("DateTimePicker").date(moment(data.date));clock.setTimeString($("#visitForm_timeStart"),data.timeStart);clock.setTimeString($("#visitForm_timeEnd"),
        data.timeEnd);$("#visitForm_status").val(data.status).trigger("change");$("#visitForm_note").val(data.note);$("#visitForm_visit_image_button").attr("src","/c/_img/schedule-images/"+data.visit_image+".png?"+visitImagesVersion);$("#visitForm_visit_image_button2").attr("src","/c/_img/schedule-images/"+data.visit_image2+".png?"+visitImagesVersion);$("#visitForm_visit_image").val(data.visit_image);$("#visitForm_visit_image2").val(data.visit_image2);if(!data.visit_image)$(".visitImageSelectContainer.visitImageSelectContainerWrap2").hide();
    else $(".visitImageSelectContainer.visitImageSelectContainerWrap2").show();$("#visitForm_authorsBlock").html(editedText).hide();if(patientId&&typeof calendar.options.clientVisits[data.scheduleVisitId]!="undefined"){var date_created=calendar.options.clientVisits[data.scheduleVisitId].date_created;var date_edited=calendar.options.clientVisits[data.scheduleVisitId].date_edited;var creator=calendar.options.doctors[calendar.options.clientVisits[data.scheduleVisitId].creator_id].name;if(typeof date_edited!=
        "undefined"){var editor=calendar.options.doctors[calendar.options.clientVisits[data.scheduleVisitId].editor_id].name;var edited=true}else var edited=false;if(edited)var editedText="<table><tr><td>"+T["Created"]+":</td><td>"+date_created+"</td><td>"+creator+"</td></tr><tr><td> "+T["Edited"]+": </td><td>"+date_edited+"</td><td>"+editor+"</td></tr></table>";else var editedText="<table><tr><td>"+T["Created"]+":</td><td>"+date_created+"</td><td>"+creator+"</td></tr></table>";$("#visitForm_authorsBlock").html(editedText).show()}if(isMobileDevice&&
        $(window).width()<710&&scheduleVisitId&&location.hash=="#schedule"){var html="";html+='<a href="#schedule-visits/list/'+patientId+'" class="clickable">'+T["Visits"]+"</a>";if(currentClinicUsesPlans&&currentClinicMemberHasAccess(ACCESS_PLANS))html+='<a href="#plans/'+(calendar.options.patients[patientId]["main_plans_id"]?"plan/"+calendar.options.patients[patientId]["main_plans_id"]:"list/"+patientId)+'" class="clickable">'+T["Plans"]+"</a>";html+='<a href="#patients/stages/'+patientId+'" class="clickable">'+
        T["History"]+"</a>";if(currentClinicMemberHasAccess(ACCESS_FINANCE))if(0&&currentCabinetUserId==7)html+='<a href="#'+(currentClinicFinanceModel==CLINIC_FINANCE_MODEL_STANDARD?"invoices":"patients-payments")+"/list/"+patientId+'" class="clickable">'+T["Finance"]+"</a>";else html+='<a href="#'+(currentClinicFinanceModel==CLINIC_FINANCE_MODEL_STANDARD?"plan-items":"patients-payments")+"/list/"+patientId+'" class="clickable">'+T["Finance"]+"</a>";$(".scheduleVisitModalPatientLinks").html(html).show()}else $(".scheduleVisitModalPatientLinks").hide();
    if(typeof data.event=="undefined"){$("#visitModal").modal("show");if(!isMobileDevice&&patientId!=0)$("#visitForm_note").focusToEnd()}else if(isMobileDevice||typeof showConfirmDialogAfterVisitMovement!="undefined"&&showConfirmDialogAfterVisitMovement){calendar.needRefreshOnCloseModal=true;$("#visitModal").modal("show")}else $("#visitForm").submit()}
function showSpaceForm(data){var data=typeof data!="undefined"?data:false;var scheduleSpaceId=typeof data.scheduleSpaceId!="undefined"?data.scheduleSpaceId:0;if(scheduleSpaceId!=0)var currentType=calendar.options.spacesTypes[calendar.options["spaces"][scheduleSpaceId].type];else if(typeof data.type!="undefined")var currentType=calendar.options.spacesTypes[data.type];else var currentType=false;if(typeof data.cabinetId=="undefined")data["cabinetId"]=0;if(typeof data.date=="undefined")data["date"]=moment().format("YYYY-MM-DD");
    if(typeof data.timeStart=="undefined")data["timeStart"]="09:00";if(typeof data.timeEnd=="undefined")data["timeEnd"]="10:00";$("#visitSpaceForm .deleteScheduleSpace").hide();if(scheduleSpaceId&&currentClinicMemberHasAccess(ACCESS_SCHEDULE_VISITS_EDITING))$("#visitSpaceForm .deleteScheduleSpace").show().attr("data-scheduleSpaceId",scheduleSpaceId);if(!currentClinicMemberHasAccess(ACCESS_SCHEDULE_VISITS_EDITING)){$(".disbaledVisitModalCabinet").html(calendar.options.cabinets[data.cabinetId].name);$(".disbaledVisitModalType").html(calendar.options.spacesTypes[calendar.options.spaces[scheduleSpaceId].type].name);
        $(".disbaledVisitModalDateAndTime").html(calendar.options.days[data.date.replace(/-/g,"")].title+" "+data.timeStart+" - "+data.timeEnd);$(".disbaledVisitModalComment").html(data.note);if(data.note.length)$(".disbaledVisitModalCommentFormGroup").show();else $(".disbaledVisitModalCommentFormGroup").hide();$("#visitSpaceModal").modal("show");return}calendarPreselectedPatientId=false;$("#visitSpaceForm_scheduleSpaceId").val(scheduleSpaceId?calendar.options.spaces[scheduleSpaceId].id:0);$("#visitSpaceForm_refresh_location").val(data&&
    typeof data.refresh_location!="undefined"?data.refresh_location:1);$("#visitSpaceForm_cabinetId").val(data.cabinetId).trigger("change");if(currentType){var selectType=$("#visitSpaceForm_type").get(0);selectType.length=0;for(var t_id in calendar.options.spacesTypes){var t=calendar.options.spacesTypes[t_id];if(calendar.options.spacesTypes[t_id].status==1||calendar.options.spacesTypes[t_id].id==currentType.id)selectType.options[selectType.options.length]=new Option(calendar.options.spacesTypes[t_id].name,
        calendar.options.spacesTypes[t_id].id)}$("#visitSpaceForm_type").val(currentType.id).trigger("change")}else{var selectType=$("#visitSpaceForm_type").get(0);selectType.length=0;for(var t_id in calendar.options.spacesTypes){var t=calendar.options.spacesTypes[t_id];if(calendar.options.spacesTypes[t_id].status==1)selectType.options[selectType.options.length]=new Option(calendar.options.spacesTypes[t_id].name,calendar.options.spacesTypes[t_id].id)}}$("#visitSpaceForm_date").data("DateTimePicker").date(moment(data.date));
    clock.setTimeString($("#visitSpaceForm_timeStart"),data.timeStart);clock.setTimeString($("#visitSpaceForm_timeEnd"),data.timeEnd);$("#visitSpaceForm_note").val(data.note);$("#visitSpaceForm_authorsBlock").html(editedText).hide();if(scheduleSpaceId&&typeof calendar.options.spaces[scheduleSpaceId]!="undefined"){var date_created=calendar.options.spaces[scheduleSpaceId].date_created;var date_edited=calendar.options.spaces[scheduleSpaceId].date_edited;var creator=calendar.options.doctors[calendar.options.spaces[scheduleSpaceId].creator_id].name;
        if(typeof date_edited!="undefined"){var editor=calendar.options.doctors[calendar.options.spaces[scheduleSpaceId].editor_id].name;var edited=true}else var edited=false;if(edited)var editedText="<table><tr><td>"+T["Created"]+":</td><td>"+date_created+"</td><td>"+creator+"</td></tr><tr><td> "+T["Edited"]+": </td><td>"+date_edited+"</td><td>"+editor+"</td></tr></table>";else var editedText="<table><tr><td>"+T["Created"]+":</td><td>"+date_created+"</td><td>"+creator+"</td></tr></table>";$("#visitSpaceForm_authorsBlock").html(editedText).show()}if(typeof data.event==
        "undefined")$("#visitSpaceModal").modal("show");else if(isMobileDevice){calendar.needRefreshOnCloseModal=true;$("#visitSpaceModal").modal("show")}else $("#visitSpaceForm").submit()}
$("body").on("submit","#visitAdministratorForm",function(event){event.preventDefault();if(!currentClinicMemberHasAccess(ACCESS_SCHEDULE_ADMINISTRATOR_SHIFTS_EDITING))return;var scheduleAdministratorId=$("#visitAdministratorForm_scheduleAdministratorId").val();var cabinetId=$("#visitAdministratorForm_cabinetId").val();var typeId=$("#visitAdministratorForm_type").val();var date=getDateTimePickerDateInServerFormat("#visitAdministratorForm_date");var clinicMemberId=$("#visitAdministratorForm_clinicMemberId").val();
    var timeStart=$("#visitAdministratorForm_timeStart  .clockTimeValueHiddenInput").val();var timeEnd=$("#visitAdministratorForm_timeEnd .clockTimeValueHiddenInput").val();var rate=$("#hourRateForShift").val();var status=$("#visitAdministratorForm_status").val();var refresh_location=$("#visitAdministratorForm_refresh_location").val();var params={scheduleAdministratorId:scheduleAdministratorId,clinicMemberId:clinicMemberId,cabinetId:cabinetId,typeId:typeId,date:date,timeStart:timeStart,timeEnd:timeEnd,
        status:status,rate:rate,isSchedulePage:typeof calendar.onSuccessSave!="undefinded"?1:0};if(typeof event.schedule_confirm_unset_holiday!="undefined")params.schedule_confirm_unset_holiday=1;ajax({url:"/cabinet/schedule-api/save-administrator",data:params,success:function(response){if(response.saved==1){calendarSelectedVisitIdOnLoad=response.visitId;if(refresh_location=="1")locationHashChanged();if(location.hash=="#schedule/administrators"&&typeof calendar.onSuccessSave!="undefined")calendar.onSuccessSave(response.calendarOptions);
            $("#visitAdministratorModal").modal("hide");sendScheduleUpdateMessage(response.websocketUpdateData)}else{if(location.hash=="#schedule/administrators"&&typeof calendar.onSuccessSave!="undefined"&&typeof response.calendarOptions!="undefined")calendar.onSuccessSave(response.calendarOptions);$("#visitAdministratorModal").modal("show");if(typeof response.schedule_confirm_unset_holiday!="undefined")confirmDialog({buttonText:T["Schedule cancel holiday button"],text:response.message,buttonColor:"white",width:380,
            cancelButtonText:T["Schedule edit shift button"],action:function(){var event=jQuery.Event("submit");event.schedule_confirm_unset_holiday=1;$("#visitAdministratorForm").trigger(event)}});else messageBoard(response.message,"warning")}}})});
$("body").on("submit","#visitAssistantForm",function(event){event.preventDefault();if(!currentClinicMemberHasAccess(ACCESS_SCHEDULE_ASSISTANT_SHIFTS_EDITING))return;var scheduleAssistantId=$("#visitAssistantForm_scheduleAssistantId").val();var cabinetId=$("#visitAssistantForm_cabinetId").val();var typeId=$("#visitAssistantForm_type").val();var date=getDateTimePickerDateInServerFormat("#visitAssistantForm_date");var clinicMemberId=$("#visitAssistantForm_clinicMemberId").val();var timeStart=$("#visitAssistantForm_timeStart  .clockTimeValueHiddenInput").val();
    var timeEnd=$("#visitAssistantForm_timeEnd .clockTimeValueHiddenInput").val();var rate=$("#hourRateForShift").val();var status=$("#visitAssistantForm_status").val();var refresh_location=$("#visitAssistantForm_refresh_location").val();var params={scheduleAssistantId:scheduleAssistantId,clinicMemberId:clinicMemberId,cabinetId:cabinetId,typeId:typeId,date:date,timeStart:timeStart,timeEnd:timeEnd,status:status,rate:rate,isSchedulePage:typeof calendar.onSuccessSave!="undefinded"?1:0};if(typeof event.schedule_confirm_unset_holiday!=
        "undefined")params.schedule_confirm_unset_holiday=1;ajax({url:"/cabinet/schedule-api/save-assistant",data:params,success:function(response){if(response.saved==1){calendarSelectedVisitIdOnLoad=response.visitId;if(refresh_location=="1")locationHashChanged();if(location.hash=="#schedule/assistants"&&typeof calendar.onSuccessSave!="undefined")calendar.onSuccessSave(response.calendarOptions);$("#visitAssistantModal").modal("hide");sendScheduleUpdateMessage(response.websocketUpdateData)}else{if(location.hash==
            "#schedule/assistants"&&typeof calendar.onSuccessSave!="undefined"&&typeof response.calendarOptions!="undefined")calendar.onSuccessSave(response.calendarOptions);$("#visitAssistantModal").modal("show");if(typeof response.schedule_confirm_unset_holiday!="undefined")confirmDialog({buttonText:T["Schedule cancel holiday button"],text:response.message,width:380,buttonColor:"white",cancelButtonText:T["Schedule edit shift button"],action:function(){var event=jQuery.Event("submit");event.schedule_confirm_unset_holiday=
                1;$("#visitAssistantForm").trigger(event)}});else messageBoard(response.message,"warning")}}})});
$("body").on("submit","#visitSpaceForm",function(event){event.preventDefault();if(!currentClinicMemberHasAccess(ACCESS_SCHEDULE_VISITS_EDITING))return;var scheduleSpaceId=$("#visitSpaceForm_scheduleSpaceId").val();var cabinetId=$("#visitSpaceForm_cabinetId").val();var typeId=$("#visitSpaceForm_type").val();var date=getDateTimePickerDateInServerFormat("#visitSpaceForm_date");var timeStart=$("#visitSpaceForm_timeStart  .clockTimeValueHiddenInput").val();var timeEnd=$("#visitSpaceForm_timeEnd .clockTimeValueHiddenInput").val();
    var note=$("#visitSpaceForm_note").val();var refresh_location=$("#visitSpaceForm_refresh_location").val();ajax({url:"/cabinet/schedule-api/save-space",data:{scheduleSpaceId:scheduleSpaceId,cabinetId:cabinetId,typeId:typeId,date:date,timeStart:timeStart,timeEnd:timeEnd,note:note,isSchedulePage:typeof calendar.onSuccessSave!="undefinded"?1:0},success:function(response){if(response.saved==1){calendarSelectedVisitIdOnLoad=response.visitId;if(refresh_location=="1")locationHashChanged();if(location.hash==
            "#schedule"&&typeof calendar.onSuccessSave!="undefined")calendar.onSuccessSave(response.calendarOptions);$("#visitSpaceModal").modal("hide");sendScheduleUpdateMessage(response.websocketUpdateData)}else{if(location.hash=="#schedule"&&typeof calendar.onSuccessSave!="undefined"&&typeof response.calendarOptions!="undefined")calendar.onSuccessSave(response.calendarOptions);$("#visitSpaceModal").modal("show");messageBoard(response.message,"warning")}}})});
$("body").on("submit","#visitForm",function(event){event.preventDefault();if(!currentClinicMemberHasAccess(ACCESS_SCHEDULE_VISITS_EDITING))return;var scheduleVisitId=$("#visitForm_scheduleVisitId").val();var patientId=$("#visitForm_patientId").val();var cabinetId=$("#visitForm_cabinetId").val();var clinicMemberId=$("#visitForm_clinicMemberId").val();var date=getDateTimePickerDateInServerFormat("#visitForm_date");var timeStart=$("#visitForm_timeStart  .clockTimeValueHiddenInput").val();var timeEnd=
    $("#visitForm_timeEnd .clockTimeValueHiddenInput").val();var status=$("#visitForm_status").val();var note=$("#visitForm_note").val();var refresh_location=$("#visitForm_refresh_location").val();var visit_image=$("#visitForm_visit_image").val();var visit_image2=$("#visitForm_visit_image2").val();var annotationId=$("#visitForm_annotationId").val();ajax({url:"/cabinet/schedule-api/save-visit",data:{scheduleVisitId:scheduleVisitId,patientId:patientId,cabinetId:cabinetId,clinicMemberId:clinicMemberId,date:date,
        timeStart:timeStart,timeEnd:timeEnd,status:status,note:note,visit_image:visit_image,visit_image2:visit_image2,isSchedulePage:typeof calendar.onSuccessSave!="undefinded"?1:0,annotationId:annotationId},success:function(response){if(response.saved==1){calendarSelectedVisitIdOnLoad=response.visitId;if(refresh_location=="1")locationHashChanged();if(location.hash=="#schedule"&&typeof calendar.onSuccessSave!="undefined")calendar.onSuccessSave(response.calendarOptions);$("#visitModal").modal("hide");sendScheduleUpdateMessage(response.websocketUpdateData)}else{if(location.hash==
        "#schedule"&&typeof calendar.onSuccessSave!="undefined"&&typeof response.calendarOptions!="undefined")calendar.onSuccessSave(response.calendarOptions);$("#visitModal").modal("show");messageBoard(response.message,"warning")}}})});
$("body").on("click",".createNewScheduleVisitButton",function(event){calendarSelectAndScrollToVisitIdOnLoad=false;if(typeof calendar!="undefined"&&typeof calendar.$ACTIVE_VISIT!="undefined")calendar.$ACTIVE_VISIT=null;calendarPreselectedPatientId=$(this).attr("data-patientId");var expire=new Date;$.cookie("calendarPreselectedPatientId",calendarPreselectedPatientId,{expires:expire.getTime()+3600,path:"/"});calendarPreselectedAnnotationtId=$(this).attr("data-annotationId");$.cookie("calendarPreselectedAnnotationtId",
    calendarPreselectedAnnotationtId,{expires:expire.getTime()+3600,path:"/"});if(location.hash!="#schedule")changeLocationHash("#schedule")});$("body").on("click",".linkToScheduleWithDate",function(event){makeSureScheduleFiltersDontHideIt($(this).attr("data-cabinetId"),$(this).attr("data-clinicMemberId"));calendarSelectAndScrollToVisitIdOnLoad=$(this).attr("data-scheduleVisitId");var date=$(this).attr("data-date").substring(0,10);setScheduleDateCookie(date);changeLocationHash("#schedule")});
$("body").on("click",".linkToScheduleShiftWithDate",function(event){makeSureScheduleFiltersDontHideIt($(this).attr("data-cabinetId"),$(this).attr("data-clinicMemberId"));calendarSelectAndScrollToShiftIdOnLoad=$(this).attr("data-scheduleShiftId");var date=$(this).attr("data-date").substring(0,10);setScheduleDateCookie(date,SCHEDULE_VIEW_TYPE_VISITS);changeLocationHash("#schedule")});
function makeSureScheduleFiltersDontHideIt(cabinetId,clinicMemberId){var updateSettings=false;var cl=$.cookie("sch"+SCHEDULE_VIEW_TYPE_VISITS);if(cl)var settings=JSON.parse(cl);else var settings={};if(typeof settings[currentCabinetUserId]!="undefined"&&typeof settings[currentCabinetUserId][currentClinicId]!="undefined"&&typeof settings[currentCabinetUserId][currentClinicId].c!="undefined"){var cabinets=settings[currentCabinetUserId][currentClinicId].c.split(",");if(cabinets.indexOf(cabinetId)==-1){delete settings[currentCabinetUserId][currentClinicId].c;
    updateSettings=true}}if(typeof settings[currentCabinetUserId]!="undefined"&&typeof settings[currentCabinetUserId][currentClinicId]!="undefined"&&typeof settings[currentCabinetUserId][currentClinicId].m!="undefined")if(settings[currentCabinetUserId][currentClinicId].m!=clinicMemberId){delete settings[currentCabinetUserId][currentClinicId].m;updateSettings=true}if(updateSettings)$.cookie("sch"+SCHEDULE_VIEW_TYPE_VISITS,JSON.stringify(settings),{expires:5*365,path:"/"})}
$("body").on("click",".deleteScheduleVisit",function(event){deleteScheduleVisit($(this).attr("data-scheduleVisitId"))});$("body").on("click",".deleteScheduleAssistant",function(event){deleteScheduleAssistant($(this).attr("data-scheduleAssistantId"))});$("body").on("click",".deleteScheduleAdministrator",function(event){deleteScheduleAdministrator($(this).attr("data-scheduleAdministratorId"))});$("body").on("click",".deleteScheduleSpace",function(event){deleteScheduleSpace($(this).attr("data-scheduleSpaceId"))});
function setScheduleDateCookie(date,viewType){if(typeof viewType=="undefined")viewType=typeof calendar=="undefined"||typeof calendar.options=="undefined"||typeof calendar.options.viewType=="undefined"?SCHEDULE_VIEW_TYPE_VISITS:calendar.options.viewType;var cl=$.cookie("schedule_date"+"");if(cl)var settings=JSON.parse(cl);else var settings={};if(!settings||typeof settings!="object")settings={};if(typeof settings[currentCabinetUserId]=="undefined")settings[currentCabinetUserId]={};settings[currentCabinetUserId]=
    date;var expire=new Date;$.cookie("schedule_date"+"",JSON.stringify(settings),{expires:expire.getTime()+3600*1E3,path:"/"})}
function deleteScheduleVisit(visitId){if(!currentClinicMemberHasAccess(ACCESS_SCHEDULE_VISITS_EDITING))return;confirmDialog({buttonText:T["Delete"],text:T["Delete visit?"],buttonColor:"red",action:function(){ajax({url:"/cabinet/schedule-visits/delete-visits",data:{ids:visitId,isSchedulePage:document.location.hash=="#schedule"?1:0},success:function(response){if(location.hash=="#schedule"&&typeof calendar.onSuccessSave!="undefined")calendar.onSuccessSave(response.calendarOptions);else if(document.location.hash==
            "#schedule")refreshCalendar(calendar.options.date,false);else locationHashChanged();sendScheduleUpdateMessage(response.websocketUpdateData);$("#visitModal").modal("hide")}})}})}
function deleteScheduleAssistant(shiftId){if(!currentClinicMemberHasAccess(ACCESS_SCHEDULE_ASSISTANT_SHIFTS_EDITING))return;confirmDialog({buttonText:T["Delete"],text:T["Delete schedule assistant?"],buttonColor:"red",action:function(){ajax({url:"/cabinet/schedule-visits/delete-assistant-shift",data:{ids:shiftId,isSchedulePage:document.location.hash=="#schedule/assistants"?1:0},success:function(response){if(location.hash=="#schedule/assistants"&&typeof calendar.onSuccessSave!="undefined")calendar.onSuccessSave(response.calendarOptions);
        else if(document.location.hash=="#schedule/assistants")refreshCalendar(calendar.options.date,false);else locationHashChanged();sendScheduleUpdateMessage(response.websocketUpdateData);$("#visitAssistantModal").modal("hide")}})}})}
function deleteScheduleAdministrator(shiftId){if(!currentClinicMemberHasAccess(ACCESS_SCHEDULE_ADMINISTRATOR_SHIFTS_EDITING))return;confirmDialog({buttonText:T["Delete"],text:T["Delete schedule administrator?"],buttonColor:"red",action:function(){ajax({url:"/cabinet/schedule-visits/delete-administrator-shift",data:{ids:shiftId,isSchedulePage:document.location.hash=="#schedule/administrators"?1:0},success:function(response){if(location.hash=="#schedule/administrators"&&typeof calendar.onSuccessSave!=
            "undefined")calendar.onSuccessSave(response.calendarOptions);else if(document.location.hash=="#schedule/administrators")refreshCalendar(calendar.options.date,false);else locationHashChanged();sendScheduleUpdateMessage(response.websocketUpdateData);$("#visitAdministratorModal").modal("hide")}})}})}
function deleteScheduleSpace(spaceId){if(!currentClinicMemberHasAccess(ACCESS_SCHEDULE_VISITS_EDITING))return;confirmDialog({buttonText:T["Delete"],text:T["Delete space?"],buttonColor:"red",action:function(){ajax({url:"/cabinet/schedule-spaces/delete-spaces",data:{ids:calendar.options.spaces[spaceId].id,isSchedulePage:document.location.hash=="#schedule"?1:0},success:function(response){if((location.hash=="#schedule"||location.hash=="#schedule/assistants"||location.hash=="#schedule/administrators")&&
            typeof calendar.onSuccessSave!="undefined")calendar.onSuccessSave(response.calendarOptions);else if(location.hash=="#schedule"||location.hash=="#schedule/assistants"||location.hash=="#schedule/administrators")refreshCalendar(calendar.options.date,false);else locationHashChanged();sendScheduleUpdateMessage(response.websocketUpdateData);$("#visitSpaceModal").modal("hide")}})}})}
$("body").on("change",".scheduleTooltipVisitStatusSelectContainer select",function(event){if(!currentClinicMemberHasAccess(ACCESS_SCHEDULE_VISITS_EDITING))return;var status=$(this).val();var scheduleVisitId=$(this).closest(".calVisitCell").attr("_vis");ajax({url:"/cabinet/schedule-api/save-visit-status",data:{scheduleVisitId:scheduleVisitId,status:status},success:function(response){if(response.saved==1){calendarSelectedVisitIdOnLoad=response.visitId;if(location.hash=="#schedule"&&typeof calendar.onSuccessSave!=
        "undefined"){calendar.onSuccessSave(response.calendarOptions);sendScheduleUpdateMessage(response.websocketUpdateData)}}else messageBoard(response.message,"warning")}})});
function sendScheduleUpdateMessage(websocketUpdateData){if(typeof websocketUpdateData==undefined)websocketUpdateData="";var schedulePage=1;if(location.hash=="#schedule/assistants")schedulePage=2;if(location.hash=="#schedule/administrators")schedulePage=3;if(mainWebSocket.readyState==1)try{mainWebSocket.send(JSON.stringify({message:"sendMessage",messageType:"scheduleUpdate",clinicId:currentClinicId,hash:currentClinicWssHash,userId:currentCabinetUserId,schedulePage:schedulePage,websocketUpdateData:websocketUpdateData}))}catch(error){if(typeof Sentry!=
    "undefined"&&Sentry)Sentry.captureException(error)}}$("body").on("click",".visitImageSelectContainer .visitImageSelectPickerButton",function(event){visitImageSelectIsOpened=true;$(this).closest(".visitImageSelectContainer").find(".visitImageSelectPicker").show()});$("body").on("click",".visitImageSelectContainerInTooltip .visitImageSelectPickerButton",function(event){visitImageSelectIsOpened=true;$(this).closest(".visitImageSelectContainerInTooltip").find(".visitImageSelectPicker").show()});
$("body").on("click",".visitImageSelectContainerInFilterModal .visitImageSelectPickerButton",function(event){visitImageSelectIsOpened=true;$("#scheduleFilterModalAddHeight").show();$(".visitImageSelectContainerInFilterModal .visitImageSelectPicker").show()});
$("body").on("click",".visitImageSelectContainer .visitImageSelectPicker img",function(event){var imageN=$(this).attr("data-n");var imagePlace=parseInt($(this).attr("data-imagePlace"));$("#visitForm_visit_image_button"+(imagePlace==1?"":"2")).attr("src","/c/_img/schedule-images/"+imageN+".png?"+visitImagesVersion);$("#visitForm_visit_image"+(imagePlace==1?"":"2")).val(imageN);$(".visitImageSelectPicker").fadeOut("fast");if(!$("#visitForm_visit_image").val())$(".visitImageSelectContainer.visitImageSelectContainerWrap2").hide();
else $(".visitImageSelectContainer.visitImageSelectContainerWrap2").show()});
$("body").on("click",".visitImageSelectContainerInTooltip .visitImageSelectPicker img",function(event){var imageN=$(this).attr("data-n");var imagePlace=parseInt($(this).attr("data-imagePlace"));var scheduleVisitId=$(this).closest(".calVisitCell").attr("_vis");$(".visitImageSelectPicker").hide();ajax({url:"/cabinet/schedule-api/save-visit-image",data:{scheduleVisitId:scheduleVisitId,image:imageN,imagePlace:imagePlace},success:function(response){if(response.saved==1){calendarSelectedVisitIdOnLoad=response.visitId;
        if(location.hash=="#schedule"&&typeof calendar.onSuccessSave!="undefined"){calendar.onSuccessSave(response.calendarOptions);sendScheduleUpdateMessage(response.websocketUpdateData)}}else messageBoard(response.message,"warning")}})});
$("body").on("click",".visitImageSelectContainerInFilterModal .visitImageSelectPicker img",function(event){var imageN=$(this).attr("data-n");$("#filterModalButtonImage").attr("src","/c/_img/schedule-images/"+imageN+".png?"+visitImagesVersion);$("#scheduleSearchForm_imageN").val(imageN);$("#scheduleFilterModalAddHeight").hide();$(".visitImageSelectPicker").fadeOut("fast")});
;
$("body").on("click",".showScheduleShiftModalFormToEditInList",function(event){loadScheduleShiftDataFromServerAndShowModalForm($(this).attr("data-scheduleShiftId"))});function loadScheduleShiftDataFromServerAndShowModalForm(scheduleShiftId){ajax({url:"/cabinet/schedule-shifts/get-shift-data",data:{scheduleShiftId:scheduleShiftId},success:function(response){showScheduleShiftModalForm(response.data)}})}
function showScheduleShiftModalForm(data){try{var dateForShift=data.date.replace(/\-/g,"");var shift=calendar.options.doctorSchedule[dateForShift][data.cabinetId][data.clinicMemberId][data.scheduleShiftId]}catch(err){}if(!currentClinicMemberHasAccess(ACCESS_SCHEDULE_SHIFTS_EDITING))return;var scheduleShiftId=typeof data.scheduleShiftId!="undefined"?data.scheduleShiftId:0;if(typeof data.clinicMemberId=="undefined")data["clinicMemberId"]=currentClinicMemberId;if(typeof data.cabinetId=="undefined")data["cabinetId"]=
    0;if(typeof data.date=="undefined")data["date"]=moment().format("YYYY-MM-DD");if(typeof data.timeStart=="undefined")data["timeStart"]="09:00";if(typeof data.timeEnd=="undefined")data["timeEnd"]="18:00";$("#scheduleShiftForm_scheduleShiftId").val(scheduleShiftId);$("#scheduleShiftForm_refresh_location").val(data&&typeof data.refresh_location!="undefined"?data.refresh_location:1);$("#scheduleShiftForm_cabinetId").val(data.cabinetId).trigger("change");$("#scheduleShiftForm_clinicMemberId").val(data.clinicMemberId).trigger("change");
    $("#scheduleShiftForm_date").data("DateTimePicker").date(moment(data.date));clock.setTimeString($("#scheduleShiftForm_timeStart"),data.timeStart);clock.setTimeString($("#scheduleShiftForm_timeEnd"),data.timeEnd);$("#scheduleShiftForm .deleteScheduleShift").hide();if(scheduleShiftId)$("#scheduleShiftForm .deleteScheduleShift").show().attr("data-scheduleShiftId",scheduleShiftId);$("#scheduleShiftForm_authorsBlock").html(editedText).hide();if(typeof shift!="undefined"&&scheduleShiftId){var date_created=
        shift.date_created;var date_edited=shift.date_edited;var creator=calendar.options.doctors[shift.creator_id].name;if(typeof date_edited!="undefined"){var editor=calendar.options.doctors[shift.editor_id].name;var edited=true}else var edited=false;if(edited)var editedText="<table><tr><td>"+T["Created"]+":</td><td>"+date_created+"</td><td>"+creator+"</td></tr><tr><td> "+T["Edited"]+": </td><td>"+date_edited+"</td><td>"+editor+"</td></tr></table>";else var editedText="<table><tr><td>"+T["Created"]+":</td><td>"+
        date_created+"</td><td>"+creator+"</td></tr></table>";$("#scheduleShiftForm_authorsBlock").html(editedText).show()}else if(typeof data.editedText!="undefined")$("#scheduleShiftForm_authorsBlock").html(data.editedText).show();if(typeof data.event=="undefined")$("#scheduleShiftModal").modal("show");else if(isMobileDevice&&(currentClinicId==2043||currentClinicId==1876||currentClinicId==926||currentClinicId==892)&&(data.event=="drag"||data.event=="resize")){calendar.needRefreshOnCloseModal=true;$("#scheduleShiftModal").modal("show")}else $("#scheduleShiftForm").submit()}
$("body").on("submit","#scheduleShiftForm",function(event){event.preventDefault();if(!currentClinicMemberHasAccess(ACCESS_SCHEDULE_SHIFTS_EDITING))return;var scheduleShiftId=$("#scheduleShiftForm_scheduleShiftId").val();var cabinetId=$("#scheduleShiftForm_cabinetId").val();var clinicMemberId=$("#scheduleShiftForm_clinicMemberId").val();var date=getDateTimePickerDateInServerFormat("#scheduleShiftForm_date");var timeStart=$("#scheduleShiftForm_timeStart  .clockTimeValueHiddenInput").val();var timeEnd=
    $("#scheduleShiftForm_timeEnd .clockTimeValueHiddenInput").val();var refresh_location=$("#scheduleShiftForm_refresh_location").val();ajax({url:"/cabinet/schedule-api/save-shift",data:{scheduleShiftId:scheduleShiftId,cabinetId:cabinetId,clinicMemberId:clinicMemberId,date:date,timeStart:timeStart,timeEnd:timeEnd,isSchedulePage:typeof calendar.onSuccessSave!="undefinded"?1:0},success:function(response){if(response.saved==1){calendarSelectedShiftIdOnLoad=response.shiftId;if(refresh_location=="1")locationHashChanged();
        if(location.hash=="#schedule"&&typeof calendar.onSuccessSave!="undefined")calendar.onSuccessSave(response.calendarOptions);$("#scheduleShiftModal").modal("hide");sendScheduleUpdateMessage(response.websocketUpdateData)}else{if(location.hash=="#schedule"&&typeof calendar.onSuccessSave!="undefined"&&typeof response.calendarOptions!="undefined")calendar.onSuccessSave(response.calendarOptions);$("#scheduleShiftModal").modal("show");messageBoard(response.message,"warning")}}})});
$("body").on("click",".createNewScheduleShiftButton",function(event){if(!currentClinicMemberHasAccess(ACCESS_SCHEDULE_SHIFTS_EDITING))return;var clinicMemberId=$(this).attr("data-clinicMemberId");showScheduleShiftModalForm({clinicMemberId:clinicMemberId})});$("body").on("click",".deleteScheduleShift",function(event){deleteScheduleShift($(this).attr("data-scheduleShiftId"))});
function deleteScheduleShift(shiftId){if(!currentClinicMemberHasAccess(ACCESS_SCHEDULE_SHIFTS_EDITING))return;confirmDialog({buttonText:T["Delete"],text:T["Delete shift?"],buttonColor:"red",action:function(){ajax({url:"/cabinet/schedule-shifts/delete-schedule-shifts",data:{ids:shiftId,isSchedulePage:document.location.hash=="#schedule"?1:0},success:function(response){if(location.hash=="#schedule"&&typeof calendar.onSuccessSave!="undefined")calendar.onSuccessSave(response.calendarOptions);else if(document.location.hash==
            "#schedule")refreshCalendar(calendar.options.date,false);else locationHashChanged();sendScheduleUpdateMessage(response.websocketUpdateData);$("#scheduleShiftModal").modal("hide")}})}})};
;
function initScheduleDatetimepicker(){if("undefined"==typeof $("#scheduleDatetimepicker").data("DateTimePicker"))$("#scheduleDatetimepicker").datetimepicker({inline:!0,useCurrent:!1,format:"YYYY-MM-DD",allowInputToggle:!0,icons:{time:"glyphicon glyphicon-time",date:"glyphicon glyphicon-calendar",up:"fa fa-angle-up",down:"fa fa-angle-down",previous:"fa fa-angle-left",next:"fa fa-angle-right",today:"glyphicon glyphicon-screenshot",clear:"glyphicon glyphicon-trash",close:"glyphicon glyphicon-remove"},
showTodayButton:!0}).on("dp.change",function(a){var b=a.date;null!=$("#scheduleDatetimepickerMobile").data("DateTimePicker").date()&&$("#scheduleDatetimepickerMobile").data("DateTimePicker").date()._d.toString()==b._d.toString()||$("#scheduleDatetimepickerMobile").data("DateTimePicker").date(b._d);refreshCalendar(a.date.format("YYYY-MM-DD"),!0);scheduleDatetimepickerHighlightShownDays()}).on("dp.update",function(a){scheduleDatetimepickerHighlightShownDays()});$("#scheduleDatetimepickerMobile").datetimepicker({useCurrent:!1,
format:"YYYY-MM-DD",allowInputToggle:!0,inline:!0,icons:{time:"glyphicon glyphicon-time",date:"glyphicon glyphicon-calendar",up:"fa fa-angle-up",down:"fa fa-angle-down",previous:"fa fa-angle-left",next:"fa fa-angle-right",today:"glyphicon glyphicon-screenshot",clear:"glyphicon glyphicon-trash",close:"glyphicon glyphicon-remove"},showTodayButton:!0}).on("dp.change",function(a){$("#scheduleDatetimepickerMobile").hide();a=a.date;$("#scheduleDatetimepicker").data("DateTimePicker").date()._d.toString()!=
a._d.toString()?$("#scheduleDatetimepicker").data("DateTimePicker").date(a._d):isMobileDevice&&(unsetTouchScroll(),scrollStartLeft=_scrollLeft=_scrollTop=0,setTimeout(function(){__sidebar.style.marginTop="0px";__header.style.marginLeft="0px";setTouchScroll()},100),scheduleDatetimepickerHighlightShownDays())}).on("dp.update",function(a){}).on("dp.show",function(a){scheduleDatetimepickerHighlightShownDays()})}
function scheduleDatetimepickerHighlightShownDays(){var a=$("#scheduleDatetimepicker").data("DateTimePicker").date();$(".datepicker .table-condensed .day").removeClass("scheduleDatetimepickerHighlightedDay");if(null!=a)for(var b=1;b<scheduleCountDays;b++){var c=a.add(1,"day").format("en"==cabinetLanguage?"DD/MM/YYYY":"DD.MM.YYYY");$('.datepicker .table-condensed .day[data-day="'+c+'"]').addClass("scheduleDatetimepickerHighlightedDay")}};
;
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(b,v,r){b instanceof String&&(b=String(b));for(var t=b.length,q=0;q<t;q++){var x=b[q];if(v.call(r,x,q,b))return{i:q,v:x}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,v,r){if(b==Array.prototype||b==Object.prototype)return b;b[v]=r.value;return b};$jscomp.getGlobal=function(b){b=["object"==typeof globalThis&&globalThis,b,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var v=0;v<b.length;++v){var r=b[v];if(r&&r.Math==Math)return r}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(b,v){var r=$jscomp.propertyToPolyfillSymbol[v];if(null==r)return b[v];r=b[r];return void 0!==r?r:b[v]};
$jscomp.polyfill=function(b,v,r,t){v&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(b,v,r,t):$jscomp.polyfillUnisolated(b,v,r,t))};$jscomp.polyfillUnisolated=function(b,v,r,t){r=$jscomp.global;b=b.split(".");for(t=0;t<b.length-1;t++){var q=b[t];q in r||(r[q]={});r=r[q]}b=b[b.length-1];t=r[b];v=v(t);v!=t&&null!=v&&$jscomp.defineProperty(r,b,{configurable:!0,writable:!0,value:v})};
$jscomp.polyfillIsolated=function(b,v,r,t){var q=b.split(".");b=1===q.length;t=q[0];t=!b&&t in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var x=0;x<q.length-1;x++){var J=q[x];J in t||(t[J]={});t=t[J]}q=q[q.length-1];r=$jscomp.IS_SYMBOL_NATIVE&&"es6"===r?t[q]:null;v=v(r);null!=v&&(b?$jscomp.defineProperty($jscomp.polyfills,q,{configurable:!0,writable:!0,value:v}):v!==r&&($jscomp.propertyToPolyfillSymbol[q]=$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(q):$jscomp.POLYFILL_PREFIX+q,q=$jscomp.propertyToPolyfillSymbol[q],
$jscomp.defineProperty(t,q,{configurable:!0,writable:!0,value:v})))};$jscomp.polyfill("Array.prototype.find",function(b){return b?b:function(b,r){return $jscomp.findInternal(this,b,r).v}},"es6","es3");var scheduleScrollonCompleteInterval=null,scheduleMouseWheelTimeout=null,scheduleMouseWheelInterval=null,skipMouseWheelTimeout=null,useSkipMouseWheel=!1,scheduleCabinetPerDay=3,lockFixScroll=!1,touchOn=!1,touchOffTimeout=null,xDirection=1,clinicMouseDraggableMCS=!1,emptyFunction=function(){};
(function(b){"function"===typeof define&&define.amd?define(["jquery"],b):"undefined"!==typeof module&&module.exports?module.exports=b:b(jQuery,window,document)})(function(b){(function(v){var r="undefined"!==typeof module&&module.exports,t="https:"==document.location.protocol?"https:":"http:";"function"===typeof define&&define.amd||(r?require("jquery-mousewheel")(b):b.event.special.mousewheel||b("head").append(decodeURI("%3Cscript src="+t+"//cdnjs.cloudflare.com/ajax/libs/jquery-mousewheel/3.1.13/jquery.mousewheel.min.js%3E%3C/script%3E")));
v()})(function(){var v={setTop:0,setLeft:0,axis:"y",scrollbarPosition:"inside",scrollInertia:950,autoDraggerLength:!0,alwaysShowScrollbar:0,snapOffset:0,mouseWheel:{enable:!0,scrollAmount:"auto",axis:"y",deltaFactor:"auto",disableOver:["select","option","keygen","datalist","textarea"]},scrollButtons:{scrollType:"stepless",scrollAmount:"auto"},keyboard:{enable:!0,scrollType:"stepped",scrollAmount:"auto"},contentTouchScroll:25,documentTouchScroll:!0,advanced:{autoScrollOnFocus:"input,textarea,select,button,datalist,keygen,a[tabindex],area,object,[contenteditable='true']",
updateOnContentResize:!0,updateOnImageLoad:!1,autoUpdateTimeout:60},theme:"light",callbacks:{onTotalScrollOffset:0,onTotalScrollBackOffset:0,alwaysTriggerOffsets:!0}},r=0,t={},q=window.attachEvent&&!window.addEventListener?1:0,x=!1,J,p="mCSB_dragger_onDrag mCSB_scrollTools_onDrag mCS_img_loaded mCS_disabled mCS_destroyed mCS_no_scrollbar mCS-autoHide mCS-dir-rtl mCS_no_scrollbar_y mCS_no_scrollbar_x mCS_y_hidden mCS_x_hidden mCSB_draggerContainer mCSB_buttonUp mCSB_buttonDown mCSB_buttonLeft mCSB_buttonRight".split(" "),
F={init:function(a){a=b.extend(!0,{},v,a);var d=K.call(this);if(a.live){var c=a.liveSelector||this.selector||".mCustomScrollbar",e=b(c);if("off"===a.live){U(c);return}t[c]=setTimeout(function(){e.mCustomScrollbar(a);"once"===a.live&&e.length&&U(c)},500)}else U(c);a.setWidth=a.set_width?a.set_width:a.setWidth;a.setHeight=a.set_height?a.set_height:a.setHeight;a.axis=a.horizontalScroll?"x":ka(a.axis);a.scrollInertia=0<a.scrollInertia&&17>a.scrollInertia?17:a.scrollInertia;"object"!==typeof a.mouseWheel&&
1==a.mouseWheel&&(a.mouseWheel={enable:!0,scrollAmount:"auto",axis:"y",preventDefault:!1,deltaFactor:"auto",normalizeDelta:!1,invert:!1});a.mouseWheel.scrollAmount=a.mouseWheelPixels?a.mouseWheelPixels:a.mouseWheel.scrollAmount;a.mouseWheel.normalizeDelta=a.advanced.normalizeMouseWheelDelta?a.advanced.normalizeMouseWheelDelta:a.mouseWheel.normalizeDelta;a.scrollButtons.scrollType=la(a.scrollButtons.scrollType);da(a);return b(d).each(function(){var c=b(this);if(!c.data("mCS")){c.data("mCS",{idx:++r,
opt:a,scrollRatio:{y:null,x:null},overflowed:null,contentReset:{y:null,x:null},bindEvents:!1,tweenRunning:!1,sequential:{},langDir:c.css("direction"),cbOffsets:null,trigger:null,poll:{size:{o:0,n:0},img:{o:0,n:0},change:{o:0,n:0}}});var d=c.data("mCS"),g=d.opt,e=c.data("mcs-axis"),k=c.data("mcs-scrollbar-position"),l=c.data("mcs-theme");e&&(g.axis=e);k&&(g.scrollbarPosition=k);l&&(g.theme=l,da(g));k=b(this);e=k.data("mCS");l=e.opt;var n=l.autoExpandScrollbar?" "+p[1]+"_expand":"";n=["<div id='mCSB_"+
e.idx+"_scrollbar_vertical' class='mCSB_scrollTools mCSB_"+e.idx+"_scrollbar mCS-"+l.theme+" mCSB_scrollTools_vertical"+n+"'><div class='"+p[12]+"'><div id='mCSB_"+e.idx+"_dragger_vertical' class='mCSB_dragger' style='position:absolute;'><div class='mCSB_dragger_bar' /></div><div class='mCSB_draggerRail' /></div></div>","<div id='mCSB_"+e.idx+"_scrollbar_horizontal' class='mCSB_scrollTools mCSB_"+e.idx+"_scrollbar mCS-"+l.theme+" mCSB_scrollTools_horizontal"+n+"'><div class='"+p[12]+"'><div id='mCSB_"+
e.idx+"_dragger_horizontal' class='mCSB_dragger' style='position:absolute;'><div class='mCSB_dragger_bar' /></div><div class='mCSB_draggerRail' /></div></div>"];var z="yx"===l.axis?"mCSB_vertical_horizontal":"x"===l.axis?"mCSB_horizontal":"mCSB_vertical";n="yx"===l.axis?n[0]+n[1]:"x"===l.axis?n[1]:n[0];var ma="yx"===l.axis?"<div id='mCSB_"+e.idx+"_container_wrapper' class='mCSB_container_wrapper' />":"",E=l.autoHideScrollbar?" "+p[6]:"",na="x"!==l.axis&&"rtl"===e.langDir?" "+p[7]:"";l.setWidth&&k.css("width",
l.setWidth);l.setHeight&&k.css("height",l.setHeight);l.setLeft="y"!==l.axis&&"rtl"===e.langDir?"989999px":l.setLeft;k.addClass("mCustomScrollbar _mCS_"+e.idx+E+na).wrapInner("<div id='mCSB_"+e.idx+"' class='mCustomScrollBox mCS-"+l.theme+" "+z+"'><div id='mCSB_"+e.idx+"_container' class='mCSB_container' style='position:relative; top:"+l.setTop+"; left:"+l.setLeft+";' dir='"+e.langDir+"' /></div>");z=b("#mCSB_"+e.idx);E=b("#mCSB_"+e.idx+"_container");"y"===l.axis||l.advanced.autoExpandHorizontalScroll||
E.css("width",ea(E));"outside"===l.scrollbarPosition?("static"===k.css("position")&&k.css("position","relative"),k.css("overflow","visible"),z.addClass("mCSB_outside").after(n)):(z.addClass("mCSB_inside").append(n),E.wrap(ma));l=b(this).data("mCS");k=l.opt;l=b(".mCSB_"+l.idx+"_scrollbar:first");n=V(k.scrollButtons.tabindex)?"tabindex='"+k.scrollButtons.tabindex+"'":"";n=["<a href='#' class='"+p[13]+"' "+n+" />","<a href='#' class='"+p[14]+"' "+n+" />","<a href='#' class='"+p[15]+"' "+n+" />","<a href='#' class='"+
p[16]+"' "+n+" />"];n=["x"===k.axis?n[2]:n[0],"x"===k.axis?n[3]:n[1],n[2],n[3]];k.scrollButtons.enable&&l.prepend(n[0]).append(n[1]).next(".mCSB_scrollTools").prepend(n[2]).append(n[3]);e=[b("#mCSB_"+e.idx+"_dragger_vertical"),b("#mCSB_"+e.idx+"_dragger_horizontal")];e[0].css("min-height",e[0].height());e[1].css("min-width",e[1].width());d&&g.callbacks.onCreate&&"function"===typeof g.callbacks.onCreate&&g.callbacks.onCreate.call(this);F.update.call(null,c)}})},update:function(a,d){a=a||K.call(this);
return b(a).each(function(){var a=b(this);if(a.data("mCS")){var e=a.data("mCS"),f=e.opt,h=b("#mCSB_"+e.idx+"_container"),g=b("#mCSB_"+e.idx),m=[b("#mCSB_"+e.idx+"_dragger_vertical"),b("#mCSB_"+e.idx+"_dragger_horizontal")];if(h.length){e.tweenRunning&&I(a);d&&e&&f.callbacks.onBeforeUpdate&&"function"===typeof f.callbacks.onBeforeUpdate&&f.callbacks.onBeforeUpdate.call(this);a.hasClass(p[3])&&a.removeClass(p[3]);a.hasClass(p[4])&&a.removeClass(p[4]);g.css("max-height","none");g.height()!==a.height()&&
g.css("max-height",a.height());var k=b(this).data("mCS");g=k.opt;k=b("#mCSB_"+k.idx+"_container");if(g.advanced.autoExpandHorizontalScroll&&"y"!==g.axis){k.css({width:"auto","min-width":0,"overflow-x":"scroll"});var l=Math.ceil(k[0].scrollWidth);3===g.advanced.autoExpandHorizontalScroll||2!==g.advanced.autoExpandHorizontalScroll&&l>k.parent().width()?k.css({width:l,"min-width":"100%","overflow-x":"inherit"}):k.css({"overflow-x":"inherit",position:"absolute"}).wrap("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />").css({width:Math.ceil(k[0].getBoundingClientRect().right+
.4)-Math.floor(k[0].getBoundingClientRect().left),"min-width":"100%",position:"relative"}).unwrap()}"y"===f.axis||f.advanced.autoExpandHorizontalScroll||h.css("width",ea(h));var n=b(this).data("mCS");g=b("#mCSB_"+n.idx);l=b("#mCSB_"+n.idx+"_container");k=null==n.overflowed?l.height():l.outerHeight(!1);n=null==n.overflowed?l.width():l.outerWidth(!1);var z=l[0].scrollHeight;l=l[0].scrollWidth;z>k&&(k=z);l>n&&(n=l);g=[k>g.height(),n>g.width()];e.overflowed=g;fa.call(this);f.autoDraggerLength&&(g=b(this).data("mCS"),
k=b("#mCSB_"+g.idx),l=b("#mCSB_"+g.idx+"_container"),g=[b("#mCSB_"+g.idx+"_dragger_vertical"),b("#mCSB_"+g.idx+"_dragger_horizontal")],k=[k.height()/l.outerHeight(!1),k.width()/l.outerWidth(!1)],k=[parseInt(g[0].css("min-height")),Math.round(k[0]*g[0].parent().height()),parseInt(g[1].css("min-width")),Math.round(k[1]*g[1].parent().width())],l=q&&k[3]<k[2]?k[2]:k[3],g[0].css({height:q&&k[1]<k[0]?k[0]:k[1],"max-height":g[0].parent().height()-10}).find(".mCSB_dragger_bar").css({"line-height":k[0]+"px"}),
g[1].css({width:l,"max-width":g[1].parent().width()-10}));g=b(this).data("mCS");l=b("#mCSB_"+g.idx);n=b("#mCSB_"+g.idx+"_container");k=[b("#mCSB_"+g.idx+"_dragger_vertical"),b("#mCSB_"+g.idx+"_dragger_horizontal")];l=[n.outerHeight(!1)-l.height(),n.outerWidth(!1)-l.width()];k=[l[0]/(k[0].parent().height()-k[0].height()),l[1]/(k[1].parent().width()-k[1].width())];g.scrollRatio={y:k[0],x:k[1]};oa.call(this);h=[Math.abs(h[0].offsetTop),Math.abs(h[0].offsetLeft)];"x"!==f.axis&&(e.overflowed[0]?m[0].height()>
m[0].parent().height()?L.call(this):(A(a,h[0].toString(),{dir:"y",dur:0,overwrite:"none"}),e.contentReset.y=null):(L.call(this),"y"===f.axis?W.call(this):"yx"===f.axis&&e.overflowed[1]&&A(a,h[1].toString(),{dir:"x",dur:0,overwrite:"none"})));"y"!==f.axis&&(e.overflowed[1]?m[1].width()>m[1].parent().width()?L.call(this):(A(a,h[1].toString(),{dir:"x",dur:0,overwrite:"none"}),e.contentReset.x=null):(L.call(this),"x"===f.axis?W.call(this):"yx"===f.axis&&e.overflowed[0]&&A(a,h[0].toString(),{dir:"y",dur:0,
overwrite:"none"})));d&&e&&(2===d&&f.callbacks.onImageLoad&&"function"===typeof f.callbacks.onImageLoad?f.callbacks.onImageLoad.call(this):3===d&&f.callbacks.onSelectorChange&&"function"===typeof f.callbacks.onSelectorChange?f.callbacks.onSelectorChange.call(this):f.callbacks.onUpdate&&"function"===typeof f.callbacks.onUpdate&&f.callbacks.onUpdate.call(this));Y.call(this)}}})},scrollTo:function(a,d){if("undefined"!=typeof a&&null!=a){var c=K.call(this);return b(c).each(function(){var c=b(this);if(c.data("mCS")){var f=
c.data("mCS"),h=f.opt,g=b.extend(!0,{},{trigger:"external",scrollInertia:h.scrollInertia,scrollEasing:"mcsEaseInOut",moveDragger:!1,timeout:60,callbacks:!0,onStart:!0,onUpdate:!0,onComplete:!0},d),m=Z.call(this,a),k=0<g.scrollInertia&&17>g.scrollInertia?17:g.scrollInertia;m[0]=ha.call(this,m[0],"y");m[1]=ha.call(this,m[1],"x");g.moveDragger&&(m[0]*=f.scrollRatio.y,m[1]*=f.scrollRatio.x);g.dur=pa()?0:k;0<g.timeout?setTimeout(function(){null!==m[0]&&"undefined"!==typeof m[0]&&"x"!==h.axis&&f.overflowed[0]&&
(g.dir="y",g.overwrite="all",A(c,m[0].toString(),g));null!==m[1]&&"undefined"!==typeof m[1]&&"y"!==h.axis&&f.overflowed[1]&&(g.dir="x",g.overwrite="none",A(c,m[1].toString(),g))},g.timeout):(null!==m[0]&&"undefined"!==typeof m[0]&&"x"!==h.axis&&f.overflowed[0]&&(g.dir="y",g.overwrite="all",A(c,m[0].toString(),g)),null!==m[1]&&"undefined"!==typeof m[1]&&"y"!==h.axis&&f.overflowed[1]&&(g.dir="x",g.overwrite="none",A(c,m[1].toString(),g)))}})}},stop:function(){var a=K.call(this);return b(a).each(function(){var a=
b(this);a.data("mCS")&&I(a)})},disable:function(a){var d=K.call(this);return b(d).each(function(){var c=b(this);c.data("mCS")&&(c.data("mCS"),Y.call(this,"remove"),W.call(this),a&&L.call(this),fa.call(this,!0),c.addClass(p[3]))})},destroy:function(){var a=K.call(this);return b(a).each(function(){var d=b(this);if(d.data("mCS")){var c=d.data("mCS"),e=c.opt,f=b("#mCSB_"+c.idx),h=b("#mCSB_"+c.idx+"_container"),g=b(".mCSB_"+c.idx+"_scrollbar");e.live&&U(e.liveSelector||b(a).selector);Y.call(this,"remove");
W.call(this);L.call(this);d.removeData("mCS");C(this,"mcs");g.remove();h.find("img."+p[2]).removeClass(p[2]);f.replaceWith(h.contents());d.removeClass("mCustomScrollbar _mCS_"+c.idx+" "+p[6]+" "+p[7]+" "+p[5]+" "+p[3]).addClass(p[4])}})},setTouchScroll:function(){var a=K.call(this);return b(a).each(function(){b(this).data("mCS").opt.contentTouchScroll=5})},unsetTouchScroll:function(){var a=K.call(this);return b(a).each(function(){b(this).data("mCS").opt.contentTouchScroll=!1})}},K=function(){return"object"!==
typeof b(this)||1>b(this).length?".mCustomScrollbar":this},da=function(a){a.autoDraggerLength=-1<b.inArray(a.theme,["rounded","rounded-dark","rounded-dots","rounded-dots-dark"])?!1:a.autoDraggerLength;a.autoExpandScrollbar=-1<b.inArray(a.theme,"rounded-dots rounded-dots-dark 3d 3d-dark 3d-thick 3d-thick-dark inset inset-dark inset-2 inset-2-dark inset-3 inset-3-dark".split(" "))?!1:a.autoExpandScrollbar;a.scrollButtons.enable=-1<b.inArray(a.theme,["minimal","minimal-dark"])?!1:a.scrollButtons.enable;
a.autoHideScrollbar=-1<b.inArray(a.theme,["minimal","minimal-dark"])?!0:a.autoHideScrollbar;a.scrollbarPosition=-1<b.inArray(a.theme,["minimal","minimal-dark"])?"outside":a.scrollbarPosition},U=function(a){t[a]&&(clearTimeout(t[a]),C(t,a))},ka=function(a){return"yx"===a||"xy"===a||"auto"===a?"yx":"x"===a||"horizontal"===a?"x":"y"},la=function(a){return"stepped"===a||"pixels"===a||"step"===a||"click"===a?"stepped":"stepless"},ea=function(a){var d=[a[0].scrollWidth,Math.max.apply(Math,a.children().map(function(){return b(this).outerWidth(!0)}).get())];
a=a.parent().width();return d[0]>a?d[0]:d[1]>a?d[1]:"100%"},X=function(a,b,c){c=c?p[0]+"_expanded":"";var d=a.closest(".mCSB_scrollTools");"active"===b?(a.toggleClass(p[0]+" "+c),d.toggleClass(p[1]),a[0]._draggable=a[0]._draggable?0:1):a[0]._draggable||("hide"===b?(a.removeClass(p[0]),d.removeClass(p[1])):(a.addClass(p[0]),d.addClass(p[1])))},L=function(){var a=b(this),d=a.data("mCS"),c=d.opt,e=b("#mCSB_"+d.idx),f=b("#mCSB_"+d.idx+"_container"),h=[b("#mCSB_"+d.idx+"_dragger_vertical"),b("#mCSB_"+
d.idx+"_dragger_horizontal")];I(a);if("x"!==c.axis&&!d.overflowed[0]||"y"===c.axis&&d.overflowed[0])h[0].add(f).css("top",0),A(a,"_resetY");if("y"!==c.axis&&!d.overflowed[1]||"x"===c.axis&&d.overflowed[1])c=dx=0,"rtl"===d.langDir&&(c=e.width()-f.outerWidth(!1),dx=Math.abs(c/d.scrollRatio.x)),f.css("left",c),h[1].css("left",dx),A(a,"_resetX")},oa=function(){var a=b(this),d=a.data("mCS"),c=d.opt;if(!d.bindEvents){qa.call(this);c.contentTouchScroll&&ra.call(this);sa.call(this);if(c.mouseWheel.enable){var e=
function(){f=setTimeout(function(){b.event.special.mousewheel?(clearTimeout(f),ta.call(a[0])):e()},100)},f;e()}ua.call(this);va.call(this);c.advanced.autoScrollOnFocus&&wa.call(this);c.scrollButtons.enable&&xa.call(this);c.keyboard.enable&&ya.call(this);d.bindEvents=!0}},W=function(){var a=b(this),d=a.data("mCS"),c=d.opt,e="mCS_"+d.idx,f=".mCSB_"+d.idx+"_scrollbar";f=b("#mCSB_"+d.idx+",#mCSB_"+d.idx+"_container,#mCSB_"+d.idx+"_container_wrapper,"+f+" ."+p[12]+",#mCSB_"+d.idx+"_dragger_vertical,#mCSB_"+
d.idx+"_dragger_horizontal,"+f+">a");var h=b("#mCSB_"+d.idx+"_container");c.advanced.releaseDraggableSelectors&&f.add(b(c.advanced.releaseDraggableSelectors));c.advanced.extraDraggableSelectors&&f.add(b(c.advanced.extraDraggableSelectors));d.bindEvents&&(b(document).add(b(!Q()||top.document)).unbind("."+e),f.each(function(){b(this).unbind("."+e)}),clearTimeout(a[0]._focusTimeout),C(a[0],"_focusTimeout"),clearTimeout(d.sequential.step),C(d.sequential,"step"),clearTimeout(h[0].onCompleteTimeout),C(h[0],
"onCompleteTimeout"),d.bindEvents=!1)},fa=function(a){var d=b(this),c=d.data("mCS"),e=c.opt,f=b("#mCSB_"+c.idx+"_container_wrapper");f=f.length?f:b("#mCSB_"+c.idx+"_container");var h=[b("#mCSB_"+c.idx+"_scrollbar_vertical"),b("#mCSB_"+c.idx+"_scrollbar_horizontal")],g=[h[0].find(".mCSB_dragger"),h[1].find(".mCSB_dragger")];"x"!==e.axis&&(c.overflowed[0]&&!a?(h[0].add(g[0]).add(h[0].children("a")).css("display","block"),f.removeClass(p[8]+" "+p[10])):(e.alwaysShowScrollbar?(2!==e.alwaysShowScrollbar&&
g[0].css("display","none"),f.removeClass(p[10])):(h[0].css("display","none"),f.addClass(p[10])),f.addClass(p[8])));"y"!==e.axis&&(c.overflowed[1]&&!a?(h[1].add(g[1]).add(h[1].children("a")).css("display","block"),f.removeClass(p[9]+" "+p[11])):(e.alwaysShowScrollbar?(2!==e.alwaysShowScrollbar&&g[1].css("display","none"),f.removeClass(p[11])):(h[1].css("display","none"),f.addClass(p[11])),f.addClass(p[9])));c.overflowed[0]||c.overflowed[1]?d.removeClass(p[5]):d.addClass(p[5])},u=function(a){var d=
a.type,c=a.target.ownerDocument!==document&&null!==frameElement?[b(frameElement).offset().top,b(frameElement).offset().left]:null,e=Q()&&a.target.ownerDocument!==top.document&&null!==frameElement?[b(a.view.frameElement).offset().top,b(a.view.frameElement).offset().left]:[0,0];switch(d){case "pointerdown":case "MSPointerDown":case "pointermove":case "MSPointerMove":case "pointerup":case "MSPointerUp":return c?[a.originalEvent.pageY-c[0]+e[0],a.originalEvent.pageX-c[1]+e[1],!1]:[a.originalEvent.pageY,
a.originalEvent.pageX,!1];case "touchstart":case "touchmove":case "touchend":return d=a.originalEvent.touches[0]||a.originalEvent.changedTouches[0],c=a.originalEvent.touches.length||a.originalEvent.changedTouches.length,a.target.ownerDocument!==document?[d.screenY,d.screenX,1<c]:[d.pageY,d.pageX,1<c];default:return c?[a.pageY-c[0]+e[0],a.pageX-c[1]+e[1],!1]:[a.pageY,a.pageX,!1]}},qa=function(){function a(a,b,l,f){g[0].idleTimer=233>e.scrollInertia?250:0;if(k.attr("id")===h[1]){var E="x";a=(k[0].offsetLeft-
b+f)*c.scrollRatio.x}else E="y",a=(k[0].offsetTop-a+l)*c.scrollRatio.y;A(d,a.toString(),{dir:E,drag:!0})}var d=b(this),c=d.data("mCS"),e=c.opt,f="mCS_"+c.idx,h=["mCSB_"+c.idx+"_dragger_vertical","mCSB_"+c.idx+"_dragger_horizontal"],g=b("#mCSB_"+c.idx+"_container"),m=b("#"+h[0]+",#"+h[1]),k,l,n,z=e.advanced.releaseDraggableSelectors?m.add(b(e.advanced.releaseDraggableSelectors)):m,p=e.advanced.extraDraggableSelectors?b(!Q()||top.document).add(b(e.advanced.extraDraggableSelectors)):b(!Q()||top.document);
m.bind("contextmenu."+f,function(a){a.preventDefault()}).bind("mousedown."+f+" touchstart."+f+" pointerdown."+f+" MSPointerDown."+f,function(a){a.stopImmediatePropagation();a.preventDefault();if(!a.which||1===a.which){x=!0;q&&(document.onselectstart=function(){return!1});ia.call(g,!1);I(d);k=b(this);var c=k.offset(),f=u(a)[0]-c.top;a=u(a)[1]-c.left;var h=k.height()+c.top;c=k.width()+c.left;f<h&&0<f&&a<c&&0<a&&(l=f,n=a);X(k,"active",e.autoExpandScrollbar)}}).bind("touchmove."+f,function(b){b.stopImmediatePropagation();
b.preventDefault();var c=k.offset(),d=u(b)[0]-c.top;b=u(b)[1]-c.left;a(l,n,d,b)});b(document).add(p).bind("mousemove."+f+" pointermove."+f+" MSPointerMove."+f,function(b){if(k){var c=k.offset(),d=u(b)[0]-c.top;b=u(b)[1]-c.left;l===d&&n===b||a(l,n,d,b)}}).add(z).bind("mouseup."+f+" touchend."+f+" pointerup."+f+" MSPointerUp."+f,function(a){k&&(X(k,"active",e.autoExpandScrollbar),k=null);x=!1;touchOn=0;q&&(document.onselectstart=null);ia.call(g,!0)})},ra=function(){function a(a){r=0;S=N();z.offset();
u(a);u(a);70<S-P&&(touchOn=0)}function d(a){P=0;if(!T(a)||x||u(a)[2])J=0;else{r=J=touchOn=1;m.removeClass("mCS_touch_action");var b=p.offset();M=u(a)[0]-b.top;B=u(a)[1]-b.left;D=[u(a)[0],u(a)[1]]}}function c(a){if(!clinicFlagTouchMove&&!clinicFlagResize&&T(a)&&!x&&!u(a)[2]&&(l.documentTouchScroll||a.preventDefault(),a.stopImmediatePropagation(),r)){clearTimeout(clinicMoveTimeout);clearInterval(clinicMoveInterval);N();0==P&&(P=N());var b=z.offset(),c=u(a)[0]-b.top;b=u(a)[1]-b.left;var d=q[q.length-
1],e=w[w.length-1];q.push(c);w.push(b);D[2]=Math.abs(u(a)[0]-D[0]);D[3]=Math.abs(u(a)[1]-D[1]);if(k.overflowed[0]){var f=E[0].parent().height()-E[0].height();f=0<M-c&&c-M>-(f*k.scrollRatio.y)&&(2*D[3]<D[2]||"yx"===l.axis)}if(k.overflowed[1]){var h=E[1].parent().width()-E[1].width();h=0<B-b&&b-B>-(h*k.scrollRatio.x)&&(2*D[2]<D[3]||"yx"===l.axis)}f||h?L||a.preventDefault():m.addClass("mCS_touch_action");L&&a.preventDefault();G="yx"===l.axis?[M-c,B-b]:"x"===l.axis?[null,B-b]:[M-c,null];p[0].idleTimer=
250;if(1<q.length){if(!H){if(0==Math.abs(d-c)+Math.abs(e-b))return;H=Math.abs(d-c)>=Math.abs(e-b)?"y":"x"}a=w.length-1;"y"==H?(k.overflowed[0]&&g(G[0],0,"mcsLinearOut","y","all",!0),w[0]=0,w[a]=0):(k.overflowed[1]&&g(G[1],0,"mcsLinearOut","x",F,!0),q[0]=0,q[a]=0)}console.log(H)}}function e(a){if(!T(a)||x||u(a)[2])J=0;else{J=1;a.stopImmediatePropagation();I(m);t=N();var b=z.offset();aa=u(a)[0]-b.top;v=u(a)[1]-b.left;q=[];w=[];H=!1}}function f(a){if(!("touchend"==a.type&&"x"==H&&200<SCHEDULE_DEFAULT_CABINET_WIDTH))if(!T(a)||
x||u(a)[2])touchOn=0;else{r=0;a.stopImmediatePropagation();S=N();var b=z.offset(),c=u(a)[0]-b.top;b=u(a)[1]-b.left;if(!("x"==H&&200<SCHEDULE_DEFAULT_CABINET_WIDTH))if(300<S-P)touchOn=0;else if(!(200<SCHEDULE_DEFAULT_CABINET_WIDTH&&"x"==H)){O=1E3/(S-t);var d=(a=2.5>O)?[q[q.length-2],w[w.length-2]]:[0,0];R=a?[c-d[0],b-d[1]]:[c-aa,b-v];c=[Math.abs(R[0]),Math.abs(R[1])];O=a?[Math.abs(R[0]/4),Math.abs(R[1]/4)]:[O,O];a=[Math.abs(p[0].offsetTop)-R[0]*h(c[0]/O[0],O[0]),Math.abs(p[0].offsetLeft)-R[1]*h(c[1]/
O[1],O[1])];G="yx"===l.axis?[a[0],a[1]]:"x"===l.axis?[null,a[1]]:[a[0],null];y=[4*c[0]+l.scrollInertia,4*c[1]+l.scrollInertia];a=parseInt(l.contentTouchScroll)||0;G[0]=c[0]>a?G[0]:0;G[1]=c[1]>a?G[1]:0;"y"==H?k.overflowed[0]&&g(G[0],y[0],"mcsEaseOut","y",F,!1):k.overflowed[1]&&(G[1]=Math.ceil(G[1]/SCHEDULE_DEFAULT_CABINET_WIDTH)*SCHEDULE_DEFAULT_CABINET_WIDTH,g(G[1],y[1],"mcsEaseOut","x",F,!1))}}}function h(a,b){var c=[1.5*b,2*b,b/1.5,b/2];return 90<a?4<b?c[0]:c[3]:60<a?3<b?c[3]:c[2]:30<a?8<b?c[1]:
6<b?c[0]:4<b?b:c[2]:8<b?b:c[3]}function g(a,b,c,d,e,g){a&&A(m,a.toString(),{dur:b,scrollEasing:c,dir:d,overwrite:e,drag:g})}var m=b(this),k=m.data("mCS"),l=k.opt,n="mCS_"+k.idx,z=b("#mCSB_"+k.idx),p=b("#mCSB_"+k.idx+"_container"),E=[b("#mCSB_"+k.idx+"_dragger_vertical"),b("#mCSB_"+k.idx+"_dragger_horizontal")],r,M,B,aa,v,q=[],w=[],t,P,S,R,O,G,y,F="yx"===l.axis?"none":"all",D=[],K=p.find("iframe"),C=["touchstart."+n+" pointerdown."+n+" MSPointerDown."+n,"touchmove."+n+" pointermove."+n+" MSPointerMove."+
n,"touchend."+n+" pointerup."+n+" MSPointerUp."+n],L=void 0!==document.body.style.touchAction&&""!==document.body.style.touchAction;isMobileDevice||(p.bind("mousedown."+n,function(a){if(!(clinicFlagTouchMove||clinicFlagResize||1!==a.button&&1!==a.which)){var c=b(a.target);c.closest(".calItemDoctorCell.active").length||c.closest(".calVisitCell.active").length||c.closest(".calItemDoctorWorkTime").length&&c.closest(".calItemDoctorWorkTime").prev().hasClass("active")||(P=0,r=J=touchOn=1,m.removeClass("mCS_touch_action"),
c=p.offset(),M=u(a)[0]-c.top,B=u(a)[1]-c.left,D=[u(a)[0],u(a)[1]])}}).bind("mousemove."+n,function(a){if(!(clinicFlagTouchMove||clinicFlagResize||clinicFlagTouchMove||clinicFlagResize||!T(a)||x||u(a)[2])&&(isMobileDevice&&(l.documentTouchScroll||a.preventDefault(),a.stopImmediatePropagation()),r)){clearTimeout(clinicMoveTimeout);clearInterval(clinicMoveInterval);N();0==P&&(P=N());var b=z.offset(),c=u(a)[0]-b.top;b=u(a)[1]-b.left;var d=q[q.length-1],e=w[w.length-1];q.push(c);w.push(b);D[2]=Math.abs(u(a)[0]-
D[0]);D[3]=Math.abs(u(a)[1]-D[1]);if(k.overflowed[0]){var f=E[0].parent().height()-E[0].height();f=0<M-c&&c-M>-(f*k.scrollRatio.y)&&(2*D[3]<D[2]||"yx"===l.axis)}if(k.overflowed[1]){var h=E[1].parent().width()-E[1].width();h=0<B-b&&b-B>-(h*k.scrollRatio.x)&&(2*D[2]<D[3]||"yx"===l.axis)}f||h?L||a.preventDefault():m.addClass("mCS_touch_action");L&&a.preventDefault();G="yx"===l.axis?[M-c,B-b]:"x"===l.axis?[null,B-b]:[M-c,null];p[0].idleTimer=250;H=!1;1<q.length&&(clinicMouseDraggableMCS=!0,H||(H=Math.abs(d-
c)>=Math.abs(e-b)?"y":"x"),a=w.length-1,"y"==H?(k.overflowed[0]&&g(G[0],0,"mcsLinearOut","y","all",!0),w[0]=0,w[a]=0):(k.overflowed[1]&&g(G[1],0,"mcsLinearOut","x",F,!0),q[0]=0,q[a]=0))}}),z.bind("mousedown."+n,function(a){if(!(clinicFlagTouchMove||clinicFlagResize||1!==a.button&&1!==a.which||b(a.target).closest(".active").length)){a.stopImmediatePropagation();I(m);t=N();var c=z.offset();aa=u(a)[0]-c.top;v=u(a)[1]-c.left;q=[];w=[];H=!1}}).bind("mouseup."+n,function(c){clinicFlagTouchMove||clinicFlagResize||
1!==c.button&&1!==c.which||b(c.target).closest(".active").length||(setTimeout(function(){clinicMouseDraggableMCS=!1},100),a(c))}),b(document).bind("mouseup",function(c){!clinicMouseDraggableMCS||clinicFlagTouchMove||clinicFlagResize||1!==c.button&&1!==c.which||b(c.target).closest(".active").length||(setTimeout(function(){clinicMouseDraggableMCS=!1},100),a(c))}));p.bind(C[0],function(a){clearTimeout(touchOffTimeout);touchOffTimeout=null;d(a)}).bind(C[1],function(a){clearTimeout(touchOffTimeout);touchOffTimeout=
null;c(a)});z.bind(C[0],function(a){clearTimeout(touchOffTimeout);touchOffTimeout=null;e(a)}).bind(C[2],function(a){clearTimeout(touchOffTimeout);touchOffTimeout=null;touchOffTimeout=setTimeout(function(){touchOn=0},3E3);f(a)});K.length&&K.each(function(){b(this).bind("load",function(){Q(this)&&b(this.contentDocument||this.contentWindow.document).bind(C[0],function(a){d(a);e(a)}).bind(C[1],function(a){c(a)}).bind(C[2],function(a){f(a)})})});var H=!1},sa=function(){function a(a,c,b){f.type=b&&k?"stepped":
"stepless";f.scrollAmount=10;ba(d,a,c,"mcsLinearOut",b?60:null)}var d=b(this),c=d.data("mCS"),e=c.opt,f=c.sequential,h="mCS_"+c.idx,g=b("#mCSB_"+c.idx+"_container"),m=g.parent(),k;g.bind("mousedown."+h,function(a){J||k||(k=1,x=!0)}).add(document).bind("mousemove."+h,function(b){if(!J&&k&&(window.getSelection?window.getSelection().toString():document.selection&&"Control"!=document.selection.type&&document.selection.createRange().text)){var d=g.offset(),h=u(b)[0]-d.top+g[0].offsetTop;b=u(b)[1]-d.left+
g[0].offsetLeft;0<h&&h<m.height()&&0<b&&b<m.width()?f.step&&a("off",null,"stepped"):("x"!==e.axis&&c.overflowed[0]&&(0>h?a("on",38):h>m.height()&&a("on",40)),"y"!==e.axis&&c.overflowed[1]&&(0>b?a("on",37):b>m.width()&&a("on",39)))}}).bind("mouseup."+h+" dragend."+h,function(b){J||(k&&(k=0,a("off",null)),x=!1)})},ta=function(){function a(a,f){touchOn=0;I(d);l&&clearTimeout(n);n=setTimeout(function(){l=!1},20);l?e.mouseWheel.axis=l:(e.mouseWheel.axis=Math.abs(a.deltaY)>=Math.abs(a.deltaX)?"y":"x",l=
e.mouseWheel.axis);if(za(d,a.target))return!1;var m="auto"!==e.mouseWheel.deltaFactor?parseInt(e.mouseWheel.deltaFactor):q&&100>a.deltaFactor?100:a.deltaFactor||100,p=e.scrollInertia;if("x"===e.axis||"x"===e.mouseWheel.axis){var z="x";m=[Math.round(m*c.scrollRatio.x),parseInt(e.mouseWheel.scrollAmount)];m="auto"!==e.mouseWheel.scrollAmount?m[1]:m[0]>=h.width()?.9*h.width():m[0];var B=Math.abs(b("#mCSB_"+c.idx+"_container")[0].offsetLeft),r=g[1][0].offsetLeft,v=Math.round((g[1].parent().width()-g[1].width())/
SCHEDULE_DEFAULT_CABINET_WIDTH)*SCHEDULE_DEFAULT_CABINET_WIDTH;v=g[1].parent().width()-g[1].width();f=-(a.deltaX||f)}else z="y",m=[Math.round(m*c.scrollRatio.y),parseInt(e.mouseWheel.scrollAmount)],m="auto"!==e.mouseWheel.scrollAmount?m[1]:m[0]>=h.height()?.9*h.height():m[0],B=Math.abs(b("#mCSB_"+c.idx+"_container")[0].offsetTop),r=g[0][0].offsetTop,v=g[0].parent().height()-g[0].height(),f=a.deltaY||f;if("y"===z&&!c.overflowed[0]||"x"===z&&!c.overflowed[1])return 0==r&&"x"==z&&0<f&&(a.stopImmediatePropagation(),
a.preventDefault()),!1;if(e.mouseWheel.invert||a.webkitDirectionInvertedFromDevice)f=-f;e.mouseWheel.normalizeDelta&&(f=0>f?-1:1);if(0<f&&0!==r||0>f&&r!==v||e.mouseWheel.preventDefault)a.stopImmediatePropagation(),a.preventDefault();else if(0==r&&"x"==z&&0<f)return a.stopImmediatePropagation(),a.preventDefault(),!1;5>a.deltaFactor&&!e.mouseWheel.normalizeDelta&&(m=a.deltaFactor,p=17);k&&(0==B&&0<f||("x"===z&&(Math.abs(f*m)>=SCHEDULE_DEFAULT_CABINET_WIDTH||useSkipMouseWheel)?A(d,(Math.round((B-f*m)/
SCHEDULE_DEFAULT_CABINET_WIDTH)*SCHEDULE_DEFAULT_CABINET_WIDTH).toString(),{dir:z,dur:p}):A(d,(1*Math.round(B-f*m)).toString(),{dir:z,dur:p})));return"undefined"==typeof m?!1:m*f}if(b(this).data("mCS")){var d=b(this),c=d.data("mCS"),e=c.opt,f="mCS_"+c.idx,h=b("#mCSB_"+c.idx),g=[b("#mCSB_"+c.idx+"_dragger_vertical"),b("#mCSB_"+c.idx+"_dragger_horizontal")],m=b("#mCSB_"+c.idx+"_container").find("iframe");m.length&&m.each(function(){b(this).bind("load",function(){Q(this)&&b(this.contentDocument||this.contentWindow.document).bind("mousewheel."+
f,function(b,c){a(b,c)})})});h.bind("mousewheel."+f,function(b,c){0!=a(b,c)?(navigator.platform.indexOf("Mac"),clearInterval(scheduleMouseWheelInterval),scheduleMouseWheelInterval=null,clearTimeout(scheduleMouseWheelTimeout),scheduleMouseWheelTimeout=null,useSkipMouseWheel||(clearInterval(scheduleMouseWheelInterval),scheduleMouseWheelInterval=null,scheduleMouseWheelTimeout=setTimeout(function(){clearTimeout(scheduleMouseWheelTimeout);scheduleMouseWheelTimeout=null},1E6))):(clearInterval(scheduleMouseWheelInterval),
scheduleMouseWheelInterval=null,clearTimeout(scheduleMouseWheelTimeout),scheduleMouseWheelTimeout=null)});var k=!0,l=!1,n=!1}},ca={},Q=function(a){var d=!1,c=null;void 0===a?d="#empty":void 0!==b(a).attr("id")&&(d=b(a).attr("id"));if(!1!==d&&void 0!==ca[d])return ca[d];if(a)try{e=a.contentDocument||a.contentWindow.document,c=e.body.innerHTML}catch(f){}else try{var e=top.document;c=e.body.innerHTML}catch(f){}a=null!==c;!1!==d&&(ca[d]=a);return a},ia=function(a){var b=this.find("iframe");b.length&&
b.css("pointer-events",a?"auto":"none")},za=function(a,d){var c=d.nodeName.toLowerCase();a=a.data("mCS").opt.mouseWheel.disableOver;var e=["select","textarea"];return-1<b.inArray(c,a)&&!(-1<b.inArray(c,e)&&!b(d).is(":focus"))},ua=function(){var a=b(this),d=a.data("mCS"),c="mCS_"+d.idx,e=b("#mCSB_"+d.idx+"_container"),f=e.parent(),h;b(".mCSB_"+d.idx+"_scrollbar ."+p[12]).bind("mousedown."+c+" touchstart."+c+" pointerdown."+c+" MSPointerDown."+c,function(a){x=!0;b(a.target).hasClass("mCSB_dragger")||
(h=1)}).bind("touchend."+c+" pointerup."+c+" MSPointerUp."+c,function(a){x=!1}).bind("click."+c,function(c){if(h&&(h=0,b(c.target).hasClass(p[12])||b(c.target).hasClass("mCSB_draggerRail"))){I(a);var g=b(this),k=g.find(".mCSB_dragger");if(0<g.parent(".mCSB_scrollTools_horizontal").length){if(!d.overflowed[1])return;g="x";c=c.pageX>k.offset().left?-1:1;c=Math.abs(e[0].offsetLeft)-.9*c*f.width()}else{if(!d.overflowed[0])return;g="y";c=c.pageY>k.offset().top?-1:1;c=Math.abs(e[0].offsetTop)-.9*c*f.height()}A(a,
c.toString(),{dir:g,scrollEasing:"mcsEaseInOut"})}})},wa=function(){var a=b(this),d=a.data("mCS"),c=d.opt,e="mCS_"+d.idx,f=b("#mCSB_"+d.idx+"_container"),h=f.parent();f.bind("focusin."+e,function(d){var e=b(document.activeElement);d=f.find(".mCustomScrollBox").length;e.is(c.advanced.autoScrollOnFocus)&&(I(a),clearTimeout(a[0]._focusTimeout),a[0]._focusTimer=d?17*d:0,a[0]._focusTimeout=setTimeout(function(){var b=[y(e)[0],y(e)[1]],d=[f[0].offsetTop,f[0].offsetLeft];d=[0<=d[0]+b[0]&&d[0]+b[0]<h.height()-
e.outerHeight(!1),0<=d[1]+b[1]&&d[0]+b[1]<h.width()-e.outerWidth(!1)];var g="yx"!==c.axis||d[0]||d[1]?"all":"none";"x"===c.axis||d[0]||A(a,b[0].toString(),{dir:"y",scrollEasing:"mcsEaseInOut",overwrite:g,dur:0});"y"===c.axis||d[1]||A(a,b[1].toString(),{dir:"x",scrollEasing:"mcsEaseInOut",overwrite:g,dur:0})},a[0]._focusTimer))})},va=function(){var a=b(this).data("mCS"),d="mCS_"+a.idx,c=b("#mCSB_"+a.idx+"_container").parent();c.bind("scroll."+d,function(d){0===c.scrollTop()&&0===c.scrollLeft()||b(".mCSB_"+
a.idx+"_scrollbar").css("visibility","hidden")})},xa=function(){var a=b(this),d=a.data("mCS"),c=d.opt,e=d.sequential,f="mCS_"+d.idx;b(".mCSB_"+d.idx+"_scrollbar>a").bind("contextmenu."+f,function(a){a.preventDefault()}).bind("mousedown."+f+" touchstart."+f+" pointerdown."+f+" MSPointerDown."+f+" mouseup."+f+" touchend."+f+" pointerup."+f+" MSPointerUp."+f+" mouseout."+f+" pointerout."+f+" MSPointerOut."+f+" click."+f,function(f){function g(b,d){e.scrollAmount=c.scrollButtons.scrollAmount;ba(a,b,d)}
f.preventDefault();if(!f.which||1===f.which){var h=b(this).attr("class");e.type=c.scrollButtons.scrollType;switch(f.type){case "mousedown":case "touchstart":case "pointerdown":case "MSPointerDown":if("stepped"===e.type)break;x=!0;d.tweenRunning=!1;g("on",h);break;case "mouseup":case "touchend":case "pointerup":case "MSPointerUp":case "mouseout":case "pointerout":case "MSPointerOut":if("stepped"===e.type)break;x=!1;e.dir&&g("off",h);break;case "click":"stepped"!==e.type||d.tweenRunning||g("on",h)}}})},
ya=function(){function a(a){function g(a,b){f.type=e.keyboard.scrollType;f.scrollAmount=SCHEDULE_DEFAULT_CABINET_WIDTH;"stepped"===f.type&&c.tweenRunning||ba(d,a,b)}switch(a.type){case "blur":c.tweenRunning&&f.dir&&g("off",null);break;case "keydown":case "keyup":var h=a.keyCode?a.keyCode:a.which,l="on";if("x"!==e.axis&&(38===h||40===h)){if(38!==h&&40!==h||c.overflowed[0])"keyup"===a.type&&(l="off"),b(document.activeElement).is("input,textarea,select,datalist,keygen,[contenteditable='true']")||(a.preventDefault(),
a.stopImmediatePropagation(),g(l,h))}else if("y"!==e.axis&&(37===h||39===h)){if(c.overflowed[0]||c.overflowed[1])a.preventDefault(),a.stopImmediatePropagation();"keyup"===a.type&&(I(d),l=37===h?-1:1,h=Math.ceil(-m[0].offsetLeft/SCHEDULE_DEFAULT_CABINET_WIDTH/scheduleCabinetPerDay)*SCHEDULE_DEFAULT_CABINET_WIDTH*scheduleCabinetPerDay+scheduleCabinetPerDay*SCHEDULE_DEFAULT_CABINET_WIDTH*(37===h?-1:1),A(d,h.toString(),{dir:"x",scrollEasing:"mcsEaseInOut"}))}else if(33===h||34===h){if(c.overflowed[0]||
c.overflowed[1])a.preventDefault(),a.stopImmediatePropagation();"keyup"===a.type&&(I(d),l=34===h?-1:1,"x"===e.axis||"yx"===e.axis&&c.overflowed[1]&&!c.overflowed[0]?(a="x",h=Math.ceil(-m[0].offsetLeft/SCHEDULE_DEFAULT_CABINET_WIDTH/scheduleCabinetPerDay)*SCHEDULE_DEFAULT_CABINET_WIDTH*scheduleCabinetPerDay+scheduleCabinetPerDay*SCHEDULE_DEFAULT_CABINET_WIDTH*(34===h?-1:1)):(a="y",h=Math.abs(m[0].offsetTop)-.9*l*k.height()),A(d,h.toString(),{dir:a,scrollEasing:"mcsEaseInOut"}))}else if((35===h||36===
h)&&!b(document.activeElement).is("input,textarea,select,datalist,keygen,[contenteditable='true']")){if(c.overflowed[0]||c.overflowed[1])a.preventDefault(),a.stopImmediatePropagation();"keyup"===a.type&&("x"===e.axis||"yx"===e.axis&&c.overflowed[1]&&!c.overflowed[0]?(a="x",h=35===h?Math.abs(k.width()-m.outerWidth(!1)):0):(a="y",h=35===h?Math.abs(k.height()-m.outerHeight(!1)):0),A(d,h.toString(),{dir:a,scrollEasing:"mcsEaseInOut"}))}}}var d=b(this),c=d.data("mCS"),e=c.opt,f=c.sequential,h="mCS_"+c.idx,
g=b("#mCSB_"+c.idx),m=b("#mCSB_"+c.idx+"_container"),k=m.parent(),l=m.find("iframe"),n=["blur."+h+" keydown."+h+" keyup."+h];l.length&&l.each(function(){b(this).bind("load",function(){Q(this)&&b(this.contentDocument||this.contentWindow.document).bind(n[0],function(b){a(b)})})});g.attr("tabindex","0").bind(n[0],function(b){a(b)})},ba=function(a,d,c,e,f){function h(b){m.snapAmount&&(k.scrollAmount=m.snapAmount instanceof Array?"x"===k.dir[0]?m.snapAmount[1]:m.snapAmount[0]:m.snapAmount);var c="stepped"!==
k.type,d=f?f:b?c?r/1.5:q:1E3/60,n=b?c?7.5:40:2.5,p=[Math.abs(l[0].offsetTop),Math.abs(l[0].offsetLeft)],v=[10<g.scrollRatio.y?10:g.scrollRatio.y,10<g.scrollRatio.x?10:g.scrollRatio.x];n="x"===k.dir[0]?p[1]+k.dir[1]*v[1]*n:p[0]+k.dir[1]*v[0]*n;v="x"===k.dir[0]?p[1]+k.dir[1]*parseInt(k.scrollAmount):p[0]+k.dir[1]*parseInt(k.scrollAmount);n="auto"!==k.scrollAmount?v:n;c=e?e:b?c?"mcsLinearOut":"mcsEaseInOut":"mcsLinear";b&&17>d&&(n="x"===k.dir[0]?p[1]:p[0]);A(a,n.toString(),{dir:k.dir[0],scrollEasing:c,
dur:d,onComplete:b?!0:!1,onCompleteFixScroll:b?!0:!1});b?k.dir=!1:(clearTimeout(k.step),k.step=setTimeout(function(){h()},d))}var g=a.data("mCS"),m=g.opt,k=g.sequential,l=b("#mCSB_"+g.idx+"_container"),n="stepped"===k.type?!0:!1,r=26>m.scrollInertia?26:m.scrollInertia,q=1>m.scrollInertia?17:m.scrollInertia;switch(d){case "on":k.dir=[c===p[16]||c===p[15]||39===c||37===c?"x":"y",c===p[13]||c===p[15]||38===c||37===c?-1:1];I(a);V(c);h(n);break;case "off":clearTimeout(k.step),C(k,"step"),I(a),(n||g.tweenRunning&&
k.dir)&&h(!0)}},Z=function(a){var d=b(this).data("mCS").opt,c=[];"function"===typeof a&&(a=a());a instanceof Array?c=1<a.length?[a[0],a[1]]:"x"===d.axis?[null,a[0]]:[a[0],null]:(c[0]=a.y?a.y:a.x||"x"===d.axis?null:a,c[1]=a.x?a.x:a.y||"y"===d.axis?null:a);"function"===typeof c[0]&&(c[0]=c[0]());"function"===typeof c[1]&&(c[1]=c[1]());return c},ha=function(a,d){if(null!=a&&"undefined"!=typeof a){var c=b(this),e=c.data("mCS"),f=e.opt;e=b("#mCSB_"+e.idx+"_container");var h=e.parent(),g=typeof a;d||(d=
"x"===f.axis?"x":"y");f="x"===d?e.outerWidth(!1)-h.width():e.outerHeight(!1)-h.height();var m="x"===d?e[0].offsetLeft:e[0].offsetTop,k="x"===d?"left":"top";switch(g){case "function":return a();case "object":a=a.jquery?a:b(a);if(!a.length)break;return"x"===d?y(a)[1]:y(a)[0];case "string":case "number":if(V(a))return Math.abs(a);if(-1!==a.indexOf("%"))return Math.abs(f*parseInt(a)/100);if(-1!==a.indexOf("-="))return Math.abs(m-parseInt(a.split("-=")[1]));if(-1!==a.indexOf("+="))return d=m+parseInt(a.split("+=")[1]),
0<=d?0:Math.abs(d);if(-1!==a.indexOf("px")&&V(a.split("px")[0]))return Math.abs(a.split("px")[0]);if("top"===a||"left"===a)return 0;if("bottom"===a)return Math.abs(h.height()-e.outerHeight(!1));if("right"===a)return Math.abs(h.width()-e.outerWidth(!1));if("first"===a||"last"===a)return a=e.find(":"+a),"x"===d?y(a)[1]:y(a)[0];if(b(a).length)return"x"===d?y(b(a))[1]:y(b(a))[0];e.css(k,a);F.update.call(null,c[0])}}},Y=function(a){function d(){clearTimeout(m[0].autoUpdate);0===f.parents("html").length?
f=null:m[0].autoUpdate=setTimeout(function(){if(g.advanced.updateOnSelectorChange&&(h.poll.change.n=c(),h.poll.change.n!==h.poll.change.o)){h.poll.change.o=h.poll.change.n;e(3);return}if(g.advanced.updateOnContentResize&&(h.poll.size.n=f[0].scrollHeight+f[0].scrollWidth+m[0].offsetHeight+f[0].offsetHeight+f[0].offsetWidth,h.poll.size.n!==h.poll.size.o)){h.poll.size.o=h.poll.size.n;e(1);return}if(g.advanced.updateOnImageLoad&&("auto"!==g.advanced.updateOnImageLoad||"y"!==g.axis)&&(h.poll.img.n=m.find("img").length,
h.poll.img.n!==h.poll.img.o)){h.poll.img.o=h.poll.img.n;m.find("img").each(function(){});return}(g.advanced.updateOnSelectorChange||g.advanced.updateOnContentResize||g.advanced.updateOnImageLoad)&&d()},g.advanced.autoUpdateTimeout)}function c(){!0===g.advanced.updateOnSelectorChange&&(g.advanced.updateOnSelectorChange="*");var a=0,b=m.find(g.advanced.updateOnSelectorChange);g.advanced.updateOnSelectorChange&&0<b.length&&b.each(function(){a+=this.offsetHeight+this.offsetWidth});return a}function e(a){clearTimeout(m[0].autoUpdate);
F.update.call(null,f[0],a)}var f=b(this),h=f.data("mCS"),g=h.opt,m=b("#mCSB_"+h.idx+"_container");a?(clearTimeout(m[0].autoUpdate),C(m[0],"autoUpdate")):d()},I=function(a){a=a.data("mCS");b("#mCSB_"+a.idx+"_container,#mCSB_"+a.idx+"_container_wrapper,#mCSB_"+a.idx+"_dragger_vertical,#mCSB_"+a.idx+"_dragger_horizontal").each(function(){this._mTween||(this._mTween={top:{},left:{}});for(var a=["top","left"],b=0;b<a.length;b++){var e=a[b];this._mTween[e].id&&(window.requestAnimationFrame?window.cancelAnimationFrame(this._mTween[e].id):
clearTimeout(this._mTween[e].id),this._mTween[e].id=null,this._mTween[e].stop=1)}})},A=function(a,d,c){function e(a){return h&&g.callbacks[a]&&"function"===typeof g.callbacks[a]}function f(){var b=[l[0].offsetTop,l[0].offsetLeft],d=[q[0].offsetTop,q[0].offsetLeft],e=[l.outerHeight(!1),l.outerWidth(!1)],f=[k.height(),k.width()];a[0].mcs={content:l,top:b[0],left:b[1],draggerTop:d[0],draggerLeft:d[1],topPct:Math.round(100*Math.abs(b[0])/(Math.abs(e[0])-f[0])),leftPct:Math.round(100*Math.abs(b[1])/(Math.abs(e[1])-
f[1])),direction:c.dir}}calendar.tooltipSelect2IsOpened&&(calendar.tooltipSelect2IsOpened=!1,b(".scheduleTooltipVisitStatusSelectContainer select").select2("close"));var h=a.data("mCS"),g=h.opt;c=b.extend({trigger:"internal",dir:"y",scrollEasing:"mcsEaseOut",drag:!1,dur:g.scrollInertia,overwrite:"all",callbacks:!0,onStart:!0,onUpdate:!0,onComplete:!0},c);var m=[c.dur,c.drag?0:c.dur],k=b("#mCSB_"+h.idx),l=b("#mCSB_"+h.idx+"_container"),n=l.parent(),p=g.callbacks.onTotalScrollOffset?Z.call(a,g.callbacks.onTotalScrollOffset):
[0,0],r=g.callbacks.onTotalScrollBackOffset?Z.call(a,g.callbacks.onTotalScrollBackOffset):[0,0];h.trigger=c.trigger;if(0!==n.scrollTop()||0!==n.scrollLeft())b(".mCSB_"+h.idx+"_scrollbar").css("visibility","visible"),n.scrollTop(0).scrollLeft(0);"_resetY"!==d||h.contentReset.y||(e("onOverflowYNone")&&g.callbacks.onOverflowYNone.call(a[0]),h.contentReset.y=1);"_resetX"!==d||h.contentReset.x||(e("onOverflowXNone")&&g.callbacks.onOverflowXNone.call(a[0]),h.contentReset.x=1);if("_resetY"!==d&&"_resetX"!==
d){!h.contentReset.y&&a[0].mcs||!h.overflowed[0]||(e("onOverflowY")&&g.callbacks.onOverflowY.call(a[0]),h.contentReset.x=null);!h.contentReset.x&&a[0].mcs||!h.overflowed[1]||(e("onOverflowX")&&g.callbacks.onOverflowX.call(a[0]),h.contentReset.x=null);g.snapAmount&&(n=g.snapAmount instanceof Array?"x"===c.dir?g.snapAmount[1]:g.snapAmount[0]:g.snapAmount,d=Math.round(d/n)*n-g.snapOffset);switch(c.dir){case "x":var q=b("#mCSB_"+h.idx+"_dragger_horizontal"),v="left",u=l[0].offsetLeft,B=[k.width()-l.outerWidth(!1),
q.parent().width()-q.width()],t=[d,0===d?0:d/h.scrollRatio.x],x=p[1],y=r[1],w=0<x?x/h.scrollRatio.x:0,C=0<y?y/h.scrollRatio.x:0;break;case "y":q=b("#mCSB_"+h.idx+"_dragger_vertical"),v="top",u=l[0].offsetTop,B=[k.height()-l.outerHeight(!1),q.parent().height()-q.height()],t=[d,0===d?0:d/h.scrollRatio.y],x=p[0],y=r[0],w=0<x?x/h.scrollRatio.y:0,C=0<y?y/h.scrollRatio.y:0}0>t[1]||0===t[0]&&0===t[1]?t=[0,0]:t[1]>=B[1]?t=[B[0],B[1]]:t[0]=-t[0];a[0].mcs||(f(),e("onInit")&&g.callbacks.onInit.call(a[0]));clearTimeout(l[0].onCompleteTimeout);
ja(q[0],v,Math.round(t[1]),m[1],c.scrollEasing);!h.tweenRunning&&(0===u&&0<=t[0]||u===B[0]&&t[0]<=B[0])||ja(l[0],v,Math.round(t[0]),m[0],c.scrollEasing,c.overwrite,{onStart:function(){c.callbacks&&c.onStart&&!h.tweenRunning&&(e("onScrollStart")&&(f(),g.callbacks.onScrollStart.call(a[0])),h.tweenRunning=!0,X(q),h.cbOffsets=[g.callbacks.alwaysTriggerOffsets||u>=B[0]+x,g.callbacks.alwaysTriggerOffsets||u<=-y])},onUpdate:function(){c.callbacks&&c.onUpdate&&e("whileScrolling")&&(f(),g.callbacks.whileScrolling.call(a[0]))},
onComplete:function(){c.callbacks&&c.onComplete&&("yx"===g.axis&&clearTimeout(l[0].onCompleteTimeout),l[0].onCompleteTimeout=setTimeout(function(){e("onScroll")&&(f(),g.callbacks.onScroll.call(a[0]));e("onTotalScroll")&&t[1]>=B[1]-w&&h.cbOffsets[0]&&(f(),g.callbacks.onTotalScroll.call(a[0]));e("onTotalScrollBack")&&t[1]<=C&&h.cbOffsets[1]&&(f(),g.callbacks.onTotalScrollBack.call(a[0]));h.tweenRunning=!1;l[0].idleTimer=0;X(q,"hide")},l[0].idleTimer||0))},onCompleteFixScroll:function(){if(isMobileDevice){if(0!=
l[0].offsetLeft%SCHEDULE_DEFAULT_CABINET_WIDTH&&b(l[0]).parent().width()-l[0].offsetLeft!=b(l[0]).width())if(isMobileDevice&&"undefined"!=typeof SCHEDULE_EVENT_DRAG_RELEASE_BLOCK){var c=0;null!=calendar.$ACTIVE_VISIT?c=parseInt(calendar.$ACTIVE_VISIT.css("left")):null!=calendar.$ACTIVE_SHIFT&&(c=parseInt(calendar.$ACTIVE_SHIFT.css("left")));A(a,c,{dir:"x",drag:!0});setTimeout(function(){delete SCHEDULE_EVENT_DRAG_RELEASE_BLOCK},100)}else 0<xDirection?A(a,-Math.floor(l[0].offsetLeft/SCHEDULE_DEFAULT_CABINET_WIDTH)*
SCHEDULE_DEFAULT_CABINET_WIDTH,{dir:"x",drag:!0}):A(a,-Math.ceil(l[0].offsetLeft/SCHEDULE_DEFAULT_CABINET_WIDTH)*SCHEDULE_DEFAULT_CABINET_WIDTH,{dir:"x",drag:!0});touchOn=0;lockFixScroll=!0;setTimeout(function(){lockFixScroll=!1},100)}}})}},ja=function(a,b,c,e,f,h,g){function d(){if(!w.stop)if(u||n.call(),u=N()-v,k(),u>=w.time&&(w.time=u>w.time?u+t-(u-w.time):u+t-1,w.time<u+1&&(w.time=u+1)),w.time<e)w.id=C(d);else if(q.call(),x||touchOn||scheduleScrollonCompleteInterval)clearInterval(scheduleScrollonCompleteInterval),
scheduleScrollonCompleteInterval=null,scheduleScrollonCompleteInterval=setInterval(function(){x||touchOn||(clearInterval(scheduleScrollonCompleteInterval),scheduleScrollonCompleteInterval=null,r.call())},1);else if(!scheduleMouseWheelTimeout)r.call();else if(!scheduleMouseWheelInterval&&r!=emptyFunction){var a=r;clearInterval(scheduleMouseWheelInterval);scheduleMouseWheelInterval=null;scheduleMouseWheelInterval=setInterval(function(){scheduleMouseWheelTimeout||(a.call(),clearInterval(scheduleMouseWheelInterval),
scheduleMouseWheelInterval=null)},1)}}function k(){0<e?(w.currVal=l(w.time,y,F,e,f),A[b]=Math.round(w.currVal)+"px"):A[b]=c+"px";p.call()}function l(a,b,c,d,e){switch(e){case "linear":case "mcsLinear":return c*a/d+b;case "mcsLinearOut":return a/=d,a--,c*Math.sqrt(1-a*a)+b;case "easeInOutSmooth":a/=d/2;if(1>a)return c/2*a*a+b;a--;return-c/2*(a*(a-2)-1)+b;case "easeInOutStrong":a/=d/2;if(1>a)return c/2*Math.pow(2,10*(a-1))+b;a--;return c/2*(-Math.pow(2,-10*a)+2)+b;case "easeInOut":case "mcsEaseInOut":a/=
d/2;if(1>a)return c/2*a*a*a+b;a-=2;return c/2*(a*a*a+2)+b;case "easeOutSmooth":return a/=d,a--,-c*(a*a*a*a-1)+b;case "easeOutStrong":return c*(-Math.pow(2,-10*a/d)+1)+b;default:return d=(a/=d)*a,e=d*a,b+c*(.499999999999997*e*d+-2.5*d*d+5.5*e+-6.5*d+4*a)}}"undefined"!=typeof a.style?3<Math.abs(parseInt(a.style.left)-c)&&(xDirection=parseInt(a.style.left)>c?1:-1):xDirection=0>c?1:-1;a._mTween||(a._mTween={top:{},left:{}});g=g||{};var n=g.onStart||emptyFunction,p=g.onUpdate||emptyFunction,q=g.onComplete||
emptyFunction,r=g.onCompleteFixScroll||emptyFunction,v=N(),t,u=0,y=a.offsetTop,A=a.style,C,w=a._mTween[b];"left"===b&&(y=a.offsetLeft);var F=c-y;w.stop=0;"none"!==h&&null!=w.id&&(window.requestAnimationFrame?window.cancelAnimationFrame(w.id):clearTimeout(w.id),w.id=null);(function(){t=1E3/60;w.time=u+t;C=window.requestAnimationFrame?window.requestAnimationFrame:function(a){k();return setTimeout(a,.01)};w.id=C(d)})()},N=function(){return window.performance&&window.performance.now?window.performance.now():
window.performance&&window.performance.webkitNow?window.performance.webkitNow():Date.now?Date.now():(new Date).getTime()},C=function(a,b){try{delete a[b]}catch(c){a[b]=null}},T=function(a){a=a.originalEvent.pointerType;return!(a&&"touch"!==a&&2!==a)},V=function(a){return!isNaN(parseFloat(a))&&isFinite(a)},y=function(a){var b=a.parents(".mCSB_container");return[a.offset().top-b.offset().top,a.offset().left-b.offset().left]},pa=function(){var a=function(){var a=["webkit","moz","ms","o"];if("hidden"in
document)return"hidden";for(var b=0;b<a.length;b++)if(a[b]+"Hidden"in document)return a[b]+"Hidden";return null}();return a?document[a]:!1};b.fn.mCustomScrollbar=function(a){if(F[a])return F[a].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof a&&a)b.error("Method "+a+" does not exist");else return F.init.apply(this,arguments)};b.mCustomScrollbar=function(a){if(F[a])return F[a].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof a&&a)b.error("Method "+a+
" does not exist");else return F.init.apply(this,arguments)};b.mCustomScrollbar.defaults=v;window.mCustomScrollbar=!0;b(window).bind("load",function(){b(".mCustomScrollbar").mCustomScrollbar();b.extend(b.expr[":"],{mcsInView:b.expr[":"].mcsInView||function(a){a=b(a);var d=a.parents(".mCSB_container");if(d.length){var c=d.parent();d=[d[0].offsetTop,d[0].offsetLeft];return 0<=d[0]+y(a)[0]&&d[0]+y(a)[0]<c.height()-a.outerHeight(!1)&&0<=d[1]+y(a)[1]&&d[1]+y(a)[1]<c.width()-a.outerWidth(!1)}},mcsInSight:b.expr[":"].mcsInSight||
function(a,d,c){d=b(a);a=d.parents(".mCSB_container");var e="exact"===c[3]?[[1,0],[1,0]]:[[.9,.1],[.6,.4]];if(a.length)return c=[d.outerHeight(!1),d.outerWidth(!1)],d=[a[0].offsetTop+y(d)[0],a[0].offsetLeft+y(d)[1]],a=[a.parent()[0].offsetHeight,a.parent()[0].offsetWidth],e=[c[0]<a[0]?e[0]:e[1],c[1]<a[1]?e[0]:e[1]],0>d[0]-a[0]*e[0][0]&&0<=d[0]+c[0]-a[0]*e[0][1]&&0>d[1]-a[1]*e[1][0]&&0<=d[1]+c[1]-a[1]*e[1][1]},mcsOverflow:b.expr[":"].mcsOverflow||function(a){if(a=b(a).data("mCS"))return a.overflowed[0]||
a.overflowed[1]}})})})});
;
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){if(a==Array.prototype||a==Object.prototype)return a;a[b]=c.value;return a};$jscomp.getGlobal=function(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var c=a[b];if(c&&c.Math==Math)return c}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(a,b){var c=$jscomp.propertyToPolyfillSymbol[b];if(null==c)return a[b];c=a[c];return void 0!==c?c:a[b]};
$jscomp.polyfill=function(a,b,c,d){b&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(a,b,c,d):$jscomp.polyfillUnisolated(a,b,c,d))};$jscomp.polyfillUnisolated=function(a,b,c,d){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})};
$jscomp.polyfillIsolated=function(a,b,c,d){var e=a.split(".");a=1===e.length;d=e[0];d=!a&&d in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var f=0;f<e.length-1;f++){var g=e[f];g in d||(d[g]={});d=d[g]}e=e[e.length-1];c=$jscomp.IS_SYMBOL_NATIVE&&"es6"===c?d[e]:null;b=b(c);null!=b&&(a?$jscomp.defineProperty($jscomp.polyfills,e,{configurable:!0,writable:!0,value:b}):b!==c&&($jscomp.propertyToPolyfillSymbol[e]=$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(e):$jscomp.POLYFILL_PREFIX+e,e=$jscomp.propertyToPolyfillSymbol[e],
$jscomp.defineProperty(d,e,{configurable:!0,writable:!0,value:b})))};$jscomp.initSymbol=function(){};
$jscomp.polyfill("Symbol",function(a){if(a)return a;var b=function(a,b){this.$jscomp$symbol$id_=a;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:b})};b.prototype.toString=function(){return this.$jscomp$symbol$id_};var c=0,d=function(a){if(this instanceof d)throw new TypeError("Symbol is not a constructor");return new b("jscomp_symbol_"+(a||"")+"_"+c++,a)};return d},"es6","es3");$jscomp.initSymbolIterator=function(){};
$jscomp.polyfill("Symbol.iterator",function(a){if(a)return a;a=Symbol("Symbol.iterator");for(var b="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),c=0;c<b.length;c++){var d=$jscomp.global[b[c]];"function"===typeof d&&"function"!=typeof d.prototype[a]&&$jscomp.defineProperty(d.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}})}return a},"es6",
"es3");$jscomp.initSymbolAsyncIterator=function(){};$jscomp.iteratorPrototype=function(a){a={next:a};a[Symbol.iterator]=function(){return this};return a};$jscomp.iteratorFromArray=function(a,b){a instanceof String&&(a+="");var c=0,d={next:function(){if(c<a.length){var e=c++;return{value:b(e,a[e]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};
$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");$jscomp.findInternal=function(a,b,c){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var f=a[e];if(b.call(c,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6","es3");var calendar={};SCHEDULE_VIEW_STANDARD=1;
SCHEDULE_VIEW_DOCTORS=2;SCHEDULE_DEFAULT_CABINET_WIDTH=200;var SCHEDULE_VIEW_TYPE_VISITS=0,SCHEDULE_VIEW_TYPE_ASSISTANTS=1,SCHEDULE_VIEW_TYPE_ADMINISTRATORS=2;function calendarBlock(a,b,c,d,e,f,g,p){this.id=g;this.top=b;this.bottom=c;this.type=d;this.db_id=p;this.column=a;this.next=e;this.prev=f}function intersects(a,b){return a.y<b.y1||a.y1>b.y||a.x1<b.x||a.x>b.x1}function intersectsY(a,b){return!(a[1]<=b[0]||a[0]>=b[1])}function intersectsY1(a,b){return a[0]<b[1]||a[1]>b[0]}
function intersectsTime(a,b,c,d){return a<d&&b>c}var currentCalendarDateTime=!1,currentTimeInterval=null,scheduleResizeInterval=null;
function CalendarClass(){this.debugMode=!1;this.logLastTime=this.logStartTime=0;this.visibleVisits={};this.visibleVisitsTimer=0;this.options={clientVisits:[],spaces:[],spacesTypes:[],clinicSchedule:[],doctorSchedule:[],assistantSchedule:[],cabinetSchedule:[],doctorCabinets:[],cabinetDoctors:[],doctors:[],cabinets:[],patients:[],days:[],daysPositions:[],gridTimes:[],doctorTimes:[],zoomCellCSS:"",zoomTimes:[],include30MinIntervals:!0,include15MinIntervals:!1,autoUpdateTimer:!1,use_spaces_creation:!1,
viewType:0,useSingleMode:!0};this.timesYCoords=[];this.timesY2Coords=[];this.times=[];this.xCoords=[];this.blocks=[];this.columnsInfo=[];this.doctorsCellsCoords=[];this.timeBlocks=[];this.columnYCoords=[];this.doctorScheduleTimes=[];this.calendarClickTime=null;this.calendar_global_block_id=0;this.needRefreshOnCloseModal=this.stop_on_escape=!1;this.$ACTIVE_SHIFT=this.$ACTIVE_VISIT=this.copy2MemBlock=this.cut2MemBlock=null;this.tooltipSelect2IsOpened=!1;this.intersectsAssistantArray=[];this.intersectsAssistantMaxColumnsArray=
{};this.timeDisplay=function(a,b){10>a&&(a="0"+a);10>b&&(b="0"+b);return a+":"+b};this.strtimeToObject=function(a){var b=a.split(":");a=parseInt(b[0]);b=parseInt(b[1]);return{h:a,m:b}};this.time2minutes=function(a){a=a.split(":");return 60*parseInt(a[0])+parseInt(a[1])};this.minutes2time=function(a){var b=Math.floor(a/60);return this.timeDisplay(b,a-60*b)};this.round5=function(a){return 2.5<=a%5?5*parseInt(a/5)+5:5*parseInt(a/5)};this.ksort=function(a){var b=Object.keys(a).sort(),c={},d;for(d in b)c[b[d]]=
a[b[d]];return c};this.getDurationBetweenTimes=function(a,b){a=this.time2minutes(a);return this.time2minutes(b)-a};this.getYCoordinateForTime=function(a,b){if(void 0==b)b="all";else if("undefined"!=typeof this.timesY2Coords[a+b])return this.timesY2Coords[a+b];var c;for(c in this.timesYCoords){var d=this.timesYCoords[c];if("all"==b){d=d.substr(0,5);var e=a}else e=a.toString()+b;if(d==e){parseInt(c);break}}return parseInt(c)};this.getYCoordinateForTimeColumn=function(a,b){this.initColumnYCoords(a);
for(var c in this.columnYCoords[a])if(this.columnYCoords[a][c]==b.toString()+"t")return a=parseInt(c);return parseInt(c)};this.getYCoordinateForTimeCached=function(a){a=this.timesY2Coords[a.toString()+"t"];console.log(a);return"undefined"==typeof a?0:a};this.getXCoordinateForTime=function(a,b){return this.xCoords[a][b]};this.getTimeForYCoord=function(a){"undefined"==typeof this.timesYCoords[a]&&(a=this.timesYCoords.length-1);return this.timesYCoords[a].substr(0,5)};this.getTimeForYCoordColumn=function(a,
b){this.initColumnYCoords(a);"undefined"==typeof this.columnYCoords[a][b]&&(b=this.columnYCoords[a].length-1);return this.columnYCoords[a][b].substr(0,5)};this.getColumnIdByDayAndCabinet=function(a,b){return this.getColumnIdByX(this.getXCoordinateForTime(a,b))};this.getColumnIdByX=function(a,b){a+=20;return this.options.viewType==SCHEDULE_VIEW_TYPE_ASSISTANTS||this.options.viewType==SCHEDULE_VIEW_TYPE_ADMINISTRATORS?Math.floor(a/SCHEDULE_DEFAULT_CABINET_WIDTH):Math.round(a/SCHEDULE_DEFAULT_CABINET_WIDTH)};
this.refreshGridTimes=function(){var a=[],b=1E6,c=0;this.showInactiveDaysSchedule=!0;for(var d in this.options.clinicSchedule)if(1==this.options.days[d].active){this.showInactiveDaysSchedule=!1;break}for(d in this.options.clinicSchedule){var e=this.options.clinicSchedule[d];if(this.showInactiveDaysSchedule||1==this.options.days[d].active)b=Math.min(b,this.time2minutes(e.timeStart.time)),c=Math.max(c,this.time2minutes(e.timeEnd.time))}for(e in this.options.doctorSchedule){var f=this.options.doctorSchedule[e],
g;for(g in f){var p=f[g],q;for(q in p){var n=p[q];for(d in n){var l=n[d];b=Math.min(b,this.time2minutes(l.timeStart.time));c=Math.max(c,this.time2minutes(l.timeEnd.time));this.doctorScheduleTimes[d]=l}}}}for(var m in this.options.clientVisits){var h=this.options.clientVisits[m];b=Math.min(b,this.time2minutes(h.visit_time.timeStart.time));c=Math.max(c,this.time2minutes(h.visit_time.timeEnd.time))}for(m in this.options.spaces)h=this.options.spaces[m],b=Math.min(b,this.time2minutes(h.visit_time.timeStart.time)),
c=Math.max(c,this.time2minutes(h.visit_time.timeEnd.time));for(m in this.options.assistantSchedule)h=this.options.assistantSchedule[m],b=Math.min(b,this.time2minutes(h.shift_time.timeStart.time)),c=Math.max(c,this.time2minutes(h.shift_time.timeEnd.time));var k=60;this.options.include15MinIntervals?k=15:this.options.include30MinIntervals&&(k=30);if(c>b){var t=b;0!=Math.ceil(t%k)&&(a[this.minutes2time(t)]=Math.ceil(t%k),t=Math.ceil(t/k)*k);for(;t<=c;){var r=this.minutes2time(t);a[r]=30;t+=k}0!=Math.ceil(c%
k)&&(a[this.minutes2time(c)]=Math.ceil(c%k))}this.timeEndMin=c;this.timeEnd=this.minutes2time(this.timeEndMin);this.timeStartMin=b;this.timeStart=this.minutes2time(this.timeStartMin);t=[];k=-SCHEDULE_DEFAULT_CABINET_WIDTH;for(var v in this.options.days)for(d in this.options.ordered_cabinets){var w=this.options.ordered_cabinets[d];k+=SCHEDULE_DEFAULT_CABINET_WIDTH;"undefined"==typeof this.xCoords[v]&&(this.xCoords[v]=[]);h=this.getColumnIdByX(k,SCHEDULE_DEFAULT_CABINET_WIDTH);t[h]=[];for(r in a)t[h][r]=
a[r];this.xCoords[v][w]=k}k=[];var y=[];for(e in this.options.doctorSchedule)for(g in f=this.options.doctorSchedule[e],f)for(q in p=f[g],p)for(d in n=p[q],n)l=n[d],h=this.getColumnIdByDayAndCabinet(e,g),"undefined"==typeof t[h][l.timeStart.time]?t[h][l.timeStart.time]=30:30==t[h][l.timeStart.time]&&(t[h][l.timeStart.time]=30),"undefined"==typeof k[l.timeStart.time]&&(k[l.timeStart.time]=[]),k[l.timeStart.time][q]=q,"undefined"==typeof y[h]&&(y[h]=[]),y[h][l.timeStart.time]=q;d=[];for(var u in a)d[u]=
a[u];for(w in t)for(m in u=t[w],u)d[m]="undefined"==typeof d[m]?u[m]:Math.max(d[m],u[m]);d=this.ksort(d);this.timeBlocks=[];e=u=!1;for(r in d)"undefined"!=typeof k[r]&&(d=r+"d",this.timeBlocks[d]={type:"d",height:30,prev_time:e,time:r,time_min:this.time2minutes(r),duration:0,next_time:!1,next_time_min:!1,prev_block:u,next_block:!1},u&&(this.timeBlocks[u].next_time=r,this.timeBlocks[u].next_time_min=this.time2minutes(r),this.timeBlocks[u].next_block=d),u=d,e=r),d=r+"t",this.timeBlocks[d]={type:"t",
height:30,prev_time:e,time:r,time_min:this.time2minutes(r),next_time_min:!1,duration:0,next_time:!1,prev_block:u,next_block:!1},u&&(this.timeBlocks[u].next_time=r,this.timeBlocks[u].next_time_min=this.time2minutes(r),this.timeBlocks[u].next_block=d),u=d,e=r;this.timeBlocks=this.ksort(this.timeBlocks);for(r in this.timeBlocks)!1===this.timeBlocks[r].next_time_min?(this.timeBlocks[r].height=30,this.timeBlocks[r].duration=0):this.timeBlocks[r].duration=this.timeBlocks[r].next_time_min-this.timeBlocks[r].time_min;
d=[];t=b;if(c>b)for(;t<=c;)d[this.minutes2time(t)]=5,t+=5;for(m in this.options.clientVisits)if(h=this.options.clientVisits[m],30>h.visit_time.duration)for(b=h.visit_time.duration/5,u=1;u<=b;u++)t=this.minutes2time(this.time2minutes(h.visit_time.timeStart.time)+5*(u-1)),d[t]=Math.max(d[t],Math.round(30/b));for(m in this.options.assistantSchedule)if(h=this.options.assistantSchedule[m],30>h.duration)for(b=h.duration/5,u=1;u<=b;u++)t=this.minutes2time(this.time2minutes(h.timeStart.time)+5*(u-1)),d[t]=
Math.max(d[t],Math.round(30/b));for(m in this.options.spaces)if(h=this.options.spaces[m],30>h.visit_time.duration)for(b=h.visit_time.duration/5,u=1;u<=b;u++)t=this.minutes2time(this.time2minutes(h.visit_time.timeStart.time)+5*(u-1)),d[t]=Math.max(d[t],Math.round(30/b));u=0;for(r in this.timeBlocks)if(b=0,c=this.timeBlocks[r].time,!1===this.timeBlocks[r].next_time_min)for(this.timeBlocks[r].height=30,e=0;20>e;e++)this.timesYCoords[u]=this.timeBlocks[r].time+"t","undefined"==typeof this.timesY2Coords[this.timesYCoords[u]]&&
(this.timesY2Coords[this.timesYCoords[u]]=u),u++;else if("d"==this.timeBlocks[r].type)for(e=0;30>e;e++)this.timesYCoords[u]=c+"d",u++;else{for(l in d)if(c=this.time2minutes(l),c>=this.timeBlocks[r].time_min&&c<this.timeBlocks[r].next_time_min&&(b+=d[l],"t"==this.timeBlocks[r].type))for(e=0;e<d[l];e++)this.timesYCoords[u]=this.minutes2time(5*Math.floor(c/5))+"t","undefined"==typeof this.timesY2Coords[this.timesYCoords[u]]&&(this.timesY2Coords[this.timesYCoords[u]]=u),u++;this.timeBlocks[r].height=
b}delete d;r=l="";for(m in this.timeBlocks)b=this.timeBlocks[m].height,c=this.timeBlocks[m].time,u="00"==c.substr(3),"d"==this.timeBlocks[m].type?(l+='<div class="calTimeDoctorCell" style="height:'+b+'px"></div>',r+='<div style="height:'+b+'px; border: 0px"></div>'):(0==this.timeBlocks[m].next_time&&(b=30),l+='<div style="height:'+b+'px" class="calTimeCell'+(u?" timeHour":"")+'">'+c+"</div>",r+='<div style="height:'+b+'px" '+(u?' class="timeHour"':"")+"></div>");$("#gridTimeContainer").append(l);
$(".scheduleHorizontalLinesContainer").append(r);for(v in this.options.doctorSchedule)for(w in this.options.doctorSchedule[v])for(var D in this.options.doctorSchedule[v][w])for(var E in this.options.doctorSchedule[v][w][D])m=this.getYCoordinateForTime(this.options.doctorSchedule[v][w][D][E].timeStart.time,"t")-30,l=this.getXCoordinateForTime(v,w),h=this.getColumnIdByX(l,SCHEDULE_DEFAULT_CABINET_WIDTH),"undefined"==typeof this.doctorsCellsCoords[h]&&(this.doctorsCellsCoords[h]=[]),this.doctorsCellsCoords[h][m]=
m;this.displayShifts();this.displayLogTime("displayShiftsAssistantsAdministartors-start");this.options.viewType==SCHEDULE_VIEW_TYPE_ASSISTANTS?this.assistantDisplay():this.options.viewType==SCHEDULE_VIEW_TYPE_ADMINISTRATORS&&this.administratorDisplay();this.displayLogTime("displayShiftsAssistantsAdministartors-end");this.options.gridTimes=a;this.options.doctorTimes=k};this.initColumnYCoords=function(a){if("undefined"==typeof this.columnYCoords[a]){this.columnYCoords[a]=[];for(var b in this.timesY2Coords){var c=
this.timesY2Coords[b];this.columnYCoords[a][c]=b}for(c in this.timesYCoords)"undefined"==typeof this.columnYCoords[a][c]&&(this.columnYCoords[a][c]=this.timesYCoords[c]);for(c in this.doctorsCellsCoords[a]){b=this.columnYCoords[a][c];for(var d=0;30>d;d++)this.columnYCoords[a][parseInt(c)+d]=b.substr(0,b.length-1)+"d"}this.columnYCoords=this.ksort(this.columnYCoords)}};this.insertTimeBlock=function(a,b){b=Math.round(b);if("undefined"!=typeof this.timeBlocks[a+"t"])return this.timeBlocks[a+"t"].height=
Math.max(this.timeBlocks[a+"t"].height,b),!1;var c=this.time2minutes(a),d=!1,e=!1,f;for(f in this.timeBlocks){if(c<this.timeBlocks[f].time_min){this.timeBlocks[a+"t"]={type:"t",height:b,prev_time:e,time:a,time_min:this.time2minutes(a),duration:this.timeBlocks[f].time_min-this.time2minutes(a),next_time:this.timeBlocks[f].time,next_time_min:this.timeBlocks[f].time_min,prev_block:d,next_block:f};d&&(this.timeBlocks[d].next_time=a,this.timeBlocks[d].duration=this.timeBlocks[a+"t"].time_min-this.timeBlocks[d].time_min,
this.timeBlocks[d].next_time_min=this.timeBlocks[a+"t"].time_min,this.timeBlocks[d].next_block=a+"t",this.timeBlocks[f].prev_time=a,this.timeBlocks[f].prev_block=a+"t",this.timeBlocks[f].prev_time_min=this.timeBlocks[a+"t"].time_min,this.timeBlocks[f].duration=this.timeBlocks[f].next_time_min-this.timeBlocks[a+"t"].time_min);break}d=f;e=this.timeBlocks[f].time}this.timeBlocks=this.ksort(this.timeBlocks)};this.deleteBlockFromColumn=function(a,b){var c=this.blocks[a][b],d=c.prev;c=c.next;0!=d&&0!=c?
(this.blocks[a][d].next=c,this.blocks[a][c].prev=d):0==d&&c?this.blocks[a][c].prev=!1:0==c&&d&&(this.blocks[a][d].next=!1);delete this.blocks[a][b];0==Object.keys(this.blocks[a]).length&&(b=this.getYCoordinateForTimeColumn(a,this.timeEnd),this.blocks[a]["b"+this.calendar_global_block_id]=new calendarBlock(a,0,b,"free",!1,!1,"b"+this.calendar_global_block_id,null),this.calendar_global_block_id++)};this.moveBlockToColumn=function(a,b,c,d,e){var f=this.blocks[a][c];this.deleteBlockFromColumn(a,c);var g=
a=!1,p=!1,q;for(q in this.blocks[b]){var n=this.blocks[b][q];if("free"==n.type){p=!0;delete this.blocks[b][q];break}n.bottom<=d&&(0==a||a.bottom<n.bottom)?a=n:n.top>=e&&(0==g||g.top>n.top)&&(g=n)}n={};f.prev=a?a.id:!1;f.next=g?g.id:!1;f.top=d;f.bottom=e;if(0==a){if(n[c]=f,!p)for(q in this.blocks[b])n[q]=this.blocks[b][q]}else if(0==g){if(!p)for(q in this.blocks[b])n[q]=this.blocks[b][q];n[c]=f}else if(!p)for(q in this.blocks[b])n[q]=this.blocks[b][q],q==f.prev&&(n[c]=f);0==f.next||p||(n[f.next].prev=
c);0==f.prev||p||(n[f.prev].next=c);this.blocks[b]=n};this.serachPrevShiftInColumn=function(a,b){for(b=b.prev;b;){if("doctor"==this.blocks[a][b].type)return this.blocks[a][b].id;b=this.blocks[a][b].prev}return!1};this.serachNextShiftInColumn=function(a,b){for(b=b.next;b;){if("doctor"==this.blocks[a][b].type)return this.blocks[a][b].id;b=this.blocks[a][b].next}return!1};this.fixBlockPosition=function(a,b,c){};this.initCalendarBlocks=function(){var a=[],b=this;this.calendar_global_block_id=0;this.displayLogTime("INLINE-initCalendarBlocks-start");
$(".calItemDoctorCell").each(function(){var c=$(this),d=parseInt(this.style.left),e=parseInt(this.style.top);d=b.getColumnIdByX(d,SCHEDULE_DEFAULT_CABINET_WIDTH);"undefined"==typeof a[d]&&(a[d]=[]);a[d]["b"+b.calendar_global_block_id]=new calendarBlock(d,e,e+28,"doctor",!1,!1,"b"+b.calendar_global_block_id,c.attr("_id"));c.attr("block_id",b.calendar_global_block_id);c.next().attr("block_id",b.calendar_global_block_id);c.attr("column_id",d);b.calendar_global_block_id++});$(".calVisitCell").each(function(){var c=
$(this),d=parseInt(this.style.left),e=parseInt(this.style.top),f=parseInt(this.style.height),g=parseInt(this.style.width);d=b.getColumnIdByX(d,g);"undefined"==typeof a[d]&&(a[d]=[]);a[d]["b"+b.calendar_global_block_id]=new calendarBlock(d,e,e+f,"visit",!1,!1,"b"+b.calendar_global_block_id,c.attr("_vis"));c.attr("block_id",b.calendar_global_block_id);c.attr("column_id",d);b.calendar_global_block_id++});this.displayLogTime("INLINE-initCalendarBlocks-end");for(var c in a){a[c]=this.ksort_blocks(a[c]);
var d=a[c],e=!1,f=!1;for(g in d)a[c][g].prev=e,e=g;d=Object.keys(d);for(e=d.length-1;0<=e;e--){var g=d[e];a[c][g].next=f;f=g}}c=Object.keys(this.options.cabinets).length;f=Object.keys(this.options.days).length;scheduleCabinetPerDay=c;g=0;for(var p in this.options.days)for(var q in this.options.ordered_cabinets)this.columnsInfo[g]={day_info:this.options.days[p],cabinet_info:this.options.cabinets[this.options.ordered_cabinets[q]]},g++;p=f*c;for(c=0;c<p;c++)"undefined"==typeof a[c]&&(q=b.getYCoordinateForTimeColumn(c,
b.timeEnd),a[c]=[],a[c]["b"+b.calendar_global_block_id]=new calendarBlock(c,0,q,"free",!1,!1,"b"+b.calendar_global_block_id,null),b.calendar_global_block_id++);this.blocks=a;this.displayLogTime("SORTBLOCKS");return this.blocks};this.ksort_blocks=function(a){var b=Object.keys(a).sort(function(b,c){return a[b].top<a[c].top?-1:a[b].top>a[c].top?1:0}),c={},d;for(d in b)c[b[d]]=a[b[d]];return c};this.getCommentHeight=function(a){return 15*Math.max(Math.floor((a-45)/15),0)};this.recalculateCommentHeightO=
function(a){var b=a.height(),c=a.find(".visitNote");c.css("max-height","inherit");var d=c.height(),e=this.getCommentHeight(b);d>e+1?a.find(".visitNoteDots").show():a.find(".visitNoteDots").hide();c.css("max-height",e);this.doctorLineIsVisible(b)?a.find(".visitDoctorTitle, .visitDoctorName").removeClass("hidden"):a.find(".visitDoctorTitle, .visitDoctorName").addClass("hidden")};this.recalculateCommentHeight=function(a){var b=parseInt(a[0].style.height),c=a[0].attributes._vis.value,d=document.getElementById("visitNote-"+
c);if(d){d.style.maxHeight="inherit";var e=d.offsetHeight,f=this.getCommentHeight(b);e>f+1?document.getElementById("visitNoteDots-"+c).style.display="block":document.getElementById("visitNoteDots-"+c).style.display="none";d.style.maxHeight=f;this.doctorLineIsVisible(b)?a.find(".visitDoctorTitle, .visitDoctorName").removeClass("hidden"):a.find(".visitDoctorTitle, .visitDoctorName").addClass("hidden")}};this.recalculateSpaceCommentHeight=function(a){var b=a.height(),c=a.find(".visitNote");c.css("max-height",
"inherit");var d=c.height(),e=this.getCommentHeight(b);d>e+2?a.find(".visitNoteDots").show():a.find(".visitNoteDots").hide();c.css("max-height",e);this.doctorLineIsVisible(b)?a.find(".visitDoctorTitle, .visitDoctorName").removeClass("hidden"):a.find(".visitDoctorTitle, .visitDoctorName").addClass("hidden")};this.doctorLineIsVisible=function(a){return 40<a};this.setActiveShift=function(a,b){if(!a.hasClass("active")){"undefuned"==typeof b&&(b=!1);1==b?a.addClass("onAfterCreate"):a.removeClass("onAfterCreate");
a.addClass("active");this.$ACTIVE_SHIFT=a;var c=this;currentClinicMemberHasAccess(ACCESS_SCHEDULE_SHIFTS_EDITING);$_shift_schedule=a.next();$_shift_schedule.html('<div class="doctorinfo"></div><div class="shifttime"></div>');currentClinicMemberHasAccess(ACCESS_SCHEDULE_SHIFTS_EDITING)&&(a.clinicDraggableTouch(),$_shift_schedule.resizable({containment:"parent",scroll:!0,delay:0,autoHide:!1,customgrid:!0,minHeight:30,handles:"s,n",resize:function(b,d){b.preventDefault();$(this).css("width","");b=Math.round($_shift_schedule.position().top);
var e=$(this).data("uiResizable").axis,f=a.attr("column_id");if("n"==e)d=c.getTimeForYCoordColumn(f,b),e=a.attr("_tim_e");else{var g=b+Math.round(d.size.height);d=a.attr("_tim_s");e=c.getTimeForYCoordColumn(f,g)}a.attr("_tim_s_new",d);a.attr("_tim_e_new",e);g=c.shiftCheckPosition($_shift_schedule.get(0),f,b,g);d!=e&&g?$_shift_schedule.removeClass("mistake"):$_shift_schedule.addClass("mistake");$(".shifttime",$(this)).html(d+" - "+e)},start:function(b,d){if(clinicMoveInterval)return!1;clinicFlagResize=
!0;clinicMoveInterval&&clearInterval(clinicMoveInterval);$(".sch_tooltip").hide();b=document.getElementById("scheduleSidebarContainer");resizeScrollTopBeforeStart=parseInt(""==b.style.marginTop?0:b.style.marginTop);$(".doctorinfo",$_shift_schedule).html(a.get(0).innerHTML);$(".shifttime",$_shift_schedule).html(a.attr("_tim_s")+" - "+a.attr("_tim_e"));$(this).addClass("shedule_resizable");d=$(this).data("uiResizable").axis;var e="b"+a.attr("block_id");b=a.attr("column_id");$(this).resizable("option",
"maxHeight",!1);a.hide();"n"==d?(d=c.serachPrevShiftInColumn(b,c.blocks[b][e]),b=0==d?c.getYCoordinateForTimeColumn(b,c.getTimeForYCoordColumn(b,0)):c.getYCoordinateForTimeColumn(b,c.doctorScheduleTimes[c.blocks[b][d].db_id].timeEnd.time),$(this).resizable("option","maxHeight",$_shift_schedule.height()-b+$_shift_schedule.position().top)):"s"==d&&(d=c.serachNextShiftInColumn(b,c.blocks[b][e]),0!=d&&(b=c.blocks[b][d].top,$(this).resizable("option","maxHeight",b-$_shift_schedule.position().top)))},stop:function(b,
d){$(this).removeClass("shedule_resizable");clearInterval(scheduleResizeInterval);setTimeout(function(){clinicFlagResize=!1},10);if(c.stop_on_escape||void 0==a.attr("_tim_s_new")||$(this).hasClass("mistake")){d.element.css(d.originalPosition);d.element.css(d.originalSize);$(this).css("width",SCHEDULE_DEFAULT_CABINET_WIDTH);var e=$(this).attr("_tim_s"),f=$(this).attr("_tim_e");a.removeAttr("_tim_s_new");a.removeAttr("_tim_e_new");c.stop_on_escape=!1;a.removeClass("active");$(this).html("").removeClass("mistake");
c.setActiveShift(a);a.show()}else{e=$_shift_schedule.height();b="b"+a.attr("block_id");d=a.attr("column_id");f=$(this).position().top;c.blocks[d][b].top=f;c.blocks[d][b].bottom=f+e;var g=!0,h=a.attr("_tim_s_new"),k=a.attr("_tim_e_new");e=a.attr("_tim_s");f=a.attr("_tim_e");if(h!=e||k!=f)g=!0;g?(a.attr("_tim_s",h),a.attr("_tim_e",k),$(".shifttime",$(this)).html(h+" - "+k),c.fixBlockPosition(d,b,$(this)),c.confirmShift(a,d,"resize")):c.fixBlockPosition(d,b,$(this));a.removeAttr("_tim_s_new");a.removeAttr("_tim_e_new")}}}));
if(isMobileDevice&&(710>$(window).width()||500>$(window).height()))c.removeResizableHandles(),$_shift_schedule.append('<span class="resizableMarkerTop"></span><span class="resizableMarkerBottom"></span>');else if(c.removeShiftTooltip(),b=$(".sch_tooltip",a),b.length)b.show();else if(a.length){var d=$(".scheduleBody");b=parseInt(d.css("width"));var e=document.getElementById("scheduleHeaderContainer"),f=document.getElementById("scheduleSidebarContainer");d=parseInt(d.css("height"));e=parseInt(""==e.style.marginLeft?
0:e.style.marginLeft);f=parseInt(""==f.style.marginTop?0:f.style.marginTop);var g=parseInt(a.position().top),p=parseInt(a.position().left),q=parseInt(a.css("height")),n=SCHEDULE_DEFAULT_CABINET_WIDTH,l=0,m=a.attr("_id"),h=-308,k=0,t="right";if(p+e+430+n<b||430>=p)h=a.width()+10;0<=h&&(t="left");g+f+340>d&&(k=-(g+f+340-d)-12);l=0==k?Math.min(q,340)/2-5:Math.min(q,340+k)/2-k-5;l="right"==t?l+14:l-5;40>=q&&30<=g&&100>l&&(k-=30,l+=30);ajax({url:"/cabinet/schedule-api/get-doctor-calendar-html",data:{shift_id:m},
success:function(a){$("#sch_tooltip_content").html(a.html);c.refreshTooltipPosition()}});a.append('<div class="sch_tooltip" id="sch_tooltip" style="visibility: hidden; left: '+h+"px; top:"+k+'px; min-width: 280px; min-height: 270px; width: auto"><div style="top:'+l+'px;" class="sch_arrow '+t+'"></div><div id="sch_tooltip_content"></div></div>')}}};this.setActiveVisit=function(a){if(!a.hasClass("active")){a.addClass("active");var b=this;this.$ACTIVE_VISIT=a;var c=!1;this.options.viewType==SCHEDULE_VIEW_TYPE_VISITS&&
currentClinicMemberHasAccess(ACCESS_SCHEDULE_VISITS_EDITING)?c=!0:this.options.viewType==SCHEDULE_VIEW_TYPE_ASSISTANTS&&currentClinicMemberHasAccess(ACCESS_SCHEDULE_ASSISTANT_SHIFTS_EDITING)?c=!0:this.options.viewType==SCHEDULE_VIEW_TYPE_ADMINISTRATORS&&currentClinicMemberHasAccess(ACCESS_SCHEDULE_ADMINISTRATOR_SHIFTS_EDITING)&&(c=!0);c&&(a.clinicDraggableTouch(),a.resizable({containment:"parent",scroll:!0,delay:0,autoHide:!1,customgrid:!0,minHeight:30,handles:"n,s",resize:function(c,d){c.preventDefault();
$(this).css("width","");var e=Math.round(a.position().top),f=$(this).data("uiResizable").axis;c=$(this).attr("column_id");"n"==f?(d=b.getTimeForYCoordColumn(c,e),c=a.attr("_tim_e")):(e+=Math.round(d.size.height),d=a.attr("_tim_s"),c=b.getTimeForYCoordColumn(c,e));a.attr("_tim_s_new",d);a.attr("_tim_e_new",c);d==c?a.addClass("mistake"):a.removeClass("mistake");b.recalculateCommentHeight($(this));$(".visittime",$(this)).html(d+" - "+c)},start:function(c,d){if(clinicMoveInterval)return!1;clinicFlagResize=
!0;clinicMoveInterval&&clearInterval(clinicMoveInterval);$(".sch_tooltip").hide();c=document.getElementById("scheduleSidebarContainer");resizeScrollTopBeforeStart=parseInt(""==c.style.marginTop?0:c.style.marginTop);$(this).addClass("shedule_resizable");d=$(this).data("uiResizable").axis;var e="b"+$(this).attr("block_id");c=$(this).attr("column_id");$(this).resizable("option","maxHeight",!1);calendar.options.viewType==SCHEDULE_VIEW_TYPE_VISITS?"n"==d?(d=b.blocks[c][e].prev,c=0==d?b.getYCoordinateForTimeColumn(c,
b.getTimeForYCoordColumn(c,0)):b.blocks[c][d].bottom,$(this).resizable("option","maxHeight",a.height()-c+a.position().top)):"s"==d&&(d=b.blocks[c][e].next,0!=d&&(c=b.blocks[c][d].top,$(this).resizable("option","maxHeight",c-a.position().top))):calendar.options.viewType!=SCHEDULE_VIEW_TYPE_ASSISTANTS&&calendar.options.viewType!=SCHEDULE_VIEW_TYPE_ADMINISTRATORS||$(this).css("left",c*SCHEDULE_DEFAULT_CABINET_WIDTH+"px")},stop:function(a,c){$(this).removeClass("shedule_resizable");clearInterval(scheduleResizeInterval);
setTimeout(function(){clinicFlagResize=!1},10);if(b.stop_on_escape||void 0==$(this).attr("_tim_s_new")||$(this).hasClass("mistake")){c.element.css(c.originalPosition);c.element.css(c.originalSize);$(this).css("width",SCHEDULE_DEFAULT_CABINET_WIDTH);var d=$(this).attr("_tim_s"),e=$(this).attr("_tim_e");$(".visittime",$(this)).html(d+" - "+e);$(this).removeAttr("_tim_s_new");$(this).removeAttr("_tim_e_new");b.stop_on_escape=!1;$(this).removeClass("mistake");$(".calVisitInfoCell",$(this)).css("height",
c.originalSize.height-b.options.paddingVisitBottom);$(".sch_tooltip").show()}else{d=$(this).height();c="b"+$(this).attr("block_id");a=$(this).attr("column_id");e=$(this).position().top;b.blocks[a][c].top=e;b.blocks[a][c].bottom=e+d;var f=!0,g=$(this).attr("_tim_s_new"),h=$(this).attr("_tim_e_new");d=$(this).attr("_tim_s");e=$(this).attr("_tim_e");if(g!=d||h!=e)f=!0;f?($(this).attr("_tim_s",g),$(this).attr("_tim_e",h),$(".visittime",$(this)).html(g+" - "+h),b.fixBlockPosition(a,c,$(this)),b.confirmVisit($(this),
a,"resize")):b.fixBlockPosition(a,c,$(this));$(this).removeAttr("_tim_s_new");$(this).removeAttr("_tim_e_new")}}}));if(isMobileDevice&&(710>$(window).width()||500>$(window).height()))c&&(b.removeResizableHandles(),a.append('<span class="resizableMarkerTop"></span><span class="resizableMarkerBottom"></span>'),$(".resizableMarkerTop, .resizableMarkerBottom").css("border-color",a.find(".calVisitInfoCell").css("background-color")));else if(isMobileDevice&&(b.removeResizableHandles(),a.append('<span class="resizableMarkerTop"></span><span class="resizableMarkerBottom"></span>'),
$(".resizableMarkerTop, .resizableMarkerBottom").css("border-color",a.find(".calVisitInfoCell").css("background-color"))),b.removeVisitTooltip(),c=$(".sch_tooltip",a),c.length)c.show();else if(a.length){c=$(".scheduleBody");var d=parseInt(c.css("width")),e=document.getElementById("scheduleHeaderContainer"),f=document.getElementById("scheduleSidebarContainer");c=parseInt(c.css("height"));var g=parseInt(""==e.style.marginLeft?0:e.style.marginLeft);f=parseInt(""==f.style.marginTop?0:f.style.marginTop);
e=parseInt(a.position().top);var p=parseInt(a.position().left),q=parseInt(a.css("height")),n=SCHEDULE_DEFAULT_CABINET_WIDTH,l=0,m=!1,h=!1,k=a.attr("_vis");this.options.viewType==SCHEDULE_VIEW_TYPE_ASSISTANTS||this.options.viewType==SCHEDULE_VIEW_TYPE_ADMINISTRATORS?(k=b.options.assistantSchedule[k],h=!0):a.hasClass("calSpaceCell")?(k=b.options.spaces[k],m=!0):k=b.options.clientVisits[k];if(!h&&!m){var t="undefined"!=typeof b.options.patients[k.patient_id]["in"]?'<div class="scheduleTooltipImportantNote'+
(k.note.length?" scheduleTooltipImportantNoteWithNote":"")+'">'+b.options.patients[k.patient_id]["in"]+"</div>":"",r="undefined"!=typeof b.options.patients[k.patient_id].pc?(k.note.length?"<br>":"")+T["Preferred contact"]+": "+T["Preferred contact "+b.options.patients[k.patient_id].pc]:"",v="undefined"!=typeof b.options.patients[k.patient_id].src?(k.note.length||r.length?"<br>":"")+T["Patient source"]+": "+b.options.patients[k.patient_id].src:"",w="",y="";null!=k.cancel_message&&k.cancel_message.length&&
(y+='<span class="scheduleCancelMessage">'+k.cancel_message+"</span>");var u="";888==currentClinicId&&(u='<a class="scheduleTooltip043 clickable" target="_blank" href="#doc043/index/'+k.patient_id+'">043</a>');var D="undefined"!=typeof b.options.patients[k.patient_id].insur?'<div class="scheduleTooltipInsuranceCompany">'+T["Insurance company"]+": "+b.options.patients[k.patient_id].insur+"</div>":"",E='<div class="scheduleTooltipDoctor">'+T.Doctor+": "+b.options.doctors[k.doctor_id].name+"</div>",
z="undefined"!=typeof b.options.patients[k.patient_id].birthdayTodayText;z="undefined"!=typeof b.options.patients[k.patient_id].birthday?' <span class="birthdayText '+(z?" birthdayTodayText":"")+'">'+b.options.patients[k.patient_id].birthday+(z?b.options.patients[k.patient_id].birthdayTodayText:"")+"</span>":"";z="undefined"!=typeof b.options.patients[k.patient_id].age?b.options.patients[k.patient_id].age+" "+getAgeYearsWord(b.options.patients[k.patient_id].age)+z+"<br>":"";var C='<div id="testHeightNoteHtml" class="scheduleTooltipNote" style="display: none;">'+
E+D+z+t+k.note+r+v+w+y+"</div>";$("body").append(C);var x=$("#testHeightNoteHtml").height();$("#testHeightNoteHtml").remove()}C=h?-308:-390;var A=0;if(h)var B=300;else B=190+(18<x?x-18:0),currentClinicMemberHasAccess(ACCESS_FINANCE)&&(B+=x?34:18);l=h?430:390;x="right";if(p+g+l+n<d||p<=l)C=h?a.width()+10:210;0<=C&&(x="left");e+f+B>c&&(A=-(e+f+B-c)-12);l=0==A?Math.min(q,B)/2-5:Math.min(q,B+A)/2-A-5;l="right"==x?l+14:l-5;40>=q&&30<=e&&100>l&&(A-=30,l+=30);h?(d=k.shift_time.timeStart.time,g=k.shift_time.timeEnd.time):
(d=k.visit_time.timeStart.time,g=k.visit_time.timeEnd.time);d=b.options.days[a.attr("_dat")].visit_data_title+"  "+d+" - "+g;q=$("#scheduleVisitTooltipStatusSelectPrototype").html();n=$("#scheduleVisitImageSelectPrototype").html();g='<div id="sch_tooltip_content">';p=!0;if(h)"undefined"!=typeof calendarSelectedVisitTooltipHtmlOnLoad?(g+=calendarSelectedVisitTooltipHtmlOnLoad,p=!1,setTimeout(function(){},1),delete calendarSelectedVisitTooltipHtmlOnLoad):ajax({url:this.options.viewType==SCHEDULE_VIEW_TYPE_ADMINISTRATORS?
"/cabinet/schedule-api/get-administrator-calendar-html":"/cabinet/schedule-api/get-assistant-calendar-html",data:{shift_id:k.id},success:function(a){$("#sch_tooltip_content").html(a.html);b.refreshTooltipPosition()}});else{if(m)g=g+'<div class="scheduleTooltipSpace"><div class="scheduleTooltipName">'+(b.options.spacesTypes[k.type].name+"</div>"),g=g+'<div class="scheduleTooltipLine1"></div><div class="scheduleTooltipDateAndTime">'+(d+'</div><div class="scheduleTooltipLine2"></div><div class="scheduleTooltipNote">')+
(k.note+"</div>"),g+='<div class="scheduleTooltipButtons">',g=currentClinicMemberHasAccess(ACCESS_SCHEDULE_VISITS_EDITING)?g+('<a onclick="calendar.editSpaceForm(calendar.$ACTIVE_VISIT)" class="clickable btn blue"><i class="fa fa-edit clickable"></i>&nbsp;&nbsp;'+T["Edit space"]+"</a>"):g+('<a onclick="calendar.editSpaceForm(calendar.$ACTIVE_VISIT)" class="clickable btn blue"><i class="fa fa-info clickable"></i>&nbsp;&nbsp;'+T["Show space"]+"</a>"),g+="</div>";else{h=parseFloat(b.options.patients[k.patient_id].balance);
if(0==h||isNaN(h))var F=T.Balance+": 0.00";0<h&&(F=T["Paid in advance"]+": "+formatPrice(h));0>h&&(F=T.Debt+": "+formatPrice(Math.abs(h)));g+=n;g+='<div class="scheduleTooltipVisitStatusSelectContainer">'+q+"</div>";g+='<div class="scheduleTooltipImage"><a href="#schedule-visits/list/'+k.patient_id+'"><img src="'+b.options.patients[k.patient_id].img+'" class="clickable"></a></div>';"undefined"!=typeof b.options.patients[k.patient_id].fn&&(g+='<div class="scheduleTooltipFamilyButton clickable" data-patientId="'+
k.patient_id+'"><img class="clickable" src="/c/_img/family.png"></div>');"undefined"!=typeof b.options.patients[k.patient_id].eid&&(g+='<div class="scheduleTooltipExternalId clickable">'+b.options.patients[k.patient_id].eid+"</div>");g+='<a class="scheduleTooltipName clickable" href="#schedule-visits/list/'+k.patient_id+'">'+b.options.patients[k.patient_id].name+"</a>";h=b.options.patients[k.patient_id].phone.split(" ")[0];g+='<div class="scheduleTooltipPhone clickable" data-phone="'+h+'">'+b.options.patients[k.patient_id].phone+
("undefined"!=typeof k.sms_sent?" "+T["Sms sent message in tooltip"]:"")+"</div>";g+='<div class="scheduleTooltipLine1"></div>';g=g+('<div class="scheduleTooltipDateAndTime">'+d+'</div><div class="scheduleTooltipBalance">')+(F+'</div><div class="scheduleTooltipLine2"></div>');g+='<div class="scheduleTooltipNote">'+E+D+z+t+k.note+r+v+w+y+"</div>";g+=u;currentClinicMemberHasAccess(ACCESS_FINANCE)&&(g+='<div class="scheduleTooltipButtons">',g+='<a href="#simple-invoice/create/'+k.patient_id+'" class="clickable btn blue"><i class="fa fa-bolt clickable"></i>&nbsp;&nbsp;'+
T["Fast invoice"]+"</a>",g+='<span class="btn green registerPatientPayment clickable" data-patientid="'+k.patient_id+'" data-returnpayment="0"><i class="fa fa-download clickable"></i>&nbsp;&nbsp;'+T["Receive payment"]+"</span>",g+='<a href="#patients/edit/'+k.patient_id+'" class="clickable btn btn-default"><i class="fa fa-cogs clickable"></i>&nbsp;&nbsp;'+T.Profile+"</a>",g+="</div>");g+='<div class="scheduleTooltiPatientLinks">';g+='<a href="#schedule-visits/list/'+k.patient_id+'" class="clickable">'+
T.Visits+"</a>";currentClinicUsesPlans&&currentClinicMemberHasAccess(ACCESS_PLANS)&&(g+='<a href="#plans/'+(b.options.patients[k.patient_id].main_plans_id?"plan/"+b.options.patients[k.patient_id].main_plans_id:"list/"+k.patient_id)+'" class="clickable">'+T.Plans+"</a>");g+='<a href="#patients/stages/'+k.patient_id+'" class="clickable">'+T.History+"</a>";currentClinicMemberHasAccess(ACCESS_FINANCE)?g+='<a href="#'+(currentClinicFinanceModel==CLINIC_FINANCE_MODEL_STANDARD?"plan-items":"invoices-and-payments")+
"/list/"+k.patient_id+'" class="clickable">'+T.Finance+"</a>":currentClinicMemberHasAccess(ACCESS_MANIPULATION_HISTORY)&&(g+='<a href="#plan-items/manipulations-list/'+k.patient_id+'" class="clickable">'+T.Finance+"</a>")}g+="</div>"}g+="</div>";this.options.viewType==SCHEDULE_VIEW_TYPE_ASSISTANTS||this.options.viewType==SCHEDULE_VIEW_TYPE_ADMINISTRATORS?a.append('<div class="sch_tooltip" id="sch_tooltip" style="'+(p?"visibility: hidden;":"")+" left: "+C+"px; top:"+A+'px; min-width: 280px; min-height: 270px; width: auto"><div style="top:'+
l+'px;" class="sch_arrow '+x+'"></div>'+g+"</div>"):a.append('<div class="sch_tooltip" id="sch_tooltip" style=" left: '+C+"px; top:"+A+"px;  height: "+B+'px;"><div style="top:'+l+'px;" class="sch_arrow '+x+'"></div>'+g+"</div>");m||($("#tooltip_visit_image_button").attr("src","/c/_img/schedule-images/"+k.visit_image+".png?"+visitImagesVersion),k.visit_image?$("#tooltip_visit_image_button2").attr("src","/c/_img/schedule-images/"+k.visit_image2+".png?"+visitImagesVersion):$(".sch_tooltip .visitImageSelectContainerWrap2").remove(),
t=0,e+f+485>c&&(t=-(e+f+485-c)-12),$("#sch_tooltip .visitImageSelectPicker").css("top",t+"px"),b.tooltipSelect2IsOpened=!1,$(".scheduleTooltipVisitStatusSelectContainer select").val(k.status),$(".scheduleTooltipVisitStatusSelectContainer select").select2({minimumResultsForSearch:10,width:null,escapeMarkup:function(a){return a},templateResult:formatColoredItemInSelect,templateSelection:formatColoredSelectedItem,containerCssClass:"select2ColoredContainer",dropdownCssClass:"select2ColoredDropdown"}),
$(".scheduleTooltipVisitStatusSelectContainer select").on("select2:open",function(a){b.tooltipSelect2IsOpened=!0}))}}};this.refreshTooltipPosition=function(){if(null==this.$ACTIVE_VISIT){var a=this.$ACTIVE_SHIFT,b=$(".scheduleBody"),c=parseInt(b.css("width")),d=document.getElementById("scheduleHeaderContainer"),e=document.getElementById("scheduleSidebarContainer");b=parseInt(b.css("height"));d=parseInt(""==d.style.marginLeft?0:d.style.marginLeft);var f=parseInt(""==e.style.marginTop?0:e.style.marginTop);
e=parseInt(a.position().top);var g=parseInt(a.position().left),p=parseInt(a.css("height")),q=SCHEDULE_DEFAULT_CABINET_WIDTH;a.attr("_id");var n=$("#sch_tooltip"),l=n.height(),m=n.width(),h="right",k=0,t=-308;if(g+d+m+q<c||g<=m)t=a.width()+10;0<=t&&(h="left");e+f+l>b&&(k=-(e+f+l-b)-12);c=0==k?Math.min(p,l)/2-5:Math.min(p,l+k)/2-k-5;c="right"==h?c+14:c-5;40>=p&&30<=e&&100>c&&(k-=30,c+=30);0==k&&a.hasClass("onAfterCreate")&&(a.removeClass("onAfterCreate"),k+=30);n.css("left",t+"px");n.css("top",k+"px");
$(".sch_arrow").css("top",c+"px");"right"==h?$(".sch_arrow").hasClass("left")&&$(".sch_arrow").removeClass("left").addClass("right"):$(".sch_arrow").hasClass("right")&&$(".sch_arrow").removeClass("right").addClass("left");$(".sch_tooltip").css("visibility","visible")}else{a=this.$ACTIVE_VISIT;b=$(".scheduleBody");c=parseInt(b.css("width"));d=document.getElementById("scheduleHeaderContainer");e=document.getElementById("scheduleSidebarContainer");b=parseInt(b.css("height"));d=parseInt(""==d.style.marginLeft?
0:d.style.marginLeft);f=parseInt(""==e.style.marginTop?0:e.style.marginTop);e=parseInt(a.position().top);g=parseInt(a.position().left);p=parseInt(a.css("height"));q=SCHEDULE_DEFAULT_CABINET_WIDTH;var r=this.options.viewType==SCHEDULE_VIEW_TYPE_ASSISTANTS||this.options.viewType==SCHEDULE_VIEW_TYPE_ADMINISTRATORS;a.attr("_vis");n=$("#sch_tooltip");l=n.height();m=n.width();h="right";k=0;t=r?-308:-390;if(g+d+m+q<c||g<=m)t=r?a.width()+10:210;0<=t&&(h="left");e+f+l>b&&(k=-(e+f+l-b)-12);c=0==k?Math.min(p,
l)/2-5:Math.min(p,l+k)/2-k-5;c="right"==h?c+14:c-5;40>=p&&30<=e&&100>c&&(k-=30,c+=30);n.css("left",t+"px");n.css("top",k+"px");$(".sch_arrow").css("top",c+"px");"right"==h?$(".sch_arrow").hasClass("left")&&$(".sch_arrow").removeClass("left").addClass("right"):$(".sch_arrow").hasClass("right")&&$(".sch_arrow").removeClass("right").addClass("left");r&&$(".sch_tooltip").css("visibility","visible")}};this.displayVisits=function(){this.displayLogTime("DP-VISISTS-START");var a="",b;for(b in this.options.clientVisits){var c=
this.options.clientVisits[b],d=c.visit_time.timeStart.time,e=c.visit_time.timeEnd.time,f=this.getXCoordinateForTime(c.datetime,c.cabinet_id),g=this.getColumnIdByX(f,SCHEDULE_DEFAULT_CABINET_WIDTH),p=this.getYCoordinateForTime(d,"t"),q=this.getYCoordinateForTime(e,"t");"undefined"!=typeof this.doctorsCellsCoords[g]&&"undefined"!=typeof this.doctorsCellsCoords[g][q-30]&&(q-=30);g=q-p;d=' _tim_s="'+d+'"';d+=' _tim_e="'+e+'"';d+=' _cab="'+c.cabinet_id+'"';d+=' _dat="'+c.datetime+'"';d+=' _doc="'+c.doctor_id+
'"';d+=' _pat="'+c.patient_id+'"';d+=' _vis="'+b+'"';e="";"undefined"!=typeof c.disabled&&(d+=' _disabled="1"',e=" disabled",visit_text="");q="undefined"!=typeof this.options.patients[c.patient_id].balance?this.options.patients[c.patient_id].balance:0;a+='<div id="calVisitCell'+b+'" class="calVisitCell '+e+(0!=q?0<q?SCHEDULE_GREEN_NAME_BALANCE?" prepayment":"":" debtor":"")+((SCHEDULE_VIEW==SCHEDULE_VIEW_STANDARD?" calVisitCellStatus"+c.status:" scheduleDoctorColor"+this.options.doctors[c.doctor_id].color)+
" ")+(renderOldVisitsTransparent?"  transparentSTATUS_"+c.status+"Visit ":"")+'"'+d+' style="top:'+p+"px;left:"+f+"px;height:"+g+'px;"></div>'}this.displayLogTime("DP-VISISTS-END");$("#scheduleBodyContainer").append(a);this.displayLogTime("DP-VISISTS-appendHTML")};this.displayVisits2=function(a,b,c,d){this.displayLogTime("VISISTS-CACHE-APPEND-START");var e=[],f;for(f in this.options.clientVisits){var g=this.options.clientVisits[f],p=g.visit_time.timeStart.time,q=g.visit_time.timeEnd.time,n=this.getXCoordinateForTime(g.datetime,
g.cabinet_id);n=this.getColumnIdByX(n,SCHEDULE_DEFAULT_CABINET_WIDTH);if("undefined"==typeof this.visibleVisits[f]&&(!(p>=d||q<=c)||n>=a&&n<=b)){this.visibleVisits[f]=1;var l=this.getYCoordinateForTimeColumn(n,p),m=this.getYCoordinateForTimeColumn(n,q);"undefined"!=typeof this.doctorsCellsCoords[n]&&"undefined"!=typeof this.doctorsCellsCoords[n][m-30]&&(m-=30);n=m-l;l=this.doctorLineIsVisible(n);m="undefined"!=typeof this.options.patients[g.patient_id].eid?this.options.patients[g.patient_id].eid:
0;var h='<div  class="visitWritingsContainer'+("1"==this.options.patients[g.patient_id].has_avatar?"":" visitWritingsNoAvatar")+(0<g.visit_image2?" visitWritingsVisitHas2Images":0<g.visit_image?" visitWritingsVisitHasImage":"")+'">';h+='<a href="#schedule-visits/list/'+g.patient_id+'" class="visitAvatar"><img src="'+this.options.patients[g.patient_id].img+'" class="clickable"></a>';h+='<div class="visittime">'+p+" - "+q+"</div>";m&&(h+='<div class="visitExternal_id">'+m+"</div>");h+='<div class="visitPatientName">'+
this.options.patients[g.patient_id].name+"</div>";h+='<div class="visitDoctorTitle'+(l?"":" hidden")+'">'+T.Doctor+"</div>";h+='<div class="visitDoctorName'+(l?"":" hidden")+'">'+this.options.doctors[g.doctor_id].name+"</div>";h+=""!=g.note?'<div class="visitNote" id="visitNote-'+f+'" style="max-height:0px;">'+g.note+"</div>":"";h+=SCHEDULE_VIEW==SCHEDULE_VIEW_DOCTORS?'<div class="scheduleViewDoctorsStatus scheduleViewDoctorsStatus'+g.status+'"></div>':"";parseInt(g.visit_image)&&(h+='<img class="visitEmoji" src="/c/_img/schedule-images/'+
g.visit_image+".png?"+visitImagesVersion+'">');parseInt(g.visit_image2)&&(h+='<img class="visitEmoji visitEmoji2" src="/c/_img/schedule-images/'+g.visit_image2+".png?"+visitImagesVersion+'">');h+="</div>";h+=""!=g.note?'<div class="visitNoteDots" id="visitNoteDots-'+f+'">...</div>':"";"undefined"!=typeof g.disabled&&(h="");document.getElementById("calVisitCell"+f).innerHTML='<div class="calVisitInfoCell" style="height:'+(n-this.options.paddingVisitBottom)+'px;">'+h+"</div>";""!=g.note&&e.push(f)}}this.displayLogTime("VISISTS-RECALCULATE-COMMENTS-HEIGHT_START");
for(f in e)this.recalculateCommentHeight($("#calVisitCell"+e[f]));this.displayLogTime("VISISTS-RECALCULATE-COMMENTS-HEIGHT_END")};this.displayShifts=function(){this.displayLogTime("displayShifts-start");var a="",b;for(b in this.options.doctorSchedule)for(var c in this.options.doctorSchedule[b])for(var d in this.options.doctorSchedule[b][c])for(var e in this.options.doctorSchedule[b][c][d]){var f=this.options.doctorSchedule[b][c][d][e],g=f.timeStart.time,p=f.timeEnd.time,q=this.getYCoordinateForTime(g,
"t")-30;f=this.getXCoordinateForTime(b,c);var n=this.getColumnIdByX(f,SCHEDULE_DEFAULT_CABINET_WIDTH),l="";if("undefined"!=typeof this.options.doctors[d].disabled){l=" disabled";var m=this.options.viewType==SCHEDULE_VIEW_TYPE_ASSISTANTS||this.options.viewType==SCHEDULE_VIEW_TYPE_ADMINISTRATORS?"<img  class='calItemDoctorCellImg' src='"+this.options.doctors[d].img+"'><span class='calItemDoctorCellSpan'>"+this.options.doctors[d].name+"</span>":""}else m="<img  class='calItemDoctorCellImg' src='"+this.options.doctors[d].img+
"'><span class='calItemDoctorCellSpan'>"+this.options.doctors[d].name+"</span>";a+='<div class="calItemDoctorCell'+l+'" id="shift'+e+'" _doc_id="'+d+'" _id="'+e+'" _tim_s="'+g+'" _tim_e="'+p+'" style="position:absolute; top:'+q+"px; left:"+f+'px">'+m+"</div>";g=q+30;p=this.getYCoordinateForTime(p,"t");"undefined"!=typeof this.doctorsCellsCoords[n][p-30]&&(p-=30);n=parseInt(p-g)-this.options.paddingDoctorShiftBottom;a+='<div class="calItemDoctorWorkTime'+l+'" _id="'+e+'" _doc="'+d+'" style=" top:'+
g+"px; left:"+f+"px;  height:"+n+'px;  "></div>'}this.displayLogTime("displayShifts-end");$("#scheduleBodyContainer").append(a);this.displayLogTime("displayShifts-append")};this.displaySpaces=function(){var a="",b=[],c;for(c in this.options.spaces){var d=this.options.spaces[c],e=d.visit_time.timeStart.time,f=d.visit_time.timeEnd.time,g=this.getXCoordinateForTime(d.datetime,d.cabinet_id),p=this.getColumnIdByX(g,SCHEDULE_DEFAULT_CABINET_WIDTH),q=this.getYCoordinateForTimeColumn(p,e),n=this.getYCoordinateForTimeColumn(p,
f);"undefined"!=typeof this.doctorsCellsCoords[p]&&"undefined"!=typeof this.doctorsCellsCoords[p][n-30]&&(n-=30);p=n-q;n='<div class="visitWritingsContainer visitWritingsNoAvatar">';n+='<div class="visitPatientName">'+this.options.spacesTypes[d.type].name+"</div>";n+='<div class="visittime">'+e+" - "+f+"</div>";n+=""!=d.note?'<div class="visitNote" id="visitNote-'+c+'" style="max-height:0px;">'+d.note+"</div>":"";n+="</div>";n+=""!=d.note?'<div class="visitNoteDots" id="visitNoteDots-'+c+'">...</div>':
"";e=' _tim_s="'+e+'"';e+=' _tim_e="'+f+'"';e+=' _cab="'+d.cabinet_id+'"';e+=' _dat="'+d.datetime+'"';e+=' _vis="'+c+'"';f="";"undefined"!=typeof d.disabled&&(e+=' _disabled="1"',f=" disabled",this.options.viewType==SCHEDULE_VIEW_TYPE_VISITS&&(n=""));a+='<div id="calVisitCell'+c+'" class="calVisitCell calSpaceCell '+f+'"'+e+' style="top:'+q+"px;left:"+g+"px;height:"+p+'px;"><div class="calVisitInfoCell" style="height:'+(p-this.options.paddingVisitBottom)+'px;">'+n+"</div></div>";""!=d.note&&b.push(c)}$("#scheduleBodyContainer").append(a);
this.displayLogTime("SPACE-RECALCULATE-COMMENTS-HEIGHT_FINISH-1");for(c in b)this.recalculateCommentHeight($("#calVisitCell"+b[c]));this.displayLogTime("SPACE-RECALCULATE-COMMENTS-HEIGHT_FINISH-2")};this.displayActiveElements=function(){if("undefined"!=typeof calendarSelectedVisitIdOnLoad){var a=$("#calVisitCell"+calendarSelectedVisitIdOnLoad);this.setActiveVisit(a);delete calendarSelectedVisitIdOnLoad}else"undefined"!=typeof calendarSelectedShiftIdOnLoad?(a=$("#shift"+calendarSelectedShiftIdOnLoad),
this.setActiveShift(a,!0),delete calendarSelectedShiftIdOnLoad):(null!=this.$ACTIVE_VISIT&&"undefined"!=typeof this.$ACTIVE_VISIT[0]&&"undefined"!=typeof this.$ACTIVE_VISIT[0].id?(a=$("#"+this.$ACTIVE_VISIT[0].id),this.setActiveVisit(a)):this.$ACTIVE_VISIT=null,null!=this.$ACTIVE_SHIFT&&"undefined"!=typeof this.$ACTIVE_SHIFT[0]&&"undefined"!=typeof this.$ACTIVE_SHIFT[0].id?(a=$("#"+this.$ACTIVE_SHIFT[0].id),this.setActiveShift(a)):this.$ACTIVE_SHIFT=null)};this.removeVisitTooltip=function(){$(".scheduleTooltipVisitStatusSelectContainer select").select2("destroy");
$(".sch_tooltip").remove()};this.removeShiftTooltip=function(){$(".sch_tooltip").remove()};this.doctorIsWorkForTime=function(a,b,c,d){if("undefined"==typeof this.options.doctorSchedule[a][b][c])return!1;for(var e in this.options.doctorSchedule[a][b][c]){var f=this.options.doctorSchedule[a][b][c][e].timeEnd.time;if(d>=this.options.doctorSchedule[a][b][c][e].timeStart.time&&d<=f)return!0}return!1};this.ksort_cabinets_ids=function(a){return Object.keys(a).sort(function(b,c){return parseInt(a[b].sort)<
parseInt(a[c].sort)?-1:parseInt(a[b].sort)>parseInt(a[c].sort)?1:0})};this.clickOnDate=function(a){$("#scheduleDatetimepickerMobile").is(":visible")?$("#scheduleDatetimepickerMobile").hide():$("#scheduleDatetimepickerMobile").show()};this.hideTooltipDatepicker=function(){$("#scheduleDatetimepickerMobile").is(":visible")&&$("#scheduleDatetimepickerMobile").hide()};this.hideContextMenu=function(a){if("undefined"!=typeof a&&a||needCloseContextMenu)$visibleMenu=$(".context-menu-list").filter(":visible"),
$visibleMenu.length&&$visibleMenu.trigger("contextmenu:hide",{force:!0}),needCloseContextMenu=!1};this.checkClickOnSchedule=function(){var a=this,b=null;$(".scheduleBodyContainer").bind("touchend",function(a){clearTimeout(b)});$(".scheduleBodyContainer").bind("touchmove",function(a){clearTimeout(b)});$(".scheduleBodyContainer").bind("touchcancel",function(a){clearTimeout(b)});$(".scheduleBodyContainer").bind("touchstart",function(c){a.hideContextMenu();$(".scheduleBodyContainer").contextMenu("hide");
clearTimeout(b);var d=$(this),e=c.originalEvent.changedTouches[0].pageX,f=c.originalEvent.changedTouches[0].pageY,n=$(c.target);b=setTimeout(function(){iPhonePressPosition=null;n.closest(".calItemDoctorWorkTime").length?n.closest(".calItemDoctorWorkTime").contextMenu({x:e,y:f}):n.closest(".calItemDoctorCell").length?n.closest(".calItemDoctorCell").contextMenu({x:e,y:f}):n.closest(".calVisitCell").length?n.closest(".calVisitCell").contextMenu({x:e,y:f}):d.contextMenu({x:e,y:f})},700);var l=c.timeStamp,
m=$(this).data("lastTouch")||l;m=l-m;var h=c.originalEvent.touches.length;$(this).data("lastTouch",l);if(!(!m||200<m||1<h))return c.preventDefault(),$("#scheduleContainer").trigger("click",[c.target,c.originalEvent.changedTouches[0].pageX,c.originalEvent.changedTouches[0].pageY]),!1});var c=0,d=null,e=null;$("#scheduleContainer").click(function(b,g,p,q){a.hideContextMenu();var f={};if("undefined"!=typeof g){var l=$(g);f.target=g;f.pageX=p;f.pageY=q}else l=$(b.target),f.target=b.target,f.pageX=b.pageX,
f.pageY=b.pageY;g=b.ctrlKey||b.metaKey;clearTimeout(e);e=setTimeout(function(){c=0},350);d!=l.get(0)&&(c=0);d=l.get(0);c++;if(b=1<c?!0:!1)a.calendarClickTime=null;if(clinicFlagResize)return!1;if(l.hasClass("clickable"))return!0;if(l.closest(".calDayCell").length)return a.clickOnDate(f),!1;a.hideTooltipDatepicker();if(l.closest(".calCabinetCell").length)return b&&a.dblClickOnCabinet(l.closest(".calCabinetCell")),!1;if(l.closest(".calItemDoctorCell").length){f=l.closest(".calItemDoctorCell");if(clinicFlagResize||
f.hasClass("disabled")||clinicMouseDraggableMCS)return!1;b?a.editShiftForm(f):(a.unSelectVisit(),null!=a.$ACTIVE_SHIFT&&a.$ACTIVE_SHIFT.attr("_id")!=f.attr("_id")&&a.unSelectShift(),a.setActiveShift(f));return!1}if(l.closest(".calItemDoctorWorkTime").length)return b?a.options.viewType==SCHEDULE_VIEW_TYPE_ASSISTANTS?a.addAssistantForm(f):a.addVisitForm(f):(null!=a.$ACTIVE_SHIFT&&l.closest(".calItemDoctorWorkTime").attr("_id")==a.$ACTIVE_SHIFT.attr("_id")||a.unSelectAllBlocks(),a.checkPasteBlockTime(f)),
!1;if(l.closest(".calVisitCell").length){l=l.closest(".calVisitCell");a.options.viewType!=SCHEDULE_VIEW_TYPE_VISITS&&a.checkPasteBlockTime(f);if((clinicFlagResize||l.hasClass("disabled")||clinicMouseDraggableMCS)&&a.options.viewType!=SCHEDULE_VIEW_TYPE_ASSISTANTS)return!0;if(b)l.hasClass("calAssistantCell")?a.editAssistantForm(l):l.hasClass("calAdministratorCell")?a.editAdministratorForm(l):l.hasClass("calSpaceCell")?a.options.viewType==SCHEDULE_VIEW_TYPE_ASSISTANTS?a.addAssistantForm(f):a.editSpaceForm(l):
a.editVisitForm(l);else{if(l.hasClass("calSpaceCell")&&a.options.viewType==SCHEDULE_VIEW_TYPE_ASSISTANTS)return!1;a.unSelectShift();null!=a.$ACTIVE_VISIT&&a.$ACTIVE_VISIT.attr("id")!=l.attr("id")&&a.unSelectVisit();a.setActiveVisit(l)}return!1}b?g?a.options.viewType==SCHEDULE_VIEW_TYPE_VISITS&&a.addShiftForm(f):a.options.viewType==SCHEDULE_VIEW_TYPE_ASSISTANTS?a.addAssistantForm(f):a.options.viewType==SCHEDULE_VIEW_TYPE_ADMINISTRATORS?a.addAdministratorForm(f):a.addVisitForm(f):(a.checkPasteBlockTime(f),
a.unSelectAllBlocks())})};this.getLogTimestamp=function(){return(new Date).getTime()};this.getLogTime=function(){return this.getLogTimestamp()-this.logStartTime};this.displayLogTime=function(a){if(!0===this.debugMode){var b=this.getLogTimestamp();console.log([b-this.logLastTime,this.getLogTime()],"---LOG---:"+a);this.logLastTime=b}};this.display=function(a){!0===this.debugMode&&(this.logStartTime=this.getLogTimestamp(),this.logLastTime=this.getLogTimestamp());$("#customCalendarCss").remove();var b=
this;b.options=a;a=200;if(this.options.viewType==SCHEDULE_VIEW_TYPE_ASSISTANTS||this.options.viewType==SCHEDULE_VIEW_TYPE_ADMINISTRATORS){this.intersectsAssistantMaxColumnsArray={};a={};for(var c in this.options.assistantSchedule){var d=this.options.assistantSchedule[c],e=d.shift_time.timeStart.time,f=d.shift_time.timeEnd.time;d=d.datetime+"-"+d.cabinet_id;"undefined"==typeof a[d]&&(a[d]=[]);a[d][c]={time_start:this.time2minutes(e),time_end:this.time2minutes(f)}}e={};c=0;for(d in a){f=a[d];e[d]={};
for(var g in f){var p=f[g],q=0;"undefined"==typeof e[g]&&(e[d][g]=[]);for(var n in f)if(n!=g){var l=f[n];intersectsTime(p.time_start,p.time_end,l.time_start,l.time_end)&&(e[d][g].push(n),q++)}this.intersectsAssistantMaxColumnsArray[d]="undefined"==typeof this.intersectsAssistantMaxColumnsArray[d]?q:Math.max(this.intersectsAssistantMaxColumnsArray[d],q);c=Math.max(c,q)}}this.intersectsAssistantArray=e;c=0;for(var m in b.intersectsAssistantArray){d=b.getSortedShiftKeys(b.intersectsAssistantArray[m]);
g=[];n=0;for(var h in d){n=d[h];g[n]=0;for(var k in this.intersectsAssistantArray[m][n])a=this.intersectsAssistantArray[m][n][k],"undefined"!=typeof g[a]&&(g[n]=Math.max(g[n],g[a]));g[n]++;c=Math.max(c,g[n])}}a=Math.max(40*c,200)}SCHEDULE_DEFAULT_CABINET_WIDTH=460<window.innerWidth?a:Math.max(window.innerWidth-45-8,a);h='<style id="customCalendarCss" type="text/css">#gridCabinetsContainer .calCabinetCell{width:'+(SCHEDULE_DEFAULT_CABINET_WIDTH+"px;}");h+=".scheduleHeaderContainer span{width:"+SCHEDULE_DEFAULT_CABINET_WIDTH+
"px;}";h+="#gridPaddingContainer div{width:"+SCHEDULE_DEFAULT_CABINET_WIDTH+"px;}";h+=".scheduleCabinetColumn{width:"+SCHEDULE_DEFAULT_CABINET_WIDTH+"px;}";h+=".calVisitCell{width:"+SCHEDULE_DEFAULT_CABINET_WIDTH+"px;}";h+=".schedule_clinic_not_working{width:"+SCHEDULE_DEFAULT_CABINET_WIDTH+"px;}";h+=".calItemDoctorWorkTime{width:"+(SCHEDULE_DEFAULT_CABINET_WIDTH-3)+"px;}";h+=".calItemDoctorCell{width:"+(SCHEDULE_DEFAULT_CABINET_WIDTH-3)+"px;}";h+=".mobileDevice .calItemDoctorWorkTime .ui-resizable-n{margin-left:"+
(SCHEDULE_DEFAULT_CABINET_WIDTH-39)+"px;}";SCHEDULE_VIEW==SCHEDULE_VIEW_DOCTORS?(h+=".visitPatientName {max-width: "+(SCHEDULE_DEFAULT_CABINET_WIDTH-65)+"px;}",h+=".visitWritingsVisitHasImage .visitPatientName {max-width: "+(SCHEDULE_DEFAULT_CABINET_WIDTH-90)+"px;}",h+=".visitWritingsVisitHas2Images .visitPatientName {max-width: "+(SCHEDULE_DEFAULT_CABINET_WIDTH-115)+"px;}",h+=".visitWritingsNoAvatar .visitPatientName {max-width: "+(SCHEDULE_DEFAULT_CABINET_WIDTH-35)+"px;}",h+=".visitWritingsNoAvatar.visitWritingsVisitHasImage .visitPatientName {max-width: "+
(SCHEDULE_DEFAULT_CABINET_WIDTH-63)+"px;}",h+=".visitWritingsNoAvatar.visitWritingsVisitHas2Images .visitPatientName {max-width: "+(SCHEDULE_DEFAULT_CABINET_WIDTH-83)+"px;}"):(h+=".visitPatientName {max-width: "+(SCHEDULE_DEFAULT_CABINET_WIDTH-55)+"px;}",h+=".visitWritingsVisitHasImage .visitPatientName {max-width: "+(SCHEDULE_DEFAULT_CABINET_WIDTH-70)+"px;}",h+=".visitWritingsVisitHas2Images .visitPatientName {max-width: "+(SCHEDULE_DEFAULT_CABINET_WIDTH-95)+"px;}",h+=".visitWritingsNoAvatar.visitWritingsVisitHasImage .visitPatientName {max-width: "+
(SCHEDULE_DEFAULT_CABINET_WIDTH-37)+"px;}",h+=".visitWritingsNoAvatar.visitWritingsVisitHas2Images .visitPatientName {max-width: "+(SCHEDULE_DEFAULT_CABINET_WIDTH-37)+"px;}",h+=".visitWritingsNoAvatar .visitPatientName {max-width: "+(SCHEDULE_DEFAULT_CABINET_WIDTH-15)+"px;}");h+=".calItemDoctorCell span.calItemDoctorCellSpan {max-width: "+(SCHEDULE_DEFAULT_CABINET_WIDTH-48)+"px;}";h+=".visitDoctorName {max-width: "+(SCHEDULE_DEFAULT_CABINET_WIDTH-55)+"px;}";h+="</style>";$("head").append(h);b.options.paddingDoctorShiftBottom=
0;b.options.paddingVisitBottom=3;b.options.ordered_cabinets=b.ksort_cabinets_ids(b.options.cabinets);$(".scheduleBodyContainer").unbind();$("#saveScheduleFiltersBtn").unbind();$("#scheduleContainer").unbind();this.displayLogTime("INIT");this.checkClickOnSchedule();this.displayLogTime("checkClickOnSchedule");clearInterval(currentTimeInterval);currentCalendarDateTime=!1;this.visibleVisits={};this.visibleVisitsTimer=0;this.timesYCoords=[];this.timesY2Coords=[];this.times=[];this.xCoords=[];this.blocks=
[];this.columnsInfo=[];this.doctorsCellsCoords=[];this.timeBlocks=[];this.columnYCoords=[];this.doctorScheduleTimes=[];this.calendar_global_block_id=0;this.stop_on_escape=this.needRefreshOnCloseModal=!1;$("#gridDaysContainer").html("");$("#gridPaddingContainer").html("");$("#gridTimeContainer").html("");$("#gridCabinetsContainer").html("");$("#scheduleBodyContainer").html("");$("#scheduleBodyContainer").append('<div class="scheduleHorizontalLinesContainer"></div>');$("#scheduleSidebarCurrentTimeLine").hide();
$(".currentTimeLine").hide();b.refreshGridTimes();this.displayLogTime("refreshGridTimes");m=Object.keys(this.options.cabinets).length;scheduleCountDays=k=Object.keys(this.options.days).length;scheduleDatetimepickerHighlightShownDays();this.displayLogTime("scheduleDatetimepickerHighlightShownDays");1==m?$("#scheduleContainer").addClass("oneCabinetSchedule").removeClass("multipleCabinetsSchedule"):$("#scheduleContainer").addClass("multipleCabinetsSchedule").removeClass("oneCabinetSchedule");h=new Date;
c=h.getDate();d=h.getMonth()+1;h=h.getFullYear();10>c&&(c="0"+c);10>d&&(d="0"+d);h=h+"-"+d+"-"+c;g=0;a=n="";for(var t in b.options.days){c=!isMobileDevice&&1<m&&0==g;var r=b.options.days[t];d=0==parseInt(r.active)?" scheduleHolidayDay ":r.date==h?" scheduleTodayDay ":"";e=1==m||1==k?" oneCabinet":"";if(200<SCHEDULE_DEFAULT_CABINET_WIDTH)for(var v=1;v<=m;v++)f=1<m&&v==m?" boldBorder ":"",n+='<div class="calDayCell'+(v<m?" dayClassBorderRightDashed ":"")+e+d+f+'" style="width:'+SCHEDULE_DEFAULT_CABINET_WIDTH+
'px">'+r.title+"</div>";else f=1<m?" boldBorder ":"",n+='<div class="calDayCell'+f+e+d+'" style="width:'+SCHEDULE_DEFAULT_CABINET_WIDTH*m+"px;"+(c?"padding-left:0;":"")+'">'+(c?'<b class="clickable" id="prevDayButtonInDayLine"><i class="clickable fa fa-angle-left"></i></b>':"")+(c?'<b class="clickable" id="nextDayButtonInDayLine"><i class="clickable fa fa-angle-right"></i></b>':"")+r.title+"</div>";c=0;for(v in b.options.ordered_cabinets)d=b.options.cabinets[b.options.ordered_cabinets[v]],a=c==m-
1&&0!=c&&1<k||1==m||1==k?a+('<div class="calCabinetCell day cabinetColor'+d.color+'" _id="'+d.id+'" >'+d.name+"</div>"):a+('<div class="calCabinetCell cabinetColor'+d.color+'"  _id="'+d.id+'">'+d.name+"</div>"),c++;g++}$("#gridDaysContainer").append(n);$("#gridCabinetsContainer").append(a);this.displayLogTime("\u041e\u0442\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u0434\u043d\u0435\u0439");b.displayVisits();this.displayLogTime("displayVisits");$(".scheduleHeaderContainer, .scheduleBodyContainer").css("width",
SCHEDULE_DEFAULT_CABINET_WIDTH*m*k);$(".scheduleBodyContainer").css("height",$("#gridTimeContainer").height());this.displayLogTime("\u041e\u0442\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u0432\u0435\u0440\u0442\u0438\u043a\u0430\u043b\u044c\u043d\u044b\u0445 \u043b\u0438\u043d\u0438\u0439-start");h=0;g="";for(t in b.options.days){c=0;for(v in b.options.ordered_cabinets)d=c==m-1&&h==k-1?"lastDay":c==m-1&&0!=c&&1<k||1==m?"day":"",g+='<div class="scheduleCabinetColumn '+d+'"></div>',c++;
h++}$("#scheduleBodyContainer").append(g);this.displayLogTime("\u041e\u0442\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u0432\u0435\u0440\u0442\u0438\u043a\u0430\u043b\u044c\u043d\u044b\u0445 \u043b\u0438\u043d\u0438\u0439 - \u0435\u043d\u0434");currentTimeInterval=setInterval(function(){calendarCurrentTimeLineInit(calendar)},1E3);calendarCurrentTimeLineInit(calendar);this.displayLogTime("calendarCurrentTimeLineInit");this.displayLogTime("workAreaKeydown-\u0441\u0442\u0430\u0440\u0442");
$(".scheduleBodyContainer").keydown(function(a){b.workAreaKeydown(a)});this.displayLogTime("workAreaKeydown-\u0435\u043d\u0434");this.displayLogTime("$(.scheduleCabinetColumn).height(");t="";for(r in this.options.clinicSchedule)if(v=this.options.clinicSchedule[r],1==this.options.days[r].active){h=this.time2minutes(v.timeStart.time);if(h>this.timeStartMin)for(var w in b.options.ordered_cabinets)d=b.options.ordered_cabinets[w],d=this.getColumnIdByDayAndCabinet(r,d),m=d*SCHEDULE_DEFAULT_CABINET_WIDTH,
k=this.getYCoordinateForTime(this.minutes2time(h),"t"),t+='<div class="schedule_clinic_not_working" style="top:0px; left:'+m+"px; height:"+k+'px;"></div>';v=this.time2minutes(v.timeEnd.time);if(v<this.timeEndMin)for(w in b.options.ordered_cabinets)d=b.options.ordered_cabinets[w],d=this.getColumnIdByDayAndCabinet(r,d),m=d*SCHEDULE_DEFAULT_CABINET_WIDTH,h=this.getYCoordinateForTime(this.minutes2time(v),"t"),k=this.getYCoordinateForTime(this.minutes2time(this.timeEndMin),"t")-h,t+='<div class="schedule_clinic_not_working" style="top:'+
h+"px; left:"+m+"px; height:"+k+'px;"></div>'}else for(w in b.options.ordered_cabinets)d=b.options.ordered_cabinets[w],d=this.getColumnIdByDayAndCabinet(r,d),m=d*SCHEDULE_DEFAULT_CABINET_WIDTH,k=this.getYCoordinateForTime(this.minutes2time(this.timeEndMin),"t"),t+='<div class="schedule_clinic_not_working" style="top:0px; left:'+m+"px; height:"+k+'px;"></div>';$(".scheduleBodyContainer").append(t);this.displayLogTime("\u0437\u0430\u0434\u0430\u0435\u043c \u043e\u0431\u043b\u0430\u0441\u0442\u0438 \u043d\u0435\u0440\u0430\u0431\u043e\u0442\u044b \u043a\u043b\u0438\u043d\u0438\u043a\u0438 \u043f\u043e \u0434\u043d\u044f\u043c");
resfreshScrollAreas();this.displayLogTime("resfreshScrollAreas");$scheduleBody=$(".scheduleBody");"undefined"!=typeof $scheduleBody[0].mcs?preloadCalendar($scheduleBody[0].mcs):preloadedCalendar?preloadCalendar(!1,$scheduleBody):setTimeout(function(){preloadCalendar(!1,$scheduleBody)},50);b.displaySpaces();b.displayActiveElements();b.displayLogTime("initCalendarBlocks-start");b.initCalendarBlocks();b.displayLogTime("initCalendarBlocks-end");this.displayLogTime("displaySpaces")};this.set_filters=function(){var a=
$.cookie("sch"+calendar.options.viewType);(a=a?JSON.parse(a):{})&&"object"==typeof a||(a={});var b={d:$("#scheduleSearchForm_countDays").val()},c=0,d=[];$(".cheduleSearchForm_cabitet").each(function(){c++;this.checked&&d.push(this.value)});c!=d.length&&(b.c=d.join(","));"0"!=$("#scheduleSearchForm_clinicMemberId").val()&&(b.m=$("#scheduleSearchForm_clinicMemberId").val());"undefined"==typeof a[currentCabinetUserId]&&(a[currentCabinetUserId]={});"0"!=$("#scheduleSearchForm_imageN").val()&&(b.i=$("#scheduleSearchForm_imageN").val());
a[currentCabinetUserId][currentClinicId]=b;$.cookie("sch"+calendar.options.viewType,JSON.stringify(a),{expires:1825,path:"/"});refreshCalendar(this.options.date,!0)};this.dblClickOnCabinet=function(a){var b=$(a).attr("_id"),c=0,d=[];$(".cheduleSearchForm_cabitet").each(function(){c++;this.checked&&d.push(this.value)});c!=d.length?$(".cheduleSearchForm_cabitet").each(function(){this.checked||$(this).click()}):$(".cheduleSearchForm_cabitet").each(function(){b!=this.value||this.checked?b!=this.value&&
this.checked&&$(this).click():$(this).click()});this.set_filters()};this.findNextBlockTopYByYAndColumn=function(a,b,c,d){var e=this.getYCoordinateForTimeColumn(a,this.timeEnd),f;for(f in this.blocks[a]){var g=this.blocks[a][f];if(g.db_id!=d||g.type!=c)"doctor"==c?"free"!=g.type&&"visit"!=g.type&&g.top>b&&(e=Math.min(e,g.top)):"free"!=g.type&&g.top>b&&(e=Math.min(e,g.top))}return e};this.copyVisit=function(a){currentClinicMemberHasAccess(ACCESS_SCHEDULE_VISITS_EDITING)&&(this.copy2MemBlock={type:"visit",
_tim_e:a.attr("_tim_e"),_tim_s:a.attr("_tim_s"),_doc:a.attr("_doc"),_pat:a.attr("_pat"),_vis:a.attr("_vis"),status:this.options.clientVisits[a.attr("_vis")].status,note:this.options.clientVisits[a.attr("_vis")].note});this.calendarClickTime=this.cut2MemBlock=null};this.copySpace=function(a){currentClinicMemberHasAccess(ACCESS_SCHEDULE_VISITS_EDITING)&&(this.copy2MemBlock={type:"space",_tim_e:a.attr("_tim_e"),_tim_s:a.attr("_tim_s"),_vis:a.attr("_vis"),note:this.options.spaces[a.attr("_vis")].note,
_type:this.options.spaces[a.attr("_vis")].type});this.calendarClickTime=this.cut2MemBlock=null};this.cutVisit=function(a){currentClinicMemberHasAccess(ACCESS_SCHEDULE_VISITS_EDITING)&&(this.cut2MemBlock={type:"visit",_tim_e:a.attr("_tim_e"),_tim_s:a.attr("_tim_s"),_doc:a.attr("_doc"),_pat:a.attr("_pat"),_vis:a.attr("_vis"),status:this.options.clientVisits[a.attr("_vis")].status,note:this.options.clientVisits[a.attr("_vis")].note});this.calendarClickTime=this.copy2MemBlock=null};this.cutSpace=function(a){currentClinicMemberHasAccess(ACCESS_SCHEDULE_VISITS_EDITING)&&
(this.cut2MemBlock={type:"space",_tim_e:a.attr("_tim_e"),_tim_s:a.attr("_tim_s"),_vis:a.attr("_vis"),note:this.options.spaces[a.attr("_vis")].note,_type:this.options.spaces[a.attr("_vis")].type});this.calendarClickTime=this.copy2MemBlock=null};this.copyShift=function(a){currentClinicMemberHasAccess(ACCESS_SCHEDULE_SHIFTS_EDITING)&&(this.copy2MemBlock={type:"shift",_tim_e:a.attr("_tim_e"),_tim_s:a.attr("_tim_s"),_doc:a.attr("_doc_id"),_id:a.attr("_id")});this.calendarClickTime=this.cut2MemBlock=null};
this.cutShift=function(a){currentClinicMemberHasAccess(ACCESS_SCHEDULE_SHIFTS_EDITING)&&(this.cut2MemBlock={type:"shift",_tim_e:a.attr("_tim_e"),_tim_s:a.attr("_tim_s"),_doc:a.attr("_doc_id"),_id:a.attr("_id")});this.calendarClickTime=this.copy2MemBlock=null};this.deleteVisit=function(a){switch(this.options.viewType){case SCHEDULE_VIEW_TYPE_VISITS:currentClinicMemberHasAccess(ACCESS_SCHEDULE_VISITS_EDITING)&&currentClinicMemberHasAccess(ACCESS_SCHEDULE_DELETE)&&deleteScheduleVisit(a);break;case SCHEDULE_VIEW_TYPE_ADMINISTRATORS:currentClinicMemberHasAccess(ACCESS_SCHEDULE_ADMINISTRATOR_SHIFTS_EDITING)&&
currentClinicMemberHasAccess(ACCESS_SCHEDULE_DELETE)&&deleteScheduleVisit(a);break;case SCHEDULE_VIEW_TYPE_ASSISTANTS:currentClinicMemberHasAccess(ACCESS_SCHEDULE_ASSISTANT_SHIFTS_EDITING)&&currentClinicMemberHasAccess(ACCESS_SCHEDULE_DELETE)&&deleteScheduleVisit(a)}};this.deleteSpace=function(a){currentClinicMemberHasAccess(ACCESS_SCHEDULE_VISITS_EDITING)&&currentClinicMemberHasAccess(ACCESS_SCHEDULE_DELETE)&&deleteScheduleSpace(a)};this.deleteShift=function(a){switch(this.options.viewType){case SCHEDULE_VIEW_TYPE_VISITS:currentClinicMemberHasAccess(ACCESS_SCHEDULE_SHIFTS_EDITING)&&
currentClinicMemberHasAccess(ACCESS_SCHEDULE_DELETE)&&deleteScheduleShift(a);break;case SCHEDULE_VIEW_TYPE_ADMINISTRATORS:currentClinicMemberHasAccess(ACCESS_SCHEDULE_ADMINISTRATOR_SHIFTS_EDITING)&&currentClinicMemberHasAccess(ACCESS_SCHEDULE_DELETE)&&deleteScheduleShift(a);break;case SCHEDULE_VIEW_TYPE_ASSISTANTS:currentClinicMemberHasAccess(ACCESS_SCHEDULE_ASSISTANT_SHIFTS_EDITING)&&currentClinicMemberHasAccess(ACCESS_SCHEDULE_DELETE)&&deleteScheduleShift(a)}};this.addShiftForm=function(a){if(currentClinicMemberHasAccess(ACCESS_SCHEDULE_SHIFTS_EDITING)){a=
this.getInfoForClickPoint(a);var b=this.strtimeToObject(a.time),c=b.h+6;for(e in this.blocks[a.column])if("visit"!=this.blocks[a.column][e].type){var d=Math.round(this.blocks[a.column][e].top);if(d>a.clickY){a.maxTime=this.getTimeForYCoordColumn(a.column,d);break}}for(e in this.blocks[a.column])if(d=Math.round(this.blocks[a.column][e].bottom),d<a.clickY){a.minTime=this.getTimeForYCoordColumn(a.column,d);break}var e=this.timeDisplay(c,b.m);a.maxTime&&this.time2minutes(e)>this.time2minutes(a.maxTime)&&
(e=a.maxTime);b=this.timeDisplay(b.h,b.m);a.minTime&&this.time2minutes(b)<this.time2minutes(a.minTime)&&(b=a.minTime);showScheduleShiftModalForm({refresh_location:0,timeStart:b,timeEnd:e,cabinetId:this.columnsInfo[a.column].cabinet_info.id,date:this.columnsInfo[a.column].day_info.date})}};this.addSpaceForm=function(a){if(currentClinicMemberHasAccess(ACCESS_SCHEDULE_VISITS_EDITING)){var b=this.getInfoForClickPoint(a),c=this.strtimeToObject(b.time),d=c.h+1,e;for(e in this.blocks[b.column]){var f=Math.round(this.blocks[b.column][e].top);
if(f>b.clickY){b.maxTime=this.getTimeForYCoordColumn(b.column,f);break}}for(e in this.blocks[b.column])if(f=Math.round(this.blocks[b.column][e].bottom),f<b.clickY){b.minTime=this.getTimeForYCoordColumn(b.column,f);break}d=this.timeDisplay(d,c.m);b.maxTime&&this.time2minutes(d)>this.time2minutes(b.maxTime)&&(d=b.maxTime);c=this.timeDisplay(c.h,c.m);b.minTime&&this.time2minutes(c)<this.time2minutes(b.minTime)&&(c=b.minTime);a=$(a.target);a.closest(".calItemDoctorWorkTime").length?showSpaceForm({refresh_location:0,
timeStart:c,timeEnd:d,clinicMemberId:a.closest(".calItemDoctorWorkTime").attr("_doc"),cabinetId:this.columnsInfo[b.column].cabinet_info.id,date:this.columnsInfo[b.column].day_info.date}):showSpaceForm({refresh_location:0,timeStart:c,timeEnd:d,cabinetId:this.columnsInfo[b.column].cabinet_info.id,date:this.columnsInfo[b.column].day_info.date})}};this.addVisitForm=function(a){if(currentClinicMemberHasAccess(ACCESS_SCHEDULE_VISITS_EDITING)){var b=this.getInfoForClickPoint(a),c=this.strtimeToObject(b.time),
d=c.h+1,e;for(e in this.blocks[b.column]){var f=Math.round(this.blocks[b.column][e].top);if(f>b.clickY){b.maxTime=this.getTimeForYCoordColumn(b.column,f);break}}for(e in this.blocks[b.column])if(f=Math.round(this.blocks[b.column][e].bottom),f<b.clickY){b.minTime=this.getTimeForYCoordColumn(b.column,f);break}d=this.timeDisplay(d,c.m);b.maxTime&&this.time2minutes(d)>this.time2minutes(b.maxTime)&&(d=b.maxTime);c=this.timeDisplay(c.h,c.m);b.minTime&&this.time2minutes(c)<this.time2minutes(b.minTime)&&
(c=b.minTime);a=$(a.target);a.closest(".calItemDoctorWorkTime").length?showVisitForm({refresh_location:0,timeStart:c,timeEnd:d,clinicMemberId:a.closest(".calItemDoctorWorkTime").attr("_doc"),cabinetId:this.columnsInfo[b.column].cabinet_info.id,date:this.columnsInfo[b.column].day_info.date}):showVisitForm({refresh_location:0,timeStart:c,timeEnd:d,cabinetId:this.columnsInfo[b.column].cabinet_info.id,date:this.columnsInfo[b.column].day_info.date})}};this.editVisitForm=function(a){var b=a.attr("_vis"),
c=this.options.clientVisits[b],d=a.attr("column_id");showVisitForm({scheduleVisitId:b,refresh_location:0,status:c.status,note:c.note,timeStart:a.attr("_tim_s"),timeEnd:a.attr("_tim_e"),cabinetId:this.columnsInfo[d].cabinet_info.id,clinicMemberId:a.attr("_doc"),date:this.columnsInfo[d].day_info.date,patientId:a.attr("_pat"),visit_image:this.options.clientVisits[b].visit_image,visit_image2:this.options.clientVisits[b].visit_image2})};this.editSpaceForm=function(a){var b=a.attr("_vis"),c=this.options.spaces[b],
d=a.attr("column_id");showSpaceForm({scheduleSpaceId:b,refresh_location:0,note:c.note,timeStart:a.attr("_tim_s"),timeEnd:a.attr("_tim_e"),cabinetId:this.columnsInfo[d].cabinet_info.id,date:this.columnsInfo[d].day_info.date})};this.editShiftForm=function(a){if(currentClinicMemberHasAccess(ACCESS_SCHEDULE_SHIFTS_EDITING)){var b=a.attr("column_id");showScheduleShiftModalForm({refresh_location:0,scheduleShiftId:a.attr("_id"),timeStart:a.attr("_tim_s"),timeEnd:a.attr("_tim_e"),clinicMemberId:a.attr("_doc_id"),
cabinetId:this.columnsInfo[b].cabinet_info.id,date:this.columnsInfo[b].day_info.date})}};this.pasteVisit=function(){if(currentClinicMemberHasAccess(ACCESS_SCHEDULE_VISITS_EDITING)){var a=this.calendarClickTime[1],b=this.calendarClickTime[0];if(null!=this.cut2MemBlock){var c=this.time2minutes(this.cut2MemBlock._tim_e)-this.time2minutes(this.cut2MemBlock._tim_s);c=this.minutes2time(this.time2minutes(b)+c);var d=this.cut2MemBlock._vis,e=this.findNextBlockTopYByYAndColumn(a,this.getYCoordinateForTimeColumn(a,
b),"visit",this.cut2MemBlock._vis),f=this.getYCoordinateForTimeColumn(a,c);e<f&&(c=this.getTimeForYCoordColumn(a,e));showVisitForm({scheduleVisitId:d,refresh_location:0,event:"ctrlX",timeStart:b,timeEnd:c,status:this.cut2MemBlock.status,note:this.cut2MemBlock.note,cabinetId:this.columnsInfo[a].cabinet_info.id,clinicMemberId:"undefined"!=typeof this.calendarClickTime[2]?this.calendarClickTime[2]:this.cut2MemBlock._doc,date:this.columnsInfo[a].day_info.date,patientId:this.cut2MemBlock._pat})}else null!=
this.copy2MemBlock&&(this.unSelectAllBlocks(),c=this.time2minutes(this.copy2MemBlock._tim_e)-this.time2minutes(this.copy2MemBlock._tim_s),c=this.minutes2time(this.time2minutes(b)+c),e=this.findNextBlockTopYByYAndColumn(a,this.getYCoordinateForTimeColumn(a,b),"visit",null),f=this.getYCoordinateForTimeColumn(a,c),e<f&&(c=this.getTimeForYCoordColumn(a,e)),showVisitForm({refresh_location:0,event:"ctrlC",timeStart:b,timeEnd:c,cabinetId:this.columnsInfo[a].cabinet_info.id,clinicMemberId:"undefined"!=typeof this.calendarClickTime[2]?
this.calendarClickTime[2]:this.copy2MemBlock._doc,date:this.columnsInfo[a].day_info.date,patientId:this.copy2MemBlock._pat}))}this.calendarClickTime=null};this.pasteSpace=function(){if(currentClinicMemberHasAccess(ACCESS_SCHEDULE_VISITS_EDITING)){var a=this.calendarClickTime[1],b=this.calendarClickTime[0];if(null!=this.cut2MemBlock){var c=this.time2minutes(this.cut2MemBlock._tim_e)-this.time2minutes(this.cut2MemBlock._tim_s);c=this.minutes2time(this.time2minutes(b)+c);var d=this.cut2MemBlock._vis,
e=this.findNextBlockTopYByYAndColumn(a,this.getYCoordinateForTimeColumn(a,b),"visit",this.cut2MemBlock._vis),f=this.getYCoordinateForTimeColumn(a,c);e<f&&(c=this.getTimeForYCoordColumn(a,e));showSpaceForm({scheduleSpaceId:d,refresh_location:0,event:"ctrlX",timeStart:b,timeEnd:c,note:this.cut2MemBlock.note,type:this.cut2MemBlock._type,cabinetId:this.columnsInfo[a].cabinet_info.id,date:this.columnsInfo[a].day_info.date})}else null!=this.copy2MemBlock&&(this.unSelectAllBlocks(),c=this.time2minutes(this.copy2MemBlock._tim_e)-
this.time2minutes(this.copy2MemBlock._tim_s),c=this.minutes2time(this.time2minutes(b)+c),e=this.findNextBlockTopYByYAndColumn(a,this.getYCoordinateForTimeColumn(a,b),"visit",null),f=this.getYCoordinateForTimeColumn(a,c),e<f&&(c=this.getTimeForYCoordColumn(a,e)),showSpaceForm({refresh_location:0,event:"ctrlC",timeStart:b,timeEnd:c,cabinetId:this.columnsInfo[a].cabinet_info.id,date:this.columnsInfo[a].day_info.date,type:this.copy2MemBlock._type}))}this.calendarClickTime=null};this.pasteShift=function(){if(currentClinicMemberHasAccess(ACCESS_SCHEDULE_SHIFTS_EDITING)){var a=
this.calendarClickTime[1],b=this.calendarClickTime[0];if(null!=this.cut2MemBlock){var c=this.time2minutes(this.cut2MemBlock._tim_e)-this.time2minutes(this.cut2MemBlock._tim_s);c=this.minutes2time(this.time2minutes(b)+c);var d=this.cut2MemBlock._id,e=this.findNextBlockTopYByYAndColumn(a,this.getYCoordinateForTimeColumn(a,b),"doctor",this.cut2MemBlock._id),f=this.getYCoordinateForTimeColumn(a,c);e<f&&(c=this.getTimeForYCoordColumn(a,e));showScheduleShiftModalForm({scheduleShiftId:d,refresh_location:0,
event:"ctrlX",timeStart:b,timeEnd:c,cabinetId:this.columnsInfo[a].cabinet_info.id,clinicMemberId:"undefined"!=typeof this.calendarClickTime[2]?this.calendarClickTime[2]:this.cut2MemBlock._doc,date:this.columnsInfo[a].day_info.date})}else null!=this.copy2MemBlock&&(this.unSelectAllBlocks(),c=this.time2minutes(this.copy2MemBlock._tim_e)-this.time2minutes(this.copy2MemBlock._tim_s),c=this.minutes2time(this.time2minutes(b)+c),e=this.findNextBlockTopYByYAndColumn(a,this.getYCoordinateForTimeColumn(a,b),
"doctor",null),f=this.getYCoordinateForTimeColumn(a,c),e<f&&(c=this.getTimeForYCoordColumn(a,e)),showScheduleShiftModalForm({refresh_location:0,event:"ctrlC",timeStart:b,timeEnd:c,cabinetId:this.columnsInfo[a].cabinet_info.id,clinicMemberId:"undefined"!=typeof this.calendarClickTime[2]?this.calendarClickTime[2]:this.copy2MemBlock._doc,date:this.columnsInfo[a].day_info.date}))}this.calendarClickTime=null};this.workAreaKeydown=function(a){if(8==a.keyCode||46==a.keyCode||8==a.which||46==a.which)null!=
this.$ACTIVE_VISIT?this.$ACTIVE_VISIT.hasClass("calAdministratorCell")?this.deleteAdministrator(this.$ACTIVE_VISIT.attr("_vis")):this.$ACTIVE_VISIT.hasClass("calAssistantCell")?this.deleteAssistant(this.$ACTIVE_VISIT.attr("_vis")):this.$ACTIVE_VISIT.hasClass("calSpaceCell")?this.deleteSpace(this.$ACTIVE_VISIT.attr("_vis")):this.deleteVisit(this.$ACTIVE_VISIT.attr("_vis")):null!=this.$ACTIVE_SHIFT&&this.deleteShift(this.$ACTIVE_SHIFT.attr("_id"));if(27===a.which||27===a.keyCode)this.stop_on_escape=
!0,$(".ui-resizable-resizing").trigger("mouseup"),$(".calVisitCell.draggable").trigger("mouseup"),$(".calItemDoctorCell.draggable").trigger("mouseup"),this.calendarClickTime=this.copy2MemBlock=this.cut2MemBlock=null,this.unSelectAllBlocks();if(a.ctrlKey||a.metaKey){if(null!=this.$ACTIVE_VISIT)if(67===a.keyCode||67===a.which)this.$ACTIVE_VISIT.hasClass("calAdministratorCell")?this.copyAdministrator(this.$ACTIVE_VISIT):this.$ACTIVE_VISIT.hasClass("calAssistantCell")?this.copyAssistant(this.$ACTIVE_VISIT):
this.$ACTIVE_VISIT.hasClass("calSpaceCell")?this.copySpace(this.$ACTIVE_VISIT):this.copyVisit(this.$ACTIVE_VISIT);else{if(88===a.keyCode||88===a.which)this.$ACTIVE_VISIT.hasClass("calAdministratorCell")?this.cutAdministrator(this.$ACTIVE_VISIT):this.$ACTIVE_VISIT.hasClass("calAssistantCell")?this.cutAssistant(this.$ACTIVE_VISIT):this.$ACTIVE_VISIT.hasClass("calSpaceCell")?this.cutSpace(this.$ACTIVE_VISIT):this.cutVisit(this.$ACTIVE_VISIT)}else null!=this.$ACTIVE_SHIFT&&(67===a.keyCode||67===a.which?
this.copyShift(this.$ACTIVE_SHIFT):(88===a.keyCode||88===a.which)&&this.cutShift(this.$ACTIVE_SHIFT));(86===a.keyCode||86===a.which)&&(this.cut2MemBlock||this.copy2MemBlock)&&null!=this.calendarClickTime&&(this.copy2MemBlock&&"administrator"==this.copy2MemBlock.type||this.cut2MemBlock&&"administrator"==this.cut2MemBlock.type?this.pasteAdministrator():this.copy2MemBlock&&"assistant"==this.copy2MemBlock.type||this.cut2MemBlock&&"assistant"==this.cut2MemBlock.type?this.pasteAssistant():this.copy2MemBlock&&
"visit"==this.copy2MemBlock.type||this.cut2MemBlock&&"visit"==this.cut2MemBlock.type?this.pasteVisit():this.copy2MemBlock&&"space"==this.copy2MemBlock.type||this.cut2MemBlock&&"space"==this.cut2MemBlock.type?this.pasteSpace():(this.copy2MemBlock&&"shift"==this.copy2MemBlock.type||this.cut2MemBlock&&"shift"==this.cut2MemBlock.type)&&this.pasteShift())}};this.onSuccessSave=function(a){this.needRefreshOnCloseModal=!1;"undefined"==typeof a?refreshCalendar(this.options.date,!1):refreshCalendarWithOptions(a,
!1);$(".scheduleBodyContainer").focus()};this.confirmVisit=function(a,b,c,d){this.needRefreshOnCloseModal=!0;var e=a.attr("_vis");a.hasClass("calAdministratorCell")?(b={refresh_location:0,event:c,timeStart:a.attr("_tim_s"),timeEnd:a.attr("_tim_e"),clinicMemberId:a.attr("_doc"),status:this.options.assistantSchedule[e].status,cabinetId:this.columnsInfo[b].cabinet_info.id,date:this.columnsInfo[b].day_info.date},"undefined"==typeof d?b.scheduleAdministratorId=e:b.note="",b.rate=a.attr("_rate"),showAdministratorForm(b)):
a.hasClass("calAssistantCell")?(b={refresh_location:0,event:c,timeStart:a.attr("_tim_s"),timeEnd:a.attr("_tim_e"),status:this.options.assistantSchedule[e].status,clinicMemberId:a.attr("_doc"),cabinetId:this.columnsInfo[b].cabinet_info.id,date:this.columnsInfo[b].day_info.date},"undefined"==typeof d?b.scheduleAssistantId=e:b.note="",b.rate=a.attr("_rate"),showAssistantForm(b)):a.hasClass("calSpaceCell")?(b={refresh_location:0,event:c,timeStart:a.attr("_tim_s"),timeEnd:a.attr("_tim_e"),note:this.options.spaces[e].note,
cabinetId:this.columnsInfo[b].cabinet_info.id,date:this.columnsInfo[b].day_info.date},"undefined"==typeof d?b.scheduleSpaceId=e:b.note="",showSpaceForm(b)):(b={refresh_location:0,event:c,timeStart:a.attr("_tim_s"),timeEnd:a.attr("_tim_e"),status:this.options.clientVisits[e].status,note:this.options.clientVisits[e].note,cabinetId:this.columnsInfo[b].cabinet_info.id,clinicMemberId:a.attr("_doc"),date:this.columnsInfo[b].day_info.date,patientId:a.attr("_pat"),visit_image:this.options.clientVisits[e].visit_image,
visit_image2:this.options.clientVisits[e].visit_image2},"undefined"==typeof d?b.scheduleVisitId=e:(b.status=1,b.note=""),showVisitForm(b))};this.confirmShift=function(a,b,c,d){this.needRefreshOnCloseModal=!0;var e=a.attr("_id");a={refresh_location:0,event:c,timeStart:a.attr("_tim_s"),timeEnd:a.attr("_tim_e"),cabinetId:this.columnsInfo[b].cabinet_info.id,clinicMemberId:a.attr("_doc_id"),date:this.columnsInfo[b].day_info.date};"undefined"==typeof d&&(a.scheduleShiftId=e);showScheduleShiftModalForm(a)};
this.removeResizableHandles=function(){isMobileDevice&&$(".resizableMarkerTop, .resizableMarkerBottom").remove()};this.unSelectVisit=function(){if(null!=this.$ACTIVE_VISIT){this.$ACTIVE_VISIT.removeClass("active");if(this.options.viewType==SCHEDULE_VIEW_TYPE_VISITS&&currentClinicMemberHasAccess(ACCESS_SCHEDULE_VISITS_EDITING)||this.options.viewType==SCHEDULE_VIEW_TYPE_ASSISTANTS&&currentClinicMemberHasAccess(ACCESS_SCHEDULE_ADMINISTRATOR_SHIFTS_EDITING)||this.options.viewType==SCHEDULE_VIEW_TYPE_ADMINISTRATORS&&
currentClinicMemberHasAccess(ACCESS_SCHEDULE_ADMINISTRATOR_SHIFTS_EDITING))this.$ACTIVE_VISIT.removeClass("draggable"),this.$ACTIVE_VISIT.clinicDraggableTouch("disable"),this.$ACTIVE_VISIT.hasClass("ui-resizable")&&this.$ACTIVE_VISIT.resizable("destroy"),this.removeResizableHandles();this.$ACTIVE_VISIT=null;this.removeVisitTooltip()}};this.unSelectShift=function(){if(null!=this.$ACTIVE_SHIFT){this.$ACTIVE_SHIFT.removeClass("active");this.$ACTIVE_SHIFT.removeClass("draggable");if(currentClinicMemberHasAccess(ACCESS_SCHEDULE_SHIFTS_EDITING)){this.$ACTIVE_SHIFT.clinicDraggableTouch("disable");
var a=this.$ACTIVE_SHIFT.next();a.hasClass("ui-resizable")&&a.resizable("destroy");this.removeResizableHandles()}this.$ACTIVE_SHIFT=null;this.removeShiftTooltip()}};this.unSelectAllBlocks=function(){this.unSelectVisit();this.unSelectShift()};this.findActualHeightElement=function(a,b,c,d,e){"undefined"==typeof e&&(e=!1);$element=$(a);if("undefined"==typeof c||"undefined"==typeof b||"undefined"==typeof d)d=$element.position(),b=this.getColumnIdByX($element.position().left,SCHEDULE_DEFAULT_CABINET_WIDTH),
c=d.top,d=d.top+$element.height();a="b"+$element.attr("block_id");if($element.hasClass("calVisitCell")){for(var f in this.blocks[b]){var g=this.blocks[b][f];if((f!=a&&!e||e)&&g.top<=c&&g.bottom>c)return!1}for(f in this.blocks[b])if(g=this.blocks[b][f],(f!=a&&!e||e)&&g.top<d&&g.top>c+1)return Math.round(g.top-c)}else{for(f in this.blocks[b])if(g=this.blocks[b][f],(f!=a&&!e||e)&&"doctor"==g.type){var p=this.getYCoordinateForTimeColumn(b,this.doctorScheduleTimes[g.db_id].timeEnd.time);if(g.top<=c&&p>
c)return!1}else if((f!=a&&!e||e)&&"visit"==g.type&&g.top<c&&g.bottom>c)return!1;for(f in this.blocks[b])if(g=this.blocks[b][f],"doctor"==g.type&&(f!=a&&!e||e)&&g.top<d&&g.top>c+1)return Math.round(g.top-c)}return!1};this.visitCheckPosition=function(a,b,c,d,e){"undefined"==typeof e&&(e=!1);$element=$(a);if("undefined"==typeof c||"undefined"==typeof b||"undefined"==typeof d)d=$element.position(),b=this.getColumnIdByX($element.position().left,SCHEDULE_DEFAULT_CABINET_WIDTH),c=d.top,d=d.top+$element.height();
a="b"+$element.attr("block_id");var f=!1,g;for(g in this.blocks[b]){var p=this.blocks[b][g];if((g!=a&&!e||e)&&"free"!=p.type&&intersectsY([Math.round(p.top),Math.round(p.bottom)],[c,d])){f=!0;break}}if(f)return $element.addClass("mistake"),!1;$element.removeClass("mistake");return!0};this.shiftCheckPosition=function(a,b,c,d,e){"undefined"==typeof e&&(e=!1);$element=$(a);if("undefined"==typeof c||"undefined"==typeof b||"undefined"==typeof d)d=$element.position(),b=this.getColumnIdByX($element.position().left,
SCHEDULE_DEFAULT_CABINET_WIDTH),c=Math.round(d.top),d=Math.round(d.top+$element.height());a="b"+$element.attr("block_id");var f=!1,g;for(g in this.blocks[b]){var p=this.blocks[b][g];if(g!=a&&!e||e)if("visit"==p.type&&Math.round(p.top)<c&&Math.round(p.bottom)>c){f=!0;break}else if("doctor"==p.type){var q=this.getYCoordinateForTimeColumn(b,this.doctorScheduleTimes[p.db_id].timeEnd.time);if(intersectsY([c,d],[Math.round(p.top),q])){f=!0;break}}}if(f)return $element.addClass("mistake"),!1;$element.removeClass("mistake");
return!0};this.customResizePlugin=function(a,b,c,d){var e=15;a.shiftKey&&(a.ctrlKey||a.metaKey)?e=60:a.altKey&&(a.ctrlKey||a.metaKey)?e=5:a.shiftKey?e=10:a.altKey&&(e=30);a=$(b).resizable("instance");var f=$(b).attr("column_id"),g=document.getElementById("scheduleSidebarContainer"),p=""==g.style.marginTop?0:g.style.marginTop;p=parseInt(p);g=a.options;var q=Math.round(a.position.top),n=a.size,l=a.originalSize,m=a.originalPosition,h=this.getTimeForYCoordColumn(f,m.top);h=this.time2minutes(h);m.top=
Math.round(m.top);l.height=Math.round(l.height);n.height=Math.round(n.height);"s"==a.axis?30<c-q-d.offset().top-p?n.height=Math.round(c-q-d.offset().top-p):n.height=30:c-d.offset().top-p<m.top+l.height-30?q=Math.round(c-d.offset().top-p):(q=Math.round(m.top+l.height-30),n.height=30);q=Math.max(0,q);"s"==a.axis?(q=this.getTimeForYCoordColumn(f,q+n.height),h=this.time2minutes(q),c=this.getTimeForYCoordColumn(f,m.top+l.height),l=this.time2minutes(c),d=Math.ceil(l/e)*e,p=this.minutes2time(d),c=Math.ceil((this.time2minutes(q)-
this.time2minutes(c))/e)*e,q<p&&d-h<e&&c<e?e=l+c:(c=Math.ceil((this.time2minutes(q)-this.time2minutes(p))/e)*e,e=d+c),m=this.getYCoordinateForTimeColumn(f,this.minutes2time(e))-m.top,a.size.height=Math.max(g.maxHeight?Math.min(m,g.maxHeight):m,30),$(".calVisitInfoCell",$(b)).css("height",a.size.height-this.options.paddingVisitBottom)):(c=this.getTimeForYCoordColumn(f,q),d=this.time2minutes(c),p=Math.ceil(h/e)*e,this.minutes2time(p),c=q<m.top?Math.floor((d-h)/e)*e:Math.ceil((d-h)/e)*e,Math.abs(c)<
e?e=h+c:(c=Math.round((d-p)/e)*e,e=p+c),f=this.getYCoordinateForTimeColumn(f,this.minutes2time(e)),g.maxHeight?(e=m.top+l.height-g.maxHeight,q<=e&&(f=e)):(e=0,0>=q&&(f=0)),m=-f+m.top+l.height,30<=m&&(a.size.height=Math.max(g.maxHeight?Math.min(m,g.maxHeight):m,30),a.position.top="undefined"!=typeof e?Math.max(f,e):f,$(".calVisitInfoCell",$(b)).css("height",a.size.height-this.options.paddingVisitBottom)));$(b).css("width","");g=Math.round(a.position.top);m=$(b).data("uiResizable").axis;f=$(b).attr("column_id");
if("n"==m)m=this.getTimeForYCoordColumn(f,g),e=$(b).attr("_tim_e");else{var k=g+Math.round(a.size.height);m=$(b).attr("_tim_s");e=this.getTimeForYCoordColumn(f,k)}$(b).attr("_tim_s_new",m);$(b).attr("_tim_e_new",e);$(b).css("top",a.position.top);$(b).css("height",a.size.height);k=$(b).hasClass("calItemDoctorWorkTime")?this.shiftCheckPosition(b,f,g,k):!0;m!=e&&k?$(b).removeClass("mistake"):$(b).addClass("mistake");$(".visittime",$(b)).html(m+" - "+e)};this.onHiddenModalEvent=function(){this.needRefreshOnCloseModal&&
refreshCalendar(this.options.date)};this.getContextMenuItems=function(a){var b={},c;for(c in a)switch(a[c]){case "create_visit":currentClinicMemberHasAccess(ACCESS_SCHEDULE_VISITS_EDITING)&&(b.create_visit={name:T["Create patient visit"],icon:"add"});break;case "create_assistant":currentClinicMemberHasAccess(ACCESS_SCHEDULE_ASSISTANT_SHIFTS_EDITING)&&(b.create_assistant={name:T["Create assistant shift"],icon:"add"});break;case "create_administrator":currentClinicMemberHasAccess(ACCESS_SCHEDULE_ADMINISTRATOR_SHIFTS_EDITING)&&
(b.create_administrator={name:T["Create administrator shift"],icon:"add"});break;case "create_shift":currentClinicMemberHasAccess(ACCESS_SCHEDULE_SHIFTS_EDITING)&&(b.create_shift={name:T["Create doctors shift"],icon:"add"});break;case "create_space":currentClinicMemberHasAccess(ACCESS_SCHEDULE_VISITS_EDITING)&&this.options.use_spaces_creation&&(b.create_space={name:T["Create space"],icon:"add"});break;case "paste_visit":if(null!=this.cut2MemBlock||null!=this.copy2MemBlock){var d=null!=this.cut2MemBlock?
this.cut2MemBlock:this.copy2MemBlock;"visit"==d.type&&currentClinicMemberHasAccess(ACCESS_SCHEDULE_VISITS_EDITING)&&(b.paste_visit={name:T["Paste patient visit"]+" (CTRL+V)",icon:"paste"})}break;case "paste_assistant":if(null!=this.cut2MemBlock||null!=this.copy2MemBlock)d=null!=this.cut2MemBlock?this.cut2MemBlock:this.copy2MemBlock,"assistant"==d.type&&currentClinicMemberHasAccess(ACCESS_SCHEDULE_ASSISTANT_SHIFTS_EDITING)&&(b.paste_assistant={name:T["Paste assistant shift"]+" (CTRL+V)",icon:"paste"});
break;case "paste_administrator":if(null!=this.cut2MemBlock||null!=this.copy2MemBlock)d=null!=this.cut2MemBlock?this.cut2MemBlock:this.copy2MemBlock,"administrator"==d.type&&currentClinicMemberHasAccess(ACCESS_SCHEDULE_ASSISTANT_SHIFTS_EDITING)&&(b.paste_administrator={name:T["Paste administrator shift"]+" (CTRL+V)",icon:"paste"});break;case "paste_space":if(null!=this.cut2MemBlock||null!=this.copy2MemBlock)d=null!=this.cut2MemBlock?this.cut2MemBlock:this.copy2MemBlock,"space"==d.type&&currentClinicMemberHasAccess(ACCESS_SCHEDULE_VISITS_EDITING)&&
(b.paste_space={name:T["Paste space"]+" (CTRL+V)",icon:"paste"});break;case "paste_shift":if(null!=this.cut2MemBlock||null!=this.copy2MemBlock)d=null!=this.cut2MemBlock?this.cut2MemBlock:this.copy2MemBlock,"shift"==d.type&&currentClinicMemberHasAccess(ACCESS_SCHEDULE_SHIFTS_EDITING)&&(b.paste_shift={name:T["Paste doctors shift"]+" (CTRL+V)",icon:"paste"});break;case "edit_visit":currentClinicMemberHasAccess(ACCESS_SCHEDULE_VISITS_EDITING)&&(b.edit_visit={name:T["Edit patient visit"],icon:"edit"});
break;case "edit_assistant":currentClinicMemberHasAccess(ACCESS_SCHEDULE_ASSISTANT_SHIFTS_EDITING)&&(b.edit_assistant={name:T["Edit assistant shift"],icon:"edit"});break;case "edit_administrator":currentClinicMemberHasAccess(ACCESS_SCHEDULE_ADMINISTRATOR_SHIFTS_EDITING)&&(b.edit_administrator={name:T["Edit administrator shift"],icon:"edit"});break;case "edit_space":currentClinicMemberHasAccess(ACCESS_SCHEDULE_VISITS_EDITING)&&(b.edit_space={name:T["Edit space"],icon:"edit"});break;case "copy_visit":currentClinicMemberHasAccess(ACCESS_SCHEDULE_VISITS_EDITING)&&
(b.copy_visit={name:T["Copy patient visit"]+" (CTRL+C)",icon:"copy"});break;case "copy_assistant":currentClinicMemberHasAccess(ACCESS_SCHEDULE_ASSISTANT_SHIFTS_EDITING)&&(b.copy_assistant={name:T["Copy assistant shift"]+" (CTRL+C)",icon:"copy"});break;case "copy_administrator":currentClinicMemberHasAccess(ACCESS_SCHEDULE_ADMINISTRATOR_SHIFTS_EDITING)&&(b.copy_administrator={name:T["Copy administrator shift"]+" (CTRL+C)",icon:"copy"});break;case "cut_visit":currentClinicMemberHasAccess(ACCESS_SCHEDULE_VISITS_EDITING)&&
(b.cut_visit={name:T["Cut patient visit"]+" (CTRL+X)",icon:"cut"});break;case "cut_assistant":currentClinicMemberHasAccess(ACCESS_SCHEDULE_ASSISTANT_SHIFTS_EDITING)&&(b.cut_assistant={name:T["Cut assistant shift"]+" (CTRL+X)",icon:"cut"});break;case "cut_administrator":currentClinicMemberHasAccess(ACCESS_SCHEDULE_ADMINISTRATOR_SHIFTS_EDITING)&&(b.cut_administrator={name:T["Cut administrator shift"]+" (CTRL+X)",icon:"cut"});break;case "copy_space":currentClinicMemberHasAccess(ACCESS_SCHEDULE_VISITS_EDITING)&&
(b.copy_space={name:T["Copy space"]+" (CTRL+C)",icon:"copy"});break;case "cut_space":currentClinicMemberHasAccess(ACCESS_SCHEDULE_VISITS_EDITING)&&(b.cut_space={name:T["Cut space"]+" (CTRL+X)",icon:"cut"});break;case "delete_space":currentClinicMemberHasAccess(ACCESS_SCHEDULE_VISITS_EDITING)&&currentClinicMemberHasAccess(ACCESS_SCHEDULE_DELETE)&&(b.delete_space={name:T["Remove space"]+" (DEL)",icon:"delete"});break;case "delete_visit":currentClinicMemberHasAccess(ACCESS_SCHEDULE_VISITS_EDITING)&&
currentClinicMemberHasAccess(ACCESS_SCHEDULE_DELETE)&&(b.delete_visit={name:T["Remove patient visit"]+" (DEL)",icon:"delete"});break;case "delete_assistant":currentClinicMemberHasAccess(ACCESS_SCHEDULE_ASSISTANT_SHIFTS_EDITING)&&currentClinicMemberHasAccess(ACCESS_SCHEDULE_DELETE)&&(b.delete_assistant={name:T["Remove assistant shift"]+" (DEL)",icon:"delete"});break;case "delete_administrator":currentClinicMemberHasAccess(ACCESS_SCHEDULE_ADMINISTRATOR_SHIFTS_EDITING)&&currentClinicMemberHasAccess(ACCESS_SCHEDULE_DELETE)&&
(b.delete_administrator={name:T["Remove administrator shift"]+" (DEL)",icon:"delete"});break;case "edit_shift":currentClinicMemberHasAccess(ACCESS_SCHEDULE_SHIFTS_EDITING)&&(b.edit_shift={name:T["Edit doctor shift"],icon:"edit"});break;case "copy_shift":currentClinicMemberHasAccess(ACCESS_SCHEDULE_SHIFTS_EDITING)&&(b.copy_shift={name:T["Copy doctor shift"]+" (CTRL+C)",icon:"copy"});break;case "cut_shift":currentClinicMemberHasAccess(ACCESS_SCHEDULE_SHIFTS_EDITING)&&(b.cut_shift={name:T["Cut doctor shift"]+
" (CTRL+X)",icon:"cut"});break;case "delete_shift":currentClinicMemberHasAccess(ACCESS_SCHEDULE_SHIFTS_EDITING)&&(b.delete_shift={name:T["Remove doctor shift"]+" (DEL)",icon:"delete"})}return b};this.pressContextMenuItem=function(a,b,c,d){this.checkPasteBlockTime(c);switch(a){case "create_visit":this.addVisitForm(c);break;case "create_assistant":this.addAssistantForm(c);break;case "create_administrator":this.addAdministratorForm(c);break;case "create_space":this.addSpaceForm(c);break;case "create_shift":this.addShiftForm(c);
break;case "paste_visit":this.pasteVisit();break;case "paste_assistant":this.pasteAssistant();break;case "paste_administrator":this.pasteAdministrator();break;case "paste_space":this.pasteSpace();break;case "paste_shift":this.pasteShift();break;case "edit_visit":a=$(d);this.editVisitForm(a);break;case "edit_assistant":a=$(d);this.editAssistantForm(a);break;case "edit_administrator":a=$(d);this.editAdministratorForm(a);break;case "edit_space":a=$(d);this.editSpaceForm(a);break;case "copy_visit":a=
$(d);this.copyVisit(a);break;case "copy_assistant":a=$(d);this.copyAssistant(a);break;case "copy_administrator":a=$(d);this.copyAdministrator(a);break;case "copy_space":a=$(d);this.copySpace(a);break;case "cut_visit":a=$(d);this.cutVisit(a);break;case "cut_assistant":a=$(d);this.cutAssistant(a);break;case "cut_administrator":a=$(d);this.cutAdministrator(a);break;case "cut_space":a=$(d);this.cutSpace(a);break;case "delete_visit":a=$(d);a=a.attr("_vis");this.deleteVisit(a);break;case "delete_assistant":a=
$(d);a=a.attr("_vis");this.deleteAssistant(a);break;case "delete_administrator":a=$(d);a=a.attr("_vis");this.deleteAdministrator(a);break;case "delete_space":a=$(d);a=a.attr("_vis");this.deleteSpace(a);break;case "edit_shift":a=$(d).hasClass("calItemDoctorWorkTime")?$(d).prev():$(d);this.editShiftForm(a);break;case "copy_shift":a=$(d).hasClass("calItemDoctorWorkTime")?$(d).prev():$(d);this.copyShift(a);break;case "cut_shift":a=$(d).hasClass("calItemDoctorWorkTime")?$(d).prev():$(d);this.cutShift(a);
break;case "delete_shift":a=$(d).hasClass("calItemDoctorWorkTime")?$(d).prev():$(d),a=a.attr("_id"),this.deleteShift(a)}};this.getInfoForClickPoint=function(a){var b=document.getElementById("scheduleHeaderContainer"),c=document.getElementById("scheduleSidebarContainer");b=parseInt(""==b.style.marginLeft?0:b.style.marginLeft);c=parseInt(""==c.style.marginTop?0:c.style.marginTop);c=Math.round(a.pageY-c-$(".scheduleBody").offset().top);a=Math.round(a.pageX-b-$(".scheduleBody").offset().left);b=this.getTimeForYCoord(c);
b=this.time2minutes(b);b=Math.round(b/(this.options.include15MinIntervals?15:30))*(this.options.include15MinIntervals?15:30);var d=this.minutes2time(b);return{clickX:a,clickY:c,time:d,column:Math.floor(a/SCHEDULE_DEFAULT_CABINET_WIDTH),time15_min:b,time15:d,maxTime:this.timeEnd}};this.checkPasteBlockTime=function(a){if(null!=this.cut2MemBlock||null!=this.copy2MemBlock){var b=null!=this.cut2MemBlock?this.cut2MemBlock:this.copy2MemBlock;this.options.viewType==SCHEDULE_VIEW_TYPE_ASSISTANTS||this.options.viewType==
SCHEDULE_VIEW_TYPE_ADMINISTRATORS?(b=this.getInfoForClickPoint(a),this.calendarClickTime=[b.time,b.column]):$(a.target).closest(".calItemDoctorWorkTime").length&&"shift"==b.type&&null!=this.$ACTIVE_SHIFT&&$(a.target).closest(".calItemDoctorWorkTime").attr("_id")==this.$ACTIVE_SHIFT.attr("_id")||($(a.target).closest(".calItemDoctorWorkTime").length&&"visit"==b.type?(b=this.getInfoForClickPoint(a),this.calendarClickTime=[b.time,b.column,$(a.target).attr("_doc")]):$(a.target).closest(".calVisitCell").length||
(b=this.getInfoForClickPoint(a),this.calendarClickTime=[b.time,b.column]))}else this.calendarClickTime=null};this.autoUpdater=function(a){return!1}}
function calendarCurrentTimeLineInit(a){if("#schedule"!=location.hash&&"#schedule/assistants"!=location.hash&&"#schedule/administrators"!=location.hash||0==a.timesYCoords.length)clearInterval(currentTimeInterval);else{var b=new Date,c=b.getHours();b=b.getMinutes();var d=5*Math.floor(b/5),e=("00"+c).slice(-2)+":"+("00"+b).slice(-2);if(!1===currentCalendarDateTime||e!=currentCalendarDateTime){var f=a.timeDisplay(c,d),g=a.getYCoordinateForTime(f,"t"),p=$("#scheduleSidebarCurrentTimeLine");currentCalendarDateTime=
e;if(a.getTimeForYCoord(g)!=f)$(".currentTimeLine").hide(),p.hide(),$("#scheduleSidebarCurrentTimeApple").hide();else{d!=b&&(f=d+5,c=60<=f?a.timeDisplay(c+1,f-60):a.timeDisplay(c,f),a=Math.min(a.getYCoordinateForTime(c,"all"),g+30),g+=(b-d)*(a-g)/5);$(".currentTimeLine").css("top",g).show();$(".currentTimeLine").width($(".scheduleHeaderContainer").width());var q=$("#gridTimeContainer").offset().top,n=g-7,l=!0;$(".calTimeCell.timeHour").each(function(a,b){a=n-$(b).offset().top+q;if(0<=a&&10>a||0>a&&
-13<a)l=!1});$("#scheduleSidebarCurrentTimeApple").css("top",n+3).show();l?p.html(e).css("top",n).show():p.hide()}}}}window.defaultWidth=window.innerWidth;var window_scale=100*(window.defaultWidth/window.innerWidth).toFixed(2);
$(window).resize(function(){if("#schedule"==location.hash||"#schedule/assistants"==location.hash||"#schedule/administrators"==location.hash){var a=100*(window.defaultWidth/window.innerWidth).toFixed(2);window_scale!=a&&(refreshCalendar(calendar.options.date,200<SCHEDULE_DEFAULT_CABINET_WIDTH?!0:!1),window_scale=a);resfreshScrollAreas()}});
function refreshCalendar(a,b,c){clearInterval(currentTimeInterval);$(".scheduleTooltipVisitStatusSelectContainer select").select2("close");"undefined"==typeof b&&(b=!1);"undefined"==typeof c&&(c=!0);"undefined"!=typeof initCalendarOptions?(refreshCalendarWithOptions(initCalendarOptions.calendarOptions,b),delete initCalendarOptions):(a={date:a,additional_patients:[]},null==calendar.cut2MemBlock&&null==calendar.copy2MemBlock||a.additional_patients.push((null!=calendar.cut2MemBlock?calendar.cut2MemBlock:
calendar.copy2MemBlock)._pat),calendarPreselectedPatientId&&a.additional_patients.push(calendarPreselectedPatientId),ajax({url:calendarServiceURL,data:a,showAjaxLoadingBlock:c,success:function(a){b&&(unsetTouchScroll(),scrollStartLeft=_scrollLeft=_scrollTop=0,setTimeout(function(){__sidebar.style.marginTop="0px";__header.style.marginLeft="0px";setTouchScroll()},100));calendar.display(a.calendarOptions);calendar.needRefreshOnCloseModal=!1;calendar.autoUpdater(!0)}}))}
function refreshCalendarWithOptions(a,b){clearInterval(currentTimeInterval);"undefined"==typeof b&&(b=!1);b&&(unsetTouchScroll(),scrollStartLeft=_scrollLeft=_scrollTop=0,setTimeout(function(){__sidebar.style.marginTop="0px";__header.style.marginLeft="0px";setTouchScroll()},100));calendar.display(a);calendar.needRefreshOnCloseModal=!1;calendar.autoUpdater(!0)}
$.ui.plugin.add("resizable","customgrid",{resize:function(a){var b=a.pageY,c=$(".scheduleBody"),d=this;calendar.customResizePlugin(a,d,b,c);var e=parseInt(c.css("height"));clearInterval(scheduleResizeInterval);if(b<c.offset().top||b>e+c.offset().top)scheduleResizeInterval=setInterval(function(){var f="+=0";isMobileDevice&&b<c.offset().top-20?f="+=5":b<c.offset().top?f="+=5":b>e+c.offset().top?f="-=5":clearInterval(scheduleResizeInterval);"+=0"!=f&&c.mCustomScrollbar("scrollTo",[f,"+=0"],{timeout:0,
scrollEasing:"easeOut",scrollInertia:0});calendar.customResizePlugin(a,d,b,c)},5)}});
$(document).ready(function(){$("#visitModal").live("hidden.bs.modal",function(a){if("undefined"!==typeof calendar.onHiddenModalEvent)calendar.onHiddenModalEvent()});$("#scheduleShiftModal").live("hidden.bs.modal",function(a){if("undefined"!==typeof calendar.onHiddenModalEvent)calendar.onHiddenModalEvent()});$("#visitSpaceModal").live("hidden.bs.modal",function(a){if("undefined"!==typeof calendar.onHiddenModalEvent)calendar.onHiddenModalEvent()});$("#visitAssistantModal").live("hidden.bs.modal",function(a){if("undefined"!==
typeof calendar.onHiddenModalEvent)calendar.onHiddenModalEvent()});$("#visitAdministratorModal").live("hidden.bs.modal",function(a){if("undefined"!==typeof calendar.onHiddenModalEvent)calendar.onHiddenModalEvent()});var a=$("body");a.on("click","#prevDayButtonInDayLine",function(a){a.stopPropagation();$("#scheduleDatetimepicker .prevDayButton a").trigger("click");$("#scheduleDatetimepickerMobile").is(":visible")&&$("#scheduleDatetimepickerMobile").hide()});a.on("click","#nextDayButtonInDayLine",function(a){a.stopPropagation();
$("#scheduleDatetimepicker .nextDayButton a").trigger("click");$("#scheduleDatetimepickerMobile").is(":visible")&&$("#scheduleDatetimepickerMobile").hide()});$("#header_menuItemSchedule").click(function(a){if(isMobileDevice&&"undefined"!=typeof calendar&&"undefined"!=typeof calendar.clickOnDate&&("#schedule"==location.hash||"#schedule/administrators"==location.hash||"#schedule/assistants"==location.hash))return calendar.clickOnDate(a),a.preventDefault(),a.stopImmediatePropagation(),!1})});
;
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(b){var c=0;return function(){return c<b.length?{done:!1,value:b[c++]}:{done:!0}}};$jscomp.arrayIterator=function(b){return{next:$jscomp.arrayIteratorImpl(b)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,c,e){if(b==Array.prototype||b==Object.prototype)return b;b[c]=e.value;return b};$jscomp.getGlobal=function(b){b=["object"==typeof globalThis&&globalThis,b,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var c=0;c<b.length;++c){var e=b[c];if(e&&e.Math==Math)return e}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(b,c){var e=$jscomp.propertyToPolyfillSymbol[c];if(null==e)return b[c];e=b[e];return void 0!==e?e:b[c]};
$jscomp.polyfill=function(b,c,e,g){c&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(b,c,e,g):$jscomp.polyfillUnisolated(b,c,e,g))};$jscomp.polyfillUnisolated=function(b,c,e,g){e=$jscomp.global;b=b.split(".");for(g=0;g<b.length-1;g++){var k=b[g];k in e||(e[k]={});e=e[k]}b=b[b.length-1];g=e[b];c=c(g);c!=g&&null!=c&&$jscomp.defineProperty(e,b,{configurable:!0,writable:!0,value:c})};
$jscomp.polyfillIsolated=function(b,c,e,g){var k=b.split(".");b=1===k.length;g=k[0];g=!b&&g in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var t=0;t<k.length-1;t++){var q=k[t];q in g||(g[q]={});g=g[q]}k=k[k.length-1];e=$jscomp.IS_SYMBOL_NATIVE&&"es6"===e?g[k]:null;c=c(e);null!=c&&(b?$jscomp.defineProperty($jscomp.polyfills,k,{configurable:!0,writable:!0,value:c}):c!==e&&($jscomp.propertyToPolyfillSymbol[k]=$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(k):$jscomp.POLYFILL_PREFIX+k,k=$jscomp.propertyToPolyfillSymbol[k],
$jscomp.defineProperty(g,k,{configurable:!0,writable:!0,value:c})))};$jscomp.initSymbol=function(){};
$jscomp.polyfill("Symbol",function(b){if(b)return b;var c=function(b,c){this.$jscomp$symbol$id_=b;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:c})};c.prototype.toString=function(){return this.$jscomp$symbol$id_};var e=0,g=function(b){if(this instanceof g)throw new TypeError("Symbol is not a constructor");return new c("jscomp_symbol_"+(b||"")+"_"+e++,b)};return g},"es6","es3");$jscomp.initSymbolIterator=function(){};
$jscomp.polyfill("Symbol.iterator",function(b){if(b)return b;b=Symbol("Symbol.iterator");for(var c="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),e=0;e<c.length;e++){var g=$jscomp.global[c[e]];"function"===typeof g&&"function"!=typeof g.prototype[b]&&$jscomp.defineProperty(g.prototype,b,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}})}return b},"es6",
"es3");$jscomp.initSymbolAsyncIterator=function(){};$jscomp.iteratorPrototype=function(b){b={next:b};b[Symbol.iterator]=function(){return this};return b};$jscomp.iteratorFromArray=function(b,c){b instanceof String&&(b+="");var e=0,g={next:function(){if(e<b.length){var k=e++;return{value:c(k,b[k]),done:!1}}g.next=function(){return{done:!0,value:void 0}};return g.next()}};g[Symbol.iterator]=function(){return g};return g};
$jscomp.polyfill("Array.prototype.keys",function(b){return b?b:function(){return $jscomp.iteratorFromArray(this,function(b){return b})}},"es6","es3");
var clinicFlagResize=!1,clinicFlagTouchMove=!1,clinicMoveInterval=null,clinicMoveTimeout=null,startX=0,__body=document.getElementsByClassName("scheduleBody")[0],__sidebar=document.getElementsByClassName("scheduleSidebarContainer")[0],__header=document.getElementsByClassName("scheduleHeaderContainer")[0],_scrollTop=0,_scrollLeft=0,locked=!1,_ui=null,start,stop,scrollLeftStart=0,scrollSpeed=5,oldX=0,scrollStartLeft=0,originalLeft=0;
function resfreshScrollAreas(){calendar.options.useSingleMode?isMobileDevice?($(".scheduleHeader,  .scheduleBody").css("width",$("#main_content").width()-56),$(".scheduleSidebar, .scheduleBody").css("height",$(window).height()-130-(iOsAppWithNotch?35:0))):($(".scheduleHeader,  .scheduleBody").css("width",$("#main_content").width()-58),$(".scheduleSidebar, .scheduleBody").css("height",$(window).height()-113)):isMobileDevice?($(".scheduleHeader,  .scheduleBody").css("width",$("#main_content").width()-
56),$(".scheduleSidebar, .scheduleBody").css("height",$(window).height()-168-(iOsAppWithNotch?35:0))):($(".scheduleHeader,  .scheduleBody").css("width",$("#main_content").width()-58),$(".scheduleSidebar, .scheduleBody").css("height",$(window).height()-165))}var preloadedCalendar=!1;
function preloadCalendar(b,c){if("undefined"!=typeof initCalendarOptions)return!1;if(!1===b)var e=c=0;else c=parseInt(-b.top),e=parseInt(-b.left);preloadedCalendar=!0;b=Math.max(calendar.getColumnIdByX(e,SCHEDULE_DEFAULT_CABINET_WIDTH)-1,0);var g=Object.keys(calendar.options.cabinets).length;"undefined"!=typeof calendar.options.ordered_cabinets&&(g=calendar.options.ordered_cabinets.length);e=Math.min(calendar.getColumnIdByX(e+$("#scheduleContainer").width(),SCHEDULE_DEFAULT_CABINET_WIDTH)+1,Object.keys(calendar.options.days).length*
g);g=calendar.getTimeForYCoord(Math.max(c-100,0));c=calendar.getTimeForYCoord(Math.min(parseInt(c)+parseInt($(".scheduleBody").height())+100,$("#scheduleBodyContainer").height()));0===calendar.visibleVisitsTimer&&(calendar.visibleVisitsTimer=1,setTimeout(function(){calendar.visibleVisitsTimer=0},500),calendar.displayVisits2(b,e,g,c))}
var scrollOptions={axis:"auto",theme:"dark",scrollInertia:300,autoExpandScrollbar:!0,advanced:{autoScrollOnFocus:!1,updateOnImageLoad:!1,updateOnSelectorChange:!1},contentTouchScroll:!1,documentTouchScroll:!1,scrollbarPosition:"outside",callbacks:{onCreate:function(){},onInit:function(){preloadCalendar(this.mcs)},onScroll:function(){locked=!1;preloadCalendar(this.mcs)},onScrollStart:function(){scrollStartLeft=_scrollLeft},onTotalScrollBack:function(b){},onOverflowXNone:function(){},whileScrolling:function(){var b=
-this.mcs.top,c=-this.mcs.left;_scrollTop!=b&&(__sidebar.style.marginTop=-b+"px",_scrollTop=b);_scrollLeft!=c&&(__header.style.marginLeft=-c+"px",_scrollLeft=c)}}};
function calendarScrollInit(){(function(b){function c(c,p){this.element=c;this.offset=null;this.old_pageY=this.old_pageX=this.pageY=this.pageX=0;this.is_desktop=p;this.isMove2Clone=this.isMoving=this.moveStart=!1;this.isVisitBlock=c.hasClass("calVisitCell");this.isSpaceBlock=c.hasClass("calSpaceCell");var d=this;this.calendarMoveBlock=function(b){};this.calendarUpBlock=function(c,e,h,g){if(!clinicFlagResize)if(calendar.stop_on_escape)calendar.stop_on_escape=!1,d.is_desktop&&(b(document).unbind("mousemove",
e),b(document).unbind("mouseup",h)),null!=a&&(a.removeClass("mistake"),a.removeClass("moving"),a.next().removeClass("moving"),a.css("top",b(f).position().top),a.css("left",b(f).position().left),a.css("height",b(f).height()),a.css("width",b(f).width()),a.html(f.innerHTML)),clearInterval(clinicMoveInterval),clinicMoveInterval=null,clinicFlagTouchMove=!1,b(f).remove(),b(".sch_tooltip").show(),a=f=null;else if(null==a)p&&(b(document).unbind("mousemove",e),b(document).unbind("mouseup",h)),clearInterval(clinicMoveInterval),
clinicMoveInterval=null,clinicFlagTouchMove=!1;else{d.is_desktop&&(b(document).unbind("mousemove",e),b(document).unbind("mouseup",h));clearInterval(clinicMoveInterval);clinicMoveInterval=null;clinicFlagTouchMove=!1;if(!d.isMoving)return!1;if(a.hasClass("mistake"))a.removeClass("mistake"),a.removeClass("moving"),a.next().removeClass("moving"),a.css("top",b(f).position().top),a.css("left",b(f).position().left),a.css("height",b(f).height()),a.css("width",b(f).width()),a.attr("_tim_e_new",a.attr("_tim_e")),
a.attr("_tim_s_new",a.attr("_tim_s")),a.html(f.innerHTML),b(f).remove(),b(".sch_tooltip").show();else{a.css({top:a.position().top,height:a.height(),width:a.width(),left:a.position().left});d.isSpaceBlock?b(".calVisitInfoCell",a).css({height:a.height()-calendar.options.paddingVisitBottom}):d.isVisitBlock&&b(".calVisitInfoCell",a).css({height:a.height()-calendar.options.paddingVisitBottom});g="b"+a.attr("block_id");var r=calendar.getColumnIdByX(a.position().left,a.width()),z=a.attr("column_id");a.attr("column_id",
r);var k=d.isVisitBlock?!1:!0;if(void 0!=a.attr("_tim_s_new")){var u=a.attr("_tim_s_new"),l=a.attr("_tim_e_new"),v=a.attr("_tim_s"),D=a.attr("_tim_e");if(z!=r||u!=v||l!=D)k=!0}if(!k&&calendar.options.viewType!=SCHEDULE_VIEW_TYPE_VISITS){d.is_desktop&&(b(document).unbind("mousemove",e),b(document).unbind("mouseup",h));null!=f&&(a.removeClass("mistake"),a.removeClass("moving"),a.next().removeClass("moving"),a.css("top",b(f).position().top),a.css("left",b(f).position().left),a.css("height",b(f).height()),
a.css("width",b(f).width()),a.attr("_tim_e_new",a.attr("_tim_e")),a.attr("_tim_s_new",a.attr("_tim_s")),a.html(f.innerHTML));clearInterval(clinicMoveInterval);clinicMoveInterval=null;clinicFlagTouchMove=!1;b(f).remove();b(".sch_tooltip").show();a=f=null;b(".ui-resizable-resizing").trigger("mouseup");b(".calVisitCell.draggable").trigger("mouseup");b(".calItemDoctorCell.draggable").trigger("mouseup");calendar.cut2MemBlock=null;calendar.copy2MemBlock=null;calendar.calendarClickTime=null;calendar.unSelectAllBlocks();
return}k?(calendar.moveBlockToColumn(z,r,g,a.position().top,a.position().top+a.height()),a.attr("_tim_s",a.attr("_tim_s_new")),a.attr("_tim_e",a.attr("_tim_e_new")),d.isSpaceBlock?(b(".visittime",a).html(a.attr("_tim_s_new")+" - "+a.attr("_tim_e_new")),calendar.fixBlockPosition(r,g,a),d.isMove2Clone?calendar.confirmVisit(a,r,"drag",0):calendar.confirmVisit(a,r,"drag")):d.isVisitBlock?(b(".visittime",a).html(a.attr("_tim_s_new")+" - "+a.attr("_tim_e_new")),calendar.fixBlockPosition(r,g,a),d.isMove2Clone?
calendar.confirmVisit(a,r,"drag",0):calendar.confirmVisit(a,r,"drag")):d.isMove2Clone?calendar.confirmShift(a,r,"drag",0):calendar.confirmShift(a,r,"drag")):calendar.fixBlockPosition(r,g,a);b(c).removeAttr("_tim_s_new");b(c).removeAttr("_tim_e_new");z!=r&&(SCHEDULE_EVENT_DRAG_RELEASE_BLOCK=1)}calendar.recalculateCommentHeight(b(a));d.isMove2Clone||b(f).remove();a=null}};this.displayClone=function(){a=d.element;if(d.isVisitBlock){f=a.get(0).cloneNode(!0);for(var c in f.childNodes)"undefined"!=typeof f.childNodes[c].id&&
"sch_tooltip"==f.childNodes[c].id&&f.removeChild(f.childNodes[c]);f.id="tmp_visit";d.isMove2Clone?(f.className=a.get(0).className+" cloned opacity1",a.get(0).className="calVisitCell calVisitCellStatus1 active",b(".visitNote",a).html("")):f.className=a.get(0).className+" cloned";if(calendar.options.viewType==SCHEDULE_VIEW_TYPE_ASSISTANTS||calendar.options.viewType==SCHEDULE_VIEW_TYPE_ADMINISTRATORS)calendar.$ACTIVE_VISIT.css("width",SCHEDULE_DEFAULT_CABINET_WIDTH+"px"),c=calendar.getColumnIdByX(parseFloat(calendar.$ACTIVE_VISIT.css("left")),
calendar.$ACTIVE_VISIT.width()),calendar.$ACTIVE_VISIT.css("left",c*SCHEDULE_DEFAULT_CABINET_WIDTH+"px")}else{f=a.get(0).cloneNode(!0);c=document.createElement("div");c.className="shifttime";var e=a.attr("_tim_s"),h=a.attr("_tim_e"),g=a.attr("column_id");calendar.getYCoordinateForTimeColumn(g,e);calendar.getYCoordinateForTimeColumn(g,h);f.id="tmp_shift";f.className=d.isMove2Clone?a.get(0).className+" cloned opacity1":a.get(0).className+" cloned";e=a.attr("_tim_s");h=a.attr("_tim_e");g=a.attr("column_id");
e=calendar.getYCoordinateForTimeColumn(g,e);h=calendar.getYCoordinateForTimeColumn(g,h);h=Math.max(h-e,30);a.css("top",e);a.css("height",h);a.addClass("moving");a.get(0).appendChild(c)}b("#scheduleBodyContainer").get(0).appendChild(f)};this.calendarDownBlock=function(c,f,h,u){clearInterval(clinicMoveInterval);a=clinicMoveInterval=null;a=d.element;a.addClass("draggable");d.is_desktop||(clinicFlagTouchMove=!0);b(document).bind("mousemove",f);clinicMoveInterval=setInterval(function(){if(clinicFlagResize)clearInterval(clinicMoveInterval),
clinicMoveInterval=null;else if(d.moveStart){var c="+=0",h="+=0";d.pageX>k+B?h="-=15":d.pageX<e.left+B&&(h="+=15");isMobileDevice&&d.pageY<e.top+A-20?c="+=5":d.pageY>g+A?c="-=5":d.pageY<e.top+A&&(c="+=5");if("+=0"!=c||"+=0"!=h)w.mCustomScrollbar("scrollTo",[c,h],{timeout:0,scrollEasing:"easeOut",scrollInertia:0});else if(d.old_pageX==d.pageX&&d.old_pageY==d.pageY)return;d.old_pageX=d.pageX;d.old_pageY=d.pageY;c=""==t.style.marginLeft?0:t.style.marginLeft;h=""==q.style.marginTop?0:q.style.marginTop;
c=parseInt(c);h=parseInt(h);var f=Math.round(d.pageY-d.offset.y-h+x);c=Math.round(d.pageX-d.offset.x-c+y);0>f&&(f=0);0>c&&(c=0);var m=C.width(),l=C.height();h=a.width();var p=a.height();f>l-p&&(f=l-p);c>m-h&&(c=m-h);c=calendar.getColumnIdByX(c,h)*SCHEDULE_DEFAULT_CABINET_WIDTH;h=calendar.getColumnIdByX(c,h);m=15;u.shiftKey&&(u.ctrlKey||u.metaKey)?m=60:u.altKey&&(u.ctrlKey||u.metaKey)?m=5:u.shiftKey?m=10:u.altKey&&(m=30);f=calendar.getTimeForYCoordColumn(h,f);l=calendar.time2minutes(f);f=Math.ceil(l/
m)*m;f=calendar.getYCoordinateForTimeColumn(h,calendar.minutes2time(f));p=0;for(var v in calendar.blocks[h]){var n=calendar.blocks[h][v];d.isVisitBlock?"free"!=n.type&&n.bottom<f&&(p=Math.max(p,n.bottom)):"doctor"==n.type&&n.bottom<f&&(p=Math.max(p,n.bottom))}calendar.time2minutes(calendar.getTimeForYCoordColumn(h,f))-calendar.time2minutes(calendar.getTimeForYCoordColumn(h,p))<m&&(f=5*Math.ceil(l/5),f=calendar.getYCoordinateForTimeColumn(h,calendar.minutes2time(f)));v=a.attr("_tim_s");m=a.attr("_tim_e");
l=calendar.getDurationBetweenTimes(v,m);v=f;m=calendar.getTimeForYCoordColumn(h,v);l=calendar.minutes2time(calendar.time2minutes(m)+l);n=calendar.getYCoordinateForTimeColumn(h,l);l=calendar.getTimeForYCoordColumn(h,n);n=calendar.getYCoordinateForTimeColumn(h,l);a.attr("_tim_s_new",m);a.attr("_tim_e_new",l);p=Math.max(n-v,30);calendar.options.viewType==SCHEDULE_VIEW_TYPE_ASSISTANTS||calendar.options.viewType==SCHEDULE_VIEW_TYPE_ADMINISTRATORS||(d.isVisitBlock?calendar.visitCheckPosition(a,h,f,n,d.isMove2Clone):
calendar.shiftCheckPosition(a,h,f,n,d.isMove2Clone))||!(n=calendar.findActualHeightElement(a,h,f,n,d.isMove2Clone))||(p=Math.max(n,30),a.removeClass("mistake"),l=calendar.getTimeForYCoordColumn(h,v+n),a.attr("_tim_e_new",l));a.height(p);d.isVisitBlock?(b(".calVisitInfoCell",a).css("height",p-calendar.options.paddingVisitBottom),b(".visittime",a).html(m+" - "+l),calendar.recalculateCommentHeight(a)):b(".shifttime",a).html(m+" - "+l);l==m&&a.addClass("mistake");a.css({top:f,left:c})}},1);d.is_desktop&&
b(document).bind("mouseup",h);y=""==t.style.marginLeft?0:t.style.marginLeft;x=""==q.style.marginTop?0:q.style.marginTop;y=parseInt(y);x=parseInt(x);g=parseInt(w.css("height"));k=parseInt(w.css("width"));e=w.position()}}__body=document.getElementsByClassName("scheduleBody")[0];__sidebar=document.getElementsByClassName("scheduleSidebarContainer")[0];__header=document.getElementsByClassName("scheduleHeaderContainer")[0];var e=b(".scheduleBody").position(),g=parseInt(b(".scheduleBody").css("height")),
k=parseInt(b(".scheduleBody").css("width")),t=document.getElementById("scheduleHeaderContainer"),q=document.getElementById("scheduleSidebarContainer"),C=b("#scheduleBodyContainer"),w=b(".scheduleBody"),B=w.offset().left,A=w.offset().top,y=0,x=0,a=null,f=null;resfreshScrollAreas();b.fn.clinicDraggableTouch=function(a){if(!("ontouchstart"in document.documentElement))return this.clinicDraggableMouse(a);if("disable"==a)return this.unbind("touchstart"),this.unbind("touchmove"),this.unbind("touchend"),
this.unbind("touchcancel"),this;this.each(function(){var a=b(this),d=new c(a,!1),e=function(a){a=a.originalEvent;"undefined"!=typeof a.targetTouches&&1<a.targetTouches.length||("undefined"!=typeof a.changedTouches&&(d.pageX=a.changedTouches[0].pageX,d.pageY=a.changedTouches[0].pageY,5<Math.abs(d.pageX-d.old_pageX)||5<Math.abs(d.pageY-d.old_pageY))&&(0==d.moveStart&&d.displayClone(),b(".sch_tooltip").hide(),d.moveStart=!0,d.isMoving=!0),d.calendarMoveBlock(this))},f=function(a){b(a.target).hasClass("ui-resizable-handle")||
d.calendarUpBlock(this,e,f,a)};a.bind("touchstart",function(c){if(!(b(c.target).hasClass("clickable")||b(c.target).hasClass("select2SelectedColored")||b(c.target).hasClass("ui-resizable-handle")||clinicFlagResize)){var h=c.originalEvent,g=b(this).position();d.pageX=h.changedTouches[0].pageX;d.pageY=h.changedTouches[0].pageY;d.old_pageX=d.pageX;d.old_pageY=d.pageY;d.moveStart=!1;d.offset={x:d.pageX-g.left,y:d.pageY-g.top};d.calendarDownBlock(this,e,f,c);b("#scheduleContainer").trigger("click",[c.target]);
a.bind("touchmove",e);a.bind("touchend",f);a.bind("touchcancel",f);c.preventDefault();return!0}})});return this};b.fn.clinicDraggableMouse=function(a){if("disable"==a)return this.unbind("mousedown"),this.unbind("mouseup"),this.unbind("mouseout"),this;this.each(function(){var a=b(this),d=new c(a,!0),e=function(a){b(".sch_tooltip").hide();d.pageX=a.pageX;d.pageY=a.pageY;if(d.pageX!=d.old_pageX||d.pageY!=d.old_pageY)0==d.moveStart&&d.displayClone(),d.moveStart=!0,d.isMoving=!0;d.calendarMoveBlock(this)},
f=function(b){d.calendarUpBlock(this,e,f,b)};a.bind("mouseup",f);a.bind("mouseout",function(b){});a.bind("mousedown",function(a){if(!(1!==a.button&&1!==a.which||b(a.target).closest(".sch_tooltip").length||b(a.target).hasClass("clickable")||b(a.target).hasClass("ui-resizable-handle")||clinicFlagResize)){var c=d.element.position();d.offset={x:a.pageX-c.left,y:a.pageY-c.top};d.pageX=a.pageX;d.pageY=a.pageY;d.old_pageX=a.pageX;d.old_pageY=a.pageY;d.moveStart=!1;d.isMove2Clone=a.ctrlKey||a.metaKey;d.calendarDownBlock(this,
e,f,a)}})});return this}})(jQuery)}function eventBoundToFunction(b,c,e){if(!(b&&b.data("events")&&b.data("events")[c]&&e))return!1;for(runner in b.data("events")[c])if(b.data("events")[c][runner].handler==e)return!0;return!1}
function setTouchScroll(){var b=$(".scheduleBody");scrollOptions.contentTouchScroll=5;b.mCustomScrollbar("destroy");b.mCustomScrollbar(scrollOptions);$("#scheduleBodyContainer").focus();if("undefined"!=typeof calendarScrollToRight)b.mCustomScrollbar("scrollTo","right",{timeout:130,scrollEasing:"easeOut",scrollInertia:0}),delete calendarScrollToRight;else if("undefined"!=typeof calendarSelectAndScrollToVisitIdOnLoad){var c=$("#calVisitCell"+calendarSelectAndScrollToVisitIdOnLoad);if(c.length){var e=
parseInt(c.position().left),g=$(".scheduleBody").height(),k=parseInt(c.position().top),t=c.height();b.mCustomScrollbar("scrollTo",[g>=k+t?0:k-10,e],{timeout:0,scrollEasing:"easeOut",scrollInertia:0});calendar.unSelectAllBlocks();setTimeout(function(){calendar.setActiveVisit(c)},1)}delete calendarSelectAndScrollToVisitIdOnLoad}else if("undefined"!=typeof calendarSelectAndScrollToShiftIdOnLoad){var q=$("#shift"+calendarSelectAndScrollToShiftIdOnLoad);q.length&&(e=parseInt(q.position().left),g=parseInt(q.position().top),
b.mCustomScrollbar("scrollTo",[g,e],{timeout:0,scrollEasing:"easeOut",scrollInertia:0}),calendar.unSelectAllBlocks(),setTimeout(function(){calendar.setActiveShift(q)},1));delete calendarSelectAndScrollToShiftIdOnLoad}}function unsetTouchScroll(){scrollOptions.contentTouchScroll=!1;$(".scheduleBody").mCustomScrollbar("destroy");$(".scheduleBody").mCustomScrollbar(scrollOptions)};
;
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){if(a==Array.prototype||a==Object.prototype)return a;a[b]=c.value;return a};$jscomp.getGlobal=function(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var c=a[b];if(c&&c.Math==Math)return c}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(a,b){var c=$jscomp.propertyToPolyfillSymbol[b];if(null==c)return a[b];c=a[c];return void 0!==c?c:a[b]};
$jscomp.polyfill=function(a,b,c,d){b&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(a,b,c,d):$jscomp.polyfillUnisolated(a,b,c,d))};$jscomp.polyfillUnisolated=function(a,b,c,d){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})};
$jscomp.polyfillIsolated=function(a,b,c,d){var e=a.split(".");a=1===e.length;d=e[0];d=!a&&d in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var h=0;h<e.length-1;h++){var f=e[h];f in d||(d[f]={});d=d[f]}e=e[e.length-1];c=$jscomp.IS_SYMBOL_NATIVE&&"es6"===c?d[e]:null;b=b(c);null!=b&&(a?$jscomp.defineProperty($jscomp.polyfills,e,{configurable:!0,writable:!0,value:b}):b!==c&&($jscomp.propertyToPolyfillSymbol[e]=$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(e):$jscomp.POLYFILL_PREFIX+e,e=$jscomp.propertyToPolyfillSymbol[e],
$jscomp.defineProperty(d,e,{configurable:!0,writable:!0,value:b})))};$jscomp.initSymbol=function(){};
$jscomp.polyfill("Symbol",function(a){if(a)return a;var b=function(a,b){this.$jscomp$symbol$id_=a;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:b})};b.prototype.toString=function(){return this.$jscomp$symbol$id_};var c=0,d=function(a){if(this instanceof d)throw new TypeError("Symbol is not a constructor");return new b("jscomp_symbol_"+(a||"")+"_"+c++,a)};return d},"es6","es3");$jscomp.initSymbolIterator=function(){};
$jscomp.polyfill("Symbol.iterator",function(a){if(a)return a;a=Symbol("Symbol.iterator");for(var b="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),c=0;c<b.length;c++){var d=$jscomp.global[b[c]];"function"===typeof d&&"function"!=typeof d.prototype[a]&&$jscomp.defineProperty(d.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}})}return a},"es6",
"es3");$jscomp.initSymbolAsyncIterator=function(){};$jscomp.iteratorPrototype=function(a){a={next:a};a[Symbol.iterator]=function(){return this};return a};$jscomp.iteratorFromArray=function(a,b){a instanceof String&&(a+="");var c=0,d={next:function(){if(c<a.length){var e=c++;return{value:b(e,a[e]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};
$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");
function CalendarAssistantClass(){CalendarClass.apply(this,arguments);this.getSortedShiftKeys=function(a){return Object.keys(a).sort(function(b,c){return a[b].length<a[c].length?1:a[b].length>a[c].length||calendar.options.assistantSchedule[b].shift_time.period<calendar.options.assistantSchedule[c].shift_time.period?-1:calendar.options.assistantSchedule[b].shift_time.period>calendar.options.assistantSchedule[c].shift_time.period?1:calendar.options.assistantSchedule[b].shift_time.period<calendar.options.assistantSchedule[c].shift_time.period?
-1:calendar.options.doctors[calendar.options.assistantSchedule[b].doctor_id].name>calendar.options.doctors[calendar.options.assistantSchedule[c].doctor_id].name?1:calendar.options.doctors[calendar.options.assistantSchedule[b].doctor_id].name<calendar.options.doctors[calendar.options.assistantSchedule[c].doctor_id].name?-1:0})};this.assistantDisplay=function(){var a="",b;for(b in this.intersectsAssistantArray){var c=this.getSortedShiftKeys(this.intersectsAssistantArray[b]),d=[],e=0,h;for(h in c){var f=
c[h];d[f]=0;for(var t in this.intersectsAssistantArray[b][f]){var g=this.intersectsAssistantArray[b][f][t];"undefined"!=typeof d[g]&&(d[f]=Math.max(d[f],d[g]))}d[f]++;e=Math.max(e,d[f])}for(h in c){f=c[h];var m=0;for(t in this.intersectsAssistantArray[b][f])g=this.intersectsAssistantArray[b][f][t],d[f]<d[g]&&m++;g=this.options.assistantSchedule[f];var p=e,q=SCHEDULE_DEFAULT_CABINET_WIDTH/p;m=Math.max(q,q*(p-this.intersectsAssistantArray[b][f].length-m));m=Math.min((p-d[f]+1)*q,m);var k=g.shift_time.timeStart.time,
r=g.shift_time.timeEnd.time;p=this.getXCoordinateForTime(g.datetime,g.cabinet_id);var n=this.getColumnIdByX(p,m);p+=(d[f]-1)*q;q=this.getYCoordinateForTimeColumn(n,k);var l=this.getYCoordinateForTimeColumn(n,r);"undefined"!=typeof this.doctorsCellsCoords[n]&&"undefined"!=typeof this.doctorsCellsCoords[n][l-30]&&(l-=30);n=l-q;this.doctorLineIsVisible(n);l='<div class="visitWritingsContainer">';l+='<a class="visitAvatar"><img src="'+this.options.doctors[g.doctor_id].img+'"></a>';"TWO"===g.rate&&(l+=
'<i class="shiftRate fa fa-eur"></i>',l+='<i class="shiftRate fa fa-eur" style="top: 13px;"></i>');200<=m?(l+='<div class="visittime">'+k+" - "+r+"</div>",l+='<div class="visitPatientName">'+this.options.doctors[g.doctor_id].name+"</div>"):l+='<div class="assistantRotateText">'+this.options.doctors[g.doctor_id].name+"<br>"+k+" - "+r+"</div>";l+="</div>";k=' _tim_s="'+k+'"';k+=' _tim_e="'+r+'"';k+=' _cab="'+g.cabinet_id+'"';k+=' _dat="'+g.datetime+'"';k+=' _doc="'+g.doctor_id+'"';k+=' _vis="'+f+'"';
k+=' _rate="'+g.rate+'"';r="";"undefined"!=typeof g.disabled&&(k+=' _disabled="1"',r=" disabled",l="");var u=" scheduleDoctorColor"+this.options.doctors[g.doctor_id].color+" ";u+="scheduleShiftStatusColor"+g.status;a+='<div id="calVisitCell'+f+'" class="calVisitCell calAssistantCell '+r+u+'"'+k+' style="width:'+m+"px;top:"+q+"px;left:"+p+"px;height:"+n+'px;"><div class="calVisitInfoCell" style="height:'+(n-this.options.paddingVisitBottom)+'px;">'+l+"</div></div>"}}$("#scheduleBodyContainer").append(a)};
this.addAssistantForm=function(a){if(currentClinicMemberHasAccess(ACCESS_SCHEDULE_ASSISTANT_SHIFTS_EDITING)){var b=this.getInfoForClickPoint(a),c=this.strtimeToObject(b.time),d=c.h+6,e;for(e in this.blocks[b.column]){var h=Math.round(this.blocks[b.column][e].top);if(h>b.clickY){b.maxTime=this.getTimeForYCoordColumn(b.column,h);break}}for(e in this.blocks[b.column])if(h=Math.round(this.blocks[b.column][e].bottom),h<b.clickY){b.minTime=this.getTimeForYCoordColumn(b.column,h);break}d=this.timeDisplay(d,
c.m);b.maxTime&&this.time2minutes(d)>this.time2minutes(b.maxTime)&&(d=b.maxTime);c=this.timeDisplay(c.h,c.m);b.minTime&&this.time2minutes(c)<this.time2minutes(b.minTime)&&(c=b.minTime);$(a.target).closest(".calItemDoctorWorkTime");showAssistantForm({refresh_location:0,timeStart:c,timeEnd:d,clinicMemberId:0,rate:"ONE",cabinetId:this.columnsInfo[b.column].cabinet_info.id,date:this.columnsInfo[b.column].day_info.date})}};this.editAssistantForm=function(a){var b=a.attr("_vis"),c=this.options.assistantSchedule[b],
d=a.attr("column_id");showAssistantForm({scheduleAssistantId:b,refresh_location:0,status:c.status,timeStart:a.attr("_tim_s"),timeEnd:a.attr("_tim_e"),cabinetId:this.columnsInfo[d].cabinet_info.id,clinicMemberId:a.attr("_doc"),date:this.columnsInfo[d].day_info.date,rate:a.attr("_rate")})};this.copyAssistant=function(a){currentClinicMemberHasAccess(ACCESS_SCHEDULE_ASSISTANT_SHIFTS_EDITING)&&(this.copy2MemBlock={type:"assistant",_tim_e:a.attr("_tim_e"),_tim_s:a.attr("_tim_s"),_doc:a.attr("_doc"),_vis:a.attr("_vis"),
_rate:a.attr("_rate"),status:this.options.assistantSchedule[a.attr("_vis")].status});this.calendarClickTime=this.cut2MemBlock=null};this.pasteAssistant=function(){if(currentClinicMemberHasAccess(ACCESS_SCHEDULE_ASSISTANT_SHIFTS_EDITING)){var a=this.calendarClickTime[1],b=this.calendarClickTime[0];if(null!=this.cut2MemBlock){var c=this.time2minutes(this.cut2MemBlock._tim_e)-this.time2minutes(this.cut2MemBlock._tim_s);c=this.minutes2time(this.time2minutes(b)+c);var d=this.cut2MemBlock._vis,e=this.getYCoordinateForTimeColumn(a,
this.timeEnd),h=this.getYCoordinateForTimeColumn(a,c);e<h&&(c=this.getTimeForYCoordColumn(a,e));showAssistantForm({scheduleAssistantId:d,refresh_location:0,event:"ctrlX",timeStart:b,timeEnd:c,status:this.options.assistantSchedule[d].status,rate:this.cut2MemBlock._rate,cabinetId:this.columnsInfo[a].cabinet_info.id,clinicMemberId:"undefined"!=typeof this.calendarClickTime[2]?this.calendarClickTime[2]:this.cut2MemBlock._doc,date:this.columnsInfo[a].day_info.date})}else null!=this.copy2MemBlock&&(this.unSelectAllBlocks(),
c=this.time2minutes(this.copy2MemBlock._tim_e)-this.time2minutes(this.copy2MemBlock._tim_s),c=this.minutes2time(this.time2minutes(b)+c),e=this.getYCoordinateForTimeColumn(a,this.timeEnd),h=this.getYCoordinateForTimeColumn(a,c),e<h&&(c=this.getTimeForYCoordColumn(a,e)),showAssistantForm({refresh_location:0,event:"ctrlC",timeStart:b,timeEnd:c,cabinetId:this.columnsInfo[a].cabinet_info.id,clinicMemberId:"undefined"!=typeof this.calendarClickTime[2]?this.calendarClickTime[2]:this.copy2MemBlock._doc,date:this.columnsInfo[a].day_info.date,
rate:this.copy2MemBlock._rate}))}this.calendarClickTime=null};this.cutAssistant=function(a){currentClinicMemberHasAccess(ACCESS_SCHEDULE_ASSISTANT_SHIFTS_EDITING)&&(this.cut2MemBlock={type:"assistant",_tim_e:a.attr("_tim_e"),_tim_s:a.attr("_tim_s"),_doc:a.attr("_doc"),_vis:a.attr("_vis"),_rate:a.attr("_rate")});this.calendarClickTime=this.copy2MemBlock=null};this.deleteAssistant=function(a){currentClinicMemberHasAccess(ACCESS_SCHEDULE_ASSISTANT_SHIFTS_EDITING)&&currentClinicMemberHasAccess(ACCESS_SCHEDULE_DELETE)&&
deleteScheduleAssistant(a)}};
;
function CalendarAdministratorClass(){CalendarAssistantClass.apply(this,arguments);this.administratorDisplay=function(){var a="",b;for(b in this.intersectsAssistantArray){var c=this.getSortedShiftKeys(this.intersectsAssistantArray[b]),d=[],g=0,h;for(h in c){var f=c[h];d[f]=0;for(var t in this.intersectsAssistantArray[b][f]){var e=this.intersectsAssistantArray[b][f][t];"undefined"!=typeof d[e]&&(d[f]=Math.max(d[f],d[e]))}d[f]++;g=Math.max(g,d[f])}for(h in c){f=c[h];var m=0;for(t in this.intersectsAssistantArray[b][f])e=
this.intersectsAssistantArray[b][f][t],d[f]<d[e]&&m++;e=this.options.assistantSchedule[f];var p=g,q=SCHEDULE_DEFAULT_CABINET_WIDTH/p;m=Math.max(q,q*(p-this.intersectsAssistantArray[b][f].length-m));m=Math.min((p-d[f]+1)*q,m);var k=e.shift_time.timeStart.time,r=e.shift_time.timeEnd.time;p=this.getXCoordinateForTime(e.datetime,e.cabinet_id);var n=this.getColumnIdByX(p,m);p+=(d[f]-1)*q;q=this.getYCoordinateForTimeColumn(n,k);var l=this.getYCoordinateForTimeColumn(n,r);"undefined"!=typeof this.doctorsCellsCoords[n]&&
"undefined"!=typeof this.doctorsCellsCoords[n][l-30]&&(l-=30);n=l-q;this.doctorLineIsVisible(n);l='<div class="visitWritingsContainer">';l+='<a class="visitAvatar"><img src="'+this.options.doctors[e.doctor_id].img+'"></a>';"TWO"===e.rate&&(l+='<i class="shiftRate fa fa-eur"></i>',l+='<i class="shiftRate fa fa-eur" style="top: 13px;"></i>');200<=m?(l+='<div class="visittime">'+k+" - "+r+"</div>",l+='<div class="visitPatientName">'+this.options.doctors[e.doctor_id].name+"</div>"):l+='<div class="assistantRotateText">'+
this.options.doctors[e.doctor_id].name+"<br>"+k+" - "+r+"</div>";l+="</div>";k=' _tim_s="'+k+'"';k+=' _tim_e="'+r+'"';k+=' _cab="'+e.cabinet_id+'"';k+=' _dat="'+e.datetime+'"';k+=' _doc="'+e.doctor_id+'"';k+=' _vis="'+f+'"';k+=' _rate="'+e.rate+'"';r="";"undefined"!=typeof e.disabled&&(k+=' _disabled="1"',r=" disabled",l="");var u=" scheduleDoctorColor"+this.options.doctors[e.doctor_id].color+" ";u+="scheduleShiftStatusColor"+e.status;a+='<div id="calVisitCell'+f+'" class="calVisitCell calAdministratorCell '+
r+u+'"'+k+' style="width:'+m+"px;top:"+q+"px;left:"+p+"px;height:"+n+'px;"><div class="calVisitInfoCell" style="height:'+(n-this.options.paddingVisitBottom)+'px;">'+l+"</div></div>"}}$("#scheduleBodyContainer").append(a)};this.addAdministratorForm=function(a){if(currentClinicMemberHasAccess(ACCESS_SCHEDULE_ADMINISTRATOR_SHIFTS_EDITING)){var b=this.getInfoForClickPoint(a),c=this.strtimeToObject(b.time),d=c.h+6,g;for(g in this.blocks[b.column]){var h=Math.round(this.blocks[b.column][g].top);if(h>b.clickY){b.maxTime=
this.getTimeForYCoordColumn(b.column,h);break}}for(g in this.blocks[b.column])if(h=Math.round(this.blocks[b.column][g].bottom),h<b.clickY){b.minTime=this.getTimeForYCoordColumn(b.column,h);break}d=this.timeDisplay(d,c.m);b.maxTime&&this.time2minutes(d)>this.time2minutes(b.maxTime)&&(d=b.maxTime);c=this.timeDisplay(c.h,c.m);b.minTime&&this.time2minutes(c)<this.time2minutes(b.minTime)&&(c=b.minTime);$(a.target).closest(".calItemDoctorWorkTime");showAdministratorForm({refresh_location:0,timeStart:c,
timeEnd:d,clinicMemberId:0,rate:"ONE",cabinetId:this.columnsInfo[b.column].cabinet_info.id,date:this.columnsInfo[b.column].day_info.date})}};this.editAdministratorForm=function(a){var b=a.attr("_vis"),c=this.options.assistantSchedule[b],d=a.attr("column_id");showAdministratorForm({scheduleAdministratorId:b,refresh_location:0,status:c.status,timeStart:a.attr("_tim_s"),timeEnd:a.attr("_tim_e"),cabinetId:this.columnsInfo[d].cabinet_info.id,clinicMemberId:a.attr("_doc"),date:this.columnsInfo[d].day_info.date,
rate:a.attr("_rate")})};this.copyAdministrator=function(a){currentClinicMemberHasAccess(ACCESS_SCHEDULE_ADMINISTRATOR_SHIFTS_EDITING)&&(this.copy2MemBlock={type:"administrator",_tim_e:a.attr("_tim_e"),_tim_s:a.attr("_tim_s"),_doc:a.attr("_doc"),_vis:a.attr("_vis"),_rate:a.attr("_rate"),status:this.options.assistantSchedule[a.attr("_vis")].status});this.calendarClickTime=this.cut2MemBlock=null};this.pasteAdministrator=function(){if(currentClinicMemberHasAccess(ACCESS_SCHEDULE_ADMINISTRATOR_SHIFTS_EDITING)){var a=
this.calendarClickTime[1],b=this.calendarClickTime[0];if(null!=this.cut2MemBlock){var c=this.time2minutes(this.cut2MemBlock._tim_e)-this.time2minutes(this.cut2MemBlock._tim_s);c=this.minutes2time(this.time2minutes(b)+c);var d=this.cut2MemBlock._vis,g=this.getYCoordinateForTimeColumn(a,this.timeEnd),h=this.getYCoordinateForTimeColumn(a,c);g<h&&(c=this.getTimeForYCoordColumn(a,g));showAdministratorForm({scheduleAdministratorId:d,refresh_location:0,event:"ctrlX",timeStart:b,timeEnd:c,status:this.options.assistantSchedule[d].status,
rate:this.cut2MemBlock._rate,cabinetId:this.columnsInfo[a].cabinet_info.id,clinicMemberId:"undefined"!=typeof this.calendarClickTime[2]?this.calendarClickTime[2]:this.cut2MemBlock._doc,date:this.columnsInfo[a].day_info.date})}else null!=this.copy2MemBlock&&(this.unSelectAllBlocks(),c=this.time2minutes(this.copy2MemBlock._tim_e)-this.time2minutes(this.copy2MemBlock._tim_s),c=this.minutes2time(this.time2minutes(b)+c),g=this.getYCoordinateForTimeColumn(a,this.timeEnd),h=this.getYCoordinateForTimeColumn(a,
c),g<h&&(c=this.getTimeForYCoordColumn(a,g)),showAdministratorForm({refresh_location:0,event:"ctrlC",timeStart:b,timeEnd:c,cabinetId:this.columnsInfo[a].cabinet_info.id,clinicMemberId:"undefined"!=typeof this.calendarClickTime[2]?this.calendarClickTime[2]:this.copy2MemBlock._doc,date:this.columnsInfo[a].day_info.date,rate:this.copy2MemBlock._rate}))}this.calendarClickTime=null};this.cutAdministrator=function(a){currentClinicMemberHasAccess(ACCESS_SCHEDULE_ADMINISTRATOR_SHIFTS_EDITING)&&(this.cut2MemBlock=
{type:"administrator",_tim_e:a.attr("_tim_e"),_tim_s:a.attr("_tim_s"),_doc:a.attr("_doc"),_vis:a.attr("_vis"),_rate:a.attr("_rate")});this.calendarClickTime=this.copy2MemBlock=null};this.deleteAdministrator=function(a){currentClinicMemberHasAccess(ACCESS_SCHEDULE_ADMINISTRATOR_SHIFTS_EDITING)&&currentClinicMemberHasAccess(ACCESS_SCHEDULE_DELETE)&&deleteScheduleAdministrator(a)}};
;
(function(a){if(navigator.userAgent.match(/Macintosh/)){var b=-1<navigator.userAgent.indexOf("Chrome"),c=-1<navigator.userAgent.indexOf("Safari"),d=-1<navigator.userAgent.indexOf("Firefox");if(b||c||d)a("body").on("mousewheel","#scheduleContainer",function(a){a.preventDefault()})}})(jQuery);
;
!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e("object"==typeof exports?require("jquery"):jQuery)}(function(e){"use strict";function t(t){return t.id&&e('label[for="'+t.id+'"]').val()||t.name}function n(a,o,s){return s||(s=0),o.each(function(){var o,i,c=e(this),l=this,r=this.nodeName.toLowerCase();switch("label"===r&&c.find("input, textarea, select").length&&(o=c.text(),r=(l=(c=c.children().first()).get(0)).nodeName.toLowerCase()),r){case"menu":i={name:c.attr("label"),items:{}},s=n(i.items,c.children(),s);break;case"a":case"button":i={name:c.text(),disabled:!!c.attr("disabled"),callback:function(){c.get(0).click()}};break;case"menuitem":case"command":switch(c.attr("type")){case void 0:case"command":case"menuitem":i={name:c.attr("label"),disabled:!!c.attr("disabled"),icon:c.attr("icon"),callback:function(){c.get(0).click()}};break;case"checkbox":i={type:"checkbox",disabled:!!c.attr("disabled"),name:c.attr("label"),selected:!!c.attr("checked")};break;case"radio":i={type:"radio",disabled:!!c.attr("disabled"),name:c.attr("label"),radio:c.attr("radiogroup"),value:c.attr("id"),selected:!!c.attr("checked")};break;default:i=void 0}break;case"hr":i="-------";break;case"input":switch(c.attr("type")){case"text":i={type:"text",name:o||t(l),disabled:!!c.attr("disabled"),value:c.val()};break;case"checkbox":i={type:"checkbox",name:o||t(l),disabled:!!c.attr("disabled"),selected:!!c.attr("checked")};break;case"radio":i={type:"radio",name:o||t(l),disabled:!!c.attr("disabled"),radio:!!c.attr("name"),value:c.val(),selected:!!c.attr("checked")};break;default:i=void 0}break;case"select":i={type:"select",name:o||t(l),disabled:!!c.attr("disabled"),selected:c.val(),options:{}},c.children().each(function(){i.options[this.value]=e(this).text()});break;case"textarea":i={type:"textarea",name:o||t(l),disabled:!!c.attr("disabled"),value:c.val()};break;case"label":break;default:i={type:"html",html:c.clone(!0)}}i&&(a["key"+ ++s]=i)}),s}e.support.htmlMenuitem="HTMLMenuItemElement"in window,e.support.htmlCommand="HTMLCommandElement"in window,e.support.eventSelectstart="onselectstart"in document.documentElement,e.ui&&e.widget||(e.cleanData=function(t){return function(n){var a,o,s;for(s=0;null!=n[s];s++){o=n[s];try{(a=e._data(o,"events"))&&a.remove&&e(o).triggerHandler("remove")}catch(e){}}t(n)}}(e.cleanData));var a=null,o=!1,s=e(window),i=0,c={},l={},r={},u={selector:null,appendTo:null,trigger:"right",autoHide:!1,delay:200,reposition:!0,hideOnSecondTrigger:!1,selectableSubMenu:!1,classNames:{hover:"context-menu-hover",disabled:"context-menu-disabled",visible:"context-menu-visible",notSelectable:"context-menu-not-selectable",icon:"context-menu-icon",iconEdit:"context-menu-icon-edit",iconCut:"context-menu-icon-cut",iconCopy:"context-menu-icon-copy",iconPaste:"context-menu-icon-paste",iconDelete:"context-menu-icon-delete",iconAdd:"context-menu-icon-add",iconQuit:"context-menu-icon-quit",iconLoadingClass:"context-menu-icon-loading"},determinePosition:function(t){if(e.ui&&e.ui.position)t.css("display","block").position({my:"center top",at:"center bottom",of:this,offset:"0 5",collision:"fit"}).css("display","none");else{var n=this.offset();n.top+=this.outerHeight(),n.left+=this.outerWidth()/2-t.outerWidth()/2,t.css(n)}},position:function(e,t,n){var a;if(t||n){if("maintain"===t&&"maintain"===n)a=e.$menu.position();else{var o=e.$menu.offsetParent().offset();a={top:n-o.top,left:t-o.left}}var i=s.scrollTop()+s.height(),c=s.scrollLeft()+s.width(),l=e.$menu.outerHeight(),r=e.$menu.outerWidth();a.top+l>i&&(a.top-=l),a.top<0&&(a.top=0),a.left+r>c&&(a.left-=r),a.left<0&&(a.left=0),e.$menu.css(a)}else e.determinePosition.call(this,e.$menu)},positionSubmenu:function(t){if(void 0!==t)if(e.ui&&e.ui.position)t.css("display","block").position({my:"left top-5",at:"right top",of:this,collision:"flipfit fit"}).css("display","");else{var n={top:-9,left:this.outerWidth()-5};t.css(n)}},zIndex:1,animation:{duration:50,show:"slideDown",hide:"slideUp"},events:{show:e.noop,hide:e.noop,activated:e.noop},callback:null,items:{}},d={timer:null,pageX:null,pageY:null},m={abortevent:function(e){e.preventDefault(),e.stopImmediatePropagation()},contextmenu:function(t){var n=e(this);if("right"===t.data.trigger&&(t.preventDefault(),t.stopImmediatePropagation()),!("right"!==t.data.trigger&&"demand"!==t.data.trigger&&t.originalEvent||!(void 0===t.mouseButton||!t.data||"left"===t.data.trigger&&0===t.mouseButton||"right"===t.data.trigger&&2===t.mouseButton)||n.hasClass("context-menu-active")||n.hasClass("context-menu-disabled"))){if(a=n,t.data.build){var o=t.data.build(a,t);if(!1===o)return;if(t.data=e.extend(!0,{},u,t.data,o||{}),!t.data.items||e.isEmptyObject(t.data.items))throw window.console&&(console.error||console.log).call(console,"No items specified to show in contextMenu"),new Error("No Items specified");t.data.$trigger=a,p.create(t.data)}var s=!1;for(var i in t.data.items)if(t.data.items.hasOwnProperty(i)){(e.isFunction(t.data.items[i].visible)?t.data.items[i].visible.call(e(t.currentTarget),i,t.data):void 0===t.data.items[i]||!t.data.items[i].visible||!0===t.data.items[i].visible)&&(s=!0)}s&&p.show.call(n,t.data,t.pageX,t.pageY)}},click:function(t){t.preventDefault(),t.stopImmediatePropagation(),e(this).trigger(e.Event("contextmenu",{data:t.data,pageX:t.pageX,pageY:t.pageY}))},mousedown:function(t){var n=e(this);a&&a.length&&!a.is(n)&&a.data("contextMenu").$menu.trigger("contextmenu:hide"),2===t.button&&(a=n.data("contextMenuActive",!0))},mouseup:function(t){var n=e(this);n.data("contextMenuActive")&&a&&a.length&&a.is(n)&&!n.hasClass("context-menu-disabled")&&(t.preventDefault(),t.stopImmediatePropagation(),a=n,n.trigger(e.Event("contextmenu",{data:t.data,pageX:t.pageX,pageY:t.pageY}))),n.removeData("contextMenuActive")},mouseenter:function(t){var n=e(this),o=e(t.relatedTarget),s=e(document);o.is(".context-menu-list")||o.closest(".context-menu-list").length||a&&a.length||(d.pageX=t.pageX,d.pageY=t.pageY,d.data=t.data,s.on("mousemove.contextMenuShow",m.mousemove),d.timer=setTimeout(function(){d.timer=null,s.off("mousemove.contextMenuShow"),a=n,n.trigger(e.Event("contextmenu",{data:d.data,pageX:d.pageX,pageY:d.pageY}))},t.data.delay))},mousemove:function(e){d.pageX=e.pageX,d.pageY=e.pageY},mouseleave:function(t){var n=e(t.relatedTarget);if(!n.is(".context-menu-list")&&!n.closest(".context-menu-list").length){try{clearTimeout(d.timer)}catch(t){}d.timer=null}},layerClick:function(t){var n,a,o=e(this).data("contextMenuRoot"),i=t.button,c=t.pageX,l=t.pageY;t.preventDefault(),setTimeout(function(){var r,u="left"===o.trigger&&0===i||"right"===o.trigger&&2===i;if(document.elementFromPoint&&o.$layer){if(o.$layer.hide(),(n=document.elementFromPoint(c-s.scrollLeft(),l-s.scrollTop())).isContentEditable){var d=document.createRange(),m=window.getSelection();d.selectNode(n),d.collapse(!0),m.removeAllRanges(),m.addRange(d)}e(n).trigger(t),o.$layer.show()}if(o.hideOnSecondTrigger&&u&&null!==o.$menu&&void 0!==o.$menu)o.$menu.trigger("contextmenu:hide");else{if(o.reposition&&u)if(document.elementFromPoint){if(o.$trigger.is(n))return void o.position.call(o.$trigger,o,c,l)}else if(a=o.$trigger.offset(),r=e(window),a.top+=r.scrollTop(),a.top<=t.pageY&&(a.left+=r.scrollLeft(),a.left<=t.pageX&&(a.bottom=a.top+o.$trigger.outerHeight(),a.bottom>=t.pageY&&(a.right=a.left+o.$trigger.outerWidth(),a.right>=t.pageX))))return void o.position.call(o.$trigger,o,c,l);n&&u&&o.$trigger.one("contextmenu:hidden",function(){e(n).contextMenu({x:c,y:l,button:i})}),null!==o&&void 0!==o&&null!==o.$menu&&void 0!==o.$menu&&o.$menu.trigger("contextmenu:hide")}},50)},keyStop:function(e,t){t.isInput||e.preventDefault(),e.stopPropagation()},key:function(e){var t={};a&&(t=a.data("contextMenu")||{}),void 0===t.zIndex&&(t.zIndex=0);var n=0,o=function(e){""!==e.style.zIndex?n=e.style.zIndex:null!==e.offsetParent&&void 0!==e.offsetParent?o(e.offsetParent):null!==e.parentElement&&void 0!==e.parentElement&&o(e.parentElement)};if(o(e.target),!(t.$menu&&parseInt(n,10)>parseInt(t.$menu.css("zIndex"),10))){switch(e.keyCode){case 9:case 38:if(m.keyStop(e,t),t.isInput){if(9===e.keyCode&&e.shiftKey)return e.preventDefault(),t.$selected&&t.$selected.find("input, textarea, select").blur(),void(null!==t.$menu&&void 0!==t.$menu&&t.$menu.trigger("prevcommand"));if(38===e.keyCode&&"checkbox"===t.$selected.find("input, textarea, select").prop("type"))return void e.preventDefault()}else if(9!==e.keyCode||e.shiftKey)return void(null!==t.$menu&&void 0!==t.$menu&&t.$menu.trigger("prevcommand"));break;case 40:if(m.keyStop(e,t),!t.isInput)return void(null!==t.$menu&&void 0!==t.$menu&&t.$menu.trigger("nextcommand"));if(9===e.keyCode)return e.preventDefault(),t.$selected&&t.$selected.find("input, textarea, select").blur(),void(null!==t.$menu&&void 0!==t.$menu&&t.$menu.trigger("nextcommand"));if(40===e.keyCode&&"checkbox"===t.$selected.find("input, textarea, select").prop("type"))return void e.preventDefault();break;case 37:if(m.keyStop(e,t),t.isInput||!t.$selected||!t.$selected.length)break;if(!t.$selected.parent().hasClass("context-menu-root")){var s=t.$selected.parent().parent();return t.$selected.trigger("contextmenu:blur"),void(t.$selected=s)}break;case 39:if(m.keyStop(e,t),t.isInput||!t.$selected||!t.$selected.length)break;var i=t.$selected.data("contextMenu")||{};if(i.$menu&&t.$selected.hasClass("context-menu-submenu"))return t.$selected=null,i.$selected=null,void i.$menu.trigger("nextcommand");break;case 35:case 36:return t.$selected&&t.$selected.find("input, textarea, select").length?void 0:((t.$selected&&t.$selected.parent()||t.$menu).children(":not(."+t.classNames.disabled+", ."+t.classNames.notSelectable+")")[36===e.keyCode?"first":"last"]().trigger("contextmenu:focus"),void e.preventDefault());case 13:if(m.keyStop(e,t),t.isInput){if(t.$selected&&!t.$selected.is("textarea, select"))return void e.preventDefault();break}return void(void 0!==t.$selected&&null!==t.$selected&&t.$selected.trigger("mouseup"));case 32:case 33:case 34:return void m.keyStop(e,t);case 27:return m.keyStop(e,t),void(null!==t.$menu&&void 0!==t.$menu&&t.$menu.trigger("contextmenu:hide"));default:var c=String.fromCharCode(e.keyCode).toUpperCase();if(t.accesskeys&&t.accesskeys[c])return void t.accesskeys[c].$node.trigger(t.accesskeys[c].$menu?"contextmenu:focus":"mouseup")}e.stopPropagation(),void 0!==t.$selected&&null!==t.$selected&&t.$selected.trigger(e)}},prevItem:function(t){t.stopPropagation();var n=e(this).data("contextMenu")||{},a=e(this).data("contextMenuRoot")||{};if(n.$selected){var o=n.$selected;(n=n.$selected.parent().data("contextMenu")||{}).$selected=o}for(var s=n.$menu.children(),i=n.$selected&&n.$selected.prev().length?n.$selected.prev():s.last(),c=i;i.hasClass(a.classNames.disabled)||i.hasClass(a.classNames.notSelectable)||i.is(":hidden");)if((i=i.prev().length?i.prev():s.last()).is(c))return;n.$selected&&m.itemMouseleave.call(n.$selected.get(0),t),m.itemMouseenter.call(i.get(0),t);var l=i.find("input, textarea, select");l.length&&l.focus()},nextItem:function(t){t.stopPropagation();var n=e(this).data("contextMenu")||{},a=e(this).data("contextMenuRoot")||{};if(n.$selected){var o=n.$selected;(n=n.$selected.parent().data("contextMenu")||{}).$selected=o}for(var s=n.$menu.children(),i=n.$selected&&n.$selected.next().length?n.$selected.next():s.first(),c=i;i.hasClass(a.classNames.disabled)||i.hasClass(a.classNames.notSelectable)||i.is(":hidden");)if((i=i.next().length?i.next():s.first()).is(c))return;n.$selected&&m.itemMouseleave.call(n.$selected.get(0),t),m.itemMouseenter.call(i.get(0),t);var l=i.find("input, textarea, select");l.length&&l.focus()},focusInput:function(){var t=e(this).closest(".context-menu-item"),n=t.data(),a=n.contextMenu,o=n.contextMenuRoot;o.$selected=a.$selected=t,o.isInput=a.isInput=!0},blurInput:function(){var t=e(this).closest(".context-menu-item").data(),n=t.contextMenu;t.contextMenuRoot.isInput=n.isInput=!1},menuMouseenter:function(){e(this).data().contextMenuRoot.hovering=!0},menuMouseleave:function(t){var n=e(this).data().contextMenuRoot;n.$layer&&n.$layer.is(t.relatedTarget)&&(n.hovering=!1)},itemMouseenter:function(t){var n=e(this),a=n.data(),o=a.contextMenu,s=a.contextMenuRoot;s.hovering=!0,t&&s.$layer&&s.$layer.is(t.relatedTarget)&&(t.preventDefault(),t.stopImmediatePropagation()),(o.$menu?o:s).$menu.children("."+s.classNames.hover).trigger("contextmenu:blur").children(".hover").trigger("contextmenu:blur"),n.hasClass(s.classNames.disabled)||n.hasClass(s.classNames.notSelectable)?o.$selected=null:n.trigger("contextmenu:focus")},itemMouseleave:function(t){var n=e(this),a=n.data(),o=a.contextMenu,s=a.contextMenuRoot;if(s!==o&&s.$layer&&s.$layer.is(t.relatedTarget))return void 0!==s.$selected&&null!==s.$selected&&s.$selected.trigger("contextmenu:blur"),t.preventDefault(),t.stopImmediatePropagation(),void(s.$selected=o.$selected=o.$node);o&&o.$menu&&o.$menu.hasClass("context-menu-visible")||n.trigger("contextmenu:blur")},itemClick:function(t){var n,a=e(this),o=a.data(),s=o.contextMenu,i=o.contextMenuRoot,c=o.contextMenuKey;if(!(!s.items[c]||a.is("."+i.classNames.disabled+", .context-menu-separator, ."+i.classNames.notSelectable)||a.is(".context-menu-submenu")&&!1===i.selectableSubMenu)){if(t.preventDefault(),t.stopImmediatePropagation(),e.isFunction(s.callbacks[c])&&Object.prototype.hasOwnProperty.call(s.callbacks,c))n=s.callbacks[c];else{if(!e.isFunction(i.callback))return;n=i.callback}!1!==n.call(i.$trigger,c,i,t)?i.$menu.trigger("contextmenu:hide"):i.$menu.parent().length&&p.update.call(i.$trigger,i)}},inputClick:function(e){e.stopImmediatePropagation()},hideMenu:function(t,n){var a=e(this).data("contextMenuRoot");p.hide.call(a.$trigger,a,n&&n.force)},focusItem:function(t){t.stopPropagation();var n=e(this),a=n.data(),o=a.contextMenu,s=a.contextMenuRoot;n.hasClass(s.classNames.disabled)||n.hasClass(s.classNames.notSelectable)||(n.addClass([s.classNames.hover,s.classNames.visible].join(" ")).parent().find(".context-menu-item").not(n).removeClass(s.classNames.visible).filter("."+s.classNames.hover).trigger("contextmenu:blur"),o.$selected=s.$selected=n,o&&o.$node&&o.$node.hasClass("context-menu-submenu")&&o.$node.addClass(s.classNames.hover),o.$node&&s.positionSubmenu.call(o.$node,o.$menu))},blurItem:function(t){t.stopPropagation();var n=e(this),a=n.data(),o=a.contextMenu,s=a.contextMenuRoot;o.autoHide&&n.removeClass(s.classNames.visible),n.removeClass(s.classNames.hover),o.$selected=null}},p={show:function(t,n,o){var s=e(this),i={};if(e("#context-menu-layer").trigger("mousedown"),t.$trigger=s,!1!==t.events.show.call(s,t)){if(p.update.call(s,t),t.position.call(s,t,n,o),t.zIndex){var c=t.zIndex;"function"==typeof t.zIndex&&(c=t.zIndex.call(s,t)),i.zIndex=function(e){for(var t=0,n=e;t=Math.max(t,parseInt(n.css("z-index"),10)||0),(n=n.parent())&&n.length&&!("html body".indexOf(n.prop("nodeName").toLowerCase())>-1););return t}(s)+c}p.layer.call(t.$menu,t,i.zIndex),t.$menu.find("ul").css("zIndex",i.zIndex+1),t.$menu.css(i)[t.animation.show](t.animation.duration,function(){s.trigger("contextmenu:visible"),p.activated(t),t.events.activated(t)}),s.data("contextMenu",t).addClass("context-menu-active"),e(document).off("keydown.contextMenu").on("keydown.contextMenu",m.key),t.autoHide&&e(document).on("mousemove.contextMenuAutoHide",function(e){var n=s.offset();n.right=n.left+s.outerWidth(),n.bottom=n.top+s.outerHeight(),!t.$layer||t.hovering||e.pageX>=n.left&&e.pageX<=n.right&&e.pageY>=n.top&&e.pageY<=n.bottom||setTimeout(function(){t.hovering||null===t.$menu||void 0===t.$menu||t.$menu.trigger("contextmenu:hide")},50)})}else a=null},hide:function(t,n){var o=e(this);if(t||(t=o.data("contextMenu")||{}),n||!t.events||!1!==t.events.hide.call(o,t)){if(o.removeData("contextMenu").removeClass("context-menu-active"),t.$layer){setTimeout(function(e){return function(){e.remove()}}(t.$layer),10);try{delete t.$layer}catch(e){t.$layer=null}}a=null,t.$menu.find("."+t.classNames.hover).trigger("contextmenu:blur"),t.$selected=null,t.$menu.find("."+t.classNames.visible).removeClass(t.classNames.visible),e(document).off(".contextMenuAutoHide").off("keydown.contextMenu"),t.$menu&&t.$menu[t.animation.hide](t.animation.duration,function(){t.build&&(t.$menu.remove(),e.each(t,function(e){switch(e){case"ns":case"selector":case"build":case"trigger":return!0;default:t[e]=void 0;try{delete t[e]}catch(e){}return!0}})),setTimeout(function(){o.trigger("contextmenu:hidden")},10)})}},create:function(t,n){function a(t){var n=e("<span></span>");if(t._accesskey)t._beforeAccesskey&&n.append(document.createTextNode(t._beforeAccesskey)),e("<span></span>").addClass("context-menu-accesskey").text(t._accesskey).appendTo(n),t._afterAccesskey&&n.append(document.createTextNode(t._afterAccesskey));else if(t.isHtmlName){if(void 0!==t.accesskey)throw new Error("accesskeys are not compatible with HTML names and cannot be used together in the same item");n.html(t.name)}else n.text(t.name);return n}void 0===n&&(n=t),t.$menu=e('<ul class="context-menu-list"></ul>').addClass(t.className||"").data({contextMenu:t,contextMenuRoot:n}),e.each(["callbacks","commands","inputs"],function(e,a){t[a]={},n[a]||(n[a]={})}),n.accesskeys||(n.accesskeys={}),e.each(t.items,function(o,s){var i=e('<li class="context-menu-item"></li>').addClass(s.className||""),c=null,l=null;if(i.on("click",e.noop),"string"!=typeof s&&"cm_separator"!==s.type||(s={type:"cm_seperator"}),s.$node=i.data({contextMenu:t,contextMenuRoot:n,contextMenuKey:o}),void 0!==s.accesskey)for(var u,d=function(e){for(var t,n=e.split(/\s+/),a=[],o=0;t=n[o];o++)t=t.charAt(0).toUpperCase(),a.push(t);return a}(s.accesskey),f=0;u=d[f];f++)if(!n.accesskeys[u]){n.accesskeys[u]=s;var h=s.name.match(new RegExp("^(.*?)("+u+")(.*)$","i"));h&&(s._beforeAccesskey=h[1],s._accesskey=h[2],s._afterAccesskey=h[3]);break}if(s.type&&r[s.type])r[s.type].call(i,s,t,n),e.each([t,n],function(n,a){a.commands[o]=s,!e.isFunction(s.callback)||void 0!==a.callbacks[o]&&void 0!==t.type||(a.callbacks[o]=s.callback)});else{switch("cm_seperator"===s.type?i.addClass("context-menu-separator "+n.classNames.notSelectable):"html"===s.type?i.addClass("context-menu-html "+n.classNames.notSelectable):"sub"===s.type||(s.type?(c=e("<label></label>").appendTo(i),a(s).appendTo(c),i.addClass("context-menu-input"),t.hasTypes=!0,e.each([t,n],function(e,t){t.commands[o]=s,t.inputs[o]=s})):s.items&&(s.type="sub")),s.type){case"cm_seperator":break;case"text":l=e('<input type="text" value="1" name="" />').attr("name","context-menu-input-"+o).val(s.value||"").appendTo(c);break;case"textarea":l=e('<textarea name=""></textarea>').attr("name","context-menu-input-"+o).val(s.value||"").appendTo(c),s.height&&l.height(s.height);break;case"checkbox":l=e('<input type="checkbox" value="1" name="" />').attr("name","context-menu-input-"+o).val(s.value||"").prop("checked",!!s.selected).prependTo(c);break;case"radio":l=e('<input type="radio" value="1" name="" />').attr("name","context-menu-input-"+s.radio).val(s.value||"").prop("checked",!!s.selected).prependTo(c);break;case"select":l=e('<select name=""></select>').attr("name","context-menu-input-"+o).appendTo(c),s.options&&(e.each(s.options,function(t,n){e("<option></option>").val(t).text(n).appendTo(l)}),l.val(s.selected));break;case"sub":a(s).appendTo(i),s.appendTo=s.$node,i.data("contextMenu",s).addClass("context-menu-submenu"),s.callback=null,"function"==typeof s.items.then?p.processPromises(s,n,s.items):p.create(s,n);break;case"html":e(s.html).appendTo(i);break;default:e.each([t,n],function(n,a){a.commands[o]=s,!e.isFunction(s.callback)||void 0!==a.callbacks[o]&&void 0!==t.type||(a.callbacks[o]=s.callback)}),a(s).appendTo(i)}s.type&&"sub"!==s.type&&"html"!==s.type&&"cm_seperator"!==s.type&&(l.on("focus",m.focusInput).on("blur",m.blurInput),s.events&&l.on(s.events,t)),s.icon&&(e.isFunction(s.icon)?s._icon=s.icon.call(this,this,i,o,s):"string"==typeof s.icon&&"fa-"===s.icon.substring(0,3)?s._icon=n.classNames.icon+" "+n.classNames.icon+"--fa fa "+s.icon:s._icon=n.classNames.icon+" "+n.classNames.icon+"-"+s.icon,i.addClass(s._icon))}s.$input=l,s.$label=c,i.appendTo(t.$menu),!t.hasTypes&&e.support.eventSelectstart&&i.on("selectstart.disableTextSelect",m.abortevent)}),t.$node||t.$menu.css("display","none").addClass("context-menu-root"),t.$menu.appendTo(t.appendTo||document.body)},resize:function(t,n){var a;t.css({position:"absolute",display:"block"}),t.data("width",(a=t.get(0)).getBoundingClientRect?Math.ceil(a.getBoundingClientRect().width):t.outerWidth()+1),t.css({position:"static",minWidth:"0px",maxWidth:"100000px"}),t.find("> li > ul").each(function(){p.resize(e(this),!0)}),n||t.find("ul").addBack().css({position:"",display:"",minWidth:"",maxWidth:""}).outerWidth(function(){return e(this).data("width")})},update:function(t,n){var a=this;void 0===n&&(n=t,p.resize(t.$menu)),t.$menu.children().each(function(){var o,s=e(this),i=s.data("contextMenuKey"),c=t.items[i],l=e.isFunction(c.disabled)&&c.disabled.call(a,i,n)||!0===c.disabled;if(o=e.isFunction(c.visible)?c.visible.call(a,i,n):void 0===c.visible||!0===c.visible,s[o?"show":"hide"](),s[l?"addClass":"removeClass"](n.classNames.disabled),e.isFunction(c.icon)&&(s.removeClass(c._icon),c._icon=c.icon.call(this,a,s,i,c),s.addClass(c._icon)),c.type)switch(s.find("input, select, textarea").prop("disabled",l),c.type){case"text":case"textarea":c.$input.val(c.value||"");break;case"checkbox":case"radio":c.$input.val(c.value||"").prop("checked",!!c.selected);break;case"select":c.$input.val((0===c.selected?"0":c.selected)||"")}c.$menu&&p.update.call(a,c,n)})},layer:function(t,n){var a=t.$layer=e('<div id="context-menu-layer"></div>').css({height:s.height(),width:s.width(),display:"block",position:"fixed","z-index":n,top:0,left:0,opacity:0,filter:"alpha(opacity=0)","background-color":"#000"}).data("contextMenuRoot",t).insertBefore(this).on("contextmenu",m.abortevent).on("mousedown",m.layerClick);return void 0===document.body.style.maxWidth&&a.css({position:"absolute",height:e(document).height()}),a},processPromises:function(e,t,n){function a(e,t,n){void 0===n?(n={error:{name:"No items and no error item",icon:"context-menu-icon context-menu-icon-quit"}},window.console&&(console.error||console.log).call(console,'When you reject a promise, provide an "items" object, equal to normal sub-menu items')):"string"==typeof n&&(n={error:{name:n}}),o(e,t,n)}function o(e,t,n){void 0!==t.$menu&&t.$menu.is(":visible")&&(e.$node.removeClass(t.classNames.iconLoadingClass),e.items=n,p.create(e,t,!0),p.update(e,t),t.positionSubmenu.call(e.$node,e.$menu))}e.$node.addClass(t.classNames.iconLoadingClass),n.then(function(e,t,n){void 0===n&&a(void 0),o(e,t,n)}.bind(this,e,t),a.bind(this,e,t))},activated:function(t){var n=t.$menu,a=n.offset(),o=e(window).height(),s=e(window).scrollTop(),i=n.height();i>o?n.css({height:o+"px","overflow-x":"hidden","overflow-y":"auto",top:s+"px"}):(a.top<s||a.top+i>s+o)&&n.css({top:"0px"})}};e.fn.contextMenu=function(t){var n=this,a=t;if(this.length>0)if(void 0===t)this.first().trigger("contextmenu");else if(void 0!==t.x&&void 0!==t.y)this.first().trigger(e.Event("contextmenu",{pageX:t.x,pageY:t.y,mouseButton:t.button}));else if("hide"===t){var o=this.first().data("contextMenu")?this.first().data("contextMenu").$menu:null;o&&o.trigger("contextmenu:hide")}else"destroy"===t?e.contextMenu("destroy",{context:this}):e.isPlainObject(t)?(t.context=this,e.contextMenu("create",t)):t?this.removeClass("context-menu-disabled"):t||this.addClass("context-menu-disabled");else e.each(l,function(){this.selector===n.selector&&(a.data=this,e.extend(a.data,{trigger:"demand"}))}),m.contextmenu.call(a.target,a);return this},e.contextMenu=function(t,n){"string"!=typeof t&&(n=t,t="create"),"string"==typeof n?n={selector:n}:void 0===n&&(n={});var a=e.extend(!0,{},u,n||{}),s=e(document),r=s,d=!1;switch(a.context&&a.context.length?(r=e(a.context).first(),a.context=r.get(0),d=!e(a.context).is(document)):a.context=document,t){case"update":if(d)p.update(r);else for(var f in l)l.hasOwnProperty(f)&&p.update(l[f]);break;case"create":if(!a.selector)throw new Error("No selector specified");if(a.selector.match(/.context-menu-(list|item|input)($|\s)/))throw new Error('Cannot bind to selector "'+a.selector+'" as it contains a reserved className');if(!a.build&&(!a.items||e.isEmptyObject(a.items)))throw new Error("No Items specified");if(i++,a.ns=".contextMenu"+i,d||(c[a.selector]=a.ns),l[a.ns]=a,a.trigger||(a.trigger="right"),!o){var h="click"===a.itemClickEvent?"click.contextMenu":"mouseup.contextMenu",v={"contextmenu:focus.contextMenu":m.focusItem,"contextmenu:blur.contextMenu":m.blurItem,"contextmenu.contextMenu":m.abortevent,"mouseenter.contextMenu":m.itemMouseenter,"mouseleave.contextMenu":m.itemMouseleave};v[h]=m.itemClick,s.on({"contextmenu:hide.contextMenu":m.hideMenu,"prevcommand.contextMenu":m.prevItem,"nextcommand.contextMenu":m.nextItem,"contextmenu.contextMenu":m.abortevent,"mouseenter.contextMenu":m.menuMouseenter,"mouseleave.contextMenu":m.menuMouseleave},".context-menu-list").on("mouseup.contextMenu",".context-menu-input",m.inputClick).on(v,".context-menu-item"),o=!0}switch(r.on("contextmenu"+a.ns,a.selector,a,m.contextmenu),d&&r.on("remove"+a.ns,function(){e(this).contextMenu("destroy")}),a.trigger){case"hover":r.on("mouseenter"+a.ns,a.selector,a,m.mouseenter).on("mouseleave"+a.ns,a.selector,a,m.mouseleave);break;case"left":r.on("click"+a.ns,a.selector,a,m.click);break;case"touchstart":r.on("touchstart"+a.ns,a.selector,a,m.click)}a.build||p.create(a);break;case"destroy":var x;if(d){var g=a.context;e.each(l,function(t,n){if(!n)return!0;if(!e(g).is(n.selector))return!0;(x=e(".context-menu-list").filter(":visible")).length&&x.data().contextMenuRoot.$trigger.is(e(n.context).find(n.selector))&&x.trigger("contextmenu:hide",{force:!0});try{l[n.ns].$menu&&l[n.ns].$menu.remove(),delete l[n.ns]}catch(e){l[n.ns]=null}return e(n.context).off(n.ns),!0})}else if(a.selector){if(c[a.selector]){(x=e(".context-menu-list").filter(":visible")).length&&x.data().contextMenuRoot.$trigger.is(a.selector)&&x.trigger("contextmenu:hide",{force:!0});try{l[c[a.selector]].$menu&&l[c[a.selector]].$menu.remove(),delete l[c[a.selector]]}catch(e){l[c[a.selector]]=null}s.off(c[a.selector])}}else s.off(".contextMenu .contextMenuAutoHide"),e.each(l,function(t,n){e(n.context).off(n.ns)}),c={},l={},i=0,o=!1,e("#context-menu-layer, .context-menu-list").remove();break;case"html5":(!e.support.htmlCommand&&!e.support.htmlMenuitem||"boolean"==typeof n&&n)&&e('menu[type="context"]').each(function(){this.id&&e.contextMenu({selector:"[contextmenu="+this.id+"]",items:e.contextMenu.fromMenu(this)})}).css("display","none");break;default:throw new Error('Unknown operation "'+t+'"')}return this},e.contextMenu.setInputValues=function(t,n){void 0===n&&(n={}),e.each(t.inputs,function(e,t){switch(t.type){case"text":case"textarea":t.value=n[e]||"";break;case"checkbox":t.selected=!!n[e];break;case"radio":t.selected=(n[t.radio]||"")===t.value;break;case"select":t.selected=n[e]||""}})},e.contextMenu.getInputValues=function(t,n){return void 0===n&&(n={}),e.each(t.inputs,function(e,t){switch(t.type){case"text":case"textarea":case"select":n[e]=t.$input.val();break;case"checkbox":n[e]=t.$input.prop("checked");break;case"radio":t.$input.prop("checked")&&(n[t.radio]=t.value)}}),n},e.contextMenu.fromMenu=function(t){var a={};return n(a,e(t).children()),a},e.contextMenu.defaults=u,e.contextMenu.types=r,e.contextMenu.handle=m,e.contextMenu.op=p,e.contextMenu.menus=l});
//# sourceMappingURL=jquery.contextMenu.min.js.map
;
/*! jQuery UI - v1.12.1 - 2016-09-16
 * http://jqueryui.com
 * Includes: position.js
 * Copyright jQuery Foundation and other contributors; Licensed MIT */

(function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)})(function(t){t.ui=t.ui||{},t.ui.version="1.12.1",function(){function e(t,e,i){return[parseFloat(t[0])*(u.test(t[0])?e/100:1),parseFloat(t[1])*(u.test(t[1])?i/100:1)]}function i(e,i){return parseInt(t.css(e,i),10)||0}function s(e){var i=e[0];return 9===i.nodeType?{width:e.width(),height:e.height(),offset:{top:0,left:0}}:t.isWindow(i)?{width:e.width(),height:e.height(),offset:{top:e.scrollTop(),left:e.scrollLeft()}}:i.preventDefault?{width:0,height:0,offset:{top:i.pageY,left:i.pageX}}:{width:e.outerWidth(),height:e.outerHeight(),offset:e.offset()}}var n,o=Math.max,a=Math.abs,r=/left|center|right/,l=/top|center|bottom/,h=/[\+\-]\d+(\.[\d]+)?%?/,c=/^\w+/,u=/%$/,d=t.fn.position;t.position={scrollbarWidth:function(){if(void 0!==n)return n;var e,i,s=t("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),o=s.children()[0];return t("body").append(s),e=o.offsetWidth,s.css("overflow","scroll"),i=o.offsetWidth,e===i&&(i=s[0].clientWidth),s.remove(),n=e-i},getScrollInfo:function(e){var i=e.isWindow||e.isDocument?"":e.element.css("overflow-x"),s=e.isWindow||e.isDocument?"":e.element.css("overflow-y"),n="scroll"===i||"auto"===i&&e.width<e.element[0].scrollWidth,o="scroll"===s||"auto"===s&&e.height<e.element[0].scrollHeight;return{width:o?t.position.scrollbarWidth():0,height:n?t.position.scrollbarWidth():0}},getWithinInfo:function(e){var i=t(e||window),s=t.isWindow(i[0]),n=!!i[0]&&9===i[0].nodeType,o=!s&&!n;return{element:i,isWindow:s,isDocument:n,offset:o?t(e).offset():{left:0,top:0},scrollLeft:i.scrollLeft(),scrollTop:i.scrollTop(),width:i.outerWidth(),height:i.outerHeight()}}},t.fn.position=function(n){if(!n||!n.of)return d.apply(this,arguments);n=t.extend({},n);var u,p,f,g,m,_,v=t(n.of),b=t.position.getWithinInfo(n.within),y=t.position.getScrollInfo(b),w=(n.collision||"flip").split(" "),k={};return _=s(v),v[0].preventDefault&&(n.at="left top"),p=_.width,f=_.height,g=_.offset,m=t.extend({},g),t.each(["my","at"],function(){var t,e,i=(n[this]||"").split(" ");1===i.length&&(i=r.test(i[0])?i.concat(["center"]):l.test(i[0])?["center"].concat(i):["center","center"]),i[0]=r.test(i[0])?i[0]:"center",i[1]=l.test(i[1])?i[1]:"center",t=h.exec(i[0]),e=h.exec(i[1]),k[this]=[t?t[0]:0,e?e[0]:0],n[this]=[c.exec(i[0])[0],c.exec(i[1])[0]]}),1===w.length&&(w[1]=w[0]),"right"===n.at[0]?m.left+=p:"center"===n.at[0]&&(m.left+=p/2),"bottom"===n.at[1]?m.top+=f:"center"===n.at[1]&&(m.top+=f/2),u=e(k.at,p,f),m.left+=u[0],m.top+=u[1],this.each(function(){var s,r,l=t(this),h=l.outerWidth(),c=l.outerHeight(),d=i(this,"marginLeft"),_=i(this,"marginTop"),x=h+d+i(this,"marginRight")+y.width,C=c+_+i(this,"marginBottom")+y.height,D=t.extend({},m),T=e(k.my,l.outerWidth(),l.outerHeight());"right"===n.my[0]?D.left-=h:"center"===n.my[0]&&(D.left-=h/2),"bottom"===n.my[1]?D.top-=c:"center"===n.my[1]&&(D.top-=c/2),D.left+=T[0],D.top+=T[1],s={marginLeft:d,marginTop:_},t.each(["left","top"],function(e,i){t.ui.position[w[e]]&&t.ui.position[w[e]][i](D,{targetWidth:p,targetHeight:f,elemWidth:h,elemHeight:c,collisionPosition:s,collisionWidth:x,collisionHeight:C,offset:[u[0]+T[0],u[1]+T[1]],my:n.my,at:n.at,within:b,elem:l})}),n.using&&(r=function(t){var e=g.left-D.left,i=e+p-h,s=g.top-D.top,r=s+f-c,u={target:{element:v,left:g.left,top:g.top,width:p,height:f},element:{element:l,left:D.left,top:D.top,width:h,height:c},horizontal:0>i?"left":e>0?"right":"center",vertical:0>r?"top":s>0?"bottom":"middle"};h>p&&p>a(e+i)&&(u.horizontal="center"),c>f&&f>a(s+r)&&(u.vertical="middle"),u.important=o(a(e),a(i))>o(a(s),a(r))?"horizontal":"vertical",n.using.call(this,t,u)}),l.offset(t.extend(D,{using:r}))})},t.ui.position={fit:{left:function(t,e){var i,s=e.within,n=s.isWindow?s.scrollLeft:s.offset.left,a=s.width,r=t.left-e.collisionPosition.marginLeft,l=n-r,h=r+e.collisionWidth-a-n;e.collisionWidth>a?l>0&&0>=h?(i=t.left+l+e.collisionWidth-a-n,t.left+=l-i):t.left=h>0&&0>=l?n:l>h?n+a-e.collisionWidth:n:l>0?t.left+=l:h>0?t.left-=h:t.left=o(t.left-r,t.left)},top:function(t,e){var i,s=e.within,n=s.isWindow?s.scrollTop:s.offset.top,a=e.within.height,r=t.top-e.collisionPosition.marginTop,l=n-r,h=r+e.collisionHeight-a-n;e.collisionHeight>a?l>0&&0>=h?(i=t.top+l+e.collisionHeight-a-n,t.top+=l-i):t.top=h>0&&0>=l?n:l>h?n+a-e.collisionHeight:n:l>0?t.top+=l:h>0?t.top-=h:t.top=o(t.top-r,t.top)}},flip:{left:function(t,e){var i,s,n=e.within,o=n.offset.left+n.scrollLeft,r=n.width,l=n.isWindow?n.scrollLeft:n.offset.left,h=t.left-e.collisionPosition.marginLeft,c=h-l,u=h+e.collisionWidth-r-l,d="left"===e.my[0]?-e.elemWidth:"right"===e.my[0]?e.elemWidth:0,p="left"===e.at[0]?e.targetWidth:"right"===e.at[0]?-e.targetWidth:0,f=-2*e.offset[0];0>c?(i=t.left+d+p+f+e.collisionWidth-r-o,(0>i||a(c)>i)&&(t.left+=d+p+f)):u>0&&(s=t.left-e.collisionPosition.marginLeft+d+p+f-l,(s>0||u>a(s))&&(t.left+=d+p+f))},top:function(t,e){var i,s,n=e.within,o=n.offset.top+n.scrollTop,r=n.height,l=n.isWindow?n.scrollTop:n.offset.top,h=t.top-e.collisionPosition.marginTop,c=h-l,u=h+e.collisionHeight-r-l,d="top"===e.my[1],p=d?-e.elemHeight:"bottom"===e.my[1]?e.elemHeight:0,f="top"===e.at[1]?e.targetHeight:"bottom"===e.at[1]?-e.targetHeight:0,g=-2*e.offset[1];0>c?(s=t.top+p+f+g+e.collisionHeight-r-o,(0>s||a(c)>s)&&(t.top+=p+f+g)):u>0&&(i=t.top-e.collisionPosition.marginTop+p+f+g-l,(i>0||u>a(i))&&(t.top+=p+f+g))}},flipfit:{left:function(){t.ui.position.flip.left.apply(this,arguments),t.ui.position.fit.left.apply(this,arguments)},top:function(){t.ui.position.flip.top.apply(this,arguments),t.ui.position.fit.top.apply(this,arguments)}}}}(),t.ui.position});;
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,b,c){a instanceof String&&(a=String(a));for(var e=a.length,d=0;d<e;d++){var f=a[d];if(b.call(c,f,d,a))return{i:d,v:f}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){if(a==Array.prototype||a==Object.prototype)return a;a[b]=c.value;return a};$jscomp.getGlobal=function(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var c=a[b];if(c&&c.Math==Math)return c}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(a,b){var c=$jscomp.propertyToPolyfillSymbol[b];if(null==c)return a[b];c=a[c];return void 0!==c?c:a[b]};
$jscomp.polyfill=function(a,b,c,e){b&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(a,b,c,e):$jscomp.polyfillUnisolated(a,b,c,e))};$jscomp.polyfillUnisolated=function(a,b,c,e){c=$jscomp.global;a=a.split(".");for(e=0;e<a.length-1;e++){var d=a[e];d in c||(c[d]={});c=c[d]}a=a[a.length-1];e=c[a];b=b(e);b!=e&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})};
$jscomp.polyfillIsolated=function(a,b,c,e){var d=a.split(".");a=1===d.length;e=d[0];e=!a&&e in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var f=0;f<d.length-1;f++){var g=d[f];g in e||(e[g]={});e=e[g]}d=d[d.length-1];c=$jscomp.IS_SYMBOL_NATIVE&&"es6"===c?e[d]:null;b=b(c);null!=b&&(a?$jscomp.defineProperty($jscomp.polyfills,d,{configurable:!0,writable:!0,value:b}):b!==c&&($jscomp.propertyToPolyfillSymbol[d]=$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(d):$jscomp.POLYFILL_PREFIX+d,d=$jscomp.propertyToPolyfillSymbol[d],
$jscomp.defineProperty(e,d,{configurable:!0,writable:!0,value:b})))};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6","es3");
$("body").on("click","#simpleInvoicePriceWrap .planPriceItem",function(a){var b=$(this);simpleInvoiceMaxId++;a={formulaValue:"",total:0,amount:1,new:1,itemDiscount:0};a.id=simpleInvoiceMaxId;a.priceItemId=b.attr("data-itemId");a.itemPrice=b.find(".planPriceItemPrice").attr("data-price");a.total=a.itemPrice;a.itemName=b.find(".planPriceItemName").text();a.itemDiscount=invoice.discount;4114==currentClinicId&&(b=b.closest(".priceGroupDiv"),b=parseInt(b.attr("data-groupId")),console.log("groupId",b),
-1!=[4466,4505,4560,4651,4837,4750].indexOf(b)&&(a.itemDiscount=0));invoice.items[simpleInvoiceMaxId]=a;$("#planPriceSearchInput").val("").trigger("keyup");renderSimpleInvoice();$("#simpleInvoicePriceWrap").hasClass("mobilePlanPriceWrap")&&slideRightInvoicePrice();unsavedChanges=!0;$(".simpleInvoiceItemNameInput").trigger("keyup")});
$("body").on("click","#simpleInvoicePriceWrap .planPriceGroup",function(a){var b=$(this).closest(".priceGroupDiv");confirmDialog({buttonText:T["plans.Add group button"],text:T["plans.Add group?"],action:function(){b.find(".planPriceItem").each(function(){var a=$(this);simpleInvoiceMaxId++;var b={formulaValue:"",total:0,amount:1,new:1,itemDiscount:0};b.id=simpleInvoiceMaxId;b.priceItemId=a.attr("data-itemId");b.itemPrice=a.find(".planPriceItemPrice").attr("data-price");b.total=b.itemPrice;b.itemName=
a.find(".planPriceItemName").text();invoice.items[simpleInvoiceMaxId]=b});$("#planPriceSearchInput").val("").trigger("keyup");renderSimpleInvoice();$("#simpleInvoicePriceWrap").hasClass("mobilePlanPriceWrap")&&slideRightInvoicePrice();unsavedChanges=!0}})});$("body").on("focus",".simpleInvoiceItemAmountInput",function(a){$(this).prop("selectionStart",0);$(this).prop("selectionEnd",999)});
$("body").on("keyup",".simpleInvoiceItemAmountInput",function(a){recalculateSimpleInvoiceItemAmount($(this));unsavedChanges=!0});$("body").on("change",".simpleInvoiceItemAmountInput",function(a){a=recalculateSimpleInvoiceItemAmount($(this));$(this).val(a.amount);unsavedChanges=!0});$("body").on("focus",".simpleInvoiceItemDiscountInput",function(a){$(this).prop("selectionStart",0);$(this).prop("selectionEnd",999)});
$("body").on("keyup",".simpleInvoiceItemDiscountInput",function(a){recalculateSimpleInvoiceItemDiscount($(this));unsavedChanges=!0});$("body").on("change",".simpleInvoiceItemDiscountInput",function(a){a=recalculateSimpleInvoiceItemDiscount($(this));$(this).val(a.itemDiscount);unsavedChanges=!0});
$("body").on("click",".addDiscountToSimpleInvoice",function(a){$("#simpleInvoiceDiscountInputModal").modal("show");$("#discountInputSimpleInvoiceModalDiscountInput").val(invoice.discount).focus();$("#discountInputSimpleInvoiceModalDiscountInput").prop("selectionStart",0);$("#discountInputSimpleInvoiceModalDiscountInput").prop("selectionEnd",999)});
$("body").on("submit","#discountInputSimpleInvoiceModalForm",function(a){a.preventDefault();a=parseFloat($("#discountInputSimpleInvoiceModalDiscountInput").val());isNaN(a)&&(a=0);100<a&&(a=100);for(var b in invoice.items)invoice.items[b].itemDiscount=a;invoice.discount=a;renderSimpleInvoice();$("#simpleInvoiceDiscountInputModal").modal("hide");$(".simpleInvoiceItemNameInput").trigger("keyup");unsavedChanges=!0});
$("body").on("focus",".simpleInvoiceItemDZoneInput",function(a){$(this).prop("selectionStart",0);$(this).prop("selectionEnd",999)});
$("body").on("change",".simpleInvoiceItemDZoneInput",function(a){a=parseInt($(this).val());-1==[11,12,13,14,15,16,17,18,21,22,23,24,25,26,27,28,31,32,33,34,35,36,37,38,41,42,43,44,45,46,47,48,55,54,53,52,51,61,62,63,64,65,85,84,83,82,81,71,72,73,74,75].indexOf(a)&&(a="",confirmDialog({cancelButtonText:"Ok",text:T["Msg.Enter correct zone"]}));var b=$(this).closest("tr");b=parseInt(b.attr("data-itemId"));invoice.items[b].formulaValue=a;$(this).val(a);unsavedChanges=!0});
$(document).on("keyup",".simpleInvoiceItemNameInput",function(){saveSimpleInvoiceItemName($(this));this.style.height="auto";this.style.height=this.scrollHeight-2+"px"});$(document).on("change",".simpleInvoiceItemNameInput",function(){unsavedChanges=!0});$(document).on("click",".simpleInvoiceItemNameInput",function(){ACCESS_INVOICE_NAME_EDITING&&$(this).removeAttr("readonly")});
$(document).on("keyup",".simpleInvoiceItemPriceInput",function(){if(!this.reportValidity())return $(this).val($(this).val().replace(/[^\d. ]/,"")),!1;saveSimpleInvoiceItemPrice($(this));renderSimpleInvoiceDiscount();unsavedChanges=!0});$(document).on("click",".simpleInvoiceItemPriceInput",function(){ACCESS_INVOICE_PRICE_EDITING&&$(this).removeAttr("readonly")});$("body").on("click",".saveSimpleInvoice",function(a){$("#simpleInvoceCreationClinicMemberSelectModal").modal("show");$("#invoicePurpose").select2({minimumResultsForSearch:Infinity})});
$("body").on("click","#simpleInvoceCreationClinicMemberSelectModalForm_createInvoceButton, #saveAndFiscalise",function(a){a={invoice:JSON.stringify(invoice),performerClinicsMembersId:$("#simpleInvoceCreationClinicMemberSelectModalForm_performerClinicMemberId").val(),creator:$("#simpleInvoceCreationClinicMemberSelectModalForm_clinicMemberId").val(),date:getDateTimePickerDateInServerFormat("#simpleInvoceCreationClinicMemberSelectModalForm_date"),invoice_note:$("#simpleInvoceCreationClinicMemberSelectModalForm_invoice_note").val(),
fiscalise:"saveAndFiscalise"===$(this).attr("id")?1:0,purpose:$("#invoicePurposeInModal").val(),purpose_companies_id:$("#invoicePurposeInModalCompanies").val(),purpose_polices_id:$("#invoicePurposeInModalPolicy").val(),purpose_diagnosis:$("#insuranceDiagnosisInput").val(),purpose_payed:$("#insurancePurposePayed").val()};document.getElementById("simpleInvoceCreationClinicMemberSelectModalForm_subclinicsId")&&(a.subclinics_id=$("#simpleInvoceCreationClinicMemberSelectModalForm_subclinicsId").val());
ajax({url:"/cabinet/simple-invoice/save",data:a,success:function(a){unsavedChanges=!1}})});$("body").on("click",".removeSimpleInvoiceItem",function(a){a=$(this).closest("tr");a=parseInt(a.attr("data-itemId"));delete invoice.items[a];renderSimpleInvoice();unsavedChanges=!0});$(window).on("resize",function(a){a.target==this&&positionSimpleInvoice("resize")});$("body").on("click",".receivePaymentLinkToPatientPaymentsList",function(a){openPaymentDialogOnLoad=!0});
function slideRightInvoicePrice(){var a=$(window).width();window.scrollTo(0,bodyScrollTop);$("#simpleInvoicePriceWrap").animate({right:-a},function(){})}$("body").on("click","#simpleInvoicePriceToggle",function(a){0==parseInt($("#simpleInvoicePriceWrap").css("right"))?slideRightInvoicePrice():(bodyScrollTop=document.body.scrollTop,$("#simpleInvoicePriceWrap").animate({right:"0px"},function(){window.scrollTo(0,0);$("#planPriceSearchInput").focus().blur()}))});
$("body").on("click","#closePlanPrice",function(a){slideRightInvoicePrice()});$("body").on("click",".invoiceCommentModalTriggerButton",function(a){a=$(this).attr("data-id");ajax({url:"/cabinet/invoices/get-invoice-comment-modal-body",data:{invoiceId:a},success:function(a){$("#invoiceCommentModal").html(a.html).modal("show");$("#invoiceCommentModalForm_invoice_note").focusToEnd()}})});
$("body").on("click","#invoiceCommentModal_saveButton",function(a){a=$("#invoiceCommentModalForm_invoice_note").val();var b=$("#invoiceCommentModalForm_invoice_note").attr("data-id");ajax({url:"/cabinet/invoices/save-comment",data:{invoiceId:b,comment:a},success:function(a){$("#invoiceCommentModal").html("").modal("hide");locationHashChanged()}})});
$("body").on("click","[data-copy-invoice]",function(){var a=$(this).data("copy-invoice");ajax({url:"/cabinet/invoices/prepare-to-copy",data:{invoiceId:a},success:function(a){$("#copyInvoice").html(a.html);$("#simpleInvoceCreationClinicMemberSelectModal").modal("show")}});return!1});
;
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,b,d){a instanceof String&&(a=String(a));for(var c=a.length,e=0;e<c;e++){var f=a[e];if(b.call(d,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,d){a!=Array.prototype&&a!=Object.prototype&&(a[b]=d.value)};$jscomp.getGlobal=function(a){a=["object"==typeof globalThis&&globalThis,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,a];for(var b=0;b<a.length;++b){var d=a[b];if(d&&d.Math==Math)return d}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,b,d,c){if(b){d=$jscomp.global;a=a.split(".");for(c=0;c<a.length-1;c++){var e=a[c];e in d||(d[e]={});d=d[e]}a=a[a.length-1];c=d[a];b=b(c);b!=c&&null!=b&&$jscomp.defineProperty(d,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(b,a){return $jscomp.findInternal(this,b,a).v}},"es6","es3");
function renderSimpleInvoice(){var a=$("#simpleInvoiceItems tbody");a.html("");var b=0;for(c in invoice.items)invoice.items.hasOwnProperty(c)&&b++;b?$("#simpleInvoiceContainer").removeClass("simpleInvoiceIsEmpty").addClass("simpleInvoiceIsNotEmpty"):$("#simpleInvoiceContainer").removeClass("simpleInvoiceIsNotEmpty").addClass("simpleInvoiceIsEmpty");for(var d in invoice.items){b=invoice.items[d];var c='<tr data-itemId="'+d+'">';c+='<td><input class="simpleInvoiceItemDZoneInput" type="text" value="'+
b.formulaValue+'"/></td>';c+='<td><textarea rows="1" '+(ACCESS_INVOICE_NAME_EDITING?"":"readonly")+' class="simpleInvoiceItemNameInput">'+b.itemName+"</textarea></td>";c+='<td class="simpleInvoicePrice"><input '+(ACCESS_INVOICE_PRICE_EDITING?"":"readonly")+' pattern="^[0-9]* ?[0-9]*\\.?[0-9]*$" class="simpleInvoiceItemPriceInput" type="text" value="'+formatPrice(b.itemPrice)+'"/></td>';c+='<td><input class="simpleInvoiceItemAmountInput" type="text" value="'+b.amount+'"/></td>';c+='<td><input class="simpleInvoiceItemDiscountInput" type="text" value="'+
b.itemDiscount+'"/></td>';c+='<td class="simpleInvoiceTotal">'+formatPrice(b.itemPrice*b.amount*(100-b.itemDiscount)/100)+"</td>";c+='<td><span class="removeSimpleInvoiceItem"><i class="fa fa-times"></i></span></td>';a.append(c)}renderSimpleInvoiceDiscount()}
function positionSimpleInvoice(a){var b=$("#simpleInvoiceContainerWrap");if(b.length){var d=$("#main_content"),c=$("#simpleInvoicePriceWrap"),e=d.offset(),f=d.width();d=$(window).width();var g=$(window).height();e=g-e.top-30-150;f=Math.min(450,f-b.width());1300<d?(c.removeClass("mobilePlanPriceWrap"),c.css("top",197),c.css("left",b.offset().left+b.width()+13),c.css("width",f),c.css("height",e),$("#planPriceSearchDiv").css("width",f),$("#planPriceContainer").css("height",e-30),$("#simpleInvoiceContainer").css("min-height",
Math.min(900,g-266))):(c.addClass("mobilePlanPriceWrap"),c.css("top",0),c.css("width","100%"),c.css("height","100%"),c.css("left","inherit"),"init"!=a&&__windowWidth==d||c.css("right",-d),$("#planPriceContainer").css("height",g+12),$("#planPriceSearchDiv").css("width",d-70),$("#simpleInvoiceContainer").css("min-height",Math.min(900,g-206)));__windowWidth=d}}
function recalculateSimpleInvoiceItemAmount(a){var b=a.val();b=isNaN(b)||0>=b?1:b;b=parseInt(200<b?200:b);a=a.closest("tr");var d=a.find(".simpleInvoiceItemPriceInput").val().replace(/ /g,""),c=a.find(".simpleInvoiceItemDiscountInput").val().replace(/ /g,"");d=b*d*(100-c)/100;a.find(".simpleInvoiceTotal").html(formatPrice(d));a=parseInt(a.attr("data-itemId"));invoice.items[a].amount=b;renderSimpleInvoiceDiscount();return{amount:b}}
function recalculateSimpleInvoiceItemDiscount(a){var b=a.val();b=isNaN(b)||0>=b?0:b;b=parseFloat(100<b?100:b);a=a.closest("tr");var d=a.find(".simpleInvoiceItemPriceInput").val().replace(/ /g,""),c=a.find(".simpleInvoiceItemAmountInput").val().replace(/ /g,"");d=d*c*(100-b)/100;a.find(".simpleInvoiceTotal").html(formatPrice(d));a=parseInt(a.attr("data-itemId"));invoice.items[a].itemDiscount=b;renderSimpleInvoiceDiscount();return{itemDiscount:b}}
function renderSimpleInvoiceDiscount(){var a=0,b=0,d;for(d in invoice.items){var c=invoice.items[d];a+=parseFloat(c.itemPrice*c.amount);b+=parseFloat(c.itemPrice*c.amount*(100-c.itemDiscount)/100)}$("#simpleInvoiceTotalWithoutDiscount").html(formatPrice(a));$("#simpleInvoiceDiscount").html(formatPrice(a-b));currentClinicRounding?$("#simpleInvoiceTotalWithDiscount").html(formatPrice(Math.floor(b))):$("#simpleInvoiceTotalWithDiscount").html(formatPrice(b));a!=b?$(".simpleInvoiceShowRowIfDeiscountPresent").show():
$(".simpleInvoiceShowRowIfDeiscountPresent").hide()}function saveSimpleInvoiceItemName(a){var b=a.closest("[data-itemid]").data("itemid");invoice.items[b].itemName=a.val()}
function saveSimpleInvoiceItemPrice(a){var b=a.closest("[data-itemid]"),d=b.data("itemid");a=a.val().replace(/ /g,"");var c=b.find(".simpleInvoiceItemAmountInput").val().replace(/ /g,""),e=b.find(".simpleInvoiceItemDiscountInput").val().replace(/ /g,"");c=a*c*(100-e)/100;invoice.items[d].itemPrice=a;b.find(".simpleInvoiceTotal").html(formatPrice(c))};
;
$("body").on("submit","#reminderForm",function(event){event.preventDefault();var patientId=$("#reminderForm_patientId").val();var reminderId=$("#reminderForm_reminderId").val();var status=$("#reminderForm_status").val();var date=getDateTimePickerDateInServerFormat("#reminderForm_datetimepickerDate","YYYY-MM-DD");var note=$("#reminderForm_note").val();var executor=$("#reminderForm_executor").val();var priority=$("#reminderForm_priority").val();var annotationId=$("#reminderForm_annotationId").val();
    ajax({url:"/cabinet/reminders/save",data:{patientId:patientId,reminderId:reminderId,status:status,date:date,note:note,executor:executor,priority:priority,annotationId:annotationId},success:function(data){$("#reminderModal").html("").modal("hide");locationHashChanged()}})});
$("body").on("click",".editReminderButton",function(event){var reminderId=$(this).attr("data-reminderId");var action=function(){ajax({url:"/cabinet/reminders/get-form",data:{reminderId:reminderId},success:function(data){if(typeof data.formHtml!="undefined"){$("#reminderModal").html(data.formHtml).modal("show");if(!isMobileDevice)$("#reminderForm_note").focusToEnd()}}})};action()});$("body").on("click","#remindersWrap a, #remindersWrap button:not(.changeReminderStatusButton)",function(event){closeRemindersPopup()});
$("body").on("click",".createNewReminderButton",function(event){var patientId=$(this).attr("data-patientId");var annotationId=$(this).attr("data-annotationId");var action=function(){ajax({url:"/cabinet/reminders/get-form",data:{patientId:patientId,annotationId:annotationId},success:function(data){if(typeof data.formHtml!="undefined"){$("#reminderModal").html(data.formHtml).modal("show");$("#reminderForm_note").focus()}}})};action()});
function closeRemindersPopup(){$("#remindersPopup").fadeOut("fast");$("#main_content").css("max-height","inherit")}function showNewRemindersCount(newRemindersCount){if(newRemindersCount>0)$("#newRemindersCount").html(newRemindersCount).show();else $("#newRemindersCount").html(newRemindersCount).hide()}
function getRemindersForPopup(hideRemindersPopupIfZeroReminders){ajax({url:"/cabinet/reminders/get-reminders-list",success:function(data){if(data.status=="success"){showNewRemindersCount(data.remindersCount);$("#remindersList").html(data.remindersHtml);$("#remindersPopup").show();setRemindersArrow();var remindersPopupTop=parseInt($("#remindersPopup").css("top"));if($(window).width()>576){var remindersWrapHeight=$("#remindersWrap").height()+2;if(remindersWrapHeight>$(window).height()-remindersPopupTop-
        20)remindersWrapHeight=$(window).height()-remindersPopupTop-20}else{remindersWrapHeight=$(window).height()-remindersPopupTop;$("#main_content").css("max-height","1px");$("#startSelection").hide()}$("#remindersPopup").css("height",remindersWrapHeight);if(typeof hideRemindersPopupIfZeroReminders!="undefined"&&hideRemindersPopupIfZeroReminders)if(data.newRemindersCount==0)closeRemindersPopup()}}})}
$("#header_reminders_bar a").on("click",function(event){if($("#remindersPopup").is(":visible"))closeRemindersPopup();else getRemindersForPopup()});
function setRemindersArrow(){var buttonOffset=$("#showRemindersButton").offset().left;var windowWidth=$(window).width();var offsetRight=windowWidth-buttonOffset;var offset=windowWidth>576?58:30;if(windowWidth>855&&windowWidth<991){$("#remindersPopup").css("right","130px");offset=160}else $("#remindersPopup").css("right","30px");$("#remindersPopup .arrowtop").css("right",Math.round(offsetRight-offset));$("#remindersPopup .arrowbottom").css("right",Math.round(offsetRight-offset)+1)}
$("body").on("click",".changeReminderStatusButton",function(event){var reminderId=$(this).attr("data-reminderId");var status=$(this).attr("data-status");ajax({url:"/cabinet/reminders/set-reminder-status",data:{reminderId:reminderId,status:status},success:function(data){if(data.status=="success"){showNewRemindersCount(data.remindersCount);$("#reminderItemInPopup"+reminderId).fadeTo("slow",.01,function(){$(this).hide()});if(data.remindersCount==0)$(".noNewRemindersMessage").removeClass("hidden");if(document.location.hash==
        "#reminders"||/#schedule-visits\/list\/[0-9]+/.test(document.location.hash))locationHashChanged(false)}}})});;
$("body").on("submit","#annotationForm",function(event){event.preventDefault();var patientId=$("#annotationForm_patientId").val();var annotationId=$("#annotationForm_annotationId").val();var status=$("#annotationForm_status").val();var date=getDateTimePickerDateInServerFormat("#annotationForm_datetimepickerDate","YYYY-MM-DD");var note=$("#annotationForm_note").val();var visitOrReminder=$("#annotationForm_visitOrReminder").val();ajax({url:"/cabinet/annotations/save",data:{patientId:patientId,annotationId:annotationId,
        status:status,date:date,note:note,visitOrReminder:visitOrReminder},success:function(data){$("#annotationModal").html("").modal("hide");locationHashChanged()}})});
$("body").on("click",".editAnnotationButton",function(event){var annotationId=$(this).attr("data-annotationId");var action=function(){ajax({url:"/cabinet/annotations/get-form",data:{annotationId:annotationId},success:function(data){if(typeof data.formHtml!="undefined"){$("#annotationModal").html(data.formHtml).modal("show");if(!isMobileDevice)$("#annotationForm_note").focusToEnd()}}})};action()});
$("body").on("click","#annotationsWrap a, #annotationsWrap button:not(.changeAnnotationStatusButton)",function(event){closeAnnotationsPopup()});
$("body").on("click",".createNewAnnotationButton",function(event){var patientId=$(this).attr("data-patientId");var visitId=$(this).attr("data-visitId");var reminderId=$(this).attr("data-reminderId");var action=function(){ajax({url:"/cabinet/annotations/get-form",data:{patientId:patientId,visitId:visitId,reminderId:reminderId},success:function(data){if(typeof data.formHtml!="undefined"){$("#annotationModal").html(data.formHtml).modal("show");$("#annotationForm_note").focus()}}})};action()});
function closeAnnotationsPopup(){$("#annotationsPopup").fadeOut("fast");$("#main_content").css("max-height","inherit")}function showNewAnnotationsCount(newAnnotationsCount){if(newAnnotationsCount>0)$("#newAnnotationsCount").html(newAnnotationsCount).show();else $("#newAnnotationsCount").html(newAnnotationsCount).hide()}
function getAnnotationsForPopup(hideAnnotationsPopupIfZeroAnnotations){ajax({url:"/cabinet/annotations/get-annotations-list",success:function(data){if(data.status=="success"){showNewAnnotationsCount(data.annotationsCount);$("#annotationsList").html(data.annotationsHtml);$("#annotationsPopup").show();setAnnotationsArrow();var annotationsPopupTop=parseInt($("#annotationsPopup").css("top"));if($(window).width()>576){var annotationsWrapHeight=$("#annotationsWrap").height()+2;if(annotationsWrapHeight>
        $(window).height()-annotationsPopupTop-20)annotationsWrapHeight=$(window).height()-annotationsPopupTop-20}else{annotationsWrapHeight=$(window).height()-annotationsPopupTop;$("#main_content").css("max-height","1px");$("#startSelection").hide()}$("#annotationsPopup").css("height",annotationsWrapHeight);if(typeof hideAnnotationsPopupIfZeroAnnotations!="undefined"&&hideAnnotationsPopupIfZeroAnnotations)if(data.newAnnotationsCount==0)closeAnnotationsPopup()}}})}
$("#header_annotations_bar a").on("click",function(event){if($("#annotationsPopup").is(":visible"))closeAnnotationsPopup();else getAnnotationsForPopup()});
function setAnnotationsArrow(){var buttonOffset=$("#showAnnotationsButton").offset().left;var windowWidth=$(window).width();var offsetRight=windowWidth-buttonOffset;var offset=windowWidth>576?58:30;if(windowWidth>855&&windowWidth<991){$("#annotationsPopup").css("right","130px");offset=160}else $("#annotationsPopup").css("right","30px");$("#annotationsPopup .arrowtop").css("right",Math.round(offsetRight-offset));$("#annotationsPopup .arrowbottom").css("right",Math.round(offsetRight-offset)+1)}
$("body").on("click",".changeAnnotationStatusButton",function(event){var annotationId=$(this).attr("data-annotationId");var status=$(this).attr("data-status");ajax({url:"/cabinet/annotations/set-annotation-status",data:{annotationId:annotationId,status:status},success:function(data){if(data.status=="success"){showNewAnnotationsCount(data.annotationsCount);$("#annotationItemInPopup"+annotationId).fadeTo("slow",.01,function(){$(this).hide()});if(data.annotationsCount==0)$(".noNewAnnotationsMessage").removeClass("hidden");
        if(document.location.hash=="#annotations"||/#schedule-visits\/list\/[0-9]+/.test(document.location.hash))locationHashChanged(false)}}})});;
$("body").on("submit","#waitingForm",function(a){a.preventDefault();a=$("#waitingForm_patientId").val();var b=$("#waitingForm_waitingId").val(),c=$("#waitingForm_status").val(),d=$("#waitingForm_note").val(),e=$("#waitingForm_clinics_members_id").val();ajax({url:"/cabinet/waitings/save",data:{patientId:a,waitingId:b,status:c,note:d,clinics_members_id:e},success:function(a){$("#waitingModal").html("").modal("hide");locationHashChanged()}})});
$("body").on("click",".editWaitingButton",function(a){var b=$(this).attr("data-waitingId");(function(){ajax({url:"/cabinet/waitings/get-form",data:{waitingId:b},success:function(a){"undefined"!=typeof a.formHtml&&($("#waitingModal").html(a.formHtml).modal("show"),isMobileDevice||$("#waitingForm_note").focusToEnd())}})})()});$("body").on("click","#waitingsWrap a, #waitingsWrap button:not(.changeWaitingStatusButton)",function(a){closeWaitingsPopup()});
$("body").on("click",".createNewWaitingButton",function(a){var b=$(this).attr("data-patientId");(function(){ajax({url:"/cabinet/waitings/get-form",data:{patientId:b},success:function(a){"undefined"!=typeof a.formHtml&&($("#waitingModal").html(a.formHtml).modal("show"),$("#waitingForm_note").focus())}})})()});function closeWaitingsPopup(){$("#waitingsPopup").fadeOut("fast");$("#main_content").css("max-height","inherit")}
function showNewWaitingsCount(a){0<a?$("#newWaitingsCount").html(a).show():$("#newWaitingsCount").html(a).hide()}
function getWaitingsForPopup(a){ajax({url:"/cabinet/waitings/get-waitings-list",success:function(b){if("success"==b.status){showNewWaitingsCount(b.waitingsCount);$("#waitingsList").html(b.waitingsHtml);$("#waitingsPopup").show();setWaitingsArrow();var c=parseInt($("#waitingsPopup").css("top"));if(576<$(window).width()){var d=$("#waitingsWrap").height()+2;d>$(window).height()-c-20&&(d=$(window).height()-c-20)}else d=$(window).height()-c,$("#main_content").css("max-height","1px"),$("#startSelection").hide();
$("#waitingsPopup").css("height",d);"undefined"!=typeof a&&a&&0==b.newWaitingsCount&&closeWaitingsPopup()}}})}$("#header_waitings_bar a").on("click",function(a){$("#waitingsPopup").is(":visible")?closeWaitingsPopup():getWaitingsForPopup()});
function setWaitingsArrow(){var a=$("#showWaitingsButton").offset().left,b=$(window).width();a=b-a;var c=576<b?58:30;855<b&&991>b?($("#waitingsPopup").css("right","130px"),c=160):$("#waitingsPopup").css("right","30px");$("#waitingsPopup .arrowtop").css("right",Math.round(a-c));$("#waitingsPopup .arrowbottom").css("right",Math.round(a-c)+1)}
$("body").on("click",".changeWaitingStatusButton",function(a){var b=$(this).attr("data-waitingId");a=$(this).attr("data-status");ajax({url:"/cabinet/waitings/set-waiting-status",data:{waitingId:b,status:a},success:function(a){"success"==a.status&&(showNewWaitingsCount(a.waitingsCount),$("#waitingItemInPopup"+b).fadeTo("slow",.01,function(){$(this).hide()}),0==a.waitingsCount&&$(".noNewWaitingsMessage").removeClass("hidden"),("#waitings"==document.location.hash||/#schedule-visits\/list\/[0-9]+/.test(document.location.hash))&&
locationHashChanged(!1))}})});
$("body").on("click",".__waitingsPopupRemoveButton",function(a){var b=$(this).attr("data-waitingId");ajax({url:"/cabinet/waitings/set-waiting-status",data:{waitingId:b,status:status},success:function(a){"success"==a.status&&(showNewWaitingsCount(a.waitingsCount),$("#waitingItemInPopup"+b).fadeTo("slow",.01,function(){$(this).hide()}),0==a.waitingsCount&&$(".noNewWaitingsMessage").removeClass("hidden"),("#waitings"==document.location.hash||/#schedule-visits\/list\/[0-9]+/.test(document.location.hash))&&locationHashChanged(!1))}})});
;
window.onscroll=function(){renderPatientHeaderOnScroll()};function renderPatientHeaderOnScroll(){if("undefined"!=typeof $patientHeaderFixed&&$patientHeaderFixed&&currentClinicType==CLINIC_TYPE_PUBLIC){var a=991<$(window).width()?70:110;window.pageYOffset>a?$patientHeaderFixed.show():$patientHeaderFixed.hide()}}$(window).on("resize",function(){renderPatientHeaderOnWindowResize()});
function renderPatientHeaderOnWindowResize(){if("undefined"!=typeof $patientHeaderFixed&&$patientHeaderFixed){var a=$(window).width();991<a?$(".patientHeaderFixed").css("width",$("#main_content").width()-2):$(".patientHeaderFixed").css("width","100%");a=$(".patientHeader").width()-$(".bigScreenPatientButtons").width()-90-(686<a?50:20)-25;$(".patientHeaderImportantNote").css("max-width",a)}};
;
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,c,b){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var f=a[e];if(c.call(b,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,b){a!=Array.prototype&&a!=Object.prototype&&(a[c]=b.value)};$jscomp.getGlobal=function(a){a=["object"==typeof globalThis&&globalThis,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,a];for(var c=0;c<a.length;++c){var b=a[c];if(b&&b.Math==Math)return b}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,c,b,d){if(c){b=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in b||(b[e]={});b=b[e]}a=a[a.length-1];d=b[a];c=c(d);c!=d&&null!=c&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:c})}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,b){return $jscomp.findInternal(this,a,b).v}},"es6","es3");
$("body").on("click",".familyButton, .patientCardFamilyButton, .scheduleTooltipFamilyButton",function(a){a=$(this).attr("data-patientId");ajax({url:"/cabinet/families/get-form",data:{patientId:a},success:function(a){"undefined"!=typeof a.formHtml&&$("#familyModal").html(a.formHtml).modal("show")}})});$("body").on("click","#saveFamily",function(a){saveFamily(0)});
function saveFamily(a){var c=[];$(".existingFamilyMember").each(function(){var a=$(this).attr("data-patientId"),d=$(this).find(".role").val(),e=$(this).find(".is_payer:checked").length,f=$(this).hasClass("deletedFamilyMember")?1:0;c.push({role:d,is_payer:e,familyMemberPatientsId:a,deleted:f})});ajax({url:"/cabinet/families/save",data:{existingFamily:c,newMemberId:a,patientId:$("#familyModal .modal-body").attr("data-patientId")},success:function(b){"undefined"!=typeof b.formHtml&&(a?$("#familyModal").html(b.formHtml).modal("show"):
($("#familyModal").modal("hide"),1==b.patientHasFamily?$(".familyButton, .patientCardFamilyButton").addClass("patientHasFamilyButton"):$(".familyButton, .patientCardFamilyButton").removeClass("patientHasFamilyButton")))}})}$("body").on("click",".deleteFamilyMember",function(a){$(this).closest("tr").addClass("deletedFamilyMember");$("#familyTable .deletedFamilyMember").length==$("#familyTable .existingFamilyMember").length&&$("#familyTable").hide()});
$("body").on("change","#familyModalForm_newMember",function(a){a=$("#familyModalForm_newMember").val();saveFamily(a)});$("body").on("click",".newPatientCardFamilyButton",function(a){$("#patientForm").append("<input type='hidden' name='editFamilyAfterSave' value='1' />");$("#patientForm").submit()});
;
var fabric=fabric||{version:"2.0.0-rc.3"};"undefined"!=typeof exports&&(exports.fabric=fabric),"undefined"!=typeof document&&"undefined"!=typeof window?(fabric.document=document,fabric.window=window):(fabric.document=require("jsdom").jsdom(decodeURIComponent("%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3C%2Fhead%3E%3Cbody%3E%3C%2Fbody%3E%3C%2Fhtml%3E"),{features:{FetchExternalResources:["img"]}}),fabric.jsdomImplForWrapper=require("jsdom/lib/jsdom/living/generated/utils").implForWrapper,fabric.window=fabric.document.defaultView,DOMParser=require("xmldom").DOMParser),fabric.isTouchSupported="ontouchstart"in fabric.window,fabric.isLikelyNode="undefined"!=typeof Buffer&&"undefined"==typeof window,fabric.SHARED_ATTRIBUTES=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","instantiated_by_use"],fabric.DPI=96,fabric.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?)",fabric.fontPaths={},fabric.iMatrix=[1,0,0,1,0,0],fabric.canvasModule="canvas",fabric.perfLimitSizeTotal=2097152,fabric.maxCacheSideLimit=4096,fabric.minCacheSideLimit=256,fabric.charWidthsCache={},fabric.textureSize=2048,fabric.enableGLFiltering=!0,fabric.devicePixelRatio=fabric.window.devicePixelRatio||fabric.window.webkitDevicePixelRatio||fabric.window.mozDevicePixelRatio||1,fabric.browserShadowBlurConstant=1,fabric.initFilterBackend=function(){return fabric.enableGLFiltering&&fabric.isWebglSupported&&fabric.isWebglSupported(fabric.textureSize)?(console.log("max texture size: "+fabric.maxTextureSize),new fabric.WebglFilterBackend({tileSize:fabric.textureSize})):fabric.Canvas2dFilterBackend?new fabric.Canvas2dFilterBackend:void 0};"undefined"!=typeof document&&"undefined"!=typeof window&&(window.fabric=fabric);!function(){function e(e,t){if(this.__eventListeners[e]){var i=this.__eventListeners[e];t?i[i.indexOf(t)]=!1:fabric.util.array.fill(i,!1)}}function t(e,t){if(this.__eventListeners||(this.__eventListeners={}),1===arguments.length)for(var i in e)this.on(i,e[i]);else this.__eventListeners[e]||(this.__eventListeners[e]=[]),this.__eventListeners[e].push(t);return this}function i(t,i){if(this.__eventListeners){if(0===arguments.length)for(t in this.__eventListeners)e.call(this,t);else if(1===arguments.length&&"object"==typeof arguments[0])for(var n in t)e.call(this,n,t[n]);else e.call(this,t,i);return this}}function n(e,t){if(this.__eventListeners){var i=this.__eventListeners[e];if(i){for(var n=0,s=i.length;s>n;n++)i[n]&&i[n].call(this,t||{});return this.__eventListeners[e]=i.filter(function(e){return e!==!1}),this}}}fabric.Observable={observe:t,stopObserving:i,fire:n,on:t,off:i,trigger:n}}();fabric.Collection={_objects:[],add:function(){if(this._objects.push.apply(this._objects,arguments),this._onObjectAdded)for(var e=0,t=arguments.length;t>e;e++)this._onObjectAdded(arguments[e]);return this.renderOnAddRemove&&this.requestRenderAll(),this},insertAt:function(e,t,n){var i=this.getObjects();return n?i[t]=e:i.splice(t,0,e),this._onObjectAdded&&this._onObjectAdded(e),this.renderOnAddRemove&&this.requestRenderAll(),this},remove:function(){for(var e,t=this.getObjects(),n=!1,i=0,s=arguments.length;s>i;i++)e=t.indexOf(arguments[i]),-1!==e&&(n=!0,t.splice(e,1),this._onObjectRemoved&&this._onObjectRemoved(arguments[i]));return this.renderOnAddRemove&&n&&this.requestRenderAll(),this},forEachObject:function(e,t){for(var n=this.getObjects(),i=0,s=n.length;s>i;i++)e.call(t,n[i],i,n);return this},getObjects:function(e){return"undefined"==typeof e?this._objects:this._objects.filter(function(t){return t.type===e})},item:function(e){return this.getObjects()[e]},isEmpty:function(){return 0===this.getObjects().length},size:function(){return this.getObjects().length},contains:function(e){return this.getObjects().indexOf(e)>-1},complexity:function(){return this.getObjects().reduce(function(e,t){return e+=t.complexity?t.complexity():0},0)}};fabric.CommonMethods={_setOptions:function(t){for(var e in t)this.set(e,t[e])},_initGradient:function(t,e){!t||!t.colorStops||t instanceof fabric.Gradient||this.set(e,new fabric.Gradient(t))},_initPattern:function(t,e,n){!t||!t.source||t instanceof fabric.Pattern?n&&n():this.set(e,new fabric.Pattern(t,n))},_initClipping:function(t){if(t.clipTo&&"string"==typeof t.clipTo){var e=fabric.util.getFunctionBody(t.clipTo);"undefined"!=typeof e&&(this.clipTo=new Function("ctx",e))}},_setObject:function(t){for(var e in t)this._set(e,t[e])},set:function(t,e){return"object"==typeof t?this._setObject(t):"function"==typeof e&&"clipTo"!==t?this._set(t,e(this.get(t))):this._set(t,e),this},_set:function(t,e){this[t]=e},toggle:function(t){var e=this.get(t);return"boolean"==typeof e&&this.set(t,!e),this},get:function(t){return this[t]}};!function(e){var t=Math.sqrt,i=Math.atan2,n=Math.pow,r=Math.abs,a=Math.PI/180;fabric.util={removeFromArray:function(e,t){var i=e.indexOf(t);return-1!==i&&e.splice(i,1),e},getRandomInt:function(e,t){return Math.floor(Math.random()*(t-e+1))+e},degreesToRadians:function(e){return e*a},radiansToDegrees:function(e){return e/a},rotatePoint:function(e,t,i){e.subtractEquals(t);var n=fabric.util.rotateVector(e,i);return new fabric.Point(n.x,n.y).addEquals(t)},rotateVector:function(e,t){var i=Math.sin(t),n=Math.cos(t),r=e.x*n-e.y*i,a=e.x*i+e.y*n;return{x:r,y:a}},transformPoint:function(e,t,i){return i?new fabric.Point(t[0]*e.x+t[2]*e.y,t[1]*e.x+t[3]*e.y):new fabric.Point(t[0]*e.x+t[2]*e.y+t[4],t[1]*e.x+t[3]*e.y+t[5])},makeBoundingBoxFromPoints:function(e){var t=[e[0].x,e[1].x,e[2].x,e[3].x],i=fabric.util.array.min(t),n=fabric.util.array.max(t),r=n-i,a=[e[0].y,e[1].y,e[2].y,e[3].y],o=fabric.util.array.min(a),c=fabric.util.array.max(a),s=c-o;return{left:i,top:o,width:r,height:s}},invertTransform:function(e){var t=1/(e[0]*e[3]-e[1]*e[2]),i=[t*e[3],-t*e[1],-t*e[2],t*e[0]],n=fabric.util.transformPoint({x:e[4],y:e[5]},i,!0);return i[4]=-n.x,i[5]=-n.y,i},toFixed:function(e,t){return parseFloat(Number(e).toFixed(t))},parseUnit:function(e,t){var i=/\D{0,2}$/.exec(e),n=parseFloat(e);switch(t||(t=fabric.Text.DEFAULT_SVG_FONT_SIZE),i[0]){case"mm":return n*fabric.DPI/25.4;case"cm":return n*fabric.DPI/2.54;case"in":return n*fabric.DPI;case"pt":return n*fabric.DPI/72;case"pc":return n*fabric.DPI/72*12;case"em":return n*t;default:return n}},falseFunction:function(){return!1},getKlass:function(e,t){return e=fabric.util.string.camelize(e.charAt(0).toUpperCase()+e.slice(1)),fabric.util.resolveNamespace(t)[e]},getSvgAttributes:function(e){var t=["instantiated_by_use","style","id","class"];switch(e){case"linearGradient":t=t.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);break;case"radialGradient":t=t.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);break;case"stop":t=t.concat(["offset","stop-color","stop-opacity"])}return t},resolveNamespace:function(t){if(!t)return fabric;var i,n=t.split("."),r=n.length,a=e||fabric.window;for(i=0;r>i;++i)a=a[n[i]];return a},loadImage:function(e,t,i,n){if(!e)return void(t&&t.call(i,e));var r=fabric.util.createImage(),a=function(){t&&t.call(i,r),r=r.onload=r.onerror=null};r.onload=a,r.onerror=function(){fabric.log("Error loading "+r.src),t&&t.call(i,null,!0),r=r.onload=r.onerror=null},0!==e.indexOf("data")&&n&&(r.crossOrigin=n),"data:image/svg"===e.substring(0,14)&&(r.onload=null,fabric.util.loadImageInDom(r,a)),r.src=e},loadImageInDom:function(e,t){var i=fabric.document.createElement("div");i.style.width=i.style.height="1px",i.style.left=i.style.top="-100%",i.style.position="absolute",i.appendChild(e),fabric.document.querySelector("body").appendChild(i),e.onload=function(){t(),i.parentNode.removeChild(i),i=null}},enlivenObjects:function(e,t,i,n){function r(){++o===c&&t&&t(a)}e=e||[];var a=[],o=0,c=e.length;return c?void e.forEach(function(e,t){if(!e||!e.type)return void r();var o=fabric.util.getKlass(e.type,i);o.fromObject(e,function(i,o){o||(a[t]=i),n&&n(e,i,o),r()})}):void(t&&t(a))},enlivenPatterns:function(e,t){function i(){++r===a&&t&&t(n)}e=e||[];var n=[],r=0,a=e.length;return a?void e.forEach(function(e,t){e&&e.source?new fabric.Pattern(e,function(e){n[t]=e,i()}):(n[t]=e,i())}):void(t&&t(n))},groupSVGElements:function(e,t,i){var n;return 1===e.length?e[0]:(t&&(t.width&&t.height?t.centerPoint={x:t.width/2,y:t.height/2}:(delete t.width,delete t.height)),n=new fabric.Group(e,t),"undefined"!=typeof i&&(n.sourcePath=i),n)},populateWithProperties:function(e,t,i){if(i&&"[object Array]"===Object.prototype.toString.call(i))for(var n=0,r=i.length;r>n;n++)i[n]in e&&(t[i[n]]=e[i[n]])},drawDashedLine:function(e,n,r,a,o,c){var s=a-n,f=o-r,u=t(s*s+f*f),l=i(f,s),d=c.length,h=0,b=!0;for(e.save(),e.translate(n,r),e.moveTo(0,0),e.rotate(l),n=0;u>n;)n+=c[h++%d],n>u&&(n=u),e[b?"lineTo":"moveTo"](n,0),b=!b;e.restore()},createCanvasElement:function(){return fabric.document.createElement("canvas")},createImage:function(){return fabric.document.createElement("img")},clipContext:function(e,t){t.save(),t.beginPath(),e.clipTo(t),t.clip()},multiplyTransformMatrices:function(e,t,i){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],i?0:e[0]*t[4]+e[2]*t[5]+e[4],i?0:e[1]*t[4]+e[3]*t[5]+e[5]]},qrDecompose:function(e){var r=i(e[1],e[0]),o=n(e[0],2)+n(e[1],2),c=t(o),s=(e[0]*e[3]-e[2]*e[1])/c,f=i(e[0]*e[2]+e[1]*e[3],o);return{angle:r/a,scaleX:c,scaleY:s,skewX:f/a,skewY:0,translateX:e[4],translateY:e[5]}},customTransformMatrix:function(e,t,i){var n=[1,0,r(Math.tan(i*a)),1],o=[r(e),0,0,r(t)];return fabric.util.multiplyTransformMatrices(o,n,!0)},resetObjectTransform:function(e){e.scaleX=1,e.scaleY=1,e.skewX=0,e.skewY=0,e.flipX=!1,e.flipY=!1,e.rotate(0)},getFunctionBody:function(e){return(String(e).match(/function[^{]*\{([\s\S]*)\}/)||{})[1]},isTransparent:function(e,t,i,n){n>0&&(t>n?t-=n:t=0,i>n?i-=n:i=0);var r,a,o=!0,c=e.getImageData(t,i,2*n||1,2*n||1),s=c.data.length;for(r=3;s>r&&(a=c.data[r],o=0>=a,o!==!1);r+=4);return c=null,o},parsePreserveAspectRatioAttribute:function(e){var t,i="meet",n="Mid",r="Mid",a=e.split(" ");return a&&a.length&&(i=a.pop(),"meet"!==i&&"slice"!==i?(t=i,i="meet"):a.length&&(t=a.pop())),n="none"!==t?t.slice(1,4):"none",r="none"!==t?t.slice(5,8):"none",{meetOrSlice:i,alignX:n,alignY:r}},clearFabricFontCache:function(e){e?fabric.charWidthsCache[e]&&delete fabric.charWidthsCache[e]:fabric.charWidthsCache={}},limitDimsByArea:function(e,t){var i=Math.sqrt(t*e),n=Math.floor(t/i);return{x:Math.floor(i),y:n}},capValue:function(e,t,i){return Math.max(e,Math.min(t,i))},findScaleToFit:function(e,t){return Math.min(t.width/e.width,t.height/e.height)},findScaleToCover:function(e,t){return Math.max(t.width/e.width,t.height/e.height)}}}("undefined"!=typeof exports?exports:this);!function(){function t(t,r,a,o,s,f,u){var l=c.call(arguments);if(i[l])return i[l];var h=Math.PI,d=u*h/180,b=Math.sin(d),p=Math.cos(d),m=0,v=0;a=Math.abs(a),o=Math.abs(o);var g=-p*t*.5-b*r*.5,y=-p*r*.5+b*t*.5,x=a*a,w=o*o,_=y*y,M=g*g,O=x*w-x*_-w*M,j=0;if(0>O){var P=Math.sqrt(1-O/(x*w));a*=P,o*=P}else j=(s===f?-1:1)*Math.sqrt(O/(x*_+w*M));var T=j*a*y/o,C=-j*o*g/a,F=p*T-b*C+.5*t,S=b*T+p*C+.5*r,E=n(1,0,(g-T)/a,(y-C)/o),A=n((g-T)/a,(y-C)/o,(-g-T)/a,(-y-C)/o);0===f&&A>0?A-=2*h:1===f&&0>A&&(A+=2*h);for(var I=Math.ceil(Math.abs(A/h*2)),D=[],k=A/I,L=8/3*Math.sin(k/4)*Math.sin(k/4)/Math.sin(k/2),R=E+k,q=0;I>q;q++)D[q]=e(E,R,p,b,a,o,F,S,L,m,v),m=D[q][4],v=D[q][5],E=R,R+=k;return i[l]=D,D}function e(t,e,n,r,i,o,s,f,u,l,h){var d=c.call(arguments);if(a[d])return a[d];var b=Math.cos(t),p=Math.sin(t),m=Math.cos(e),v=Math.sin(e),g=n*i*m-r*o*v+s,y=r*i*m+n*o*v+f,x=l+u*(-n*i*p-r*o*b),w=h+u*(-r*i*p+n*o*b),_=g+u*(n*i*v+r*o*m),M=y+u*(r*i*v-n*o*m);return a[d]=[x,w,_,M,g,y],a[d]}function n(t,e,n,r){var i=Math.atan2(e,t),a=Math.atan2(r,n);return a>=i?a-i:2*Math.PI-(i-a)}function r(t,e,n,r,i,a,s,f){var u=c.call(arguments);if(o[u])return o[u];var l,h,d,b,p,m,v,g,y=Math.sqrt,x=Math.min,w=Math.max,_=Math.abs,M=[],O=[[],[]];h=6*t-12*n+6*i,l=-3*t+9*n-9*i+3*s,d=3*n-3*t;for(var j=0;2>j;++j)if(j>0&&(h=6*e-12*r+6*a,l=-3*e+9*r-9*a+3*f,d=3*r-3*e),_(l)<1e-12){if(_(h)<1e-12)continue;b=-d/h,b>0&&1>b&&M.push(b)}else v=h*h-4*d*l,0>v||(g=y(v),p=(-h+g)/(2*l),p>0&&1>p&&M.push(p),m=(-h-g)/(2*l),m>0&&1>m&&M.push(m));for(var P,T,C,F=M.length,S=F;F--;)b=M[F],C=1-b,P=C*C*C*t+3*C*C*b*n+3*C*b*b*i+b*b*b*s,O[0][F]=P,T=C*C*C*e+3*C*C*b*r+3*C*b*b*a+b*b*b*f,O[1][F]=T;O[0][S]=t,O[1][S]=e,O[0][S+1]=s,O[1][S+1]=f;var E=[{x:x.apply(null,O[0]),y:x.apply(null,O[1])},{x:w.apply(null,O[0]),y:w.apply(null,O[1])}];return o[u]=E,E}var i={},a={},o={},c=Array.prototype.join;fabric.util.drawArc=function(e,n,r,i){for(var a=i[0],o=i[1],c=i[2],s=i[3],f=i[4],u=i[5],l=i[6],h=[[],[],[],[]],d=t(u-n,l-r,a,o,s,f,c),b=0,p=d.length;p>b;b++)h[b][0]=d[b][0]+n,h[b][1]=d[b][1]+r,h[b][2]=d[b][2]+n,h[b][3]=d[b][3]+r,h[b][4]=d[b][4]+n,h[b][5]=d[b][5]+r,e.bezierCurveTo.apply(e,h[b])},fabric.util.getBoundsOfArc=function(e,n,i,a,o,c,s,f,u){for(var l,h=0,d=0,b=[],p=t(f-e,u-n,i,a,c,s,o),m=0,v=p.length;v>m;m++)l=r(h,d,p[m][0],p[m][1],p[m][2],p[m][3],p[m][4],p[m][5]),b.push({x:l[0].x+e,y:l[0].y+n}),b.push({x:l[1].x+e,y:l[1].y+n}),h=p[m][4],d=p[m][5];return b},fabric.util.getBoundsOfCurve=r}();!function(){function t(t,e){for(var i=a.call(arguments,2),n=[],r=0,o=t.length;o>r;r++)n[r]=i.length?t[r][e].apply(t[r],i):t[r][e].call(t[r]);return n}function e(t,e){return r(t,e,function(t,e){return t>=e})}function i(t,e){return r(t,e,function(t,e){return e>t})}function n(t,e){for(var i=t.length;i--;)t[i]=e;return t}function r(t,e,i){if(t&&0!==t.length){var n=t.length-1,r=e?t[n][e]:t[n];if(e)for(;n--;)i(t[n][e],r)&&(r=t[n][e]);else for(;n--;)i(t[n],r)&&(r=t[n]);return r}}var a=Array.prototype.slice;fabric.util.array={fill:n,invoke:t,min:i,max:e}}();!function(){function t(e,n,r){if(r)if(!fabric.isLikelyNode&&n instanceof Element)e=n;else if(n instanceof Array){e=[];for(var i=0,a=n.length;a>i;i++)e[i]=t({},n[i],r)}else if(n&&"object"==typeof n)for(var o in n)n.hasOwnProperty(o)&&(e[o]=t({},n[o],r));else e=n;else for(var o in n)e[o]=n[o];return e}function e(e,n){return t({},e,n)}fabric.util.object={extend:t,clone:e},fabric.util.object.extend(fabric.util,fabric.Observable)}();!function(){function t(t){return t.replace(/-+(.)?/g,function(t,e){return e?e.toUpperCase():""})}function e(t,e){return t.charAt(0).toUpperCase()+(e?t.slice(1):t.slice(1).toLowerCase())}function r(t){return t.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function n(t){var e,r=0,n=[];for(r=0,e;r<t.length;r++)(e=i(t,r))!==!1&&n.push(e);return n}function i(t,e){var r=t.charCodeAt(e);if(isNaN(r))return"";if(55296>r||r>57343)return t.charAt(e);if(r>=55296&&56319>=r){if(t.length<=e+1)throw"High surrogate without following low surrogate";var n=t.charCodeAt(e+1);if(56320>n||n>57343)throw"High surrogate without following low surrogate";return t.charAt(e)+t.charAt(e+1)}if(0===e)throw"Low surrogate without preceding high surrogate";var i=t.charCodeAt(e-1);if(55296>i||i>56319)throw"Low surrogate without preceding high surrogate";return!1}fabric.util.string={camelize:t,capitalize:e,escapeXml:r,graphemeSplit:n}}();!function(){function t(){}function e(t){for(var e=null,r=this;r.constructor.superclass;){var i=r.constructor.superclass.prototype[t];if(r[t]!==i){e=i;break}r=r.constructor.superclass.prototype}return e?arguments.length>1?e.apply(this,n.call(arguments,1)):e.call(this):console.log("tried to callSuper "+t+", method not found in prototype chain",this)}function r(){function r(){this.initialize.apply(this,arguments)}var a=null,c=n.call(arguments,0);"function"==typeof c[0]&&(a=c.shift()),r.superclass=a,r.subclasses=[],a&&(t.prototype=a.prototype,r.prototype=new t,a.subclasses.push(r));for(var u=0,s=c.length;s>u;u++)o(r,c[u],a);return r.prototype.initialize||(r.prototype.initialize=i),r.prototype.constructor=r,r.prototype.callSuper=e,r}var n=Array.prototype.slice,i=function(){},a=function(){for(var t in{toString:1})if("toString"===t)return!1;return!0}(),o=function(t,e,r){for(var n in e)t.prototype[n]=n in t.prototype&&"function"==typeof t.prototype[n]&&(e[n]+"").indexOf("callSuper")>-1?function(t){return function(){var n=this.constructor.superclass;this.constructor.superclass=r;var i=e[t].apply(this,arguments);return this.constructor.superclass=n,"initialize"!==t?i:void 0}}(n):e[n],a&&(e.toString!==Object.prototype.toString&&(t.prototype.toString=e.toString),e.valueOf!==Object.prototype.valueOf&&(t.prototype.valueOf=e.valueOf))};fabric.util.createClass=r}();!function(){function t(t){var e,n,r=Array.prototype.slice.call(arguments,1),i=r.length;for(n=0;i>n;n++)if(e=typeof t[r[n]],!/^(?:function|object|unknown)$/.test(e))return!1;return!0}function e(t,e){return{handler:e,wrappedHandler:n(t,e)}}function n(t,e){return function(n){e.call(o(t),n||fabric.window.event)}}function r(t,e){return function(n){if(p[t]&&p[t][e])for(var r=p[t][e],i=0,a=r.length;a>i;i++)r[i].call(this,n||fabric.window.event)}}function i(t){t||(t=fabric.window.event);var e=t.target||(typeof t.srcElement!==u?t.srcElement:null),n=fabric.util.getScrollLeftTop(e);return{x:v(t)+n.left,y:g(t)+n.top}}function a(t,e,n){var r="touchend"===t.type?"changedTouches":"touches";return t[r]&&t[r][0]?t[r][0][e]-(t[r][0][e]-t[r][0][n])||t[n]:t[n]}var o,c,u="unknown",f=function(){var t=0;return function(e){return e.__uniqueID||(e.__uniqueID="uniqueID__"+t++)}}();!function(){var t={};o=function(e){return t[e]},c=function(e,n){t[e]=n}}();var s,l,h=t(fabric.document.documentElement,"addEventListener","removeEventListener")&&t(fabric.window,"addEventListener","removeEventListener"),d=t(fabric.document.documentElement,"attachEvent","detachEvent")&&t(fabric.window,"attachEvent","detachEvent"),b={},p={};h?(s=function(t,e,n,r){t&&t.addEventListener(e,n,d?!1:r)},l=function(t,e,n,r){t&&t.removeEventListener(e,n,d?!1:r)}):d?(s=function(t,n,r){if(t){var i=f(t);c(i,t),b[i]||(b[i]={}),b[i][n]||(b[i][n]=[]);var a=e(i,r);b[i][n].push(a),t.attachEvent("on"+n,a.wrappedHandler)}},l=function(t,e,n){if(t){var r,i=f(t);if(b[i]&&b[i][e])for(var a=0,o=b[i][e].length;o>a;a++)r=b[i][e][a],r&&r.handler===n&&(t.detachEvent("on"+e,r.wrappedHandler),b[i][e][a]=null)}}):(s=function(t,e,n){if(t){var i=f(t);if(p[i]||(p[i]={}),!p[i][e]){p[i][e]=[];var a=t["on"+e];a&&p[i][e].push(a),t["on"+e]=r(i,e)}p[i][e].push(n)}},l=function(t,e,n){if(t){var r=f(t);if(p[r]&&p[r][e])for(var i=p[r][e],a=0,o=i.length;o>a;a++)i[a]===n&&i.splice(a,1)}}),fabric.util.addListener=s,fabric.util.removeListener=l;var v=function(t){return t.clientX},g=function(t){return t.clientY};fabric.isTouchSupported&&(v=function(t){return a(t,"pageX","clientX")},g=function(t){return a(t,"pageY","clientY")}),fabric.util.getPointer=i}();!function(){function t(t,e){var n=t.style;if(!n)return t;if("string"==typeof e)return t.style.cssText+=";"+e,e.indexOf("opacity")>-1?a(t,e.match(/opacity:\s*(\d?\.?\d*)/)[1]):t;for(var r in e)if("opacity"===r)a(t,e[r]);else{var i="float"===r||"cssFloat"===r?"undefined"==typeof n.styleFloat?"cssFloat":"styleFloat":r;n[i]=e[r]}return t}var e=fabric.document.createElement("div"),n="string"==typeof e.style.opacity,r="string"==typeof e.style.filter,i=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,a=function(t){return t};n?a=function(t,e){return t.style.opacity=e,t}:r&&(a=function(t,e){var n=t.style;return t.currentStyle&&!t.currentStyle.hasLayout&&(n.zoom=1),i.test(n.filter)?(e=e>=.9999?"":"alpha(opacity="+100*e+")",n.filter=n.filter.replace(i,e)):n.filter+=" alpha(opacity="+100*e+")",t}),fabric.util.setStyle=t}();!function(){function t(t){return"string"==typeof t?fabric.document.getElementById(t):t}function e(t,e){var n=fabric.document.createElement(t);for(var r in e)"class"===r?n.className=e[r]:"for"===r?n.htmlFor=e[r]:n.setAttribute(r,e[r]);return n}function n(t,e){t&&-1===(" "+t.className+" ").indexOf(" "+e+" ")&&(t.className+=(t.className?" ":"")+e)}function r(t,n,r){return"string"==typeof n&&(n=e(n,r)),t.parentNode&&t.parentNode.replaceChild(n,t),n.appendChild(t),n}function i(t){for(var e=0,n=0,r=fabric.document.documentElement,i=fabric.document.body||{scrollLeft:0,scrollTop:0};t&&(t.parentNode||t.host)&&(t=t.parentNode||t.host,t===fabric.document?(e=i.scrollLeft||r.scrollLeft||0,n=i.scrollTop||r.scrollTop||0):(e+=t.scrollLeft||0,n+=t.scrollTop||0),1!==t.nodeType||"fixed"!==fabric.util.getElementStyle(t,"position")););return{left:e,top:n}}function a(t){var e,n,r=t&&t.ownerDocument,a={left:0,top:0},o={left:0,top:0},c={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!r)return o;for(var u in c)o[c[u]]+=parseInt(f(t,u),10)||0;return e=r.documentElement,"undefined"!=typeof t.getBoundingClientRect&&(a=t.getBoundingClientRect()),n=i(t),{left:a.left+n.left-(e.clientLeft||0)+o.left,top:a.top+n.top-(e.clientTop||0)+o.top}}var o,c=Array.prototype.slice,u=function(t){return c.call(t,0)};try{o=u(fabric.document.childNodes)instanceof Array}catch(s){}o||(u=function(t){for(var e=new Array(t.length),n=t.length;n--;)e[n]=t[n];return e});var f;f=fabric.document.defaultView&&fabric.document.defaultView.getComputedStyle?function(t,e){var n=fabric.document.defaultView.getComputedStyle(t,null);return n?n[e]:void 0}:function(t,e){var n=t.style[e];return!n&&t.currentStyle&&(n=t.currentStyle[e]),n},function(){function t(t){return"undefined"!=typeof t.onselectstart&&(t.onselectstart=fabric.util.falseFunction),r?t.style[r]="none":"string"==typeof t.unselectable&&(t.unselectable="on"),t}function e(t){return"undefined"!=typeof t.onselectstart&&(t.onselectstart=null),r?t.style[r]="":"string"==typeof t.unselectable&&(t.unselectable=""),t}var n=fabric.document.documentElement.style,r="userSelect"in n?"userSelect":"MozUserSelect"in n?"MozUserSelect":"WebkitUserSelect"in n?"WebkitUserSelect":"KhtmlUserSelect"in n?"KhtmlUserSelect":"";fabric.util.makeElementUnselectable=t,fabric.util.makeElementSelectable=e}(),function(){function t(t,e){var n=fabric.document.getElementsByTagName("head")[0],r=fabric.document.createElement("script"),i=!0;r.onload=r.onreadystatechange=function(t){if(i){if("string"==typeof this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState)return;i=!1,e(t||fabric.window.event),r=r.onload=r.onreadystatechange=null}},r.src=t,n.appendChild(r)}fabric.util.getScript=t}(),fabric.util.getById=t,fabric.util.toArray=u,fabric.util.makeElement=e,fabric.util.addClass=n,fabric.util.wrapElement=r,fabric.util.getScrollLeftTop=i,fabric.util.getElementOffset=a,fabric.util.getElementStyle=f}();!function(){function t(t,e){return t+(/\?/.test(t)?"&":"?")+e}function e(){}function n(n,i){i||(i={});var a=i.method?i.method.toUpperCase():"GET",o=i.onComplete||function(){},c=r(),u=i.body||i.parameters;return c.onreadystatechange=function(){4===c.readyState&&(o(c),c.onreadystatechange=e)},"GET"===a&&(u=null,"string"==typeof i.parameters&&(n=t(n,i.parameters))),c.open(a,n,!0),("POST"===a||"PUT"===a)&&c.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),c.send(u),c}var r=function(){for(var t=[function(){return new ActiveXObject("Microsoft.XMLHTTP")},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml2.XMLHTTP.3.0")},function(){return new XMLHttpRequest}],e=t.length;e--;)try{var n=t[e]();if(n)return t[e]}catch(r){}}();fabric.util.request=n}();fabric.log=function(){},fabric.warn=function(){},"undefined"!=typeof console&&["log","warn"].forEach(function(t){"undefined"!=typeof console[t]&&"function"==typeof console[t].apply&&(fabric[t]=function(){return console[t].apply(console,arguments)})});!function(){function t(){return!1}function e(e){n(function(r){e||(e={});var i,a=r||+new Date,o=e.duration||500,c=a+o,u=e.onChange||t,f=e.abort||t,s=e.onComplete||t,l=e.easing||function(t,e,n,r){return-n*Math.cos(t/r*(Math.PI/2))+n+e},d="startValue"in e?e.startValue:0,h="endValue"in e?e.endValue:100,p=e.byValue||h-d;e.onStart&&e.onStart(),function b(t){if(f())return void s(h,1,1);i=t||+new Date;var r=i>c?o:i-a,m=r/o,g=l(r,d,p,o),v=Math.abs((g-d)/p);return u(g,v,m),i>c?void(e.onComplete&&e.onComplete()):void n(b)}(a)})}function n(){return i.apply(fabric.window,arguments)}function r(){return a.apply(fabric.window,arguments)}var i=fabric.window.requestAnimationFrame||fabric.window.webkitRequestAnimationFrame||fabric.window.mozRequestAnimationFrame||fabric.window.oRequestAnimationFrame||fabric.window.msRequestAnimationFrame||function(t){return fabric.window.setTimeout(t,1e3/60)},a=fabric.window.cancelAnimationFrame||fabric.window.clearTimeout;fabric.util.animate=e,fabric.util.requestAnimFrame=n,fabric.util.cancelAnimFrame=r}();!function(){function t(t,e,n){var r="rgba("+parseInt(t[0]+n*(e[0]-t[0]),10)+","+parseInt(t[1]+n*(e[1]-t[1]),10)+","+parseInt(t[2]+n*(e[2]-t[2]),10);return r+=","+(t&&e?parseFloat(t[3]+n*(e[3]-t[3])):1),r+=")"}function e(e,n,r,i){var a=new fabric.Color(e).getSource(),o=new fabric.Color(n).getSource();i=i||{},fabric.util.animate(fabric.util.object.extend(i,{duration:r||500,startValue:a,endValue:o,byValue:o,easing:function(e,n,r,a){var o=i.colorEasing?i.colorEasing(e,a):1-Math.cos(e/a*(Math.PI/2));return t(n,r,o)}}))}fabric.util.animateColor=e}();!function(){function t(t,e,n,r){return t<Math.abs(e)?(t=e,r=n/4):r=0===e&&0===t?n/(2*Math.PI)*Math.asin(1):n/(2*Math.PI)*Math.asin(e/t),{a:t,c:e,p:n,s:r}}function e(t,e,n){return t.a*Math.pow(2,10*(e-=1))*Math.sin(2*(e*n-t.s)*Math.PI/t.p)}function n(t,e,n,r){return n*((t=t/r-1)*t*t+1)+e}function r(t,e,n,r){return t/=r/2,1>t?n/2*t*t*t+e:n/2*((t-=2)*t*t+2)+e}function i(t,e,n,r){return n*(t/=r)*t*t*t+e}function a(t,e,n,r){return-n*((t=t/r-1)*t*t*t-1)+e}function o(t,e,n,r){return t/=r/2,1>t?n/2*t*t*t*t+e:-n/2*((t-=2)*t*t*t-2)+e}function c(t,e,n,r){return n*(t/=r)*t*t*t*t+e}function u(t,e,n,r){return n*((t=t/r-1)*t*t*t*t+1)+e}function f(t,e,n,r){return t/=r/2,1>t?n/2*t*t*t*t*t+e:n/2*((t-=2)*t*t*t*t+2)+e}function s(t,e,n,r){return-n*Math.cos(t/r*(Math.PI/2))+n+e}function l(t,e,n,r){return n*Math.sin(t/r*(Math.PI/2))+e}function d(t,e,n,r){return-n/2*(Math.cos(Math.PI*t/r)-1)+e}function p(t,e,n,r){return 0===t?e:n*Math.pow(2,10*(t/r-1))+e}function h(t,e,n,r){return t===r?e+n:n*(-Math.pow(2,-10*t/r)+1)+e}function b(t,e,n,r){return 0===t?e:t===r?e+n:(t/=r/2,1>t?n/2*Math.pow(2,10*(t-1))+e:n/2*(-Math.pow(2,-10*--t)+2)+e)}function m(t,e,n,r){return-n*(Math.sqrt(1-(t/=r)*t)-1)+e}function v(t,e,n,r){return n*Math.sqrt(1-(t=t/r-1)*t)+e}function g(t,e,n,r){return t/=r/2,1>t?-n/2*(Math.sqrt(1-t*t)-1)+e:n/2*(Math.sqrt(1-(t-=2)*t)+1)+e}function y(n,r,i,a){var o=1.70158,c=0,u=i;if(0===n)return r;if(n/=a,1===n)return r+i;c||(c=.3*a);var f=t(u,i,c,o);return-e(f,n,a)+r}function w(e,n,r,i){var a=1.70158,o=0,c=r;if(0===e)return n;if(e/=i,1===e)return n+r;o||(o=.3*i);var u=t(c,r,o,a);return u.a*Math.pow(2,-10*e)*Math.sin(2*(e*i-u.s)*Math.PI/u.p)+u.c+n}function M(n,r,i,a){var o=1.70158,c=0,u=i;if(0===n)return r;if(n/=a/2,2===n)return r+i;c||(c=.3*a*1.5);var f=t(u,i,c,o);return 1>n?-.5*e(f,n,a)+r:f.a*Math.pow(2,-10*(n-=1))*Math.sin(2*(n*a-f.s)*Math.PI/f.p)*.5+f.c+r}function x(t,e,n,r,i){return void 0===i&&(i=1.70158),n*(t/=r)*t*((i+1)*t-i)+e}function O(t,e,n,r,i){return void 0===i&&(i=1.70158),n*((t=t/r-1)*t*((i+1)*t+i)+1)+e}function S(t,e,n,r,i){return void 0===i&&(i=1.70158),t/=r/2,1>t?n/2*t*t*(((i*=1.525)+1)*t-i)+e:n/2*((t-=2)*t*(((i*=1.525)+1)*t+i)+2)+e}function E(t,e,n,r){return n-C(r-t,0,n,r)+e}function C(t,e,n,r){return(t/=r)<1/2.75?7.5625*n*t*t+e:2/2.75>t?n*(7.5625*(t-=1.5/2.75)*t+.75)+e:2.5/2.75>t?n*(7.5625*(t-=2.25/2.75)*t+.9375)+e:n*(7.5625*(t-=2.625/2.75)*t+.984375)+e}function I(t,e,n,r){return r/2>t?.5*E(2*t,0,n,r)+e:.5*C(2*t-r,0,n,r)+.5*n+e}fabric.util.ease={easeInQuad:function(t,e,n,r){return n*(t/=r)*t+e},easeOutQuad:function(t,e,n,r){return-n*(t/=r)*(t-2)+e},easeInOutQuad:function(t,e,n,r){return t/=r/2,1>t?n/2*t*t+e:-n/2*(--t*(t-2)-1)+e},easeInCubic:function(t,e,n,r){return n*(t/=r)*t*t+e},easeOutCubic:n,easeInOutCubic:r,easeInQuart:i,easeOutQuart:a,easeInOutQuart:o,easeInQuint:c,easeOutQuint:u,easeInOutQuint:f,easeInSine:s,easeOutSine:l,easeInOutSine:d,easeInExpo:p,easeOutExpo:h,easeInOutExpo:b,easeInCirc:m,easeOutCirc:v,easeInOutCirc:g,easeInElastic:y,easeOutElastic:w,easeInOutElastic:M,easeInBack:x,easeOutBack:O,easeInOutBack:S,easeInBounce:E,easeOutBounce:C,easeInOutBounce:I}}();!function(t){"use strict";function e(t){return t in O?O[t]:t}function n(t,e,n,r){var i,a="[object Array]"===Object.prototype.toString.call(e);if("fill"!==t&&"stroke"!==t||"none"!==e)if("strokeDashArray"===t)e="none"===e?null:e.replace(/,/g," ").split(/\s+/).map(function(t){return parseFloat(t)});else if("transformMatrix"===t)e=n&&n.transformMatrix?w(n.transformMatrix,g.parseTransformAttribute(e)):g.parseTransformAttribute(e);else if("visible"===t)e="none"!==e&&"hidden"!==e,n&&n.visible===!1&&(e=!1);else if("opacity"===t)e=parseFloat(e),n&&"undefined"!=typeof n.opacity&&(e*=n.opacity);else if("textAnchor"===t)e="start"===e?"left":"end"===e?"right":"center";else if("paintFirst"===t){var o=e.indexOf("fill"),s=e.indexOf("stroke"),e="fill";o>-1&&s>-1&&o>s?e="stroke":-1===o&&s>-1&&(e="stroke")}else i=a?e.map(x):x(e,r);else e="";return!a&&isNaN(i)?e:i}function r(t){return new RegExp("^("+t.join("|")+")\\b","i")}function i(t){for(var e in P)if("undefined"!=typeof t[P[e]]&&""!==t[e]){if("undefined"==typeof t[e]){if(!g.Object.prototype[e])continue;t[e]=g.Object.prototype[e]}if(0!==t[e].indexOf("url(")){var n=new g.Color(t[e]);t[e]=n.setAlpha(v(n.getAlpha()*t[P[e]],2)).toRgba()}}return t}function a(t,e){var n,r,i,a,o=[];for(i=0,a=e.length;a>i;i++)n=e[i],r=t.getElementsByTagName(n),o=o.concat(Array.prototype.slice.call(r));return o}function o(t,e){var n,r;t.replace(/;\s*$/,"").split(";").forEach(function(t){var i=t.split(":");n=i[0].trim().toLowerCase(),r=i[1].trim(),e[n]=r})}function s(t,e){var n,r;for(var i in t)"undefined"!=typeof t[i]&&(n=i.toLowerCase(),r=t[i],e[n]=r)}function c(t,e){var n={};for(var r in g.cssRules[e])if(u(t,r.split(" ")))for(var i in g.cssRules[e][r])n[i]=g.cssRules[e][r][i];return n}function u(t,e){var n,r=!0;return n=l(t,e.pop()),n&&e.length&&(r=f(t,e)),n&&r&&0===e.length}function f(t,e){for(var n,r=!0;t.parentNode&&1===t.parentNode.nodeType&&e.length;)r&&(n=e.pop()),t=t.parentNode,r=l(t,n);return 0===e.length}function l(t,e){var n,r,i=t.nodeName,a=t.getAttribute("class"),o=t.getAttribute("id");if(n=new RegExp("^"+i,"i"),e=e.replace(n,""),o&&e.length&&(n=new RegExp("#"+o+"(?![a-zA-Z\\-]+)","i"),e=e.replace(n,"")),a&&e.length)for(a=a.split(" "),r=a.length;r--;)n=new RegExp("\\."+a[r]+"(?![a-zA-Z\\-]+)","i"),e=e.replace(n,"");return 0===e.length}function p(t,e){var n;if(t.getElementById&&(n=t.getElementById(e)),n)return n;var r,i,a,o=t.getElementsByTagName("*");for(i=0,a=o.length;a>i;i++)if(r=o[i],e===r.getAttribute("id"))return r}function d(t){for(var e=a(t,["use","svg:use"]),n=0;e.length&&n<e.length;){var r,i,o,s,c,u=e[n],f=u.getAttribute("xlink:href").substr(1),l=u.getAttribute("x")||0,d=u.getAttribute("y")||0,m=p(t,f).cloneNode(!0),g=(m.getAttribute("transform")||"")+" translate("+l+", "+d+")",y=e.length;if(h(m),/^svg$/i.test(m.nodeName)){var b=m.ownerDocument.createElement("g");for(o=0,s=m.attributes,c=s.length;c>o;o++)i=s.item(o),b.setAttribute(i.nodeName,i.nodeValue);for(;m.firstChild;)b.appendChild(m.firstChild);m=b}for(o=0,s=u.attributes,c=s.length;c>o;o++)i=s.item(o),"x"!==i.nodeName&&"y"!==i.nodeName&&"xlink:href"!==i.nodeName&&("transform"===i.nodeName?g=i.nodeValue+" "+g:m.setAttribute(i.nodeName,i.nodeValue));m.setAttribute("transform",g),m.setAttribute("instantiated_by_use","1"),m.removeAttribute("id"),r=u.parentNode,r.replaceChild(m,u),e.length===y&&n++}}function h(t){var e,n,r,i,a=t.getAttribute("viewBox"),o=1,s=1,c=0,u=0,f=t.getAttribute("width"),l=t.getAttribute("height"),p=t.getAttribute("x")||0,d=t.getAttribute("y")||0,h=t.getAttribute("preserveAspectRatio")||"",m=!a||!g.svgViewBoxElementsRegEx.test(t.nodeName)||!(a=a.match(C)),y=!f||!l||"100%"===f||"100%"===l,b=m&&y,v={},w="";if(v.width=0,v.height=0,v.toBeParsed=b,b)return v;if(m)return v.width=x(f),v.height=x(l),v;if(c=-parseFloat(a[1]),u=-parseFloat(a[2]),e=parseFloat(a[3]),n=parseFloat(a[4]),y?(v.width=e,v.height=n):(v.width=x(f),v.height=x(l),o=v.width/e,s=v.height/n),h=g.util.parsePreserveAspectRatioAttribute(h),"none"!==h.alignX&&(s=o=o>s?s:o),1===o&&1===s&&0===c&&0===u&&0===p&&0===d)return v;if((p||d)&&(w=" translate("+x(p)+" "+x(d)+") "),r=w+" matrix("+o+" 0 0 "+s+" "+c*o+" "+u*s+") ","svg"===t.nodeName){for(i=t.ownerDocument.createElement("g");t.firstChild;)i.appendChild(t.firstChild);t.appendChild(i)}else i=t,r=i.getAttribute("transform")+r;return i.setAttribute("transform",r),v}function m(t,e){for(;t&&(t=t.parentNode);)if(t.nodeName&&e.test(t.nodeName.replace("svg:",""))&&!t.getAttribute("instantiated_by_use"))return!0;return!1}var g=t.fabric||(t.fabric={}),y=g.util.object.extend,b=g.util.object.clone,v=g.util.toFixed,x=g.util.parseUnit,w=g.util.multiplyTransformMatrices,M=["path","circle","polygon","polyline","ellipse","rect","line","image","text","linearGradient","radialGradient","stop"],E=["symbol","image","marker","pattern","view","svg"],A=["pattern","defs","symbol","metadata","clipPath","mask","desc"],S=["symbol","g","a","svg"],O={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity"},P={stroke:"strokeOpacity",fill:"fillOpacity"};g.svgValidTagNamesRegEx=r(M),g.svgViewBoxElementsRegEx=r(E),g.svgInvalidAncestorsRegEx=r(A),g.svgValidParentsRegEx=r(S),g.cssRules={},g.gradientDefs={},g.parseTransformAttribute=function(){function t(t,e){var n=Math.cos(e[0]),r=Math.sin(e[0]),i=0,a=0;3===e.length&&(i=e[1],a=e[2]),t[0]=n,t[1]=r,t[2]=-r,t[3]=n,t[4]=i-(n*i-r*a),t[5]=a-(r*i+n*a)}function e(t,e){var n=e[0],r=2===e.length?e[1]:e[0];t[0]=n,t[3]=r}function n(t,e,n){t[n]=Math.tan(g.util.degreesToRadians(e[0]))}function r(t,e){t[4]=e[0],2===e.length&&(t[5]=e[1])}var i=[1,0,0,1,0,0],a=g.reNum,o="(?:\\s+,?\\s*|,\\s*)",s="(?:(skewX)\\s*\\(\\s*("+a+")\\s*\\))",c="(?:(skewY)\\s*\\(\\s*("+a+")\\s*\\))",u="(?:(rotate)\\s*\\(\\s*("+a+")(?:"+o+"("+a+")"+o+"("+a+"))?\\s*\\))",f="(?:(scale)\\s*\\(\\s*("+a+")(?:"+o+"("+a+"))?\\s*\\))",l="(?:(translate)\\s*\\(\\s*("+a+")(?:"+o+"("+a+"))?\\s*\\))",p="(?:(matrix)\\s*\\(\\s*("+a+")"+o+"("+a+")"+o+"("+a+")"+o+"("+a+")"+o+"("+a+")"+o+"("+a+")\\s*\\))",d="(?:"+p+"|"+l+"|"+f+"|"+u+"|"+s+"|"+c+")",h="(?:"+d+"(?:"+o+"*"+d+")*)",m="^\\s*(?:"+h+"?)\\s*$",y=new RegExp(m),b=new RegExp(d,"g");return function(a){var o=i.concat(),s=[];if(!a||a&&!y.test(a))return o;a.replace(b,function(a){var c=new RegExp(d).exec(a).filter(function(t){return!!t}),u=c[1],f=c.slice(2).map(parseFloat);switch(u){case"translate":r(o,f);break;case"rotate":f[0]=g.util.degreesToRadians(f[0]),t(o,f);break;case"scale":e(o,f);break;case"skewX":n(o,f,2);break;case"skewY":n(o,f,1);break;case"matrix":o=f}s.push(o.concat()),o=i.concat()});for(var c=s[0];s.length>1;)s.shift(),c=g.util.multiplyTransformMatrices(c,s[0]);return c}}();var C=new RegExp("^\\s*("+g.reNum+"+)\\s*,?\\s*("+g.reNum+"+)\\s*,?\\s*("+g.reNum+"+)\\s*,?\\s*("+g.reNum+"+)\\s*$");g.parseSVGDocument=function(t,e,n,r){if(t){d(t);var i,a,o=g.Object.__uid++,s=h(t),c=g.util.toArray(t.getElementsByTagName("*"));if(s.crossOrigin=r&&r.crossOrigin,s.svgUid=o,0===c.length&&g.isLikelyNode){c=t.selectNodes('//*[name(.)!="svg"]');var u=[];for(i=0,a=c.length;a>i;i++)u[i]=c[i];c=u}var f=c.filter(function(t){return h(t),g.svgValidTagNamesRegEx.test(t.nodeName.replace("svg:",""))&&!m(t,g.svgInvalidAncestorsRegEx)});if(!f||f&&!f.length)return void(e&&e([],{}));g.gradientDefs[o]=g.getGradientDefs(t),g.cssRules[o]=g.getCSSRules(t),g.parseElements(f,function(t,n){e&&e(t,s,n,c)},b(s),n,r)}};var T=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+g.reNum+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+g.reNum+"))?\\s+(.*)");y(g,{parseFontDeclaration:function(t,e){var n=t.match(T);if(n){var r=n[1],i=n[3],a=n[4],o=n[5],s=n[6];r&&(e.fontStyle=r),i&&(e.fontWeight=isNaN(parseFloat(i))?i:parseFloat(i)),a&&(e.fontSize=x(a)),s&&(e.fontFamily=s),o&&(e.lineHeight="normal"===o?1:o)}},getGradientDefs:function(t){var e,n,r,i=["linearGradient","radialGradient","svg:linearGradient","svg:radialGradient"],o=a(t,i),s=0,c={},u={};for(s=o.length;s--;)e=o[s],r=e.getAttribute("xlink:href"),n=e.getAttribute("id"),r&&(u[n]=r.substr(1)),c[n]=e;for(n in u){var f=c[u[n]].cloneNode(!0);for(e=c[n];f.firstChild;)e.appendChild(f.firstChild)}return c},parseAttributes:function(t,r,a){if(t){var o,s,u={};"undefined"==typeof a&&(a=t.getAttribute("svgUid")),t.parentNode&&g.svgValidParentsRegEx.test(t.parentNode.nodeName)&&(u=g.parseAttributes(t.parentNode,r,a)),s=u&&u.fontSize||t.getAttribute("font-size")||g.Text.DEFAULT_SVG_FONT_SIZE;var f=r.reduce(function(e,n){return o=t.getAttribute(n),o&&(e[n]=o),e},{});f=y(f,y(c(t,a),g.parseStyleAttribute(t)));var l,p,d={};for(var h in f)l=e(h),p=n(l,f[h],u,s),d[l]=p;d&&d.font&&g.parseFontDeclaration(d.font,d);var m=y(u,d);return g.svgValidParentsRegEx.test(t.nodeName)?m:i(m)}},parseElements:function(t,e,n,r,i){new g.ElementsParser(t,e,n,r,i).parse()},parseStyleAttribute:function(t){var e={},n=t.getAttribute("style");return n?("string"==typeof n?o(n,e):s(n,e),e):e},parsePointsAttribute:function(t){if(!t)return null;t=t.replace(/,/g," ").trim(),t=t.split(/\s+/);var e,n,r=[];for(e=0,n=t.length;n>e;e+=2)r.push({x:parseFloat(t[e]),y:parseFloat(t[e+1])});return r},getCSSRules:function(t){var e,n,r,i=t.getElementsByTagName("style"),a={};for(e=0,n=i.length;n>e;e++){var o=i[e].textContent||i[e].text;o=o.replace(/\/\*[\s\S]*?\*\//g,""),""!==o.trim()&&(r=o.match(/[^{]*\{[\s\S]*?\}/g),r=r.map(function(t){return t.trim()}),r.forEach(function(t){var r=t.match(/([\s\S]*?)\s*\{([^}]*)\}/),i={},o=r[2].trim(),s=o.replace(/;$/,"").split(/\s*;\s*/);for(e=0,n=s.length;n>e;e++){var c=s[e].split(/\s*:\s*/),u=c[0],f=c[1];i[u]=f}t=r[1],t.split(",").forEach(function(t){t=t.replace(/^svg/i,"").trim(),""!==t&&(a[t]?g.util.object.extend(a[t],i):a[t]=g.util.object.clone(i))})}))}return a},loadSVGFromURL:function(t,e,n,r){function i(t){var i=t.responseXML;i&&!i.documentElement&&g.window.ActiveXObject&&t.responseText&&(i=new ActiveXObject("Microsoft.XMLDOM"),i.async="false",i.loadXML(t.responseText.replace(/<!DOCTYPE[\s\S]*?(\[[\s\S]*\])*?>/i,""))),i&&i.documentElement||e&&e(null),g.parseSVGDocument(i.documentElement,function(t,n,r,i){e&&e(t,n,r,i)},n,r)}t=t.replace(/^\n\s*/,"").trim(),new g.util.request(t,{method:"get",onComplete:i})},loadSVGFromString:function(t,e,n,r){t=t.trim();var i;if("undefined"!=typeof DOMParser){var a=new DOMParser;a&&a.parseFromString&&(i=a.parseFromString(t,"text/xml"))}else g.window.ActiveXObject&&(i=new ActiveXObject("Microsoft.XMLDOM"),i.async="false",i.loadXML(t.replace(/<!DOCTYPE[\s\S]*?(\[[\s\S]*\])*?>/i,"")));g.parseSVGDocument(i.documentElement,function(t,n,r,i){e(t,n,r,i)},n,r)}})}("undefined"!=typeof exports?exports:this);fabric.ElementsParser=function(t,e,n,r,i){this.elements=t,this.callback=e,this.options=n,this.reviver=r,this.svgUid=n&&n.svgUid||0,this.parsingOptions=i},fabric.ElementsParser.prototype.parse=function(){this.instances=new Array(this.elements.length),this.numElements=this.elements.length,this.createObjects()},fabric.ElementsParser.prototype.createObjects=function(){for(var t=0,e=this.elements.length;e>t;t++)this.elements[t].setAttribute("svgUid",this.svgUid),function(t,e){setTimeout(function(){t.createObject(t.elements[e],e)},0)}(this,t)},fabric.ElementsParser.prototype.createObject=function(t,e){var n=fabric[fabric.util.string.capitalize(t.tagName.replace("svg:",""))];if(n&&n.fromElement)try{this._createObject(n,t,e)}catch(r){fabric.log(r)}else this.checkIfDone()},fabric.ElementsParser.prototype._createObject=function(t,e,n){t.fromElement(e,this.createCallback(n,e),this.options)},fabric.ElementsParser.prototype.createCallback=function(t,e){var n=this;return function(r){var i;n.resolveGradient(r,"fill"),n.resolveGradient(r,"stroke"),r instanceof fabric.Image&&(i=r.parsePreserveAspectRatioAttribute(e)),r._removeTransformMatrix(i),n.reviver&&n.reviver(e,r),n.instances[t]=r,n.checkIfDone()}},fabric.ElementsParser.prototype.resolveGradient=function(t,e){var n=t.get(e);if(/^url\(/.test(n)){var r=n.slice(5,n.length-1);fabric.gradientDefs[this.svgUid][r]&&t.set(e,fabric.Gradient.fromElement(fabric.gradientDefs[this.svgUid][r],t))}},fabric.ElementsParser.prototype.checkIfDone=function(){0===--this.numElements&&(this.instances=this.instances.filter(function(t){return null!=t}),this.callback(this.instances,this.elements))};!function(t){"use strict";function e(t,e){this.x=t,this.y=e}var n=t.fabric||(t.fabric={});return n.Point?void n.warn("fabric.Point is already defined"):(n.Point=e,void(e.prototype={type:"point",constructor:e,add:function(t){return new e(this.x+t.x,this.y+t.y)},addEquals:function(t){return this.x+=t.x,this.y+=t.y,this},scalarAdd:function(t){return new e(this.x+t,this.y+t)},scalarAddEquals:function(t){return this.x+=t,this.y+=t,this},subtract:function(t){return new e(this.x-t.x,this.y-t.y)},subtractEquals:function(t){return this.x-=t.x,this.y-=t.y,this},scalarSubtract:function(t){return new e(this.x-t,this.y-t)},scalarSubtractEquals:function(t){return this.x-=t,this.y-=t,this},multiply:function(t){return new e(this.x*t,this.y*t)},multiplyEquals:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return new e(this.x/t,this.y/t)},divideEquals:function(t){return this.x/=t,this.y/=t,this},eq:function(t){return this.x===t.x&&this.y===t.y},lt:function(t){return this.x<t.x&&this.y<t.y},lte:function(t){return this.x<=t.x&&this.y<=t.y},gt:function(t){return this.x>t.x&&this.y>t.y},gte:function(t){return this.x>=t.x&&this.y>=t.y},lerp:function(t,n){return"undefined"==typeof n&&(n=.5),n=Math.max(Math.min(1,n),0),new e(this.x+(t.x-this.x)*n,this.y+(t.y-this.y)*n)},distanceFrom:function(t){var e=this.x-t.x,n=this.y-t.y;return Math.sqrt(e*e+n*n)},midPointFrom:function(t){return this.lerp(t)},min:function(t){return new e(Math.min(this.x,t.x),Math.min(this.y,t.y))},max:function(t){return new e(Math.max(this.x,t.x),Math.max(this.y,t.y))},toString:function(){return this.x+","+this.y},setXY:function(t,e){return this.x=t,this.y=e,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setFromPoint:function(t){return this.x=t.x,this.y=t.y,this},swap:function(t){var e=this.x,n=this.y;this.x=t.x,this.y=t.y,t.x=e,t.y=n},clone:function(){return new e(this.x,this.y)}}))}("undefined"!=typeof exports?exports:this);!function(t){"use strict";function e(t){this.status=t,this.points=[]}var n=t.fabric||(t.fabric={});return n.Intersection?void n.warn("fabric.Intersection is already defined"):(n.Intersection=e,n.Intersection.prototype={constructor:e,appendPoint:function(t){return this.points.push(t),this},appendPoints:function(t){return this.points=this.points.concat(t),this}},n.Intersection.intersectLineLine=function(t,r,i,a){var o,c=(a.x-i.x)*(t.y-i.y)-(a.y-i.y)*(t.x-i.x),u=(r.x-t.x)*(t.y-i.y)-(r.y-t.y)*(t.x-i.x),s=(a.y-i.y)*(r.x-t.x)-(a.x-i.x)*(r.y-t.y);if(0!==s){var f=c/s,l=u/s;f>=0&&1>=f&&l>=0&&1>=l?(o=new e("Intersection"),o.appendPoint(new n.Point(t.x+f*(r.x-t.x),t.y+f*(r.y-t.y)))):o=new e}else o=new e(0===c||0===u?"Coincident":"Parallel");return o},n.Intersection.intersectLinePolygon=function(t,n,r){var i,a,o,c,u=new e,s=r.length;for(c=0;s>c;c++)i=r[c],a=r[(c+1)%s],o=e.intersectLineLine(t,n,i,a),u.appendPoints(o.points);return u.points.length>0&&(u.status="Intersection"),u},n.Intersection.intersectPolygonPolygon=function(t,n){var r,i=new e,a=t.length;for(r=0;a>r;r++){var o=t[r],c=t[(r+1)%a],u=e.intersectLinePolygon(o,c,n);i.appendPoints(u.points)}return i.points.length>0&&(i.status="Intersection"),i},void(n.Intersection.intersectPolygonRectangle=function(t,r,i){var a=r.min(i),o=r.max(i),c=new n.Point(o.x,a.y),u=new n.Point(a.x,o.y),s=e.intersectLinePolygon(a,c,t),f=e.intersectLinePolygon(c,o,t),l=e.intersectLinePolygon(o,u,t),h=e.intersectLinePolygon(u,a,t),d=new e;return d.appendPoints(s.points),d.appendPoints(f.points),d.appendPoints(l.points),d.appendPoints(h.points),d.points.length>0&&(d.status="Intersection"),d}))}("undefined"!=typeof exports?exports:this);!function(t){"use strict";function e(t){t?this._tryParsingColor(t):this.setSource([0,0,0,1])}function r(t,e,r){return 0>r&&(r+=1),r>1&&(r-=1),1/6>r?t+6*(e-t)*r:.5>r?e:2/3>r?t+(e-t)*(2/3-r)*6:t}var n=t.fabric||(t.fabric={});return n.Color?void n.warn("fabric.Color is already defined."):(n.Color=e,n.Color.prototype={_tryParsingColor:function(t){var r;t in e.colorNameMap&&(t=e.colorNameMap[t]),"transparent"===t&&(r=[255,255,255,0]),r||(r=e.sourceFromHex(t)),r||(r=e.sourceFromRgb(t)),r||(r=e.sourceFromHsl(t)),r||(r=[0,0,0,1]),r&&this.setSource(r)},_rgbToHsl:function(t,e,r){t/=255,e/=255,r/=255;var i,a,o,s=n.util.array.max([t,e,r]),c=n.util.array.min([t,e,r]);if(o=(s+c)/2,s===c)i=a=0;else{var u=s-c;switch(a=o>.5?u/(2-s-c):u/(s+c),s){case t:i=(e-r)/u+(r>e?6:0);break;case e:i=(r-t)/u+2;break;case r:i=(t-e)/u+4}i/=6}return[Math.round(360*i),Math.round(100*a),Math.round(100*o)]},getSource:function(){return this._source},setSource:function(t){this._source=t},toRgb:function(){var t=this.getSource();return"rgb("+t[0]+","+t[1]+","+t[2]+")"},toRgba:function(){var t=this.getSource();return"rgba("+t[0]+","+t[1]+","+t[2]+","+t[3]+")"},toHsl:function(){var t=this.getSource(),e=this._rgbToHsl(t[0],t[1],t[2]);return"hsl("+e[0]+","+e[1]+"%,"+e[2]+"%)"},toHsla:function(){var t=this.getSource(),e=this._rgbToHsl(t[0],t[1],t[2]);return"hsla("+e[0]+","+e[1]+"%,"+e[2]+"%,"+t[3]+")"},toHex:function(){var t,e,r,n=this.getSource();return t=n[0].toString(16),t=1===t.length?"0"+t:t,e=n[1].toString(16),e=1===e.length?"0"+e:e,r=n[2].toString(16),r=1===r.length?"0"+r:r,t.toUpperCase()+e.toUpperCase()+r.toUpperCase()},toHexa:function(){var t,e=this.getSource();return t=255*e[3],t=t.toString(16),t=1===t.length?"0"+t:t,this.toHex()+t.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(t){var e=this.getSource();return e[3]=t,this.setSource(e),this},toGrayscale:function(){var t=this.getSource(),e=parseInt((.3*t[0]+.59*t[1]+.11*t[2]).toFixed(0),10),r=t[3];return this.setSource([e,e,e,r]),this},toBlackWhite:function(t){var e=this.getSource(),r=(.3*e[0]+.59*e[1]+.11*e[2]).toFixed(0),n=e[3];return t=t||127,r=Number(r)<Number(t)?0:255,this.setSource([r,r,r,n]),this},overlayWith:function(t){t instanceof e||(t=new e(t));var r,n=[],i=this.getAlpha(),a=.5,o=this.getSource(),s=t.getSource();for(r=0;3>r;r++)n.push(Math.round(o[r]*(1-a)+s[r]*a));return n[3]=i,this.setSource(n),this}},n.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*((?:\d*\.?\d+)?)\s*)?\)$/,n.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/,n.Color.reHex=/^#?([0-9a-f]{8}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{3})$/i,n.Color.colorNameMap={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"},n.Color.fromRgb=function(t){return e.fromSource(e.sourceFromRgb(t))},n.Color.sourceFromRgb=function(t){var r=t.match(e.reRGBa);if(r){var n=parseInt(r[1],10)/(/%$/.test(r[1])?100:1)*(/%$/.test(r[1])?255:1),i=parseInt(r[2],10)/(/%$/.test(r[2])?100:1)*(/%$/.test(r[2])?255:1),a=parseInt(r[3],10)/(/%$/.test(r[3])?100:1)*(/%$/.test(r[3])?255:1);return[parseInt(n,10),parseInt(i,10),parseInt(a,10),r[4]?parseFloat(r[4]):1]}},n.Color.fromRgba=e.fromRgb,n.Color.fromHsl=function(t){return e.fromSource(e.sourceFromHsl(t))},n.Color.sourceFromHsl=function(t){var n=t.match(e.reHSLa);if(n){var i,a,o,s=(parseFloat(n[1])%360+360)%360/360,c=parseFloat(n[2])/(/%$/.test(n[2])?100:1),u=parseFloat(n[3])/(/%$/.test(n[3])?100:1);if(0===c)i=a=o=u;else{var l=.5>=u?u*(c+1):u+c-u*c,f=2*u-l;i=r(f,l,s+1/3),a=r(f,l,s),o=r(f,l,s-1/3)}return[Math.round(255*i),Math.round(255*a),Math.round(255*o),n[4]?parseFloat(n[4]):1]}},n.Color.fromHsla=e.fromHsl,n.Color.fromHex=function(t){return e.fromSource(e.sourceFromHex(t))},n.Color.sourceFromHex=function(t){if(t.match(e.reHex)){var r=t.slice(t.indexOf("#")+1),n=3===r.length||4===r.length,i=8===r.length||4===r.length,a=n?r.charAt(0)+r.charAt(0):r.substring(0,2),o=n?r.charAt(1)+r.charAt(1):r.substring(2,4),s=n?r.charAt(2)+r.charAt(2):r.substring(4,6),c=i?n?r.charAt(3)+r.charAt(3):r.substring(6,8):"FF";return[parseInt(a,16),parseInt(o,16),parseInt(s,16),parseFloat((parseInt(c,16)/255).toFixed(2))]}},void(n.Color.fromSource=function(t){var r=new e;return r.setSource(t),r}))}("undefined"!=typeof exports?exports:this);!function(){function t(t){var e,r,n,i,o=t.getAttribute("style"),a=t.getAttribute("offset")||0;if(a=parseFloat(a)/(/%$/.test(a)?100:1),a=0>a?0:a>1?1:a,o){var s=o.split(/\s*;\s*/);for(""===s[s.length-1]&&s.pop(),i=s.length;i--;){var c=s[i].split(/\s*:\s*/),u=c[0].trim(),l=c[1].trim();"stop-color"===u?e=l:"stop-opacity"===u&&(n=l)}}return e||(e=t.getAttribute("stop-color")||"rgb(0,0,0)"),n||(n=t.getAttribute("stop-opacity")),e=new fabric.Color(e),r=e.getAlpha(),n=isNaN(parseFloat(n))?1:parseFloat(n),n*=r,{offset:a,color:e.toRgb(),opacity:n}}function e(t){return{x1:t.getAttribute("x1")||0,y1:t.getAttribute("y1")||0,x2:t.getAttribute("x2")||"100%",y2:t.getAttribute("y2")||0}}function r(t){return{x1:t.getAttribute("fx")||t.getAttribute("cx")||"50%",y1:t.getAttribute("fy")||t.getAttribute("cy")||"50%",r1:0,x2:t.getAttribute("cx")||"50%",y2:t.getAttribute("cy")||"50%",r2:t.getAttribute("r")||"50%"}}function n(t,e,r){var n,i=0,o=1,a="";for(var s in e)"Infinity"===e[s]?e[s]=1:"-Infinity"===e[s]&&(e[s]=0),n=parseFloat(e[s],10),o="string"==typeof e[s]&&/^\d+%$/.test(e[s])?.01:1,"x1"===s||"x2"===s||"r2"===s?(o*="objectBoundingBox"===r?t.width:1,i="objectBoundingBox"===r?t.left||0:0):("y1"===s||"y2"===s)&&(o*="objectBoundingBox"===r?t.height:1,i="objectBoundingBox"===r?t.top||0:0),e[s]=n*o+i;if("ellipse"===t.type&&null!==e.r2&&"objectBoundingBox"===r&&t.rx!==t.ry){var c=t.ry/t.rx;a=" scale(1, "+c+")",e.y1&&(e.y1/=c),e.y2&&(e.y2/=c)}return a}var i=fabric.util.object.clone;fabric.Gradient=fabric.util.createClass({offsetX:0,offsetY:0,initialize:function(t){t||(t={});var e={};this.id=fabric.Object.__uid++,this.type=t.type||"linear",e={x1:t.coords.x1||0,y1:t.coords.y1||0,x2:t.coords.x2||0,y2:t.coords.y2||0},"radial"===this.type&&(e.r1=t.coords.r1||0,e.r2=t.coords.r2||0),this.coords=e,this.colorStops=t.colorStops.slice(),t.gradientTransform&&(this.gradientTransform=t.gradientTransform),this.offsetX=t.offsetX||this.offsetX,this.offsetY=t.offsetY||this.offsetY},addColorStop:function(t){for(var e in t){var r=new fabric.Color(t[e]);this.colorStops.push({offset:parseFloat(e),color:r.toRgb(),opacity:r.getAlpha()})}return this},toObject:function(t){var e={type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY,gradientTransform:this.gradientTransform?this.gradientTransform.concat():this.gradientTransform};return fabric.util.populateWithProperties(this,e,t),e},toSVG:function(t){var e,r,n,o,a=i(this.coords,!0),s=i(this.colorStops,!0),c=a.r1>a.r2,u=t.width/2,l=t.height/2;s.sort(function(t,e){return t.offset-e.offset}),"path"===t.type&&(u-=t.pathOffset.x,l-=t.pathOffset.y);for(var f in a)"x1"===f||"x2"===f?a[f]+=this.offsetX-u:("y1"===f||"y2"===f)&&(a[f]+=this.offsetY-l);if(o='id="SVGID_'+this.id+'" gradientUnits="userSpaceOnUse"',this.gradientTransform&&(o+=' gradientTransform="matrix('+this.gradientTransform.join(" ")+')" '),"linear"===this.type?n=["<linearGradient ",o,' x1="',a.x1,'" y1="',a.y1,'" x2="',a.x2,'" y2="',a.y2,'">\n']:"radial"===this.type&&(n=["<radialGradient ",o,' cx="',c?a.x1:a.x2,'" cy="',c?a.y1:a.y2,'" r="',c?a.r1:a.r2,'" fx="',c?a.x2:a.x1,'" fy="',c?a.y2:a.y1,'">\n']),"radial"===this.type){if(c)for(s=s.concat(),s.reverse(),e=0,r=s.length;r>e;e++)s[e].offset=1-s[e].offset;var h=Math.min(a.r1,a.r2);if(h>0){var d=Math.max(a.r1,a.r2),p=h/d;for(e=0,r=s.length;r>e;e++)s[e].offset+=p*(1-s[e].offset)}}for(e=0,r=s.length;r>e;e++){var g=s[e];n.push("<stop ",'offset="',100*g.offset+"%",'" style="stop-color:',g.color,null!==g.opacity?";stop-opacity: "+g.opacity:";",'"/>\n')}return n.push("linear"===this.type?"</linearGradient>\n":"</radialGradient>\n"),n.join("")},toLive:function(t){var e,r,n,i=fabric.util.object.clone(this.coords);if(this.type){for("linear"===this.type?e=t.createLinearGradient(i.x1,i.y1,i.x2,i.y2):"radial"===this.type&&(e=t.createRadialGradient(i.x1,i.y1,i.r1,i.x2,i.y2,i.r2)),r=0,n=this.colorStops.length;n>r;r++){var o=this.colorStops[r].color,a=this.colorStops[r].opacity,s=this.colorStops[r].offset;"undefined"!=typeof a&&(o=new fabric.Color(o).setAlpha(a).toRgba()),e.addColorStop(s,o)}return e}}}),fabric.util.object.extend(fabric.Gradient,{fromElement:function(i,o){var a,s,c,u,l=i.getElementsByTagName("stop"),f=i.getAttribute("gradientUnits")||"objectBoundingBox",h=i.getAttribute("gradientTransform"),d=[];for(a="linearGradient"===i.nodeName||"LINEARGRADIENT"===i.nodeName?"linear":"radial","linear"===a?s=e(i):"radial"===a&&(s=r(i)),u=l.length;u--;)d.push(t(l[u]));c=n(o,s,f);var p=new fabric.Gradient({type:a,coords:s,colorStops:d,offsetX:-o.left,offsetY:-o.top});return(h||""!==c)&&(p.gradientTransform=fabric.parseTransformAttribute((h||"")+c)),p},forObject:function(t,e){return e||(e={}),n(t,e.coords,"userSpaceOnUse"),new fabric.Gradient(e)}})}();!function(){"use strict";var t=fabric.util.toFixed;fabric.Pattern=fabric.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,initialize:function(t,e){if(t||(t={}),this.id=fabric.Object.__uid++,this.setOptions(t),!t.source||t.source&&"string"!=typeof t.source)return void(e&&e(this));if("undefined"!=typeof fabric.util.getFunctionBody(t.source))this.source=new Function(fabric.util.getFunctionBody(t.source)),e&&e(this);else{var r=this;this.source=fabric.util.createImage(),fabric.util.loadImage(t.source,function(t){r.source=t,e&&e(r)})}},toObject:function(e){var r,n,i=fabric.Object.NUM_FRACTION_DIGITS;return"function"==typeof this.source?r=String(this.source):"string"==typeof this.source.src?r=this.source.src:"object"==typeof this.source&&this.source.toDataURL&&(r=this.source.toDataURL()),n={type:"pattern",source:r,repeat:this.repeat,offsetX:t(this.offsetX,i),offsetY:t(this.offsetY,i)},fabric.util.populateWithProperties(this,n,e),n},toSVG:function(t){var e="function"==typeof this.source?this.source():this.source,r=e.width/t.width,n=e.height/t.height,i=this.offsetX/t.width,o=this.offsetY/t.height,a="";return("repeat-x"===this.repeat||"no-repeat"===this.repeat)&&(n=1),("repeat-y"===this.repeat||"no-repeat"===this.repeat)&&(r=1),e.src?a=e.src:e.toDataURL&&(a=e.toDataURL()),'<pattern id="SVGID_'+this.id+'" x="'+i+'" y="'+o+'" width="'+r+'" height="'+n+'">\n<image x="0" y="0" width="'+e.width+'" height="'+e.height+'" xlink:href="'+a+'"></image>\n</pattern>\n'},setOptions:function(t){for(var e in t)this[e]=t[e]},toLive:function(t){var e="function"==typeof this.source?this.source():this.source;if(!e)return"";if("undefined"!=typeof e.src){if(!e.complete)return"";if(0===e.naturalWidth||0===e.naturalHeight)return""}return t.createPattern(e,this.repeat)}})}();!function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.util.toFixed;return e.Shadow?void e.warn("fabric.Shadow is already defined."):(e.Shadow=e.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,initialize:function(t){"string"==typeof t&&(t=this._parseShadow(t));for(var r in t)this[r]=t[r];this.id=e.Object.__uid++},_parseShadow:function(t){var r=t.trim(),n=e.Shadow.reOffsetsAndBlur.exec(r)||[],i=r.replace(e.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)";return{color:i.trim(),offsetX:parseInt(n[1],10)||0,offsetY:parseInt(n[2],10)||0,blur:parseInt(n[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(t){var n=40,i=40,o=e.Object.NUM_FRACTION_DIGITS,a=e.util.rotateVector({x:this.offsetX,y:this.offsetY},e.util.degreesToRadians(-t.angle)),s=20;return t.width&&t.height&&(n=100*r((Math.abs(a.x)+this.blur)/t.width,o)+s,i=100*r((Math.abs(a.y)+this.blur)/t.height,o)+s),t.flipX&&(a.x*=-1),t.flipY&&(a.y*=-1),'<filter id="SVGID_'+this.id+'" y="-'+i+'%" height="'+(100+2*i)+'%" x="-'+n+'%" width="'+(100+2*n)+'%" >\n	<feGaussianBlur in="SourceAlpha" stdDeviation="'+r(this.blur?this.blur/2:0,o)+'"></feGaussianBlur>\n	<feOffset dx="'+r(a.x,o)+'" dy="'+r(a.y,o)+'" result="oBlur" ></feOffset>\n	<feFlood flood-color="'+this.color+'"/>\n	<feComposite in2="oBlur" operator="in" />\n	<feMerge>\n		<feMergeNode></feMergeNode>\n		<feMergeNode in="SourceGraphic"></feMergeNode>\n	</feMerge>\n</filter>\n'},toObject:function(){if(this.includeDefaultValues)return{color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke};var t={},r=e.Shadow.prototype;return["color","blur","offsetX","offsetY","affectStroke"].forEach(function(e){this[e]!==r[e]&&(t[e]=this[e])},this),t}}),void(e.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:px)?(?:\s?|$))?(-?\d+(?:px)?(?:\s?|$))?(\d+(?:px)?)?(?:\s?|$)(?:$|\s)/))}("undefined"!=typeof exports?exports:this);!function(){"use strict";if(fabric.StaticCanvas)return void fabric.warn("fabric.StaticCanvas is already defined.");var t=fabric.util.object.extend,e=fabric.util.getElementOffset,r=fabric.util.removeFromArray,n=fabric.util.toFixed,i=fabric.util.transformPoint,o=fabric.util.invertTransform,a=new Error("Could not initialize `canvas` element");fabric.StaticCanvas=fabric.util.createClass(fabric.CommonMethods,{initialize:function(t,e){e||(e={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(t,e)},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!1,renderOnAddRemove:!0,clipTo:null,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,viewportTransform:fabric.iMatrix.concat(),backgroundVpt:!0,overlayVpt:!0,onBeforeScaleRotate:function(){},enableRetinaScaling:!0,vptCoords:{},skipOffscreen:!0,_initStatic:function(t,e){var r=this.requestRenderAllBound;this._objects=[],this._createLowerCanvas(t),this._initOptions(e),this._setImageSmoothing(),this.interactive||this._initRetinaScaling(),e.overlayImage&&this.setOverlayImage(e.overlayImage,r),e.backgroundImage&&this.setBackgroundImage(e.backgroundImage,r),e.backgroundColor&&this.setBackgroundColor(e.backgroundColor,r),e.overlayColor&&this.setOverlayColor(e.overlayColor,r),this.calcOffset()},_isRetinaScaling:function(){return 1!==fabric.devicePixelRatio&&this.enableRetinaScaling},getRetinaScaling:function(){return this._isRetinaScaling()?fabric.devicePixelRatio:1},_initRetinaScaling:function(){this._isRetinaScaling()&&(this.lowerCanvasEl.setAttribute("width",this.width*fabric.devicePixelRatio),this.lowerCanvasEl.setAttribute("height",this.height*fabric.devicePixelRatio),this.contextContainer.scale(fabric.devicePixelRatio,fabric.devicePixelRatio))},calcOffset:function(){return this._offset=e(this.lowerCanvasEl),this},setOverlayImage:function(t,e,r){return this.__setBgOverlayImage("overlayImage",t,e,r)},setBackgroundImage:function(t,e,r){return this.__setBgOverlayImage("backgroundImage",t,e,r)},setOverlayColor:function(t,e){return this.__setBgOverlayColor("overlayColor",t,e)},setBackgroundColor:function(t,e){return this.__setBgOverlayColor("backgroundColor",t,e)},_setImageSmoothing:function(){var t=this.getContext();t.imageSmoothingEnabled=t.imageSmoothingEnabled||t.webkitImageSmoothingEnabled||t.mozImageSmoothingEnabled||t.msImageSmoothingEnabled||t.oImageSmoothingEnabled,t.imageSmoothingEnabled=this.imageSmoothingEnabled},__setBgOverlayImage:function(t,e,r,n){return"string"==typeof e?fabric.util.loadImage(e,function(e){e&&(this[t]=new fabric.Image(e,n)),r&&r(e)},this,n&&n.crossOrigin):(n&&e.setOptions(n),this[t]=e,r&&r(e)),this},__setBgOverlayColor:function(t,e,r){return this[t]=e,this._initGradient(e,t),this._initPattern(e,t,r),this},_createCanvasElement:function(){var t=fabric.util.createCanvasElement();if(!t)throw a;if(t.style||(t.style={}),"undefined"==typeof t.getContext)throw a;return t},_initOptions:function(t){this._setOptions(t),this.width=this.width||parseInt(this.lowerCanvasEl.width,10)||0,this.height=this.height||parseInt(this.lowerCanvasEl.height,10)||0,this.lowerCanvasEl.style&&(this.lowerCanvasEl.width=this.width,this.lowerCanvasEl.height=this.height,this.lowerCanvasEl.style.width=this.width+"px",this.lowerCanvasEl.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(t){this.lowerCanvasEl=t&&t.getContext?t:fabric.util.getById(t)||this._createCanvasElement(),fabric.util.addClass(this.lowerCanvasEl,"lower-canvas"),this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl),this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(t,e){return this.setDimensions({width:t},e)},setHeight:function(t,e){return this.setDimensions({height:t},e)},setDimensions:function(t,e){var r;e=e||{};for(var n in t)r=t[n],e.cssOnly||(this._setBackstoreDimension(n,t[n]),r+="px"),e.backstoreOnly||this._setCssDimension(n,r);return this._initRetinaScaling(),this._setImageSmoothing(),this.calcOffset(),e.cssOnly||this.requestRenderAll(),this},_setBackstoreDimension:function(t,e){return this.lowerCanvasEl[t]=e,this.upperCanvasEl&&(this.upperCanvasEl[t]=e),this.cacheCanvasEl&&(this.cacheCanvasEl[t]=e),this[t]=e,this},_setCssDimension:function(t,e){return this.lowerCanvasEl.style[t]=e,this.upperCanvasEl&&(this.upperCanvasEl.style[t]=e),this.wrapperEl&&(this.wrapperEl.style[t]=e),this},getZoom:function(){return this.viewportTransform[0]},setViewportTransform:function(t){var e,r,n,i=this._activeObject,o=!1,a=!0;for(this.viewportTransform=t,r=0,n=this._objects.length;n>r;r++)e=this._objects[r],e.group||e.setCoords(o,a);return i&&"activeSelection"===i.type&&i.setCoords(o,a),this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll(),this},zoomToPoint:function(t,e){var r=t,n=this.viewportTransform.slice(0);t=i(t,o(this.viewportTransform)),n[0]=e,n[3]=e;var a=i(t,n);return n[4]+=r.x-a.x,n[5]+=r.y-a.y,this.setViewportTransform(n)},setZoom:function(t){return this.zoomToPoint(new fabric.Point(0,0),t),this},absolutePan:function(t){var e=this.viewportTransform.slice(0);return e[4]=-t.x,e[5]=-t.y,this.setViewportTransform(e)},relativePan:function(t){return this.absolutePan(new fabric.Point(-t.x-this.viewportTransform[4],-t.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},_onObjectAdded:function(t){this.stateful&&t.setupState(),t._set("canvas",this),t.setCoords(),this.fire("object:added",{target:t}),t.fire("added")},_onObjectRemoved:function(t){this.fire("object:removed",{target:t}),t.fire("removed"),delete t.canvas},clearContext:function(t){return t.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this._objects.length=0,this.backgroundImage=null,this.overlayImage=null,this.backgroundColor="",this.overlayColor="",this._hasITextHandlers&&(this.off("mouse:up",this._mouseUpITextHandler),this._iTextInstances=null,this._hasITextHandlers=!1),this.clearContext(this.contextContainer),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll(),this},renderAll:function(){var t=this.contextContainer;return this.renderCanvas(t,this._objects),this},renderAndReset:function(){this.isRendering=0,this.renderAll()},requestRenderAll:function(){return this.isRendering||(this.isRendering=fabric.util.requestAnimFrame(this.renderAndResetBound)),this},calcViewportBoundaries:function(){var t={},e=this.width,r=this.height,n=o(this.viewportTransform);return t.tl=i({x:0,y:0},n),t.br=i({x:e,y:r},n),t.tr=new fabric.Point(t.br.x,t.tl.y),t.bl=new fabric.Point(t.tl.x,t.br.y),this.vptCoords=t,t},renderCanvas:function(t,e){var r=this.viewportTransform;this.isRendering&&(fabric.util.cancelAnimFrame(this.isRendering),this.isRendering=0),this.calcViewportBoundaries(),this.clearContext(t),this.fire("before:render"),this.clipTo&&fabric.util.clipContext(this,t),this._renderBackground(t),t.save(),t.transform(r[0],r[1],r[2],r[3],r[4],r[5]),this._renderObjects(t,e),t.restore(),!this.controlsAboveOverlay&&this.interactive&&this.drawControls(t),this.clipTo&&t.restore(),this._renderOverlay(t),this.controlsAboveOverlay&&this.interactive&&this.drawControls(t),this.fire("after:render")},_renderObjects:function(t,e){var r,n;for(r=0,n=e.length;n>r;++r)e[r]&&e[r].render(t)},_renderBackgroundOrOverlay:function(t,e){var r,n=this[e+"Color"];n&&(t.fillStyle=n.toLive?n.toLive(t,this):n,t.fillRect(n.offsetX||0,n.offsetY||0,this.width,this.height)),n=this[e+"Image"],n&&(this[e+"Vpt"]&&(r=this.viewportTransform,t.save(),t.transform(r[0],r[1],r[2],r[3],r[4],r[5])),n.render(t),this[e+"Vpt"]&&t.restore())},_renderBackground:function(t){this._renderBackgroundOrOverlay(t,"background")},_renderOverlay:function(t){this._renderBackgroundOrOverlay(t,"overlay")},getCenter:function(){return{top:this.height/2,left:this.width/2}},centerObjectH:function(t){return this._centerObject(t,new fabric.Point(this.getCenter().left,t.getCenterPoint().y))},centerObjectV:function(t){return this._centerObject(t,new fabric.Point(t.getCenterPoint().x,this.getCenter().top))},centerObject:function(t){var e=this.getCenter();return this._centerObject(t,new fabric.Point(e.left,e.top))},viewportCenterObject:function(t){var e=this.getVpCenter();return this._centerObject(t,e)},viewportCenterObjectH:function(t){var e=this.getVpCenter();return this._centerObject(t,new fabric.Point(e.x,t.getCenterPoint().y)),this},viewportCenterObjectV:function(t){var e=this.getVpCenter();return this._centerObject(t,new fabric.Point(t.getCenterPoint().x,e.y))},getVpCenter:function(){var t=this.getCenter(),e=o(this.viewportTransform);return i({x:t.left,y:t.top},e)},_centerObject:function(t,e){return t.setPositionByOrigin(e,"center","center"),this.renderOnAddRemove&&this.requestRenderAll(),this},toDatalessJSON:function(t){return this.toDatalessObject(t)},toObject:function(t){return this._toObjectMethod("toObject",t)},toDatalessObject:function(t){return this._toObjectMethod("toDatalessObject",t)},_toObjectMethod:function(e,r){var n={version:fabric.version,objects:this._toObjects(e,r)};return t(n,this.__serializeBgOverlay(e,r)),fabric.util.populateWithProperties(this,n,r),n},_toObjects:function(t,e){return this.getObjects().filter(function(t){return!t.excludeFromExport}).map(function(r){return this._toObject(r,t,e)},this)},_toObject:function(t,e,r){var n;this.includeDefaultValues||(n=t.includeDefaultValues,t.includeDefaultValues=!1);var i=t[e](r);return this.includeDefaultValues||(t.includeDefaultValues=n),i},__serializeBgOverlay:function(t,e){var r={},n=this.backgroundImage,i=this.overlayImage;return this.backgroundColor&&(r.background=this.backgroundColor.toObject?this.backgroundColor.toObject(e):this.backgroundColor),this.overlayColor&&(r.overlay=this.overlayColor.toObject?this.overlayColor.toObject(e):this.overlayColor),n&&!n.excludeFromExport&&(r.backgroundImage=this._toObject(n,t,e)),i&&!i.excludeFromExport&&(r.overlayImage=this._toObject(i,t,e)),r},svgViewportTransformation:!0,toSVG:function(t,e){t||(t={});var r=[];return this._setSVGPreamble(r,t),this._setSVGHeader(r,t),this._setSVGBgOverlayColor(r,"backgroundColor"),this._setSVGBgOverlayImage(r,"backgroundImage",e),this._setSVGObjects(r,e),this._setSVGBgOverlayColor(r,"overlayColor"),this._setSVGBgOverlayImage(r,"overlayImage",e),r.push("</svg>"),r.join("")},_setSVGPreamble:function(t,e){e.suppressPreamble||t.push('<?xml version="1.0" encoding="',e.encoding||"UTF-8",'" standalone="no" ?>\n','<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ','"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n')},_setSVGHeader:function(t,e){var r,i=e.width||this.width,o=e.height||this.height,a='viewBox="0 0 '+this.width+" "+this.height+'" ',s=fabric.Object.NUM_FRACTION_DIGITS;e.viewBox?a='viewBox="'+e.viewBox.x+" "+e.viewBox.y+" "+e.viewBox.width+" "+e.viewBox.height+'" ':this.svgViewportTransformation&&(r=this.viewportTransform,a='viewBox="'+n(-r[4]/r[0],s)+" "+n(-r[5]/r[3],s)+" "+n(this.width/r[0],s)+" "+n(this.height/r[3],s)+'" '),t.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',i,'" ','height="',o,'" ',a,'xml:space="preserve">\n',"<desc>Created with Fabric.js ",fabric.version,"</desc>\n","<defs>\n",this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),"</defs>\n")},createSVGRefElementsMarkup:function(){var t=this,e=["backgroundColor","overlayColor"].map(function(e){var r=t[e];return r&&r.toLive?r.toSVG(t,!1):void 0});return e.join("")},createSVGFontFacesMarkup:function(){var t,e,r,n,i,o,a,s,c,u="",l={},f=fabric.fontPaths,h=this.getObjects();for(s=0,c=h.length;c>s;s++)if(t=h[s],e=t.fontFamily,-1!==t.type.indexOf("text")&&!l[e]&&f[e]&&(l[e]=!0,t.styles)){r=t.styles;for(i in r){n=r[i];for(a in n)o=n[a],e=o.fontFamily,!l[e]&&f[e]&&(l[e]=!0)}}for(var d in l)u+=["		@font-face {\n","			font-family: '",d,"';\n","			src: url('",f[d],"');\n","		}\n"].join("");return u&&(u=['	<style type="text/css">',"<![CDATA[\n",u,"]]>","</style>\n"].join("")),u},_setSVGObjects:function(t,e){var r,n,i,o=this.getObjects();for(n=0,i=o.length;i>n;n++)r=o[n],r.excludeFromExport||this._setSVGObject(t,r,e)},_setSVGObject:function(t,e,r){t.push(e.toSVG(r))},_setSVGBgOverlayImage:function(t,e,r){this[e]&&this[e].toSVG&&t.push(this[e].toSVG(r))},_setSVGBgOverlayColor:function(t,e){var r=this[e];if(r)if(r.toLive){var n=r.repeat;t.push('<rect transform="translate(',this.width/2,",",this.height/2,')"',' x="',r.offsetX-this.width/2,'" y="',r.offsetY-this.height/2,'" ','width="',"repeat-y"===n||"no-repeat"===n?r.source.width:this.width,'" height="',"repeat-x"===n||"no-repeat"===n?r.source.height:this.height,'" fill="url(#SVGID_'+r.id+')"',"></rect>\n")}else t.push('<rect x="0" y="0" ','width="',this.width,'" height="',this.height,'" fill="',this[e],'"',"></rect>\n")},sendToBack:function(t){if(!t)return this;var e,n,i,o=this._activeObject;if(t===o&&"activeSelection"===t.type)for(i=o._objects,e=i.length;e--;)n=i[e],r(this._objects,n),this._objects.unshift(n);else r(this._objects,t),this._objects.unshift(t);return this.renderOnAddRemove&&this.requestRenderAll(),this},bringToFront:function(t){if(!t)return this;var e,n,i,o=this._activeObject;if(t===o&&"activeSelection"===t.type)for(i=o._objects,e=0;e<i.length;e++)n=i[e],r(this._objects,n),this._objects.push(n);else r(this._objects,t),this._objects.push(t);return this.renderOnAddRemove&&this.requestRenderAll(),this},sendBackwards:function(t,e){if(!t)return this;var n,i,o,a,s,c=this._activeObject,u=0;if(t===c&&"activeSelection"===t.type)for(s=c._objects,n=0;n<s.length;n++)i=s[n],o=this._objects.indexOf(i),o>0+u&&(a=o-1,r(this._objects,i),this._objects.splice(a,0,i)),u++;else o=this._objects.indexOf(t),0!==o&&(a=this._findNewLowerIndex(t,o,e),r(this._objects,t),this._objects.splice(a,0,t));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewLowerIndex:function(t,e,r){var n,i;if(r)for(n=e,i=e-1;i>=0;--i){var o=t.intersectsWithObject(this._objects[i])||t.isContainedWithinObject(this._objects[i])||this._objects[i].isContainedWithinObject(t);if(o){n=i;break}}else n=e-1;return n},bringForward:function(t,e){if(!t)return this;var n,i,o,a,s,c=this._activeObject,u=0;if(t===c&&"activeSelection"===t.type)for(s=c._objects,n=s.length;n--;)i=s[n],o=this._objects.indexOf(i),o<this._objects.length-1-u&&(a=o+1,r(this._objects,i),this._objects.splice(a,0,i)),u++;else o=this._objects.indexOf(t),o!==this._objects.length-1&&(a=this._findNewUpperIndex(t,o,e),r(this._objects,t),this._objects.splice(a,0,t));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewUpperIndex:function(t,e,r){var n,i,o;if(r)for(n=e,i=e+1,o=this._objects.length;o>i;++i){var a=t.intersectsWithObject(this._objects[i])||t.isContainedWithinObject(this._objects[i])||this._objects[i].isContainedWithinObject(t);if(a){n=i;break}}else n=e+1;return n},moveTo:function(t,e){return r(this._objects,t),this._objects.splice(e,0,t),this.renderOnAddRemove&&this.requestRenderAll()},dispose:function(){return this._objects.length=0,this.backgroundImage=null,this.overlayImage=null,this._iTextInstances=null,this.lowerCanvasEl=null,this.cacheCanvasEl=null,this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this.getObjects().length+" }>"}}),t(fabric.StaticCanvas.prototype,fabric.Observable),t(fabric.StaticCanvas.prototype,fabric.Collection),t(fabric.StaticCanvas.prototype,fabric.DataURLExporter),t(fabric.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(t){var e=fabric.util.createCanvasElement();if(!e||!e.getContext)return null;var r=e.getContext("2d");if(!r)return null;switch(t){case"getImageData":return"undefined"!=typeof r.getImageData;case"setLineDash":return"undefined"!=typeof r.setLineDash;case"toDataURL":return"undefined"!=typeof e.toDataURL;case"toDataURLWithQuality":try{return e.toDataURL("image/jpeg",0),!0}catch(n){}return!1;default:return null}}}),fabric.StaticCanvas.prototype.toJSON=fabric.StaticCanvas.prototype.toObject,fabric.isLikelyNode&&(fabric.StaticCanvas.prototype.createPNGStream=function(){var t=fabric.jsdomImplForWrapper(this.lowerCanvasEl);return t&&t.createPNGStream()},fabric.StaticCanvas.prototype.createJPEGStream=function(t){var e=fabric.jsdomImplForWrapper(this.lowerCanvasEl);return e&&e.createJPEGStream(t)})}();fabric.BaseBrush=fabric.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",strokeMiterLimit:10,strokeDashArray:null,setShadow:function(t){return this.shadow=new fabric.Shadow(t),this},_setBrushStyles:function(){var t=this.canvas.contextTop;t.strokeStyle=this.color,t.lineWidth=this.width,t.lineCap=this.strokeLineCap,t.miterLimit=this.strokeMiterLimit,t.lineJoin=this.strokeLineJoin,this.strokeDashArray&&fabric.StaticCanvas.supports("setLineDash")&&t.setLineDash(this.strokeDashArray)},_setShadow:function(){if(this.shadow){var t=this.canvas.contextTop,e=this.canvas.getZoom();t.shadowColor=this.shadow.color,t.shadowBlur=this.shadow.blur*e,t.shadowOffsetX=this.shadow.offsetX*e,t.shadowOffsetY=this.shadow.offsetY*e}},_resetShadow:function(){var t=this.canvas.contextTop;t.shadowColor="",t.shadowBlur=t.shadowOffsetX=t.shadowOffsetY=0}});!function(){fabric.PencilBrush=fabric.util.createClass(fabric.BaseBrush,{initialize:function(t){this.canvas=t,this._points=[]},onMouseDown:function(t){this._prepareForDrawing(t),this._captureDrawingPath(t),this._render()},onMouseMove:function(t){this._captureDrawingPath(t),this.canvas.clearContext(this.canvas.contextTop),this._render()},onMouseUp:function(){this._finalizeAndAddPath()},_prepareForDrawing:function(t){var e=new fabric.Point(t.x,t.y);this._reset(),this._addPoint(e),this.canvas.contextTop.moveTo(e.x,e.y)},_addPoint:function(t){this._points.length>1&&t.eq(this._points[this._points.length-1])||this._points.push(t)},_reset:function(){this._points.length=0,this._setBrushStyles(),this._setShadow()},_captureDrawingPath:function(t){var e=new fabric.Point(t.x,t.y);this._addPoint(e)},_render:function(){var t,e,r=this.canvas.contextTop,i=this.canvas.viewportTransform,n=this._points[0],o=this._points[1];if(r.save(),r.transform(i[0],i[1],i[2],i[3],i[4],i[5]),r.beginPath(),2===this._points.length&&n.x===o.x&&n.y===o.y){var a=this.width/1e3;n=new fabric.Point(n.x,n.y),o=new fabric.Point(o.x,o.y),n.x-=a,o.x+=a}for(r.moveTo(n.x,n.y),t=1,e=this._points.length;e>t;t++){var s=n.midPointFrom(o);r.quadraticCurveTo(n.x,n.y,s.x,s.y),n=this._points[t],o=this._points[t+1]}r.lineTo(n.x,n.y),r.stroke(),r.restore()},convertPointsToSVGPath:function(t){var e,r=[],i=this.width/1e3,n=new fabric.Point(t[0].x,t[0].y),o=new fabric.Point(t[1].x,t[1].y),a=t.length,s=1,c=1,u=a>2;for(u&&(s=t[2].x<o.x?-1:t[2].x===o.x?0:1,c=t[2].y<o.y?-1:t[2].y===o.y?0:1),r.push("M ",n.x-s*i," ",n.y-c*i," "),e=1;a>e;e++){if(!n.eq(o)){var l=n.midPointFrom(o);r.push("Q ",n.x," ",n.y," ",l.x," ",l.y," ")}n=t[e],e+1<t.length&&(o=t[e+1])}return u&&(s=n.x>t[e-2].x?1:n.x===t[e-2].x?0:-1,c=n.y>t[e-2].y?1:n.y===t[e-2].y?0:-1),r.push("L ",n.x+s*i," ",n.y+c*i),r},createPath:function(t){var e=new fabric.Path(t,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray}),r=new fabric.Point(e.left+e.width/2,e.top+e.height/2);return r=e.translateToGivenOrigin(r,"center","center",e.originX,e.originY),e.top=r.y,e.left=r.x,this.shadow&&(this.shadow.affectStroke=!0,e.setShadow(this.shadow)),e},_finalizeAndAddPath:function(){var t=this.canvas.contextTop;t.closePath();var e=this.convertPointsToSVGPath(this._points).join("");if("M 0 0 Q 0 0 0 0 L 0 0"===e)return void this.canvas.requestRenderAll();var r=this.createPath(e);this.canvas.clearContext(this.canvas.contextTop),this.canvas.add(r),this.canvas.renderAll(),r.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:r})}})}();fabric.CircleBrush=fabric.util.createClass(fabric.BaseBrush,{width:10,initialize:function(t){this.canvas=t,this.points=[]},drawDot:function(t){var e=this.addPoint(t),r=this.canvas.contextTop,i=this.canvas.viewportTransform;r.save(),r.transform(i[0],i[1],i[2],i[3],i[4],i[5]),r.fillStyle=e.fill,r.beginPath(),r.arc(e.x,e.y,e.radius,0,2*Math.PI,!1),r.closePath(),r.fill(),r.restore()},onMouseDown:function(t){this.points.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.drawDot(t)},onMouseMove:function(t){this.drawDot(t)},onMouseUp:function(){var t,e,r=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;var i=[];for(t=0,e=this.points.length;e>t;t++){var n=this.points[t],o=new fabric.Circle({radius:n.radius,left:n.x,top:n.y,originX:"center",originY:"center",fill:n.fill});this.shadow&&o.setShadow(this.shadow),i.push(o)}var a=new fabric.Group(i,{originX:"center",originY:"center"});a.canvas=this.canvas,this.canvas.add(a),this.canvas.fire("path:created",{path:a}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=r,this.canvas.requestRenderAll()},addPoint:function(t){var e=new fabric.Point(t.x,t.y),r=fabric.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,i=new fabric.Color(this.color).setAlpha(fabric.util.getRandomInt(0,100)/100).toRgba();return e.radius=r,e.fill=i,this.points.push(e),e}});fabric.SprayBrush=fabric.util.createClass(fabric.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(t){this.canvas=t,this.sprayChunks=[]},onMouseDown:function(t){this.sprayChunks.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.addSprayChunk(t),this.render()},onMouseMove:function(t){this.addSprayChunk(t),this.render()},onMouseUp:function(){var t=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var e=[],r=0,i=this.sprayChunks.length;i>r;r++)for(var n=this.sprayChunks[r],o=0,a=n.length;a>o;o++){var s=new fabric.Rect({width:n[o].width,height:n[o].width,left:n[o].x+1,top:n[o].y+1,originX:"center",originY:"center",fill:this.color});this.shadow&&s.setShadow(this.shadow),e.push(s)}this.optimizeOverlapping&&(e=this._getOptimizedRects(e));var c=new fabric.Group(e,{originX:"center",originY:"center"});c.canvas=this.canvas,this.canvas.add(c),this.canvas.fire("path:created",{path:c}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=t,this.canvas.requestRenderAll()},_getOptimizedRects:function(t){var e,r,i,n={};for(r=0,i=t.length;i>r;r++)e=t[r].left+""+t[r].top,n[e]||(n[e]=t[r]);var o=[];for(e in n)o.push(n[e]);return o},render:function(){var t=this.canvas.contextTop;t.fillStyle=this.color;var e,r,i=this.canvas.viewportTransform;for(t.save(),t.transform(i[0],i[1],i[2],i[3],i[4],i[5]),e=0,r=this.sprayChunkPoints.length;r>e;e++){var n=this.sprayChunkPoints[e];"undefined"!=typeof n.opacity&&(t.globalAlpha=n.opacity),t.fillRect(n.x,n.y,n.width,n.width)}t.restore()},addSprayChunk:function(t){this.sprayChunkPoints=[];var e,r,i,n,o=this.width/2;for(n=0;n<this.density;n++){e=fabric.util.getRandomInt(t.x-o,t.x+o),r=fabric.util.getRandomInt(t.y-o,t.y+o),i=this.dotWidthVariance?fabric.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):this.dotWidth;var a=new fabric.Point(e,r);a.width=i,this.randomOpacity&&(a.opacity=fabric.util.getRandomInt(0,100)/100),this.sprayChunkPoints.push(a)}this.sprayChunks.push(this.sprayChunkPoints)}});fabric.PatternBrush=fabric.util.createClass(fabric.PencilBrush,{getPatternSrc:function(){var t=20,e=5,r=fabric.document.createElement("canvas"),i=r.getContext("2d");return r.width=r.height=t+e,i.fillStyle=this.color,i.beginPath(),i.arc(t/2,t/2,t/2,0,2*Math.PI,!1),i.closePath(),i.fill(),r},getPatternSrcFunction:function(){return String(this.getPatternSrc).replace("this.color",'"'+this.color+'"')},getPattern:function(){return this.canvas.contextTop.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(){this.callSuper("_setBrushStyles"),this.canvas.contextTop.strokeStyle=this.getPattern()},createPath:function(t){var e=this.callSuper("createPath",t),r=e._getLeftTopCoords().scalarAdd(e.strokeWidth/2);return e.stroke=new fabric.Pattern({source:this.source||this.getPatternSrcFunction(),offsetX:-r.x,offsetY:-r.y}),e}});!function(){var t=fabric.util.getPointer,e=fabric.util.degreesToRadians,i=fabric.util.radiansToDegrees,r=Math.atan2,n=Math.abs,s=fabric.StaticCanvas.supports("setLineDash"),o=.5;fabric.Canvas=fabric.util.createClass(fabric.StaticCanvas,{initialize:function(t,e){e||(e={}),this.renderAndResetBound=this.renderAndReset.bind(this),this._initStatic(t,e),this._initInteractive(),this._createCacheCanvas()},uniScaleTransform:!1,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",interactive:!0,selection:!0,selectionKey:"shiftKey",altSelectionKey:null,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",rotationCursor:"crosshair",notAllowedCursor:"not-allowed",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,isDrawingMode:!1,preserveObjectStacking:!1,snapAngle:0,snapThreshold:null,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,_initInteractive:function(){this._currentTransform=null,this._groupSelector=null,this._initWrapperElement(),this._createUpperCanvas(),this._initEventListeners(),this._initRetinaScaling(),this.freeDrawingBrush=fabric.PencilBrush&&new fabric.PencilBrush(this),this.calcOffset()},_chooseObjectsToRender:function(){var t,e,i,r=this.getActiveObjects();if(r.length>0&&!this.preserveObjectStacking){e=[],i=[];for(var n=0,s=this._objects.length;s>n;n++)t=this._objects[n],-1===r.indexOf(t)?e.push(t):i.push(t);r.length>1&&(this._activeObject._objects=i),e.push.apply(e,i)}else e=this._objects;return e},renderAll:function(){!this.contextTopDirty||this._groupSelector||this.isDrawingMode||(this.clearContext(this.contextTop),this.contextTopDirty=!1);var t=this.contextContainer;return this.renderCanvas(t,this._chooseObjectsToRender()),this},renderTop:function(){var t=this.contextTop;return this.clearContext(t),this.selection&&this._groupSelector&&this._drawSelection(t),this.fire("after:render"),this.contextTopDirty=!0,this},_resetCurrentTransform:function(){var t=this._currentTransform;t.target.set({scaleX:t.original.scaleX,scaleY:t.original.scaleY,skewX:t.original.skewX,skewY:t.original.skewY,left:t.original.left,top:t.original.top}),this._shouldCenterTransform(t.target)?"rotate"===t.action?this._setOriginToCenter(t.target):("center"!==t.originX&&(t.mouseXSign="right"===t.originX?-1:1),"center"!==t.originY&&(t.mouseYSign="bottom"===t.originY?-1:1),t.originX="center",t.originY="center"):(t.originX=t.original.originX,t.originY=t.original.originY)},containsPoint:function(t,e,i){var r,n=!0,s=i||this.getPointer(t,n);return r=e.group&&e.group===this._activeObject&&"activeSelection"===e.group.type?this._normalizePointer(e.group,s):{x:s.x,y:s.y},e.containsPoint(r)||e._findTargetCorner(s)},_normalizePointer:function(t,e){var i=t.calcTransformMatrix(),r=fabric.util.invertTransform(i),n=this.restorePointerVpt(e);return fabric.util.transformPoint(n,r)},isTargetTransparent:function(t,e,i){var r=this.contextCache,n=t.selectionBackgroundColor,s=this.viewportTransform;t.selectionBackgroundColor="",this.clearContext(r),r.save(),r.transform(s[0],s[1],s[2],s[3],s[4],s[5]),t.render(r),r.restore(),t===this._activeObject&&t._renderControls(r,{hasBorders:!1,transparentCorners:!1},{hasBorders:!1}),t.selectionBackgroundColor=n;var o=fabric.util.isTransparent(r,e,i,this.targetFindTolerance);return o},_isSelectionKeyPressed:function(t){var e=!1;return e="[object Array]"===Object.prototype.toString.call(this.selectionKey)?!!this.selectionKey.find(function(e){return t[e]===!0}):t[this.selectionKey]},_shouldClearSelection:function(t,e){var i=this.getActiveObjects(),r=this._activeObject;return!e||e&&r&&i.length>1&&-1===i.indexOf(e)&&r!==e&&!this._isSelectionKeyPressed(t)||e&&!e.evented||e&&!e.selectable&&r&&r!==e},_shouldCenterTransform:function(t){if(t){var e,i=this._currentTransform;return"scale"===i.action||"scaleX"===i.action||"scaleY"===i.action?e=this.centeredScaling||t.centeredScaling:"rotate"===i.action&&(e=this.centeredRotation||t.centeredRotation),e?!i.altKey:i.altKey}},_getOriginFromCorner:function(t,e){var i={x:t.originX,y:t.originY};return"ml"===e||"tl"===e||"bl"===e?i.x="right":("mr"===e||"tr"===e||"br"===e)&&(i.x="left"),"tl"===e||"mt"===e||"tr"===e?i.y="bottom":("bl"===e||"mb"===e||"br"===e)&&(i.y="top"),i},_getActionFromCorner:function(t,e,i){if(!e)return"drag";switch(e){case"mtr":return"rotate";case"ml":case"mr":return i[this.altActionKey]?"skewY":"scaleX";case"mt":case"mb":return i[this.altActionKey]?"skewX":"scaleY";default:return"scale"}},_setupCurrentTransform:function(t,i){if(i){var r=this.getPointer(t),n=i._findTargetCorner(this.getPointer(t,!0)),s=this._getActionFromCorner(i,n,t),o=this._getOriginFromCorner(i,n);this._currentTransform={target:i,action:s,corner:n,scaleX:i.scaleX,scaleY:i.scaleY,skewX:i.skewX,skewY:i.skewY,offsetX:r.x-i.left,offsetY:r.y-i.top,originX:o.x,originY:o.y,ex:r.x,ey:r.y,lastX:r.x,lastY:r.y,left:i.left,top:i.top,theta:e(i.angle),width:i.width*i.scaleX,mouseXSign:1,mouseYSign:1,shiftKey:t.shiftKey,altKey:t[this.centeredKey]},this._currentTransform.original={left:i.left,top:i.top,scaleX:i.scaleX,scaleY:i.scaleY,skewX:i.skewX,skewY:i.skewY,originX:o.x,originY:o.y},this._resetCurrentTransform()}},_translateObject:function(t,e){var i=this._currentTransform,r=i.target,n=t-i.offsetX,s=e-i.offsetY,o=!r.get("lockMovementX")&&r.left!==n,a=!r.get("lockMovementY")&&r.top!==s;return o&&r.set("left",n),a&&r.set("top",s),o||a},_changeSkewTransformOrigin:function(t,e,i){var r="originX",n={0:"center"},s=e.target.skewX,o="left",a="right",c="mt"===e.corner||"ml"===e.corner?1:-1,l=1;t=t>0?1:-1,"y"===i&&(s=e.target.skewY,o="top",a="bottom",r="originY"),n[-1]=o,n[1]=a,e.target.flipX&&(l*=-1),e.target.flipY&&(l*=-1),0===s?(e.skewSign=-c*t*l,e[r]=n[-t]):(s=s>0?1:-1,e.skewSign=s,e[r]=n[s*c*l])},_skewObject:function(t,e,i){var r=this._currentTransform,n=r.target,s=!1,o=n.get("lockSkewingX"),a=n.get("lockSkewingY");if(o&&"x"===i||a&&"y"===i)return!1;var c,l,u=n.getCenterPoint(),h=n.toLocalPoint(new fabric.Point(t,e),"center","center")[i],f=n.toLocalPoint(new fabric.Point(r.lastX,r.lastY),"center","center")[i],d=n._getTransformedDimensions();return this._changeSkewTransformOrigin(h-f,r,i),c=n.toLocalPoint(new fabric.Point(t,e),r.originX,r.originY)[i],l=n.translateToOriginPoint(u,r.originX,r.originY),s=this._setObjectSkew(c,r,i,d),r.lastX=t,r.lastY=e,n.setPositionByOrigin(l,r.originX,r.originY),s},_setObjectSkew:function(t,e,i,r){var n,s,o,a,c,l,u,h,f,d=e.target,p=!1,g=e.skewSign;return"x"===i?(a="y",c="Y",l="X",h=0,f=d.skewY):(a="x",c="X",l="Y",h=d.skewX,f=0),o=d._getTransformedDimensions(h,f),u=2*Math.abs(t)-o[i],2>=u?n=0:(n=g*Math.atan(u/d["scale"+l]/(o[a]/d["scale"+c])),n=fabric.util.radiansToDegrees(n)),p=d["skew"+l]!==n,d.set("skew"+l,n),0!==d["skew"+c]&&(s=d._getTransformedDimensions(),n=r[a]/s[a]*d["scale"+c],d.set("scale"+c,n)),p},_scaleObject:function(t,e,i){var r=this._currentTransform,n=r.target,s=n.get("lockScalingX"),o=n.get("lockScalingY"),a=n.get("lockScalingFlip");if(s&&o)return!1;var c=n.translateToOriginPoint(n.getCenterPoint(),r.originX,r.originY),l=n.toLocalPoint(new fabric.Point(t,e),r.originX,r.originY),u=n._getTransformedDimensions(),h=!1;return this._setLocalMouse(l,r),h=this._setObjectScale(l,r,s,o,i,a,u),n.setPositionByOrigin(c,r.originX,r.originY),h},_setObjectScale:function(t,e,i,r,n,s,o){var a,c,l,u,h=e.target,f=!1,d=!1,p=!1;return l=t.x*h.scaleX/o.x,u=t.y*h.scaleY/o.y,a=h.scaleX!==l,c=h.scaleY!==u,s&&0>=l&&l<h.scaleX&&(f=!0,t.x=0),s&&0>=u&&u<h.scaleY&&(d=!0,t.y=0),"equally"!==n||i||r?n?"x"!==n||h.get("lockUniScaling")?"y"!==n||h.get("lockUniScaling")||d||r||h.set("scaleY",u)&&(p=p||c):f||i||h.set("scaleX",l)&&(p=p||a):(f||i||h.set("scaleX",l)&&(p=p||a),d||r||h.set("scaleY",u)&&(p=p||c)):p=this._scaleObjectEqually(t,h,e,o),e.newScaleX=l,e.newScaleY=u,f||d||this._flipObject(e,n),p},_scaleObjectEqually:function(t,e,i,r){var n,s=t.y+t.x,o=r.y*i.original.scaleY/e.scaleY+r.x*i.original.scaleX/e.scaleX,a=t.x<0?-1:1,c=t.y<0?-1:1;return i.newScaleX=a*Math.abs(i.original.scaleX*s/o),i.newScaleY=c*Math.abs(i.original.scaleY*s/o),n=i.newScaleX!==e.scaleX||i.newScaleY!==e.scaleY,e.set("scaleX",i.newScaleX),e.set("scaleY",i.newScaleY),n},_flipObject:function(t,e){t.newScaleX<0&&"y"!==e&&("left"===t.originX?t.originX="right":"right"===t.originX&&(t.originX="left")),t.newScaleY<0&&"x"!==e&&("top"===t.originY?t.originY="bottom":"bottom"===t.originY&&(t.originY="top"))},_setLocalMouse:function(t,e){var i=e.target,r=this.getZoom(),s=i.padding/r;"right"===e.originX?t.x*=-1:"center"===e.originX&&(t.x*=2*e.mouseXSign,t.x<0&&(e.mouseXSign=-e.mouseXSign)),"bottom"===e.originY?t.y*=-1:"center"===e.originY&&(t.y*=2*e.mouseYSign,t.y<0&&(e.mouseYSign=-e.mouseYSign)),n(t.x)>s?t.x<0?t.x+=s:t.x-=s:t.x=0,n(t.y)>s?t.y<0?t.y+=s:t.y-=s:t.y=0},_rotateObject:function(t,e){var n=this._currentTransform;if(n.target.get("lockRotation"))return!1;var s=r(n.ey-n.top,n.ex-n.left),o=r(e-n.top,t-n.left),a=i(o-s+n.theta),c=!0;if(n.target.snapAngle>0){var l=n.target.snapAngle,u=n.target.snapThreshold||l,h=Math.ceil(a/l)*l,f=Math.floor(a/l)*l;Math.abs(a-f)<u?a=f:Math.abs(a-h)<u&&(a=h)}return 0>a&&(a=360+a),a%=360,n.target.angle===a?c=!1:n.target.angle=a,c},setCursor:function(t){this.upperCanvasEl.style.cursor=t},_resetObjectTransform:function(t){t.scaleX=1,t.scaleY=1,t.skewX=0,t.skewY=0,t.rotate(0)},_drawSelection:function(t){var e=this._groupSelector,i=e.left,r=e.top,a=n(i),c=n(r);if(this.selectionColor&&(t.fillStyle=this.selectionColor,t.fillRect(e.ex-(i>0?0:-i),e.ey-(r>0?0:-r),a,c)),this.selectionLineWidth&&this.selectionBorderColor)if(t.lineWidth=this.selectionLineWidth,t.strokeStyle=this.selectionBorderColor,this.selectionDashArray.length>1&&!s){var l=e.ex+o-(i>0?0:a),u=e.ey+o-(r>0?0:c);t.beginPath(),fabric.util.drawDashedLine(t,l,u,l+a,u,this.selectionDashArray),fabric.util.drawDashedLine(t,l,u+c-1,l+a,u+c-1,this.selectionDashArray),fabric.util.drawDashedLine(t,l,u,l,u+c,this.selectionDashArray),fabric.util.drawDashedLine(t,l+a-1,u,l+a-1,u+c,this.selectionDashArray),t.closePath(),t.stroke()}else fabric.Object.prototype._setLineDash.call(this,t,this.selectionDashArray),t.strokeRect(e.ex+o-(i>0?0:a),e.ey+o-(r>0?0:c),a,c)},findTarget:function(t,e){if(!this.skipTargetFind){var i,r,n=!0,s=this.getPointer(t,n),o=this._activeObject,a=this.getActiveObjects();if(this.targets=[],a.length>1&&!e&&o===this._searchPossibleTargets([o],s))return o;if(1===a.length&&o._findTargetCorner(s))return o;if(1===a.length&&o===this._searchPossibleTargets([o],s)){if(!this.preserveObjectStacking)return o;i=o,r=this.targets,this.targets=[]}var c=this._searchPossibleTargets(this._objects,s);return t[this.altSelectionKey]&&c&&i&&c!==i&&(c=i,this.targets=r),c}},_checkTarget:function(t,e){if(e&&e.visible&&e.evented&&this.containsPoint(null,e,t)){if(!this.perPixelTargetFind&&!e.perPixelTargetFind||e.isEditing)return!0;var i=this.isTargetTransparent(e,t.x,t.y);if(!i)return!0}},_searchPossibleTargets:function(t,e){for(var i,r,n,s=t.length;s--;)if(this._checkTarget(e,t[s])){i=t[s],"group"===i.type&&i.subTargetCheck&&(r=this._normalizePointer(i,e),n=this._searchPossibleTargets(i._objects,r),n&&this.targets.push(n));break}return i},restorePointerVpt:function(t){return fabric.util.transformPoint(t,fabric.util.invertTransform(this.viewportTransform))},getPointer:function(e,i,r){r||(r=this.upperCanvasEl);var n,s=t(e),o=r.getBoundingClientRect(),a=o.width||0,c=o.height||0;return a&&c||("top"in o&&"bottom"in o&&(c=Math.abs(o.top-o.bottom)),"right"in o&&"left"in o&&(a=Math.abs(o.right-o.left))),this.calcOffset(),s.x=s.x-this._offset.left,s.y=s.y-this._offset.top,i||(s=this.restorePointerVpt(s)),n=0===a||0===c?{width:1,height:1}:{width:r.width/a,height:r.height/c},{x:s.x*n.width,y:s.y*n.height}},_createUpperCanvas:function(){var t=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,"");this.upperCanvasEl?this.upperCanvasEl.className="":this.upperCanvasEl=this._createCanvasElement(),fabric.util.addClass(this.upperCanvasEl,"upper-canvas "+t),this.wrapperEl.appendChild(this.upperCanvasEl),this._copyCanvasStyle(this.lowerCanvasEl,this.upperCanvasEl),this._applyCanvasStyle(this.upperCanvasEl),this.contextTop=this.upperCanvasEl.getContext("2d")},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement(),this.cacheCanvasEl.setAttribute("width",this.width),this.cacheCanvasEl.setAttribute("height",this.height),this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=fabric.util.wrapElement(this.lowerCanvasEl,"div",{"class":this.containerClass}),fabric.util.setStyle(this.wrapperEl,{width:this.width+"px",height:this.height+"px",position:"relative"}),fabric.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(t){var e=this.width||t.width,i=this.height||t.height;fabric.util.setStyle(t,{position:"absolute",width:e+"px",height:i+"px",left:0,top:0,"touch-action":"none"}),t.width=e,t.height=i,fabric.util.makeElementUnselectable(t)},_copyCanvasStyle:function(t,e){e.style.cssText=t.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},getActiveObject:function(){return this._activeObject},getActiveObjects:function(){var t=this._activeObject;return t?"activeSelection"===t.type&&t._objects?t._objects.slice(0):[t]:[]},_onObjectRemoved:function(t){t===this._activeObject&&(this.fire("before:selection:cleared",{target:t}),this._discardActiveObject(),this.fire("selection:cleared",{target:t}),t.fire("deselected")),this._hoveredTarget===t&&(this._hoveredTarget=null),this.callSuper("_onObjectRemoved",t)},_fireSelectionEvents:function(t,e){var i=!1,r=this.getActiveObjects(),n=[],s=[],o={e:e};t.forEach(function(t){-1===r.indexOf(t)&&(i=!0,t.fire("deselected",o),s.push(t))}),r.forEach(function(e){-1===t.indexOf(e)&&(i=!0,e.fire("selected",o),n.push(e))}),t.length>0&&r.length>0?(o.selected=n,o.deselected=s,o.updated=n[0]||s[0],o.target=this._activeObject,i&&this.fire("selection:updated",o)):r.length>0?(1===r.length&&(o.target=n[0],this.fire("object:selected",o)),o.selected=n,o.target=this._activeObject,this.fire("selection:created",o)):t.length>0&&(o.deselected=s,this.fire("selection:cleared",o))},setActiveObject:function(t,e){var i=this.getActiveObjects();return this._setActiveObject(t,e),this._fireSelectionEvents(i,e),this},_setActiveObject:function(t,e){return this._activeObject===t?!1:this._discardActiveObject(e,t)?t.onSelect({e:e})?!1:(this._activeObject=t,!0):!1},_discardActiveObject:function(t,e){var i=this._activeObject;if(i){if(i.onDeselect({e:t,object:e}))return!1;this._activeObject=null}return!0},discardActiveObject:function(t){var e=this.getActiveObjects();return e.length&&this.fire("before:selection:cleared",{target:e[0],e:t}),this._discardActiveObject(t),this._fireSelectionEvents(e,t),this},dispose:function(){var t=this.wrapperEl;return this.removeListeners(),t.removeChild(this.upperCanvasEl),t.removeChild(this.lowerCanvasEl),delete this.upperCanvasEl,t.parentNode&&t.parentNode.replaceChild(this.lowerCanvasEl,this.wrapperEl),delete this.wrapperEl,fabric.StaticCanvas.prototype.dispose.call(this),this},clear:function(){return this.discardActiveObject(),this.clearContext(this.contextTop),this.callSuper("clear")},drawControls:function(t){var e=this._activeObject;e&&e._renderControls(t)},_toObject:function(t,e,i){var r=this._realizeGroupTransformOnObject(t),n=this.callSuper("_toObject",t,e,i);return this._unwindGroupTransformOnObject(t,r),n},_realizeGroupTransformOnObject:function(t){if(t.group&&"activeSelection"===t.group.type&&this._activeObject===t.group){var e=["angle","flipX","flipY","left","scaleX","scaleY","skewX","skewY","top"],i={};return e.forEach(function(e){i[e]=t[e]}),this._activeObject.realizeTransform(t),i}return null},_unwindGroupTransformOnObject:function(t,e){e&&t.set(e)},_setSVGObject:function(t,e,i){var r=this._realizeGroupTransformOnObject(e);this.callSuper("_setSVGObject",t,e,i),this._unwindGroupTransformOnObject(e,r)}});for(var a in fabric.StaticCanvas)"prototype"!==a&&(fabric.Canvas[a]=fabric.StaticCanvas[a]);fabric.isTouchSupported&&(fabric.Canvas.prototype._setCursorFromEvent=function(){})}();!function(){function t(t,e){return"which"in t?t.which===e:t.button===e-1}var e={mt:0,tr:1,mr:2,br:3,mb:4,bl:5,ml:6,tl:7},i=fabric.util.addListener,r=fabric.util.removeListener,n=3,o=2,s=1;fabric.util.object.extend(fabric.Canvas.prototype,{cursorMap:["n-resize","ne-resize","e-resize","se-resize","s-resize","sw-resize","w-resize","nw-resize"],_initEventListeners:function(){this.removeListeners(),this._bindEvents(),i(fabric.window,"resize",this._onResize),i(this.upperCanvasEl,"mousedown",this._onMouseDown),i(this.upperCanvasEl,"dblclick",this._onDoubleClick),i(this.upperCanvasEl,"mousemove",this._onMouseMove),i(this.upperCanvasEl,"mouseout",this._onMouseOut),i(this.upperCanvasEl,"mouseenter",this._onMouseEnter),i(this.upperCanvasEl,"wheel",this._onMouseWheel),i(this.upperCanvasEl,"contextmenu",this._onContextMenu),i(this.upperCanvasEl,"touchstart",this._onMouseDown,{passive:!1}),i(this.upperCanvasEl,"touchmove",this._onMouseMove,{passive:!1}),"undefined"!=typeof eventjs&&"add"in eventjs&&(eventjs.add(this.upperCanvasEl,"gesture",this._onGesture),eventjs.add(this.upperCanvasEl,"drag",this._onDrag),eventjs.add(this.upperCanvasEl,"orientation",this._onOrientationChange),eventjs.add(this.upperCanvasEl,"shake",this._onShake),eventjs.add(this.upperCanvasEl,"longpress",this._onLongPress))},_bindEvents:function(){this.eventsBinded||(this._onMouseDown=this._onMouseDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onResize=this._onResize.bind(this),this._onGesture=this._onGesture.bind(this),this._onDrag=this._onDrag.bind(this),this._onShake=this._onShake.bind(this),this._onLongPress=this._onLongPress.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._onMouseWheel=this._onMouseWheel.bind(this),this._onMouseOut=this._onMouseOut.bind(this),this._onMouseEnter=this._onMouseEnter.bind(this),this._onContextMenu=this._onContextMenu.bind(this),this._onDoubleClick=this._onDoubleClick.bind(this),this.eventsBinded=!0)},removeListeners:function(){r(fabric.window,"resize",this._onResize),r(this.upperCanvasEl,"mousedown",this._onMouseDown),r(this.upperCanvasEl,"mousemove",this._onMouseMove),r(this.upperCanvasEl,"mouseout",this._onMouseOut),r(this.upperCanvasEl,"mouseenter",this._onMouseEnter),r(this.upperCanvasEl,"wheel",this._onMouseWheel),r(this.upperCanvasEl,"contextmenu",this._onContextMenu),r(this.upperCanvasEl,"doubleclick",this._onDoubleClick),r(this.upperCanvasEl,"touchstart",this._onMouseDown),r(this.upperCanvasEl,"touchmove",this._onMouseMove),"undefined"!=typeof eventjs&&"remove"in eventjs&&(eventjs.remove(this.upperCanvasEl,"gesture",this._onGesture),eventjs.remove(this.upperCanvasEl,"drag",this._onDrag),eventjs.remove(this.upperCanvasEl,"orientation",this._onOrientationChange),eventjs.remove(this.upperCanvasEl,"shake",this._onShake),eventjs.remove(this.upperCanvasEl,"longpress",this._onLongPress))},_onGesture:function(t,e){this.__onTransformGesture&&this.__onTransformGesture(t,e)},_onDrag:function(t,e){this.__onDrag&&this.__onDrag(t,e)},_onMouseWheel:function(t){this.__onMouseWheel(t)},_onMouseOut:function(t){var e=this._hoveredTarget;this.fire("mouse:out",{target:e,e:t}),this._hoveredTarget=null,e&&e.fire("mouseout",{e:t}),this._iTextInstances&&this._iTextInstances.forEach(function(t){t.isEditing&&t.hiddenTextarea.focus()})},_onMouseEnter:function(t){this.findTarget(t)||(this.fire("mouse:over",{target:null,e:t}),this._hoveredTarget=null)},_onOrientationChange:function(t,e){this.__onOrientationChange&&this.__onOrientationChange(t,e)},_onShake:function(t,e){this.__onShake&&this.__onShake(t,e)},_onLongPress:function(t,e){this.__onLongPress&&this.__onLongPress(t,e)},_onContextMenu:function(t){return this.stopContextMenu&&(t.stopPropagation(),t.preventDefault()),!1},_onDoubleClick:function(t){var e;this._handleEvent(t,"dblclick",e)},_onMouseDown:function(t){this.__onMouseDown(t),i(fabric.document,"touchend",this._onMouseUp,{passive:!1}),i(fabric.document,"touchmove",this._onMouseMove,{passive:!1}),r(this.upperCanvasEl,"mousemove",this._onMouseMove),r(this.upperCanvasEl,"touchmove",this._onMouseMove),"touchstart"===t.type?r(this.upperCanvasEl,"mousedown",this._onMouseDown):(i(fabric.document,"mouseup",this._onMouseUp),i(fabric.document,"mousemove",this._onMouseMove))},_onMouseUp:function(t){if(this.__onMouseUp(t),r(fabric.document,"mouseup",this._onMouseUp),r(fabric.document,"touchend",this._onMouseUp),r(fabric.document,"mousemove",this._onMouseMove),r(fabric.document,"touchmove",this._onMouseMove),i(this.upperCanvasEl,"mousemove",this._onMouseMove),i(this.upperCanvasEl,"touchmove",this._onMouseMove,{passive:!1}),"touchend"===t.type){var e=this;setTimeout(function(){i(e.upperCanvasEl,"mousedown",e._onMouseDown)},400)}},_onMouseMove:function(t){!this.allowTouchScrolling&&t.preventDefault&&t.preventDefault(),this.__onMouseMove(t)},_onResize:function(){this.calcOffset()},_shouldRender:function(t,e){var i=this._activeObject;return i&&i.isEditing&&t===i?!1:!!(t&&(t.isMoving||t!==i)||!t&&i||!t&&!i&&!this._groupSelector||e&&this._previousPointer&&this.selection&&(e.x!==this._previousPointer.x||e.y!==this._previousPointer.y))},__onMouseUp:function(e){var i,r=!0,a=this._currentTransform,c=this._groupSelector,u=!c||0===c.left&&0===c.top;if(t(e,n))return void(this.fireRightClick&&this._handleEvent(e,"up",i,n,u));if(t(e,o))return void(this.fireMiddleClick&&this._handleEvent(e,"up",i,o,u));if(this.isDrawingMode&&this._isCurrentlyDrawing)return void this._onMouseUpInDrawingMode(e);a&&(this._finalizeCurrentTransform(e),r=!a.actionPerformed),i=r?this.findTarget(e,!0):a.target;var h=this._shouldRender(i,this.getPointer(e));i||!u?this._maybeGroupObjects(e):(this._groupSelector=null,this._currentTransform=null),i&&(i.isMoving=!1),this._setCursorFromEvent(e,i),this._handleEvent(e,"up",i?i:null,s,u),i&&(i.__corner=0),h&&this.requestRenderAll()},_handleEvent:function(t,e,i,r,n){var o="undefined"==typeof i?this.findTarget(t):i,a=this.targets||[],c={e:t,target:o,subTargets:a,button:r||s,isClick:n||!1};this.fire("mouse:"+e,c),o&&o.fire("mouse"+e,c);for(var u=0;u<a.length;u++)a[u].fire("mouse"+e,c)},_finalizeCurrentTransform:function(t){var e=this._currentTransform,i=e.target;i._scaling&&(i._scaling=!1),i.setCoords(),this._restoreOriginXY(i),(e.actionPerformed||this.stateful&&i.hasStateChanged())&&(this.fire("object:modified",{target:i,e:t}),i.fire("modified",{e:t}))},_restoreOriginXY:function(t){if(this._previousOriginX&&this._previousOriginY){var e=t.translateToOriginPoint(t.getCenterPoint(),this._previousOriginX,this._previousOriginY);t.originX=this._previousOriginX,t.originY=this._previousOriginY,t.left=e.x,t.top=e.y,this._previousOriginX=null,this._previousOriginY=null}},_onMouseDownInDrawingMode:function(t){this._isCurrentlyDrawing=!0,this.discardActiveObject(t).requestRenderAll(),this.clipTo&&fabric.util.clipContext(this,this.contextTop);var e=this.getPointer(t);this.freeDrawingBrush.onMouseDown(e),this._handleEvent(t,"down")},_onMouseMoveInDrawingMode:function(t){if(this._isCurrentlyDrawing){var e=this.getPointer(t);this.freeDrawingBrush.onMouseMove(e)}this.setCursor(this.freeDrawingCursor),this._handleEvent(t,"move")},_onMouseUpInDrawingMode:function(t){this._isCurrentlyDrawing=!1,this.clipTo&&this.contextTop.restore(),this.freeDrawingBrush.onMouseUp(),this._handleEvent(t,"up")},__onMouseDown:function(e){var i=this.findTarget(e);if(t(e,n))return void(this.fireRightClick&&this._handleEvent(e,"down",i?i:null,n));if(t(e,o))return void(this.fireMiddleClick&&this._handleEvent(e,"down",i?i:null,o));if(this.isDrawingMode)return void this._onMouseDownInDrawingMode(e);if(!this._currentTransform){var r=this.getPointer(e,!0);this._previousPointer=r;var s=this._shouldRender(i,r),a=this._shouldGroup(e,i);this._shouldClearSelection(e,i)?this.discardActiveObject(e):a&&(this._handleGrouping(e,i),i=this._activeObject),!this.selection||i&&(i.selectable||i.isEditing||i===this._activeObject)||(this._groupSelector={ex:r.x,ey:r.y,top:0,left:0}),i&&(i.selectable&&this.setActiveObject(i,e),i!==this._activeObject||!i.__corner&&a||(this._beforeTransform(e,i),this._setupCurrentTransform(e,i))),this._handleEvent(e,"down",i?i:null),s&&this.requestRenderAll()}},_beforeTransform:function(t,e){this.stateful&&e.saveState(),e._findTargetCorner(this.getPointer(t))&&this.onBeforeScaleRotate(e)},_setOriginToCenter:function(t){this._previousOriginX=this._currentTransform.target.originX,this._previousOriginY=this._currentTransform.target.originY;var e=t.getCenterPoint();t.originX="center",t.originY="center",t.left=e.x,t.top=e.y,this._currentTransform.left=t.left,this._currentTransform.top=t.top},_setCenterToOrigin:function(t){var e=t.translateToOriginPoint(t.getCenterPoint(),this._previousOriginX,this._previousOriginY);t.originX=this._previousOriginX,t.originY=this._previousOriginY,t.left=e.x,t.top=e.y,this._previousOriginX=null,this._previousOriginY=null},__onMouseMove:function(t){var e,i;if(this.isDrawingMode)return void this._onMouseMoveInDrawingMode(t);if(!("undefined"!=typeof t.touches&&t.touches.length>1)){var r=this._groupSelector;r?(i=this.getPointer(t,!0),r.left=i.x-r.ex,r.top=i.y-r.ey,this.renderTop()):this._currentTransform?this._transformObject(t):(e=this.findTarget(t),this._setCursorFromEvent(t,e),this._fireOverOutEvents(e,t)),this._handleEvent(t,"move",this._currentTransform?null:e)}},_fireOverOutEvents:function(t,e){var i,r,n=this._hoveredTarget;n!==t&&(i={e:e,target:t,previousTarget:this._hoveredTarget},r={e:e,target:this._hoveredTarget,nextTarget:t},this._hoveredTarget=t),t?n!==t&&(n&&(this.fire("mouse:out",r),n.fire("mouseout",r)),this.fire("mouse:over",i),t.fire("mouseover",i)):n&&(this.fire("mouse:out",r),n.fire("mouseout",r))},__onMouseWheel:function(t){this._handleEvent(t,"wheel")},_transformObject:function(t){var e=this.getPointer(t),i=this._currentTransform;i.reset=!1,i.target.isMoving=!0,i.shiftKey=t.shiftKey,i.altKey=t[this.centeredKey],this._beforeScaleTransform(t,i),this._performTransformAction(t,i,e),i.actionPerformed&&this.requestRenderAll()},_performTransformAction:function(t,e,i){var r=i.x,n=i.y,o=e.target,s=e.action,a=!1;"rotate"===s?(a=this._rotateObject(r,n))&&this._fire("rotating",o,t):"scale"===s?(a=this._onScale(t,e,r,n))&&this._fire("scaling",o,t):"scaleX"===s?(a=this._scaleObject(r,n,"x"))&&this._fire("scaling",o,t):"scaleY"===s?(a=this._scaleObject(r,n,"y"))&&this._fire("scaling",o,t):"skewX"===s?(a=this._skewObject(r,n,"x"))&&this._fire("skewing",o,t):"skewY"===s?(a=this._skewObject(r,n,"y"))&&this._fire("skewing",o,t):(a=this._translateObject(r,n),a&&(this._fire("moving",o,t),this.setCursor(o.moveCursor||this.moveCursor))),e.actionPerformed=e.actionPerformed||a},_fire:function(t,e,i){this.fire("object:"+t,{target:e,e:i}),e.fire(t,{e:i})},_beforeScaleTransform:function(t,e){if("scale"===e.action||"scaleX"===e.action||"scaleY"===e.action){var i=this._shouldCenterTransform(e.target);(i&&("center"!==e.originX||"center"!==e.originY)||!i&&"center"===e.originX&&"center"===e.originY)&&(this._resetCurrentTransform(),e.reset=!0)}},_onScale:function(t,e,i,r){return this._isUniscalePossible(t,e.target)?(e.currentAction="scale",this._scaleObject(i,r)):(e.reset||"scale"!==e.currentAction||this._resetCurrentTransform(),e.currentAction="scaleEqually",this._scaleObject(i,r,"equally"))},_isUniscalePossible:function(t,e){return(t[this.uniScaleKey]||this.uniScaleTransform)&&!e.get("lockUniScaling")},_setCursorFromEvent:function(t,e){if(!e)return this.setCursor(this.defaultCursor),!1;var i=e.hoverCursor||this.hoverCursor,r=this._activeObject&&"activeSelection"===this._activeObject.type?this._activeObject:null,n=(!r||!r.contains(e))&&e._findTargetCorner(this.getPointer(t,!0));this.setCursor(n?this.getCornerCursor(n,e,t):i)},getCornerCursor:function(t,i,r){return this.actionIsDisabled(t,i,r)?this.notAllowedCursor:t in e?this._getRotatedCornerCursor(t,i,r):"mtr"===t&&i.hasRotatingPoint?this.rotationCursor:this.defaultCursor},actionIsDisabled:function(t,e,i){return"mt"===t||"mb"===t?i[this.altActionKey]?e.lockSkewingX:e.lockScalingY:"ml"===t||"mr"===t?i[this.altActionKey]?e.lockSkewingY:e.lockScalingX:"mtr"===t?e.lockRotation:this._isUniscalePossible(i,e)?e.lockScalingX&&e.lockScalingY:e.lockScalingX||e.lockScalingY},_getRotatedCornerCursor:function(t,i,r){var n=Math.round(i.angle%360/45);return 0>n&&(n+=8),n+=e[t],r[this.altActionKey]&&e[t]%2===0&&(n+=2),n%=8,this.cursorMap[n]}})}();!function(){var t=Math.min,e=Math.max;fabric.util.object.extend(fabric.Canvas.prototype,{_shouldGroup:function(t,e){var i=this._activeObject;return i&&this._isSelectionKeyPressed(t)&&e&&e.selectable&&this.selection&&(i!==e||"activeSelection"===i.type)},_handleGrouping:function(t,e){var i=this._activeObject;i.__corner||(e!==i||(e=this.findTarget(t,!0)))&&(i&&"activeSelection"===i.type?this._updateActiveSelection(e,t):this._createActiveSelection(e,t))},_updateActiveSelection:function(t,e){var i=this._activeObject,r=i._objects.slice(0);i.contains(t)?(i.removeWithUpdate(t),this._hoveredTarget=t,1===i.size()&&this._setActiveObject(i.item(0),e)):(i.addWithUpdate(t),this._hoveredTarget=i),this._fireSelectionEvents(r,e)},_createActiveSelection:function(t,e){var i=this.getActiveObjects(),r=this._createGroup(t);this._hoveredTarget=r,this._setActiveObject(r,e),this._fireSelectionEvents(i,e)},_createGroup:function(t){var e=this.getObjects(),i=e.indexOf(this._activeObject)<e.indexOf(t),r=i?[this._activeObject,t]:[t,this._activeObject];return this._activeObject.isEditing&&this._activeObject.exitEditing(),new fabric.ActiveSelection(r,{canvas:this})},_groupSelectedObjects:function(t){var e,i=this._collectObjects();1===i.length?this.setActiveObject(i[0],t):i.length>1&&(e=new fabric.ActiveSelection(i.reverse(),{canvas:this}),this.setActiveObject(e,t))},_collectObjects:function(){for(var i,r=[],n=this._groupSelector.ex,s=this._groupSelector.ey,o=n+this._groupSelector.left,a=s+this._groupSelector.top,c=new fabric.Point(t(n,o),t(s,a)),l=new fabric.Point(e(n,o),e(s,a)),u=n===o&&s===a,h=this._objects.length;h--&&(i=this._objects[h],!(i&&i.selectable&&i.visible&&(i.intersectsWithRect(c,l)||i.isContainedWithinRect(c,l)||i.containsPoint(c)||i.containsPoint(l))&&(r.push(i),u))););return r},_maybeGroupObjects:function(t){this.selection&&this._groupSelector&&this._groupSelectedObjects(t),this.setCursor(this.defaultCursor),this._groupSelector=null,this._currentTransform=null}})}();!function(){var t=fabric.StaticCanvas.supports("toDataURLWithQuality");fabric.util.object.extend(fabric.StaticCanvas.prototype,{toDataURL:function(t){t||(t={});var e=t.format||"png",i=t.quality||1,r=t.multiplier||1,n={left:t.left||0,top:t.top||0,width:t.width||0,height:t.height||0};return this.__toDataURLWithMultiplier(e,i,n,r)},__toDataURLWithMultiplier:function(t,e,i,r){var n=this.width,s=this.height,o=(i.width||this.width)*r,a=(i.height||this.height)*r,c=this.getZoom(),l=c*r,h=this.viewportTransform,u=(h[4]-i.left)*r,f=(h[5]-i.top)*r,d=[l,0,0,l,u,f],p=this.interactive,g=this.skipOffscreen,v=n!==o||s!==a;this.viewportTransform=d,this.skipOffscreen=!1,this.interactive=!1,v&&this.setDimensions({width:o,height:a},{backstoreOnly:!0}),this.renderAll();var b=this.__toDataURL(t,e,i);return this.interactive=p,this.skipOffscreen=g,this.viewportTransform=h,v&&this.setDimensions({width:n,height:s},{backstoreOnly:!0}),this.renderAll(),b},__toDataURL:function(e,i){var r=this.contextContainer.canvas;"jpg"===e&&(e="jpeg");var n=t?r.toDataURL("image/"+e,i):r.toDataURL("image/"+e);return n}})}();fabric.util.object.extend(fabric.StaticCanvas.prototype,{loadFromDatalessJSON:function(t,e,i){return this.loadFromJSON(t,e,i)},loadFromJSON:function(t,e,i){if(t){var r="string"==typeof t?JSON.parse(t):fabric.util.object.clone(t),n=this,s=this.renderOnAddRemove;return this.renderOnAddRemove=!1,this._enlivenObjects(r.objects,function(t){n.clear(),n._setBgOverlay(r,function(){t.forEach(function(t,e){n.insertAt(t,e)}),n.renderOnAddRemove=s,delete r.objects,delete r.backgroundImage,delete r.overlayImage,delete r.background,delete r.overlay,n._setOptions(r),n.renderAll(),e&&e()})},i),this}},_setBgOverlay:function(t,e){var i={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};if(!(t.backgroundImage||t.overlayImage||t.background||t.overlay))return void(e&&e());var r=function(){i.backgroundImage&&i.overlayImage&&i.backgroundColor&&i.overlayColor&&e&&e()};this.__setBgOverlay("backgroundImage",t.backgroundImage,i,r),this.__setBgOverlay("overlayImage",t.overlayImage,i,r),this.__setBgOverlay("backgroundColor",t.background,i,r),this.__setBgOverlay("overlayColor",t.overlay,i,r)},__setBgOverlay:function(t,e,i,r){var n=this;return e?void("backgroundImage"===t||"overlayImage"===t?fabric.util.enlivenObjects([e],function(e){n[t]=e[0],i[t]=!0,r&&r()}):this["set"+fabric.util.string.capitalize(t,!0)](e,function(){i[t]=!0,r&&r()})):(i[t]=!0,void(r&&r()))},_enlivenObjects:function(t,e,i){return t&&0!==t.length?void fabric.util.enlivenObjects(t,function(t){e&&e(t)},null,i):void(e&&e([]))},_toDataURL:function(t,e){this.clone(function(i){e(i.toDataURL(t))})},_toDataURLWithMultiplier:function(t,e,i){this.clone(function(r){i(r.toDataURLWithMultiplier(t,e))})},clone:function(t,e){var i=JSON.stringify(this.toJSON(e));this.cloneWithoutData(function(e){e.loadFromJSON(i,function(){t&&t(e)})})},cloneWithoutData:function(t){var e=fabric.document.createElement("canvas");e.width=this.width,e.height=this.height;var i=new fabric.Canvas(e);i.clipTo=this.clipTo,this.backgroundImage?(i.setBackgroundImage(this.backgroundImage.src,function(){i.renderAll(),t&&t(i)}),i.backgroundImageOpacity=this.backgroundImageOpacity,i.backgroundImageStretch=this.backgroundImageStretch):t&&t(i)}});!function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,r=e.util.object.clone,n=e.util.toFixed,s=e.util.string.capitalize,o=e.util.degreesToRadians,a=e.StaticCanvas.supports("setLineDash"),c=!e.isLikelyNode,h=2;e.Object||(e.Object=e.util.createClass(e.CommonMethods,{type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,skewX:0,skewY:0,cornerSize:13,transparentCorners:!0,hoverCursor:null,moveCursor:null,padding:0,borderColor:"rgba(102,153,255,0.75)",borderDashArray:null,cornerColor:"rgba(102,153,255,0.5)",cornerStrokeColor:null,cornerStyle:"rect",cornerDashArray:null,centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",selectionBackgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:10,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,transformMatrix:null,minScaleLimit:0,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,hasRotatingPoint:!0,rotatingPointOffset:40,perPixelTargetFind:!1,includeDefaultValues:!0,clipTo:null,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockUniScaling:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,excludeFromExport:!1,objectCaching:c,statefullCache:!1,noScaleCache:!0,dirty:!0,__corner:0,paintFirst:"fill",stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeLineJoin strokeMiterLimit angle opacity fill globalCompositeOperation shadow clipTo visible backgroundColor skewX skewY fillRule paintFirst".split(" "),cacheProperties:"fill stroke strokeWidth strokeDashArray width height paintFirst strokeLineCap strokeLineJoin strokeMiterLimit backgroundColor".split(" "),initialize:function(t){t&&this.setOptions(t)},_createCacheCanvas:function(){this._cacheProperties={},this._cacheCanvas=e.document.createElement("canvas"),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas()},_limitCacheSize:function(t){var i=e.perfLimitSizeTotal,r=t.width,n=t.height,s=e.maxCacheSideLimit,o=e.minCacheSideLimit;if(s>=r&&s>=n&&i>=r*n)return o>r&&(t.width=o),o>n&&(t.height=o),t;var a=r/n,c=e.util.limitDimsByArea(a,i),h=e.util.capValue,l=h(o,c.x,s),u=h(o,c.y,s);return r>l&&(t.zoomX/=r/l,t.width=l,t.capped=!0),n>u&&(t.zoomY/=n/u,t.height=u,t.capped=!0),t},_getCacheCanvasDimensions:function(){var t=this.canvas&&this.canvas.getZoom()||1,i=this.getObjectScaling(),r=this.canvas&&this.canvas._isRetinaScaling()?e.devicePixelRatio:1,n=this._getNonTransformedDimensions(),s=i.scaleX*t*r,o=i.scaleY*t*r,a=n.x*s,c=n.y*o;return{width:a+h,height:c+h,zoomX:s,zoomY:o,x:n.x,y:n.y}},_updateCacheCanvas:function(){if(this.noScaleCache&&this.canvas&&this.canvas._currentTransform){var t=this.canvas._currentTransform.target,i=this.canvas._currentTransform.action;if(this===t&&i.slice&&"scale"===i.slice(0,5))return!1}var r,n,s=this._cacheCanvas,o=this._limitCacheSize(this._getCacheCanvasDimensions()),a=e.minCacheSideLimit,c=o.width,h=o.height,l=o.zoomX,u=o.zoomY,f=c!==this.cacheWidth||h!==this.cacheHeight,d=this.zoomX!==l||this.zoomY!==u,p=f||d,g=0,v=0,b=!1;if(f){var m=this._cacheCanvas.width,y=this._cacheCanvas.height,_=c>m||h>y,w=(.9*m>c||.9*y>h)&&m>a&&y>a;b=_||w,_&&!o.capped&&(c>a||h>a)&&(g=.1*c,v=.1*h)}return p?(b?(s.width=Math.ceil(c+g),s.height=Math.ceil(h+v)):(this._cacheContext.setTransform(1,0,0,1,0,0),this._cacheContext.clearRect(0,0,s.width,s.height)),r=o.x*l/2,n=o.y*u/2,this.cacheTranslationX=Math.round(s.width/2-r)+r,this.cacheTranslationY=Math.round(s.height/2-n)+n,this.cacheWidth=c,this.cacheHeight=h,this._cacheContext.translate(this.cacheTranslationX,this.cacheTranslationY),this._cacheContext.scale(l,u),this.zoomX=l,this.zoomY=u,!0):!1},setOptions:function(t){this._setOptions(t),this._initGradient(t.fill,"fill"),this._initGradient(t.stroke,"stroke"),this._initClipping(t),this._initPattern(t.fill,"fill"),this._initPattern(t.stroke,"stroke")},transform:function(t){var e;e=this.group&&!this.group._transformDone?this.calcTransformMatrix():this.calcOwnMatrix(),t.transform(e[0],e[1],e[2],e[3],e[4],e[5])},toObject:function(t){var i=e.Object.NUM_FRACTION_DIGITS,r={type:this.type,version:e.version,originX:this.originX,originY:this.originY,left:n(this.left,i),top:n(this.top,i),width:n(this.width,i),height:n(this.height,i),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:n(this.strokeWidth,i),strokeDashArray:this.strokeDashArray?this.strokeDashArray.concat():this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeMiterLimit:n(this.strokeMiterLimit,i),scaleX:n(this.scaleX,i),scaleY:n(this.scaleY,i),angle:n(this.angle,i),flipX:this.flipX,flipY:this.flipY,opacity:n(this.opacity,i),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,clipTo:this.clipTo&&String(this.clipTo),backgroundColor:this.backgroundColor,fillRule:this.fillRule,paintFirst:this.paintFirst,globalCompositeOperation:this.globalCompositeOperation,transformMatrix:this.transformMatrix?this.transformMatrix.concat():null,skewX:n(this.skewX,i),skewY:n(this.skewY,i)};return e.util.populateWithProperties(this,r,t),this.includeDefaultValues||(r=this._removeDefaultValues(r)),r},toDatalessObject:function(t){return this.toObject(t)},_removeDefaultValues:function(t){var i=e.util.getKlass(t.type).prototype,r=i.stateProperties;return r.forEach(function(e){t[e]===i[e]&&delete t[e];var r="[object Array]"===Object.prototype.toString.call(t[e])&&"[object Array]"===Object.prototype.toString.call(i[e]);r&&0===t[e].length&&0===i[e].length&&delete t[e]}),t},toString:function(){return"#<fabric."+s(this.type)+">"},getObjectScaling:function(){var t=this.scaleX,e=this.scaleY;if(this.group){var i=this.group.getObjectScaling();t*=i.scaleX,e*=i.scaleY}return{scaleX:t,scaleY:e}},getObjectOpacity:function(){var t=this.opacity;return this.group&&(t*=this.group.getObjectOpacity()),t},_set:function(t,i){var r="scaleX"===t||"scaleY"===t,n=this[t]!==i,s=!1;return r&&(i=this._constrainScale(i)),"scaleX"===t&&0>i?(this.flipX=!this.flipX,i*=-1):"scaleY"===t&&0>i?(this.flipY=!this.flipY,i*=-1):"shadow"!==t||!i||i instanceof e.Shadow?"dirty"===t&&this.group&&this.group.set("dirty",i):i=new e.Shadow(i),this[t]=i,n&&(s=this.group&&this.group.isOnACache(),this.cacheProperties.indexOf(t)>-1?(this.dirty=!0,s&&this.group.set("dirty",!0)):s&&this.stateProperties.indexOf(t)>-1&&this.group.set("dirty",!0)),this},setOnGroup:function(){},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:e.iMatrix.concat()},isNotVisible:function(){return 0===this.opacity||0===this.width&&0===this.height||!this.visible},render:function(t){this.isNotVisible()||(!this.canvas||!this.canvas.skipOffscreen||this.group||this.isOnScreen())&&(t.save(),this._setupCompositeOperation(t),this.drawSelectionBackground(t),this.transform(t),this._setOpacity(t),this._setShadow(t,this),this.transformMatrix&&t.transform.apply(t,this.transformMatrix),this.clipTo&&e.util.clipContext(this,t),this.shouldCache()?(this._cacheCanvas||this._createCacheCanvas(),this.isCacheDirty()&&(this.statefullCache&&this.saveState({propertySet:"cacheProperties"}),this.drawObject(this._cacheContext),this.dirty=!1),this.drawCacheOnCanvas(t)):(this._removeCacheCanvas(),this.dirty=!1,this.drawObject(t),this.objectCaching&&this.statefullCache&&this.saveState({propertySet:"cacheProperties"})),this.clipTo&&t.restore(),t.restore())},_removeCacheCanvas:function(){this._cacheCanvas=null,this.cacheWidth=0,this.cacheHeight=0},needsItsOwnCache:function(){return"stroke"===this.paintFirst&&"object"==typeof this.shadow?!0:!1},shouldCache:function(){return this.ownCaching=this.objectCaching&&(!this.group||this.needsItsOwnCache()||!this.group.isOnACache()),this.ownCaching},willDrawShadow:function(){return!!this.shadow&&(0!==this.shadow.offsetX||0!==this.shadow.offsetY)},drawObject:function(t){this._renderBackground(t),this._setStrokeStyles(t,this),this._setFillStyles(t,this),this._render(t)},drawCacheOnCanvas:function(t){t.scale(1/this.zoomX,1/this.zoomY),t.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)},isCacheDirty:function(t){if(this.isNotVisible())return!1;if(this._cacheCanvas&&!t&&this._updateCacheCanvas())return!0;if(this.dirty||this.statefullCache&&this.hasStateChanged("cacheProperties")){if(this._cacheCanvas&&!t){var e=this.cacheWidth/this.zoomX,i=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-e/2,-i/2,e,i)}return!0}return!1},_renderBackground:function(t){if(this.backgroundColor){var e=this._getNonTransformedDimensions();t.fillStyle=this.backgroundColor,t.fillRect(-e.x/2,-e.y/2,e.x,e.y),this._removeShadow(t)}},_setOpacity:function(t){this.group&&!this.group._transformDone?t.globalAlpha=this.getObjectOpacity():t.globalAlpha*=this.opacity},_setStrokeStyles:function(t,e){e.stroke&&(t.lineWidth=e.strokeWidth,t.lineCap=e.strokeLineCap,t.lineJoin=e.strokeLineJoin,t.miterLimit=e.strokeMiterLimit,t.strokeStyle=e.stroke.toLive?e.stroke.toLive(t,this):e.stroke)},_setFillStyles:function(t,e){e.fill&&(t.fillStyle=e.fill.toLive?e.fill.toLive(t,this):e.fill)},_setLineDash:function(t,e,i){e&&(1&e.length&&e.push.apply(e,e),a?t.setLineDash(e):i&&i(t))},_renderControls:function(t,i){var r,n,s,a=this.getViewportTransform(),c=this.calcTransformMatrix();i=i||{},n="undefined"!=typeof i.hasBorders?i.hasBorders:this.hasBorders,s="undefined"!=typeof i.hasControls?i.hasControls:this.hasControls,c=e.util.multiplyTransformMatrices(a,c),r=e.util.qrDecompose(c),t.save(),t.translate(r.translateX,r.translateY),t.lineWidth=1*this.borderScaleFactor,this.group||(t.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),i.forActiveSelection?(t.rotate(o(r.angle)),n&&this.drawBordersInGroup(t,r,i)):(t.rotate(o(this.angle)),n&&this.drawBorders(t,i)),s&&this.drawControls(t,i),t.restore()},_setShadow:function(t){if(this.shadow){var i=this.canvas&&this.canvas.viewportTransform[0]||1,r=this.canvas&&this.canvas.viewportTransform[3]||1,n=this.getObjectScaling();this.canvas&&this.canvas._isRetinaScaling()&&(i*=e.devicePixelRatio,r*=e.devicePixelRatio),t.shadowColor=this.shadow.color,t.shadowBlur=this.shadow.blur*e.browserShadowBlurConstant*(i+r)*(n.scaleX+n.scaleY)/4,t.shadowOffsetX=this.shadow.offsetX*i*n.scaleX,t.shadowOffsetY=this.shadow.offsetY*r*n.scaleY}},_removeShadow:function(t){this.shadow&&(t.shadowColor="",t.shadowBlur=t.shadowOffsetX=t.shadowOffsetY=0)},_applyPatternGradientTransform:function(t,e){if(!e||!e.toLive)return{offsetX:0,offsetY:0};var i=e.gradientTransform||e.patternTransform,r=-this.width/2+e.offsetX||0,n=-this.height/2+e.offsetY||0;return t.translate(r,n),i&&t.transform(i[0],i[1],i[2],i[3],i[4],i[5]),{offsetX:r,offsetY:n}},_renderPaintInOrder:function(t){"stroke"===this.paintFirst?(this._renderStroke(t),this._renderFill(t)):(this._renderFill(t),this._renderStroke(t))},_renderFill:function(t){this.fill&&(t.save(),this._applyPatternGradientTransform(t,this.fill),"evenodd"===this.fillRule?t.fill("evenodd"):t.fill(),t.restore())},_renderStroke:function(t){this.stroke&&0!==this.strokeWidth&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(t),t.save(),this._setLineDash(t,this.strokeDashArray,this._renderDashedStroke),this._applyPatternGradientTransform(t,this.stroke),t.stroke(),t.restore())},_findCenterFromElement:function(){return{x:this.left+this.width/2,y:this.top+this.height/2}},_assignTransformMatrixProps:function(){if(this.transformMatrix){var t=e.util.qrDecompose(this.transformMatrix);this.flipX=!1,this.flipY=!1,this.set("scaleX",t.scaleX),this.set("scaleY",t.scaleY),this.angle=t.angle,this.skewX=t.skewX,this.skewY=0}},_removeTransformMatrix:function(t){var i=this._findCenterFromElement();this.transformMatrix&&(this._assignTransformMatrixProps(),i=e.util.transformPoint(i,this.transformMatrix)),this.transformMatrix=null,t&&(this.scaleX*=t.scaleX,this.scaleY*=t.scaleY,this.cropX=t.cropX,this.cropY=t.cropY,i.x+=t.offsetLeft,i.y+=t.offsetTop,this.width=t.width,this.height=t.height),this.setPositionByOrigin(i,"center","center")},clone:function(t,i){var r=this.toObject(i);this.constructor.fromObject?this.constructor.fromObject(r,t):e.Object._fromObject("Object",r,t)},cloneAsImage:function(t,i){var r=this.toDataURL(i);return e.util.loadImage(r,function(i){t&&t(new e.Image(i))}),this},toDataURL:function(t){t||(t={});var i=e.util.createCanvasElement(),r=this.getBoundingRect();i.width=r.width,i.height=r.height,e.util.wrapElement(i,"div");var n=new e.StaticCanvas(i,{enableRetinaScaling:t.enableRetinaScaling});"jpg"===t.format&&(t.format="jpeg"),"jpeg"===t.format&&(n.backgroundColor="#fff");var s={left:this.left,top:this.top};this.setPositionByOrigin(new e.Point(n.width/2,n.height/2),"center","center");var o=this.canvas;n.add(this);var a=n.toDataURL(t);return this.set(s).setCoords(),this.canvas=o,n.dispose(),n=null,a},isType:function(t){return this.type===t},complexity:function(){return 1},toJSON:function(t){return this.toObject(t)},setGradient:function(t,i){i||(i={});var r={colorStops:[]};return r.type=i.type||(i.r1||i.r2?"radial":"linear"),r.coords={x1:i.x1,y1:i.y1,x2:i.x2,y2:i.y2},(i.r1||i.r2)&&(r.coords.r1=i.r1,r.coords.r2=i.r2),r.gradientTransform=i.gradientTransform,e.Gradient.prototype.addColorStop.call(r,i.colorStops),this.set(t,e.Gradient.forObject(this,r))},setPatternFill:function(t){return this.set("fill",new e.Pattern(t))},setShadow:function(t){return this.set("shadow",t?new e.Shadow(t):null)},setColor:function(t){return this.set("fill",t),this},rotate:function(t){var e=("center"!==this.originX||"center"!==this.originY)&&this.centeredRotation;return e&&this._setOriginToCenter(),this.set("angle",t),e&&this._resetOrigin(),this},centerH:function(){return this.canvas&&this.canvas.centerObjectH(this),this},viewportCenterH:function(){return this.canvas&&this.canvas.viewportCenterObjectH(this),this},centerV:function(){return this.canvas&&this.canvas.centerObjectV(this),this},viewportCenterV:function(){return this.canvas&&this.canvas.viewportCenterObjectV(this),this},center:function(){return this.canvas&&this.canvas.centerObject(this),this},viewportCenter:function(){return this.canvas&&this.canvas.viewportCenterObject(this),this},getLocalPointer:function(t,i){i=i||this.canvas.getPointer(t);var r=new e.Point(i.x,i.y),n=this._getLeftTopCoords();return this.angle&&(r=e.util.rotatePoint(r,n,o(-this.angle))),{x:r.x-n.x,y:r.y-n.y}},_setupCompositeOperation:function(t){this.globalCompositeOperation&&(t.globalCompositeOperation=this.globalCompositeOperation)}}),e.util.createAccessors&&e.util.createAccessors(e.Object),i(e.Object.prototype,e.Observable),e.Object.NUM_FRACTION_DIGITS=2,e.Object._fromObject=function(t,i,n,s){var o=e[t];i=r(i,!0),e.util.enlivenPatterns([i.fill,i.stroke],function(t){"undefined"!=typeof t[0]&&(i.fill=t[0]),"undefined"!=typeof t[1]&&(i.stroke=t[1]);var e=s?new o(i[s],i):new o(i);n&&n(e)})},e.Object.__uid=0)}("undefined"!=typeof exports?exports:this);!function(){var t=fabric.util.degreesToRadians,e={left:-.5,center:0,right:.5},i={top:-.5,center:0,bottom:.5};fabric.util.object.extend(fabric.Object.prototype,{translateToGivenOrigin:function(t,r,n,s,o){var a,c,l,h=t.x,u=t.y;return"string"==typeof r?r=e[r]:r-=.5,"string"==typeof s?s=e[s]:s-=.5,a=s-r,"string"==typeof n?n=i[n]:n-=.5,"string"==typeof o?o=i[o]:o-=.5,c=o-n,(a||c)&&(l=this._getTransformedDimensions(),h=t.x+a*l.x,u=t.y+c*l.y),new fabric.Point(h,u)},translateToCenterPoint:function(e,i,r){var n=this.translateToGivenOrigin(e,i,r,"center","center");return this.angle?fabric.util.rotatePoint(n,e,t(this.angle)):n},translateToOriginPoint:function(e,i,r){var n=this.translateToGivenOrigin(e,"center","center",i,r);return this.angle?fabric.util.rotatePoint(n,e,t(this.angle)):n},getCenterPoint:function(){var t=new fabric.Point(this.left,this.top);return this.translateToCenterPoint(t,this.originX,this.originY)},getPointByOrigin:function(t,e){var i=this.getCenterPoint();return this.translateToOriginPoint(i,t,e)},toLocalPoint:function(e,i,r){var n,s,o=this.getCenterPoint();return n="undefined"!=typeof i&&"undefined"!=typeof r?this.translateToGivenOrigin(o,"center","center",i,r):new fabric.Point(this.left,this.top),s=new fabric.Point(e.x,e.y),this.angle&&(s=fabric.util.rotatePoint(s,o,-t(this.angle))),s.subtractEquals(n)},setPositionByOrigin:function(t,e,i){var r=this.translateToCenterPoint(t,e,i),n=this.translateToOriginPoint(r,this.originX,this.originY);this.set("left",n.x),this.set("top",n.y)},adjustPosition:function(i){var r,n,s=t(this.angle),o=this.getScaledWidth(),a=Math.cos(s)*o,c=Math.sin(s)*o;r="string"==typeof this.originX?e[this.originX]:this.originX-.5,n="string"==typeof i?e[i]:i-.5,this.left+=a*(n-r),this.top+=c*(n-r),this.setCoords(),this.originX=i},_setOriginToCenter:function(){this._originalOriginX=this.originX,this._originalOriginY=this.originY;var t=this.getCenterPoint();this.originX="center",this.originY="center",this.left=t.x,this.top=t.y},_resetOrigin:function(){var t=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX,this.originY=this._originalOriginY,this.left=t.x,this.top=t.y,this._originalOriginX=null,this._originalOriginY=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","top")},onDeselect:function(){}})}();!function(){function t(t){return[new fabric.Point(t.tl.x,t.tl.y),new fabric.Point(t.tr.x,t.tr.y),new fabric.Point(t.br.x,t.br.y),new fabric.Point(t.bl.x,t.bl.y)]}var e=fabric.util.degreesToRadians,i=fabric.util.multiplyTransformMatrices;fabric.util.object.extend(fabric.Object.prototype,{oCoords:null,aCoords:null,ownMatrixCache:null,matrixCache:null,getCoords:function(e,i){this.oCoords||this.setCoords();var r=e?this.aCoords:this.oCoords;return t(i?this.calcCoords(e):r)},intersectsWithRect:function(t,e,i,r){var n=this.getCoords(i,r),s=fabric.Intersection.intersectPolygonRectangle(n,t,e);return"Intersection"===s.status},intersectsWithObject:function(t,e,i){var r=fabric.Intersection.intersectPolygonPolygon(this.getCoords(e,i),t.getCoords(e,i));return"Intersection"===r.status||t.isContainedWithinObject(this,e,i)||this.isContainedWithinObject(t,e,i)},isContainedWithinObject:function(t,e,i){for(var r=this.getCoords(e,i),n=0,s=t._getImageLines(i?t.calcCoords(e):e?t.aCoords:t.oCoords);4>n;n++)if(!t.containsPoint(r[n],s))return!1;return!0},isContainedWithinRect:function(t,e,i,r){var n=this.getBoundingRect(i,r);return n.left>=t.x&&n.left+n.width<=e.x&&n.top>=t.y&&n.top+n.height<=e.y},containsPoint:function(t,e,i,r){var e=e||this._getImageLines(r?this.calcCoords(i):i?this.aCoords:this.oCoords),n=this._findCrossPoints(t,e);return 0!==n&&n%2===1},isOnScreen:function(t){if(!this.canvas)return!1;for(var e,i=this.canvas.vptCoords.tl,r=this.canvas.vptCoords.br,n=this.getCoords(!0,t),s=0;4>s;s++)if(e=n[s],e.x<=r.x&&e.x>=i.x&&e.y<=r.y&&e.y>=i.y)return!0;if(this.intersectsWithRect(i,r,!0))return!0;var o={x:(i.x+r.x)/2,y:(i.y+r.y)/2};return this.containsPoint(o,null,!0)?!0:!1},_getImageLines:function(t){return{topline:{o:t.tl,d:t.tr},rightline:{o:t.tr,d:t.br},bottomline:{o:t.br,d:t.bl},leftline:{o:t.bl,d:t.tl}}},_findCrossPoints:function(t,e){var i,r,n,s,o,a,c=0;for(var h in e)if(a=e[h],!(a.o.y<t.y&&a.d.y<t.y||a.o.y>=t.y&&a.d.y>=t.y||(a.o.x===a.d.x&&a.o.x>=t.x?o=a.o.x:(i=0,r=(a.d.y-a.o.y)/(a.d.x-a.o.x),n=t.y-i*t.x,s=a.o.y-r*a.o.x,o=-(n-s)/(i-r)),o>=t.x&&(c+=1),2!==c)))break;return c},getBoundingRect:function(t,e){var i=this.getCoords(t,e);return fabric.util.makeBoundingBoxFromPoints(i)},getScaledWidth:function(){return this._getTransformedDimensions().x},getScaledHeight:function(){return this._getTransformedDimensions().y},_constrainScale:function(t){return Math.abs(t)<this.minScaleLimit?0>t?-this.minScaleLimit:this.minScaleLimit:0===t?1e-4:t},scale:function(t){return this._set("scaleX",t),this._set("scaleY",t),this.setCoords()},scaleToWidth:function(t,e){var i=this.getBoundingRect(e).width/this.getScaledWidth();return this.scale(t/this.width/i)},scaleToHeight:function(t,e){var i=this.getBoundingRect(e).height/this.getScaledHeight();return this.scale(t/this.height/i)},calcCoords:function(t){var i=e(this.angle),r=this.getViewportTransform(),n=t?this._getTransformedDimensions():this._calculateCurrentDimensions(),s=n.x,o=n.y,a=i?Math.sin(i):0,c=i?Math.cos(i):1,h=s>0?Math.atan(o/s):0,l=s/Math.cos(h)/2,u=Math.cos(h+i)*l,f=Math.sin(h+i)*l,d=this.getCenterPoint(),g=t?d:fabric.util.transformPoint(d,r),p=new fabric.Point(g.x-u,g.y-f),v=new fabric.Point(p.x+s*c,p.y+s*a),b=new fabric.Point(p.x-o*a,p.y+o*c),m=new fabric.Point(g.x+u,g.y+f);if(!t)var y=new fabric.Point((p.x+b.x)/2,(p.y+b.y)/2),_=new fabric.Point((v.x+p.x)/2,(v.y+p.y)/2),w=new fabric.Point((m.x+v.x)/2,(m.y+v.y)/2),C=new fabric.Point((m.x+b.x)/2,(m.y+b.y)/2),x=new fabric.Point(_.x+a*this.rotatingPointOffset,_.y-c*this.rotatingPointOffset);var g={tl:p,tr:v,br:m,bl:b};return t||(g.ml=y,g.mt=_,g.mr=w,g.mb=C,g.mtr=x),g},setCoords:function(t,e){return this.oCoords=this.calcCoords(t),e||(this.aCoords=this.calcCoords(!0)),t||this._setCornerCoords&&this._setCornerCoords(),this},_calcRotateMatrix:function(){if(this.angle){var t=e(this.angle),i=Math.cos(t),r=Math.sin(t);return(6.123233995736766e-17===i||-1.8369701987210297e-16===i)&&(i=0),[i,r,-r,i,0,0]}return fabric.iMatrix.concat()},transformMatrixKey:function(t){var e="_",i="";return!t&&this.group&&(i=this.group.transformMatrixKey(t)+e),i+this.top+e+this.left+e+this.scaleX+e+this.scaleY+e+this.skewX+e+this.skewY+e+this.angle+e+this.flipX+e+this.flipY+e+this.width+e+this.height},calcTransformMatrix:function(t){if(t)return this.calcOwnMatrix();var e=this.transformMatrixKey(),r=this.matrixCache||(this.matrixCache={});if(r.key===e)return r.value;var n=this.calcOwnMatrix();return this.group&&(n=i(this.group.calcTransformMatrix(),n)),r.key=e,r.value=n,n},calcOwnMatrix:function(){var t=this.transformMatrixKey(!0),e=this.ownMatrixCache||(this.ownMatrixCache={});if(e.key===t)return e.value;var r,n=this.getCenterPoint(),s=[1,0,0,1,n.x,n.y],o=this._calcDimensionsTransformMatrix(this.skewX,this.skewY,!0);return this.angle&&(r=this._calcRotateMatrix(),s=i(s,r)),s=i(s,o),e.key=t,e.value=s,s},_calcDimensionsTransformMatrix:function(t,r,n){var s,o=this.scaleX*(n&&this.flipX?-1:1),a=this.scaleY*(n&&this.flipY?-1:1),c=[o,0,0,a,0,0];return t&&(s=[1,0,Math.tan(e(t)),1],c=i(c,s,!0)),r&&(s=[1,Math.tan(e(r)),0,1],c=i(c,s,!0)),c},_getNonTransformedDimensions:function(){var t=this.strokeWidth,e=this.width+t,i=this.height+t;return{x:e,y:i}},_getTransformedDimensions:function(t,e){"undefined"==typeof t&&(t=this.skewX),"undefined"==typeof e&&(e=this.skewY);var i,r,n=this._getNonTransformedDimensions(),s=n.x/2,o=n.y/2,a=[{x:-s,y:-o},{x:s,y:-o},{x:-s,y:o},{x:s,y:o}],c=this._calcDimensionsTransformMatrix(t,e,!1);for(i=0;i<a.length;i++)a[i]=fabric.util.transformPoint(a[i],c);return r=fabric.util.makeBoundingBoxFromPoints(a),{x:r.width,y:r.height}},_calculateCurrentDimensions:function(){var t=this.getViewportTransform(),e=this._getTransformedDimensions(),i=fabric.util.transformPoint(e,t,!0);return i.scalarAdd(2*this.padding)}})}();fabric.util.object.extend(fabric.Object.prototype,{sendToBack:function(){return this.group?fabric.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?fabric.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas.bringToFront(this),this},sendBackwards:function(t){return this.group?fabric.StaticCanvas.prototype.sendBackwards.call(this.group,this,t):this.canvas.sendBackwards(this,t),this},bringForward:function(t){return this.group?fabric.StaticCanvas.prototype.bringForward.call(this.group,this,t):this.canvas.bringForward(this,t),this},moveTo:function(t){return this.group&&"activeSelection"!==this.group.type?fabric.StaticCanvas.prototype.moveTo.call(this.group,this,t):this.canvas.moveTo(this,t),this}});!function(){function t(t,e){if(e){if(e.toLive)return t+": url(#SVGID_"+e.id+"); ";var i=new fabric.Color(e),r=t+": "+i.toRgb()+"; ",n=i.getAlpha();return 1!==n&&(r+=t+"-opacity: "+n.toString()+"; "),r}return t+": none; "}var e=fabric.Object.NUM_FRACTION_DIGITS,i=fabric.util.toFixed;fabric.util.object.extend(fabric.Object.prototype,{getSvgStyles:function(e){var i=this.fillRule,r=this.strokeWidth?this.strokeWidth:"0",n=this.strokeDashArray?this.strokeDashArray.join(" "):"none",s=this.strokeLineCap?this.strokeLineCap:"butt",o=this.strokeLineJoin?this.strokeLineJoin:"miter",a=this.strokeMiterLimit?this.strokeMiterLimit:"4",c="undefined"!=typeof this.opacity?this.opacity:"1",h=this.visible?"":" visibility: hidden;",l=e?"":this.getSvgFilter(),u=t("fill",this.fill),f=t("stroke",this.stroke);return[f,"stroke-width: ",r,"; ","stroke-dasharray: ",n,"; ","stroke-linecap: ",s,"; ","stroke-linejoin: ",o,"; ","stroke-miterlimit: ",a,"; ",u,"fill-rule: ",i,"; ","opacity: ",c,";",l,h].join("")},getSvgSpanStyles:function(e,i){var r="; ",n=e.strokeWidth?"stroke-width: "+e.strokeWidth+r:"",s=e.fontFamily?"font-family: "+e.fontFamily.replace(/"/g,"'")+r:"",o=e.fontSize?"font-size: "+e.fontSize+r:"",a=e.fontStyle?"font-style: "+e.fontStyle+r:"",c=e.fontWeight?"font-weight: "+e.fontWeight+r:"",h=e.fill?t("fill",e.fill):"",l=e.stroke?t("stroke",e.stroke):"",u=this.getSvgTextDecoration(e);return u&&(u="text-decoration: "+u+r),[l,n,s,o,a,c,u,h,i?"white-space: pre; ":""].join("")},getSvgTextDecoration:function(t){return"overline"in t||"underline"in t||"linethrough"in t?(t.overline?"overline ":"")+(t.underline?"underline ":"")+(t.linethrough?"line-through ":""):""},getSvgFilter:function(){return this.shadow?"filter: url(#SVGID_"+this.shadow.id+");":""},getSvgId:function(){return this.id?'id="'+this.id+'" ':""},getSvgTransform:function(){var t=this.angle,e=this.skewX%360,r=this.skewY%360,n=this.getCenterPoint(),s=fabric.Object.NUM_FRACTION_DIGITS,o="translate("+i(n.x,s)+" "+i(n.y,s)+")",a=0!==t?" rotate("+i(t,s)+")":"",c=1===this.scaleX&&1===this.scaleY?"":" scale("+i(this.scaleX,s)+" "+i(this.scaleY,s)+")",h=0!==e?" skewX("+i(e,s)+")":"",l=0!==r?" skewY("+i(r,s)+")":"",u=this.flipX?" matrix(-1 0 0 1 0 0) ":"",f=this.flipY?" matrix(1 0 0 -1 0 0)":"";return[o,a,c,u,f,h,l].join("")},getSvgTransformMatrix:function(){return this.transformMatrix?" matrix("+this.transformMatrix.join(" ")+") ":""},_setSVGBg:function(t){this.backgroundColor&&t.push("		<rect ",this._getFillAttributes(this.backgroundColor),' x="',i(-this.width/2,e),'" y="',i(-this.height/2,e),'" width="',i(this.width,e),'" height="',i(this.height,e),'"></rect>\n')},_createBaseSVGMarkup:function(){var t=[];return this.fill&&this.fill.toLive&&t.push(this.fill.toSVG(this,!1)),this.stroke&&this.stroke.toLive&&t.push(this.stroke.toSVG(this,!1)),this.shadow&&t.push(this.shadow.toSVG(this)),t},addPaintOrder:function(){return"fill"!==this.paintFirst?' paint-order="'+this.paintFirst+'" ':""}})}();!function(){function t(t,e,r){var n={},s=!0;r.forEach(function(e){n[e]=t[e]}),i(t[e],n,s)}function e(t,i,r){if(t===i)return!0;if(Array.isArray(t)){if(t.length!==i.length)return!1;for(var n=0,s=t.length;s>n;n++)if(!e(t[n],i[n]))return!1;return!0}if(t&&"object"==typeof t){var o,a=Object.keys(t);if(!r&&a.length!==Object.keys(i).length)return!1;for(var n=0,s=a.length;s>n;n++)if(o=a[n],!e(t[o],i[o]))return!1;return!0}}var i=fabric.util.object.extend,r="stateProperties";fabric.util.object.extend(fabric.Object.prototype,{hasStateChanged:function(t){t=t||r;var i="_"+t;return Object.keys(this[i]).length<this[t].length?!0:!e(this[i],this,!0)},saveState:function(e){var i=e&&e.propertySet||r,n="_"+i;return this[n]?(t(this,n,this[i]),e&&e.stateProperties&&t(this,n,e.stateProperties),this):this.setupState(e)},setupState:function(t){t=t||{};var e=t.propertySet||r;return t.propertySet=e,this["_"+e]={},this.saveState(t),this}})}();!function(){var t=fabric.util.degreesToRadians;fabric.util.object.extend(fabric.Object.prototype,{_controlsVisibility:null,_findTargetCorner:function(t){if(!this.hasControls||this.group||!this.canvas||this.canvas._activeObject!==this)return!1;var e,i,r=t.x,n=t.y;this.__corner=0;for(var s in this.oCoords)if(this.isControlVisible(s)&&("mtr"!==s||this.hasRotatingPoint)&&(!this.get("lockUniScaling")||"mt"!==s&&"mr"!==s&&"mb"!==s&&"ml"!==s)&&(i=this._getImageLines(this.oCoords[s].corner),e=this._findCrossPoints({x:r,y:n},i),0!==e&&e%2===1))return this.__corner=s,s;return!1},_setCornerCoords:function(){var e,i,r=this.oCoords,n=t(45-this.angle),s=.707106*this.cornerSize,o=s*Math.cos(n),a=s*Math.sin(n);for(var c in r)e=r[c].x,i=r[c].y,r[c].corner={tl:{x:e-a,y:i-o},tr:{x:e+o,y:i-a},bl:{x:e-o,y:i+a},br:{x:e+a,y:i+o}}},drawSelectionBackground:function(e){if(!this.selectionBackgroundColor||this.canvas&&!this.canvas.interactive||this.canvas&&this.canvas._activeObject!==this)return this;e.save();var i=this.getCenterPoint(),r=this._calculateCurrentDimensions(),n=this.canvas.viewportTransform;return e.translate(i.x,i.y),e.scale(1/n[0],1/n[3]),e.rotate(t(this.angle)),e.fillStyle=this.selectionBackgroundColor,e.fillRect(-r.x/2,-r.y/2,r.x,r.y),e.restore(),this},drawBorders:function(t,e){e=e||{};var i=this._calculateCurrentDimensions(),r=1/this.borderScaleFactor,n=i.x+r,s=i.y+r,o="undefined"!=typeof e.hasRotatingPoint?e.hasRotatingPoint:this.hasRotatingPoint,a="undefined"!=typeof e.hasControls?e.hasControls:this.hasControls,c="undefined"!=typeof e.rotatingPointOffset?e.rotatingPointOffset:this.rotatingPointOffset;if(t.save(),t.strokeStyle=e.borderColor||this.borderColor,this._setLineDash(t,e.borderDashArray||this.borderDashArray,null),t.strokeRect(-n/2,-s/2,n,s),o&&this.isControlVisible("mtr")&&a){var h=-s/2;t.beginPath(),t.moveTo(0,h),t.lineTo(0,h-c),t.closePath(),t.stroke()}return t.restore(),this},drawBordersInGroup:function(t,e,i){i=i||{};var r=this._getNonTransformedDimensions(),n=fabric.util.customTransformMatrix(e.scaleX,e.scaleY,e.skewX),s=fabric.util.transformPoint(r,n),o=1/this.borderScaleFactor,a=s.x+o,c=s.y+o;return t.save(),this._setLineDash(t,i.borderDashArray||this.borderDashArray,null),t.strokeStyle=i.borderColor||this.borderColor,t.strokeRect(-a/2,-c/2,a,c),t.restore(),this},drawControls:function(t,e){e=e||{};var i=this._calculateCurrentDimensions(),r=i.x,n=i.y,s=e.cornerSize||this.cornerSize,o=-(r+s)/2,a=-(n+s)/2,c="undefined"!=typeof e.transparentCorners?e.transparentCorners:this.transparentCorners,h="undefined"!=typeof e.hasRotatingPoint?e.hasRotatingPoint:this.hasRotatingPoint,l=c?"stroke":"fill";return t.save(),t.strokeStyle=t.fillStyle=e.cornerColor||this.cornerColor,this.transparentCorners||(t.strokeStyle=e.cornerStrokeColor||this.cornerStrokeColor),this._setLineDash(t,e.cornerDashArray||this.cornerDashArray,null),this._drawControl("tl",t,l,o,a,e),this._drawControl("tr",t,l,o+r,a,e),this._drawControl("bl",t,l,o,a+n,e),this._drawControl("br",t,l,o+r,a+n,e),this.get("lockUniScaling")||(this._drawControl("mt",t,l,o+r/2,a,e),this._drawControl("mb",t,l,o+r/2,a+n,e),this._drawControl("mr",t,l,o+r,a+n/2,e),this._drawControl("ml",t,l,o,a+n/2,e)),h&&this._drawControl("mtr",t,l,o+r/2,a-this.rotatingPointOffset,e),t.restore(),this},_drawControl:function(t,e,i,r,n,s){if(s=s||{},this.isControlVisible(t)){var o=this.cornerSize,a=!this.transparentCorners&&this.cornerStrokeColor;switch(s.cornerStyle||this.cornerStyle){case"circle":e.beginPath(),e.arc(r+o/2,n+o/2,o/2,0,2*Math.PI,!1),e[i](),a&&e.stroke();break;default:this.transparentCorners||e.clearRect(r,n,o,o),e[i+"Rect"](r,n,o,o),a&&e.strokeRect(r,n,o,o)}}},isControlVisible:function(t){return this._getControlsVisibility()[t]},setControlVisible:function(t,e){return this._getControlsVisibility()[t]=e,this},setControlsVisibility:function(t){t||(t={});for(var e in t)this.setControlVisible(e,t[e]);return this},_getControlsVisibility:function(){return this._controlsVisibility||(this._controlsVisibility={tl:!0,tr:!0,br:!0,bl:!0,ml:!0,mt:!0,mr:!0,mb:!0,mtr:!0}),this._controlsVisibility},onDeselect:function(){},onSelect:function(){}})}();fabric.util.object.extend(fabric.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(t,e){e=e||{};var i=function(){},r=e.onComplete||i,n=e.onChange||i,s=this;return fabric.util.animate({startValue:t.left,endValue:this.getCenter().left,duration:this.FX_DURATION,onChange:function(e){t.set("left",e),s.requestRenderAll(),n()},onComplete:function(){t.setCoords(),r()}}),this},fxCenterObjectV:function(t,e){e=e||{};var i=function(){},r=e.onComplete||i,n=e.onChange||i,s=this;return fabric.util.animate({startValue:t.top,endValue:this.getCenter().top,duration:this.FX_DURATION,onChange:function(e){t.set("top",e),s.requestRenderAll(),n()},onComplete:function(){t.setCoords(),r()}}),this},fxRemove:function(t,e){e=e||{};var i=function(){},r=e.onComplete||i,n=e.onChange||i,s=this;return fabric.util.animate({startValue:t.opacity,endValue:0,duration:this.FX_DURATION,onChange:function(e){t.set("opacity",e),s.requestRenderAll(),n()},onComplete:function(){s.remove(t),r()}}),this}}),fabric.util.object.extend(fabric.Object.prototype,{animate:function(){if(arguments[0]&&"object"==typeof arguments[0]){var t,e,i=[];for(t in arguments[0])i.push(t);for(var r=0,n=i.length;n>r;r++)t=i[r],e=r!==n-1,this._animate(t,arguments[0][t],arguments[1],e)}else this._animate.apply(this,arguments);return this},_animate:function(t,e,i,r){var n,s=this;e=e.toString(),i=i?fabric.util.object.clone(i):{},~t.indexOf(".")&&(n=t.split("."));var o=n?this.get(n[0])[n[1]]:this.get(t);"from"in i||(i.from=o),e=~e.indexOf("=")?o+parseFloat(e.replace("=","")):parseFloat(e),fabric.util.animate({startValue:i.from,endValue:e,byValue:i.by,easing:i.easing,duration:i.duration,abort:i.abort&&function(){return i.abort.call(s)},onChange:function(e,o,a){n?s[n[0]][n[1]]=e:s.set(t,e),r||i.onChange&&i.onChange(e,o,a)},onComplete:function(t,e,n){r||(s.setCoords(),i.onComplete&&i.onComplete(t,e,n))}})}});!function(t){"use strict";function e(t,e){var i=t.origin,r=t.axis1,n=t.axis2,s=t.dimension,o=e.nearest,a=e.center,c=e.farthest;return function(){switch(this.get(i)){case o:return Math.min(this.get(r),this.get(n));case a:return Math.min(this.get(r),this.get(n))+.5*this.get(s);case c:return Math.max(this.get(r),this.get(n))}}}var i=t.fabric||(t.fabric={}),r=i.util.object.extend,n=i.util.object.clone,s={x1:1,x2:1,y1:1,y2:1},o=i.StaticCanvas.supports("setLineDash");return i.Line?void i.warn("fabric.Line is already defined"):(i.Line=i.util.createClass(i.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,cacheProperties:i.Object.prototype.cacheProperties.concat("x1","x2","y1","y2"),initialize:function(t,e){t||(t=[0,0,0,0]),this.callSuper("initialize",e),this.set("x1",t[0]),this.set("y1",t[1]),this.set("x2",t[2]),this.set("y2",t[3]),this._setWidthHeight(e)},_setWidthHeight:function(t){t||(t={}),this.width=Math.abs(this.x2-this.x1),this.height=Math.abs(this.y2-this.y1),this.left="left"in t?t.left:this._getLeftToOriginX(),this.top="top"in t?t.top:this._getTopToOriginY()},_set:function(t,e){return this.callSuper("_set",t,e),"undefined"!=typeof s[t]&&this._setWidthHeight(),this},_getLeftToOriginX:e({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:e({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(t){if(t.beginPath(),!this.strokeDashArray||this.strokeDashArray&&o){var e=this.calcLinePoints();t.moveTo(e.x1,e.y1),t.lineTo(e.x2,e.y2)}t.lineWidth=this.strokeWidth;var i=t.strokeStyle;t.strokeStyle=this.stroke||t.fillStyle,this.stroke&&this._renderStroke(t),t.strokeStyle=i},_renderDashedStroke:function(t){var e=this.calcLinePoints();t.beginPath(),i.util.drawDashedLine(t,e.x1,e.y1,e.x2,e.y2,this.strokeDashArray),t.closePath()},_findCenterFromElement:function(){return{x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2}},toObject:function(t){return r(this.callSuper("toObject",t),this.calcLinePoints())},_getNonTransformedDimensions:function(){var t=this.callSuper("_getNonTransformedDimensions");return"butt"===this.strokeLineCap&&(0===this.width&&(t.y-=this.strokeWidth),0===this.height&&(t.x-=this.strokeWidth)),t},calcLinePoints:function(){var t=this.x1<=this.x2?-1:1,e=this.y1<=this.y2?-1:1,i=t*this.width*.5,r=e*this.height*.5,n=t*this.width*-.5,s=e*this.height*-.5;return{x1:i,x2:n,y1:r,y2:s}},toSVG:function(t){var e=this._createBaseSVGMarkup(),i=this.calcLinePoints();return e.push("<line ",this.getSvgId(),'x1="',i.x1,'" y1="',i.y1,'" x2="',i.x2,'" y2="',i.y2,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'"/>\n'),t?t(e.join("")):e.join("")}}),i.Line.ATTRIBUTE_NAMES=i.SHARED_ATTRIBUTES.concat("x1 y1 x2 y2".split(" ")),i.Line.fromElement=function(t,e,n){n=n||{};var s=i.parseAttributes(t,i.Line.ATTRIBUTE_NAMES),o=[s.x1||0,s.y1||0,s.x2||0,s.y2||0];e(new i.Line(o,r(s,n)))},void(i.Line.fromObject=function(t,e){function r(t){delete t.points,e&&e(t)}var s=n(t,!0);s.points=[t.x1,t.y1,t.x2,t.y2],i.Object._fromObject("Line",s,r,"points")}))}("undefined"!=typeof exports?exports:this);!function(t){"use strict";function e(t){return"radius"in t&&t.radius>=0}var i=t.fabric||(t.fabric={}),r=Math.PI,n=i.util.object.extend;return i.Circle?void i.warn("fabric.Circle is already defined."):(i.Circle=i.util.createClass(i.Object,{type:"circle",radius:0,startAngle:0,endAngle:2*r,cacheProperties:i.Object.prototype.cacheProperties.concat("radius"),initialize:function(t){this.callSuper("initialize",t),this.set("radius",t&&t.radius||0)},_set:function(t,e){return this.callSuper("_set",t,e),"radius"===t&&this.setRadius(e),this},toObject:function(t){return this.callSuper("toObject",["radius","startAngle","endAngle"].concat(t))},toSVG:function(t){var e=this._createBaseSVGMarkup(),i=0,n=0,s=(this.endAngle-this.startAngle)%(2*r);if(0===s)e.push("<circle ",this.getSvgId(),'cx="'+i+'" cy="'+n+'" ','r="',this.radius,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform()," ",this.getSvgTransformMatrix(),'"',this.addPaintOrder(),"/>\n");else{var o=Math.cos(this.startAngle)*this.radius,a=Math.sin(this.startAngle)*this.radius,c=Math.cos(this.endAngle)*this.radius,h=Math.sin(this.endAngle)*this.radius,l=s>r?"1":"0";e.push('<path d="M '+o+" "+a," A "+this.radius+" "+this.radius," 0 ",+l+" 1"," "+c+" "+h,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform()," ",this.getSvgTransformMatrix(),'"',this.addPaintOrder(),'"/>\n')}return t?t(e.join("")):e.join("")},_render:function(t){t.beginPath(),t.arc(0,0,this.radius,this.startAngle,this.endAngle,!1),this._renderPaintInOrder(t)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(t){return this.radius=t,this.set("width",2*t).set("height",2*t)}}),i.Circle.ATTRIBUTE_NAMES=i.SHARED_ATTRIBUTES.concat("cx cy r".split(" ")),i.Circle.fromElement=function(t,r,s){s||(s={});var o=i.parseAttributes(t,i.Circle.ATTRIBUTE_NAMES);if(!e(o))throw new Error("value of `r` attribute is required and can not be negative");o.left=(o.left||0)-o.radius,o.top=(o.top||0)-o.radius,r(new i.Circle(n(o,s)))},void(i.Circle.fromObject=function(t,e){return i.Object._fromObject("Circle",t,e)}))}("undefined"!=typeof exports?exports:this);!function(t){"use strict";var e=t.fabric||(t.fabric={});return e.Triangle?void e.warn("fabric.Triangle is already defined"):(e.Triangle=e.util.createClass(e.Object,{type:"triangle",initialize:function(t){this.callSuper("initialize",t),this.set("width",t&&t.width||100).set("height",t&&t.height||100)},_render:function(t){var e=this.width/2,i=this.height/2;t.beginPath(),t.moveTo(-e,i),t.lineTo(0,-i),t.lineTo(e,i),t.closePath(),this._renderPaintInOrder(t)},_renderDashedStroke:function(t){var i=this.width/2,r=this.height/2;t.beginPath(),e.util.drawDashedLine(t,-i,r,0,-r,this.strokeDashArray),e.util.drawDashedLine(t,0,-r,i,r,this.strokeDashArray),e.util.drawDashedLine(t,i,r,-i,r,this.strokeDashArray),t.closePath()},toSVG:function(t){var e=this._createBaseSVGMarkup(),i=this.width/2,r=this.height/2,n=[-i+" "+r,"0 "+-r,i+" "+r].join(",");return e.push("<polygon ",this.getSvgId(),'points="',n,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),'"',this.addPaintOrder(),"/>"),t?t(e.join("")):e.join("")}}),void(e.Triangle.fromObject=function(t,i){return e.Object._fromObject("Triangle",t,i)}))}("undefined"!=typeof exports?exports:this);!function(t){"use strict";var e=t.fabric||(t.fabric={}),i=2*Math.PI,r=e.util.object.extend;return e.Ellipse?void e.warn("fabric.Ellipse is already defined."):(e.Ellipse=e.util.createClass(e.Object,{type:"ellipse",rx:0,ry:0,cacheProperties:e.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(t){this.callSuper("initialize",t),this.set("rx",t&&t.rx||0),this.set("ry",t&&t.ry||0)},_set:function(t,e){switch(this.callSuper("_set",t,e),t){case"rx":this.rx=e,this.set("width",2*e);break;case"ry":this.ry=e,this.set("height",2*e)}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(t){return this.callSuper("toObject",["rx","ry"].concat(t))},toSVG:function(t){var e=this._createBaseSVGMarkup();return e.push("<ellipse ",this.getSvgId(),'cx="0" cy="0" ','rx="',this.rx,'" ry="',this.ry,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'"',this.addPaintOrder(),"/>\n"),t?t(e.join("")):e.join("")},_render:function(t){t.beginPath(),t.save(),t.transform(1,0,0,this.ry/this.rx,0,0),t.arc(0,0,this.rx,0,i,!1),t.restore(),this._renderPaintInOrder(t)}}),e.Ellipse.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("cx cy rx ry".split(" ")),e.Ellipse.fromElement=function(t,i,n){n||(n={});var s=e.parseAttributes(t,e.Ellipse.ATTRIBUTE_NAMES);s.left=(s.left||0)-s.rx,s.top=(s.top||0)-s.ry,i(new e.Ellipse(r(s,n)))},void(e.Ellipse.fromObject=function(t,i){return e.Object._fromObject("Ellipse",t,i)}))}("undefined"!=typeof exports?exports:this);!function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend;return e.Rect?void e.warn("fabric.Rect is already defined"):(e.Rect=e.util.createClass(e.Object,{stateProperties:e.Object.prototype.stateProperties.concat("rx","ry"),type:"rect",rx:0,ry:0,cacheProperties:e.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(t){this.callSuper("initialize",t),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(t){if(1===this.width&&1===this.height)return void t.fillRect(-.5,-.5,1,1);var e=this.rx?Math.min(this.rx,this.width/2):0,i=this.ry?Math.min(this.ry,this.height/2):0,r=this.width,n=this.height,s=-this.width/2,o=-this.height/2,a=0!==e||0!==i,c=.4477152502;t.beginPath(),t.moveTo(s+e,o),t.lineTo(s+r-e,o),a&&t.bezierCurveTo(s+r-c*e,o,s+r,o+c*i,s+r,o+i),t.lineTo(s+r,o+n-i),a&&t.bezierCurveTo(s+r,o+n-c*i,s+r-c*e,o+n,s+r-e,o+n),t.lineTo(s+e,o+n),a&&t.bezierCurveTo(s+c*e,o+n,s,o+n-c*i,s,o+n-i),t.lineTo(s,o+i),a&&t.bezierCurveTo(s,o+c*i,s+c*e,o,s+e,o),t.closePath(),this._renderPaintInOrder(t)},_renderDashedStroke:function(t){var i=-this.width/2,r=-this.height/2,n=this.width,s=this.height;t.beginPath(),e.util.drawDashedLine(t,i,r,i+n,r,this.strokeDashArray),e.util.drawDashedLine(t,i+n,r,i+n,r+s,this.strokeDashArray),e.util.drawDashedLine(t,i+n,r+s,i,r+s,this.strokeDashArray),e.util.drawDashedLine(t,i,r+s,i,r,this.strokeDashArray),t.closePath()},toObject:function(t){return this.callSuper("toObject",["rx","ry"].concat(t))},toSVG:function(t){var e=this._createBaseSVGMarkup(),i=-this.width/2,r=-this.height/2;return e.push("<rect ",this.getSvgId(),'x="',i,'" y="',r,'" rx="',this.get("rx"),'" ry="',this.get("ry"),'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'"',this.addPaintOrder(),"/>\n"),t?t(e.join("")):e.join("")}}),e.Rect.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),e.Rect.fromElement=function(t,r,n){if(!t)return r(null);n=n||{};var s=e.parseAttributes(t,e.Rect.ATTRIBUTE_NAMES);s.left=s.left||0,s.top=s.top||0;var o=new e.Rect(i(n?e.util.object.clone(n):{},s));o.visible=o.visible&&o.width>0&&o.height>0,r(o)},void(e.Rect.fromObject=function(t,i){return e.Object._fromObject("Rect",t,i)}))}("undefined"!=typeof exports?exports:this);!function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,r=e.util.array.min,n=e.util.array.max,s=e.util.toFixed,o=e.Object.NUM_FRACTION_DIGITS;return e.Polyline?void e.warn("fabric.Polyline is already defined"):(e.Polyline=e.util.createClass(e.Object,{type:"polyline",points:null,cacheProperties:e.Object.prototype.cacheProperties.concat("points"),initialize:function(t,e){e=e||{},this.points=t||[],this.callSuper("initialize",e);var i=this._calcDimensions();"undefined"==typeof e.left&&(this.left=i.left),"undefined"==typeof e.top&&(this.top=i.top),this.width=i.width,this.height=i.height,this.pathOffset={x:i.left+this.width/2,y:i.top+this.height/2}},_calcDimensions:function(){var t=this.points,e=r(t,"x")||0,i=r(t,"y")||0,s=n(t,"x")||0,o=n(t,"y")||0,a=s-e,c=o-i;return{left:e,top:i,width:a,height:c}},toObject:function(t){return i(this.callSuper("toObject",t),{points:this.points.concat()})},toSVG:function(t){for(var e=[],i=this.pathOffset.x,r=this.pathOffset.y,n=this._createBaseSVGMarkup(),a=0,c=this.points.length;c>a;a++)e.push(s(this.points[a].x-i,o),",",s(this.points[a].y-r,o)," ");return n.push("<",this.type," ",this.getSvgId(),'points="',e.join(""),'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform()," ",this.getSvgTransformMatrix(),'"',this.addPaintOrder(),"/>\n"),t?t(n.join("")):n.join("")},commonRender:function(t){var e,i=this.points.length,r=this.pathOffset.x,n=this.pathOffset.y;if(!i||isNaN(this.points[i-1].y))return!1;t.beginPath(),t.moveTo(this.points[0].x-r,this.points[0].y-n);for(var s=0;i>s;s++)e=this.points[s],t.lineTo(e.x-r,e.y-n);return!0},_render:function(t){this.commonRender(t)&&this._renderPaintInOrder(t)},_renderDashedStroke:function(t){var i,r;t.beginPath();for(var n=0,s=this.points.length;s>n;n++)i=this.points[n],r=this.points[n+1]||i,e.util.drawDashedLine(t,i.x,i.y,r.x,r.y,this.strokeDashArray)},complexity:function(){return this.get("points").length}}),e.Polyline.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat(),e.Polyline.fromElement=function(t,i,r){if(!t)return i(null);r||(r={});var n=e.parsePointsAttribute(t.getAttribute("points")),s=e.parseAttributes(t,e.Polyline.ATTRIBUTE_NAMES);i(new e.Polyline(n,e.util.object.extend(s,r)))},void(e.Polyline.fromObject=function(t,i){return e.Object._fromObject("Polyline",t,i,"points")}))}("undefined"!=typeof exports?exports:this);!function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend;return e.Polygon?void e.warn("fabric.Polygon is already defined"):(e.Polygon=e.util.createClass(e.Polyline,{type:"polygon",_render:function(t){this.commonRender(t)&&(t.closePath(),this._renderPaintInOrder(t))},_renderDashedStroke:function(t){this.callSuper("_renderDashedStroke",t),t.closePath()}}),e.Polygon.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat(),e.Polygon.fromElement=function(t,r,n){if(!t)return r(null);n||(n={});var s=e.parsePointsAttribute(t.getAttribute("points")),o=e.parseAttributes(t,e.Polygon.ATTRIBUTE_NAMES);r(new e.Polygon(s,i(o,n)))},void(e.Polygon.fromObject=function(t,i){return e.Object._fromObject("Polygon",t,i,"points")}))}("undefined"!=typeof exports?exports:this);!function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.array.min,r=e.util.array.max,n=e.util.object.extend,s=Object.prototype.toString,o=e.util.drawArc,a={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},c={m:"l",M:"L"};return e.Path?void e.warn("fabric.Path is already defined"):(e.Path=e.util.createClass(e.Object,{type:"path",path:null,cacheProperties:e.Object.prototype.cacheProperties.concat("path","fillRule"),stateProperties:e.Object.prototype.stateProperties.concat("path"),initialize:function(t,e){e=e||{},this.callSuper("initialize",e),t||(t=[]);var i="[object Array]"===s.call(t);this.path=i?t:t.match&&t.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi),this.path&&(i||(this.path=this._parsePath()),this._setPositionDimensions(e))},_setPositionDimensions:function(t){var e=this._parseDimensions();this.width=e.width,this.height=e.height,"undefined"==typeof t.left&&(this.left=e.left),"undefined"==typeof t.top&&(this.top=e.top),this.pathOffset=this.pathOffset||{x:e.left+this.width/2,y:e.top+this.height/2}},_renderPathCommands:function(t){var e,i,r,n=null,s=0,a=0,c=0,h=0,l=0,u=0,f=-this.pathOffset.x,d=-this.pathOffset.y;t.beginPath();for(var p=0,g=this.path.length;g>p;++p){switch(e=this.path[p],e[0]){case"l":c+=e[1],h+=e[2],t.lineTo(c+f,h+d);break;case"L":c=e[1],h=e[2],t.lineTo(c+f,h+d);break;case"h":c+=e[1],t.lineTo(c+f,h+d);break;case"H":c=e[1],t.lineTo(c+f,h+d);break;case"v":h+=e[1],t.lineTo(c+f,h+d);break;case"V":h=e[1],t.lineTo(c+f,h+d);break;case"m":c+=e[1],h+=e[2],s=c,a=h,t.moveTo(c+f,h+d);break;case"M":c=e[1],h=e[2],s=c,a=h,t.moveTo(c+f,h+d);break;case"c":i=c+e[5],r=h+e[6],l=c+e[3],u=h+e[4],t.bezierCurveTo(c+e[1]+f,h+e[2]+d,l+f,u+d,i+f,r+d),c=i,h=r;break;case"C":c=e[5],h=e[6],l=e[3],u=e[4],t.bezierCurveTo(e[1]+f,e[2]+d,l+f,u+d,c+f,h+d);break;case"s":i=c+e[3],r=h+e[4],null===n[0].match(/[CcSs]/)?(l=c,u=h):(l=2*c-l,u=2*h-u),t.bezierCurveTo(l+f,u+d,c+e[1]+f,h+e[2]+d,i+f,r+d),l=c+e[1],u=h+e[2],c=i,h=r;break;case"S":i=e[3],r=e[4],null===n[0].match(/[CcSs]/)?(l=c,u=h):(l=2*c-l,u=2*h-u),t.bezierCurveTo(l+f,u+d,e[1]+f,e[2]+d,i+f,r+d),c=i,h=r,l=e[1],u=e[2];break;case"q":i=c+e[3],r=h+e[4],l=c+e[1],u=h+e[2],t.quadraticCurveTo(l+f,u+d,i+f,r+d),c=i,h=r;break;case"Q":i=e[3],r=e[4],t.quadraticCurveTo(e[1]+f,e[2]+d,i+f,r+d),c=i,h=r,l=e[1],u=e[2];break;case"t":i=c+e[1],r=h+e[2],null===n[0].match(/[QqTt]/)?(l=c,u=h):(l=2*c-l,u=2*h-u),t.quadraticCurveTo(l+f,u+d,i+f,r+d),c=i,h=r;break;case"T":i=e[1],r=e[2],null===n[0].match(/[QqTt]/)?(l=c,u=h):(l=2*c-l,u=2*h-u),t.quadraticCurveTo(l+f,u+d,i+f,r+d),c=i,h=r;break;case"a":o(t,c+f,h+d,[e[1],e[2],e[3],e[4],e[5],e[6]+c+f,e[7]+h+d]),c+=e[6],h+=e[7];break;case"A":o(t,c+f,h+d,[e[1],e[2],e[3],e[4],e[5],e[6]+f,e[7]+d]),c=e[6],h=e[7];break;case"z":case"Z":c=s,h=a,t.closePath()}n=e}},_render:function(t){this._renderPathCommands(t),this._renderPaintInOrder(t)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(t){var e=n(this.callSuper("toObject",t),{path:this.path.map(function(t){return t.slice()}),top:this.top,left:this.left});return e},toDatalessObject:function(t){var e=this.toObject(["sourcePath"].concat(t));return e.sourcePath&&delete e.path,e},toSVG:function(t){for(var e=[],i=this._createBaseSVGMarkup(),r="",n=0,s=this.path.length;s>n;n++)e.push(this.path[n].join(" "));var o=e.join(" ");return r=" translate("+-this.pathOffset.x+", "+-this.pathOffset.y+") ",i.push("<path ",this.getSvgId(),'d="',o,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),r,this.getSvgTransformMatrix(),'" stroke-linecap="round" ',this.addPaintOrder(),"/>\n"),t?t(i.join("")):i.join("")},complexity:function(){return this.path.length},_parsePath:function(){for(var t,e,i,r,n,s=[],o=[],h=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi,l=0,u=this.path.length;u>l;l++){for(t=this.path[l],r=t.slice(1).trim(),o.length=0;i=h.exec(r);)o.push(i[0]);n=[t.charAt(0)];for(var f=0,d=o.length;d>f;f++)e=parseFloat(o[f]),isNaN(e)||n.push(e);var p=n[0],g=a[p.toLowerCase()],v=c[p]||p;if(n.length-1>g)for(var b=1,m=n.length;m>b;b+=g)s.push([p].concat(n.slice(b,b+g))),p=v;else s.push(n)}return s},_parseDimensions:function(){for(var t,n,s,o,a=[],c=[],h=null,l=0,u=0,f=0,d=0,p=0,g=0,v=0,b=this.path.length;b>v;++v){switch(t=this.path[v],t[0]){case"l":f+=t[1],d+=t[2],o=[];break;case"L":f=t[1],d=t[2],o=[];break;case"h":f+=t[1],o=[];break;case"H":f=t[1],o=[];break;case"v":d+=t[1],o=[];break;case"V":d=t[1],o=[];break;case"m":f+=t[1],d+=t[2],l=f,u=d,o=[];break;case"M":f=t[1],d=t[2],l=f,u=d,o=[];break;case"c":n=f+t[5],s=d+t[6],p=f+t[3],g=d+t[4],o=e.util.getBoundsOfCurve(f,d,f+t[1],d+t[2],p,g,n,s),f=n,d=s;break;case"C":p=t[3],g=t[4],o=e.util.getBoundsOfCurve(f,d,t[1],t[2],p,g,t[5],t[6]),f=t[5],d=t[6];break;case"s":n=f+t[3],s=d+t[4],null===h[0].match(/[CcSs]/)?(p=f,g=d):(p=2*f-p,g=2*d-g),o=e.util.getBoundsOfCurve(f,d,p,g,f+t[1],d+t[2],n,s),p=f+t[1],g=d+t[2],f=n,d=s;break;case"S":n=t[3],s=t[4],null===h[0].match(/[CcSs]/)?(p=f,g=d):(p=2*f-p,g=2*d-g),o=e.util.getBoundsOfCurve(f,d,p,g,t[1],t[2],n,s),f=n,d=s,p=t[1],g=t[2];break;case"q":n=f+t[3],s=d+t[4],p=f+t[1],g=d+t[2],o=e.util.getBoundsOfCurve(f,d,p,g,p,g,n,s),f=n,d=s;break;case"Q":p=t[1],g=t[2],o=e.util.getBoundsOfCurve(f,d,p,g,p,g,t[3],t[4]),f=t[3],d=t[4];break;case"t":n=f+t[1],s=d+t[2],null===h[0].match(/[QqTt]/)?(p=f,g=d):(p=2*f-p,g=2*d-g),o=e.util.getBoundsOfCurve(f,d,p,g,p,g,n,s),f=n,d=s;break;case"T":n=t[1],s=t[2],null===h[0].match(/[QqTt]/)?(p=f,g=d):(p=2*f-p,g=2*d-g),o=e.util.getBoundsOfCurve(f,d,p,g,p,g,n,s),f=n,d=s;break;case"a":o=e.util.getBoundsOfArc(f,d,t[1],t[2],t[3],t[4],t[5],t[6]+f,t[7]+d),f+=t[6],d+=t[7];break;case"A":o=e.util.getBoundsOfArc(f,d,t[1],t[2],t[3],t[4],t[5],t[6],t[7]),f=t[6],d=t[7];break;case"z":case"Z":f=l,d=u}h=t,o.forEach(function(t){a.push(t.x),c.push(t.y)}),a.push(f),c.push(d)}var m=i(a)||0,y=i(c)||0,_=r(a)||0,w=r(c)||0,C=_-m,x=w-y,S={left:m,top:y,width:C,height:x};return S}}),e.Path.fromObject=function(t,i){if("string"==typeof t.sourcePath){var r=t.sourcePath;e.loadSVGFromURL(r,function(e){var r=e[0];r.setOptions(t),i&&i(r)})}else e.Object._fromObject("Path",t,i,"path")},e.Path.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat(["d"]),void(e.Path.fromElement=function(t,i,r){var s=e.parseAttributes(t,e.Path.ATTRIBUTE_NAMES);i(new e.Path(s.d,n(s,r)))}))}("undefined"!=typeof exports?exports:this);!function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,r=e.util.array.min,n=e.util.array.max;e.Group||(e.Group=e.util.createClass(e.Object,e.Collection,{type:"group",strokeWidth:0,subTargetCheck:!1,cacheProperties:[],useSetOnGroup:!1,initialize:function(t,e,i){e=e||{},this._objects=[],i&&this.callSuper("initialize",e),this._objects=t||[];for(var r=this._objects.length;r--;)this._objects[r].group=this;if(e.originX&&(this.originX=e.originX),e.originY&&(this.originY=e.originY),i)this._updateObjectsACoords();else{var n=e&&e.centerPoint;n||this._calcBounds(),this._updateObjectsCoords(n),delete e.centerPoint,this.callSuper("initialize",e)}this.setCoords()},_updateObjectsACoords:function(){for(var t=!0,e=!0,i=this._objects.length;i--;)this._objects[i].setCoords(t,e)},_updateObjectsCoords:function(t){for(var t=t||this.getCenterPoint(),e=this._objects.length;e--;)this._updateObjectCoords(this._objects[e],t)},_updateObjectCoords:function(t,e){var i=t.left,r=t.top,n=!0,s=!0;t.set({left:i-e.x,top:r-e.y}),t.group=this,t.setCoords(n,s)},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(t){return this._restoreObjectsState(),e.util.resetObjectTransform(this),t&&(this._objects.push(t),t.group=this,t._set("canvas",this.canvas)),this._calcBounds(),this._updateObjectsCoords(),this.setCoords(),this.dirty=!0,this},removeWithUpdate:function(t){return this._restoreObjectsState(),e.util.resetObjectTransform(this),this.remove(t),this._calcBounds(),this._updateObjectsCoords(),this.setCoords(),this.dirty=!0,this},_onObjectAdded:function(t){this.dirty=!0,t.group=this,t._set("canvas",this.canvas)},_onObjectRemoved:function(t){this.dirty=!0,delete t.group},_set:function(t,e){var i=this._objects.length;if(this.useSetOnGroup)for(;i--;)this._objects[i].setOnGroup(t,e);if("canvas"===t)for(i=this._objects.length;i--;)this._objects[i]._set(t,e);this.callSuper("_set",t,e)},toObject:function(t){var e=this.getObjects().map(function(e){var i=e.includeDefaultValues;e.includeDefaultValues=e.group.includeDefaultValues;var r=e.toObject(t);return e.includeDefaultValues=i,r});return i(this.callSuper("toObject",t),{objects:e})},toDatalessObject:function(t){var e,r=this.sourcePath;return e=r?r:this.getObjects().map(function(e){var i=e.includeDefaultValues;e.includeDefaultValues=e.group.includeDefaultValues;var r=e.toDatalessObject(t);return e.includeDefaultValues=i,r}),i(this.callSuper("toDatalessObject",t),{objects:e})},render:function(t){this._transformDone=!0,this.callSuper("render",t),this._transformDone=!1},shouldCache:function(){var t=this.objectCaching&&(!this.group||this.needsItsOwnCache()||!this.group.isOnACache());if(this.ownCaching=t,t)for(var e=0,i=this._objects.length;i>e;e++)if(this._objects[e].willDrawShadow())return this.ownCaching=!1,!1;return t},willDrawShadow:function(){if(this.shadow)return this.callSuper("willDrawShadow");for(var t=0,e=this._objects.length;e>t;t++)if(this._objects[t].willDrawShadow())return!0;return!1},isOnACache:function(){return this.ownCaching||this.group&&this.group.isOnACache()},drawObject:function(t){for(var e=0,i=this._objects.length;i>e;e++)this._objects[e].render(t)},isCacheDirty:function(){if(this.callSuper("isCacheDirty"))return!0;if(!this.statefullCache)return!1;for(var t=0,e=this._objects.length;e>t;t++)if(this._objects[t].isCacheDirty(!0)){if(this._cacheCanvas){var i=this.cacheWidth/this.zoomX,r=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-i/2,-r/2,i,r)}return!0}return!1},_restoreObjectsState:function(){return this._objects.forEach(this._restoreObjectState,this),this},realizeTransform:function(t){var i=t.calcTransformMatrix(),r=e.util.qrDecompose(i),n=new e.Point(r.translateX,r.translateY);return t.flipX=!1,t.flipY=!1,t.set("scaleX",r.scaleX),t.set("scaleY",r.scaleY),t.skewX=r.skewX,t.skewY=r.skewY,t.angle=r.angle,t.setPositionByOrigin(n,"center","center"),t},_restoreObjectState:function(t){return this.realizeTransform(t),t.setCoords(),delete t.group,this},destroy:function(){return this._objects.forEach(function(t){t.set("dirty",!0)}),this._restoreObjectsState()},toActiveSelection:function(){if(this.canvas){var t=this._objects,i=this.canvas;this._objects=[];var r=this.toObject();delete r.objects;var n=new e.ActiveSelection([]);return n.set(r),n.type="activeSelection",i.remove(this),t.forEach(function(t){t.group=n,t.dirty=!0,i.add(t)}),n.canvas=i,n._objects=t,i._activeObject=n,n.setCoords(),n}},ungroupOnCanvas:function(){return this._restoreObjectsState()},setObjectsCoords:function(){var t=!0,e=!0;return this.forEachObject(function(i){i.setCoords(t,e)}),this},_calcBounds:function(t){for(var e,i,r,n=[],s=[],o=["tr","br","bl","tl"],a=0,c=this._objects.length,h=o.length,l=!0;c>a;++a)for(e=this._objects[a],e.setCoords(l),r=0;h>r;r++)i=o[r],n.push(e.oCoords[i].x),s.push(e.oCoords[i].y);this.set(this._getBounds(n,s,t))},_getBounds:function(t,i,s){var o=new e.Point(r(t),r(i)),a=new e.Point(n(t),n(i)),c={width:a.x-o.x||0,height:a.y-o.y||0};return s||(c.left=o.x||0,c.top=o.y||0,"center"===this.originX&&(c.left+=c.width/2),"right"===this.originX&&(c.left+=c.width),"center"===this.originY&&(c.top+=c.height/2),"bottom"===this.originY&&(c.top+=c.height)),c},toSVG:function(t){var e=this._createBaseSVGMarkup();e.push("<g ",this.getSvgId(),'transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'" style="',this.getSvgFilter(),'">\n');for(var i=0,r=this._objects.length;r>i;i++)e.push("	",this._objects[i].toSVG(t));return e.push("</g>\n"),t?t(e.join("")):e.join("")}}),e.Group.fromObject=function(t,i){e.util.enlivenObjects(t.objects,function(r){var n=e.util.object.clone(t,!0);delete n.objects,i&&i(new e.Group(r,n,!0))})})}("undefined"!=typeof exports?exports:this);!function(t){"use strict";var e=t.fabric||(t.fabric={});e.ActiveSelection||(e.ActiveSelection=e.util.createClass(e.Group,{type:"activeSelection",initialize:function(t,i){i=i||{},this._objects=t||[];for(var r=this._objects.length;r--;)this._objects[r].group=this;i.originX&&(this.originX=i.originX),i.originY&&(this.originY=i.originY),this._calcBounds(),this._updateObjectsCoords(),e.Object.prototype.initialize.call(this,i),this.setCoords()},toGroup:function(){var t=this._objects;this._objects=[];var i=this.toObject(),r=new e.Group([]);if(delete i.objects,r.set(i),r.type="group",t.forEach(function(t){t.group=r,t.canvas.remove(t)}),r._objects=t,!this.canvas)return r;var n=this.canvas;return n.add(r),n._activeObject=r,r.setCoords(),r},onDeselect:function(){return this.destroy(),!1},toString:function(){return"#<fabric.ActiveSelection: ("+this.complexity()+")>"},_set:function(t,i){var r=this._objects.length;if("canvas"===t)for(;r--;)this._objects[r].set(t,i);if(this.useSetOnGroup)for(;r--;)this._objects[r].setOnGroup(t,i);e.Object.prototype._set.call(this,t,i)},shouldCache:function(){return!1},willDrawShadow:function(){if(this.shadow)return this.callSuper("willDrawShadow");for(var t=0,e=this._objects.length;e>t;t++)if(this._objects[t].willDrawShadow())return!0;return!1},isOnACache:function(){return!1},_renderControls:function(t,e,i){t.save(),t.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,this.callSuper("_renderControls",t,e),i=i||{},"undefined"==typeof i.hasControls&&(i.hasControls=!1),"undefined"==typeof i.hasRotatingPoint&&(i.hasRotatingPoint=!1),i.forActiveSelection=!0;for(var r=0,n=this._objects.length;n>r;r++)this._objects[r]._renderControls(t,i);t.restore()}}),e.ActiveSelection.fromObject=function(t,i){e.util.enlivenObjects(t.objects,function(r){delete t.objects,i&&i(new e.ActiveSelection(r,t,!0))})})}("undefined"!=typeof exports?exports:this);!function(t){"use strict";var e=fabric.util.object.extend;return t.fabric||(t.fabric={}),t.fabric.Image?void fabric.warn("fabric.Image is already defined."):(fabric.Image=fabric.util.createClass(fabric.Object,{type:"image",crossOrigin:"",strokeWidth:0,_lastScaleX:1,_lastScaleY:1,_filterScalingX:1,_filterScalingY:1,minimumScaleTrigger:.5,stateProperties:fabric.Object.prototype.stateProperties.concat("cropX","cropY"),objectCaching:!1,cacheKey:"",cropX:0,cropY:0,initialize:function(t,e){e||(e={}),this.filters=[],this.callSuper("initialize",e),this._initElement(t,e),this.cacheKey="texture"+fabric.Object.__uid++},getElement:function(){return this._element},setElement:function(t,e){var i=fabric.filterBackend;return i&&i.evictCachesForKey&&(i.evictCachesForKey(this.cacheKey),i.evictCachesForKey(this.cacheKey+"_filtered")),this._element=t,this._originalElement=t,this._initConfig(e),this.resizeFilter&&this.applyResizeFilters(),0!==this.filters.length&&this.applyFilters(),this},setCrossOrigin:function(t){return this.crossOrigin=t,this._element.crossOrigin=t,this},getOriginalSize:function(){var t=this.getElement();return{width:t.width,height:t.height}},_stroke:function(t){if(this.stroke&&0!==this.strokeWidth){var e=this.width/2,i=this.height/2;t.beginPath(),t.moveTo(-e,-i),t.lineTo(e,-i),t.lineTo(e,i),t.lineTo(-e,i),t.lineTo(-e,-i),t.closePath()}},_renderDashedStroke:function(t){var e=-this.width/2,i=-this.height/2,r=this.width,n=this.height;t.save(),this._setStrokeStyles(t,this),t.beginPath(),fabric.util.drawDashedLine(t,e,i,e+r,i,this.strokeDashArray),fabric.util.drawDashedLine(t,e+r,i,e+r,i+n,this.strokeDashArray),fabric.util.drawDashedLine(t,e+r,i+n,e,i+n,this.strokeDashArray),fabric.util.drawDashedLine(t,e,i+n,e,i,this.strokeDashArray),t.closePath(),t.restore()},toObject:function(t){var i=[];this.filters.forEach(function(t){t&&i.push(t.toObject())});var r=e(this.callSuper("toObject",["crossOrigin","cropX","cropY"].concat(t)),{src:this.getSrc(),filters:i});return this.resizeFilter&&(r.resizeFilter=this.resizeFilter.toObject()),r},toSVG:function(t){var e=this._createBaseSVGMarkup(),i=-this.width/2,r=-this.height/2;e.push('<g transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'">\n');var n=["	<image ",this.getSvgId(),'xlink:href="',this.getSvgSrc(!0),'" x="',i,'" y="',r,'" style="',this.getSvgStyles(),'" width="',this.width,'" height="',this.height,'"></image>\n'];if("fill"===this.paintFirst&&Array.prototype.push.apply(e,n),this.stroke||this.strokeDashArray){var s=this.fill;this.fill=null,e.push("	<rect ",'x="',i,'" y="',r,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),'"/>\n'),this.fill=s}return"fill"!==this.paintFirst&&Array.prototype.push.apply(e,n),e.push("</g>\n"),t?t(e.join("")):e.join("")},getSrc:function(t){var e=t?this._element:this._originalElement;return e?e.toDataURL?e.toDataURL():e.src:this.src||""},setSrc:function(t,e,i){return fabric.util.loadImage(t,function(t){this.setElement(t,i),e(this)},this,i&&i.crossOrigin),this},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},applyResizeFilters:function(){var t=this.resizeFilter,e=this.canvas?this.canvas.getRetinaScaling():1,i=this.minimumScaleTrigger,r=this.scaleX*e,n=this.scaleY*e,s=this._filteredEl||this._originalElement;if(!t||r>i&&n>i)return this._element=s,this._filterScalingX=1,void(this._filterScalingY=1);fabric.filterBackend||(fabric.filterBackend=fabric.initFilterBackend());var o=fabric.util.createCanvasElement(),a=this._filteredEl?this.cacheKey:this.cacheKey+"_filtered",c=s.width,h=s.height;o.width=c,o.height=h,this._element=o,t.scaleX=r,t.scaleY=n,fabric.filterBackend.applyFilters([t],s,c,h,this._element,a),this._filterScalingX=o.width/this._originalElement.width,this._filterScalingY=o.height/this._originalElement.height},applyFilters:function(t){if(t=t||this.filters||[],t=t.filter(function(t){return t}),0===t.length)return this._element=this._originalElement,this._filteredEl=null,this._filterScalingX=1,this._filterScalingY=1,this;var e=this._originalElement,i=e.naturalWidth||e.width,r=e.naturalHeight||e.height;if(this._element===this._originalElement){var n=fabric.util.createCanvasElement();n.width=i,n.height=r,this._element=n,this._filteredEl=n}else this._element.getContext("2d").clearRect(0,0,i,r);return fabric.filterBackend||(fabric.filterBackend=fabric.initFilterBackend()),fabric.filterBackend.applyFilters(t,this._originalElement,i,r,this._element,this.cacheKey),(this._originalElement.width!==this._element.width||this._originalElement.height!==this._element.height)&&(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height),this},_render:function(t){this.isMoving===!1&&this.resizeFilter&&this._needsResize()&&(this._lastScaleX=this.scaleX,this._lastScaleY=this.scaleY,this.applyResizeFilters()),this._stroke(t),this._renderPaintInOrder(t)},_renderFill:function(t){var e=this.width,i=this.height,r=e*this._filterScalingX,n=i*this._filterScalingY,s=-e/2,o=-i/2,a=this._element;a&&t.drawImage(a,this.cropX*this._filterScalingX,this.cropY*this._filterScalingY,r,n,s,o,e,i)},_needsResize:function(){return this.scaleX!==this._lastScaleX||this.scaleY!==this._lastScaleY},_resetWidthHeight:function(){var t=this.getElement();this.set("width",t.width),this.set("height",t.height)},_initElement:function(t,e){this.setElement(fabric.util.getById(t),e),fabric.util.addClass(this.getElement(),fabric.Image.CSS_CANVAS)},_initConfig:function(t){t||(t={}),this.setOptions(t),this._setWidthHeight(t),this._element&&this.crossOrigin&&(this._element.crossOrigin=this.crossOrigin)},_initFilters:function(t,e){t&&t.length?fabric.util.enlivenObjects(t,function(t){e&&e(t)},"fabric.Image.filters"):e&&e()},_setWidthHeight:function(t){this.width="width"in t?t.width:this.getElement()?this.getElement().width||0:0,this.height="height"in t?t.height:this.getElement()?this.getElement().height||0:0},parsePreserveAspectRatioAttribute:function(){var t,e=fabric.util.parsePreserveAspectRatioAttribute(this.preserveAspectRatio||""),i=this._element.width,r=this._element.height,n=1,s=1,o=0,a=0,c=0,h=0,l=this.width,u=this.height,f={width:l,height:u};return!e||"none"===e.alignX&&"none"===e.alignY?(n=l/i,s=u/r):("meet"===e.meetOrSlice&&(n=s=fabric.util.findScaleToFit(this._element,f),t=(l-i*n)/2,"Min"===e.alignX&&(o=-t),"Max"===e.alignX&&(o=t),t=(u-r*s)/2,"Min"===e.alignY&&(a=-t),"Max"===e.alignY&&(a=t)),"slice"===e.meetOrSlice&&(n=s=fabric.util.findScaleToCover(this._element,f),t=i-l/n,"Mid"===e.alignX&&(c=t/2),"Max"===e.alignX&&(c=t),t=r-u/s,"Mid"===e.alignY&&(h=t/2),"Max"===e.alignY&&(h=t),i=l/n,r=u/s)),{width:i,height:r,scaleX:n,scaleY:s,offsetLeft:o,offsetTop:a,cropX:c,cropY:h}}}),fabric.Image.CSS_CANVAS="canvas-img",fabric.Image.prototype.getSvgSrc=fabric.Image.prototype.getSrc,fabric.Image.fromObject=function(t,e){fabric.util.loadImage(t.src,function(i,r){return r?void(e&&e(null,r)):void fabric.Image.prototype._initFilters.call(t,t.filters,function(r){t.filters=r||[],fabric.Image.prototype._initFilters.call(t,[t.resizeFilter],function(r){t.resizeFilter=r[0];var n=new fabric.Image(i,t);e(n)})})},null,t.crossOrigin)},fabric.Image.fromURL=function(t,e,i){fabric.util.loadImage(t,function(t){e&&e(new fabric.Image(t,i))},null,i&&i.crossOrigin)},fabric.Image.ATTRIBUTE_NAMES=fabric.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href crossOrigin".split(" ")),void(fabric.Image.fromElement=function(t,i,r){var n=fabric.parseAttributes(t,fabric.Image.ATTRIBUTE_NAMES);fabric.Image.fromURL(n["xlink:href"],i,e(r?fabric.util.object.clone(r):{},n))}))}("undefined"!=typeof exports?exports:this);fabric.util.object.extend(fabric.Object.prototype,{_getAngleValueForStraighten:function(){var t=this.angle%360;return t>0?90*Math.round((t-1)/90):90*Math.round(t/90)},straighten:function(){return this.rotate(this._getAngleValueForStraighten()),this},fxStraighten:function(t){t=t||{};var e=function(){},i=t.onComplete||e,r=t.onChange||e,n=this;return fabric.util.animate({startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(t){n.rotate(t),r()},onComplete:function(){n.setCoords(),i()}}),this}}),fabric.util.object.extend(fabric.StaticCanvas.prototype,{straightenObject:function(t){return t.straighten(),this.requestRenderAll(),this},fxStraightenObject:function(t){return t.fxStraighten({onChange:this.requestRenderAllBound}),this}});function resizeCanvasIfNeeded(t){var e=t.targetCanvas,i=e.width,r=e.height,n=t.destinationWidth,s=t.destinationHeight;(i!==n||r!==s)&&(e.width=n,e.height=s)}function copyGLTo2DDrawImage(t,e){var i=t.canvas,r=e.targetCanvas,n=r.getContext("2d");n.translate(0,r.height),n.scale(1,-1);var s=i.height-r.height;n.drawImage(i,0,s,r.width,r.height,0,0,r.width,r.height)}function copyGLTo2DPutImageData(t,e){var i=e.targetCanvas,r=i.getContext("2d"),n=e.destinationWidth,s=e.destinationHeight,o=n*s*4,a=new Uint8Array(this.imageBuffer,0,o),c=new Uint8ClampedArray(this.imageBuffer,0,o);t.readPixels(0,0,n,s,t.RGBA,t.UNSIGNED_BYTE,a);var h=new ImageData(c,n,s);r.putImageData(h,0,0)}!function(){"use strict";function t(t,e){var i="precision "+e+" float;\nvoid main(){}",r=t.createShader(t.FRAGMENT_SHADER);return t.shaderSource(r,i),t.compileShader(r),t.getShaderParameter(r,t.COMPILE_STATUS)?!0:!1}function e(t){t&&t.tileSize&&(this.tileSize=t.tileSize),this.setupGLContext(this.tileSize,this.tileSize),this.captureGPUInfo()}fabric.isWebglSupported=function(e){if(fabric.isLikelyNode)return!1;e=e||fabric.WebglFilterBackend.prototype.tileSize;var i=document.createElement("canvas"),r=i.getContext("webgl")||i.getContext("experimental-webgl"),n=!1;if(r){fabric.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE),n=fabric.maxTextureSize>=e;for(var s=["highp","mediump","lowp"],o=0;3>o;o++)if(t(r,s[o])){fabric.webGlPrecision=s[o];break}}return this.isSupported=n,n},fabric.WebglFilterBackend=e,e.prototype={tileSize:2048,resources:{},setupGLContext:function(t,e){this.dispose(),this.createWebGLCanvas(t,e),this.aPosition=new Float32Array([0,0,0,1,1,0,1,1]),this.chooseFastestCopyGLTo2DMethod(t,e)},chooseFastestCopyGLTo2DMethod:function(t,e){var i,r="undefined"!=typeof window.performance;try{new ImageData(1,1),i=!0}catch(n){i=!1}var s="undefined"!=typeof ArrayBuffer,o="undefined"!=typeof Uint8ClampedArray;if(r&&i&&s&&o){var a,c,h,l=fabric.util.createCanvasElement(),u=new ArrayBuffer(t*e*4),f={imageBuffer:u,destinationWidth:t,destinationHeight:e,targetCanvas:l};l.width=t,l.height=e,a=window.performance.now(),copyGLTo2DDrawImage.call(f,this.gl,f),c=window.performance.now()-a,a=window.performance.now(),copyGLTo2DPutImageData.call(f,this.gl,f),h=window.performance.now()-a,c>h?(this.imageBuffer=u,this.copyGLTo2D=copyGLTo2DPutImageData):this.copyGLTo2D=copyGLTo2DDrawImage}},createWebGLCanvas:function(t,e){var i=fabric.util.createCanvasElement();i.width=t,i.height=e;var r={premultipliedAlpha:!1},n=i.getContext("webgl",r);n||(n=i.getContext("experimental-webgl",r)),n&&(n.clearColor(0,0,0,0),this.canvas=i,this.gl=n)},applyFilters:function(t,e,i,r,n,s){var o,a=this.gl;s&&(o=this.getCachedTexture(s,e));var c={originalWidth:e.width||e.originalWidth,originalHeight:e.height||e.originalHeight,sourceWidth:i,sourceHeight:r,destinationWidth:i,destinationHeight:r,context:a,sourceTexture:this.createTexture(a,i,r,!o&&e),targetTexture:this.createTexture(a,i,r),originalTexture:o||this.createTexture(a,i,r,!o&&e),passes:t.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:n},h=a.createFramebuffer();return a.bindFramebuffer(a.FRAMEBUFFER,h),t.forEach(function(t){t&&t.applyTo(c)}),resizeCanvasIfNeeded(c),this.copyGLTo2D(a,c),a.bindTexture(a.TEXTURE_2D,null),a.deleteTexture(c.sourceTexture),a.deleteTexture(c.targetTexture),a.deleteFramebuffer(h),n.getContext("2d").setTransform(1,0,0,1,0,0),c},applyFiltersDebug:function(t,e,i,r,n,s){var o=this.gl,a=this.applyFilters(t,e,i,r,n,s),c=o.getError();if(c!==o.NO_ERROR){var h=this.glErrorToString(o,c),l=new Error("WebGL Error "+h);throw l.glErrorCode=c,l}return a},glErrorToString:function(t,e){if(!t)return"Context undefined for error code: "+e;if("number"!=typeof e)return"Error code is not a number";switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"UNKNOWN_ERROR"}},dispose:function(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()},clearWebGLCaches:function(){this.programCache={},this.textureCache={}},createTexture:function(t,e,i,r){var n=t.createTexture();return t.bindTexture(t.TEXTURE_2D,n),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),r?t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,r):t.texImage2D(t.TEXTURE_2D,0,t.RGBA,e,i,0,t.RGBA,t.UNSIGNED_BYTE,null),n},getCachedTexture:function(t,e){if(this.textureCache[t])return this.textureCache[t];var i=this.createTexture(this.gl,e.width,e.height,e);return this.textureCache[t]=i,i},evictCachesForKey:function(t){this.textureCache[t]&&(this.gl.deleteTexture(this.textureCache[t]),delete this.textureCache[t])},copyGLTo2D:copyGLTo2DDrawImage,captureGPUInfo:function(){if(this.gpuInfo)return this.gpuInfo;var t=this.gl,e=t.getExtension("WEBGL_debug_renderer_info"),i={renderer:"",vendor:""};if(e){var r=t.getParameter(e.UNMASKED_RENDERER_WEBGL),n=t.getParameter(e.UNMASKED_VENDOR_WEBGL);r&&(i.renderer=r.toLowerCase()),n&&(i.vendor=n.toLowerCase())}return this.gpuInfo=i,i}}}();!function(){"use strict";function t(){}var e=function(){};fabric.Canvas2dFilterBackend=t,t.prototype={evictCachesForKey:e,dispose:e,clearWebGLCaches:e,resources:{},applyFilters:function(t,e,i,r,n){var s=n.getContext("2d");s.drawImage(e,0,0,i,r);var o=s.getImageData(0,0,i,r),a=s.getImageData(0,0,i,r),c={sourceWidth:i,sourceHeight:r,imageData:o,originalEl:e,originalImageData:a,canvasEl:n,ctx:s,filterBackend:this};return t.forEach(function(t){t.applyTo(c)}),(c.imageData.width!==i||c.imageData.height!==r)&&(n.width=c.imageData.width,n.height=c.imageData.height),s.putImageData(c.imageData,0,0),c}}}();fabric.Image.filters=fabric.Image.filters||{},fabric.Image.filters.BaseFilter=fabric.util.createClass({type:"BaseFilter",vertexSource:"attribute vec2 aPosition;\nvarying vec2 vTexCoord;\nvoid main() {\nvTexCoord = aPosition;\ngl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);\n}",fragmentSource:"precision highp float;\nvarying vec2 vTexCoord;\nuniform sampler2D uTexture;\nvoid main() {\ngl_FragColor = texture2D(uTexture, vTexCoord);\n}",initialize:function(t){t&&this.setOptions(t)},setOptions:function(t){for(var e in t)this[e]=t[e]},createProgram:function(t,e,i){e=e||this.fragmentSource,i=i||this.vertexSource,"highp"!==fabric.webGlPrecision&&(e=e.replace(/precision highp float/g,"precision "+fabric.webGlPrecision+" float"));var r=t.createShader(t.VERTEX_SHADER);if(t.shaderSource(r,i),t.compileShader(r),!t.getShaderParameter(r,t.COMPILE_STATUS))throw new Error("Vertex shader compile error for "+this.type+": "+t.getShaderInfoLog(r));var n=t.createShader(t.FRAGMENT_SHADER);if(t.shaderSource(n,e),t.compileShader(n),!t.getShaderParameter(n,t.COMPILE_STATUS))throw new Error("Fragment shader compile error for "+this.type+": "+t.getShaderInfoLog(n));var s=t.createProgram();if(t.attachShader(s,r),t.attachShader(s,n),t.linkProgram(s),!t.getProgramParameter(s,t.LINK_STATUS))throw new Error('Shader link error for "${this.type}" '+t.getProgramInfoLog(s));var o=this.getAttributeLocations(t,s),a=this.getUniformLocations(t,s)||{};return a.uStepW=t.getUniformLocation(s,"uStepW"),a.uStepH=t.getUniformLocation(s,"uStepH"),{program:s,attributeLocations:o,uniformLocations:a}},getAttributeLocations:function(t,e){return{aPosition:t.getAttribLocation(e,"aPosition")}},getUniformLocations:function(){return{}},sendAttributeData:function(t,e,i){var r=e.aPostion,n=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,n),t.enableVertexAttribArray(r),t.vertexAttribPointer(r,2,t.FLOAT,!1,0,0),t.bufferData(t.ARRAY_BUFFER,i,t.STATIC_DRAW)},_setupFrameBuffer:function(t){var e,i,r=t.context;t.passes>1?(e=t.destinationWidth,i=t.destinationHeight,(t.sourceWidth!==e||t.sourceHeight!==i)&&(r.deleteTexture(t.targetTexture),t.targetTexture=t.filterBackend.createTexture(r,e,i)),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,t.targetTexture,0)):(r.bindFramebuffer(r.FRAMEBUFFER,null),r.finish())},_swapTextures:function(t){t.passes--,t.pass++;var e=t.targetTexture;t.targetTexture=t.sourceTexture,t.sourceTexture=e},isNeutralState:function(){return!1},applyTo:function(t){if(t.webgl){if(t.passes>1&&this.isNeutralState(t))return;this._setupFrameBuffer(t),this.applyToWebGL(t),this._swapTextures(t)}else this.isNeutralState()||this.applyTo2d(t)},retrieveShader:function(t){return t.programCache.hasOwnProperty(this.type)||(t.programCache[this.type]=this.createProgram(t.context)),t.programCache[this.type]},applyToWebGL:function(t){var e=t.context,i=this.retrieveShader(t);0===t.pass&&t.originalTexture?e.bindTexture(e.TEXTURE_2D,t.originalTexture):e.bindTexture(e.TEXTURE_2D,t.sourceTexture),e.useProgram(i.program),this.sendAttributeData(e,i.attributeLocations,t.aPosition),e.uniform1f(i.uniformLocations.uStepW,1/t.sourceWidth),e.uniform1f(i.uniformLocations.uStepH,1/t.sourceHeight),this.sendUniformData(e,i.uniformLocations),e.viewport(0,0,t.destinationWidth,t.destinationHeight),e.drawArrays(e.TRIANGLE_STRIP,0,4)},bindAdditionalTexture:function(t,e,i){t.activeTexture(i),t.bindTexture(t.TEXTURE_2D,e),t.activeTexture(t.TEXTURE0)},unbindAdditionalTexture:function(t,e){t.activeTexture(e),t.bindTexture(t.TEXTURE_2D,null),t.activeTexture(t.TEXTURE0)},getMainParameter:function(){return this[this.mainParameter]},setMainParameter:function(t){this[this.mainParameter]=t},sendUniformData:function(){},createHelpLayer:function(t){if(!t.helpLayer){var e=document.createElement("canvas");e.width=t.sourceWidth,e.height=t.sourceHeight,t.helpLayer=e}},toObject:function(){var t={type:this.type},e=this.mainParameter;return e&&(t[e]=this[e]),t},toJSON:function(){return this.toObject()}}),fabric.Image.filters.BaseFilter.fromObject=function(t,e){var i=new fabric.Image.filters[t.type](t);return e&&e(i),i};!function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,r=e.util.createClass;i.ColorMatrix=r(i.BaseFilter,{type:"ColorMatrix",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nvarying vec2 vTexCoord;\nuniform mat4 uColorMatrix;\nuniform vec4 uConstants;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ncolor *= uColorMatrix;\ncolor += uConstants;\ngl_FragColor = color;\n}",matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],mainParameter:"matrix",colorsOnly:!0,initialize:function(t){this.callSuper("initialize",t),this.matrix=this.matrix.slice(0)},isNeutralState:function(){for(var t=i.ColorMatrix,e=20;e--;)if(this.matrix[e]!==t.prototype.matrix[e])return!1;return!0},applyTo2d:function(t){var e,i,r,n,s,o=t.imageData,a=o.data,c=a.length,h=this.matrix,l=this.colorsOnly;for(s=0;c>s;s+=4)e=a[s],i=a[s+1],r=a[s+2],l?(a[s]=e*h[0]+i*h[1]+r*h[2]+255*h[4],a[s+1]=e*h[5]+i*h[6]+r*h[7]+255*h[9],a[s+2]=e*h[10]+i*h[11]+r*h[12]+255*h[14]):(n=a[s+3],a[s]=e*h[0]+i*h[1]+r*h[2]+n*h[3]+255*h[4],a[s+1]=e*h[5]+i*h[6]+r*h[7]+n*h[8]+255*h[9],a[s+2]=e*h[10]+i*h[11]+r*h[12]+n*h[13]+255*h[14],a[s+3]=e*h[15]+i*h[16]+r*h[17]+n*h[18]+255*h[19])},getUniformLocations:function(t,e){return{uColorMatrix:t.getUniformLocation(e,"uColorMatrix"),uConstants:t.getUniformLocation(e,"uConstants")}},sendUniformData:function(t,e){var i=this.matrix,r=[i[0],i[1],i[2],i[3],i[5],i[6],i[7],i[8],i[10],i[11],i[12],i[13],i[15],i[16],i[17],i[18]],n=[i[4],i[9],i[14],i[19]];t.uniformMatrix4fv(e.uColorMatrix,!1,r),t.uniform4fv(e.uConstants,n)}}),e.Image.filters.ColorMatrix.fromObject=e.Image.filters.BaseFilter.fromObject}("undefined"!=typeof exports?exports:this);!function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,r=e.util.createClass;i.Brightness=r(i.BaseFilter,{type:"Brightness",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uBrightness;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ncolor.rgb += uBrightness;\ngl_FragColor = color;\n}",brightness:0,mainParameter:"brightness",applyTo2d:function(t){if(0!==this.brightness){var e,i=t.imageData,r=i.data,n=r.length,s=Math.round(255*this.brightness);for(e=0;n>e;e+=4)r[e]=r[e]+s,r[e+1]=r[e+1]+s,r[e+2]=r[e+2]+s}},getUniformLocations:function(t,e){return{uBrightness:t.getUniformLocation(e,"uBrightness")}},sendUniformData:function(t,e){t.uniform1f(e.uBrightness,this.brightness)}}),e.Image.filters.Brightness.fromObject=e.Image.filters.BaseFilter.fromObject}("undefined"!=typeof exports?exports:this);!function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,r=e.Image.filters,n=e.util.createClass;r.Convolute=n(r.BaseFilter,{type:"Convolute",opaque:!1,matrix:[0,0,0,0,1,0,0,0,0],fragmentSource:{Convolute_3_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[9];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 3.0; h+=1.0) {\nfor (float w = 0.0; w < 3.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_3_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[9];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 3.0; h+=1.0) {\nfor (float w = 0.0; w < 3.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}",Convolute_5_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[25];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 5.0; h+=1.0) {\nfor (float w = 0.0; w < 5.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_5_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[25];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 5.0; h+=1.0) {\nfor (float w = 0.0; w < 5.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}",Convolute_7_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[49];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 7.0; h+=1.0) {\nfor (float w = 0.0; w < 7.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_7_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[49];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 7.0; h+=1.0) {\nfor (float w = 0.0; w < 7.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}",Convolute_9_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[81];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 9.0; h+=1.0) {\nfor (float w = 0.0; w < 9.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_9_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[81];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 9.0; h+=1.0) {\nfor (float w = 0.0; w < 9.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}"},retrieveShader:function(t){var e=Math.sqrt(this.matrix.length),i=this.type+"_"+e+"_"+(this.opaque?1:0),r=this.fragmentSource[i];return t.programCache.hasOwnProperty(i)||(t.programCache[i]=this.createProgram(t.context,r)),t.programCache[i]},applyTo2d:function(t){var e,i,r,n,s,o,a,c,h,l,u,f,d,g=t.imageData,p=g.data,v=this.matrix,b=Math.round(Math.sqrt(v.length)),m=Math.floor(b/2),y=g.width,_=g.height,x=t.ctx.createImageData(y,_),C=x.data,w=this.opaque?1:0;for(u=0;_>u;u++)for(l=0;y>l;l++){for(s=4*(u*y+l),e=0,i=0,r=0,n=0,d=0;b>d;d++)for(f=0;b>f;f++)a=u+d-m,o=l+f-m,0>a||a>_||0>o||o>y||(c=4*(a*y+o),h=v[d*b+f],e+=p[c]*h,i+=p[c+1]*h,r+=p[c+2]*h,w||(n+=p[c+3]*h));C[s]=e,C[s+1]=i,C[s+2]=r,C[s+3]=w?p[s+3]:n}t.imageData=x},getUniformLocations:function(t,e){return{uMatrix:t.getUniformLocation(e,"uMatrix"),uOpaque:t.getUniformLocation(e,"uOpaque"),uHalfSize:t.getUniformLocation(e,"uHalfSize"),uSize:t.getUniformLocation(e,"uSize")}},sendUniformData:function(t,e){t.uniform1fv(e.uMatrix,this.matrix)},toObject:function(){return i(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}}),e.Image.filters.Convolute.fromObject=e.Image.filters.BaseFilter.fromObject}("undefined"!=typeof exports?exports:this);!function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,r=e.util.createClass;i.Grayscale=r(i.BaseFilter,{type:"Grayscale",fragmentSource:{average:"precision highp float;\nuniform sampler2D uTexture;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nfloat average = (color.r + color.b + color.g) / 3.0;\ngl_FragColor = vec4(average, average, average, color.a);\n}",lightness:"precision highp float;\nuniform sampler2D uTexture;\nuniform int uMode;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 col = texture2D(uTexture, vTexCoord);\nfloat average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;\ngl_FragColor = vec4(average, average, average, col.a);\n}",luminosity:"precision highp float;\nuniform sampler2D uTexture;\nuniform int uMode;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 col = texture2D(uTexture, vTexCoord);\nfloat average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;\ngl_FragColor = vec4(average, average, average, col.a);\n}"},mode:"average",mainParameter:"mode",applyTo2d:function(t){var e,i,r=t.imageData,n=r.data,s=n.length,o=this.mode;for(e=0;s>e;e+=4)"average"===o?i=(n[e]+n[e+1]+n[e+2])/3:"lightness"===o?i=(Math.min(n[e],n[e+1],n[e+2])+Math.max(n[e],n[e+1],n[e+2]))/2:"luminosity"===o&&(i=.21*n[e]+.72*n[e+1]+.07*n[e+2]),n[e]=i,n[e+1]=i,n[e+2]=i},retrieveShader:function(t){var e=this.type+"_"+this.mode;if(!t.programCache.hasOwnProperty(e)){var i=this.fragmentSource[this.mode];t.programCache[e]=this.createProgram(t.context,i)}return t.programCache[e]},getUniformLocations:function(t,e){return{uMode:t.getUniformLocation(e,"uMode")}},sendUniformData:function(t,e){var i=1;t.uniform1i(e.uMode,i)}}),e.Image.filters.Grayscale.fromObject=e.Image.filters.BaseFilter.fromObject}("undefined"!=typeof exports?exports:this);!function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,r=e.util.createClass;i.Invert=r(i.BaseFilter,{type:"Invert",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform int uInvert;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nif (uInvert == 1) {\ngl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);\n} else {\ngl_FragColor = color;\n}\n}",invert:!0,mainParameter:"invert",applyTo2d:function(t){if(this.invert){var e,i=t.imageData,r=i.data,n=r.length;for(e=0;n>e;e+=4)r[e]=255-r[e],r[e+1]=255-r[e+1],r[e+2]=255-r[e+2]}},getUniformLocations:function(t,e){return{uInvert:t.getUniformLocation(e,"uInvert")}},sendUniformData:function(t,e){t.uniform1i(e.uInvert,this.invert)}}),e.Image.filters.Invert.fromObject=e.Image.filters.BaseFilter.fromObject}("undefined"!=typeof exports?exports:this);!function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,r=e.Image.filters,n=e.util.createClass;r.Noise=n(r.BaseFilter,{type:"Noise",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uStepH;\nuniform float uNoise;\nuniform float uSeed;\nvarying vec2 vTexCoord;\nfloat rand(vec2 co, float seed, float vScale) {\nreturn fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);\n}\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ncolor.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;\ngl_FragColor = color;\n}",mainParameter:"noise",noise:0,applyTo2d:function(t){if(0!==this.noise){var e,i,r=t.imageData,n=r.data,s=n.length,o=this.noise;for(e=0,s=n.length;s>e;e+=4)i=(.5-Math.random())*o,n[e]+=i,n[e+1]+=i,n[e+2]+=i}},getUniformLocations:function(t,e){return{uNoise:t.getUniformLocation(e,"uNoise"),uSeed:t.getUniformLocation(e,"uSeed")}},sendUniformData:function(t,e){t.uniform1f(e.uNoise,this.noise/255),t.uniform1f(e.uSeed,Math.random())},toObject:function(){return i(this.callSuper("toObject"),{noise:this.noise})}}),e.Image.filters.Noise.fromObject=e.Image.filters.BaseFilter.fromObject}("undefined"!=typeof exports?exports:this);!function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,r=e.util.createClass;i.Pixelate=r(i.BaseFilter,{type:"Pixelate",blocksize:4,mainParameter:"blocksize",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uBlocksize;\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nfloat blockW = uBlocksize * uStepW;\nfloat blockH = uBlocksize * uStepW;\nint posX = int(vTexCoord.x / blockW);\nint posY = int(vTexCoord.y / blockH);\nfloat fposX = float(posX);\nfloat fposY = float(posY);\nvec2 squareCoords = vec2(fposX * blockW, fposY * blockH);\nvec4 color = texture2D(uTexture, squareCoords);\ngl_FragColor = color;\n}",applyTo2d:function(t){if(1!==this.blocksize){var e,i,r,n,s,o,a,c,h,l,u,f=t.imageData,d=f.data,g=f.height,p=f.width;for(i=0;g>i;i+=this.blocksize)for(r=0;p>r;r+=this.blocksize)for(e=4*i*p+4*r,n=d[e],s=d[e+1],o=d[e+2],a=d[e+3],l=Math.min(i+this.blocksize,g),u=Math.min(r+this.blocksize,p),c=i;l>c;c++)for(h=r;u>h;h++)e=4*c*p+4*h,d[e]=n,d[e+1]=s,d[e+2]=o,d[e+3]=a}},isNeutralState:function(){return 1===this.blocksize},getUniformLocations:function(t,e){return{uBlocksize:t.getUniformLocation(e,"uBlocksize"),uStepW:t.getUniformLocation(e,"uStepW"),uStepH:t.getUniformLocation(e,"uStepH")}},sendUniformData:function(t,e){t.uniform1f(e.uBlocksize,this.blocksize)}}),e.Image.filters.Pixelate.fromObject=e.Image.filters.BaseFilter.fromObject}("undefined"!=typeof exports?exports:this);!function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,r=e.Image.filters,n=e.util.createClass;r.RemoveColor=n(r.BaseFilter,{type:"RemoveColor",color:"#FFFFFF",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec4 uLow;\nuniform vec4 uHigh;\nvarying vec2 vTexCoord;\nvoid main() {\ngl_FragColor = texture2D(uTexture, vTexCoord);\nif(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {\ngl_FragColor.a = 0.0;\n}\n}",distance:.02,useAlpha:!1,applyTo2d:function(t){var i,r,n,o,s=t.imageData,a=s.data,c=255*this.distance,h=new e.Color(this.color).getSource(),l=[h[0]-c,h[1]-c,h[2]-c],u=[h[0]+c,h[1]+c,h[2]+c];for(i=0;i<a.length;i+=4)r=a[i],n=a[i+1],o=a[i+2],r>l[0]&&n>l[1]&&o>l[2]&&r<u[0]&&n<u[1]&&o<u[2]&&(a[i+3]=0)},getUniformLocations:function(t,e){return{uLow:t.getUniformLocation(e,"uLow"),uHigh:t.getUniformLocation(e,"uHigh")}},sendUniformData:function(t,i){var r=new e.Color(this.color).getSource(),n=parseFloat(this.distance),o=[0+r[0]/255-n,0+r[1]/255-n,0+r[2]/255-n,1],s=[r[0]/255+n,r[1]/255+n,r[2]/255+n,1];t.uniform4fv(i.uLow,o),t.uniform4fv(i.uHigh,s)},toObject:function(){return i(this.callSuper("toObject"),{color:this.color,distance:this.distance})}}),e.Image.filters.RemoveColor.fromObject=e.Image.filters.BaseFilter.fromObject}("undefined"!=typeof exports?exports:this);!function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,r=e.util.createClass,n={Brownie:[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0],Vintage:[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0],Kodachrome:[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0],Technicolor:[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0],Polaroid:[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],Sepia:[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0],BlackWhite:[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]};for(var o in n)i[o]=r(i.ColorMatrix,{type:o,matrix:n[o],mainParameter:!1,colorsOnly:!0}),e.Image.filters[o].fromObject=e.Image.filters.BaseFilter.fromObject}("undefined"!=typeof exports?exports:this);!function(t){"use strict";var e=t.fabric,i=e.Image.filters,r=e.util.createClass;i.BlendColor=r(i.BaseFilter,{type:"BlendColor",color:"#F95C63",mode:"multiply",alpha:1,fragmentSource:{multiply:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec4 uColor;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ncolor.rgb *= uColor.rgb;\ngl_FragColor = color;\n}",screen:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec4 uColor;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ncolor.rgb = 1.0 - (1.0 - color.rgb) * (1.0 - uColor.rgb);\ngl_FragColor = color;\n}",add:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec4 uColor;\nvarying vec2 vTexCoord;\nvoid main() {\ngl_FragColor = texture2D(uTexture, vTexCoord);\ngl_FragColor.rgb += uColor.rgb;\n}",diff:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec4 uColor;\nvarying vec2 vTexCoord;\nvoid main() {\ngl_FragColor = texture2D(uTexture, vTexCoord);\ngl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);\n}",subtract:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec4 uColor;\nvarying vec2 vTexCoord;\nvoid main() {\ngl_FragColor = texture2D(uTexture, vTexCoord);\ngl_FragColor.rgb -= uColor.rgb;\n}",lighten:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec4 uColor;\nvarying vec2 vTexCoord;\nvoid main() {\ngl_FragColor = texture2D(uTexture, vTexCoord);\ngl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);\n}",darken:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec4 uColor;\nvarying vec2 vTexCoord;\nvoid main() {\ngl_FragColor = texture2D(uTexture, vTexCoord);\ngl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);\n}",exclusion:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec4 uColor;\nvarying vec2 vTexCoord;\nvoid main() {\ngl_FragColor = texture2D(uTexture, vTexCoord);\ngl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);\n}",overlay:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec4 uColor;\nvarying vec2 vTexCoord;\nvoid main() {\ngl_FragColor = texture2D(uTexture, vTexCoord);\nif (uColor.r < 0.5) {\ngl_FragColor.r *= 2.0 * uColor.r;\n} else {\ngl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);\n}\nif (uColor.g < 0.5) {\ngl_FragColor.g *= 2.0 * uColor.g;\n} else {\ngl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);\n}\nif (uColor.b < 0.5) {\ngl_FragColor.b *= 2.0 * uColor.b;\n} else {\ngl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);\n}\n}",tint:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec4 uColor;\nvarying vec2 vTexCoord;\nvoid main() {\ngl_FragColor = texture2D(uTexture, vTexCoord);\ngl_FragColor.rgb *= (1.0 - uColor.a);\ngl_FragColor.rgb += uColor.rgb;\n}"},retrieveShader:function(t){var e=this.type+"_"+this.mode,i=this.fragmentSource[this.mode];return t.programCache.hasOwnProperty(e)||(t.programCache[e]=this.createProgram(t.context,i)),t.programCache[e]},applyTo2d:function(t){var i,r,n,o,s,a,c,h=t.imageData,l=h.data,u=l.length,f=1-this.alpha;c=new e.Color(this.color).getSource(),i=c[0]*this.alpha,r=c[1]*this.alpha,n=c[2]*this.alpha;for(var d=0;u>d;d+=4)switch(o=l[d],s=l[d+1],a=l[d+2],this.mode){case"multiply":l[d]=o*i/255,l[d+1]=s*r/255,l[d+2]=a*n/255;break;case"screen":l[d]=255-(255-o)*(255-i)/255,l[d+1]=255-(255-s)*(255-r)/255,l[d+2]=255-(255-a)*(255-n)/255;break;case"add":l[d]=o+i,l[d+1]=s+r,l[d+2]=a+n;break;case"diff":case"difference":l[d]=Math.abs(o-i),l[d+1]=Math.abs(s-r),l[d+2]=Math.abs(a-n);break;case"subtract":l[d]=o-i,l[d+1]=s-r,l[d+2]=a-n;break;case"darken":l[d]=Math.min(o,i),l[d+1]=Math.min(s,r),l[d+2]=Math.min(a,n);break;case"lighten":l[d]=Math.max(o,i),l[d+1]=Math.max(s,r),l[d+2]=Math.max(a,n);break;case"overlay":l[d]=128>i?2*o*i/255:255-2*(255-o)*(255-i)/255,l[d+1]=128>r?2*s*r/255:255-2*(255-s)*(255-r)/255,l[d+2]=128>n?2*a*n/255:255-2*(255-a)*(255-n)/255;break;case"exclusion":l[d]=i+o-2*i*o/255,l[d+1]=r+s-2*r*s/255,l[d+2]=n+a-2*n*a/255;break;case"tint":l[d]=i+o*f,l[d+1]=r+s*f,l[d+2]=n+a*f}},getUniformLocations:function(t,e){return{uColor:t.getUniformLocation(e,"uColor")}},sendUniformData:function(t,i){var r=new e.Color(this.color).getSource();r[0]=this.alpha*r[0]/255,r[1]=this.alpha*r[1]/255,r[2]=this.alpha*r[2]/255,r[3]=this.alpha,t.uniform4fv(i.uColor,r)},toObject:function(){return{type:this.type,color:this.color,mode:this.mode,alpha:this.alpha}}}),e.Image.filters.BlendColor.fromObject=e.Image.filters.BaseFilter.fromObject}("undefined"!=typeof exports?exports:this);!function(t){"use strict";var e=t.fabric||(t.fabric={}),i=Math.pow,r=Math.floor,n=Math.sqrt,o=Math.abs,s=Math.round,a=Math.sin,c=Math.ceil,h=e.Image.filters,l=e.util.createClass;h.Resize=l(h.BaseFilter,{type:"Resize",resizeType:"hermite",scaleX:0,scaleY:0,lanczosLobes:3,getUniformLocations:function(t,e){return{uDelta:t.getUniformLocation(e,"uDelta"),uTaps:t.getUniformLocation(e,"uTaps")}},sendUniformData:function(t,e){t.uniform2fv(e.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),t.uniform1fv(e.uTaps,this.taps)},retrieveShader:function(t){var e=this.getFilterWindow(),i=this.type+"_"+e;if(!t.programCache.hasOwnProperty(i)){var r=this.generateShader(e);t.programCache[i]=this.createProgram(t.context,r)}return t.programCache[i]},getFilterWindow:function(){var t=this.tempScale;return Math.ceil(this.lanczosLobes/t)},getTaps:function(){for(var t=this.lanczosCreate(this.lanczosLobes),e=this.tempScale,i=this.getFilterWindow(),r=new Array(i),n=1;i>=n;n++)r[n-1]=t(n*e);return r},generateShader:function(t){for(var t,e=new Array(t),i=this.fragmentSourceTOP,r=1;t>=r;r++)e[r-1]=r+".0 * uDelta";return i+="uniform float uTaps["+t+"];\n",i+="void main() {\n",i+="  vec4 color = texture2D(uTexture, vTexCoord);\n",i+="  float sum = 1.0;\n",e.forEach(function(t,e){i+="  color += texture2D(uTexture, vTexCoord + "+t+") * uTaps["+e+"];\n",i+="  color += texture2D(uTexture, vTexCoord - "+t+") * uTaps["+e+"];\n",i+="  sum += 2.0 * uTaps["+e+"];\n"}),i+="  gl_FragColor = color / sum;\n",i+="}"},fragmentSourceTOP:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec2 uDelta;\nvarying vec2 vTexCoord;\n",applyTo:function(t){if(t.webgl){if(t.passes>1&&this.isNeutralState(t))return;t.passes++,this.width=t.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=t.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),t.destinationWidth=this.dW,this._setupFrameBuffer(t),this.applyToWebGL(t),this._swapTextures(t),t.sourceWidth=t.destinationWidth,this.height=t.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),t.destinationHeight=this.dH,this._setupFrameBuffer(t),this.applyToWebGL(t),this._swapTextures(t),t.sourceHeight=t.destinationHeight}else this.isNeutralState(t)||this.applyTo2d(t)},isNeutralState:function(t){var e=t.scaleX||this.scaleX,i=t.scaleY||this.scaleY;return 1===e&&1===i},lanczosCreate:function(t){return function(e){if(e>=t||-t>=e)return 0;if(1.1920929e-7>e&&e>-1.1920929e-7)return 1;e*=Math.PI;var i=e/t;return a(e)/e*a(i)/i}},applyTo2d:function(t){var e=t.imageData,i=this.scaleX,r=this.scaleY;this.rcpScaleX=1/i,this.rcpScaleY=1/r;var n,o=e.width,a=e.height,c=s(o*i),h=s(a*r);"sliceHack"===this.resizeType?n=this.sliceByTwo(t,o,a,c,h):"hermite"===this.resizeType?n=this.hermiteFastResize(t,o,a,c,h):"bilinear"===this.resizeType?n=this.bilinearFiltering(t,o,a,c,h):"lanczos"===this.resizeType&&(n=this.lanczosResize(t,o,a,c,h)),t.imageData=n},sliceByTwo:function(t,i,n,o,s){var a,c,h=t.imageData,l=.5,u=!1,f=!1,d=i*l,g=n*l,p=e.filterBackend.resources,v=0,m=0,b=i,y=0;for(p.sliceByTwo||(p.sliceByTwo=document.createElement("canvas")),a=p.sliceByTwo,(a.width<1.5*i||a.height<n)&&(a.width=1.5*i,a.height=n),c=a.getContext("2d"),c.clearRect(0,0,1.5*i,n),c.putImageData(h,0,0),o=r(o),s=r(s);!u||!f;)i=d,n=g,o<r(d*l)?d=r(d*l):(d=o,u=!0),s<r(g*l)?g=r(g*l):(g=s,f=!0),c.drawImage(a,v,m,i,n,b,y,d,g),v=b,m=y,y+=g;return c.getImageData(v,m,o,s)},lanczosResize:function(t,e,s,a,h){function l(t){var c,S,T,O,j,k,P,E,D,A,F;for(C.x=(t+.5)*p,w.x=r(C.x),c=0;h>c;c++){for(C.y=(c+.5)*v,w.y=r(C.y),j=0,k=0,P=0,E=0,D=0,S=w.x-y;S<=w.x+y;S++)if(!(0>S||S>=e)){A=r(1e3*o(S-C.x)),x[A]||(x[A]={});for(var M=w.y-_;M<=w.y+_;M++)0>M||M>=s||(F=r(1e3*o(M-C.y)),x[A][F]||(x[A][F]=g(n(i(A*m,2)+i(F*b,2))/1e3)),T=x[A][F],T>0&&(O=4*(M*e+S),j+=T,k+=T*u[O],P+=T*u[O+1],E+=T*u[O+2],D+=T*u[O+3]))}O=4*(c*a+t),d[O]=k/j,d[O+1]=P/j,d[O+2]=E/j,d[O+3]=D/j}return++t<a?l(t):f}var u=t.imageData.data,f=t.ctx.createImageData(a,h),d=f.data,g=this.lanczosCreate(this.lanczosLobes),p=this.rcpScaleX,v=this.rcpScaleY,m=2/this.rcpScaleX,b=2/this.rcpScaleY,y=c(p*this.lanczosLobes/2),_=c(v*this.lanczosLobes/2),x={},C={},w={};return l(0)},bilinearFiltering:function(t,e,i,n,o){var s,a,c,h,l,u,f,d,g,p,v,m,b,y=0,_=this.rcpScaleX,x=this.rcpScaleY,C=4*(e-1),w=t.imageData,S=w.data,T=t.ctx.createImageData(n,o),O=T.data;for(f=0;o>f;f++)for(d=0;n>d;d++)for(l=r(_*d),u=r(x*f),g=_*d-l,p=x*f-u,b=4*(u*e+l),v=0;4>v;v++)s=S[b+v],a=S[b+4+v],c=S[b+C+v],h=S[b+C+4+v],m=s*(1-g)*(1-p)+a*g*(1-p)+c*p*(1-g)+h*g*p,O[y++]=m;return T},hermiteFastResize:function(t,e,i,s,a){for(var h=this.rcpScaleX,l=this.rcpScaleY,u=c(h/2),f=c(l/2),d=t.imageData,g=d.data,p=t.ctx.createImageData(s,a),v=p.data,m=0;a>m;m++)for(var b=0;s>b;b++){for(var y=4*(b+m*s),_=0,x=0,C=0,w=0,S=0,T=0,O=0,j=(m+.5)*l,k=r(m*l);(m+1)*l>k;k++)for(var P=o(j-(k+.5))/f,E=(b+.5)*h,D=P*P,A=r(b*h);(b+1)*h>A;A++){var F=o(E-(A+.5))/u,M=n(D+F*F);M>1&&-1>M||(_=2*M*M*M-3*M*M+1,_>0&&(F=4*(A+k*e),O+=_*g[F+3],C+=_,g[F+3]<255&&(_=_*g[F+3]/250),w+=_*g[F],S+=_*g[F+1],T+=_*g[F+2],x+=_))}v[y]=w/x,v[y+1]=S/x,v[y+2]=T/x,v[y+3]=O/C}return p},toObject:function(){return{type:this.type,scaleX:this.scaleX,scaleY:this.scaleY,resizeType:this.resizeType,lanczosLobes:this.lanczosLobes}}}),e.Image.filters.Resize.fromObject=e.Image.filters.BaseFilter.fromObject}("undefined"!=typeof exports?exports:this);!function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,r=e.util.createClass;i.Contrast=r(i.BaseFilter,{type:"Contrast",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uContrast;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nfloat contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));\ncolor.rgb = contrastF * (color.rgb - 0.5) + 0.5;\ngl_FragColor = color;\n}",contrast:0,mainParameter:"contrast",applyTo2d:function(t){if(0!==this.contrast){var e,i,r=t.imageData,n=r.data,i=n.length,o=Math.floor(255*this.contrast),s=259*(o+255)/(255*(259-o));for(e=0;i>e;e+=4)n[e]=s*(n[e]-128)+128,n[e+1]=s*(n[e+1]-128)+128,n[e+2]=s*(n[e+2]-128)+128}},getUniformLocations:function(t,e){return{uContrast:t.getUniformLocation(e,"uContrast")}},sendUniformData:function(t,e){t.uniform1f(e.uContrast,this.contrast)}}),e.Image.filters.Contrast.fromObject=e.Image.filters.BaseFilter.fromObject}("undefined"!=typeof exports?exports:this);!function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,r=e.util.createClass;i.Saturation=r(i.BaseFilter,{type:"Saturation",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uSaturation;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nfloat rgMax = max(color.r, color.g);\nfloat rgbMax = max(rgMax, color.b);\ncolor.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;\ncolor.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;\ncolor.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;\ngl_FragColor = color;\n}",saturation:0,mainParameter:"saturation",applyTo2d:function(t){if(0!==this.saturation){var e,i,r=t.imageData,n=r.data,o=n.length,s=-this.saturation;for(e=0;o>e;e+=4)i=Math.max(n[e],n[e+1],n[e+2]),n[e]+=i!==n[e]?(i-n[e])*s:0,n[e+1]+=i!==n[e+1]?(i-n[e+1])*s:0,n[e+2]+=i!==n[e+2]?(i-n[e+2])*s:0}},getUniformLocations:function(t,e){return{uSaturation:t.getUniformLocation(e,"uSaturation")}},sendUniformData:function(t,e){t.uniform1f(e.uSaturation,-this.saturation)}}),e.Image.filters.Saturation.fromObject=e.Image.filters.BaseFilter.fromObject}("undefined"!=typeof exports?exports:this);!function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,r=e.util.createClass;i.Blur=r(i.BaseFilter,{type:"Blur",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec2 uDelta;\nvarying vec2 vTexCoord;\nconst float nSamples = 15.0;\nvec3 v3offset = vec3(12.9898, 78.233, 151.7182);\nfloat random(vec3 scale) {\nreturn fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);\n}\nvoid main() {\nvec4 color = vec4(0.0);\nfloat total = 0.0;\nfloat offset = random(v3offset);\nfor (float t = -nSamples; t <= nSamples; t++) {\nfloat percent = (t + offset - 0.5) / nSamples;\nfloat weight = 1.0 - abs(percent);\ncolor += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;\ntotal += weight;\n}\ngl_FragColor = color / total;\n}",blur:0,mainParameter:"blur",applyTo:function(t){t.webgl?(this.aspectRatio=t.sourceWidth/t.sourceHeight,t.passes++,this._setupFrameBuffer(t),this.horizontal=!0,this.applyToWebGL(t),this._swapTextures(t),this._setupFrameBuffer(t),this.horizontal=!1,this.applyToWebGL(t),this._swapTextures(t)):this.applyTo2d(t)},applyTo2d:function(t){t.imageData=this.simpleBlur(t)},simpleBlur:function(t){var e,i,r=t.filterBackend.resources,n=t.imageData.width,o=t.imageData.height;r.blurLayer1||(r.blurLayer1=document.createElement("canvas"),r.blurLayer2=document.createElement("canvas")),e=r.blurLayer1,i=r.blurLayer2,(e.width!==n||e.height!==o)&&(i.width=e.width=n,i.height=e.height=o);var s,a,c,h,l=e.getContext("2d"),u=i.getContext("2d"),f=15,d=.06*this.blur*.5;for(l.putImageData(t.imageData,0,0),u.clearRect(0,0,n,o),h=-f;f>=h;h++)s=(Math.random()-.5)/4,a=h/f,c=d*a*n+s,u.globalAlpha=1-Math.abs(a),u.drawImage(e,c,s),l.drawImage(i,0,0),u.globalAlpha=1,u.clearRect(0,0,i.width,i.height);for(h=-f;f>=h;h++)s=(Math.random()-.5)/4,a=h/f,c=d*a*o+s,u.globalAlpha=1-Math.abs(a),u.drawImage(e,s,c),l.drawImage(i,0,0),u.globalAlpha=1,u.clearRect(0,0,i.width,i.height);t.ctx.drawImage(e,0,0);var g=t.ctx.getImageData(0,0,e.width,e.height);return l.globalAlpha=1,l.clearRect(0,0,e.width,e.height),g},getUniformLocations:function(t,e){return{delta:t.getUniformLocation(e,"uDelta")}},sendUniformData:function(t,e){var i=this.chooseRightDelta();t.uniform2fv(e.delta,i)},chooseRightDelta:function(){var t,e=1,i=[0,0];return this.horizontal?this.aspectRatio>1&&(e=1/this.aspectRatio):this.aspectRatio<1&&(e=this.aspectRatio),t=e*this.blur*.12,this.horizontal?i[0]=t:i[1]=t,i}}),i.Blur.fromObject=e.Image.filters.BaseFilter.fromObject}("undefined"!=typeof exports?exports:this);!function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,r=e.util.createClass;i.Gamma=r(i.BaseFilter,{type:"Gamma",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec3 uGamma;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nvec3 correction = (1.0 / uGamma);\ncolor.r = pow(color.r, correction.r);\ncolor.g = pow(color.g, correction.g);\ncolor.b = pow(color.b, correction.b);\ngl_FragColor = color;\ngl_FragColor.rgb *= color.a;\n}",gamma:[1,1,1],mainParameter:"gamma",applyTo2d:function(t){var e,i=t.imageData,r=i.data,n=this.gamma,o=r.length,s=1/n[0],a=1/n[1],c=1/n[2];for(this.rVals||(this.rVals=new Uint8Array(256),this.gVals=new Uint8Array(256),this.bVals=new Uint8Array(256)),e=0,o=256;o>e;e++)this.rVals[e]=255*Math.pow(e/255,s),this.gVals[e]=255*Math.pow(e/255,a),this.bVals[e]=255*Math.pow(e/255,c);for(e=0,o=r.length;o>e;e+=4)r[e]=this.rVals[r[e]],r[e+1]=this.gVals[r[e+1]],r[e+2]=this.bVals[r[e+2]]},getUniformLocations:function(t,e){return{uGamma:t.getUniformLocation(e,"uGamma")}},sendUniformData:function(t,e){t.uniform3fv(e.uGamma,this.gamma)}}),e.Image.filters.Gamma.fromObject=e.Image.filters.BaseFilter.fromObject}("undefined"!=typeof exports?exports:this);!function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,r=e.util.createClass;i.Composed=r(i.BaseFilter,{type:"Composed",subFilters:[],initialize:function(t){this.callSuper("initialize",t),this.subFilters=this.subFilters.slice(0)},applyTo:function(t){t.passes+=this.subFilters.length-1,this.subFilters.forEach(function(e){e.applyTo(t)})},toObject:function(){return e.util.object.extend(this.callSuper("toObject"),{subFilters:this.subFilters.map(function(t){return t.toObject()})})}}),e.Image.filters.Composed.fromObject=function(t,i){var r=t.subFilters||[],n=r.map(function(t){return new e.Image.filters[t.type](t)}),o=new e.Image.filters.Composed({subFilters:n});return i&&i(o),o}}("undefined"!=typeof exports?exports:this);!function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,r=e.util.createClass;i.HueRotation=r(i.ColorMatrix,{type:"HueRotation",rotation:0,mainParameter:"rotation",calculateMatrix:function(){var t=this.rotation*Math.PI,e=Math.cos(t),i=Math.sin(t),r=1/3,n=Math.sqrt(r)*i,o=1-e;this.matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],this.matrix[0]=e+o/3,this.matrix[1]=r*o-n,this.matrix[2]=r*o+n,this.matrix[5]=r*o+n,this.matrix[6]=e+r*o,this.matrix[7]=r*o-n,this.matrix[10]=r*o-n,this.matrix[11]=r*o+n,this.matrix[12]=e+r*o},applyTo:function(t){this.calculateMatrix(),e.Image.filters.BaseFilter.prototype.applyTo.call(this,t)}}),e.Image.filters.HueRotation.fromObject=e.Image.filters.BaseFilter.fromObject}("undefined"!=typeof exports?exports:this);!function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.clone,r=2,n=200;return e.Text?void e.warn("fabric.Text is already defined"):(e.Text=e.util.createClass(e.Object,{_dimensionAffectingProps:["fontSize","fontWeight","fontFamily","fontStyle","lineHeight","text","charSpacing","textAlign","styles"],_reNewline:/\r?\n/,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:"left",fontStyle:"normal",lineHeight:1.16,textBackgroundColor:"",stateProperties:e.Object.prototype.stateProperties.concat("fontFamily","fontWeight","fontSize","text","underline","overline","linethrough","textAlign","fontStyle","lineHeight","textBackgroundColor","charSpacing","styles"),cacheProperties:e.Object.prototype.cacheProperties.concat("fontFamily","fontWeight","fontSize","text","underline","overline","linethrough","textAlign","fontStyle","lineHeight","textBackgroundColor","charSpacing","styles"),stroke:null,shadow:null,_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,styles:null,_measuringContext:null,_styleProperties:["stroke","strokeWidth","fill","fontFamily","fontSize","fontWeight","fontStyle","underline","overline","linethrough","textBackgroundColor"],__charBounds:[],initialize:function(t,e){this.styles=e?e.styles||{}:{},this.text=t,this.__skipDimension=!0,this.callSuper("initialize",e),this.__skipDimension=!1,this.initDimensions(),this.setCoords(),this.setupState({propertySet:"_dimensionAffectingProps"})},getMeasuringContext:function(){return e._measuringContext||(e._measuringContext=this.canvas&&this.canvas.contextCache||e.util.createCanvasElement().getContext("2d")),e._measuringContext},_splitText:function(){var t=this._splitTextIntoLines(this.text);return this.textLines=t.lines,this._textLines=t.graphemeLines,this._unwrappedTextLines=t._unwrappedLines,this._text=t.graphemeText,t},initDimensions:function(){this.__skipDimension||(this._splitText(),this._clearCache(),this.width=this.calcTextWidth()||this.cursorWidth||r,-1!==this.textAlign.indexOf("justify")&&this.enlargeSpaces(),this.height=this.calcTextHeight(),this.saveState({propertySet:"_dimensionAffectingProps"}))},enlargeSpaces:function(){for(var t,e,i,r,n,o,s,a=0,c=this._textLines.length;c>a;a++)if(("justify"===this.textAlign||a!==c-1&&!this.isEndOfWrapping(a))&&(r=0,n=this._textLines[a],e=this.getLineWidth(a),e<this.width&&(s=this.textLines[a].match(this._reSpacesAndTabs)))){i=s.length,t=(this.width-e)/i;for(var h=0,l=n.length;l>=h;h++)o=this.__charBounds[a][h],this._reSpaceAndTab.test(n[h])?(o.width+=t,o.kernedWidth+=t,o.left+=r,r+=t):o.left+=r}},isEndOfWrapping:function(t){return t===this._textLines.length-1},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_getCacheCanvasDimensions:function(){var t=this.callSuper("_getCacheCanvasDimensions"),e=this.fontSize;return t.width+=e*t.zoomX,t.height+=e*t.zoomY,t},_render:function(t){this._setTextStyles(t),this._renderTextLinesBackground(t),this._renderTextDecoration(t,"underline"),this._renderText(t),this._renderTextDecoration(t,"overline"),this._renderTextDecoration(t,"linethrough")},_renderText:function(t){"stroke"===this.paintFirst?(this._renderTextStroke(t),this._renderTextFill(t)):(this._renderTextFill(t),this._renderTextStroke(t))},_setTextStyles:function(t,e,i){t.textBaseline="alphabetic",t.font=this._getFontDeclaration(e,i)},calcTextWidth:function(){for(var t=this.getLineWidth(0),e=1,i=this._textLines.length;i>e;e++){var r=this.getLineWidth(e);r>t&&(t=r)}return t},_renderTextLine:function(t,e,i,r,n,o){this._renderChars(t,e,i,r,n,o)},_renderTextLinesBackground:function(t){if(this.textBackgroundColor||this.styleHas("textBackgroundColor")){for(var e,i,r,n,o,s,a=0,c=t.fillStyle,h=this._getLeftOffset(),l=this._getTopOffset(),u=0,f=0,g=0,d=this._textLines.length;d>g;g++)if(e=this.getHeightOfLine(g),this.textBackgroundColor||this.styleHas("textBackgroundColor",g)){r=this._textLines[g],i=this._getLineLeftOffset(g),f=0,u=0,n=this.getValueOfPropertyAt(g,0,"textBackgroundColor");for(var p=0,v=r.length;v>p;p++)o=this.__charBounds[g][p],s=this.getValueOfPropertyAt(g,p,"textBackgroundColor"),s!==n?(t.fillStyle=n,n&&t.fillRect(h+i+u,l+a,f,e/this.lineHeight),u=o.left,f=o.width,n=s):f+=o.kernedWidth;s&&(t.fillStyle=s,t.fillRect(h+i+u,l+a,f,e/this.lineHeight)),a+=e}else a+=e;t.fillStyle=c,this._removeShadow(t)}},getFontCache:function(t){var i=t.fontFamily.toLowerCase();e.charWidthsCache[i]||(e.charWidthsCache[i]={});var r=e.charWidthsCache[i],n=t.fontStyle.toLowerCase()+"_"+(t.fontWeight+"").toLowerCase();return r[n]||(r[n]={}),r[n]},_applyCharStyles:function(t,e,i,r,n){this._setFillStyles(e,n),this._setStrokeStyles(e,n),e.font=this._getFontDeclaration(n)},_measureChar:function(t,e,i,r){var o,s,a,c,h=this.getFontCache(e),l=this._getFontDeclaration(e),u=this._getFontDeclaration(r),f=i+t,g=l===u,d=e.fontSize/n;if(i&&h[i]&&(a=h[i]),h[t]&&(c=o=h[t]),g&&h[f]&&(s=h[f],c=s-a),!o||!a||!s){var p=this.getMeasuringContext();this._setTextStyles(p,e,!0)}if(o||(c=o=p.measureText(t).width,h[t]=o),!a&&g&&i&&(a=p.measureText(i).width,h[i]=a),g&&!s&&(s=p.measureText(f).width,h[f]=s,c=s-a,c>o)){var v=c-o;h[t]=c,h[f]+=v,o=c}return{width:o*d,kernedWidth:c*d}},getHeightOfChar:function(t,e){return this.getValueOfPropertyAt(t,e,"fontSize")},measureLine:function(t){var e=this._measureLine(t);return 0!==this.charSpacing&&(e.width-=this._getWidthOfCharSpacing()),e.width<0&&(e.width=0),e},_measureLine:function(t){var e,i,r,n,o=0,s=this._textLines[t],a=0,c=new Array(s.length);for(this.__charBounds[t]=c,e=0;e<s.length;e++)i=s[e],n=this._getGraphemeBox(i,t,e,r),c[e]=n,o+=n.kernedWidth,r=i;return c[e]={left:n?n.left+n.width:0,width:0,kernedWidth:0,height:this.fontSize},{width:o,numOfSpaces:a}},_getGraphemeBox:function(t,e,i,r,n){var o=this.getCompleteStyleDeclaration(e,i),s=r?this.getCompleteStyleDeclaration(e,i-1):{},a=this._measureChar(t,o,r,s),c=a.kernedWidth,h=a.width;0!==this.charSpacing&&(h+=this._getWidthOfCharSpacing(),c+=this._getWidthOfCharSpacing());var l={width:h,left:0,height:o.fontSize,kernedWidth:c};if(i>0&&!n){var u=this.__charBounds[e][i-1];l.left=u.left+u.width+a.kernedWidth-a.width}return l},getHeightOfLine:function(t){if(this.__lineHeights[t])return this.__lineHeights[t];for(var e=this._textLines[t],i=this.getHeightOfChar(t,0),r=1,n=e.length;n>r;r++){var o=this.getHeightOfChar(t,r);o>i&&(i=o)}return this.__lineHeights[t]=i*this.lineHeight*this._fontSizeMult,this.__lineHeights[t]},calcTextHeight:function(){for(var t,e=0,i=0,r=this._textLines.length;r>i;i++)t=this.getHeightOfLine(i),e+=i===r-1?t/this.lineHeight:t;return e},_getLeftOffset:function(){return-this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextCommon:function(t,e){t.save();for(var i=0,r=this._getLeftOffset(),n=this._getTopOffset(),o=this._applyPatternGradientTransform(t,"fillText"===e?this.fill:this.stroke),s=0,a=this._textLines.length;a>s;s++){var c=this.getHeightOfLine(s),h=c/this.lineHeight,l=this._getLineLeftOffset(s);this._renderTextLine(e,t,this._textLines[s],r+l-o.offsetX,n+i+h-o.offsetY,s),i+=c}t.restore()},_renderTextFill:function(t){(this.fill||this.styleHas("fill"))&&this._renderTextCommon(t,"fillText")},_renderTextStroke:function(t){(this.stroke&&0!==this.strokeWidth||!this.isEmptyStyles())&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(t),t.save(),this._setLineDash(t,this.strokeDashArray),t.beginPath(),this._renderTextCommon(t,"strokeText"),t.closePath(),t.restore())},_renderChars:function(t,e,i,r,n,o){var s,a,c,h,l=this.getHeightOfLine(o),u=-1!==this.textAlign.indexOf("justify"),f="",g=0;e.save(),n-=l*this._fontSizeFraction/this.lineHeight;for(var d=0,p=i.length-1;p>=d;d++)h=d===p||this.charSpacing,f+=i[d],c=this.__charBounds[o][d],0===g?(r+=c.kernedWidth-c.width,g+=c.width):g+=c.kernedWidth,u&&!h&&this._reSpaceAndTab.test(i[d])&&(h=!0),h||(s=s||this.getCompleteStyleDeclaration(o,d),a=this.getCompleteStyleDeclaration(o,d+1),h=this._hasStyleChanged(s,a)),h&&(this._renderChar(t,e,o,d,f,r,n,l),f="",s=a,r+=g,g=0);e.restore()},_renderChar:function(t,e,i,r,n,o,s){var a=this._getStyleDeclaration(i,r),c=this.getCompleteStyleDeclaration(i,r),h="fillText"===t&&c.fill,l="strokeText"===t&&c.stroke&&c.strokeWidth;(l||h)&&(a&&e.save(),this._applyCharStyles(t,e,i,r,c),a&&a.textBackgroundColor&&this._removeShadow(e),h&&e.fillText(n,o,s),l&&e.strokeText(n,o,s),a&&e.restore())},_hasStyleChanged:function(t,e){return t.fill!==e.fill||t.stroke!==e.stroke||t.strokeWidth!==e.strokeWidth||t.fontSize!==e.fontSize||t.fontFamily!==e.fontFamily||t.fontWeight!==e.fontWeight||t.fontStyle!==e.fontStyle},_hasStyleChangedForSvg:function(t,e){return this._hasStyleChanged(t,e)||t.overline!==e.overline||t.underline!==e.underline||t.linethrough!==e.linethrough},_getLineLeftOffset:function(t){var e=this.getLineWidth(t);return"center"===this.textAlign?(this.width-e)/2:"right"===this.textAlign?this.width-e:"justify-center"===this.textAlign&&this.isEndOfWrapping(t)?(this.width-e)/2:"justify-right"===this.textAlign&&this.isEndOfWrapping(t)?this.width-e:0},_clearCache:function(){this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]},_shouldClearDimensionCache:function(){var t=this._forceClearCache;return t||(t=this.hasStateChanged("_dimensionAffectingProps")),t&&(this.dirty=!0,this._forceClearCache=!1),t},getLineWidth:function(t){if(this.__lineWidths[t])return this.__lineWidths[t];var e,i,r=this._textLines[t];return""===r?e=0:(i=this.measureLine(t),e=i.width),this.__lineWidths[t]=e,e},_getWidthOfCharSpacing:function(){return 0!==this.charSpacing?this.fontSize*this.charSpacing/1e3:0},getValueOfPropertyAt:function(t,e,i){var r=this._getStyleDeclaration(t,e),n=r&&"undefined"!=typeof r[i];return n?r[i]:this[i]},_renderTextDecoration:function(t,e){if(this[e]||this.styleHas(e)){for(var i,r,n,o,s,a,c,h,l,u,f,g=this._getLeftOffset(),d=this._getTopOffset(),p=0,v=this._textLines.length;v>p;p++)if(i=this.getHeightOfLine(p),this[e]||this.styleHas(e,p)){n=this._textLines[p],l=i/this.lineHeight,r=this._getLineLeftOffset(p),s=0,a=0,o=this.getValueOfPropertyAt(p,0,e),f=this.getValueOfPropertyAt(p,0,"fill");for(var m=0,b=n.length;b>m;m++)c=this.__charBounds[p][m],h=this.getValueOfPropertyAt(p,m,e),u=this.getValueOfPropertyAt(p,m,"fill"),(h!==o||u!==f)&&a>0?(t.fillStyle=f,o&&f&&t.fillRect(g+r+s,d+l*(1-this._fontSizeFraction)+this.offsets[e]*this.fontSize,a,this.fontSize/15),s=c.left,a=c.width,o=h,f=u):a+=c.kernedWidth;t.fillStyle=u,h&&u&&t.fillRect(g+r+s,d+l*(1-this._fontSizeFraction)+this.offsets[e]*this.fontSize,a,this.fontSize/15),d+=i}else d+=i;this._removeShadow(t)}},_getFontDeclaration:function(t,i){var r=t||this;return[e.isLikelyNode?r.fontWeight:r.fontStyle,e.isLikelyNode?r.fontStyle:r.fontWeight,i?n+"px":r.fontSize+"px",e.isLikelyNode?'"'+r.fontFamily+'"':r.fontFamily].join(" ")},render:function(t){this.visible&&(!this.canvas||!this.canvas.skipOffscreen||this.group||this.isOnScreen())&&(this._shouldClearDimensionCache()&&this.initDimensions(),this.callSuper("render",t))},_splitTextIntoLines:function(t){for(var i=t.split(this._reNewline),r=new Array(i.length),n=["\n"],o=[],s=0;s<i.length;s++)r[s]=e.util.string.graphemeSplit(i[s]),o=o.concat(r[s],n);return o.pop(),{_unwrappedLines:r,lines:i,graphemeText:o,graphemeLines:r}},toObject:function(t){var e=["text","fontSize","fontWeight","fontFamily","fontStyle","lineHeight","underline","overline","linethrough","textAlign","textBackgroundColor","charSpacing"].concat(t),r=this.callSuper("toObject",e);return r.styles=i(this.styles,!0),r},set:function(t,e){this.callSuper("set",t,e);var i=!1;if("object"==typeof t)for(var r in t)i=i||-1!==this._dimensionAffectingProps.indexOf(r);else i=-1!==this._dimensionAffectingProps.indexOf(t);return i&&(this.initDimensions(),this.setCoords()),this},complexity:function(){return 1}}),e.Text.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size text-decoration text-anchor".split(" ")),e.Text.DEFAULT_SVG_FONT_SIZE=16,e.Text.fromElement=function(t,r,n){if(!t)return r(null);var o=e.parseAttributes(t,e.Text.ATTRIBUTE_NAMES),s=o.textAnchor||"left";if(n=e.util.object.extend(n?i(n):{},o),n.top=n.top||0,n.left=n.left||0,o.textDecoration){var a=o.textDecoration;-1!==a.indexOf("underline")&&(n.underline=!0),-1!==a.indexOf("overline")&&(n.overline=!0),-1!==a.indexOf("line-through")&&(n.linethrough=!0),delete n.textDecoration}"dx"in o&&(n.left+=o.dx),"dy"in o&&(n.top+=o.dy),"fontSize"in n||(n.fontSize=e.Text.DEFAULT_SVG_FONT_SIZE);var c="";"textContent"in t?c=t.textContent:"firstChild"in t&&null!==t.firstChild&&"data"in t.firstChild&&null!==t.firstChild.data&&(c=t.firstChild.data),c=c.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," ");var h=new e.Text(c,n),l=h.getScaledHeight()/h.height,u=(h.height+h.strokeWidth)*h.lineHeight-h.height,f=u*l,g=h.getScaledHeight()+f,d=0;"center"===s&&(d=h.getScaledWidth()/2),"right"===s&&(d=h.getScaledWidth()),h.set({left:h.left-d,top:h.top-(g-h.fontSize*(.18+h._fontSizeFraction))/h.lineHeight}),r(h)},e.Text.fromObject=function(t,i){return e.Object._fromObject("Text",t,i,"text")},void(e.util.createAccessors&&e.util.createAccessors(e.Text)))}("undefined"!=typeof exports?exports:this);!function(){fabric.util.object.extend(fabric.Text.prototype,{isEmptyStyles:function(t){if(!this.styles)return!0;if("undefined"!=typeof t&&!this.styles[t])return!0;var e="undefined"==typeof t?this.styles:{line:this.styles[t]};for(var i in e)for(var r in e[i])for(var n in e[i][r])return!1;return!0},styleHas:function(t,e){if(!this.styles||!t||""===t)return!1;if("undefined"!=typeof e&&!this.styles[e])return!1;var i="undefined"==typeof e?this.styles:{line:this.styles[e]};for(var r in i)for(var n in i[r])if("undefined"!=typeof i[r][n][t])return!0;return!1},cleanStyle:function(t){if(!this.styles||!t||""===t)return!1;var e,i,r=this.styles,n=0,o=!1,s=!0,a=0;for(var c in r){e=0;for(var h in r[c])n++,o?r[c][h][t]!==i&&(s=!1):(i=r[c][h][t],o=!0),r[c][h][t]===this[t]&&delete r[c][h][t],0!==Object.keys(r[c][h]).length?e++:delete r[c][h];0===e&&delete r[c]}for(var l=0;l<this._textLines.length;l++)a+=this._textLines[l].length;s&&n===a&&(this[t]=i,this.removeStyle(t))},removeStyle:function(t){if(this.styles&&t&&""!==t){var e,i,r,n=this.styles;for(i in n){e=n[i];for(r in e)delete e[r][t],0===Object.keys(e[r]).length&&delete e[r];0===Object.keys(e).length&&delete n[i]}}},_extendStyles:function(t,e){var i=this.get2DCursorLocation(t);this._getLineStyle(i.lineIndex)||this._setLineStyle(i.lineIndex,{}),this._getStyleDeclaration(i.lineIndex,i.charIndex)||this._setStyleDeclaration(i.lineIndex,i.charIndex,{}),fabric.util.object.extend(this._getStyleDeclaration(i.lineIndex,i.charIndex),e)},get2DCursorLocation:function(t,e){"undefined"==typeof t&&(t=this.selectionStart);for(var i=e?this._unwrappedTextLines:this._textLines,r=i.length,n=0;r>n;n++){if(t<=i[n].length)return{lineIndex:n,charIndex:t};t-=i[n].length+1}return{lineIndex:n-1,charIndex:i[n-1].length<t?i[n-1].length:t}},getSelectionStyles:function(t,e,i){"undefined"==typeof t&&(t=this.selectionStart||0),"undefined"==typeof e&&(e=this.selectionEnd||t);for(var r=[],n=t;e>n;n++)r.push(this.getStyleAtPosition(n,i));return r},getStyleAtPosition:function(t,e){var i=this.get2DCursorLocation(t),r=e?this.getCompleteStyleDeclaration(i.lineIndex,i.charIndex):this._getStyleDeclaration(i.lineIndex,i.charIndex);return r||{}},setSelectionStyles:function(t,e,i){"undefined"==typeof e&&(e=this.selectionStart||0),"undefined"==typeof i&&(i=this.selectionEnd||e);for(var r=e;i>r;r++)this._extendStyles(r,t);return this._forceClearCache=!0,this},_getStyleDeclaration:function(t,e){var i=this.styles&&this.styles[t];return i?i[e]:null},getCompleteStyleDeclaration:function(t,e){for(var i,r=this._getStyleDeclaration(t,e)||{},n={},o=0;o<this._styleProperties.length;o++)i=this._styleProperties[o],n[i]="undefined"==typeof r[i]?this[i]:r[i];return n},_setStyleDeclaration:function(t,e,i){this.styles[t][e]=i},_deleteStyleDeclaration:function(t,e){delete this.styles[t][e]},_getLineStyle:function(t){return this.styles[t]},_setLineStyle:function(t,e){this.styles[t]=e},_deleteLineStyle:function(t){delete this.styles[t]}})}();!function(){function t(t){t.textDecoration&&(t.textDecoration.indexOf("underline")>-1&&(t.underline=!0),t.textDecoration.indexOf("line-through")>-1&&(t.linethrough=!0),t.textDecoration.indexOf("overline")>-1&&(t.overline=!0),delete t.textDecoration)}fabric.IText=fabric.util.createClass(fabric.Text,fabric.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"#333",cursorDelay:1e3,cursorDuration:600,caching:!0,_reSpace:/\s|\n/,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,__widthOfSpace:[],inCompositionMode:!1,initialize:function(t,e){this.callSuper("initialize",t,e),this.initBehavior()},setSelectionStart:function(t){t=Math.max(t,0),this._updateAndFire("selectionStart",t)},setSelectionEnd:function(t){t=Math.min(t,this.text.length),this._updateAndFire("selectionEnd",t)},_updateAndFire:function(t,e){this[t]!==e&&(this._fireSelectionChanged(),this[t]=e),this._updateTextarea()},_fireSelectionChanged:function(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},initDimensions:function(){this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this.callSuper("initDimensions")},render:function(t){this.clearContextTop(),this.callSuper("render",t),this.cursorOffsetCache={},this.renderCursorOrSelection()},_render:function(t){this.callSuper("_render",t)},clearContextTop:function(t){if(this.isEditing&&this.canvas&&this.canvas.contextTop){var e=this.canvas.contextTop,i=this.canvas.viewportTransform;e.save(),e.transform(i[0],i[1],i[2],i[3],i[4],i[5]),this.transform(e),this.transformMatrix&&e.transform.apply(e,this.transformMatrix),this._clearTextArea(e),t||e.restore()}},renderCursorOrSelection:function(){if(this.isEditing&&this.canvas){var t,e=this._getCursorBoundaries();this.canvas&&this.canvas.contextTop?(t=this.canvas.contextTop,this.clearContextTop(!0)):(t=this.canvas.contextContainer,t.save()),this.selectionStart===this.selectionEnd?this.renderCursor(e,t):this.renderSelection(e,t),t.restore()}},_clearTextArea:function(t){var e=this.width+4,i=this.height+4;t.clearRect(-e/2,-i/2,e,i)},_getCursorBoundaries:function(t){"undefined"==typeof t&&(t=this.selectionStart);var e=this._getLeftOffset(),i=this._getTopOffset(),r=this._getCursorBoundariesOffsets(t);return{left:e,top:i,leftOffset:r.left,topOffset:r.top}},_getCursorBoundariesOffsets:function(t){if(this.cursorOffsetCache&&"top"in this.cursorOffsetCache)return this.cursorOffsetCache;for(var e,i,r=0,n=0,o=0,s=0,a=this.get2DCursorLocation(t),c=0;c<a.lineIndex;c++)o+=this.getHeightOfLine(c);e=this._getLineLeftOffset(a.lineIndex);var h=this.__charBounds[a.lineIndex][a.charIndex];return h&&(s=h.left),0!==this.charSpacing&&n===this._textLines[r].length&&(s-=this._getWidthOfCharSpacing()),i={top:o,left:e+(s>0?s:0)},this.cursorOffsetCache=i,this.cursorOffsetCache},renderCursor:function(t,e){var i=this.get2DCursorLocation(),r=i.lineIndex,n=i.charIndex>0?i.charIndex-1:0,o=this.getValueOfPropertyAt(r,n,"fontSize"),s=this.scaleX*this.canvas.getZoom(),a=this.cursorWidth/s,c=t.topOffset;c+=(1-this._fontSizeFraction)*this.getHeightOfLine(r)/this.lineHeight-o*(1-this._fontSizeFraction),this.inCompositionMode&&this.renderSelection(t,e),e.fillStyle=this.getValueOfPropertyAt(r,n,"fill"),e.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity,e.fillRect(t.left+t.leftOffset-a/2,c+t.top,a,o)},renderSelection:function(t,e){for(var i=this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,r=this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd,n=-1!==this.textAlign.indexOf("justify"),o=this.get2DCursorLocation(i),s=this.get2DCursorLocation(r),a=o.lineIndex,c=s.lineIndex,h=o.charIndex<0?0:o.charIndex,l=s.charIndex<0?0:s.charIndex,u=a;c>=u;u++){var f=this._getLineLeftOffset(u)||0,d=this.getHeightOfLine(u),g=0,p=0,v=0;u===a&&(p=this.__charBounds[a][h].left),u>=a&&c>u?v=n&&!this.isEndOfWrapping(u)?this.width:this.getLineWidth(u)||5:u===c&&(v=0===l?this.__charBounds[c][l].left:this.__charBounds[c][l-1].left+this.__charBounds[c][l-1].width),g=d,(this.lineHeight<1||u===c&&this.lineHeight>1)&&(d/=this.lineHeight),this.inCompositionMode?(e.fillStyle=this.compositionColor||"black",e.fillRect(t.left+f+p,t.top+t.topOffset+d,v-p,1)):(e.fillStyle=this.selectionColor,e.fillRect(t.left+f+p,t.top+t.topOffset,v-p,d)),t.topOffset+=g}},getCurrentCharFontSize:function(){var t=this._getCurrentCharIndex();return this.getValueOfPropertyAt(t.l,t.c,"fontSize")},getCurrentCharColor:function(){var t=this._getCurrentCharIndex();return this.getValueOfPropertyAt(t.l,t.c,"fill")},_getCurrentCharIndex:function(){var t=this.get2DCursorLocation(this.selectionStart,!0),e=t.charIndex>0?t.charIndex-1:0;return{l:t.lineIndex,c:e}}}),fabric.IText.fromObject=function(e,i){if(t(e),e.styles)for(var r in e.styles)for(var n in e.styles[r])t(e.styles[r][n]);fabric.Object._fromObject("IText",e,i,"text")}}();!function(){var t=fabric.util.object.clone;fabric.util.object.extend(fabric.IText.prototype,{initBehavior:function(){this.initAddedHandler(),this.initRemovedHandler(),this.initCursorSelectionHandlers(),this.initDoubleClickSimulation(),this.mouseMoveHandler=this.mouseMoveHandler.bind(this)},onDeselect:function(t){this.isEditing&&this.exitEditing(),this.selected=!1,fabric.Object.prototype.onDeselect.call(this,t)},initAddedHandler:function(){var t=this;this.on("added",function(){var e=t.canvas;e&&(e._hasITextHandlers||(e._hasITextHandlers=!0,t._initCanvasHandlers(e)),e._iTextInstances=e._iTextInstances||[],e._iTextInstances.push(t))})},initRemovedHandler:function(){var t=this;this.on("removed",function(){var e=t.canvas;e&&(e._iTextInstances=e._iTextInstances||[],fabric.util.removeFromArray(e._iTextInstances,t),0===e._iTextInstances.length&&(e._hasITextHandlers=!1,t._removeCanvasHandlers(e)))})},_initCanvasHandlers:function(t){t._mouseUpITextHandler=function(){t._iTextInstances&&t._iTextInstances.forEach(function(t){t.__isMousedown=!1})}.bind(this),t.on("mouse:up",t._mouseUpITextHandler)},_removeCanvasHandlers:function(t){t.off("mouse:up",t._mouseUpITextHandler)},_tick:function(){this._currentTickState=this._animateCursor(this,1,this.cursorDuration,"_onTickComplete")},_animateCursor:function(t,e,i,r){var n;return n={isAborted:!1,abort:function(){this.isAborted=!0}},t.animate("_currentCursorOpacity",e,{duration:i,onComplete:function(){n.isAborted||t[r]()},onChange:function(){t.canvas&&t.selectionStart===t.selectionEnd&&t.renderCursorOrSelection()},abort:function(){return n.isAborted}}),n},_onTickComplete:function(){var t=this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1),this._cursorTimeout1=setTimeout(function(){t._currentTickCompleteState=t._animateCursor(t,0,this.cursorDuration/2,"_tick")},100)},initDelayedCursor:function(t){var e=this,i=t?0:this.cursorDelay;this.abortCursorAnimation(),this._currentCursorOpacity=1,this._cursorTimeout2=setTimeout(function(){e._tick()},i)},abortCursorAnimation:function(){var t=this._currentTickState||this._currentTickCompleteState,e=this.canvas;this._currentTickState&&this._currentTickState.abort(),this._currentTickCompleteState&&this._currentTickCompleteState.abort(),clearTimeout(this._cursorTimeout1),clearTimeout(this._cursorTimeout2),this._currentCursorOpacity=0,t&&e&&e.clearContext(e.contextTop||e.contextContainer)},selectAll:function(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this},getSelectedText:function(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")},findWordBoundaryLeft:function(t){var e=0,i=t-1;if(this._reSpace.test(this._text[i]))for(;this._reSpace.test(this._text[i]);)e++,i--;for(;/\S/.test(this._text[i])&&i>-1;)e++,i--;return t-e},findWordBoundaryRight:function(t){var e=0,i=t;if(this._reSpace.test(this._text[i]))for(;this._reSpace.test(this._text[i]);)e++,i++;for(;/\S/.test(this._text[i])&&i<this.text.length;)e++,i++;return t+e},findLineBoundaryLeft:function(t){for(var e=0,i=t-1;!/\n/.test(this._text[i])&&i>-1;)e++,i--;return t-e},findLineBoundaryRight:function(t){for(var e=0,i=t;!/\n/.test(this._text[i])&&i<this.text.length;)e++,i++;return t+e},searchWordBoundary:function(t,e){for(var i=this._reSpace.test(this.text.charAt(t))?t-1:t,r=this.text.charAt(i),n=/[ \n\.,;!\?\-]/;!n.test(r)&&i>0&&i<this.text.length;)i+=e,r=this.text.charAt(i);return n.test(r)&&"\n"!==r&&(i+=1===e?0:1),i},selectWord:function(t){t=t||this.selectionStart;var e=this.searchWordBoundary(t,-1),i=this.searchWordBoundary(t,1);this.selectionStart=e,this.selectionEnd=i,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()},selectLine:function(t){t=t||this.selectionStart;var e=this.findLineBoundaryLeft(t),i=this.findLineBoundaryRight(t);return this.selectionStart=e,this.selectionEnd=i,this._fireSelectionChanged(),this._updateTextarea(),this},enterEditing:function(t){return!this.isEditing&&this.editable?(this.canvas&&this.exitEditingOnOthers(this.canvas),this.isEditing=!0,this.initHiddenTextarea(t),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick(),this.fire("editing:entered"),this._fireSelectionChanged(),this.canvas?(this.canvas.fire("text:editing:entered",{target:this}),this.initMouseMoveHandler(),this.canvas.requestRenderAll(),this):this):void 0},exitEditingOnOthers:function(t){t._iTextInstances&&t._iTextInstances.forEach(function(t){t.selected=!1,t.isEditing&&t.exitEditing()})},initMouseMoveHandler:function(){this.canvas.on("mouse:move",this.mouseMoveHandler)},mouseMoveHandler:function(t){if(this.__isMousedown&&this.isEditing){var e=this.getSelectionStartFromPointer(t.e),i=this.selectionStart,r=this.selectionEnd;(e===this.__selectionStartOnMouseDown&&i!==r||i!==e&&r!==e)&&(e>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=e):(this.selectionStart=e,this.selectionEnd=this.__selectionStartOnMouseDown),(this.selectionStart!==i||this.selectionEnd!==r)&&(this.restartCursorIfNeeded(),this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}},_setEditingProps:function(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0},fromStringToGraphemeSelection:function(t,e,i){var r=i.slice(0,t),n=fabric.util.string.graphemeSplit(r).length;if(t===e)return{selectionStart:n,selectionEnd:n};var s=i.slice(t,e),o=fabric.util.string.graphemeSplit(s).length;return{selectionStart:n,selectionEnd:n+o}},fromGraphemeToStringSelection:function(t,e,i){var r=i.slice(0,t),n=r.join("").length;if(t===e)return{selectionStart:n,selectionEnd:n};var s=i.slice(t,e),o=s.join("").length;return{selectionStart:n,selectionEnd:n+o}},_updateTextarea:function(){if(this.cursorOffsetCache={},this.hiddenTextarea){if(!this.inCompositionMode){var t=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=t.selectionStart,this.hiddenTextarea.selectionEnd=t.selectionEnd}this.updateTextareaPosition()}},updateFromTextArea:function(){if(this.hiddenTextarea){this.cursorOffsetCache={},this.text=this.hiddenTextarea.value,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords());var t=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value);this.selectionEnd=this.selectionStart=t.selectionEnd,this.inCompositionMode||(this.selectionStart=t.selectionStart),this.updateTextareaPosition()}},updateTextareaPosition:function(){if(this.selectionStart===this.selectionEnd){var t=this._calcTextareaPosition();this.hiddenTextarea.style.left=t.left,this.hiddenTextarea.style.top=t.top}},_calcTextareaPosition:function(){if(!this.canvas)return{x:1,y:1};var t=this.inCompositionMode?this.compositionStart:this.selectionStart,e=this._getCursorBoundaries(t),i=this.get2DCursorLocation(t),r=i.lineIndex,n=i.charIndex,s=this.getValueOfPropertyAt(r,n,"fontSize")*this.lineHeight,o=e.leftOffset,a=this.calcTransformMatrix(),c={x:e.left+o,y:e.top+e.topOffset+s},h=this.canvas.upperCanvasEl,l=h.width-s,u=h.height-s;return c=fabric.util.transformPoint(c,a),c=fabric.util.transformPoint(c,this.canvas.viewportTransform),c.x<0&&(c.x=0),c.x>l&&(c.x=l),c.y<0&&(c.y=0),c.y>u&&(c.y=u),c.x+=this.canvas._offset.left,c.y+=this.canvas._offset.top,{left:c.x+"px",top:c.y+"px",fontSize:s+"px",charHeight:s}},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor))},exitEditing:function(){var t=this._textBeforeEdit!==this.text;return this.selected=!1,this.isEditing=!1,this.selectable=!0,this.selectionEnd=this.selectionStart,this.hiddenTextarea&&(this.hiddenTextarea.blur&&this.hiddenTextarea.blur(),this.canvas&&this.hiddenTextarea.parentNode.removeChild(this.hiddenTextarea),this.hiddenTextarea=null),this.abortCursorAnimation(),this._restoreEditingProps(),this._currentCursorOpacity=0,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this.fire("editing:exited"),t&&this.fire("modified"),this.canvas&&(this.canvas.off("mouse:move",this.mouseMoveHandler),this.canvas.fire("text:editing:exited",{target:this}),t&&this.canvas.fire("object:modified",{target:this})),this},_removeExtraneousStyles:function(){for(var t in this.styles)this._textLines[t]||delete this.styles[t]},removeStyleFromTo:function(t,e){var i,r,n=this.get2DCursorLocation(t,!0),s=this.get2DCursorLocation(e,!0),o=n.lineIndex,a=n.charIndex,c=s.lineIndex,h=s.charIndex;if(o!==c){if(this.styles[o])for(i=a;i<this._textLines[o].length;i++)delete this.styles[o][i];if(this.styles[c])for(i=h;i<this._textLines[c].length;i++)r=this.styles[c][i],r&&(this.styles[o]||(this.styles[o]={}),this.styles[o][a+i-h]=r);for(i=o+1;c>=i;i++)delete this.styles[i];this.shiftLineStyles(c,o-c)}else if(this.styles[o]){r=this.styles[o];var l,u,f=h-a;for(i=a;h>i;i++)delete r[i];for(u in this.styles[o])l=parseInt(u,10),l>=h&&(r[l-f]=r[u],delete r[u])}},shiftLineStyles:function(e,i){var r=t(this.styles);for(var n in this.styles){var s=parseInt(n,10);s>e&&(this.styles[s+i]=r[s],r[s-i]||delete this.styles[s])}},restartCursorIfNeeded:function(){(!this._currentTickState||this._currentTickState.isAborted||!this._currentTickCompleteState||this._currentTickCompleteState.isAborted)&&this.initDelayedCursor()},insertNewlineStyleObject:function(e,i,r,n){var s,o={},a=!1;r||(r=1),this.shiftLineStyles(e,r),this.styles[e]&&(s=this.styles[e][0===i?i:i-1]);for(var c in this.styles[e]){var h=parseInt(c,10);h>=i&&(a=!0,o[h-i]=this.styles[e][c],delete this.styles[e][c])}for(a?this.styles[e+r]=o:delete this.styles[e+r];r>1;)r--,n&&n[r]?this.styles[e+r]={0:t(n[r])}:s?this.styles[e+r]={0:t(s)}:delete this.styles[e+r];this._forceClearCache=!0},insertCharStyleObject:function(e,i,r,n){this.styles||(this.styles={});var s=this.styles[e],o=s?t(s):{};r||(r=1);for(var a in o){var c=parseInt(a,10);c>=i&&(s[c+r]=o[c],o[c-r]||delete s[c])}if(this._forceClearCache=!0,n)for(;r--;)Object.keys(n[r]).length&&(this.styles[e]||(this.styles[e]={}),this.styles[e][i+r]=t(n[r]));else if(s)for(var h=s[i?i-1:1];h&&r--;)this.styles[e][i+r]=t(h)},insertNewStyleBlock:function(t,e,i){for(var r=this.get2DCursorLocation(e,!0),n=[0],s=0,o=0;o<t.length;o++)"\n"===t[o]?(s++,n[s]=0):n[s]++;n[0]>0&&(this.insertCharStyleObject(r.lineIndex,r.charIndex,n[0],i),i=i&&i.slice(n[0]+1)),s&&this.insertNewlineStyleObject(r.lineIndex,r.charIndex+n[0],s);for(var o=1;s>o;o++)this.insertCharStyleObject(r.lineIndex+o,0,n[o],i),i=i&&i.slice(n[o]+1);n[o]>0&&this.insertCharStyleObject(r.lineIndex+o,0,n[o],i)},setSelectionStartEndWithShift:function(t,e,i){t>=i?(e===t?this._selectionDirection="left":"right"===this._selectionDirection&&(this._selectionDirection="left",this.selectionEnd=t),this.selectionStart=i):i>t&&e>i?"right"===this._selectionDirection?this.selectionEnd=i:this.selectionStart=i:(e===t?this._selectionDirection="right":"left"===this._selectionDirection&&(this._selectionDirection="right",this.selectionStart=e),this.selectionEnd=i)},setSelectionInBoundaries:function(){var t=this.text.length;this.selectionStart>t?this.selectionStart=t:this.selectionStart<0&&(this.selectionStart=0),this.selectionEnd>t?this.selectionEnd=t:this.selectionEnd<0&&(this.selectionEnd=0)}})}();fabric.util.object.extend(fabric.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown.bind(this))},onMouseDown:function(t){this.__newClickTime=+new Date;var e=this.canvas.getPointer(t.e);this.isTripleClick(e,t.e)&&(this.fire("tripleclick",t),this._stopEvent(t.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=e,this.__lastIsEditing=this.isEditing,this.__lastSelected=this.selected},isTripleClick:function(t){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===t.x&&this.__lastPointer.y===t.y},_stopEvent:function(t){t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation()},initCursorSelectionHandlers:function(){this.initMousedownHandler(),this.initMouseupHandler(),this.initClicks()},initClicks:function(){this.on("mousedblclick",function(t){this.selectWord(this.getSelectionStartFromPointer(t.e))}),this.on("tripleclick",function(t){this.selectLine(this.getSelectionStartFromPointer(t.e))})},initMousedownHandler:function(){this.on("mousedown",function(t){if(this.editable&&(!t.e.button||1===t.e.button)){var e=this.canvas.getPointer(t.e);this.__mousedownX=e.x,this.__mousedownY=e.y,this.__isMousedown=!0,this.selected&&this.setCursorByClick(t.e),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection())}})},_isObjectMoved:function(t){var e=this.canvas.getPointer(t);return this.__mousedownX!==e.x||this.__mousedownY!==e.y},initMouseupHandler:function(){this.on("mouseup",function(t){this.__isMousedown=!1,!this.editable||this._isObjectMoved(t.e)||t.e.button&&1!==t.e.button||(this.__lastSelected&&!this.__corner&&(this.enterEditing(t.e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()),this.selected=!0)})},setCursorByClick:function(t){var e=this.getSelectionStartFromPointer(t),i=this.selectionStart,r=this.selectionEnd;t.shiftKey?this.setSelectionStartEndWithShift(i,r,e):(this.selectionStart=e,this.selectionEnd=e),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())},getSelectionStartFromPointer:function(t){for(var e,i,r=this.getLocalPointer(t),n=0,s=0,o=0,a=0,c=0,h=0,l=this._textLines.length;l>h&&o<=r.y;h++)o+=this.getHeightOfLine(h)*this.scaleY,c=h,h>0&&(a+=this._textLines[h-1].length+1);e=this._getLineLeftOffset(c),s=e*this.scaleX,i=this._textLines[c];for(var u=0,f=i.length;f>u&&(n=s,s+=this.__charBounds[c][u].kernedWidth*this.scaleX,s<=r.x);u++)a++;return this._getNewSelectionStartFromOffset(r,n,s,a,f)},_getNewSelectionStartFromOffset:function(t,e,i,r,n){var s=t.x-e,o=i-t.x,a=o>s||0>o?0:1,c=r+a;return this.flipX&&(c=n-c),c>this._text.length&&(c=this._text.length),c}});fabric.util.object.extend(fabric.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=fabric.document.createElement("textarea"),this.hiddenTextarea.setAttribute("autocapitalize","off"),this.hiddenTextarea.setAttribute("autocorrect","off"),this.hiddenTextarea.setAttribute("autocomplete","off"),this.hiddenTextarea.setAttribute("spellcheck","false"),this.hiddenTextarea.setAttribute("data-fabric-hiddentextarea",""),this.hiddenTextarea.setAttribute("wrap","off");var t=this._calcTextareaPosition();this.hiddenTextarea.style.cssText="position: absolute; top: "+t.top+"; left: "+t.left+"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; line-height: 1px; paddingtop: "+t.fontSize+";",fabric.document.body.appendChild(this.hiddenTextarea),fabric.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this)),fabric.util.addListener(this.hiddenTextarea,"keyup",this.onKeyUp.bind(this)),fabric.util.addListener(this.hiddenTextarea,"input",this.onInput.bind(this)),fabric.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this)),fabric.util.addListener(this.hiddenTextarea,"cut",this.copy.bind(this)),fabric.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this)),fabric.util.addListener(this.hiddenTextarea,"compositionstart",this.onCompositionStart.bind(this)),fabric.util.addListener(this.hiddenTextarea,"compositionupdate",this.onCompositionUpdate.bind(this)),fabric.util.addListener(this.hiddenTextarea,"compositionend",this.onCompositionEnd.bind(this)),!this._clickHandlerInitialized&&this.canvas&&(fabric.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)},keysMap:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorRight",36:"moveCursorLeft",37:"moveCursorLeft",38:"moveCursorUp",39:"moveCursorRight",40:"moveCursorDown"},ctrlKeysMapUp:{67:"copy",88:"cut"},ctrlKeysMapDown:{65:"selectAll"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(t){if(this.isEditing&&!this.inCompositionMode){if(t.keyCode in this.keysMap)this[this.keysMap[t.keyCode]](t);else{if(!(t.keyCode in this.ctrlKeysMapDown&&(t.ctrlKey||t.metaKey)))return;this[this.ctrlKeysMapDown[t.keyCode]](t)}t.stopImmediatePropagation(),t.preventDefault(),t.keyCode>=33&&t.keyCode<=40?(this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}},onKeyUp:function(t){return!this.isEditing||this._copyDone||this.inCompositionMode?void(this._copyDone=!1):void(t.keyCode in this.ctrlKeysMapUp&&(t.ctrlKey||t.metaKey)&&(this[this.ctrlKeysMapUp[t.keyCode]](t),t.stopImmediatePropagation(),t.preventDefault(),this.canvas&&this.canvas.requestRenderAll()))},onInput:function(t){var e=this.fromPaste;if(this.fromPaste=!1,t&&t.stopPropagation(),this.isEditing){var i,r,n=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,s=this._text.length,o=n.length,a=o-s;if(""===this.hiddenTextarea.value)return this.styles={},this.updateFromTextArea(),this.fire("changed"),void(this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll()));var h=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),c=this.selectionStart>h.selectionStart;this.selectionStart!==this.selectionEnd?(i=this._text.slice(this.selectionStart,this.selectionEnd),a+=this.selectionEnd-this.selectionStart):s>o&&(i=c?this._text.slice(this.selectionEnd+a,this.selectionEnd):this._text.slice(this.selectionStart,this.selectionStart-a)),r=n.slice(h.selectionEnd-a,h.selectionEnd),i&&i.length&&(this.selectionStart!==this.selectionEnd?this.removeStyleFromTo(this.selectionStart,this.selectionEnd):c?this.removeStyleFromTo(this.selectionEnd-i.length,this.selectionEnd):this.removeStyleFromTo(this.selectionEnd,this.selectionEnd+i.length)),r.length&&(e&&r.join("")===fabric.copiedText?this.insertNewStyleBlock(r,this.selectionStart,fabric.copiedTextStyle):this.insertNewStyleBlock(r,this.selectionStart)),this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())}},onCompositionStart:function(){this.inCompositionMode=!0},onCompositionEnd:function(){this.inCompositionMode=!1},onCompositionUpdate:function(t){this.compositionStart=t.target.selectionStart,this.compositionEnd=t.target.selectionEnd,this.updateTextareaPosition()},copy:function(){this.selectionStart!==this.selectionEnd&&(fabric.copiedText=this.getSelectedText(),fabric.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0)},paste:function(){this.fromPaste=!0},_getClipboardData:function(t){return t&&t.clipboardData||fabric.window.clipboardData},_getWidthBeforeCursor:function(t,e){var i,r=this._getLineLeftOffset(t);return e>0&&(i=this.__charBounds[t][e-1],r+=i.left+i.width),r},getDownCursorOffset:function(t,e){var i=this._getSelectionForOffset(t,e),r=this.get2DCursorLocation(i),n=r.lineIndex;if(n===this._textLines.length-1||t.metaKey||34===t.keyCode)return this._text.length-i;var s=r.charIndex,o=this._getWidthBeforeCursor(n,s),a=this._getIndexOnLine(n+1,o),h=this._textLines[n].slice(s);return h.length+a+2},_getSelectionForOffset:function(t,e){return t.shiftKey&&this.selectionStart!==this.selectionEnd&&e?this.selectionEnd:this.selectionStart},getUpCursorOffset:function(t,e){var i=this._getSelectionForOffset(t,e),r=this.get2DCursorLocation(i),n=r.lineIndex;if(0===n||t.metaKey||33===t.keyCode)return-i;var s=r.charIndex,o=this._getWidthBeforeCursor(n,s),a=this._getIndexOnLine(n-1,o),h=this._textLines[n].slice(0,s);return-this._textLines[n-1].length+a-h.length},_getIndexOnLine:function(t,e){for(var i,r,n=this._textLines[t],s=this._getLineLeftOffset(t),o=s,a=0,h=0,c=n.length;c>h;h++)if(i=this.__charBounds[t][h].width,o+=i,o>e){r=!0;var l=o-i,u=o,f=Math.abs(l-e),d=Math.abs(u-e);a=f>d?h:h-1;break}return r||(a=n.length-1),a},moveCursorDown:function(t){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",t)},moveCursorUp:function(t){(0!==this.selectionStart||0!==this.selectionEnd)&&this._moveCursorUpOrDown("Up",t)},_moveCursorUpOrDown:function(t,e){var i="get"+t+"CursorOffset",r=this[i](e,"right"===this._selectionDirection);e.shiftKey?this.moveCursorWithShift(r):this.moveCursorWithoutShift(r),0!==r&&(this.setSelectionInBoundaries(),this.abortCursorAnimation(),this._currentCursorOpacity=1,this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorWithShift:function(t){var e="left"===this._selectionDirection?this.selectionStart+t:this.selectionEnd+t;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,e),0!==t},moveCursorWithoutShift:function(t){return 0>t?(this.selectionStart+=t,this.selectionEnd=this.selectionStart):(this.selectionEnd+=t,this.selectionStart=this.selectionEnd),0!==t},moveCursorLeft:function(t){(0!==this.selectionStart||0!==this.selectionEnd)&&this._moveCursorLeftOrRight("Left",t)},_move:function(t,e,i){var r;if(t.altKey)r=this["findWordBoundary"+i](this[e]);else{if(!t.metaKey&&35!==t.keyCode&&36!==t.keyCode)return this[e]+="Left"===i?-1:1,!0;r=this["findLineBoundary"+i](this[e])}return void 0!==typeof r&&this[e]!==r?(this[e]=r,!0):void 0},_moveLeft:function(t,e){return this._move(t,e,"Left")},_moveRight:function(t,e){return this._move(t,e,"Right")},moveCursorLeftWithoutShift:function(t){var e=!0;return this._selectionDirection="left",this.selectionEnd===this.selectionStart&&0!==this.selectionStart&&(e=this._moveLeft(t,"selectionStart")),this.selectionEnd=this.selectionStart,e},moveCursorLeftWithShift:function(t){return"right"===this._selectionDirection&&this.selectionStart!==this.selectionEnd?this._moveLeft(t,"selectionEnd"):0!==this.selectionStart?(this._selectionDirection="left",this._moveLeft(t,"selectionStart")):void 0},moveCursorRight:function(t){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",t)},_moveCursorLeftOrRight:function(t,e){var i="moveCursor"+t+"With";this._currentCursorOpacity=1,i+=e.shiftKey?"Shift":"outShift",this[i](e)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorRightWithShift:function(t){return"left"===this._selectionDirection&&this.selectionStart!==this.selectionEnd?this._moveRight(t,"selectionStart"):this.selectionEnd!==this._text.length?(this._selectionDirection="right",this._moveRight(t,"selectionEnd")):void 0},moveCursorRightWithoutShift:function(t){var e=!0;return this._selectionDirection="right",this.selectionStart===this.selectionEnd?(e=this._moveRight(t,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,e},removeChars:function(t,e){"undefined"==typeof e&&(e=t+1),this.removeStyleFromTo(t,e),this._text.splice(t,e-t),this.text=this._text.join(""),this.set("dirty",!0),this._removeExtraneousStyles(),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords())}});!function(){var t=fabric.util.toFixed,e=fabric.Object.NUM_FRACTION_DIGITS;fabric.util.object.extend(fabric.Text.prototype,{toSVG:function(t){var e=this._createBaseSVGMarkup(),i=this._getSVGLeftTopOffsets(),r=this._getSVGTextAndBg(i.textTop,i.textLeft);return this._wrapSVGTextAndBg(e,r),t?t(e.join("")):e.join("")},_getSVGLeftTopOffsets:function(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}},_wrapSVGTextAndBg:function(t,e){var i=!0,r=this.getSvgFilter(),n=""===r?"":' style="'+r+'"',s=this.getSvgTextDecoration(this);t.push("	<g ",this.getSvgId(),'transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'"',n,">\n",e.textBgRects.join(""),'		<text xml:space="preserve" ',this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",s?'text-decoration="'+s+'" ':"",'style="',this.getSvgStyles(i),'"',this.addPaintOrder()," >\n",e.textSpans.join(""),"		</text>\n","	</g>\n")},_getSVGTextAndBg:function(t,e){var i,r=[],n=[],s=t;this._setSVGBg(n);for(var o=0,a=this._textLines.length;a>o;o++)i=this._getLineLeftOffset(o),(this.textBackgroundColor||this.styleHas("textBackgroundColor",o))&&this._setSVGTextLineBg(n,o,e+i,s),this._setSVGTextLineText(r,o,e+i,s),s+=this.getHeightOfLine(o);return{textSpans:r,textBgRects:n}},_createTextCharSpan:function(i,r,n,s){var o=this.getSvgSpanStyles(r,i!==i.trim()),a=o?'style="'+o+'"':"";return['			<tspan x="',t(n,e),'" y="',t(s,e),'" ',a,">",fabric.util.string.escapeXml(i),"</tspan>\n"].join("")},_setSVGTextLineText:function(t,e,i,r){var n,s,o,a,h,c=this.getHeightOfLine(e),l=-1!==this.textAlign.indexOf("justify"),u="",f=0,d=this._textLines[e];r+=c*(1-this._fontSizeFraction)/this.lineHeight;for(var g=0,p=d.length-1;p>=g;g++)h=g===p||this.charSpacing,u+=d[g],o=this.__charBounds[e][g],0===f?(i+=o.kernedWidth-o.width,f+=o.width):f+=o.kernedWidth,l&&!h&&this._reSpaceAndTab.test(d[g])&&(h=!0),h||(n=n||this.getCompleteStyleDeclaration(e,g),s=this.getCompleteStyleDeclaration(e,g+1),h=this._hasStyleChangedForSvg(n,s)),h&&(a=this._getStyleDeclaration(e,g)||{},t.push(this._createTextCharSpan(u,a,i,r)),u="",n=s,i+=f,f=0)},_pushTextBgRect:function(i,r,n,s,o,a){i.push("		<rect ",this._getFillAttributes(r),' x="',t(n,e),'" y="',t(s,e),'" width="',t(o,e),'" height="',t(a,e),'"></rect>\n')},_setSVGTextLineBg:function(t,e,i,r){for(var n,s,o=this._textLines[e],a=this.getHeightOfLine(e)/this.lineHeight,h=0,c=0,l=this.getValueOfPropertyAt(e,0,"textBackgroundColor"),u=0,f=o.length;f>u;u++)n=this.__charBounds[e][u],s=this.getValueOfPropertyAt(e,u,"textBackgroundColor"),s!==l?(l&&this._pushTextBgRect(t,l,i+c,r,h,a),c=n.left,h=n.width,l=s):h+=n.kernedWidth;s&&this._pushTextBgRect(t,s,i+c,r,h,a)},_getFillAttributes:function(t){var e=t&&"string"==typeof t?new fabric.Color(t):"";return e&&e.getSource()&&1!==e.getAlpha()?'opacity="'+e.getAlpha()+'" fill="'+e.setAlpha(1).toRgb()+'"':'fill="'+t+'"'},_getSVGLineTopOffset:function(t){for(var e=0,i=0,r=0;t>r;r++)e+=this.getHeightOfLine(r);return i=this.getHeightOfLine(r),{lineTop:e,offset:(this._fontSizeMult-this._fontSizeFraction)*i/(this.lineHeight*this._fontSizeMult)}},getSvgStyles:function(t){var e=fabric.Object.prototype.getSvgStyles.call(this,t);return e+" white-space: pre;"}})}();!function(t){"use strict";var e=t.fabric||(t.fabric={});e.Textbox=e.util.createClass(e.IText,e.Observable,{type:"textbox",minWidth:20,dynamicMinWidth:2,__cachedLines:null,lockScalingFlip:!0,noScaleCache:!1,_dimensionAffectingProps:e.Text.prototype._dimensionAffectingProps.concat("width"),initialize:function(t,e){this.callSuper("initialize",t,e)},initDimensions:function(){this.__skipDimension||(this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),-1!==this.textAlign.indexOf("justify")&&this.enlargeSpaces(),this.height=this.calcTextHeight(),this.saveState({propertySet:"_dimensionAffectingProps"}))},_generateStyleMap:function(t){for(var e=0,i=0,r=0,n={},s=0;s<t.graphemeLines.length;s++)"\n"===t.graphemeText[r]&&s>0?(i=0,r++,e++):this._reSpaceAndTab.test(t.graphemeText[r])&&s>0&&(i++,r++),n[s]={line:e,offset:i},r+=t.graphemeLines[s].length,i+=t.graphemeLines[s].length;return n},styleHas:function(t,i){if(this._styleMap&&!this.isWrapping){var r=this._styleMap[i];r&&(i=r.line)}return e.Text.prototype.styleHas.call(this,t,i)},_getStyleDeclaration:function(t,e){if(this._styleMap&&!this.isWrapping){var i=this._styleMap[t];if(!i)return null;t=i.line,e=i.offset+e}return this.callSuper("_getStyleDeclaration",t,e)},_setStyleDeclaration:function(t,e,i){var r=this._styleMap[t];t=r.line,e=r.offset+e,this.styles[t][e]=i},_deleteStyleDeclaration:function(t,e){var i=this._styleMap[t];t=i.line,e=i.offset+e,delete this.styles[t][e]},_getLineStyle:function(t){var e=this._styleMap[t];return this.styles[e.line]},_setLineStyle:function(t,e){var i=this._styleMap[t];this.styles[i.line]=e},_deleteLineStyle:function(t){var e=this._styleMap[t];delete this.styles[e.line]},_wrapText:function(t,e){var i,r=[];for(this.isWrapping=!0,i=0;i<t.length;i++)r=r.concat(this._wrapLine(t[i],i,e));return this.isWrapping=!1,r},_measureWord:function(t,e,i){var r,n=0,s=!0;i=i||0;for(var o=0,a=t.length;a>o;o++){var h=this._getGraphemeBox(t[o],e,o+i,r,s);n+=h.kernedWidth,r=t[o]}return n},_wrapLine:function(t,i,r){for(var n=0,s=[],o=[],a=t.split(this._reSpaceAndTab),h="",c=0,l=" ",u=0,f=0,d=0,g=!0,p=this._getWidthOfCharSpacing(),v=0;v<a.length;v++)h=e.util.string.graphemeSplit(a[v]),u=this._measureWord(h,i,c),c+=h.length,n+=f+u-p,n>=r&&!g&&(s.push(o),o=[],n=u,g=!0),g||o.push(l),o=o.concat(h),f=this._measureWord([l],i,c),c++,g=!1,u>d&&(d=u);return v&&s.push(o),d>this.dynamicMinWidth&&(this.dynamicMinWidth=d-p),s},isEndOfWrapping:function(t){return this._styleMap[t+1]?this._styleMap[t+1].line!==this._styleMap[t].line?!0:!1:!0},_splitTextIntoLines:function(t){for(var i=e.Text.prototype._splitTextIntoLines.call(this,t),r=this._wrapText(i.lines,this.width),n=new Array(r.length),s=0;s<r.length;s++)n[s]=r[s].join("");return i.lines=n,i.graphemeLines=r,i},getMinWidth:function(){return Math.max(this.minWidth,this.dynamicMinWidth)},toObject:function(t){return this.callSuper("toObject",["minWidth"].concat(t))}}),e.Textbox.fromObject=function(t,i){return e.Object._fromObject("Textbox",t,i,"text")}}("undefined"!=typeof exports?exports:this);!function(){var t=fabric.Canvas.prototype._setObjectScale;fabric.Canvas.prototype._setObjectScale=function(e,i,r,n,s,o,a){var h=i.target;if(!("x"===s&&h instanceof fabric.Textbox))return t.call(fabric.Canvas.prototype,e,i,r,n,s,o,a);var c=h._getTransformedDimensions().x,l=h.width*(e.x/c);return l>=h.getMinWidth()?(h.set("width",l),!0):void 0},fabric.util.object.extend(fabric.Textbox.prototype,{_removeExtraneousStyles:function(){for(var t in this._styleMap)this._textLines[t]||delete this.styles[this._styleMap[t].line]}})}();;
photoeditor={currentSelectedObject:!1,state:[],currentState:0,canvas:null,json_data:!1,canvasWrapper:!1,fileId:0,imageWidth:0,imageHeight:0,initEditor:function(a,b,c,d,e,f,h){b=b+"?"+Date.now();$("#canvasWrapAroundCanvas").html('<canvas id="photoeditorCanvas" width="'+c+'" height="'+d+'" style="width:'+c+"px;height:"+d+'px;"></canvas>');photoeditor.imageWidth=e;photoeditor.imageHeight=f;photoeditor.fileId=a;photoeditor.currentSelectedObject=!1;photoeditor.state=[];photoeditor.currentState=0;photoeditor.canvas&&
photoeditor.canvas.clear();photoeditor.canvas=null;photoeditor.canvas=new fabric.Canvas("photoeditorCanvas",{preserveObjectStacking:!0});photoeditor.json_data=h;photoeditor.canvasWrapper=!1;/(iPhone|iPod|iPad)/i.test(navigator.userAgent)&&(fabric.Object.prototype.cornerSize=30);fabric.Object.prototype.transparentCorners=!1;fabric.Object.prototype.cornerStyle="circle";fabric.Object.prototype.cornerColor="#91b6ff";a=new fabric.Canvas2dFilterBackend;fabric.filterBackend=a;photoeditor.json_data?photoeditor.loadFromJson(photoeditor.json_data,
!0):fabric.Image.fromURL(b,function(a){photoeditor.initializeObject(a);photoeditor.canvas.add(a);photoeditor.saveHistory()},{crossOrigin:"anonymous"});photoeditor.canvas.on("object:selected",function(a){photoeditor.showObjectOptions()});photoeditor.canvas.on("selection:cleared",function(a){$(".objectOptions").hide()});photoeditor.canvas.on("object:modified",function(){photoeditor.saveHistory()},"object:added",function(){photoeditor.saveHistory()});var g=!1;photoeditor.canvas.on("mouse:up",function(a){photoeditor.showObjectOptions();
0!=g&&(photoeditor.rescaleObjects(g),g=!1)});photoeditor.canvas.on("object:scaling",function(a){g=a});$(".colorizer").each(function(){$(this).minicolors({control:$(this).attr("data-control")||"hue",defaultValue:$(this).attr("data-defaultValue")||"",format:$(this).attr("data-format")||"hex",keywords:$(this).attr("data-keywords")||"",inline:"true"===$(this).attr("data-inline"),letterCase:$(this).attr("data-letterCase")||"lowercase",opacity:$(this).attr("data-opacity"),position:$(this).attr("data-position")||
"bottom left",swatches:$(this).attr("data-swatches")?$(this).attr("data-swatches").split("|"):[],change:function(a,b){var c=photoeditor.canvas.getActiveObject();"circle"==c.type&&(c.set({stroke:a,opacity:b}),photoeditor.canvas.renderAll(),photoeditor.saveHistory());"line"==c.type&&(c.set({stroke:a,opacity:b}),photoeditor.canvas.renderAll(),photoeditor.saveHistory());"i-text"==c.type&&(c.set({fill:a,opacity:b}),photoeditor.canvas.renderAll(),photoeditor.saveHistory());if("group"==c.type){c=c.getObjects();
for(var d in c)c[d].set({stroke:a,fill:a,opacity:b});photoeditor.canvas.renderAll();photoeditor.saveHistory()}},theme:"default"})});photoeditor.canvasWrapper=document.getElementById("canvasWrap");photoeditor.canvasWrapper.tabIndex=0;photoeditor.canvasWrapper.focus();photoeditor.canvasWrapper.addEventListener("keydown",photoeditor.canvasKeydownListener,!1)},showObjectOptions:function(){object=photoeditor.canvas.getActiveObject();$(".objectOptions").hide();if("undefined"!=typeof object&&null!=object){var a=
object.type;if("circle"==a){var b=object.get("stroke"),c=object.get("opacity");$("#circleOptions").show();var d=$("#circleOptions .colorizer");d.minicolors("value",{color:b,opacity:c})}"line"==a&&(b=object.get("stroke"),c=object.get("opacity"),$("#lineOptions").show(),d=$("#lineOptions .colorizer"),d.minicolors("value",{color:b,opacity:c}));"i-text"==a&&(b=object.get("fill"),c=object.get("opacity"),$("#i-textOptions").show(),d=$("#i-textOptions .colorizer"),d.minicolors("value",{color:b,opacity:c}));
if("group"==a){a=object.getObjects();for(var e in a){b=a[e].get("stroke");c=a[e].get("opacity");break}$("#path-groupOptions").show();d=$("#path-groupOptions .colorizer");d.minicolors("value",{color:b,opacity:c})}}},rescaleObjects:function(a){if((a=a.target)&&"circle"==a.type){var b=a.scaleX,c=a.scaleY;a.radius*=b;a.width*=b;a.height*=c;a.scaleX=1;a.scaleY=1;a.dirty=!0}},addCircle:function(){var a=new fabric.Circle({fill:"transparent",stroke:"#51b821",radius:15});photoeditor.initializeObject(a);photoeditor.canvas.add(a);
photoeditor.centerObjectInViewPort(a);photoeditor.canvas.setActiveObject(a);photoeditor.showObjectOptions();photoeditor.saveHistory()},addLine:function(a){a=new fabric.Line([100,100,100,300],{stroke:"#000000",strokeWidth:.5,angle:"horizontal"==a?90:0});photoeditor.initializeObject(a);photoeditor.canvas.add(a);photoeditor.centerObjectInViewPort(a);photoeditor.canvas.setActiveObject(a);photoeditor.showObjectOptions();photoeditor.saveHistory()},addText:function(){var a=new fabric.IText("\u0412\u0432\u0435\u0434\u0456\u0442\u044c \u0442\u0435\u043a\u0441\u0442",
{fontFamily:"Helvetica",fill:"#000000",fontSize:16});photoeditor.initializeObject(a);photoeditor.canvas.add(a);photoeditor.centerObjectInViewPort(a);photoeditor.canvas.setActiveObject(a);a.selectAll();a.enterEditing();a.hiddenTextarea.focus();photoeditor.showObjectOptions();photoeditor.saveHistory()},loadSvg:function(a){fabric.loadSVGFromString("arrow"==a?'<svg width="10" height="200" xmlns="http://www.w3.org/2000/svg">\n \x3c!-- Created with Method Draw - http://github.com/duopixel/Method-Draw/ --\x3e\n <g>\n  <line stroke-linecap="undefined" stroke-linejoin="undefined" id="svg_1" y2="184.75272" x2="4.7225" y1="0.75" x1="4.7225" fill-opacity="null" stroke-opacity="null" stroke-width="1.5" stroke="#000" fill="none"/>\n  <path stroke="#000" id="svg_6" d="m0.75,185.44069l3.74997,12.1153l3.74998,-12.1153l-7.49995,0z" stroke-opacity="null" stroke-width="1.5" fill="#000000"/>\n </g>\n</svg>':
'<svg width="757" height="482" xmlns="http://www.w3.org/2000/svg">\nNaN  <line fill="none" x1="756.49955" y1="7.49978" x2="755.87088" y2="189.81265" id="svg_13" stroke-linejoin="null" stroke-linecap="null" stroke="#000000"/>\n  <line fill="none" x1="7.13078" y1="7.49977" x2="6.50212" y2="189.81265" id="svg_14" stroke-linejoin="null" stroke-linecap="null" stroke="#000000"/>\n  <line stroke="#000000" fill="none" x1="6.8808" y1="189.36964" x2="755.49216" y2="189.36964" id="svg_15" stroke-linejoin="null" stroke-linecap="null"/>\n  <line fill="none" x1="30.39139" y1="7.49977" x2="29.76273" y2="189.81265" id="svg_16" stroke-linejoin="null" stroke-linecap="null" stroke="#000000"/>\n  <line fill="none" x1="64.96797" y1="7.49978" x2="64.3393" y2="189.81265" id="svg_17" stroke-linejoin="null" stroke-linecap="null" stroke="#000000"/>\n  <line fill="none" x1="127.83448" y1="7.49978" x2="127.20581" y2="189.81265" id="svg_18" stroke-linejoin="null" stroke-linecap="null" stroke="#000000"/>\n  <line fill="none" x1="222.7629" y1="7.49978" x2="222.13424" y2="189.81265" id="svg_19" stroke-linejoin="null" stroke-linecap="null" stroke="#000000"/>\n  <line fill="none" x1="381.81517" y1="7.49977" x2="381.1865" y2="189.81265" id="svg_20" stroke-linejoin="null" stroke-linecap="null" stroke="#000000"/>\n  <line fill="none" x1="540.86743" y1="7.49977" x2="540.23877" y2="189.81265" id="svg_21" stroke-linejoin="null" stroke-linecap="null" stroke="#000000"/>\n  <line fill="none" x1="635.16719" y1="7.49978" x2="634.53853" y2="189.81265" id="svg_22" stroke-linejoin="null" stroke-linecap="null" stroke="#000000"/>\n  <line fill="none" x1="698.0337" y1="7.49978" x2="697.40503" y2="189.81265" id="svg_23" stroke-linejoin="null" stroke-linecap="null" stroke="#000000"/>\n  <line fill="none" x1="732.61028" y1="7.49978" x2="731.98161" y2="189.81265" id="svg_24" stroke-linejoin="null" stroke-linecap="null" stroke="#000000"/>\n </g>\n</svg>',
function(b,c){b=fabric.util.groupSVGElements(b,c);photoeditor.initializeObject(b);photoeditor.canvas.add(b).renderAll();"arrow"==a?b.set({angle:135}):b.set({scaleX:.5,scaleY:.5});photoeditor.centerObjectInViewPort(b);photoeditor.canvas.setActiveObject(b);photoeditor.showObjectOptions();photoeditor.saveHistory();photoeditor.canvas.renderAll()})},loadFromJson:function(a,b){photoeditor.canvas.clear();photoeditor.canvas.loadFromJSON(a,function(){"undefined"!=typeof b&&1==b&&photoeditor.saveHistory()},
function(a,b){photoeditor.initializeObject(b)})},removeActiveObject:function(){photoeditor.canvas.remove(photoeditor.canvas.getActiveObject());photoeditor.saveHistory()},save:function(){photoeditor.setDefaultZoomPan();var a=photoeditor.canvas.toDataURL({format:"png",multiplier:1}),b=JSON.stringify(photoeditor.canvas.toJSON());ajax({url:"/cabinet/photoeditor",data:{rasterization:a,json_data:b,fileId:photoeditor.fileId},success:function(a){"undefined"!=typeof a.status&&"success"==a.status&&($("#photoeditorModal").modal("hide"),
showNewlyEditedImage(a));"undefined"!=typeof a.error&&messageBoard(a.error,"warning");photoEditingIsGoingOn=!1}})},centerObjectInViewPort:function(a){var b=photoeditor.canvas.calcViewportBoundaries(),c=b.tl;b=b.br;a.setPositionByOrigin({y:(b.y-c.y)/2+c.y,x:(b.x-c.x)/2+c.x},"center","center");a.setCoords()},cloneObject:function(){var a=photoeditor.canvas.getActiveObject();a&&(a=a.toObject(),fabric.util.enlivenObjects([a],function(a){a.forEach(function(a){a.set("top",a.top+50);a.set("left",a.left+50);
photoeditor.initializeObject(a);photoeditor.canvas.add(a);photoeditor.canvas.setActiveObject(a)});photoeditor.canvas.renderAll()}),photoeditor.saveHistory())},initializeObject:function(a){"image"==a.type&&a.set({left:0,top:0,selectable:!1}).scaleToWidth(photoeditor.canvas.getWidth()).setCoords();"i-text"==a.type&&a.setControlsVisibility({tl:!1,tr:!1,bl:!1,mb:!1,ml:!1,mr:!1,mt:!1,mtr:!1});"circle"==a.type&&a.setControlsVisibility({mb:!1,ml:!1,mr:!1,mt:!1,mtr:!1});"line"==a.type&&(a.setControlsVisibility({tl:!1,
tr:!1,bl:!1,br:!1,ml:!1,mr:!1}),a.set("padding",10));if("group"==a.type){var b=a._objects.length;2==b&&(a.setControlsVisibility({tl:!1,tr:!1,bl:!1,br:!1,ml:!1,mr:!1,mb:!1}),a.set("padding",5),a.set("originX","center"),a.set("originY","bottom"),a.set("centeredRotation",!1));2<b&&(a.setControlsVisibility({mt:!1,ml:!1,mr:!1}),a.set({centeredScaling:!0,lockScalingFlip:!0}))}},setDefaultZoomPan:function(){photoeditor.canvas.setZoom(1);photoeditor.canvas.absolutePan({x:0,y:0})},zoomIn:function(){photoeditor.canvas.zoomToPoint(new fabric.Point(photoeditor.canvas.width/
2,photoeditor.canvas.height/2),1.2*photoeditor.canvas.getZoom())},zoomOut:function(){photoeditor.canvas.zoomToPoint(new fabric.Point(photoeditor.canvas.width/2,photoeditor.canvas.height/2),photoeditor.canvas.getZoom()/1.2)},panLeft:function(){photoeditor.canvas.relativePan({x:-20,y:0})},panRight:function(){photoeditor.canvas.relativePan({x:20,y:0})},panTop:function(){photoeditor.canvas.relativePan({x:0,y:-20})},panBottom:function(){photoeditor.canvas.relativePan({x:0,y:20})},saveHistory:function(){0<
photoeditor.currentState&&(photoeditor.state.splice(-photoeditor.currentState,100),photoeditor.currentState=0);var a=JSON.stringify(photoeditor.canvas);photoeditor.state.push(a);8<photoeditor.state.length&&photoeditor.state.shift()},undo:function(){photoeditor.currentState<photoeditor.state.length-1&&(photoeditor.canvas.clear().renderAll(),photoeditor.loadFromJson(photoeditor.state[photoeditor.state.length-1-photoeditor.currentState-1]),photoeditor.currentState+=1)},redo:function(){0<photoeditor.currentState&&
(photoeditor.canvas.clear().renderAll(),photoeditor.loadFromJson(photoeditor.state[photoeditor.state.length-1-photoeditor.currentState+1]),--photoeditor.currentState)},canvasKeydownListener:function(a){switch(a.keyCode){case 8:case 46:photoeditor.removeActiveObject();break;case 13:case 27:photoeditor.canvas.discardActiveObject().renderAll();break;case 37:var b=photoeditor.canvas.getActiveObject();b?a.altKey?photoeditor.rotateActiveObject(-1):photoeditor.moveActiveObject({x:-1,y:0,multiplier:a.shiftKey?
4:1}):photoeditor.panLeft();break;case 39:(b=photoeditor.canvas.getActiveObject())?a.altKey?photoeditor.rotateActiveObject(1):photoeditor.moveActiveObject({x:1,y:0,multiplier:a.shiftKey?4:1}):photoeditor.panRight();break;case 38:a.preventDefault();(b=photoeditor.canvas.getActiveObject())?photoeditor.moveActiveObject({x:0,y:-1,multiplier:a.shiftKey?4:1}):photoeditor.panTop();break;case 40:a.preventDefault();(b=photoeditor.canvas.getActiveObject())?photoeditor.moveActiveObject({x:0,y:1,multiplier:a.shiftKey?
4:1}):photoeditor.panBottom();break;case 68:photoeditor.cloneObject();break;case 43:case 187:photoeditor.zoomIn();break;case 189:photoeditor.zoomOut();break;case 48:photoeditor.setDefaultZoomPan()}},moveActiveObject:function(a){var b=photoeditor.canvas.getActiveObject();if(b){var c=b.getCenterPoint();c.x+=5*a.x*a.multiplier;c.y+=5*a.y*a.multiplier;b.setPositionByOrigin(c,"center","center");b.setCoords();photoeditor.canvas.renderAll()}},rotateActiveObject:function(a){var b=photoeditor.canvas.getActiveObject();
if(b){var c=b.get("angle");b.set({angle:c+a});b.setCoords();photoeditor.canvas.renderAll()}},getFilterValuesAndReset:function(){var a=photoeditor.canvas._objects[0],b=0,c=0,d=!1,e;for(e in a.filters){var f=a.filters[e];"undefined"!=typeof f.brightness&&(b=f.brightness);"undefined"!=typeof f.contrast&&(c=f.contrast);"Grayscale"==f.__proto__.type&&(d=!0)}return{brightness:b,contrast:c,grayscale:d}},changeFilter:function(a,b){var c=photoeditor.canvas._objects[0],d=photoeditor.getFilterValuesAndReset();
switch(a){case "Brightness":d.brightness+=.04*b;break;case "Contrast":d.contrast+=.04*b;break;case "Grayscale":d.grayscale=!d.grayscale}c.filters=[];0!=d.brightness&&c.filters.push(new fabric.Image.filters.Brightness({brightness:d.brightness}));0!=d.contrast&&c.filters.push(new fabric.Image.filters.Contrast({contrast:d.contrast}));d.grayscale&&c.filters.push(new fabric.Image.filters.Grayscale);c.applyFilters();photoeditor.canvas.renderAll();photoeditor.saveHistory()},returnToOriginal:function(a,b){photoEditingIsGoingOn||
(photoEditingIsGoingOn=!0,ajax({url:"/cabinet/image-editor/return-to-original/"+photoeditor.fileId,success:function(a){"undefined"!=typeof a.status&&"success"==a.status&&($("#photoeditorModal").modal("hide"),"undefined"==typeof a.wasntEdited&&showNewlyEditedImage(a),photoEditingIsGoingOn=!1)}}))}};
;
$(document).ready(function(){$("body").on("click","#openPhotoeditor",function(d){var a=$(window).width(),e=$(window).height()-200;currentEditedImage=currentZoomedImage;var l=$(currentEditedImage).attr("data-fileId");ajax({url:"/cabinet/photoeditor/get-image-data-for-editing",data:{imageId:l},success:function(b){$("#photoeditorModal").modal("show");console.log("data",b);var f=b.width,g=b.height,d=b.url,c=f,h=g;if(f>a||g>e){var k=f/g,m=a/e;m<=k&&(c=a,h=a/k);m>k&&(h=e,c=e*k)}c<a?$("#canvasWrapAroundCanvas").css("margin-left",
(a-c)/2):$("#canvasWrapAroundCanvas").css("margin-left",0);h<e&&$("#canvasWrapAroundCanvas").css("margin-top",50);parseInt(b.photoedited)?photoeditor.initEditor(l,"",c,h,f,g,b.json):photoeditor.initEditor(l,d,c,h,f,g,!1)}})});$("body").on("click","#photoeditorReturnToOriginal",function(d){photoEditingIsGoingOn||(photoEditingIsGoingOn=!0,d=$(currentEditedImage).attr("data-fileId"),ajax({url:"/cabinet/image-editor/return-to-original/"+d,success:function(a){"undefined"!=typeof a.status&&"success"==a.status&&
($("#acropModal").modal("hide"),"undefined"==typeof a.wasntEdited&&showNewlyEditedImage(a),photoEditingIsGoingOn=!1)}}))})});
;
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(c,n,k){c instanceof String&&(c=String(c));for(var t=c.length,p=0;p<t;p++){var A=c[p];if(n.call(k,A,p,c))return{i:p,v:A}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(c,n,k){c!=Array.prototype&&c!=Object.prototype&&(c[n]=k.value)};$jscomp.getGlobal=function(c){c=["object"==typeof globalThis&&globalThis,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,c];for(var n=0;n<c.length;++n){var k=c[n];if(k&&k.Math==Math)return k}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(c,n,k,t){if(n){k=$jscomp.global;c=c.split(".");for(t=0;t<c.length-1;t++){var p=c[t];p in k||(k[p]={});k=k[p]}c=c[c.length-1];t=k[c];n=n(t);n!=t&&null!=n&&$jscomp.defineProperty(k,c,{configurable:!0,writable:!0,value:n})}};$jscomp.polyfill("Array.prototype.find",function(c){return c?c:function(c,k){return $jscomp.findInternal(this,c,k).v}},"es6","es3");
(function(c){"function"===typeof define&&define.amd?define(["jquery"],c):"object"===typeof exports?module.exports=c(require("jquery")):c(jQuery)})(function(c){function n(a,b){var e=c('<div class="minicolors" />'),d=c.minicolors.defaults,f;if(!a.data("minicolors-initialized")){b=c.extend(!0,{},d,b);e.addClass("minicolors-theme-"+b.theme).toggleClass("minicolors-with-opacity",b.opacity);void 0!==b.position&&c.each(b.position.split(" "),function(){e.addClass("minicolors-position-"+this)});d="rgb"===
b.format?b.opacity?"25":"20":b.keywords?"11":"7";a.addClass("minicolors-input").data("minicolors-initialized",!1).data("minicolors-settings",b).prop("size",d).wrap(e).after('<div class="minicolors-panel minicolors-slider-'+b.control+'"><div class="minicolors-slider minicolors-sprite"><div class="minicolors-picker"></div></div><div class="minicolors-opacity-slider minicolors-sprite"><div class="minicolors-picker"></div></div><div class="minicolors-grid minicolors-sprite"><div class="minicolors-grid-inner"></div><div class="minicolors-picker"><div></div></div></div></div>');
b.inline||(a.after('<span class="minicolors-swatch minicolors-sprite minicolors-input-swatch"><span class="minicolors-swatch-color"></span></span>'),a.next(".minicolors-input-swatch").on("click",function(b){b.preventDefault();a.focus()}));d=a.parent().find(".minicolors-panel");d.on("selectstart",function(){return!1}).end();if(b.swatches&&0!==b.swatches.length)for(d.addClass("minicolors-with-swatches"),d=c('<ul class="minicolors-swatches"></ul>').appendTo(d),f=0;f<b.swatches.length;++f){var g=b.swatches[f];
g=w(g)?x(g,!0):u(y(g,!0));c('<li class="minicolors-swatch minicolors-sprite"><span class="minicolors-swatch-color"></span></li>').appendTo(d).data("swatch-color",b.swatches[f]).find(".minicolors-swatch-color").css({backgroundColor:C(g),opacity:g.a});b.swatches[f]=g}b.inline&&a.parent().addClass("minicolors-inline");z(a,!1);a.data("minicolors-initialized",!0)}}function k(a){var b=a.parent();a.removeData("minicolors-initialized").removeData("minicolors-settings").removeProp("size").removeClass("minicolors-input");
b.before(a).remove()}function t(a){var b=a.parent(),c=b.find(".minicolors-panel"),d=a.data("minicolors-settings");!a.data("minicolors-initialized")||a.prop("disabled")||b.hasClass("minicolors-inline")||b.hasClass("minicolors-focus")||(p(),b.addClass("minicolors-focus"),c.stop(!0,!0).fadeIn(d.showSpeed,function(){d.show&&d.show.call(a.get(0))}))}function p(){c(".minicolors-focus").each(function(){var a=c(this),b=a.find(".minicolors-input"),e=a.find(".minicolors-panel"),d=b.data("minicolors-settings");
e.fadeOut(d.hideSpeed,function(){d.hide&&d.hide.call(b.get(0));a.removeClass("minicolors-focus")})})}function A(a,b,c){var d=a.parents(".minicolors").find(".minicolors-input"),e=d.data("minicolors-settings"),g=a.find("[class$=-picker]"),l=a.offset().left,h=a.offset().top,m=Math.round(b.pageX-l),q=Math.round(b.pageY-h);c=c?e.animationSpeed:0;b.originalEvent.changedTouches&&(m=b.originalEvent.changedTouches[0].pageX-l,q=b.originalEvent.changedTouches[0].pageY-h);0>m&&(m=0);0>q&&(q=0);m>a.width()&&(m=
a.width());q>a.height()&&(q=a.height());a.parent().is(".minicolors-slider-wheel")&&g.parent().is(".minicolors-grid")&&(l=75-m,h=75-q,b=Math.sqrt(l*l+h*h),l=Math.atan2(h,l),0>l&&(l+=2*Math.PI),75<b&&(b=75,m=75-75*Math.cos(l),q=75-75*Math.sin(l)),m=Math.round(m),q=Math.round(q));a.is(".minicolors-grid")?g.stop(!0).animate({top:q+"px",left:m+"px"},c,e.animationEasing,function(){E(d,a)}):g.stop(!0).animate({top:q+"px"},c,e.animationEasing,function(){E(d,a)})}function E(a,b){function c(a,b){if(!a.length||
!b)return null;var c=a.offset().left;var d=a.offset().top;return{x:c-b.offset().left+a.outerWidth()/2,y:d-b.offset().top+a.outerHeight()/2}}var d=a.val();var f=a.attr("data-opacity");var g=a.parent();var l=a.data("minicolors-settings"),k=g.find(".minicolors-input-swatch");var m=g.find(".minicolors-grid");var q=g.find(".minicolors-slider"),n=g.find(".minicolors-opacity-slider");var r=m.find("[class$=-picker]");var p=q.find("[class$=-picker]"),t=n.find("[class$=-picker]");r=c(r,m);p=c(p,q);t=c(t,n);
if(b.is(".minicolors-grid, .minicolors-slider, .minicolors-opacity-slider")){switch(l.control){case "wheel":d=m.width()/2-r.x;g=m.height()/2-r.y;m=Math.sqrt(d*d+g*g);d=Math.atan2(g,d);0>d&&(d+=2*Math.PI);75<m&&(m=75,r.x=69-75*Math.cos(d),r.y=69-75*Math.sin(d));b=h(m/.75,0,100);f=h(180*d/Math.PI,0,360);r=h(100-Math.floor(p.y*(100/q.height())),0,100);d=v({h:f,s:b,b:r});q.css("backgroundColor",v({h:f,s:b,b:100}));break;case "saturation":f=h(parseInt(r.x*(360/m.width()),10),0,360);b=h(100-Math.floor(p.y*
(100/q.height())),0,100);r=h(100-Math.floor(r.y*(100/m.height())),0,100);d=v({h:f,s:b,b:r});q.css("backgroundColor",v({h:f,s:100,b:r}));g.find(".minicolors-grid-inner").css("opacity",b/100);break;case "brightness":f=h(parseInt(r.x*(360/m.width()),10),0,360);b=h(100-Math.floor(r.y*(100/m.height())),0,100);r=h(100-Math.floor(p.y*(100/q.height())),0,100);d=v({h:f,s:b,b:r});q.css("backgroundColor",v({h:f,s:b,b:100}));g.find(".minicolors-grid-inner").css("opacity",1-r/100);break;default:f=h(360-parseInt(p.y*
(360/q.height()),10),0,360),b=h(Math.floor(r.x*(100/m.width())),0,100),r=h(100-Math.floor(r.y*(100/m.height())),0,100),d=v({h:f,s:b,b:r}),m.css("backgroundColor",v({h:f,s:100,b:100}))}f=l.opacity?parseFloat(1-t.y/n.height()).toFixed(2):1;F(a,d,f)}else k.find("span").css({backgroundColor:d,opacity:f}),D(a,d,f)}function F(a,b,c){var d=a.parent(),e=a.data("minicolors-settings");d=d.find(".minicolors-input-swatch");e.opacity&&a.attr("data-opacity",c);if("rgb"===e.format){b=w(b)?x(b,!0):u(y(b,!0));c=""===
a.attr("data-opacity")?1:h(parseFloat(a.attr("data-opacity")).toFixed(2),0,1);if(isNaN(c)||!e.opacity)c=1;b=1>=a.minicolors("rgbObject").a&&b&&e.opacity?"rgba("+b.r+", "+b.g+", "+b.b+", "+parseFloat(c)+")":"rgb("+b.r+", "+b.g+", "+b.b+")"}else w(b)&&(b=G(b)),b=B(b,e.letterCase);a.val(b);d.find("span").css({backgroundColor:b,opacity:c});D(a,b,c)}function z(a,b){var e;var d=a.parent();var f=a.data("minicolors-settings");var g=d.find(".minicolors-input-swatch");var l=d.find(".minicolors-grid"),k=d.find(".minicolors-slider"),
m=d.find(".minicolors-opacity-slider"),q=l.find("[class$=-picker]"),p=k.find("[class$=-picker]"),r=m.find("[class$=-picker]");if(w(a.val())){var n=G(a.val());(e=h(parseFloat(H(a.val())).toFixed(2),0,1))&&a.attr("data-opacity",e)}else n=B(y(a.val(),!0),f.letterCase);n||(n=B(I(f.defaultValue,!0),f.letterCase));e=J(n);var t=f.keywords?c.map(f.keywords.split(","),function(a){return c.trim(a.toLowerCase())}):[];t=""!==a.val()&&-1<c.inArray(a.val().toLowerCase(),t)?B(a.val()):w(a.val())?x(a.val()):n;b||
a.val(t);if(f.opacity){var u=""===a.attr("data-opacity")?1:h(parseFloat(a.attr("data-opacity")).toFixed(2),0,1);isNaN(u)&&(u=1);a.attr("data-opacity",u);g.find("span").css("opacity",u);b=h(m.height()-m.height()*u,0,m.height());r.css("top",b+"px")}"transparent"===a.val().toLowerCase()&&g.find("span").css("opacity",0);g.find("span").css("backgroundColor",n);switch(f.control){case "wheel":d=h(Math.ceil(.75*e.s),0,l.height()/2);g=e.h*Math.PI/180;f=h(75-Math.cos(g)*d,0,l.width());b=h(75-Math.sin(g)*d,
0,l.height());q.css({top:b+"px",left:f+"px"});b=150-e.b/(100/l.height());""===n&&(b=0);p.css("top",b+"px");k.css("backgroundColor",v({h:e.h,s:e.s,b:100}));break;case "saturation":f=h(5*e.h/12,0,150);b=h(l.height()-Math.ceil(e.b/(100/l.height())),0,l.height());q.css({top:b+"px",left:f+"px"});b=h(k.height()-e.s*(k.height()/100),0,k.height());p.css("top",b+"px");k.css("backgroundColor",v({h:e.h,s:100,b:e.b}));d.find(".minicolors-grid-inner").css("opacity",e.s/100);break;case "brightness":f=h(5*e.h/12,
0,150);b=h(l.height()-Math.ceil(e.s/(100/l.height())),0,l.height());q.css({top:b+"px",left:f+"px"});b=h(k.height()-e.b*(k.height()/100),0,k.height());p.css("top",b+"px");k.css("backgroundColor",v({h:e.h,s:e.s,b:100}));d.find(".minicolors-grid-inner").css("opacity",1-e.b/100);break;default:f=h(Math.ceil(e.s/(100/l.width())),0,l.width()),b=h(l.height()-Math.ceil(e.b/(100/l.height())),0,l.height()),q.css({top:b+"px",left:f+"px"}),b=h(k.height()-e.h/(360/k.height()),0,k.height()),p.css("top",b+"px"),
l.css("backgroundColor",v({h:e.h,s:100,b:100}))}a.data("minicolors-initialized")&&D(a,t,u)}function D(a,b,c){var d=a.data("minicolors-settings"),e=a.data("minicolors-lastChange"),g;if(!e||e.value!==b||e.opacity!==c){a.data("minicolors-lastChange",{value:b,opacity:c});if(d.swatches&&0!==d.swatches.length){e=w(b)?x(b,!0):u(b);var h=-1;for(g=0;g<d.swatches.length;++g)if(e.r===d.swatches[g].r&&e.g===d.swatches[g].g&&e.b===d.swatches[g].b&&e.a===d.swatches[g].a){h=g;break}a.parent().find(".minicolors-swatches .minicolors-swatch").removeClass("selected");
-1!==h&&a.parent().find(".minicolors-swatches .minicolors-swatch").eq(g).addClass("selected")}d.change&&(d.changeDelay?(clearTimeout(a.data("minicolors-changeTimeout")),a.data("minicolors-changeTimeout",setTimeout(function(){d.change.call(a.get(0),b,c)},d.changeDelay))):d.change.call(a.get(0),b,c));a.trigger("change").trigger("input")}}function K(a){var b=c(a).attr("data-opacity");w(c(a).val())?a=x(c(a).val(),!0):(a=y(c(a).val(),!0),a=u(a));if(!a)return null;void 0!==b&&c.extend(a,{a:parseFloat(b)});
return a}function L(a,b){var e=c(a).attr("data-opacity");w(c(a).val())?a=x(c(a).val(),!0):(a=y(c(a).val(),!0),a=u(a));if(!a)return null;void 0===e&&(e=1);return b?"rgba("+a.r+", "+a.g+", "+a.b+", "+parseFloat(e)+")":"rgb("+a.r+", "+a.g+", "+a.b+")"}function B(a,b){return"uppercase"===b?a.toUpperCase():a.toLowerCase()}function y(a,b){a=a.replace(/^#/g,"");if(!a.match(/^[A-F0-9]{3,6}/ig)||3!==a.length&&6!==a.length)return"";3===a.length&&b&&(a=a[0]+a[0]+a[1]+a[1]+a[2]+a[2]);return"#"+a}function x(a,
b){a=a.replace(/[^\d,.]/g,"").split(",");a[0]=h(parseInt(a[0],10),0,255);a[1]=h(parseInt(a[1],10),0,255);a[2]=h(parseInt(a[2],10),0,255);a[3]&&(a[3]=h(parseFloat(a[3],10),0,1));return b?a[3]?{r:a[0],g:a[1],b:a[2],a:a[3]}:{r:a[0],g:a[1],b:a[2]}:"undefined"!==typeof a[3]&&1>=a[3]?"rgba("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")":"rgb("+a[0]+", "+a[1]+", "+a[2]+")"}function I(a,b){return w(a)?x(a):y(a,b)}function h(a,b,c){a<b&&(a=b);a>c&&(a=c);return a}function w(a){return(a=a.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i))&&
4===a.length?!0:!1}function H(a){return(a=a.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+(\.\d{1,2})?|\.\d{1,2})[\s+]?/i))&&6===a.length?a[4]:"1"}function G(a){return(a=a.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i))&&4===a.length?"#"+("0"+parseInt(a[1],10).toString(16)).slice(-2)+("0"+parseInt(a[2],10).toString(16)).slice(-2)+("0"+parseInt(a[3],10).toString(16)).slice(-2):""}function C(a){var b=[a.r.toString(16),a.g.toString(16),
a.b.toString(16)];c.each(b,function(a,c){1===c.length&&(b[a]="0"+c)});return"#"+b.join("")}function v(a){var b,c;var d=Math.round(a.h);var f=Math.round(255*a.s/100);a=Math.round(255*a.b/100);if(0===f)d=b=c=a;else{f=(255-f)*a/255;var g=d%60*(a-f)/60;360===d&&(d=0);60>d?(d=a,c=f,b=f+g):120>d?(b=a,c=f,d=a-g):180>d?(b=a,d=f,c=f+g):240>d?(c=a,d=f,b=a-g):300>d?(c=a,b=f,d=f+g):360>d?(d=a,b=f,c=a-g):c=b=d=0}return C({r:Math.round(d),g:Math.round(b),b:Math.round(c)})}function J(a){a=u(a);var b={h:0,s:0,b:0},
c=Math.max(a.r,a.g,a.b),d=c-Math.min(a.r,a.g,a.b);b.b=c;b.s=0!==c?255*d/c:0;b.h=0!==b.s?a.r===c?(a.g-a.b)/d:a.g===c?2+(a.b-a.r)/d:4+(a.r-a.g)/d:-1;b.h*=60;0>b.h&&(b.h+=360);b.s*=100/255;b.b*=100/255;0===b.s&&(b.h=360);return b}function u(a){a=parseInt(-1<a.indexOf("#")?a.substring(1):a,16);return{r:a>>16,g:(a&65280)>>8,b:a&255}}c.minicolors={defaults:{animationSpeed:50,animationEasing:"swing",change:null,changeDelay:0,control:"hue",defaultValue:"",format:"hex",hide:null,hideSpeed:100,inline:!1,keywords:"",
letterCase:"lowercase",opacity:!1,position:"bottom left",show:null,showSpeed:100,theme:"default",swatches:[]}};c.extend(c.fn,{minicolors:function(a,b){switch(a){case "destroy":return c(this).each(function(){k(c(this))}),c(this);case "hide":return p(),c(this);case "opacity":if(void 0===b)return c(this).attr("data-opacity");c(this).each(function(){z(c(this).attr("data-opacity",b))});return c(this);case "rgbObject":return K(c(this),"rgbaObject"===a);case "rgbString":case "rgbaString":return L(c(this),
"rgbaString"===a);case "settings":if(void 0===b)return c(this).data("minicolors-settings");c(this).each(function(){var a=c(this).data("minicolors-settings")||{};k(c(this));c(this).minicolors(c.extend(!0,a,b))});return c(this);case "show":return t(c(this).eq(0)),c(this);case "value":if(void 0===b)return c(this).val();c(this).each(function(){"object"===typeof b&&"null"!==b?(b.opacity&&c(this).attr("data-opacity",h(b.opacity,0,1)),b.color&&c(this).val(b.color)):c(this).val(b);z(c(this))});return c(this);
default:return"create"!==a&&(b=a),c(this).each(function(){n(c(this),b)}),c(this)}}});c([document,top.document]).on("mousedown.minicolors touchstart.minicolors",function(a){c(a.target).parents().add(a.target).hasClass("minicolors")||p()}).on("mousedown.minicolors touchstart.minicolors",".minicolors-grid, .minicolors-slider, .minicolors-opacity-slider",function(a){var b=c(this);a.preventDefault();c(a.delegateTarget).data("minicolors-target",b);A(b,a,!0)}).on("mousemove.minicolors touchmove.minicolors",
function(a){var b=c(a.delegateTarget).data("minicolors-target");b&&A(b,a)}).on("mouseup.minicolors touchend.minicolors",function(){c(this).removeData("minicolors-target")}).on("click.minicolors",".minicolors-swatches li",function(a){a.preventDefault();var b=c(this);a=b.parents(".minicolors").find(".minicolors-input");b=b.data("swatch-color");F(a,b,H(b));z(a)}).on("mousedown.minicolors touchstart.minicolors",".minicolors-input-swatch",function(a){var b=c(this).parent().find(".minicolors-input");a.preventDefault();
t(b)}).on("focus.minicolors",".minicolors-input",function(){var a=c(this);a.data("minicolors-initialized")&&t(a)}).on("blur.minicolors",".minicolors-input",function(){var a=c(this),b=a.data("minicolors-settings");if(a.data("minicolors-initialized")){var e=b.keywords?c.map(b.keywords.split(","),function(a){return c.trim(a.toLowerCase())}):[];if(""!==a.val()&&-1<c.inArray(a.val().toLowerCase(),e))var d=a.val();else e=w(a.val())?x(a.val(),!0):(e=y(a.val(),!0))?u(e):null,d=null===e?b.defaultValue:"rgb"===
b.format?b.opacity?x("rgba("+e.r+","+e.g+","+e.b+","+a.attr("data-opacity")+")"):x("rgb("+e.r+","+e.g+","+e.b+")"):C(e);e=b.opacity?a.attr("data-opacity"):1;"transparent"===d.toLowerCase()&&(e=0);a.closest(".minicolors").find(".minicolors-input-swatch > span").css("opacity",e);a.val(d);""===a.val()&&a.val(I(b.defaultValue,!0));a.val(B(a.val(),b.letterCase))}}).on("keydown.minicolors",".minicolors-input",function(a){var b=c(this);if(b.data("minicolors-initialized"))switch(a.keyCode){case 9:p();break;
case 13:case 27:p(),b.blur()}}).on("keyup.minicolors",".minicolors-input",function(){var a=c(this);a.data("minicolors-initialized")&&z(a,!0)}).on("paste.minicolors",".minicolors-input",function(){var a=c(this);a.data("minicolors-initialized")&&setTimeout(function(){z(a,!0)},1)})});
;
/*
 * @license Multi Input Mask plugin for jquery
 * https://github.com/andr-04/inputmask-multi
 * Copyright (c) 2012-2016 Andrey Egorov
 * Licensed under the MIT license (http://www.opensource.org/licenses/mit-license.php)
 * Version: 1.2.0
 *
 * Requriements:
 * https://github.com/RobinHerbots/jquery.inputmask
 */
!function(t){t.masksLoad=function(e){var s;return t.ajax({url:e,async:!1,dataType:"json",success:function(t){s=t}}),s},t.masksSort=function(e,s,i,n){return e.sort(function(e,a){for(var r=0,o=0;r<e[n].length&&o<a[n].length;){var h=e[n].charAt(r),c=a[n].charAt(o);if(i.test(h))if(i.test(c)){if(-1!=t.inArray(h,s)&&-1==t.inArray(c,s))return 1;if(-1==t.inArray(h,s)&&-1!=t.inArray(c,s))return-1;if(-1==t.inArray(h,s)&&-1==t.inArray(c,s)&&h!=c)return c>h?-1:1;r++,o++}else o++;else r++}for(;r<e[n].length||o<a[n].length;)if(r<e[n].length&&!i.test(e[n].charAt(r)))r++;else if(o<a[n].length&&!i.test(a[n].charAt(o)))o++;else{if(r<e[n].length)return 1;if(o<a[n].length)return-1}return 0}),e};var e=function(t,e){if("number"!=typeof t){if(this.setSelectionRange)t=this.selectionStart,e=this.selectionEnd;else if(document.selection&&document.selection.createRange){var s=document.selection.createRange();t=0-s.duplicate().moveStart("character",-1e5),e=t+s.text.length}return{begin:t,end:e}}if(e="number"==typeof e?e:t,this.setSelectionRange)this.setSelectionRange(t,e);else if(this.createTextRange){var s=this.createTextRange();s.collapse(!0),s.moveEnd("character",e),s.moveStart("character",t),s.select()}},s=Object.keys||function(t){if(t!==Object(t))throw new TypeError("Invalid object");var e=[];for(var s in t)e[e.length]=s;return e},i=function(t){for(var e=this.inputmasks.options,i="",n=0;n<t.length;n++){var a=t.charAt(n);if(a==this.inputmasks.placeholder)break;e.match.test(a)&&(i+=a)}for(var r in e.list){for(var o=e.list[r][e.listKey],h=!0,c=0,u=0;c<i.length&&u<o.length;){var l=o.charAt(u),p=i.charAt(c);if(e.match.test(l)||l in this.inputmasks.defs){if(!(l in this.inputmasks.defs&&this.inputmasks.defs[l].test(p)||p==l)){h=!1;break}c++,u++}else u++}if(h&&c==i.length){var m=-1==o.substr(u).search(e.match);o=o.replace(new RegExp([e.match.source].concat(s(this.inputmasks.defs)).join("|"),"g"),e.replace);var d=-1==o.substr(u).search(e.replace);return{mask:o,obj:e.list[r],determined:m,completed:d}}}return!1},n=function(t,e,s){var i=this.inputmasks.options;if(!t)return 0;for(var n=0,a=0;n<s.begin;n++)t.charAt(n)==i.replace&&a++;for(var r=0;n<s.end;n++)t.charAt(n)==i.replace&&r++;for(n=0;n<e.length&&(a>0||e.charAt(n)!=i.replace);n++)e.charAt(n)==i.replace&&a--;for(a=n;n<e.length&&r>0;n++)e.charAt(n)==i.replace&&r--;return r=n,{begin:a,end:r}},a=function(){t(this).off(".inputmasks")},r=function(){events=t._data(this,"events");var e=["keydown","keypress","paste","dragdrop","drop","setvalue","reset","cut","blur"],s=this;t.each(e,function(e,i){t.each(s.inputmask.events[i],function(e,n){t(s).off(i,n)})})},o=function(e){var s=this;t.each(this.inputmask.events[e.type],function(t,i){i.call(s,e)})},h=function(){t(this).on("keydown.inputmasks",l).on("keypress.inputmasks",p).on("paste.inputmasks",d).on("dragdrop.inputmasks",d).on("drop.inputmasks",d).on("cut.inputmasks",d).on("setvalue.inputmasks",m).on("blur.inputmasks",m).on("reset.inputmasks",m)},c=function(s,i){var a=this.inputmasks.options;if(s&&(void 0!==i||s.mask!=this.inputmasks.oldmatch.mask)){var o;void 0===i?o=n.call(this,this.inputmasks.oldmatch.mask,s.mask,e.call(this)):(this.inputmask&&this.inputmask.remove(),this.value=i),t(this).inputmask(s.mask,t.extend(!0,a.inputmask,{insertMode:this.inputmasks.insertMode})),r.call(this),void 0===i&&e.call(this,o.begin,o.end)}this.inputmasks.oldmatch=s,a.onMaskChange.call(this,s.obj,s.determined)},u=function(t,e,s){var n=i.call(this,e);return n&&n.obj==this.inputmasks.oldmatch.obj&&n.determined==this.inputmasks.oldmatch.determined?(o.call(this,t),!0):(n?s?(c.call(this,n),o.call(this,t)):(o.call(this,t),c.call(this,n)):s&&this.inputmasks.insertMode||f.call(this,e),!1)},l=function(t){if(t.metaKey)return o.call(this,t),!0;var s=this.inputmasks.options;t=t||window.event;var i=t.which||t.charCode||t.keyCode;if(8==i||46==i||this.inputmasks.iphone&&127==i){var n=this.inputmask._valueGet(),a=e.call(this);if(a.begin==a.end){var r=a.begin;do{46!=i&&r--;var h=n.charAt(r);n=n.substring(0,r)+n.substring(r+1)}while(r>0&&r<n.length&&h!=this.inputmasks.placeholder&&!s.match.test(h))}else n=n.substring(0,a.begin)+n.substring(a.end);return u.call(this,t,n,!1)}return 45==i&&(this.inputmasks.insertMode=!this.inputmasks.insertMode),o.call(this,t),!0},p=function(t){if(t.metaKey)return o.call(this,t),!0;var s=this.inputmask._valueGet();t=t||window.event;var i=t.which||t.charCode||t.keyCode,n=String.fromCharCode(i);return caretPos=e.call(this),s=caretPos.begin==caretPos.end&&s.charAt(caretPos.begin)==this.inputmasks.placeholder?s.substring(0,caretPos.begin)+n+s.substring(caretPos.end+1):s.substring(0,caretPos.begin)+n+s.substring(caretPos.end),u.call(this,t,s,!0)},m=function(t){return f.call(this),!0},d=function(t){var e=this;return setTimeout(function(){f.call(e)},0),!0},f=function(t){void 0===t&&(t=this.inputmask&&this.inputmask._valueGet?this.inputmask._valueGet():this.value);for(var e=i.call(this,t);!e&&t.length>0;)t=t.substr(0,t.length-1),e=i.call(this,t);c.call(this,e,t)},k=function(e){e=t.extend(!0,{onMaskChange:t.noop},e);var s={};for(var i in e.inputmask.definitions){var n=e.inputmask.definitions[i].validator;switch(typeof n){case"string":s[i]=new RegExp(n);break;case"object":"test"in e.definitions[i].validator&&(s[i]=n);break;case"function":s[i]={test:n}}}e.inputmask.definitions[e.replace]={validator:e.match.source,cardinality:1},this.inputmasks&&t(this).inputmasks("remove"),this.inputmasks={},this.inputmasks.options=e,this.inputmasks.defs=s,this.inputmasks.iphone=null!=navigator.userAgent.match(/iphone/i),this.inputmasks.oldmatch=!1,this.inputmasks.placeholder=e.inputmask.placeholder||Inputmask.prototype.defaults.placeholder,this.inputmasks.insertMode=void 0!==e.inputmask.insertMode?e.inputmask.insertMode:Inputmask.prototype.defaults.insertMode,f.call(this)};t.fn.inputmasks=function(e){switch(e){case"remove":a.call(this),this.inputmasks=void 0,t(this).inputmask("remove");break;case"isCompleted":var s=i.call(this[0],this[0].inputmask&&this[0].inputmask._valueGet()||this[0].value);return s&&s.completed;default:return this.each(function(){k.call(this,e),h.call(this)}),this}}}(jQuery);;
function applyPhoneMask(a){var b={inputmask:{definitions:{"#":{validator:"[0-9]",cardinality:1}},showMaskOnHover:!1,autoUnmask:!0},match:/[0-9]/,replace:"#",list:$.masksSort($.masksLoad("/c/js/inputmask-multi/data/phone-codes.json"),["#"],/[0-9]|#/,"mask"),listKey:"mask"};$(a).inputmasks(b)};
;
(function(d,b){"function"===typeof define&&define.amd?define([],b):"undefined"!==typeof module&&module.exports?module.exports=b():d.ReconnectingWebSocket=b()})(this,function(){function d(b,q,k){function h(a,d){var c=document.createEvent("CustomEvent");c.initCustomEvent(a,!1,!1,d);return c}var n={debug:!1,automaticOpen:!0,reconnectInterval:1E3,maxReconnectInterval:3E4,reconnectDecay:1.5,timeoutInterval:2E3,maxReconnectAttempts:null,binaryType:"blob"};k||(k={});for(var l in n)this[l]="undefined"!==
typeof k[l]?k[l]:n[l];this.url=b;this.reconnectAttempts=0;this.readyState=WebSocket.CONNECTING;this.protocol=null;var a=this,f,p=!1,m=!1,e=document.createElement("div");e.addEventListener("open",function(c){a.onopen(c)});e.addEventListener("close",function(c){a.onclose(c)});e.addEventListener("connecting",function(c){a.onconnecting(c)});e.addEventListener("message",function(c){a.onmessage(c)});e.addEventListener("error",function(c){a.onerror(c)});this.addEventListener=e.addEventListener.bind(e);this.removeEventListener=
e.removeEventListener.bind(e);this.dispatchEvent=e.dispatchEvent.bind(e);this.open=function(c){f=new WebSocket(a.url,q||[]);f.binaryType=this.binaryType;if(c){if(this.maxReconnectAttempts&&this.reconnectAttempts>this.maxReconnectAttempts)return}else e.dispatchEvent(h("connecting")),this.reconnectAttempts=0;(a.debug||d.debugAll)&&console.debug("ReconnectingWebSocket","attempt-connect",a.url);var b=f,k=setTimeout(function(){(a.debug||d.debugAll)&&console.debug("ReconnectingWebSocket","connection-timeout",
a.url);m=!0;b.close();m=!1},a.timeoutInterval);f.onopen=function(g){clearTimeout(k);(a.debug||d.debugAll)&&console.debug("ReconnectingWebSocket","onopen",a.url);a.protocol=f.protocol;a.readyState=WebSocket.OPEN;a.reconnectAttempts=0;g=h("open");g.isReconnect=c;c=!1;e.dispatchEvent(g)};f.onclose=function(g){clearTimeout(b);f=null;if(p)a.readyState=WebSocket.CLOSED,e.dispatchEvent(h("close"));else{Logging.error(g);a.readyState=WebSocket.CONNECTING;b=h("connecting");b.code=g.code;b.reason=g.reason;b.wasClean=
g.wasClean;e.dispatchEvent(b);c||m||((a.debug||d.debugAll)&&console.debug("ReconnectingWebSocket","onclose",a.url),e.dispatchEvent(h("close")));var b=a.reconnectInterval*Math.pow(a.reconnectDecay,a.reconnectAttempts);setTimeout(function(){a.reconnectAttempts++;a.open(!0)},b>a.maxReconnectInterval?a.maxReconnectInterval:b)}};f.onmessage=function(c){(a.debug||d.debugAll)&&console.debug("ReconnectingWebSocket","onmessage",a.url,c.data);var b=h("message");b.data=c.data;e.dispatchEvent(b)};f.onerror=function(c){(a.debug||
d.debugAll)&&console.debug("ReconnectingWebSocket","onerror",a.url,c);e.dispatchEvent(h("error"))}};1==this.automaticOpen&&this.open(!1);this.send=function(c){if(f)return(a.debug||d.debugAll)&&console.debug("ReconnectingWebSocket","send",a.url,c),f.send(c);throw"INVALID_STATE_ERR : Pausing to reconnect websocket";};this.close=function(a,b){"undefined"==typeof a&&(a=1E3);p=!0;f&&f.close(a,b)};this.refresh=function(){f&&f.close()}}if("WebSocket"in window)return d.prototype.onopen=function(b){},d.prototype.onclose=
function(b){},d.prototype.onconnecting=function(b){},d.prototype.onmessage=function(b){},d.prototype.onerror=function(b){},d.debugAll=!1,d.CONNECTING=WebSocket.CONNECTING,d.OPEN=WebSocket.OPEN,d.CLOSING=WebSocket.CLOSING,d.CLOSED=WebSocket.CLOSED,d});
;
var wss=!0,mainWebSocket=!1,wsOnOpenCount=0,CC_ONLINE_USER_IDS={},currentWebsocketPageType=-1,WS_PAGE_TYPE_STANDARD=0,WS_PAGE_TYPE_SCHEDULE=1,WS_PAGE_TYPE_PATIENT_HISTORY=2,currentWsPageType=0,sayStoppedTimeout=null,typingInterval=null,sayTyping=function(){pageWebSocket.send(JSON.stringify({messageType:"typingOn",stageId:13}))},sayStopped=function(){pageWebSocket.send(JSON.stringify({messageType:"typingOff",stageId:13}))};
function getCurrentWsPageType(){return"#schedule"==document.location.hash||"#schedule/assistants"==location.hash||"#schedule/administrators"==location.hash?WS_PAGE_TYPE_SCHEDULE:WS_PAGE_TYPE_STANDARD}
function updateWsPageType(){try{if(mainWebSocket){var a=getCurrentWsPageType();currentWebsocketPageType!=a&&(currentWebsocketPageType=a,mainWebSocket.send(JSON.stringify({message:"sendMessage",messageType:"changePageType",clinicId:currentClinicId,hash:currentClinicWssHash,pageType:a,userId:currentCabinetUserId})))}else mainWebSocket=websocketConnect()}catch(b){Logging.exception(b)}}
function websocketConnect(){currentWebsocketPageType=getCurrentWsPageType();ws=new ReconnectingWebSocket("wss://678zw4tild.execute-api.eu-central-1.amazonaws.com/Prod/?user_id="+currentCabinetUserId+"&hash="+currentClinicWssHash+"&clinic_id="+currentClinicId+"&page_type="+currentWebsocketPageType,null,{debug:!0,reconnectInterval:1E3});ws.onmessage=function(a){try{var b=eval("("+a.data+")")}catch(f){messageBoard(a.data,"warning"),Logging.exception(f)}a=document.location.hash;switch(b.type){case "getUpdates":checkNotifications();
break;case "allUsersOnline":CC_ONLINE_USER_IDS=b.online_ids;break;case "userComesOnline":CC_ONLINE_USER_IDS[b.user_id]=b.user_id;/#patients\/stages\/[0-9]+/.test(a)||/#plans\/.*/.test(a)||/#schedule-visits\/list\/[0-9]+/.test(a)||/#invoices-and-payments\/list\/[0-9]+/.test(a)||/#plan-items\/list\/[0-9]+/.test(a)||/#patients-payments\/list\/[0-9]+/.test(a)||/#invoices\/list\/[0-9]+/.test(a)?setColleaguesOnlineStatusOnPatientPage(CC_ONLINE_USER_IDS):"#colleagues"==a&&$("#cabinetUser"+b.user_id).addClass("online");
break;case "userGoesOffline":delete CC_ONLINE_USER_IDS[b.user_id];/#patients\/stages\/[0-9]+/.test(a)||/#plans\/.*/.test(a)||/#schedule-visits\/list\/[0-9]+/.test(a)||/#invoices-and-payments\/list\/[0-9]+/.test(a)||/#plan-items\/list\/[0-9]+/.test(a)||/#patients-payments\/list\/[0-9]+/.test(a)||/#invoices\/list\/[0-9]+/.test(a)?setColleaguesOnlineStatusOnPatientPage(CC_ONLINE_USER_IDS):"#colleagues"==a&&$("#cabinetUser"+b.user_id).removeClass("online");break;case "updateRemindersCount":currentClinicId==
parseInt(b.clinicId)&&currentClinicMemberHasAccess(ACCESS_REMINDERS)&&$.ajax({type:"POST",timeout:15E3,url:"/cabinet/reminders/get-reminders-count",data:{},error:function(a,b){},success:function(a){a=eval("("+a+")");showNewRemindersCount(a.count)}});break;case "setWaitingsCount":currentClinicId==parseInt(b.clinicId)&&currentClinicMemberHasAccess(ACCESS_WAITINGS)&&showNewWaitingsCount(b.waitingsCount);break;case "scheduleUpdate":a=document.location.hash;if("#schedule"==a||"#schedule/assistants"==a||
"#schedule/administrators"==a){var e=!1,d="undefined"!=typeof b.date?b.date:"";if(d){d=d.replace(/[^0-9,]+/g,"").split(",");for(var c in d){var g=d[c];"undefined"!=typeof calendar.options.days&&"undefined"!=typeof calendar.options.days[g]&&(e=!0)}}else e=!0;!e||$(".modal.in:not(#visitAdministratorModal)").length||$(".modal.in:not(#visitAssistantModal)").length||$(".modal.in:not(#visitModal)").length||$(".modal.in:not(#scheduleShiftModal)").length||$(".calVisitCell.ui-resizable-resizing, .calVisitCell.draggable").length||
$(".select2-container--open").length||("#schedule"==a&&1==b.schedulePage&&refreshCalendar(calendar.options.date,!1,!1),"#schedule/assistants"!=a||1!=b.schedulePage&&2!=b.schedulePage||refreshCalendar(calendar.options.date,!1,!1),"#schedule/administrators"==a&&3==b.schedulePage&&refreshCalendar(calendar.options.date,!1,!1))}break;case "documentsSignedOnADevice":if(!window.sentPatientDocuments)break;c=window.sentPatientDocuments.indexOf(parseInt(b.patient_id));if(-1===c)break;delete window.sentPatientDocuments[c];
c=T["signed the documents"];"1"==b.patient_gender?c=T["signed the documents(M)"]:"2"==b.patient_gender&&(c=T["signed the documents(F)"]);flashMessage("<b>"+b.patient_fullname+"</b> "+c,!1,6E6);document.location.hash==="#patients-documents/index/"+b.patient_id&&locationHashChanged();break;case "documentsUpdate":window.updateDocuments();break;case "ping":window.pong()}};ws.onopen=function(a){0<wsOnOpenCount&&checkNotifications();wsOnOpenCount++};ws.onerror=function(a){};ws.onconnecting=function(a){};
ws.onclose=function(a){};return ws};
;
(function () {
    window.fiscaliseUpdate = function (id) {
        ajax({
            method: 'GET',
            url: '/cabinet/clinic-registrators/update-status/' + id,
            success: function () {
                $('#errorMessageModal').one('hidden.bs.modal', function () {
                    locationHashChanged();
                });
            }
        });
    }
    $(document).ready(function () {
        var print = function (that) {
            ajax({
                method: 'GET',
                data: {type: $(that).data('type')},
                url: '/cabinet/clinic-registrators/print/' + $(that).data('invoice'),
                success: function (response) {
                    if ($('#fiscaliseModal').length === 0) {
                        $(document.body).append('<div id="fiscaliseModal" class="modal modal-scroll" tabindex="-1" data-width="800"></div>')
                    }
                    if (typeof (response.formHtml) != 'undefined') {
                        $('#fiscaliseModal').html(response.formHtml).modal('show');
                    }
                }
            });
        };
        $(document).on('click', '[data-fiscalise]', function (e) {
            e.stopPropagation();
            e.preventDefault();
            var that = this;
            if ($(this).data('fiscalise-state') === 'STARTED' ||
                $(this).data('fiscalise-state') === 'STARTED_REFUND') {
                confirmDialog({
                    buttonText: '',
                    text: '?',
                    buttonColor: 'red',
                    action: function () {
                        print(that)
                    }
                });
                return;

            } else {
                print(that);
            }
            return false;
        });
    });
})();
;
(function(factory){if(typeof define==="function"&&define.amd){define(["jquery"],factory)}else if(typeof exports==="object"){factory(require("jquery"))}else{factory(jQuery)}})(function($){var defaults={element:"body",position:null,type:"info",allow_dismiss:true,allow_duplicates:true,newest_on_top:false,showProgressbar:false,placement:{from:"top",align:"right"},offset:20,spacing:10,z_index:1031,delay:5e3,timer:1e3,url_target:"_blank",mouse_over:null,animate:{enter:"animated fadeInDown",exit:"animated fadeOutUp"},onShow:null,onShown:null,onClose:null,onClosed:null,onClick:null,icon_type:"class",template:'<div data-notify="container" class="col-xs-11 col-sm-4 alert alert-{0}" role="alert"><button type="button" aria-hidden="true" class="close" data-notify="dismiss">&times;</button><span data-notify="icon"></span> <span data-notify="title">{1}</span> <span data-notify="message">{2}</span><div class="progress" data-notify="progressbar"><div class="progress-bar progress-bar-{0}" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%;"></div></div><a href="{3}" target="{4}" data-notify="url"></a></div>'};String.format=function(){var args=arguments;var str=arguments[0];return str.replace(/(\{\{\d\}\}|\{\d\})/g,function(str){if(str.substring(0,2)==="{{")return str;var num=parseInt(str.match(/\d/)[0]);return args[num+1]})};function isDuplicateNotification(notification){var isDupe=false;$('[data-notify="container"]').each(function(i,el){var $el=$(el);var title=$el.find('[data-notify="title"]').html().trim();var message=$el.find('[data-notify="message"]').html().trim();var isSameTitle=title===$("<div>"+notification.settings.content.title+"</div>").html().trim();var isSameMsg=message===$("<div>"+notification.settings.content.message+"</div>").html().trim();var isSameType=$el.hasClass("alert-"+notification.settings.type);if(isSameTitle&&isSameMsg&&isSameType){isDupe=true}return!isDupe});return isDupe}function Notify(element,content,options){var contentObj={content:{message:typeof content==="object"?content.message:content,title:content.title?content.title:"",icon:content.icon?content.icon:"",url:content.url?content.url:"#",target:content.target?content.target:"-"}};options=$.extend(true,{},contentObj,options);this.settings=$.extend(true,{},defaults,options);this._defaults=defaults;if(this.settings.content.target==="-"){this.settings.content.target=this.settings.url_target}this.animations={start:"webkitAnimationStart oanimationstart MSAnimationStart animationstart",end:"webkitAnimationEnd oanimationend MSAnimationEnd animationend"};if(typeof this.settings.offset==="number"){this.settings.offset={x:this.settings.offset,y:this.settings.offset}}if(this.settings.allow_duplicates||!this.settings.allow_duplicates&&!isDuplicateNotification(this)){this.init()}}$.extend(Notify.prototype,{init:function(){var self=this;this.buildNotify();if(this.settings.content.icon){this.setIcon()}if(this.settings.content.url!="#"){this.styleURL()}this.styleDismiss();this.placement();this.bind();this.notify={$ele:this.$ele,update:function(command,update){var commands={};if(typeof command==="string"){commands[command]=update}else{commands=command}for(var cmd in commands){switch(cmd){case"type":this.$ele.removeClass("alert-"+self.settings.type);this.$ele.find('[data-notify="progressbar"] > .progress-bar').removeClass("progress-bar-"+self.settings.type);self.settings.type=commands[cmd];this.$ele.addClass("alert-"+commands[cmd]).find('[data-notify="progressbar"] > .progress-bar').addClass("progress-bar-"+commands[cmd]);break;case"icon":var $icon=this.$ele.find('[data-notify="icon"]');if(self.settings.icon_type.toLowerCase()==="class"){$icon.removeClass(self.settings.content.icon).addClass(commands[cmd])}else{if(!$icon.is("img")){$icon.find("img")}$icon.attr("src",commands[cmd])}self.settings.content.icon=commands[command];break;case"progress":var newDelay=self.settings.delay-self.settings.delay*(commands[cmd]/100);this.$ele.data("notify-delay",newDelay);this.$ele.find('[data-notify="progressbar"] > div').attr("aria-valuenow",commands[cmd]).css("width",commands[cmd]+"%");break;case"url":this.$ele.find('[data-notify="url"]').attr("href",commands[cmd]);break;case"target":this.$ele.find('[data-notify="url"]').attr("target",commands[cmd]);break;default:this.$ele.find('[data-notify="'+cmd+'"]').html(commands[cmd])}}var posX=this.$ele.outerHeight()+parseInt(self.settings.spacing)+parseInt(self.settings.offset.y);self.reposition(posX)},close:function(){self.close()}}},buildNotify:function(){var content=this.settings.content;this.$ele=$(String.format(this.settings.template,this.settings.type,content.title,content.message,content.url,content.target));this.$ele.attr("data-notify-position",this.settings.placement.from+"-"+this.settings.placement.align);if(!this.settings.allow_dismiss){this.$ele.find('[data-notify="dismiss"]').css("display","none")}if(this.settings.delay<=0&&!this.settings.showProgressbar||!this.settings.showProgressbar){this.$ele.find('[data-notify="progressbar"]').remove()}},setIcon:function(){if(this.settings.icon_type.toLowerCase()==="class"){this.$ele.find('[data-notify="icon"]').addClass(this.settings.content.icon)}else{if(this.$ele.find('[data-notify="icon"]').is("img")){this.$ele.find('[data-notify="icon"]').attr("src",this.settings.content.icon)}else{this.$ele.find('[data-notify="icon"]').append('<img src="'+this.settings.content.icon+'" alt="Notify Icon" />')}}},styleDismiss:function(){this.$ele.find('[data-notify="dismiss"]').css({position:"absolute",right:"10px",top:"10px",zIndex:this.settings.z_index+2})},styleURL:function(){this.$ele.find('[data-notify="url"]').css({backgroundImage:"url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)",height:"100%",left:0,position:"absolute",top:0,width:"100%",zIndex:this.settings.z_index+1})},placement:function(){var self=this,offsetAmt=this.settings.offset.y,css={display:"inline-block",margin:"0px auto",position:this.settings.position?this.settings.position:this.settings.element==="body"?"fixed":"absolute",transition:"all .5s ease-in-out",zIndex:this.settings.z_index},hasAnimation=false,settings=this.settings;$('[data-notify-position="'+this.settings.placement.from+"-"+this.settings.placement.align+'"]:not([data-closing="true"])').each(function(){offsetAmt=Math.max(offsetAmt,parseInt($(this).css(settings.placement.from))+parseInt($(this).outerHeight())+parseInt(settings.spacing))});if(this.settings.newest_on_top===true){offsetAmt=this.settings.offset.y}css[this.settings.placement.from]=offsetAmt+"px";switch(this.settings.placement.align){case"left":case"right":css[this.settings.placement.align]=this.settings.offset.x+"px";break;case"center":css.left=0;css.right=0;break}this.$ele.css(css).addClass(this.settings.animate.enter);$.each(Array("webkit-","moz-","o-","ms-",""),function(index,prefix){self.$ele[0].style[prefix+"AnimationIterationCount"]=1});$(this.settings.element).append(this.$ele);if(this.settings.newest_on_top===true){offsetAmt=parseInt(offsetAmt)+parseInt(this.settings.spacing)+this.$ele.outerHeight();this.reposition(offsetAmt)}if($.isFunction(self.settings.onShow)){self.settings.onShow.call(this.$ele)}this.$ele.one(this.animations.start,function(){hasAnimation=true}).one(this.animations.end,function(){self.$ele.removeClass(self.settings.animate.enter);if($.isFunction(self.settings.onShown)){self.settings.onShown.call(this)}});setTimeout(function(){if(!hasAnimation){if($.isFunction(self.settings.onShown)){self.settings.onShown.call(this)}}},600)},bind:function(){var self=this;this.$ele.find('[data-notify="dismiss"]').on("click",function(){self.close()});if($.isFunction(self.settings.onClick)){this.$ele.on("click",function(event){if(event.target!=self.$ele.find('[data-notify="dismiss"]')[0]){self.settings.onClick.call(this,event)}})}this.$ele.mouseover(function(){$(this).data("data-hover","true")}).mouseout(function(){$(this).data("data-hover","false")});this.$ele.data("data-hover","false");if(this.settings.delay>0){self.$ele.data("notify-delay",self.settings.delay);var timer=setInterval(function(){var delay=parseInt(self.$ele.data("notify-delay"))-self.settings.timer;if(self.$ele.data("data-hover")==="false"&&self.settings.mouse_over==="pause"||self.settings.mouse_over!="pause"){var percent=(self.settings.delay-delay)/self.settings.delay*100;self.$ele.data("notify-delay",delay);self.$ele.find('[data-notify="progressbar"] > div').attr("aria-valuenow",percent).css("width",percent+"%")}if(delay<=-self.settings.timer){clearInterval(timer);self.close()}},self.settings.timer)}},close:function(){var self=this,posX=parseInt(this.$ele.css(this.settings.placement.from)),hasAnimation=false;this.$ele.attr("data-closing","true").addClass(this.settings.animate.exit);self.reposition(posX);if($.isFunction(self.settings.onClose)){self.settings.onClose.call(this.$ele)}this.$ele.one(this.animations.start,function(){hasAnimation=true}).one(this.animations.end,function(){$(this).remove();if($.isFunction(self.settings.onClosed)){self.settings.onClosed.call(this)}});setTimeout(function(){if(!hasAnimation){self.$ele.remove();if($.isFunction(self.settings.onClosed)){self.settings.onClosed.call(this)}}},600)},reposition:function(posX){var self=this,notifies='[data-notify-position="'+this.settings.placement.from+"-"+this.settings.placement.align+'"]:not([data-closing="true"])',$elements=this.$ele.nextAll(notifies);if(this.settings.newest_on_top===true){$elements=this.$ele.prevAll(notifies)}$elements.each(function(){$(this).css(self.settings.placement.from,posX);posX=parseInt(posX)+parseInt(self.settings.spacing)+$(this).outerHeight()})}});$.notify=function(content,options){var plugin=new Notify(this,content,options);return plugin.notify};$.notifyDefaults=function(options){defaults=$.extend(true,{},defaults,options);return defaults};$.notifyClose=function(selector){if(typeof selector==="undefined"||selector==="all"){$("[data-notify]").find('[data-notify="dismiss"]').trigger("click")}else if(selector==="success"||selector==="info"||selector==="warning"||selector==="danger"){$(".alert-"+selector+"[data-notify]").find('[data-notify="dismiss"]').trigger("click")}else if(selector){$(selector+"[data-notify]").find('[data-notify="dismiss"]').trigger("click")}else{$('[data-notify-position="'+selector+'"]').find('[data-notify="dismiss"]').trigger("click")}};$.notifyCloseExcept=function(selector){if(selector==="success"||selector==="info"||selector==="warning"||selector==="danger"){$("[data-notify]").not(".alert-"+selector).find('[data-notify="dismiss"]').trigger("click")}else{$("[data-notify]").not(selector).find('[data-notify="dismiss"]').trigger("click")}}});;
/*! Copyright (c) 2011 Piotr Rochala (http://rocha.la)
 * Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
 * and GPL (http://www.opensource.org/licenses/gpl-license.php) licenses.
 *
 * Version: 1.3.8
 *
 */
(function(e){e.fn.extend({slimScroll:function(f){var a=e.extend({width:"auto",height:"250px",size:"7px",color:"#000",position:"right",distance:"1px",start:"top",opacity:.4,alwaysVisible:!1,disableFadeOut:!1,railVisible:!1,railColor:"#333",railOpacity:.2,railDraggable:!0,railClass:"slimScrollRail",barClass:"slimScrollBar",wrapperClass:"slimScrollDiv",allowPageScroll:!1,wheelStep:20,touchScrollStep:200,borderRadius:"7px",railBorderRadius:"7px"},f);this.each(function(){function v(d){if(r){d=d||window.event;
var c=0;d.wheelDelta&&(c=-d.wheelDelta/120);d.detail&&(c=d.detail/3);e(d.target||d.srcTarget||d.srcElement).closest("."+a.wrapperClass).is(b.parent())&&n(c,!0);d.preventDefault&&!k&&d.preventDefault();k||(d.returnValue=!1)}}function n(d,g,e){k=!1;var f=b.outerHeight()-c.outerHeight();g&&(g=parseInt(c.css("top"))+d*parseInt(a.wheelStep)/100*c.outerHeight(),g=Math.min(Math.max(g,0),f),g=0<d?Math.ceil(g):Math.floor(g),c.css({top:g+"px"}));l=parseInt(c.css("top"))/(b.outerHeight()-c.outerHeight());g=
l*(b[0].scrollHeight-b.outerHeight());e&&(g=d,d=g/b[0].scrollHeight*b.outerHeight(),d=Math.min(Math.max(d,0),f),c.css({top:d+"px"}));b.scrollTop(g);b.trigger("slimscrolling",~~g);w();p()}function x(){u=Math.max(b.outerHeight()/b[0].scrollHeight*b.outerHeight(),30);c.css({height:u+"px"});var a=u==b.outerHeight()?"none":"block";c.css({display:a})}function w(){x();clearTimeout(B);l==~~l?(k=a.allowPageScroll,C!=l&&b.trigger("slimscroll",0==~~l?"top":"bottom")):k=!1;C=l;u>=b.outerHeight()?k=!0:(c.stop(!0,
!0).fadeIn("fast"),a.railVisible&&m.stop(!0,!0).fadeIn("fast"))}function p(){a.alwaysVisible||(B=setTimeout(function(){a.disableFadeOut&&r||y||z||(c.fadeOut("slow"),m.fadeOut("slow"))},1E3))}var r,y,z,B,A,u,l,C,k=!1,b=e(this);if(b.parent().hasClass(a.wrapperClass)){var q=b.scrollTop(),c=b.siblings("."+a.barClass),m=b.siblings("."+a.railClass);x();if(e.isPlainObject(f)){if("height"in f&&"auto"==f.height){b.parent().css("height","auto");b.css("height","auto");var h=b.parent().parent().height();b.parent().css("height",
h);b.css("height",h)}else"height"in f&&(h=f.height,b.parent().css("height",h),b.css("height",h));if("scrollTo"in f)q=parseInt(a.scrollTo);else if("scrollBy"in f)q+=parseInt(a.scrollBy);else if("destroy"in f){c.remove();m.remove();b.unwrap();return}n(q,!1,!0)}}else if(!(e.isPlainObject(f)&&"destroy"in f)){a.height="auto"==a.height?b.parent().height():a.height;q=e("<div></div>").addClass(a.wrapperClass).css({position:"relative",overflow:"hidden",width:a.width,height:a.height});b.css({overflow:"hidden",
width:a.width,height:a.height});var m=e("<div></div>").addClass(a.railClass).css({width:a.size,height:"100%",position:"absolute",top:0,display:a.alwaysVisible&&a.railVisible?"block":"none","border-radius":a.railBorderRadius,background:a.railColor,opacity:a.railOpacity,zIndex:90}),c=e("<div></div>").addClass(a.barClass).css({background:a.color,width:a.size,position:"absolute",top:0,opacity:a.opacity,display:a.alwaysVisible?"block":"none","border-radius":a.borderRadius,BorderRadius:a.borderRadius,MozBorderRadius:a.borderRadius,
WebkitBorderRadius:a.borderRadius,zIndex:99}),h="right"==a.position?{right:a.distance}:{left:a.distance};m.css(h);c.css(h);b.wrap(q);b.parent().append(c);b.parent().append(m);a.railDraggable&&c.bind("mousedown",function(a){var b=e(document);z=!0;t=parseFloat(c.css("top"));pageY=a.pageY;b.bind("mousemove.slimscroll",function(a){currTop=t+a.pageY-pageY;c.css("top",currTop);n(0,c.position().top,!1)});b.bind("mouseup.slimscroll",function(a){z=!1;p();b.unbind(".slimscroll")});return!1}).bind("selectstart.slimscroll",
function(a){a.stopPropagation();a.preventDefault();return!1});m.hover(function(){w()},function(){p()});c.hover(function(){y=!0},function(){y=!1});b.hover(function(){r=!0;w();p()},function(){r=!1;p()});b.bind("touchstart",function(a,b){a.originalEvent.touches.length&&(A=a.originalEvent.touches[0].pageY)});b.bind("touchmove",function(b){k||b.originalEvent.preventDefault();b.originalEvent.touches.length&&(n((A-b.originalEvent.touches[0].pageY)/a.touchScrollStep,!0),A=b.originalEvent.touches[0].pageY)});
x();"bottom"===a.start?(c.css({top:b.outerHeight()-c.outerHeight()}),n(0,!0)):"top"!==a.start&&(n(e(a.start).position().top,null,!0),a.alwaysVisible||c.hide());window.addEventListener?(this.addEventListener("DOMMouseScroll",v,!1),this.addEventListener("mousewheel",v,!1)):document.attachEvent("onmousewheel",v)}});return this}});e.fn.extend({slimscroll:e.fn.slimScroll})})(jQuery);;
!function(h){"use strict";var a=function(e,t){this.$element=h(e),this.options=h.extend({},h.fn.hierarchySelect.defaults,t),this.$button=this.$element.children("button"),this.$selectedLabel=this.$button.children(".selected-label"),this.$menu=this.$element.children(".dropdown-menu"),this.$menuInner=this.$menu.children(".inner"),this.$searchbox=this.$menu.find("input"),this.$hiddenField=this.$element.children("input"),this.previouslySelected=null,this.init()};a.prototype={constructor:a,init:function(){this.setWidth(),this.setHeight(),this.initSelect(),this.clickListener(),this.buttonListener(),this.searchListener()},initSelect:function(){var e=this.$menuInner.find("li[data-default-selected]:first");if(e.length)this.setValue(e.data("value"));else{var t=this.$menuInner.find("li:first");this.setValue(t.data("value"))}},setWidth:function(){if("auto"===this.options.width){var e=this.$menu.width();this.$element.css("min-width",e+2+"px")}else this.options.width?this.$element.css("width",this.options.width):this.$element.css("min-width","42px")},setHeight:function(){this.options.height&&(this.$menu.css("overflow","hidden"),this.$menuInner.css({"max-height":this.options.height,"overflow-y":"auto"}))},getText:function(){return this.$selectedLabel.text()},getValue:function(){return this.$hiddenField.val()},setValue:function(e){var t=this.$menuInner.children('li[data-value="'+e+'"]:first');this.setSelected(t)},enable:function(){this.$button.removeAttr("disabled")},disable:function(){this.$button.attr("disabled","disabled")},setSelected:function(e){if(e.length&&this.previouslySelected!==e){var t=e.children("a").text(),n=e.data("value");this.previouslySelected=e,this.$selectedLabel.html(t),this.$hiddenField.val(n),this.$menuInner.find(".active").removeClass("active"),e.addClass("active"),this.$element.trigger("change")}},moveUp:function(){var e=this.$menuInner.find("li:not(.hidden,.disabled)"),t=this.$menuInner.find(".active"),n=e.index(t);void 0!==e[n-1]&&(this.$menuInner.find(".active").removeClass("active"),e[n-1].classList.add("active"),i(this.$menuInner[0],e[n-1]))},moveDown:function(){var e=this.$menuInner.find("li:not(.hidden,.disabled)"),t=this.$menuInner.find(".active"),n=e.index(t);void 0!==e[n+1]&&(this.$menuInner.find(".active").removeClass("active"),e[n+1]&&(e[n+1].classList.add("active"),i(this.$menuInner[0],e[n+1])))},selectItem:function(){var e=this,t=this.$menuInner.find(".active");t.hasClass("hidden")||t.hasClass("disabled")||(setTimeout(function(){e.$button.focus()},5),t&&this.setSelected(t),this.$button.dropdown("toggle"))},clickListener:function(){var l=this;this.$element.on("show.bs.dropdown",function(){var e=h(this),t=h(window).scrollTop(),n=h(window).height(),i=e.offset().top-t,s=n-i-e.outerHeight(),o=l.$menu.outerHeight(!0);s<o&&o<i&&e.toggleClass("dropup",!0);var a=l.$menuInner.find(".active");a&&setTimeout(function(){var e=a[0],t=a[0].parentNode;t.scrollTop<=e.offsetTop&&t.scrollTop+t.clientHeight>e.offsetTop+e.clientHeight||(e.parentNode.scrollTop=e.offsetTop)},0)}),this.$element.on("hide.bs.dropdown",function(){l.previouslySelected&&l.setSelected(l.previouslySelected)}),this.$element.on("shown.bs.dropdown",function(){l.previouslySelected=l.$menuInner.find(".active"),l.$searchbox.focus()}),this.$element.on("hidden.bs.dropdown",function(){l.$element.toggleClass("dropup",!1)}),this.$menuInner.on("click","li a",function(e){e.preventDefault();var t=h(this).parent();t.hasClass("disabled")?e.stopPropagation():l.setSelected(t)})},buttonListener:function(){var t=this;this.options.search||this.$button.on("keydown",function(e){switch(e.keyCode){case 9:t.$element.hasClass("open")&&e.preventDefault();break;case 13:t.$element.hasClass("open")&&(e.preventDefault(),t.selectItem());break;case 27:t.$element.hasClass("open")&&(e.preventDefault(),e.stopPropagation(),t.$button.focus(),t.previouslySelected&&t.setSelected(t.previouslySelected),t.$button.dropdown("toggle"));break;case 38:t.$element.hasClass("open")&&(e.preventDefault(),e.stopPropagation(),t.moveUp());break;case 40:t.$element.hasClass("open")&&(e.preventDefault(),e.stopPropagation(),t.moveDown())}})},searchListener:function(){var i=this;this.options.search?(this.$searchbox.on("keydown",function(e){switch(e.keyCode){case 9:e.preventDefault(),e.stopPropagation(),i.$menuInner.click(),i.$button.focus();break;case 13:i.selectItem();break;case 27:e.preventDefault(),e.stopPropagation(),i.$button.focus(),i.previouslySelected&&i.setSelected(i.previouslySelected),i.$button.dropdown("toggle");break;case 38:e.preventDefault(),i.moveUp();break;case 40:e.preventDefault(),i.moveDown()}}),this.$searchbox.on("input propertychange",function(e){e.preventDefault();var t=i.$searchbox.val().toLowerCase(),n=i.$menuInner.find("li");0===t.length?n.each(function(){var e=h(this);e.toggleClass("disabled",!1),e.toggleClass("hidden",!1)}):n.each(function(){var e=h(this);-1!==e.children("a").text().toLowerCase().indexOf(t)?(e.toggleClass("disabled",!1),e.toggleClass("hidden",!1),i.options.hierarchy&&function(e){for(var t=e,n=t.data("level");"object"==typeof t&&0<t.length&&1<n;)n--,(t=t.prevAll('li[data-level="'+n+'"]:first')).hasClass("hidden")&&(t.toggleClass("disabled",!0),t.removeClass("hidden"))}(e)):(e.toggleClass("disabled",!1),e.toggleClass("hidden",!0))})})):this.$searchbox.parent().toggleClass("hidden",!0)}};var e=h.fn.hierarchySelect;function i(e,t){e.offsetHeight+e.scrollTop<t.offsetTop+t.offsetHeight?e.scrollTop=t.offsetTop+t.offsetHeight-e.offsetHeight:e.scrollTop>t.offsetTop&&(e.scrollTop=t.offsetTop)}h.fn.hierarchySelect=function(i){var s,o=Array.prototype.slice.call(arguments,1),e=this.each(function(){var e=h(this),t=e.data("HierarchySelect"),n="object"==typeof i&&i;t||e.data("HierarchySelect",t=new a(this,n)),"string"==typeof i&&(s=t[i].apply(t,o))});return void 0===s?e:s},h.fn.hierarchySelect.defaults={width:"auto",height:"208px",hierarchy:!0,search:!0},h.fn.hierarchySelect.Constructor=a,h.fn.hierarchySelect.noConflict=function(){return h.fn.hierarchySelect=e,this}}(jQuery);;
(function(c,d){"function"===typeof define&&define.amd?define("jquery.numeric",["jquery"],d):"object"===typeof exports?module.exports=d(require("jquery")):d(c.jQuery)})(this,function(c){function d(a){return a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}var g=(1.1).toLocaleString().match(/\d(.*?)\d/)[1],n=new RegExp("\\"+d(g),"g"),h=function(){var a=null;return function(){if(null===a){var b=document.createElement("input");b.type="number";b.value="1";a=1===b.valueAsNumber}return a}}();c.fn.numeric=
function(a){this.each(function(b,e){b="INPUT"===e.tagName;"boolean"===typeof a&&(a={decimal:a});a=a||{};"undefined"===typeof a.negative&&(a.negative=b?e.getAttribute("min")?0>parseFloat(e.getAttribute("min")):!0:!0);var f=!1===a.decimal?"":"string"===typeof a.decimal&&a.decimal?a.decimal:g,d=!!a.negative;f&&"INPUT"===this.tagName&&"number"===this.type&&"valueAsNumber"in this&&h()&&(f=g);"undefined"===typeof a.decimal&&b&&(b=e.getAttribute("step"))&&"any"!==b&&-1===b.indexOf(".")&&(f="");return c(e).data("numeric.decimal",
f).data("numeric.negative",d).on("keypress.numericValue",c.fn.numeric._event).on("keyup.numericValue",c.fn.numeric._event).on("blur.numericValue",c.fn.numeric._event).on("input.numericValue",c.fn.numeric._event)});return this};c.fn.valueAsNumber=function(){if(!this.length)return null;var a=arguments;if(a.length)return this.each(function(){"INPUT"===this.tagName&&"number"===this.type&&"valueAsNumber"in this&&h()?this.valueAsNumber=a[0]:this.value=null===a[0]||void 0===a[0]?"":a[0].toString().replace(/\./,
c.data(this,"numeric.decimal")||g)});if("INPUT"===this[0].tagName&&"number"===this[0].type&&"valueAsNumber"in this[0]&&h())return this[0].valueAsNumber;var b=this.data("numeric.decimal");b=b?new RegExp(d(b),"g"):n;return""===this[0].value?null:parseFloat(this[0].value.replace(b,"."))};c.fn.numeric._event=function(a){a=c.data(this,"numeric.decimal");var b=c.data(this,"numeric.negative"),e=this.value,f="",g=!1;if("number"!==this.type)var h=this.selectionStart,m=this.selectionEnd;a&&d(a);a&&d(a);for(var k=
0,l;k<e.length;k++)l=e.charAt(k),"0"<=l&&"9">=l||b&&"-"===l&&!f.length?f+=l:a&&e.substr(k,a.length)===a&&!g?(g=!0,f+=a,k+=a.length-1):(k<=h&&h--,k<=m&&m--);e!==f&&(this.value=f,"number"!==this.type&&(this.selectionStart=h,this.selectionEnd=m))};c.fn.removeNumeric=function(){return this.removeData("numeric.decimal").removeData("numeric.negative").off(".numericValue")}});
;
/*! jsTree - v3.3.8 - 2019-04-29 - (MIT) */
!function(a){"use strict";"function"==typeof define&&define.amd?define(["jquery"],a):"undefined"!=typeof module&&module.exports?module.exports=a(require("jquery")):a(jQuery)}(function(a,b){"use strict";if(!a.jstree){var c=0,d=!1,e=!1,f=!1,g=[],h=a("script:last").attr("src"),i=window.document;a.jstree={version:"3.3.8",defaults:{plugins:[]},plugins:{},path:h&&-1!==h.indexOf("/")?h.replace(/\/[^\/]+$/,""):"",idregex:/[\\:&!^|()\[\]<>@*'+~#";.,=\- \/${}%?`]/g,root:"#"},a.jstree.create=function(b,d){var e=new a.jstree.core(++c),f=d;return d=a.extend(!0,{},a.jstree.defaults,d),f&&f.plugins&&(d.plugins=f.plugins),a.each(d.plugins,function(a,b){"core"!==a&&(e=e.plugin(b,d[b]))}),a(b).data("jstree",e),e.init(b,d),e},a.jstree.destroy=function(){a(".jstree:jstree").jstree("destroy"),a(i).off(".jstree")},a.jstree.core=function(a){this._id=a,this._cnt=0,this._wrk=null,this._data={core:{themes:{name:!1,dots:!1,icons:!1,ellipsis:!1},selected:[],last_error:{},working:!1,worker_queue:[],focused:null}}},a.jstree.reference=function(b){var c=null,d=null;if(!b||!b.id||b.tagName&&b.nodeType||(b=b.id),!d||!d.length)try{d=a(b)}catch(e){}if(!d||!d.length)try{d=a("#"+b.replace(a.jstree.idregex,"\\$&"))}catch(e){}return d&&d.length&&(d=d.closest(".jstree")).length&&(d=d.data("jstree"))?c=d:a(".jstree").each(function(){var d=a(this).data("jstree");return d&&d._model.data[b]?(c=d,!1):void 0}),c},a.fn.jstree=function(c){var d="string"==typeof c,e=Array.prototype.slice.call(arguments,1),f=null;return c!==!0||this.length?(this.each(function(){var g=a.jstree.reference(this),h=d&&g?g[c]:null;return f=d&&h?h.apply(g,e):null,g||d||c!==b&&!a.isPlainObject(c)||a.jstree.create(this,c),(g&&!d||c===!0)&&(f=g||!1),null!==f&&f!==b?!1:void 0}),null!==f&&f!==b?f:this):!1},a.expr.pseudos.jstree=a.expr.createPseudo(function(c){return function(c){return a(c).hasClass("jstree")&&a(c).data("jstree")!==b}}),a.jstree.defaults.core={data:!1,strings:!1,check_callback:!1,error:a.noop,animation:200,multiple:!0,themes:{name:!1,url:!1,dir:!1,dots:!0,icons:!0,ellipsis:!1,stripes:!1,variant:!1,responsive:!1},expand_selected_onload:!0,worker:!0,force_text:!1,dblclick_toggle:!0,loaded_state:!1,restore_focus:!0,keyboard:{"ctrl-space":function(b){b.type="click",a(b.currentTarget).trigger(b)},enter:function(b){b.type="click",a(b.currentTarget).trigger(b)},left:function(b){if(b.preventDefault(),this.is_open(b.currentTarget))this.close_node(b.currentTarget);else{var c=this.get_parent(b.currentTarget);c&&c.id!==a.jstree.root&&this.get_node(c,!0).children(".jstree-anchor").focus()}},up:function(a){a.preventDefault();var b=this.get_prev_dom(a.currentTarget);b&&b.length&&b.children(".jstree-anchor").focus()},right:function(b){if(b.preventDefault(),this.is_closed(b.currentTarget))this.open_node(b.currentTarget,function(a){this.get_node(a,!0).children(".jstree-anchor").focus()});else if(this.is_open(b.currentTarget)){var c=this.get_node(b.currentTarget,!0).children(".jstree-children")[0];c&&a(this._firstChild(c)).children(".jstree-anchor").focus()}},down:function(a){a.preventDefault();var b=this.get_next_dom(a.currentTarget);b&&b.length&&b.children(".jstree-anchor").focus()},"*":function(a){this.open_all()},home:function(b){b.preventDefault();var c=this._firstChild(this.get_container_ul()[0]);c&&a(c).children(".jstree-anchor").filter(":visible").focus()},end:function(a){a.preventDefault(),this.element.find(".jstree-anchor").filter(":visible").last().focus()},f2:function(a){a.preventDefault(),this.edit(a.currentTarget)}}},a.jstree.core.prototype={plugin:function(b,c){var d=a.jstree.plugins[b];return d?(this._data[b]={},d.prototype=this,new d(c,this)):this},init:function(b,c){this._model={data:{},changed:[],force_full_redraw:!1,redraw_timeout:!1,default_state:{loaded:!0,opened:!1,selected:!1,disabled:!1}},this._model.data[a.jstree.root]={id:a.jstree.root,parent:null,parents:[],children:[],children_d:[],state:{loaded:!1}},this.element=a(b).addClass("jstree jstree-"+this._id),this.settings=c,this._data.core.ready=!1,this._data.core.loaded=!1,this._data.core.rtl="rtl"===this.element.css("direction"),this.element[this._data.core.rtl?"addClass":"removeClass"]("jstree-rtl"),this.element.attr("role","tree"),this.settings.core.multiple&&this.element.attr("aria-multiselectable",!0),this.element.attr("tabindex")||this.element.attr("tabindex","0"),this.bind(),this.trigger("init"),this._data.core.original_container_html=this.element.find(" > ul > li").clone(!0),this._data.core.original_container_html.find("li").addBack().contents().filter(function(){return 3===this.nodeType&&(!this.nodeValue||/^\s+$/.test(this.nodeValue))}).remove(),this.element.html("<ul class='jstree-container-ul jstree-children' role='group'><li id='j"+this._id+"_loading' class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='tree-item'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>"),this.element.attr("aria-activedescendant","j"+this._id+"_loading"),this._data.core.li_height=this.get_container_ul().children("li").first().outerHeight()||24,this._data.core.node=this._create_prototype_node(),this.trigger("loading"),this.load_node(a.jstree.root)},destroy:function(a){if(this.trigger("destroy"),this._wrk)try{window.URL.revokeObjectURL(this._wrk),this._wrk=null}catch(b){}a||this.element.empty(),this.teardown()},_create_prototype_node:function(){var a=i.createElement("LI"),b,c;return a.setAttribute("role","treeitem"),b=i.createElement("I"),b.className="jstree-icon jstree-ocl",b.setAttribute("role","presentation"),a.appendChild(b),b=i.createElement("A"),b.className="jstree-anchor",b.setAttribute("href","#"),b.setAttribute("tabindex","-1"),c=i.createElement("I"),c.className="jstree-icon jstree-themeicon",c.setAttribute("role","presentation"),b.appendChild(c),a.appendChild(b),b=c=null,a},_kbevent_to_func:function(a){var b={8:"Backspace",9:"Tab",13:"Enter",19:"Pause",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"Print",45:"Insert",46:"Delete",96:"Numpad0",97:"Numpad1",98:"Numpad2",99:"Numpad3",100:"Numpad4",101:"Numpad5",102:"Numpad6",103:"Numpad7",104:"Numpad8",105:"Numpad9","-13":"NumpadEnter",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"Numlock",145:"Scrolllock",16:"Shift",17:"Ctrl",18:"Alt",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",61:"=",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",107:"+",109:"-",110:".",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",111:"/",106:"*",173:"-"},c=[];a.ctrlKey&&c.push("ctrl"),a.altKey&&c.push("alt"),a.shiftKey&&c.push("shift"),c.push(b[a.which]||a.which),c=c.sort().join("-").toLowerCase();var d=this.settings.core.keyboard,e,f;for(e in d)if(d.hasOwnProperty(e)&&(f=e,"-"!==f&&"+"!==f&&(f=f.replace("--","-MINUS").replace("+-","-MINUS").replace("++","-PLUS").replace("-+","-PLUS"),f=f.split(/-|\+/).sort().join("-").replace("MINUS","-").replace("PLUS","+").toLowerCase()),f===c))return d[e];return null},teardown:function(){this.unbind(),this.element.removeClass("jstree").removeData("jstree").find("[class^='jstree']").addBack().attr("class",function(){return this.className.replace(/jstree[^ ]*|$/gi,"")}),this.element=null},bind:function(){var b="",c=null,d=0;this.element.on("dblclick.jstree",function(a){if(a.target.tagName&&"input"===a.target.tagName.toLowerCase())return!0;if(i.selection&&i.selection.empty)i.selection.empty();else if(window.getSelection){var b=window.getSelection();try{b.removeAllRanges(),b.collapse()}catch(c){}}}).on("mousedown.jstree",a.proxy(function(a){a.target===this.element[0]&&(a.preventDefault(),d=+new Date)},this)).on("mousedown.jstree",".jstree-ocl",function(a){a.preventDefault()}).on("click.jstree",".jstree-ocl",a.proxy(function(a){this.toggle_node(a.target)},this)).on("dblclick.jstree",".jstree-anchor",a.proxy(function(a){return a.target.tagName&&"input"===a.target.tagName.toLowerCase()?!0:void(this.settings.core.dblclick_toggle&&this.toggle_node(a.target))},this)).on("click.jstree",".jstree-anchor",a.proxy(function(b){b.preventDefault(),b.currentTarget!==i.activeElement&&a(b.currentTarget).focus(),this.activate_node(b.currentTarget,b)},this)).on("keydown.jstree",".jstree-anchor",a.proxy(function(a){if(a.target.tagName&&"input"===a.target.tagName.toLowerCase())return!0;this._data.core.rtl&&(37===a.which?a.which=39:39===a.which&&(a.which=37));var b=this._kbevent_to_func(a);if(b){var c=b.call(this,a);if(c===!1||c===!0)return c}},this)).on("load_node.jstree",a.proxy(function(b,c){c.status&&(c.node.id!==a.jstree.root||this._data.core.loaded||(this._data.core.loaded=!0,this._firstChild(this.get_container_ul()[0])&&this.element.attr("aria-activedescendant",this._firstChild(this.get_container_ul()[0]).id),this.trigger("loaded")),this._data.core.ready||setTimeout(a.proxy(function(){if(this.element&&!this.get_container_ul().find(".jstree-loading").length){if(this._data.core.ready=!0,this._data.core.selected.length){if(this.settings.core.expand_selected_onload){var b=[],c,d;for(c=0,d=this._data.core.selected.length;d>c;c++)b=b.concat(this._model.data[this._data.core.selected[c]].parents);for(b=a.vakata.array_unique(b),c=0,d=b.length;d>c;c++)this.open_node(b[c],!1,0)}this.trigger("changed",{action:"ready",selected:this._data.core.selected})}this.trigger("ready")}},this),0))},this)).on("keypress.jstree",a.proxy(function(d){if(d.target.tagName&&"input"===d.target.tagName.toLowerCase())return!0;c&&clearTimeout(c),c=setTimeout(function(){b=""},500);var e=String.fromCharCode(d.which).toLowerCase(),f=this.element.find(".jstree-anchor").filter(":visible"),g=f.index(i.activeElement)||0,h=!1;if(b+=e,b.length>1){if(f.slice(g).each(a.proxy(function(c,d){return 0===a(d).text().toLowerCase().indexOf(b)?(a(d).focus(),h=!0,!1):void 0},this)),h)return;if(f.slice(0,g).each(a.proxy(function(c,d){return 0===a(d).text().toLowerCase().indexOf(b)?(a(d).focus(),h=!0,!1):void 0},this)),h)return}if(new RegExp("^"+e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")+"+$").test(b)){if(f.slice(g+1).each(a.proxy(function(b,c){return a(c).text().toLowerCase().charAt(0)===e?(a(c).focus(),h=!0,!1):void 0},this)),h)return;if(f.slice(0,g+1).each(a.proxy(function(b,c){return a(c).text().toLowerCase().charAt(0)===e?(a(c).focus(),h=!0,!1):void 0},this)),h)return}},this)).on("init.jstree",a.proxy(function(){var a=this.settings.core.themes;this._data.core.themes.dots=a.dots,this._data.core.themes.stripes=a.stripes,this._data.core.themes.icons=a.icons,this._data.core.themes.ellipsis=a.ellipsis,this.set_theme(a.name||"default",a.url),this.set_theme_variant(a.variant)},this)).on("loading.jstree",a.proxy(function(){this[this._data.core.themes.dots?"show_dots":"hide_dots"](),this[this._data.core.themes.icons?"show_icons":"hide_icons"](),this[this._data.core.themes.stripes?"show_stripes":"hide_stripes"](),this[this._data.core.themes.ellipsis?"show_ellipsis":"hide_ellipsis"]()},this)).on("blur.jstree",".jstree-anchor",a.proxy(function(b){this._data.core.focused=null,a(b.currentTarget).filter(".jstree-hovered").trigger("mouseleave"),this.element.attr("tabindex","0")},this)).on("focus.jstree",".jstree-anchor",a.proxy(function(b){var c=this.get_node(b.currentTarget);c&&c.id&&(this._data.core.focused=c.id),this.element.find(".jstree-hovered").not(b.currentTarget).trigger("mouseleave"),a(b.currentTarget).trigger("mouseenter"),this.element.attr("tabindex","-1")},this)).on("focus.jstree",a.proxy(function(){if(+new Date-d>500&&!this._data.core.focused&&this.settings.core.restore_focus){d=0;var a=this.get_node(this.element.attr("aria-activedescendant"),!0);a&&a.find("> .jstree-anchor").focus()}},this)).on("mouseenter.jstree",".jstree-anchor",a.proxy(function(a){this.hover_node(a.currentTarget)},this)).on("mouseleave.jstree",".jstree-anchor",a.proxy(function(a){this.dehover_node(a.currentTarget)},this))},unbind:function(){this.element.off(".jstree"),a(i).off(".jstree-"+this._id)},trigger:function(a,b){b||(b={}),b.instance=this,this.element.triggerHandler(a.replace(".jstree","")+".jstree",b)},get_container:function(){return this.element},get_container_ul:function(){return this.element.children(".jstree-children").first()},get_string:function(b){var c=this.settings.core.strings;return a.isFunction(c)?c.call(this,b):c&&c[b]?c[b]:b},_firstChild:function(a){a=a?a.firstChild:null;while(null!==a&&1!==a.nodeType)a=a.nextSibling;return a},_nextSibling:function(a){a=a?a.nextSibling:null;while(null!==a&&1!==a.nodeType)a=a.nextSibling;return a},_previousSibling:function(a){a=a?a.previousSibling:null;while(null!==a&&1!==a.nodeType)a=a.previousSibling;return a},get_node:function(b,c){b&&b.id&&(b=b.id),b instanceof a&&b.length&&b[0].id&&(b=b[0].id);var d;try{if(this._model.data[b])b=this._model.data[b];else if("string"==typeof b&&this._model.data[b.replace(/^#/,"")])b=this._model.data[b.replace(/^#/,"")];else if("string"==typeof b&&(d=a("#"+b.replace(a.jstree.idregex,"\\$&"),this.element)).length&&this._model.data[d.closest(".jstree-node").attr("id")])b=this._model.data[d.closest(".jstree-node").attr("id")];else if((d=this.element.find(b)).length&&this._model.data[d.closest(".jstree-node").attr("id")])b=this._model.data[d.closest(".jstree-node").attr("id")];else{if(!(d=this.element.find(b)).length||!d.hasClass("jstree"))return!1;b=this._model.data[a.jstree.root]}return c&&(b=b.id===a.jstree.root?this.element:a("#"+b.id.replace(a.jstree.idregex,"\\$&"),this.element)),b}catch(e){return!1}},get_path:function(b,c,d){if(b=b.parents?b:this.get_node(b),!b||b.id===a.jstree.root||!b.parents)return!1;var e,f,g=[];for(g.push(d?b.id:b.text),e=0,f=b.parents.length;f>e;e++)g.push(d?b.parents[e]:this.get_text(b.parents[e]));return g=g.reverse().slice(1),c?g.join(c):g},get_next_dom:function(b,c){var d;if(b=this.get_node(b,!0),b[0]===this.element[0]){d=this._firstChild(this.get_container_ul()[0]);while(d&&0===d.offsetHeight)d=this._nextSibling(d);return d?a(d):!1}if(!b||!b.length)return!1;if(c){d=b[0];do d=this._nextSibling(d);while(d&&0===d.offsetHeight);return d?a(d):!1}if(b.hasClass("jstree-open")){d=this._firstChild(b.children(".jstree-children")[0]);while(d&&0===d.offsetHeight)d=this._nextSibling(d);if(null!==d)return a(d)}d=b[0];do d=this._nextSibling(d);while(d&&0===d.offsetHeight);return null!==d?a(d):b.parentsUntil(".jstree",".jstree-node").nextAll(".jstree-node:visible").first()},get_prev_dom:function(b,c){var d;if(b=this.get_node(b,!0),b[0]===this.element[0]){d=this.get_container_ul()[0].lastChild;while(d&&0===d.offsetHeight)d=this._previousSibling(d);return d?a(d):!1}if(!b||!b.length)return!1;if(c){d=b[0];do d=this._previousSibling(d);while(d&&0===d.offsetHeight);return d?a(d):!1}d=b[0];do d=this._previousSibling(d);while(d&&0===d.offsetHeight);if(null!==d){b=a(d);while(b.hasClass("jstree-open"))b=b.children(".jstree-children").first().children(".jstree-node:visible:last");return b}return d=b[0].parentNode.parentNode,d&&d.className&&-1!==d.className.indexOf("jstree-node")?a(d):!1},get_parent:function(b){return b=this.get_node(b),b&&b.id!==a.jstree.root?b.parent:!1},get_children_dom:function(a){return a=this.get_node(a,!0),a[0]===this.element[0]?this.get_container_ul().children(".jstree-node"):a&&a.length?a.children(".jstree-children").children(".jstree-node"):!1},is_parent:function(a){return a=this.get_node(a),a&&(a.state.loaded===!1||a.children.length>0)},is_loaded:function(a){return a=this.get_node(a),a&&a.state.loaded},is_loading:function(a){return a=this.get_node(a),a&&a.state&&a.state.loading},is_open:function(a){return a=this.get_node(a),a&&a.state.opened},is_closed:function(a){return a=this.get_node(a),a&&this.is_parent(a)&&!a.state.opened},is_leaf:function(a){return!this.is_parent(a)},load_node:function(b,c){var d,e,f,g,h;if(a.isArray(b))return this._load_nodes(b.slice(),c),!0;if(b=this.get_node(b),!b)return c&&c.call(this,b,!1),!1;if(b.state.loaded){for(b.state.loaded=!1,f=0,g=b.parents.length;g>f;f++)this._model.data[b.parents[f]].children_d=a.vakata.array_filter(this._model.data[b.parents[f]].children_d,function(c){return-1===a.inArray(c,b.children_d)});for(d=0,e=b.children_d.length;e>d;d++)this._model.data[b.children_d[d]].state.selected&&(h=!0),delete this._model.data[b.children_d[d]];h&&(this._data.core.selected=a.vakata.array_filter(this._data.core.selected,function(c){return-1===a.inArray(c,b.children_d)})),b.children=[],b.children_d=[],h&&this.trigger("changed",{action:"load_node",node:b,selected:this._data.core.selected})}return b.state.failed=!1,b.state.loading=!0,this.get_node(b,!0).addClass("jstree-loading").attr("aria-busy",!0),this._load_node(b,a.proxy(function(a){b=this._model.data[b.id],b.state.loading=!1,b.state.loaded=a,b.state.failed=!b.state.loaded;var d=this.get_node(b,!0),e=0,f=0,g=this._model.data,h=!1;for(e=0,f=b.children.length;f>e;e++)if(g[b.children[e]]&&!g[b.children[e]].state.hidden){h=!0;break}b.state.loaded&&d&&d.length&&(d.removeClass("jstree-closed jstree-open jstree-leaf"),h?"#"!==b.id&&d.addClass(b.state.opened?"jstree-open":"jstree-closed"):d.addClass("jstree-leaf")),d.removeClass("jstree-loading").attr("aria-busy",!1),this.trigger("load_node",{node:b,status:a}),c&&c.call(this,b,a)},this)),!0},_load_nodes:function(a,b,c,d){var e=!0,f=function(){this._load_nodes(a,b,!0)},g=this._model.data,h,i,j=[];for(h=0,i=a.length;i>h;h++)g[a[h]]&&(!g[a[h]].state.loaded&&!g[a[h]].state.failed||!c&&d)&&(this.is_loading(a[h])||this.load_node(a[h],f),e=!1);if(e){for(h=0,i=a.length;i>h;h++)g[a[h]]&&g[a[h]].state.loaded&&j.push(a[h]);b&&!b.done&&(b.call(this,j),b.done=!0)}},load_all:function(b,c){if(b||(b=a.jstree.root),b=this.get_node(b),!b)return!1;var d=[],e=this._model.data,f=e[b.id].children_d,g,h;for(b.state&&!b.state.loaded&&d.push(b.id),g=0,h=f.length;h>g;g++)e[f[g]]&&e[f[g]].state&&!e[f[g]].state.loaded&&d.push(f[g]);d.length?this._load_nodes(d,function(){this.load_all(b,c)}):(c&&c.call(this,b),this.trigger("load_all",{node:b}))},_load_node:function(b,c){var d=this.settings.core.data,e,f=function g(){return 3!==this.nodeType&&8!==this.nodeType};return d?a.isFunction(d)?d.call(this,b,a.proxy(function(d){d===!1?c.call(this,!1):this["string"==typeof d?"_append_html_data":"_append_json_data"](b,"string"==typeof d?a(a.parseHTML(d)).filter(f):d,function(a){c.call(this,a)})},this)):"object"==typeof d?d.url?(d=a.extend(!0,{},d),a.isFunction(d.url)&&(d.url=d.url.call(this,b)),a.isFunction(d.data)&&(d.data=d.data.call(this,b)),a.ajax(d).done(a.proxy(function(d,e,g){var h=g.getResponseHeader("Content-Type");return h&&-1!==h.indexOf("json")||"object"==typeof d?this._append_json_data(b,d,function(a){c.call(this,a)}):h&&-1!==h.indexOf("html")||"string"==typeof d?this._append_html_data(b,a(a.parseHTML(d)).filter(f),function(a){c.call(this,a)}):(this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:b.id,xhr:g})},this.settings.core.error.call(this,this._data.core.last_error),c.call(this,!1))},this)).fail(a.proxy(function(a){this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:b.id,xhr:a})},c.call(this,!1),this.settings.core.error.call(this,this._data.core.last_error)},this))):(e=a.isArray(d)?a.extend(!0,[],d):a.isPlainObject(d)?a.extend(!0,{},d):d,b.id===a.jstree.root?this._append_json_data(b,e,function(a){c.call(this,a)}):(this._data.core.last_error={error:"nodata",plugin:"core",id:"core_05",reason:"Could not load node",data:JSON.stringify({id:b.id})},this.settings.core.error.call(this,this._data.core.last_error),c.call(this,!1))):"string"==typeof d?b.id===a.jstree.root?this._append_html_data(b,a(a.parseHTML(d)).filter(f),function(a){c.call(this,a)}):(this._data.core.last_error={error:"nodata",plugin:"core",id:"core_06",reason:"Could not load node",data:JSON.stringify({id:b.id})},this.settings.core.error.call(this,this._data.core.last_error),c.call(this,!1)):c.call(this,!1):b.id===a.jstree.root?this._append_html_data(b,this._data.core.original_container_html.clone(!0),function(a){c.call(this,a)}):c.call(this,!1)},_node_changed:function(b){b=this.get_node(b),b&&-1===a.inArray(b.id,this._model.changed)&&this._model.changed.push(b.id)},_append_html_data:function(b,c,d){b=this.get_node(b),b.children=[],b.children_d=[];var e=c.is("ul")?c.children():c,f=b.id,g=[],h=[],i=this._model.data,j=i[f],k=this._data.core.selected.length,l,m,n;for(e.each(a.proxy(function(b,c){l=this._parse_model_from_html(a(c),f,j.parents.concat()),l&&(g.push(l),h.push(l),i[l].children_d.length&&(h=h.concat(i[l].children_d)))},this)),j.children=g,j.children_d=h,m=0,n=j.parents.length;n>m;m++)i[j.parents[m]].children_d=i[j.parents[m]].children_d.concat(h);this.trigger("model",{nodes:h,parent:f}),f!==a.jstree.root?(this._node_changed(f),this.redraw()):(this.get_container_ul().children(".jstree-initial-node").remove(),this.redraw(!0)),this._data.core.selected.length!==k&&this.trigger("changed",{action:"model",selected:this._data.core.selected}),d.call(this,!0)},_append_json_data:function(b,c,d,e){if(null!==this.element){b=this.get_node(b),b.children=[],b.children_d=[],c.d&&(c=c.d,"string"==typeof c&&(c=JSON.parse(c))),a.isArray(c)||(c=[c]);var f=null,g={df:this._model.default_state,dat:c,par:b.id,m:this._model.data,t_id:this._id,t_cnt:this._cnt,sel:this._data.core.selected},h=this,i=function(a,b){a.data&&(a=a.data);var c=a.dat,d=a.par,e=[],f=[],g=[],i=a.df,j=a.t_id,k=a.t_cnt,l=a.m,m=l[d],n=a.sel,o,p,q,r,s=function(a,c,d){d=d?d.concat():[],c&&d.unshift(c);var e=a.id.toString(),f,h,j,k,m={id:e,text:a.text||"",icon:a.icon!==b?a.icon:!0,parent:c,parents:d,children:a.children||[],children_d:a.children_d||[],data:a.data,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(f in i)i.hasOwnProperty(f)&&(m.state[f]=i[f]);if(a&&a.data&&a.data.jstree&&a.data.jstree.icon&&(m.icon=a.data.jstree.icon),(m.icon===b||null===m.icon||""===m.icon)&&(m.icon=!0),a&&a.data&&(m.data=a.data,a.data.jstree))for(f in a.data.jstree)a.data.jstree.hasOwnProperty(f)&&(m.state[f]=a.data.jstree[f]);if(a&&"object"==typeof a.state)for(f in a.state)a.state.hasOwnProperty(f)&&(m.state[f]=a.state[f]);if(a&&"object"==typeof a.li_attr)for(f in a.li_attr)a.li_attr.hasOwnProperty(f)&&(m.li_attr[f]=a.li_attr[f]);if(m.li_attr.id||(m.li_attr.id=e),a&&"object"==typeof a.a_attr)for(f in a.a_attr)a.a_attr.hasOwnProperty(f)&&(m.a_attr[f]=a.a_attr[f]);for(a&&a.children&&a.children===!0&&(m.state.loaded=!1,m.children=[],m.children_d=[]),l[m.id]=m,f=0,h=m.children.length;h>f;f++)j=s(l[m.children[f]],m.id,d),k=l[j],m.children_d.push(j),k.children_d.length&&(m.children_d=m.children_d.concat(k.children_d));return delete a.data,delete a.children,l[m.id].original=a,m.state.selected&&g.push(m.id),m.id},t=function(a,c,d){d=d?d.concat():[],c&&d.unshift(c);var e=!1,f,h,m,n,o;do e="j"+j+"_"+ ++k;while(l[e]);o={id:!1,text:"string"==typeof a?a:"",icon:"object"==typeof a&&a.icon!==b?a.icon:!0,parent:c,parents:d,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(f in i)i.hasOwnProperty(f)&&(o.state[f]=i[f]);if(a&&a.id&&(o.id=a.id.toString()),a&&a.text&&(o.text=a.text),a&&a.data&&a.data.jstree&&a.data.jstree.icon&&(o.icon=a.data.jstree.icon),(o.icon===b||null===o.icon||""===o.icon)&&(o.icon=!0),a&&a.data&&(o.data=a.data,a.data.jstree))for(f in a.data.jstree)a.data.jstree.hasOwnProperty(f)&&(o.state[f]=a.data.jstree[f]);if(a&&"object"==typeof a.state)for(f in a.state)a.state.hasOwnProperty(f)&&(o.state[f]=a.state[f]);if(a&&"object"==typeof a.li_attr)for(f in a.li_attr)a.li_attr.hasOwnProperty(f)&&(o.li_attr[f]=a.li_attr[f]);if(o.li_attr.id&&!o.id&&(o.id=o.li_attr.id.toString()),o.id||(o.id=e),o.li_attr.id||(o.li_attr.id=o.id),a&&"object"==typeof a.a_attr)for(f in a.a_attr)a.a_attr.hasOwnProperty(f)&&(o.a_attr[f]=a.a_attr[f]);if(a&&a.children&&a.children.length){for(f=0,h=a.children.length;h>f;f++)m=t(a.children[f],o.id,d),n=l[m],o.children.push(m),n.children_d.length&&(o.children_d=o.children_d.concat(n.children_d));o.children_d=o.children_d.concat(o.children)}return a&&a.children&&a.children===!0&&(o.state.loaded=!1,o.children=[],o.children_d=[]),delete a.data,delete a.children,o.original=a,l[o.id]=o,o.state.selected&&g.push(o.id),o.id};if(c.length&&c[0].id!==b&&c[0].parent!==b){for(p=0,q=c.length;q>p;p++)c[p].children||(c[p].children=[]),c[p].state||(c[p].state={}),l[c[p].id.toString()]=c[p];for(p=0,q=c.length;q>p;p++)l[c[p].parent.toString()]?(l[c[p].parent.toString()].children.push(c[p].id.toString()),m.children_d.push(c[p].id.toString())):"undefined"!=typeof h&&(h._data.core.last_error={error:"parse",plugin:"core",id:"core_07",reason:"Node with invalid parent",data:JSON.stringify({id:c[p].id.toString(),parent:c[p].parent.toString()})},h.settings.core.error.call(h,h._data.core.last_error));for(p=0,q=m.children.length;q>p;p++)o=s(l[m.children[p]],d,m.parents.concat()),f.push(o),l[o].children_d.length&&(f=f.concat(l[o].children_d));for(p=0,q=m.parents.length;q>p;p++)l[m.parents[p]].children_d=l[m.parents[p]].children_d.concat(f);r={cnt:k,mod:l,sel:n,par:d,dpc:f,add:g}}else{for(p=0,q=c.length;q>p;p++)o=t(c[p],d,m.parents.concat()),o&&(e.push(o),f.push(o),l[o].children_d.length&&(f=f.concat(l[o].children_d)));for(m.children=e,m.children_d=f,p=0,q=m.parents.length;q>p;p++)l[m.parents[p]].children_d=l[m.parents[p]].children_d.concat(f);r={cnt:k,mod:l,sel:n,par:d,dpc:f,add:g}}return"undefined"!=typeof window&&"undefined"!=typeof window.document?r:void postMessage(r)},j=function(b,c){if(null!==this.element){this._cnt=b.cnt;var e,f=this._model.data;for(e in f)f.hasOwnProperty(e)&&f[e].state&&f[e].state.loading&&b.mod[e]&&(b.mod[e].state.loading=!0);if(this._model.data=b.mod,c){var g,h=b.add,i=b.sel,j=this._data.core.selected.slice();if(f=this._model.data,i.length!==j.length||a.vakata.array_unique(i.concat(j)).length!==i.length){for(e=0,g=i.length;g>e;e++)-1===a.inArray(i[e],h)&&-1===a.inArray(i[e],j)&&(f[i[e]].state.selected=!1);for(e=0,g=j.length;g>e;e++)-1===a.inArray(j[e],i)&&(f[j[e]].state.selected=!0)}}b.add.length&&(this._data.core.selected=this._data.core.selected.concat(b.add)),this.trigger("model",{nodes:b.dpc,parent:b.par}),b.par!==a.jstree.root?(this._node_changed(b.par),this.redraw()):this.redraw(!0),b.add.length&&this.trigger("changed",{action:"model",selected:this._data.core.selected}),d.call(this,!0)}};if(this.settings.core.worker&&window.Blob&&window.URL&&window.Worker)try{null===this._wrk&&(this._wrk=window.URL.createObjectURL(new window.Blob(["self.onmessage = "+i.toString()],{type:"text/javascript"}))),!this._data.core.working||e?(this._data.core.working=!0,f=new window.Worker(this._wrk),f.onmessage=a.proxy(function(a){j.call(this,a.data,!0);try{f.terminate(),f=null}catch(b){}this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1},this),g.par?f.postMessage(g):this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1):this._data.core.worker_queue.push([b,c,d,!0])}catch(k){j.call(this,i(g),!1),this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1}else j.call(this,i(g),!1)}},_parse_model_from_html:function(c,d,e){e=e?[].concat(e):[],d&&e.unshift(d);var f,g,h=this._model.data,i={id:!1,text:!1,icon:!0,parent:d,parents:e,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1},j,k,l;for(j in this._model.default_state)this._model.default_state.hasOwnProperty(j)&&(i.state[j]=this._model.default_state[j]);if(k=a.vakata.attributes(c,!0),a.each(k,function(b,c){return c=a.trim(c),c.length?(i.li_attr[b]=c,void("id"===b&&(i.id=c.toString()))):!0}),k=c.children("a").first(),k.length&&(k=a.vakata.attributes(k,!0),a.each(k,function(b,c){c=a.trim(c),c.length&&(i.a_attr[b]=c)})),k=c.children("a").first().length?c.children("a").first().clone():c.clone(),k.children("ins, i, ul").remove(),k=k.html(),k=a("<div />").html(k),i.text=this.settings.core.force_text?k.text():k.html(),k=c.data(),i.data=k?a.extend(!0,{},k):null,i.state.opened=c.hasClass("jstree-open"),i.state.selected=c.children("a").hasClass("jstree-clicked"),i.state.disabled=c.children("a").hasClass("jstree-disabled"),i.data&&i.data.jstree)for(j in i.data.jstree)i.data.jstree.hasOwnProperty(j)&&(i.state[j]=i.data.jstree[j]);k=c.children("a").children(".jstree-themeicon"),k.length&&(i.icon=k.hasClass("jstree-themeicon-hidden")?!1:k.attr("rel")),i.state.icon!==b&&(i.icon=i.state.icon),(i.icon===b||null===i.icon||""===i.icon)&&(i.icon=!0),k=c.children("ul").children("li");do l="j"+this._id+"_"+ ++this._cnt;while(h[l]);return i.id=i.li_attr.id?i.li_attr.id.toString():l,k.length?(k.each(a.proxy(function(b,c){f=this._parse_model_from_html(a(c),i.id,e),g=this._model.data[f],i.children.push(f),g.children_d.length&&(i.children_d=i.children_d.concat(g.children_d))},this)),i.children_d=i.children_d.concat(i.children)):c.hasClass("jstree-closed")&&(i.state.loaded=!1),i.li_attr["class"]&&(i.li_attr["class"]=i.li_attr["class"].replace("jstree-closed","").replace("jstree-open","")),i.a_attr["class"]&&(i.a_attr["class"]=i.a_attr["class"].replace("jstree-clicked","").replace("jstree-disabled","")),h[i.id]=i,i.state.selected&&this._data.core.selected.push(i.id),i.id},_parse_model_from_flat_json:function(a,c,d){d=d?d.concat():[],c&&d.unshift(c);var e=a.id.toString(),f=this._model.data,g=this._model.default_state,h,i,j,k,l={id:e,text:a.text||"",icon:a.icon!==b?a.icon:!0,parent:c,parents:d,children:a.children||[],children_d:a.children_d||[],data:a.data,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(h in g)g.hasOwnProperty(h)&&(l.state[h]=g[h]);if(a&&a.data&&a.data.jstree&&a.data.jstree.icon&&(l.icon=a.data.jstree.icon),(l.icon===b||null===l.icon||""===l.icon)&&(l.icon=!0),a&&a.data&&(l.data=a.data,a.data.jstree))for(h in a.data.jstree)a.data.jstree.hasOwnProperty(h)&&(l.state[h]=a.data.jstree[h]);if(a&&"object"==typeof a.state)for(h in a.state)a.state.hasOwnProperty(h)&&(l.state[h]=a.state[h]);if(a&&"object"==typeof a.li_attr)for(h in a.li_attr)a.li_attr.hasOwnProperty(h)&&(l.li_attr[h]=a.li_attr[h]);if(l.li_attr.id||(l.li_attr.id=e),a&&"object"==typeof a.a_attr)for(h in a.a_attr)a.a_attr.hasOwnProperty(h)&&(l.a_attr[h]=a.a_attr[h]);for(a&&a.children&&a.children===!0&&(l.state.loaded=!1,l.children=[],l.children_d=[]),f[l.id]=l,h=0,i=l.children.length;i>h;h++)j=this._parse_model_from_flat_json(f[l.children[h]],l.id,d),k=f[j],l.children_d.push(j),k.children_d.length&&(l.children_d=l.children_d.concat(k.children_d));return delete a.data,delete a.children,f[l.id].original=a,l.state.selected&&this._data.core.selected.push(l.id),l.id},_parse_model_from_json:function(a,c,d){d=d?d.concat():[],c&&d.unshift(c);var e=!1,f,g,h,i,j=this._model.data,k=this._model.default_state,l;do e="j"+this._id+"_"+ ++this._cnt;while(j[e]);l={id:!1,text:"string"==typeof a?a:"",icon:"object"==typeof a&&a.icon!==b?a.icon:!0,parent:c,parents:d,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(f in k)k.hasOwnProperty(f)&&(l.state[f]=k[f]);if(a&&a.id&&(l.id=a.id.toString()),a&&a.text&&(l.text=a.text),a&&a.data&&a.data.jstree&&a.data.jstree.icon&&(l.icon=a.data.jstree.icon),(l.icon===b||null===l.icon||""===l.icon)&&(l.icon=!0),a&&a.data&&(l.data=a.data,a.data.jstree))for(f in a.data.jstree)a.data.jstree.hasOwnProperty(f)&&(l.state[f]=a.data.jstree[f]);if(a&&"object"==typeof a.state)for(f in a.state)a.state.hasOwnProperty(f)&&(l.state[f]=a.state[f]);if(a&&"object"==typeof a.li_attr)for(f in a.li_attr)a.li_attr.hasOwnProperty(f)&&(l.li_attr[f]=a.li_attr[f]);
if(l.li_attr.id&&!l.id&&(l.id=l.li_attr.id.toString()),l.id||(l.id=e),l.li_attr.id||(l.li_attr.id=l.id),a&&"object"==typeof a.a_attr)for(f in a.a_attr)a.a_attr.hasOwnProperty(f)&&(l.a_attr[f]=a.a_attr[f]);if(a&&a.children&&a.children.length){for(f=0,g=a.children.length;g>f;f++)h=this._parse_model_from_json(a.children[f],l.id,d),i=j[h],l.children.push(h),i.children_d.length&&(l.children_d=l.children_d.concat(i.children_d));l.children_d=l.children.concat(l.children_d)}return a&&a.children&&a.children===!0&&(l.state.loaded=!1,l.children=[],l.children_d=[]),delete a.data,delete a.children,l.original=a,j[l.id]=l,l.state.selected&&this._data.core.selected.push(l.id),l.id},_redraw:function(){var b=this._model.force_full_redraw?this._model.data[a.jstree.root].children.concat([]):this._model.changed.concat([]),c=i.createElement("UL"),d,e,f,g=this._data.core.focused;for(e=0,f=b.length;f>e;e++)d=this.redraw_node(b[e],!0,this._model.force_full_redraw),d&&this._model.force_full_redraw&&c.appendChild(d);this._model.force_full_redraw&&(c.className=this.get_container_ul()[0].className,c.setAttribute("role","group"),this.element.empty().append(c)),null!==g&&this.settings.core.restore_focus&&(d=this.get_node(g,!0),d&&d.length&&d.children(".jstree-anchor")[0]!==i.activeElement?d.children(".jstree-anchor").focus():this._data.core.focused=null),this._model.force_full_redraw=!1,this._model.changed=[],this.trigger("redraw",{nodes:b})},redraw:function(a){a&&(this._model.force_full_redraw=!0),this._redraw()},draw_children:function(b){var c=this.get_node(b),d=!1,e=!1,f=!1,g=i;if(!c)return!1;if(c.id===a.jstree.root)return this.redraw(!0);if(b=this.get_node(b,!0),!b||!b.length)return!1;if(b.children(".jstree-children").remove(),b=b[0],c.children.length&&c.state.loaded){for(f=g.createElement("UL"),f.setAttribute("role","group"),f.className="jstree-children",d=0,e=c.children.length;e>d;d++)f.appendChild(this.redraw_node(c.children[d],!0,!0));b.appendChild(f)}},redraw_node:function(b,c,d,e){var f=this.get_node(b),g=!1,h=!1,j=!1,k=!1,l=!1,m=!1,n="",o=i,p=this._model.data,q=!1,r=!1,s=null,t=0,u=0,v=!1,w=!1;if(!f)return!1;if(f.id===a.jstree.root)return this.redraw(!0);if(c=c||0===f.children.length,b=i.querySelector?this.element[0].querySelector("#"+(-1!=="0123456789".indexOf(f.id[0])?"\\3"+f.id[0]+" "+f.id.substr(1).replace(a.jstree.idregex,"\\$&"):f.id.replace(a.jstree.idregex,"\\$&"))):i.getElementById(f.id))b=a(b),d||(g=b.parent().parent()[0],g===this.element[0]&&(g=null),h=b.index()),c||!f.children.length||b.children(".jstree-children").length||(c=!0),c||(j=b.children(".jstree-children")[0]),q=b.children(".jstree-anchor")[0]===i.activeElement,b.remove();else if(c=!0,!d){if(g=f.parent!==a.jstree.root?a("#"+f.parent.replace(a.jstree.idregex,"\\$&"),this.element)[0]:null,!(null===g||g&&p[f.parent].state.opened))return!1;h=a.inArray(f.id,null===g?p[a.jstree.root].children:p[f.parent].children)}b=this._data.core.node.cloneNode(!0),n="jstree-node ";for(k in f.li_attr)if(f.li_attr.hasOwnProperty(k)){if("id"===k)continue;"class"!==k?b.setAttribute(k,f.li_attr[k]):n+=f.li_attr[k]}for(f.a_attr.id||(f.a_attr.id=f.id+"_anchor"),b.setAttribute("aria-selected",!!f.state.selected),b.setAttribute("aria-level",f.parents.length),b.setAttribute("aria-labelledby",f.a_attr.id),f.state.disabled&&b.setAttribute("aria-disabled",!0),k=0,l=f.children.length;l>k;k++)if(!p[f.children[k]].state.hidden){v=!0;break}if(null!==f.parent&&p[f.parent]&&!f.state.hidden&&(k=a.inArray(f.id,p[f.parent].children),w=f.id,-1!==k))for(k++,l=p[f.parent].children.length;l>k;k++)if(p[p[f.parent].children[k]].state.hidden||(w=p[f.parent].children[k]),w!==f.id)break;f.state.hidden&&(n+=" jstree-hidden"),f.state.loading&&(n+=" jstree-loading"),f.state.loaded&&!v?n+=" jstree-leaf":(n+=f.state.opened&&f.state.loaded?" jstree-open":" jstree-closed",b.setAttribute("aria-expanded",f.state.opened&&f.state.loaded)),w===f.id&&(n+=" jstree-last"),b.id=f.id,b.className=n,n=(f.state.selected?" jstree-clicked":"")+(f.state.disabled?" jstree-disabled":"");for(l in f.a_attr)if(f.a_attr.hasOwnProperty(l)){if("href"===l&&"#"===f.a_attr[l])continue;"class"!==l?b.childNodes[1].setAttribute(l,f.a_attr[l]):n+=" "+f.a_attr[l]}if(n.length&&(b.childNodes[1].className="jstree-anchor "+n),(f.icon&&f.icon!==!0||f.icon===!1)&&(f.icon===!1?b.childNodes[1].childNodes[0].className+=" jstree-themeicon-hidden":-1===f.icon.indexOf("/")&&-1===f.icon.indexOf(".")?b.childNodes[1].childNodes[0].className+=" "+f.icon+" jstree-themeicon-custom":(b.childNodes[1].childNodes[0].style.backgroundImage='url("'+f.icon+'")',b.childNodes[1].childNodes[0].style.backgroundPosition="center center",b.childNodes[1].childNodes[0].style.backgroundSize="auto",b.childNodes[1].childNodes[0].className+=" jstree-themeicon-custom")),this.settings.core.force_text?b.childNodes[1].appendChild(o.createTextNode(f.text)):b.childNodes[1].innerHTML+=f.text,c&&f.children.length&&(f.state.opened||e)&&f.state.loaded){for(m=o.createElement("UL"),m.setAttribute("role","group"),m.className="jstree-children",k=0,l=f.children.length;l>k;k++)m.appendChild(this.redraw_node(f.children[k],c,!0));b.appendChild(m)}if(j&&b.appendChild(j),!d){for(g||(g=this.element[0]),k=0,l=g.childNodes.length;l>k;k++)if(g.childNodes[k]&&g.childNodes[k].className&&-1!==g.childNodes[k].className.indexOf("jstree-children")){s=g.childNodes[k];break}s||(s=o.createElement("UL"),s.setAttribute("role","group"),s.className="jstree-children",g.appendChild(s)),g=s,h<g.childNodes.length?g.insertBefore(b,g.childNodes[h]):g.appendChild(b),q&&(t=this.element[0].scrollTop,u=this.element[0].scrollLeft,b.childNodes[1].focus(),this.element[0].scrollTop=t,this.element[0].scrollLeft=u)}return f.state.opened&&!f.state.loaded&&(f.state.opened=!1,setTimeout(a.proxy(function(){this.open_node(f.id,!1,0)},this),0)),b},open_node:function(c,d,e){var f,g,h,i;if(a.isArray(c)){for(c=c.slice(),f=0,g=c.length;g>f;f++)this.open_node(c[f],d,e);return!0}return c=this.get_node(c),c&&c.id!==a.jstree.root?(e=e===b?this.settings.core.animation:e,this.is_closed(c)?this.is_loaded(c)?(h=this.get_node(c,!0),i=this,h.length&&(e&&h.children(".jstree-children").length&&h.children(".jstree-children").stop(!0,!0),c.children.length&&!this._firstChild(h.children(".jstree-children")[0])&&this.draw_children(c),e?(this.trigger("before_open",{node:c}),h.children(".jstree-children").css("display","none").end().removeClass("jstree-closed").addClass("jstree-open").attr("aria-expanded",!0).children(".jstree-children").stop(!0,!0).slideDown(e,function(){this.style.display="",i.element&&i.trigger("after_open",{node:c})})):(this.trigger("before_open",{node:c}),h[0].className=h[0].className.replace("jstree-closed","jstree-open"),h[0].setAttribute("aria-expanded",!0))),c.state.opened=!0,d&&d.call(this,c,!0),h.length||this.trigger("before_open",{node:c}),this.trigger("open_node",{node:c}),e&&h.length||this.trigger("after_open",{node:c}),!0):this.is_loading(c)?setTimeout(a.proxy(function(){this.open_node(c,d,e)},this),500):void this.load_node(c,function(a,b){return b?this.open_node(a,d,e):d?d.call(this,a,!1):!1}):(d&&d.call(this,c,!1),!1)):!1},_open_to:function(b){if(b=this.get_node(b),!b||b.id===a.jstree.root)return!1;var c,d,e=b.parents;for(c=0,d=e.length;d>c;c+=1)c!==a.jstree.root&&this.open_node(e[c],!1,0);return a("#"+b.id.replace(a.jstree.idregex,"\\$&"),this.element)},close_node:function(c,d){var e,f,g,h;if(a.isArray(c)){for(c=c.slice(),e=0,f=c.length;f>e;e++)this.close_node(c[e],d);return!0}return c=this.get_node(c),c&&c.id!==a.jstree.root?this.is_closed(c)?!1:(d=d===b?this.settings.core.animation:d,g=this,h=this.get_node(c,!0),c.state.opened=!1,this.trigger("close_node",{node:c}),void(h.length?d?h.children(".jstree-children").attr("style","display:block !important").end().removeClass("jstree-open").addClass("jstree-closed").attr("aria-expanded",!1).children(".jstree-children").stop(!0,!0).slideUp(d,function(){this.style.display="",h.children(".jstree-children").remove(),g.element&&g.trigger("after_close",{node:c})}):(h[0].className=h[0].className.replace("jstree-open","jstree-closed"),h.attr("aria-expanded",!1).children(".jstree-children").remove(),this.trigger("after_close",{node:c})):this.trigger("after_close",{node:c}))):!1},toggle_node:function(b){var c,d;if(a.isArray(b)){for(b=b.slice(),c=0,d=b.length;d>c;c++)this.toggle_node(b[c]);return!0}return this.is_closed(b)?this.open_node(b):this.is_open(b)?this.close_node(b):void 0},open_all:function(b,c,d){if(b||(b=a.jstree.root),b=this.get_node(b),!b)return!1;var e=b.id===a.jstree.root?this.get_container_ul():this.get_node(b,!0),f,g,h;if(!e.length){for(f=0,g=b.children_d.length;g>f;f++)this.is_closed(this._model.data[b.children_d[f]])&&(this._model.data[b.children_d[f]].state.opened=!0);return this.trigger("open_all",{node:b})}d=d||e,h=this,e=this.is_closed(b)?e.find(".jstree-closed").addBack():e.find(".jstree-closed"),e.each(function(){h.open_node(this,function(a,b){b&&this.is_parent(a)&&this.open_all(a,c,d)},c||0)}),0===d.find(".jstree-closed").length&&this.trigger("open_all",{node:this.get_node(d)})},close_all:function(b,c){if(b||(b=a.jstree.root),b=this.get_node(b),!b)return!1;var d=b.id===a.jstree.root?this.get_container_ul():this.get_node(b,!0),e=this,f,g;for(d.length&&(d=this.is_open(b)?d.find(".jstree-open").addBack():d.find(".jstree-open"),a(d.get().reverse()).each(function(){e.close_node(this,c||0)})),f=0,g=b.children_d.length;g>f;f++)this._model.data[b.children_d[f]].state.opened=!1;this.trigger("close_all",{node:b})},is_disabled:function(a){return a=this.get_node(a),a&&a.state&&a.state.disabled},enable_node:function(b){var c,d;if(a.isArray(b)){for(b=b.slice(),c=0,d=b.length;d>c;c++)this.enable_node(b[c]);return!0}return b=this.get_node(b),b&&b.id!==a.jstree.root?(b.state.disabled=!1,this.get_node(b,!0).children(".jstree-anchor").removeClass("jstree-disabled").attr("aria-disabled",!1),void this.trigger("enable_node",{node:b})):!1},disable_node:function(b){var c,d;if(a.isArray(b)){for(b=b.slice(),c=0,d=b.length;d>c;c++)this.disable_node(b[c]);return!0}return b=this.get_node(b),b&&b.id!==a.jstree.root?(b.state.disabled=!0,this.get_node(b,!0).children(".jstree-anchor").addClass("jstree-disabled").attr("aria-disabled",!0),void this.trigger("disable_node",{node:b})):!1},is_hidden:function(a){return a=this.get_node(a),a.state.hidden===!0},hide_node:function(b,c){var d,e;if(a.isArray(b)){for(b=b.slice(),d=0,e=b.length;e>d;d++)this.hide_node(b[d],!0);return c||this.redraw(),!0}return b=this.get_node(b),b&&b.id!==a.jstree.root?void(b.state.hidden||(b.state.hidden=!0,this._node_changed(b.parent),c||this.redraw(),this.trigger("hide_node",{node:b}))):!1},show_node:function(b,c){var d,e;if(a.isArray(b)){for(b=b.slice(),d=0,e=b.length;e>d;d++)this.show_node(b[d],!0);return c||this.redraw(),!0}return b=this.get_node(b),b&&b.id!==a.jstree.root?void(b.state.hidden&&(b.state.hidden=!1,this._node_changed(b.parent),c||this.redraw(),this.trigger("show_node",{node:b}))):!1},hide_all:function(b){var c,d=this._model.data,e=[];for(c in d)d.hasOwnProperty(c)&&c!==a.jstree.root&&!d[c].state.hidden&&(d[c].state.hidden=!0,e.push(c));return this._model.force_full_redraw=!0,b||this.redraw(),this.trigger("hide_all",{nodes:e}),e},show_all:function(b){var c,d=this._model.data,e=[];for(c in d)d.hasOwnProperty(c)&&c!==a.jstree.root&&d[c].state.hidden&&(d[c].state.hidden=!1,e.push(c));return this._model.force_full_redraw=!0,b||this.redraw(),this.trigger("show_all",{nodes:e}),e},activate_node:function(a,c){if(this.is_disabled(a))return!1;if(c&&"object"==typeof c||(c={}),this._data.core.last_clicked=this._data.core.last_clicked&&this._data.core.last_clicked.id!==b?this.get_node(this._data.core.last_clicked.id):null,this._data.core.last_clicked&&!this._data.core.last_clicked.state.selected&&(this._data.core.last_clicked=null),!this._data.core.last_clicked&&this._data.core.selected.length&&(this._data.core.last_clicked=this.get_node(this._data.core.selected[this._data.core.selected.length-1])),this.settings.core.multiple&&(c.metaKey||c.ctrlKey||c.shiftKey)&&(!c.shiftKey||this._data.core.last_clicked&&this.get_parent(a)&&this.get_parent(a)===this._data.core.last_clicked.parent))if(c.shiftKey){var d=this.get_node(a).id,e=this._data.core.last_clicked.id,f=this.get_node(this._data.core.last_clicked.parent).children,g=!1,h,i;for(h=0,i=f.length;i>h;h+=1)f[h]===d&&(g=!g),f[h]===e&&(g=!g),this.is_disabled(f[h])||!g&&f[h]!==d&&f[h]!==e?this.deselect_node(f[h],!0,c):this.is_hidden(f[h])||this.select_node(f[h],!0,!1,c);this.trigger("changed",{action:"select_node",node:this.get_node(a),selected:this._data.core.selected,event:c})}else this.is_selected(a)?this.deselect_node(a,!1,c):this.select_node(a,!1,!1,c);else!this.settings.core.multiple&&(c.metaKey||c.ctrlKey||c.shiftKey)&&this.is_selected(a)?this.deselect_node(a,!1,c):(this.deselect_all(!0),this.select_node(a,!1,!1,c),this._data.core.last_clicked=this.get_node(a));this.trigger("activate_node",{node:this.get_node(a),event:c})},hover_node:function(a){if(a=this.get_node(a,!0),!a||!a.length||a.children(".jstree-hovered").length)return!1;var b=this.element.find(".jstree-hovered"),c=this.element;b&&b.length&&this.dehover_node(b),a.children(".jstree-anchor").addClass("jstree-hovered"),this.trigger("hover_node",{node:this.get_node(a)}),setTimeout(function(){c.attr("aria-activedescendant",a[0].id)},0)},dehover_node:function(a){return a=this.get_node(a,!0),a&&a.length&&a.children(".jstree-hovered").length?(a.children(".jstree-anchor").removeClass("jstree-hovered"),void this.trigger("dehover_node",{node:this.get_node(a)})):!1},select_node:function(b,c,d,e){var f,g,h,i;if(a.isArray(b)){for(b=b.slice(),g=0,h=b.length;h>g;g++)this.select_node(b[g],c,d,e);return!0}return b=this.get_node(b),b&&b.id!==a.jstree.root?(f=this.get_node(b,!0),void(b.state.selected||(b.state.selected=!0,this._data.core.selected.push(b.id),d||(f=this._open_to(b)),f&&f.length&&f.attr("aria-selected",!0).children(".jstree-anchor").addClass("jstree-clicked"),this.trigger("select_node",{node:b,selected:this._data.core.selected,event:e}),c||this.trigger("changed",{action:"select_node",node:b,selected:this._data.core.selected,event:e})))):!1},deselect_node:function(b,c,d){var e,f,g;if(a.isArray(b)){for(b=b.slice(),e=0,f=b.length;f>e;e++)this.deselect_node(b[e],c,d);return!0}return b=this.get_node(b),b&&b.id!==a.jstree.root?(g=this.get_node(b,!0),void(b.state.selected&&(b.state.selected=!1,this._data.core.selected=a.vakata.array_remove_item(this._data.core.selected,b.id),g.length&&g.attr("aria-selected",!1).children(".jstree-anchor").removeClass("jstree-clicked"),this.trigger("deselect_node",{node:b,selected:this._data.core.selected,event:d}),c||this.trigger("changed",{action:"deselect_node",node:b,selected:this._data.core.selected,event:d})))):!1},select_all:function(b){var c=this._data.core.selected.concat([]),d,e;for(this._data.core.selected=this._model.data[a.jstree.root].children_d.concat(),d=0,e=this._data.core.selected.length;e>d;d++)this._model.data[this._data.core.selected[d]]&&(this._model.data[this._data.core.selected[d]].state.selected=!0);this.redraw(!0),this.trigger("select_all",{selected:this._data.core.selected}),b||this.trigger("changed",{action:"select_all",selected:this._data.core.selected,old_selection:c})},deselect_all:function(a){var b=this._data.core.selected.concat([]),c,d;for(c=0,d=this._data.core.selected.length;d>c;c++)this._model.data[this._data.core.selected[c]]&&(this._model.data[this._data.core.selected[c]].state.selected=!1);this._data.core.selected=[],this.element.find(".jstree-clicked").removeClass("jstree-clicked").parent().attr("aria-selected",!1),this.trigger("deselect_all",{selected:this._data.core.selected,node:b}),a||this.trigger("changed",{action:"deselect_all",selected:this._data.core.selected,old_selection:b})},is_selected:function(b){return b=this.get_node(b),b&&b.id!==a.jstree.root?b.state.selected:!1},get_selected:function(b){return b?a.map(this._data.core.selected,a.proxy(function(a){return this.get_node(a)},this)):this._data.core.selected.slice()},get_top_selected:function(b){var c=this.get_selected(!0),d={},e,f,g,h;for(e=0,f=c.length;f>e;e++)d[c[e].id]=c[e];for(e=0,f=c.length;f>e;e++)for(g=0,h=c[e].children_d.length;h>g;g++)d[c[e].children_d[g]]&&delete d[c[e].children_d[g]];c=[];for(e in d)d.hasOwnProperty(e)&&c.push(e);return b?a.map(c,a.proxy(function(a){return this.get_node(a)},this)):c},get_bottom_selected:function(b){var c=this.get_selected(!0),d=[],e,f;for(e=0,f=c.length;f>e;e++)c[e].children.length||d.push(c[e].id);return b?a.map(d,a.proxy(function(a){return this.get_node(a)},this)):d},get_state:function(){var b={core:{open:[],loaded:[],scroll:{left:this.element.scrollLeft(),top:this.element.scrollTop()},selected:[]}},c;for(c in this._model.data)this._model.data.hasOwnProperty(c)&&c!==a.jstree.root&&(this._model.data[c].state.loaded&&this.settings.core.loaded_state&&b.core.loaded.push(c),this._model.data[c].state.opened&&b.core.open.push(c),this._model.data[c].state.selected&&b.core.selected.push(c));return b},set_state:function(c,d){if(c){if(c.core&&c.core.selected&&c.core.initial_selection===b&&(c.core.initial_selection=this._data.core.selected.concat([]).sort().join(",")),c.core){var e,f,g,h,i;if(c.core.loaded)return this.settings.core.loaded_state&&a.isArray(c.core.loaded)&&c.core.loaded.length?this._load_nodes(c.core.loaded,function(a){delete c.core.loaded,this.set_state(c,d)}):(delete c.core.loaded,this.set_state(c,d)),!1;if(c.core.open)return a.isArray(c.core.open)&&c.core.open.length?this._load_nodes(c.core.open,function(a){this.open_node(a,!1,0),delete c.core.open,this.set_state(c,d)}):(delete c.core.open,this.set_state(c,d)),!1;if(c.core.scroll)return c.core.scroll&&c.core.scroll.left!==b&&this.element.scrollLeft(c.core.scroll.left),c.core.scroll&&c.core.scroll.top!==b&&this.element.scrollTop(c.core.scroll.top),delete c.core.scroll,this.set_state(c,d),!1;if(c.core.selected)return h=this,(c.core.initial_selection===b||c.core.initial_selection===this._data.core.selected.concat([]).sort().join(","))&&(this.deselect_all(),a.each(c.core.selected,function(a,b){h.select_node(b,!1,!0)})),delete c.core.initial_selection,delete c.core.selected,this.set_state(c,d),!1;for(i in c)c.hasOwnProperty(i)&&"core"!==i&&-1===a.inArray(i,this.settings.plugins)&&delete c[i];if(a.isEmptyObject(c.core))return delete c.core,this.set_state(c,d),!1}return a.isEmptyObject(c)?(c=null,d&&d.call(this),this.trigger("set_state"),!1):!0}return!1},refresh:function(b,c){this._data.core.state=c===!0?{}:this.get_state(),c&&a.isFunction(c)&&(this._data.core.state=c.call(this,this._data.core.state)),this._cnt=0,this._model.data={},this._model.data[a.jstree.root]={id:a.jstree.root,parent:null,parents:[],children:[],children_d:[],state:{loaded:!1}},this._data.core.selected=[],this._data.core.last_clicked=null,this._data.core.focused=null;var d=this.get_container_ul()[0].className;b||(this.element.html("<ul class='"+d+"' role='group'><li class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='treeitem' id='j"+this._id+"_loading'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>"),this.element.attr("aria-activedescendant","j"+this._id+"_loading")),this.load_node(a.jstree.root,function(b,c){c&&(this.get_container_ul()[0].className=d,this._firstChild(this.get_container_ul()[0])&&this.element.attr("aria-activedescendant",this._firstChild(this.get_container_ul()[0]).id),this.set_state(a.extend(!0,{},this._data.core.state),function(){this.trigger("refresh")})),this._data.core.state=null})},refresh_node:function(b){if(b=this.get_node(b),!b||b.id===a.jstree.root)return!1;var c=[],d=[],e=this._data.core.selected.concat([]);d.push(b.id),b.state.opened===!0&&c.push(b.id),this.get_node(b,!0).find(".jstree-open").each(function(){d.push(this.id),c.push(this.id)}),this._load_nodes(d,a.proxy(function(a){this.open_node(c,!1,0),this.select_node(e),this.trigger("refresh_node",{node:b,nodes:a})},this),!1,!0)},set_id:function(b,c){if(b=this.get_node(b),!b||b.id===a.jstree.root)return!1;var d,e,f=this._model.data,g=b.id;for(c=c.toString(),f[b.parent].children[a.inArray(b.id,f[b.parent].children)]=c,d=0,e=b.parents.length;e>d;d++)f[b.parents[d]].children_d[a.inArray(b.id,f[b.parents[d]].children_d)]=c;for(d=0,e=b.children.length;e>d;d++)f[b.children[d]].parent=c;for(d=0,e=b.children_d.length;e>d;d++)f[b.children_d[d]].parents[a.inArray(b.id,f[b.children_d[d]].parents)]=c;return d=a.inArray(b.id,this._data.core.selected),-1!==d&&(this._data.core.selected[d]=c),d=this.get_node(b.id,!0),d&&(d.attr("id",c),this.element.attr("aria-activedescendant")===b.id&&this.element.attr("aria-activedescendant",c)),delete f[b.id],b.id=c,b.li_attr.id=c,f[c]=b,this.trigger("set_id",{node:b,"new":b.id,old:g}),!0},get_text:function(b){return b=this.get_node(b),b&&b.id!==a.jstree.root?b.text:!1},set_text:function(b,c){var d,e;if(a.isArray(b)){for(b=b.slice(),d=0,e=b.length;e>d;d++)this.set_text(b[d],c);return!0}return b=this.get_node(b),b&&b.id!==a.jstree.root?(b.text=c,this.get_node(b,!0).length&&this.redraw_node(b.id),this.trigger("set_text",{obj:b,text:c}),!0):!1},get_json:function(b,c,d){if(b=this.get_node(b||a.jstree.root),!b)return!1;c&&c.flat&&!d&&(d=[]);var e={id:b.id,text:b.text,icon:this.get_icon(b),li_attr:a.extend(!0,{},b.li_attr),a_attr:a.extend(!0,{},b.a_attr),state:{},data:c&&c.no_data?!1:a.extend(!0,a.isArray(b.data)?[]:{},b.data)},f,g;if(c&&c.flat?e.parent=b.parent:e.children=[],c&&c.no_state)delete e.state;else for(f in b.state)b.state.hasOwnProperty(f)&&(e.state[f]=b.state[f]);if(c&&c.no_li_attr&&delete e.li_attr,c&&c.no_a_attr&&delete e.a_attr,c&&c.no_id&&(delete e.id,e.li_attr&&e.li_attr.id&&delete e.li_attr.id,e.a_attr&&e.a_attr.id&&delete e.a_attr.id),c&&c.flat&&b.id!==a.jstree.root&&d.push(e),!c||!c.no_children)for(f=0,g=b.children.length;g>f;f++)c&&c.flat?this.get_json(b.children[f],c,d):e.children.push(this.get_json(b.children[f],c));return c&&c.flat?d:b.id===a.jstree.root?e.children:e},create_node:function(c,d,e,f,g){if(null===c&&(c=a.jstree.root),c=this.get_node(c),!c)return!1;if(e=e===b?"last":e,!e.toString().match(/^(before|after)$/)&&!g&&!this.is_loaded(c))return this.load_node(c,function(){this.create_node(c,d,e,f,!0)});d||(d={text:this.get_string("New node")}),d="string"==typeof d?{text:d}:a.extend(!0,{},d),d.text===b&&(d.text=this.get_string("New node"));var h,i,j,k;switch(c.id===a.jstree.root&&("before"===e&&(e="first"),"after"===e&&(e="last")),e){case"before":h=this.get_node(c.parent),e=a.inArray(c.id,h.children),c=h;break;case"after":h=this.get_node(c.parent),e=a.inArray(c.id,h.children)+1,c=h;break;case"inside":case"first":e=0;break;case"last":e=c.children.length;break;default:e||(e=0)}if(e>c.children.length&&(e=c.children.length),d.id||(d.id=!0),!this.check("create_node",d,c,e))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(d.id===!0&&delete d.id,d=this._parse_model_from_json(d,c.id,c.parents.concat()),!d)return!1;for(h=this.get_node(d),i=[],i.push(d),i=i.concat(h.children_d),this.trigger("model",{nodes:i,parent:c.id}),c.children_d=c.children_d.concat(i),j=0,k=c.parents.length;k>j;j++)this._model.data[c.parents[j]].children_d=this._model.data[c.parents[j]].children_d.concat(i);for(d=h,h=[],j=0,k=c.children.length;k>j;j++)h[j>=e?j+1:j]=c.children[j];return h[e]=d.id,c.children=h,this.redraw_node(c,!0),this.trigger("create_node",{node:this.get_node(d),parent:c.id,position:e}),f&&f.call(this,this.get_node(d)),d.id},rename_node:function(b,c){var d,e,f;if(a.isArray(b)){for(b=b.slice(),d=0,e=b.length;e>d;d++)this.rename_node(b[d],c);return!0}return b=this.get_node(b),b&&b.id!==a.jstree.root?(f=b.text,this.check("rename_node",b,this.get_parent(b),c)?(this.set_text(b,c),this.trigger("rename_node",{node:b,text:c,old:f}),!0):(this.settings.core.error.call(this,this._data.core.last_error),!1)):!1},delete_node:function(b){var c,d,e,f,g,h,i,j,k,l,m,n;if(a.isArray(b)){for(b=b.slice(),c=0,d=b.length;d>c;c++)this.delete_node(b[c]);return!0}if(b=this.get_node(b),!b||b.id===a.jstree.root)return!1;if(e=this.get_node(b.parent),f=a.inArray(b.id,e.children),l=!1,!this.check("delete_node",b,e,f))return this.settings.core.error.call(this,this._data.core.last_error),!1;for(-1!==f&&(e.children=a.vakata.array_remove(e.children,f)),g=b.children_d.concat([]),g.push(b.id),h=0,i=b.parents.length;i>h;h++)this._model.data[b.parents[h]].children_d=a.vakata.array_filter(this._model.data[b.parents[h]].children_d,function(b){return-1===a.inArray(b,g)});for(j=0,k=g.length;k>j;j++)if(this._model.data[g[j]].state.selected){l=!0;break}for(l&&(this._data.core.selected=a.vakata.array_filter(this._data.core.selected,function(b){return-1===a.inArray(b,g)})),this.trigger("delete_node",{node:b,parent:e.id}),l&&this.trigger("changed",{action:"delete_node",node:b,selected:this._data.core.selected,parent:e.id}),j=0,k=g.length;k>j;j++)delete this._model.data[g[j]];return-1!==a.inArray(this._data.core.focused,g)&&(this._data.core.focused=null,m=this.element[0].scrollTop,n=this.element[0].scrollLeft,e.id===a.jstree.root?this._model.data[a.jstree.root].children[0]&&this.get_node(this._model.data[a.jstree.root].children[0],!0).children(".jstree-anchor").focus():this.get_node(e,!0).children(".jstree-anchor").focus(),this.element[0].scrollTop=m,this.element[0].scrollLeft=n),this.redraw_node(e,!0),!0},check:function(b,c,d,e,f){c=c&&c.id?c:this.get_node(c),d=d&&d.id?d:this.get_node(d);var g=b.match(/^move_node|copy_node|create_node$/i)?d:c,h=this.settings.core.check_callback;if("move_node"===b||"copy_node"===b){if(!(f&&f.is_multi||"move_node"!==b||a.inArray(c.id,d.children)!==e))return this._data.core.last_error={error:"check",plugin:"core",id:"core_08",reason:"Moving node to its current position",data:JSON.stringify({chk:b,pos:e,obj:c&&c.id?c.id:!1,par:d&&d.id?d.id:!1})},!1;if(!(f&&f.is_multi||c.id!==d.id&&("move_node"!==b||a.inArray(c.id,d.children)!==e)&&-1===a.inArray(d.id,c.children_d)))return this._data.core.last_error={error:"check",plugin:"core",id:"core_01",reason:"Moving parent inside child",data:JSON.stringify({chk:b,pos:e,obj:c&&c.id?c.id:!1,par:d&&d.id?d.id:!1})},!1}return g&&g.data&&(g=g.data),g&&g.functions&&(g.functions[b]===!1||g.functions[b]===!0)?(g.functions[b]===!1&&(this._data.core.last_error={error:"check",plugin:"core",id:"core_02",reason:"Node data prevents function: "+b,data:JSON.stringify({chk:b,pos:e,obj:c&&c.id?c.id:!1,par:d&&d.id?d.id:!1})}),g.functions[b]):h===!1||a.isFunction(h)&&h.call(this,b,c,d,e,f)===!1||h&&h[b]===!1?(this._data.core.last_error={error:"check",plugin:"core",id:"core_03",reason:"User config for core.check_callback prevents function: "+b,data:JSON.stringify({chk:b,pos:e,obj:c&&c.id?c.id:!1,par:d&&d.id?d.id:!1})},!1):!0},last_error:function(){return this._data.core.last_error},move_node:function(c,d,e,f,g,h,i){var j,k,l,m,n,o,p,q,r,s,t,u,v,w;if(d=this.get_node(d),e=e===b?0:e,!d)return!1;if(!e.toString().match(/^(before|after)$/)&&!g&&!this.is_loaded(d))return this.load_node(d,function(){this.move_node(c,d,e,f,!0,!1,i)});if(a.isArray(c)){if(1!==c.length){for(j=0,k=c.length;k>j;j++)(r=this.move_node(c[j],d,e,f,g,!1,i))&&(d=r,e="after");return this.redraw(),!0}c=c[0]}if(c=c&&c.id?c:this.get_node(c),!c||c.id===a.jstree.root)return!1;if(l=(c.parent||a.jstree.root).toString(),n=e.toString().match(/^(before|after)$/)&&d.id!==a.jstree.root?this.get_node(d.parent):d,o=i?i:this._model.data[c.id]?this:a.jstree.reference(c.id),p=!o||!o._id||this._id!==o._id,m=o&&o._id&&l&&o._model.data[l]&&o._model.data[l].children?a.inArray(c.id,o._model.data[l].children):-1,o&&o._id&&(c=o._model.data[c.id]),p)return(r=this.copy_node(c,d,e,f,g,!1,i))?(o&&o.delete_node(c),r):!1;switch(d.id===a.jstree.root&&("before"===e&&(e="first"),"after"===e&&(e="last")),e){case"before":e=a.inArray(d.id,n.children);break;case"after":e=a.inArray(d.id,n.children)+1;break;case"inside":case"first":e=0;break;case"last":e=n.children.length;break;default:e||(e=0)}if(e>n.children.length&&(e=n.children.length),!this.check("move_node",c,n,e,{core:!0,origin:i,is_multi:o&&o._id&&o._id!==this._id,is_foreign:!o||!o._id}))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(c.parent===n.id){for(q=n.children.concat(),r=a.inArray(c.id,q),-1!==r&&(q=a.vakata.array_remove(q,r),e>r&&e--),r=[],s=0,t=q.length;t>s;s++)r[s>=e?s+1:s]=q[s];r[e]=c.id,n.children=r,this._node_changed(n.id),this.redraw(n.id===a.jstree.root)}else{for(r=c.children_d.concat(),r.push(c.id),s=0,t=c.parents.length;t>s;s++){for(q=[],w=o._model.data[c.parents[s]].children_d,u=0,v=w.length;v>u;u++)-1===a.inArray(w[u],r)&&q.push(w[u]);o._model.data[c.parents[s]].children_d=q}for(o._model.data[l].children=a.vakata.array_remove_item(o._model.data[l].children,c.id),s=0,t=n.parents.length;t>s;s++)this._model.data[n.parents[s]].children_d=this._model.data[n.parents[s]].children_d.concat(r);for(q=[],s=0,t=n.children.length;t>s;s++)q[s>=e?s+1:s]=n.children[s];for(q[e]=c.id,n.children=q,n.children_d.push(c.id),n.children_d=n.children_d.concat(c.children_d),c.parent=n.id,r=n.parents.concat(),r.unshift(n.id),w=c.parents.length,c.parents=r,r=r.concat(),s=0,t=c.children_d.length;t>s;s++)this._model.data[c.children_d[s]].parents=this._model.data[c.children_d[s]].parents.slice(0,-1*w),Array.prototype.push.apply(this._model.data[c.children_d[s]].parents,r);(l===a.jstree.root||n.id===a.jstree.root)&&(this._model.force_full_redraw=!0),this._model.force_full_redraw||(this._node_changed(l),this._node_changed(n.id)),h||this.redraw()}return f&&f.call(this,c,n,e),this.trigger("move_node",{node:c,parent:n.id,position:e,old_parent:l,old_position:m,is_multi:o&&o._id&&o._id!==this._id,is_foreign:!o||!o._id,old_instance:o,new_instance:this}),c.id},copy_node:function(c,d,e,f,g,h,i){var j,k,l,m,n,o,p,q,r,s,t;if(d=this.get_node(d),e=e===b?0:e,!d)return!1;if(!e.toString().match(/^(before|after)$/)&&!g&&!this.is_loaded(d))return this.load_node(d,function(){this.copy_node(c,d,e,f,!0,!1,i)});if(a.isArray(c)){if(1!==c.length){for(j=0,k=c.length;k>j;j++)(m=this.copy_node(c[j],d,e,f,g,!0,i))&&(d=m,e="after");return this.redraw(),!0}c=c[0]}if(c=c&&c.id?c:this.get_node(c),!c||c.id===a.jstree.root)return!1;switch(q=(c.parent||a.jstree.root).toString(),r=e.toString().match(/^(before|after)$/)&&d.id!==a.jstree.root?this.get_node(d.parent):d,s=i?i:this._model.data[c.id]?this:a.jstree.reference(c.id),t=!s||!s._id||this._id!==s._id,s&&s._id&&(c=s._model.data[c.id]),d.id===a.jstree.root&&("before"===e&&(e="first"),"after"===e&&(e="last")),e){case"before":e=a.inArray(d.id,r.children);break;case"after":e=a.inArray(d.id,r.children)+1;break;case"inside":case"first":e=0;break;case"last":e=r.children.length;break;default:e||(e=0)}if(e>r.children.length&&(e=r.children.length),!this.check("copy_node",c,r,e,{core:!0,origin:i,is_multi:s&&s._id&&s._id!==this._id,is_foreign:!s||!s._id}))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(p=s?s.get_json(c,{no_id:!0,no_data:!0,no_state:!0}):c,!p)return!1;if(p.id===!0&&delete p.id,p=this._parse_model_from_json(p,r.id,r.parents.concat()),!p)return!1;for(m=this.get_node(p),c&&c.state&&c.state.loaded===!1&&(m.state.loaded=!1),l=[],l.push(p),l=l.concat(m.children_d),this.trigger("model",{nodes:l,parent:r.id}),n=0,o=r.parents.length;o>n;n++)this._model.data[r.parents[n]].children_d=this._model.data[r.parents[n]].children_d.concat(l);for(l=[],n=0,o=r.children.length;o>n;n++)l[n>=e?n+1:n]=r.children[n];return l[e]=m.id,r.children=l,r.children_d.push(m.id),r.children_d=r.children_d.concat(m.children_d),r.id===a.jstree.root&&(this._model.force_full_redraw=!0),this._model.force_full_redraw||this._node_changed(r.id),h||this.redraw(r.id===a.jstree.root),f&&f.call(this,m,r,e),this.trigger("copy_node",{node:m,original:c,parent:r.id,position:e,old_parent:q,old_position:s&&s._id&&q&&s._model.data[q]&&s._model.data[q].children?a.inArray(c.id,s._model.data[q].children):-1,
is_multi:s&&s._id&&s._id!==this._id,is_foreign:!s||!s._id,old_instance:s,new_instance:this}),m.id},cut:function(b){if(b||(b=this._data.core.selected.concat()),a.isArray(b)||(b=[b]),!b.length)return!1;var c=[],g,h,i;for(h=0,i=b.length;i>h;h++)g=this.get_node(b[h]),g&&g.id&&g.id!==a.jstree.root&&c.push(g);return c.length?(d=c,f=this,e="move_node",void this.trigger("cut",{node:b})):!1},copy:function(b){if(b||(b=this._data.core.selected.concat()),a.isArray(b)||(b=[b]),!b.length)return!1;var c=[],g,h,i;for(h=0,i=b.length;i>h;h++)g=this.get_node(b[h]),g&&g.id&&g.id!==a.jstree.root&&c.push(g);return c.length?(d=c,f=this,e="copy_node",void this.trigger("copy",{node:b})):!1},get_buffer:function(){return{mode:e,node:d,inst:f}},can_paste:function(){return e!==!1&&d!==!1},paste:function(a,b){return a=this.get_node(a),a&&e&&e.match(/^(copy_node|move_node)$/)&&d?(this[e](d,a,b,!1,!1,!1,f)&&this.trigger("paste",{parent:a.id,node:d,mode:e}),d=!1,e=!1,void(f=!1)):!1},clear_buffer:function(){d=!1,e=!1,f=!1,this.trigger("clear_buffer")},edit:function(b,c,d){var e,f,g,h,j,k,l,m,n,o=!1;return(b=this.get_node(b))?this.check("edit",b,this.get_parent(b))?(n=b,c="string"==typeof c?c:b.text,this.set_text(b,""),b=this._open_to(b),n.text=c,e=this._data.core.rtl,f=this.element.width(),this._data.core.focused=n.id,g=b.children(".jstree-anchor").focus(),h=a("<span>"),j=c,k=a("<div />",{css:{position:"absolute",top:"-200px",left:e?"0px":"-1000px",visibility:"hidden"}}).appendTo(i.body),l=a("<input />",{value:j,"class":"jstree-rename-input",css:{padding:"0",border:"1px solid silver","box-sizing":"border-box",display:"inline-block",height:this._data.core.li_height+"px",lineHeight:this._data.core.li_height+"px",width:"150px"},blur:a.proxy(function(c){c.stopImmediatePropagation(),c.preventDefault();var e=h.children(".jstree-rename-input"),f=e.val(),i=this.settings.core.force_text,m;""===f&&(f=j),k.remove(),h.replaceWith(g),h.remove(),j=i?j:a("<div></div>").append(a.parseHTML(j)).html(),b=this.get_node(b),this.set_text(b,j),m=!!this.rename_node(b,i?a("<div></div>").text(f).text():a("<div></div>").append(a.parseHTML(f)).html()),m||this.set_text(b,j),this._data.core.focused=n.id,setTimeout(a.proxy(function(){var a=this.get_node(n.id,!0);a.length&&(this._data.core.focused=n.id,a.children(".jstree-anchor").focus())},this),0),d&&d.call(this,n,m,o),l=null},this),keydown:function(a){var b=a.which;27===b&&(o=!0,this.value=j),(27===b||13===b||37===b||38===b||39===b||40===b||32===b)&&a.stopImmediatePropagation(),(27===b||13===b)&&(a.preventDefault(),this.blur())},click:function(a){a.stopImmediatePropagation()},mousedown:function(a){a.stopImmediatePropagation()},keyup:function(a){l.width(Math.min(k.text("pW"+this.value).width(),f))},keypress:function(a){return 13===a.which?!1:void 0}}),m={fontFamily:g.css("fontFamily")||"",fontSize:g.css("fontSize")||"",fontWeight:g.css("fontWeight")||"",fontStyle:g.css("fontStyle")||"",fontStretch:g.css("fontStretch")||"",fontVariant:g.css("fontVariant")||"",letterSpacing:g.css("letterSpacing")||"",wordSpacing:g.css("wordSpacing")||""},h.attr("class",g.attr("class")).append(g.contents().clone()).append(l),g.replaceWith(h),k.css(m),l.css(m).width(Math.min(k.text("pW"+l[0].value).width(),f))[0].select(),void a(i).one("mousedown.jstree touchstart.jstree dnd_start.vakata",function(b){l&&b.target!==l&&a(l).blur()})):(this.settings.core.error.call(this,this._data.core.last_error),!1):!1},set_theme:function(b,c){if(!b)return!1;if(c===!0){var d=this.settings.core.themes.dir;d||(d=a.jstree.path+"/themes"),c=d+"/"+b+"/style.css"}c&&-1===a.inArray(c,g)&&(a("head").append('<link rel="stylesheet" href="'+c+'" type="text/css" />'),g.push(c)),this._data.core.themes.name&&this.element.removeClass("jstree-"+this._data.core.themes.name),this._data.core.themes.name=b,this.element.addClass("jstree-"+b),this.element[this.settings.core.themes.responsive?"addClass":"removeClass"]("jstree-"+b+"-responsive"),this.trigger("set_theme",{theme:b})},get_theme:function(){return this._data.core.themes.name},set_theme_variant:function(a){this._data.core.themes.variant&&this.element.removeClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant),this._data.core.themes.variant=a,a&&this.element.addClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant)},get_theme_variant:function(){return this._data.core.themes.variant},show_stripes:function(){this._data.core.themes.stripes=!0,this.get_container_ul().addClass("jstree-striped"),this.trigger("show_stripes")},hide_stripes:function(){this._data.core.themes.stripes=!1,this.get_container_ul().removeClass("jstree-striped"),this.trigger("hide_stripes")},toggle_stripes:function(){this._data.core.themes.stripes?this.hide_stripes():this.show_stripes()},show_dots:function(){this._data.core.themes.dots=!0,this.get_container_ul().removeClass("jstree-no-dots"),this.trigger("show_dots")},hide_dots:function(){this._data.core.themes.dots=!1,this.get_container_ul().addClass("jstree-no-dots"),this.trigger("hide_dots")},toggle_dots:function(){this._data.core.themes.dots?this.hide_dots():this.show_dots()},show_icons:function(){this._data.core.themes.icons=!0,this.get_container_ul().removeClass("jstree-no-icons"),this.trigger("show_icons")},hide_icons:function(){this._data.core.themes.icons=!1,this.get_container_ul().addClass("jstree-no-icons"),this.trigger("hide_icons")},toggle_icons:function(){this._data.core.themes.icons?this.hide_icons():this.show_icons()},show_ellipsis:function(){this._data.core.themes.ellipsis=!0,this.get_container_ul().addClass("jstree-ellipsis"),this.trigger("show_ellipsis")},hide_ellipsis:function(){this._data.core.themes.ellipsis=!1,this.get_container_ul().removeClass("jstree-ellipsis"),this.trigger("hide_ellipsis")},toggle_ellipsis:function(){this._data.core.themes.ellipsis?this.hide_ellipsis():this.show_ellipsis()},set_icon:function(c,d){var e,f,g,h;if(a.isArray(c)){for(c=c.slice(),e=0,f=c.length;f>e;e++)this.set_icon(c[e],d);return!0}return c=this.get_node(c),c&&c.id!==a.jstree.root?(h=c.icon,c.icon=d===!0||null===d||d===b||""===d?!0:d,g=this.get_node(c,!0).children(".jstree-anchor").children(".jstree-themeicon"),d===!1?(g.removeClass("jstree-themeicon-custom "+h).css("background","").removeAttr("rel"),this.hide_icon(c)):d===!0||null===d||d===b||""===d?(g.removeClass("jstree-themeicon-custom "+h).css("background","").removeAttr("rel"),h===!1&&this.show_icon(c)):-1===d.indexOf("/")&&-1===d.indexOf(".")?(g.removeClass(h).css("background",""),g.addClass(d+" jstree-themeicon-custom").attr("rel",d),h===!1&&this.show_icon(c)):(g.removeClass(h).css("background",""),g.addClass("jstree-themeicon-custom").css("background","url('"+d+"') center center no-repeat").attr("rel",d),h===!1&&this.show_icon(c)),!0):!1},get_icon:function(b){return b=this.get_node(b),b&&b.id!==a.jstree.root?b.icon:!1},hide_icon:function(b){var c,d;if(a.isArray(b)){for(b=b.slice(),c=0,d=b.length;d>c;c++)this.hide_icon(b[c]);return!0}return b=this.get_node(b),b&&b!==a.jstree.root?(b.icon=!1,this.get_node(b,!0).children(".jstree-anchor").children(".jstree-themeicon").addClass("jstree-themeicon-hidden"),!0):!1},show_icon:function(b){var c,d,e;if(a.isArray(b)){for(b=b.slice(),c=0,d=b.length;d>c;c++)this.show_icon(b[c]);return!0}return b=this.get_node(b),b&&b!==a.jstree.root?(e=this.get_node(b,!0),b.icon=e.length?e.children(".jstree-anchor").children(".jstree-themeicon").attr("rel"):!0,b.icon||(b.icon=!0),e.children(".jstree-anchor").children(".jstree-themeicon").removeClass("jstree-themeicon-hidden"),!0):!1}},a.vakata={},a.vakata.attributes=function(b,c){b=a(b)[0];var d=c?{}:[];return b&&b.attributes&&a.each(b.attributes,function(b,e){-1===a.inArray(e.name.toLowerCase(),["style","contenteditable","hasfocus","tabindex"])&&null!==e.value&&""!==a.trim(e.value)&&(c?d[e.name]=e.value:d.push(e.name))}),d},a.vakata.array_unique=function(a){var c=[],d,e,f,g={};for(d=0,f=a.length;f>d;d++)g[a[d]]===b&&(c.push(a[d]),g[a[d]]=!0);return c},a.vakata.array_remove=function(a,b){return a.splice(b,1),a},a.vakata.array_remove_item=function(b,c){var d=a.inArray(c,b);return-1!==d?a.vakata.array_remove(b,d):b},a.vakata.array_filter=function(a,b,c,d,e){if(a.filter)return a.filter(b,c);d=[];for(e in a)~~e+""==e+""&&e>=0&&b.call(c,a[e],+e,a)&&d.push(a[e]);return d},a.jstree.plugins.changed=function(a,b){var c=[];this.trigger=function(a,d){var e,f;if(d||(d={}),"changed"===a.replace(".jstree","")){d.changed={selected:[],deselected:[]};var g={};for(e=0,f=c.length;f>e;e++)g[c[e]]=1;for(e=0,f=d.selected.length;f>e;e++)g[d.selected[e]]?g[d.selected[e]]=2:d.changed.selected.push(d.selected[e]);for(e=0,f=c.length;f>e;e++)1===g[c[e]]&&d.changed.deselected.push(c[e]);c=d.selected.slice()}b.trigger.call(this,a,d)},this.refresh=function(a,d){return c=[],b.refresh.apply(this,arguments)}};var j=i.createElement("I");j.className="jstree-icon jstree-checkbox",j.setAttribute("role","presentation"),a.jstree.defaults.checkbox={visible:!0,three_state:!0,whole_node:!0,keep_selected_style:!0,cascade:"",tie_selection:!0,cascade_to_disabled:!0,cascade_to_hidden:!0},a.jstree.plugins.checkbox=function(c,d){this.bind=function(){d.bind.call(this),this._data.checkbox.uto=!1,this._data.checkbox.selected=[],this.settings.checkbox.three_state&&(this.settings.checkbox.cascade="up+down+undetermined"),this.element.on("init.jstree",a.proxy(function(){this._data.checkbox.visible=this.settings.checkbox.visible,this.settings.checkbox.keep_selected_style||this.element.addClass("jstree-checkbox-no-clicked"),this.settings.checkbox.tie_selection&&this.element.addClass("jstree-checkbox-selection")},this)).on("loading.jstree",a.proxy(function(){this[this._data.checkbox.visible?"show_checkboxes":"hide_checkboxes"]()},this)),-1!==this.settings.checkbox.cascade.indexOf("undetermined")&&this.element.on("changed.jstree uncheck_node.jstree check_node.jstree uncheck_all.jstree check_all.jstree move_node.jstree copy_node.jstree redraw.jstree open_node.jstree",a.proxy(function(){this._data.checkbox.uto&&clearTimeout(this._data.checkbox.uto),this._data.checkbox.uto=setTimeout(a.proxy(this._undetermined,this),50)},this)),this.settings.checkbox.tie_selection||this.element.on("model.jstree",a.proxy(function(a,b){var c=this._model.data,d=c[b.parent],e=b.nodes,f,g;for(f=0,g=e.length;g>f;f++)c[e[f]].state.checked=c[e[f]].state.checked||c[e[f]].original&&c[e[f]].original.state&&c[e[f]].original.state.checked,c[e[f]].state.checked&&this._data.checkbox.selected.push(e[f])},this)),(-1!==this.settings.checkbox.cascade.indexOf("up")||-1!==this.settings.checkbox.cascade.indexOf("down"))&&this.element.on("model.jstree",a.proxy(function(b,c){var d=this._model.data,e=d[c.parent],f=c.nodes,g=[],h,i,j,k,l,m,n=this.settings.checkbox.cascade,o=this.settings.checkbox.tie_selection;if(-1!==n.indexOf("down"))if(e.state[o?"selected":"checked"]){for(i=0,j=f.length;j>i;i++)d[f[i]].state[o?"selected":"checked"]=!0;this._data[o?"core":"checkbox"].selected=this._data[o?"core":"checkbox"].selected.concat(f)}else for(i=0,j=f.length;j>i;i++)if(d[f[i]].state[o?"selected":"checked"]){for(k=0,l=d[f[i]].children_d.length;l>k;k++)d[d[f[i]].children_d[k]].state[o?"selected":"checked"]=!0;this._data[o?"core":"checkbox"].selected=this._data[o?"core":"checkbox"].selected.concat(d[f[i]].children_d)}if(-1!==n.indexOf("up")){for(i=0,j=e.children_d.length;j>i;i++)d[e.children_d[i]].children.length||g.push(d[e.children_d[i]].parent);for(g=a.vakata.array_unique(g),k=0,l=g.length;l>k;k++){e=d[g[k]];while(e&&e.id!==a.jstree.root){for(h=0,i=0,j=e.children.length;j>i;i++)h+=d[e.children[i]].state[o?"selected":"checked"];if(h!==j)break;e.state[o?"selected":"checked"]=!0,this._data[o?"core":"checkbox"].selected.push(e.id),m=this.get_node(e,!0),m&&m.length&&m.attr("aria-selected",!0).children(".jstree-anchor").addClass(o?"jstree-clicked":"jstree-checked"),e=this.get_node(e.parent)}}}this._data[o?"core":"checkbox"].selected=a.vakata.array_unique(this._data[o?"core":"checkbox"].selected)},this)).on(this.settings.checkbox.tie_selection?"select_node.jstree":"check_node.jstree",a.proxy(function(b,c){var d=this,e=c.node,f=this._model.data,g=this.get_node(e.parent),h,i,j,k,l=this.settings.checkbox.cascade,m=this.settings.checkbox.tie_selection,n={},o=this._data[m?"core":"checkbox"].selected;for(h=0,i=o.length;i>h;h++)n[o[h]]=!0;if(-1!==l.indexOf("down")){var p=this._cascade_new_checked_state(e.id,!0),q=e.children_d.concat(e.id);for(h=0,i=q.length;i>h;h++)p.indexOf(q[h])>-1?n[q[h]]=!0:delete n[q[h]]}if(-1!==l.indexOf("up"))while(g&&g.id!==a.jstree.root){for(j=0,h=0,i=g.children.length;i>h;h++)j+=f[g.children[h]].state[m?"selected":"checked"];if(j!==i)break;g.state[m?"selected":"checked"]=!0,n[g.id]=!0,k=this.get_node(g,!0),k&&k.length&&k.attr("aria-selected",!0).children(".jstree-anchor").addClass(m?"jstree-clicked":"jstree-checked"),g=this.get_node(g.parent)}o=[];for(h in n)n.hasOwnProperty(h)&&o.push(h);this._data[m?"core":"checkbox"].selected=o},this)).on(this.settings.checkbox.tie_selection?"deselect_all.jstree":"uncheck_all.jstree",a.proxy(function(b,c){var d=this.get_node(a.jstree.root),e=this._model.data,f,g,h;for(f=0,g=d.children_d.length;g>f;f++)h=e[d.children_d[f]],h&&h.original&&h.original.state&&h.original.state.undetermined&&(h.original.state.undetermined=!1)},this)).on(this.settings.checkbox.tie_selection?"deselect_node.jstree":"uncheck_node.jstree",a.proxy(function(b,c){var d=this,e=c.node,f=this.get_node(e,!0),g,h,i,j=this.settings.checkbox.cascade,k=this.settings.checkbox.tie_selection,l=this._data[k?"core":"checkbox"].selected,m={},n=[],o=e.children_d.concat(e.id);if(-1!==j.indexOf("down")){var p=this._cascade_new_checked_state(e.id,!1);l=a.vakata.array_filter(l,function(a){return-1===o.indexOf(a)||p.indexOf(a)>-1})}if(-1!==j.indexOf("up")&&-1===l.indexOf(e.id)){for(g=0,h=e.parents.length;h>g;g++)i=this._model.data[e.parents[g]],i.state[k?"selected":"checked"]=!1,i&&i.original&&i.original.state&&i.original.state.undetermined&&(i.original.state.undetermined=!1),i=this.get_node(e.parents[g],!0),i&&i.length&&i.attr("aria-selected",!1).children(".jstree-anchor").removeClass(k?"jstree-clicked":"jstree-checked");l=a.vakata.array_filter(l,function(a){return-1===e.parents.indexOf(a)})}this._data[k?"core":"checkbox"].selected=l},this)),-1!==this.settings.checkbox.cascade.indexOf("up")&&this.element.on("delete_node.jstree",a.proxy(function(b,c){var d=this.get_node(c.parent),e=this._model.data,f,g,h,i,j=this.settings.checkbox.tie_selection;while(d&&d.id!==a.jstree.root&&!d.state[j?"selected":"checked"]){for(h=0,f=0,g=d.children.length;g>f;f++)h+=e[d.children[f]].state[j?"selected":"checked"];if(!(g>0&&h===g))break;d.state[j?"selected":"checked"]=!0,this._data[j?"core":"checkbox"].selected.push(d.id),i=this.get_node(d,!0),i&&i.length&&i.attr("aria-selected",!0).children(".jstree-anchor").addClass(j?"jstree-clicked":"jstree-checked"),d=this.get_node(d.parent)}},this)).on("move_node.jstree",a.proxy(function(b,c){var d=c.is_multi,e=c.old_parent,f=this.get_node(c.parent),g=this._model.data,h,i,j,k,l,m=this.settings.checkbox.tie_selection;if(!d){h=this.get_node(e);while(h&&h.id!==a.jstree.root&&!h.state[m?"selected":"checked"]){for(i=0,j=0,k=h.children.length;k>j;j++)i+=g[h.children[j]].state[m?"selected":"checked"];if(!(k>0&&i===k))break;h.state[m?"selected":"checked"]=!0,this._data[m?"core":"checkbox"].selected.push(h.id),l=this.get_node(h,!0),l&&l.length&&l.attr("aria-selected",!0).children(".jstree-anchor").addClass(m?"jstree-clicked":"jstree-checked"),h=this.get_node(h.parent)}}h=f;while(h&&h.id!==a.jstree.root){for(i=0,j=0,k=h.children.length;k>j;j++)i+=g[h.children[j]].state[m?"selected":"checked"];if(i===k)h.state[m?"selected":"checked"]||(h.state[m?"selected":"checked"]=!0,this._data[m?"core":"checkbox"].selected.push(h.id),l=this.get_node(h,!0),l&&l.length&&l.attr("aria-selected",!0).children(".jstree-anchor").addClass(m?"jstree-clicked":"jstree-checked"));else{if(!h.state[m?"selected":"checked"])break;h.state[m?"selected":"checked"]=!1,this._data[m?"core":"checkbox"].selected=a.vakata.array_remove_item(this._data[m?"core":"checkbox"].selected,h.id),l=this.get_node(h,!0),l&&l.length&&l.attr("aria-selected",!1).children(".jstree-anchor").removeClass(m?"jstree-clicked":"jstree-checked")}h=this.get_node(h.parent)}},this))},this.get_undetermined=function(c){if(-1===this.settings.checkbox.cascade.indexOf("undetermined"))return[];var d,e,f,g,h={},i=this._model.data,j=this.settings.checkbox.tie_selection,k=this._data[j?"core":"checkbox"].selected,l=[],m=this,n=[];for(d=0,e=k.length;e>d;d++)if(i[k[d]]&&i[k[d]].parents)for(f=0,g=i[k[d]].parents.length;g>f;f++){if(h[i[k[d]].parents[f]]!==b)break;i[k[d]].parents[f]!==a.jstree.root&&(h[i[k[d]].parents[f]]=!0,l.push(i[k[d]].parents[f]))}for(this.element.find(".jstree-closed").not(":has(.jstree-children)").each(function(){var c=m.get_node(this),j;if(c)if(c.state.loaded){for(d=0,e=c.children_d.length;e>d;d++)if(j=i[c.children_d[d]],!j.state.loaded&&j.original&&j.original.state&&j.original.state.undetermined&&j.original.state.undetermined===!0)for(h[j.id]===b&&j.id!==a.jstree.root&&(h[j.id]=!0,l.push(j.id)),f=0,g=j.parents.length;g>f;f++)h[j.parents[f]]===b&&j.parents[f]!==a.jstree.root&&(h[j.parents[f]]=!0,l.push(j.parents[f]))}else if(c.original&&c.original.state&&c.original.state.undetermined&&c.original.state.undetermined===!0)for(h[c.id]===b&&c.id!==a.jstree.root&&(h[c.id]=!0,l.push(c.id)),f=0,g=c.parents.length;g>f;f++)h[c.parents[f]]===b&&c.parents[f]!==a.jstree.root&&(h[c.parents[f]]=!0,l.push(c.parents[f]))}),d=0,e=l.length;e>d;d++)i[l[d]].state[j?"selected":"checked"]||n.push(c?i[l[d]]:l[d]);return n},this._undetermined=function(){if(null!==this.element){var a=this.get_undetermined(!1),b,c,d;for(this.element.find(".jstree-undetermined").removeClass("jstree-undetermined"),b=0,c=a.length;c>b;b++)d=this.get_node(a[b],!0),d&&d.length&&d.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-undetermined")}},this.redraw_node=function(b,c,e,f){if(b=d.redraw_node.apply(this,arguments)){var g,h,i=null,k=null;for(g=0,h=b.childNodes.length;h>g;g++)if(b.childNodes[g]&&b.childNodes[g].className&&-1!==b.childNodes[g].className.indexOf("jstree-anchor")){i=b.childNodes[g];break}i&&(!this.settings.checkbox.tie_selection&&this._model.data[b.id].state.checked&&(i.className+=" jstree-checked"),k=j.cloneNode(!1),this._model.data[b.id].state.checkbox_disabled&&(k.className+=" jstree-checkbox-disabled"),i.insertBefore(k,i.childNodes[0]))}return e||-1===this.settings.checkbox.cascade.indexOf("undetermined")||(this._data.checkbox.uto&&clearTimeout(this._data.checkbox.uto),this._data.checkbox.uto=setTimeout(a.proxy(this._undetermined,this),50)),b},this.show_checkboxes=function(){this._data.core.themes.checkboxes=!0,this.get_container_ul().removeClass("jstree-no-checkboxes")},this.hide_checkboxes=function(){this._data.core.themes.checkboxes=!1,this.get_container_ul().addClass("jstree-no-checkboxes")},this.toggle_checkboxes=function(){this._data.core.themes.checkboxes?this.hide_checkboxes():this.show_checkboxes()},this.is_undetermined=function(b){b=this.get_node(b);var c=this.settings.checkbox.cascade,d,e,f=this.settings.checkbox.tie_selection,g=this._data[f?"core":"checkbox"].selected,h=this._model.data;if(!b||b.state[f?"selected":"checked"]===!0||-1===c.indexOf("undetermined")||-1===c.indexOf("down")&&-1===c.indexOf("up"))return!1;if(!b.state.loaded&&b.original.state.undetermined===!0)return!0;for(d=0,e=b.children_d.length;e>d;d++)if(-1!==a.inArray(b.children_d[d],g)||!h[b.children_d[d]].state.loaded&&h[b.children_d[d]].original.state.undetermined)return!0;return!1},this.disable_checkbox=function(b){var c,d,e;if(a.isArray(b)){for(b=b.slice(),c=0,d=b.length;d>c;c++)this.disable_checkbox(b[c]);return!0}return b=this.get_node(b),b&&b.id!==a.jstree.root?(e=this.get_node(b,!0),void(b.state.checkbox_disabled||(b.state.checkbox_disabled=!0,e&&e.length&&e.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-checkbox-disabled"),this.trigger("disable_checkbox",{node:b})))):!1},this.enable_checkbox=function(b){var c,d,e;if(a.isArray(b)){for(b=b.slice(),c=0,d=b.length;d>c;c++)this.enable_checkbox(b[c]);return!0}return b=this.get_node(b),b&&b.id!==a.jstree.root?(e=this.get_node(b,!0),void(b.state.checkbox_disabled&&(b.state.checkbox_disabled=!1,e&&e.length&&e.children(".jstree-anchor").children(".jstree-checkbox").removeClass("jstree-checkbox-disabled"),this.trigger("enable_checkbox",{node:b})))):!1},this.activate_node=function(b,c){return a(c.target).hasClass("jstree-checkbox-disabled")?!1:(this.settings.checkbox.tie_selection&&(this.settings.checkbox.whole_node||a(c.target).hasClass("jstree-checkbox"))&&(c.ctrlKey=!0),this.settings.checkbox.tie_selection||!this.settings.checkbox.whole_node&&!a(c.target).hasClass("jstree-checkbox")?d.activate_node.call(this,b,c):this.is_disabled(b)?!1:(this.is_checked(b)?this.uncheck_node(b,c):this.check_node(b,c),void this.trigger("activate_node",{node:this.get_node(b)})))},this._cascade_new_checked_state=function(a,b){var c=this,d=this.settings.checkbox.tie_selection,e=this._model.data[a],f=[],g=[],h,i,j;if(!this.settings.checkbox.cascade_to_disabled&&e.state.disabled||!this.settings.checkbox.cascade_to_hidden&&e.state.hidden)j=this.get_checked_descendants(a),e.state[d?"selected":"checked"]&&j.push(e.id),f=f.concat(j);else{if(e.children)for(h=0,i=e.children.length;i>h;h++){var k=e.children[h];j=c._cascade_new_checked_state(k,b),f=f.concat(j),j.indexOf(k)>-1&&g.push(k)}var l=c.get_node(e,!0),m=g.length>0&&g.length<e.children.length;e.original&&e.original.state&&e.original.state.undetermined&&(e.original.state.undetermined=m),m?(e.state[d?"selected":"checked"]=!1,l.attr("aria-selected",!1).children(".jstree-anchor").removeClass(d?"jstree-clicked":"jstree-checked")):b&&g.length===e.children.length?(e.state[d?"selected":"checked"]=b,f.push(e.id),l.attr("aria-selected",!0).children(".jstree-anchor").addClass(d?"jstree-clicked":"jstree-checked")):(e.state[d?"selected":"checked"]=!1,l.attr("aria-selected",!1).children(".jstree-anchor").removeClass(d?"jstree-clicked":"jstree-checked"))}return f},this.get_checked_descendants=function(b){var c=this,d=c.settings.checkbox.tie_selection,e=c._model.data[b];return a.vakata.array_filter(e.children_d,function(a){return c._model.data[a].state[d?"selected":"checked"]})},this.check_node=function(b,c){if(this.settings.checkbox.tie_selection)return this.select_node(b,!1,!0,c);var d,e,f,g;if(a.isArray(b)){for(b=b.slice(),e=0,f=b.length;f>e;e++)this.check_node(b[e],c);return!0}return b=this.get_node(b),b&&b.id!==a.jstree.root?(d=this.get_node(b,!0),void(b.state.checked||(b.state.checked=!0,this._data.checkbox.selected.push(b.id),d&&d.length&&d.children(".jstree-anchor").addClass("jstree-checked"),this.trigger("check_node",{node:b,selected:this._data.checkbox.selected,event:c})))):!1},this.uncheck_node=function(b,c){if(this.settings.checkbox.tie_selection)return this.deselect_node(b,!1,c);var d,e,f;if(a.isArray(b)){for(b=b.slice(),d=0,e=b.length;e>d;d++)this.uncheck_node(b[d],c);return!0}return b=this.get_node(b),b&&b.id!==a.jstree.root?(f=this.get_node(b,!0),void(b.state.checked&&(b.state.checked=!1,this._data.checkbox.selected=a.vakata.array_remove_item(this._data.checkbox.selected,b.id),f.length&&f.children(".jstree-anchor").removeClass("jstree-checked"),this.trigger("uncheck_node",{node:b,selected:this._data.checkbox.selected,event:c})))):!1},this.check_all=function(){if(this.settings.checkbox.tie_selection)return this.select_all();var b=this._data.checkbox.selected.concat([]),c,d;for(this._data.checkbox.selected=this._model.data[a.jstree.root].children_d.concat(),c=0,d=this._data.checkbox.selected.length;d>c;c++)this._model.data[this._data.checkbox.selected[c]]&&(this._model.data[this._data.checkbox.selected[c]].state.checked=!0);this.redraw(!0),this.trigger("check_all",{selected:this._data.checkbox.selected})},this.uncheck_all=function(){if(this.settings.checkbox.tie_selection)return this.deselect_all();var a=this._data.checkbox.selected.concat([]),b,c;for(b=0,c=this._data.checkbox.selected.length;c>b;b++)this._model.data[this._data.checkbox.selected[b]]&&(this._model.data[this._data.checkbox.selected[b]].state.checked=!1);this._data.checkbox.selected=[],this.element.find(".jstree-checked").removeClass("jstree-checked"),this.trigger("uncheck_all",{selected:this._data.checkbox.selected,node:a})},this.is_checked=function(b){return this.settings.checkbox.tie_selection?this.is_selected(b):(b=this.get_node(b),b&&b.id!==a.jstree.root?b.state.checked:!1)},this.get_checked=function(b){return this.settings.checkbox.tie_selection?this.get_selected(b):b?a.map(this._data.checkbox.selected,a.proxy(function(a){return this.get_node(a)},this)):this._data.checkbox.selected.slice()},this.get_top_checked=function(b){if(this.settings.checkbox.tie_selection)return this.get_top_selected(b);var c=this.get_checked(!0),d={},e,f,g,h;for(e=0,f=c.length;f>e;e++)d[c[e].id]=c[e];for(e=0,f=c.length;f>e;e++)for(g=0,h=c[e].children_d.length;h>g;g++)d[c[e].children_d[g]]&&delete d[c[e].children_d[g]];c=[];for(e in d)d.hasOwnProperty(e)&&c.push(e);return b?a.map(c,a.proxy(function(a){return this.get_node(a)},this)):c},this.get_bottom_checked=function(b){if(this.settings.checkbox.tie_selection)return this.get_bottom_selected(b);var c=this.get_checked(!0),d=[],e,f;for(e=0,f=c.length;f>e;e++)c[e].children.length||d.push(c[e].id);return b?a.map(d,a.proxy(function(a){return this.get_node(a)},this)):d},this.load_node=function(b,c){var e,f,g,h,i,j;if(!a.isArray(b)&&!this.settings.checkbox.tie_selection&&(j=this.get_node(b),j&&j.state.loaded))for(e=0,f=j.children_d.length;f>e;e++)this._model.data[j.children_d[e]].state.checked&&(i=!0,this._data.checkbox.selected=a.vakata.array_remove_item(this._data.checkbox.selected,j.children_d[e]));return d.load_node.apply(this,arguments)},this.get_state=function(){var a=d.get_state.apply(this,arguments);return this.settings.checkbox.tie_selection?a:(a.checkbox=this._data.checkbox.selected.slice(),a)},this.set_state=function(b,c){var e=d.set_state.apply(this,arguments);if(e&&b.checkbox){if(!this.settings.checkbox.tie_selection){this.uncheck_all();var f=this;a.each(b.checkbox,function(a,b){f.check_node(b)})}return delete b.checkbox,this.set_state(b,c),!1}return e},this.refresh=function(a,b){return this.settings.checkbox.tie_selection&&(this._data.checkbox.selected=[]),d.refresh.apply(this,arguments)}},a.jstree.defaults.conditionalselect=function(){return!0},a.jstree.plugins.conditionalselect=function(a,b){this.activate_node=function(a,c){return this.settings.conditionalselect.call(this,this.get_node(a),c)?b.activate_node.call(this,a,c):void 0}},a.jstree.defaults.contextmenu={select_node:!0,show_at_node:!0,items:function(b,c){return{create:{separator_before:!1,separator_after:!0,_disabled:!1,label:"Create",action:function(b){var c=a.jstree.reference(b.reference),d=c.get_node(b.reference);c.create_node(d,{},"last",function(a){try{c.edit(a)}catch(b){setTimeout(function(){c.edit(a)},0)}})}},rename:{separator_before:!1,separator_after:!1,_disabled:!1,label:"Rename",action:function(b){var c=a.jstree.reference(b.reference),d=c.get_node(b.reference);c.edit(d)}},remove:{separator_before:!1,icon:!1,separator_after:!1,_disabled:!1,label:"Delete",action:function(b){var c=a.jstree.reference(b.reference),d=c.get_node(b.reference);c.is_selected(d)?c.delete_node(c.get_selected()):c.delete_node(d)}},ccp:{separator_before:!0,icon:!1,separator_after:!1,label:"Edit",action:!1,submenu:{cut:{separator_before:!1,separator_after:!1,label:"Cut",action:function(b){var c=a.jstree.reference(b.reference),d=c.get_node(b.reference);c.is_selected(d)?c.cut(c.get_top_selected()):c.cut(d)}},copy:{separator_before:!1,icon:!1,separator_after:!1,label:"Copy",action:function(b){var c=a.jstree.reference(b.reference),d=c.get_node(b.reference);c.is_selected(d)?c.copy(c.get_top_selected()):c.copy(d)}},paste:{separator_before:!1,icon:!1,_disabled:function(b){return!a.jstree.reference(b.reference).can_paste()},separator_after:!1,label:"Paste",action:function(b){var c=a.jstree.reference(b.reference),d=c.get_node(b.reference);c.paste(d)}}}}}}},a.jstree.plugins.contextmenu=function(c,d){this.bind=function(){d.bind.call(this);var b=0,c=null,e,f;this.element.on("init.jstree loading.jstree ready.jstree",a.proxy(function(){this.get_container_ul().addClass("jstree-contextmenu")},this)).on("contextmenu.jstree",".jstree-anchor",a.proxy(function(a,d){"input"!==a.target.tagName.toLowerCase()&&(a.preventDefault(),b=a.ctrlKey?+new Date:0,(d||c)&&(b=+new Date+1e4),c&&clearTimeout(c),this.is_loading(a.currentTarget)||this.show_contextmenu(a.currentTarget,a.pageX,a.pageY,a))},this)).on("click.jstree",".jstree-anchor",a.proxy(function(c){this._data.contextmenu.visible&&(!b||+new Date-b>250)&&a.vakata.context.hide(),b=0},this)).on("touchstart.jstree",".jstree-anchor",function(b){b.originalEvent&&b.originalEvent.changedTouches&&b.originalEvent.changedTouches[0]&&(e=b.originalEvent.changedTouches[0].clientX,f=b.originalEvent.changedTouches[0].clientY,c=setTimeout(function(){a(b.currentTarget).trigger("contextmenu",!0)},750))}).on("touchmove.vakata.jstree",function(b){c&&b.originalEvent&&b.originalEvent.changedTouches&&b.originalEvent.changedTouches[0]&&(Math.abs(e-b.originalEvent.changedTouches[0].clientX)>10||Math.abs(f-b.originalEvent.changedTouches[0].clientY)>10)&&(clearTimeout(c),a.vakata.context.hide())}).on("touchend.vakata.jstree",function(a){c&&clearTimeout(c)}),a(i).on("context_hide.vakata.jstree",a.proxy(function(b,c){this._data.contextmenu.visible=!1,a(c.reference).removeClass("jstree-context")},this))},this.teardown=function(){this._data.contextmenu.visible&&a.vakata.context.hide(),d.teardown.call(this)},this.show_contextmenu=function(c,d,e,f){if(c=this.get_node(c),!c||c.id===a.jstree.root)return!1;var g=this.settings.contextmenu,h=this.get_node(c,!0),i=h.children(".jstree-anchor"),j=!1,k=!1;(g.show_at_node||d===b||e===b)&&(j=i.offset(),d=j.left,e=j.top+this._data.core.li_height),this.settings.contextmenu.select_node&&!this.is_selected(c)&&this.activate_node(c,f),k=g.items,a.isFunction(k)&&(k=k.call(this,c,a.proxy(function(a){this._show_contextmenu(c,d,e,a)},this))),a.isPlainObject(k)&&this._show_contextmenu(c,d,e,k)},this._show_contextmenu=function(b,c,d,e){var f=this.get_node(b,!0),g=f.children(".jstree-anchor");a(i).one("context_show.vakata.jstree",a.proxy(function(b,c){var d="jstree-contextmenu jstree-"+this.get_theme()+"-contextmenu";a(c.element).addClass(d),g.addClass("jstree-context")},this)),this._data.contextmenu.visible=!0,a.vakata.context.show(g,{x:c,y:d},e),this.trigger("show_contextmenu",{node:b,x:c,y:d})}},function(a){var b=!1,c={element:!1,reference:!1,position_x:0,position_y:0,items:[],html:"",is_visible:!1};a.vakata.context={settings:{hide_onmouseleave:0,icons:!0},_trigger:function(b){a(i).triggerHandler("context_"+b+".vakata",{reference:c.reference,element:c.element,position:{x:c.position_x,y:c.position_y}})},_execute:function(b){return b=c.items[b],b&&(!b._disabled||a.isFunction(b._disabled)&&!b._disabled({item:b,reference:c.reference,element:c.element}))&&b.action?b.action.call(null,{item:b,reference:c.reference,element:c.element,position:{x:c.position_x,y:c.position_y}}):!1},_parse:function(b,d){if(!b)return!1;d||(c.html="",c.items=[]);var e="",f=!1,g;return d&&(e+="<ul>"),a.each(b,function(b,d){return d?(c.items.push(d),!f&&d.separator_before&&(e+="<li class='vakata-context-separator'><a href='#' "+(a.vakata.context.settings.icons?"":'style="margin-left:0px;"')+">&#160;</a></li>"),f=!1,e+="<li class='"+(d._class||"")+(d._disabled===!0||a.isFunction(d._disabled)&&d._disabled({item:d,reference:c.reference,element:c.element})?" vakata-contextmenu-disabled ":"")+"' "+(d.shortcut?" data-shortcut='"+d.shortcut+"' ":"")+">",e+="<a href='#' rel='"+(c.items.length-1)+"' "+(d.title?"title='"+d.title+"'":"")+">",a.vakata.context.settings.icons&&(e+="<i ",
d.icon&&(e+=-1!==d.icon.indexOf("/")||-1!==d.icon.indexOf(".")?" style='background:url(\""+d.icon+"\") center center no-repeat' ":" class='"+d.icon+"' "),e+="></i><span class='vakata-contextmenu-sep'>&#160;</span>"),e+=(a.isFunction(d.label)?d.label({item:b,reference:c.reference,element:c.element}):d.label)+(d.shortcut?' <span class="vakata-contextmenu-shortcut vakata-contextmenu-shortcut-'+d.shortcut+'">'+(d.shortcut_label||"")+"</span>":"")+"</a>",d.submenu&&(g=a.vakata.context._parse(d.submenu,!0),g&&(e+=g)),e+="</li>",void(d.separator_after&&(e+="<li class='vakata-context-separator'><a href='#' "+(a.vakata.context.settings.icons?"":'style="margin-left:0px;"')+">&#160;</a></li>",f=!0))):!0}),e=e.replace(/<li class\='vakata-context-separator'\><\/li\>$/,""),d&&(e+="</ul>"),d||(c.html=e,a.vakata.context._trigger("parse")),e.length>10?e:!1},_show_submenu:function(c){if(c=a(c),c.length&&c.children("ul").length){var d=c.children("ul"),e=c.offset().left,f=e+c.outerWidth(),g=c.offset().top,h=d.width(),i=d.height(),j=a(window).width()+a(window).scrollLeft(),k=a(window).height()+a(window).scrollTop();b?c[f-(h+10+c.outerWidth())<0?"addClass":"removeClass"]("vakata-context-left"):c[f+h>j&&e>j-f?"addClass":"removeClass"]("vakata-context-right"),g+i+10>k&&d.css("bottom","-1px"),c.hasClass("vakata-context-right")?h>e&&d.css("margin-right",e-h):h>j-f&&d.css("margin-left",j-f-h),d.show()}},show:function(d,e,f){var g,h,j,k,l,m,n,o,p=!0;switch(c.element&&c.element.length&&c.element.width(""),p){case!e&&!d:return!1;case!!e&&!!d:c.reference=d,c.position_x=e.x,c.position_y=e.y;break;case!e&&!!d:c.reference=d,g=d.offset(),c.position_x=g.left+d.outerHeight(),c.position_y=g.top;break;case!!e&&!d:c.position_x=e.x,c.position_y=e.y}d&&!f&&a(d).data("vakata_contextmenu")&&(f=a(d).data("vakata_contextmenu")),a.vakata.context._parse(f)&&c.element.html(c.html),c.items.length&&(c.element.appendTo(i.body),h=c.element,j=c.position_x,k=c.position_y,l=h.width(),m=h.height(),n=a(window).width()+a(window).scrollLeft(),o=a(window).height()+a(window).scrollTop(),b&&(j-=h.outerWidth()-a(d).outerWidth(),j<a(window).scrollLeft()+20&&(j=a(window).scrollLeft()+20)),j+l+20>n&&(j=n-(l+20)),k+m+20>o&&(k=o-(m+20)),c.element.css({left:j,top:k}).show().find("a").first().focus().parent().addClass("vakata-context-hover"),c.is_visible=!0,a.vakata.context._trigger("show"))},hide:function(){c.is_visible&&(c.element.hide().find("ul").hide().end().find(":focus").blur().end().detach(),c.is_visible=!1,a.vakata.context._trigger("hide"))}},a(function(){b="rtl"===a(i.body).css("direction");var d=!1;c.element=a("<ul class='vakata-context'></ul>"),c.element.on("mouseenter","li",function(b){b.stopImmediatePropagation(),a.contains(this,b.relatedTarget)||(d&&clearTimeout(d),c.element.find(".vakata-context-hover").removeClass("vakata-context-hover").end(),a(this).siblings().find("ul").hide().end().end().parentsUntil(".vakata-context","li").addBack().addClass("vakata-context-hover"),a.vakata.context._show_submenu(this))}).on("mouseleave","li",function(b){a.contains(this,b.relatedTarget)||a(this).find(".vakata-context-hover").addBack().removeClass("vakata-context-hover")}).on("mouseleave",function(b){a(this).find(".vakata-context-hover").removeClass("vakata-context-hover"),a.vakata.context.settings.hide_onmouseleave&&(d=setTimeout(function(b){return function(){a.vakata.context.hide()}}(this),a.vakata.context.settings.hide_onmouseleave))}).on("click","a",function(b){b.preventDefault(),a(this).blur().parent().hasClass("vakata-context-disabled")||a.vakata.context._execute(a(this).attr("rel"))===!1||a.vakata.context.hide()}).on("keydown","a",function(b){var d=null;switch(b.which){case 13:case 32:b.type="click",b.preventDefault(),a(b.currentTarget).trigger(b);break;case 37:c.is_visible&&(c.element.find(".vakata-context-hover").last().closest("li").first().find("ul").hide().find(".vakata-context-hover").removeClass("vakata-context-hover").end().end().children("a").focus(),b.stopImmediatePropagation(),b.preventDefault());break;case 38:c.is_visible&&(d=c.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").prevAll("li:not(.vakata-context-separator)").first(),d.length||(d=c.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").last()),d.addClass("vakata-context-hover").children("a").focus(),b.stopImmediatePropagation(),b.preventDefault());break;case 39:c.is_visible&&(c.element.find(".vakata-context-hover").last().children("ul").show().children("li:not(.vakata-context-separator)").removeClass("vakata-context-hover").first().addClass("vakata-context-hover").children("a").focus(),b.stopImmediatePropagation(),b.preventDefault());break;case 40:c.is_visible&&(d=c.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").nextAll("li:not(.vakata-context-separator)").first(),d.length||(d=c.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").first()),d.addClass("vakata-context-hover").children("a").focus(),b.stopImmediatePropagation(),b.preventDefault());break;case 27:a.vakata.context.hide(),b.preventDefault()}}).on("keydown",function(a){a.preventDefault();var b=c.element.find(".vakata-contextmenu-shortcut-"+a.which).parent();b.parent().not(".vakata-context-disabled")&&b.click()}),a(i).on("mousedown.vakata.jstree",function(b){c.is_visible&&c.element[0]!==b.target&&!a.contains(c.element[0],b.target)&&a.vakata.context.hide()}).on("context_show.vakata.jstree",function(a,d){c.element.find("li:has(ul)").children("a").addClass("vakata-context-parent"),b&&c.element.addClass("vakata-context-rtl").css("direction","rtl"),c.element.find("ul").hide().end()})})}(a),a.jstree.defaults.dnd={copy:!0,open_timeout:500,is_draggable:!0,check_while_dragging:!0,always_copy:!1,inside_pos:0,drag_selection:!0,touch:!0,large_drop_target:!1,large_drag_target:!1,use_html5:!1};var k,l;a.jstree.plugins.dnd=function(b,c){this.init=function(a,b){c.init.call(this,a,b),this.settings.dnd.use_html5=this.settings.dnd.use_html5&&"draggable"in i.createElement("span")},this.bind=function(){c.bind.call(this),this.element.on(this.settings.dnd.use_html5?"dragstart.jstree":"mousedown.jstree touchstart.jstree",this.settings.dnd.large_drag_target?".jstree-node":".jstree-anchor",a.proxy(function(b){if(this.settings.dnd.large_drag_target&&a(b.target).closest(".jstree-node")[0]!==b.currentTarget)return!0;if("touchstart"===b.type&&(!this.settings.dnd.touch||"selected"===this.settings.dnd.touch&&!a(b.currentTarget).closest(".jstree-node").children(".jstree-anchor").hasClass("jstree-clicked")))return!0;var c=this.get_node(b.target),d=this.is_selected(c)&&this.settings.dnd.drag_selection?this.get_top_selected().length:1,e=d>1?d+" "+this.get_string("nodes"):this.get_text(b.currentTarget);if(this.settings.core.force_text&&(e=a.vakata.html.escape(e)),c&&c.id&&c.id!==a.jstree.root&&(1===b.which||"touchstart"===b.type||"dragstart"===b.type)&&(this.settings.dnd.is_draggable===!0||a.isFunction(this.settings.dnd.is_draggable)&&this.settings.dnd.is_draggable.call(this,d>1?this.get_top_selected(!0):[c],b))){if(k={jstree:!0,origin:this,obj:this.get_node(c,!0),nodes:d>1?this.get_top_selected():[c.id]},l=b.currentTarget,!this.settings.dnd.use_html5)return this.element.trigger("mousedown.jstree"),a.vakata.dnd.start(b,k,'<div id="jstree-dnd" class="jstree-'+this.get_theme()+" jstree-"+this.get_theme()+"-"+this.get_theme_variant()+" "+(this.settings.core.themes.responsive?" jstree-dnd-responsive":"")+'"><i class="jstree-icon jstree-er"></i>'+e+'<ins class="jstree-copy" style="display:none;">+</ins></div>');a.vakata.dnd._trigger("start",b,{helper:a(),element:l,data:k})}},this)),this.settings.dnd.use_html5&&this.element.on("dragover.jstree",function(b){return b.preventDefault(),a.vakata.dnd._trigger("move",b,{helper:a(),element:l,data:k}),!1}).on("drop.jstree",a.proxy(function(b){return b.preventDefault(),a.vakata.dnd._trigger("stop",b,{helper:a(),element:l,data:k}),!1},this))},this.redraw_node=function(a,b,d,e){if(a=c.redraw_node.apply(this,arguments),a&&this.settings.dnd.use_html5)if(this.settings.dnd.large_drag_target)a.setAttribute("draggable",!0);else{var f,g,h=null;for(f=0,g=a.childNodes.length;g>f;f++)if(a.childNodes[f]&&a.childNodes[f].className&&-1!==a.childNodes[f].className.indexOf("jstree-anchor")){h=a.childNodes[f];break}h&&h.setAttribute("draggable",!0)}return a}},a(function(){var c=!1,d=!1,e=!1,f=!1,g=a('<div id="jstree-marker">&#160;</div>').hide();a(i).on("dragover.vakata.jstree",function(b){l&&a.vakata.dnd._trigger("move",b,{helper:a(),element:l,data:k})}).on("drop.vakata.jstree",function(b){l&&(a.vakata.dnd._trigger("stop",b,{helper:a(),element:l,data:k}),l=null,k=null)}).on("dnd_start.vakata.jstree",function(a,b){c=!1,e=!1,b&&b.data&&b.data.jstree&&g.appendTo(i.body)}).on("dnd_move.vakata.jstree",function(h,i){var j=i.event.target!==e.target;if(f&&(!i.event||"dragover"!==i.event.type||j)&&clearTimeout(f),i&&i.data&&i.data.jstree&&(!i.event.target.id||"jstree-marker"!==i.event.target.id)){e=i.event;var k=a.jstree.reference(i.event.target),l=!1,m=!1,n=!1,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E;if(k&&k._data&&k._data.dnd)if(g.attr("class","jstree-"+k.get_theme()+(k.settings.core.themes.responsive?" jstree-dnd-responsive":"")),D=i.data.origin&&(i.data.origin.settings.dnd.always_copy||i.data.origin.settings.dnd.copy&&(i.event.metaKey||i.event.ctrlKey)),i.helper.children().attr("class","jstree-"+k.get_theme()+" jstree-"+k.get_theme()+"-"+k.get_theme_variant()+" "+(k.settings.core.themes.responsive?" jstree-dnd-responsive":"")).find(".jstree-copy").first()[D?"show":"hide"](),i.event.target!==k.element[0]&&i.event.target!==k.get_container_ul()[0]||0!==k.get_container_ul().children().length){if(l=k.settings.dnd.large_drop_target?a(i.event.target).closest(".jstree-node").children(".jstree-anchor"):a(i.event.target).closest(".jstree-anchor"),l&&l.length&&l.parent().is(".jstree-closed, .jstree-open, .jstree-leaf")&&(m=l.offset(),n=(i.event.pageY!==b?i.event.pageY:i.event.originalEvent.pageY)-m.top,r=l.outerHeight(),u=r/3>n?["b","i","a"]:n>r-r/3?["a","i","b"]:n>r/2?["i","a","b"]:["i","b","a"],a.each(u,function(b,e){switch(e){case"b":p=m.left-6,q=m.top,s=k.get_parent(l),t=l.parent().index();break;case"i":B=k.settings.dnd.inside_pos,C=k.get_node(l.parent()),p=m.left-2,q=m.top+r/2+1,s=C.id,t="first"===B?0:"last"===B?C.children.length:Math.min(B,C.children.length);break;case"a":p=m.left-6,q=m.top+r,s=k.get_parent(l),t=l.parent().index()+1}for(v=!0,w=0,x=i.data.nodes.length;x>w;w++)if(y=i.data.origin&&(i.data.origin.settings.dnd.always_copy||i.data.origin.settings.dnd.copy&&(i.event.metaKey||i.event.ctrlKey))?"copy_node":"move_node",z=t,"move_node"===y&&"a"===e&&i.data.origin&&i.data.origin===k&&s===k.get_parent(i.data.nodes[w])&&(A=k.get_node(s),z>a.inArray(i.data.nodes[w],A.children)&&(z-=1)),v=v&&(k&&k.settings&&k.settings.dnd&&k.settings.dnd.check_while_dragging===!1||k.check(y,i.data.origin&&i.data.origin!==k?i.data.origin.get_node(i.data.nodes[w]):i.data.nodes[w],s,z,{dnd:!0,ref:k.get_node(l.parent()),pos:e,origin:i.data.origin,is_multi:i.data.origin&&i.data.origin!==k,is_foreign:!i.data.origin})),!v){k&&k.last_error&&(d=k.last_error());break}return"i"===e&&l.parent().is(".jstree-closed")&&k.settings.dnd.open_timeout&&(!i.event||"dragover"!==i.event.type||j)&&(f&&clearTimeout(f),f=setTimeout(function(a,b){return function(){a.open_node(b)}}(k,l),k.settings.dnd.open_timeout)),v?(E=k.get_node(s,!0),E.hasClass(".jstree-dnd-parent")||(a(".jstree-dnd-parent").removeClass("jstree-dnd-parent"),E.addClass("jstree-dnd-parent")),c={ins:k,par:s,pos:"i"!==e||"last"!==B||0!==t||k.is_loaded(C)?t:"last"},g.css({left:p+"px",top:q+"px"}).show(),i.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok"),i.event.originalEvent&&i.event.originalEvent.dataTransfer&&(i.event.originalEvent.dataTransfer.dropEffect=D?"copy":"move"),d={},u=!0,!1):void 0}),u===!0))return}else{for(v=!0,w=0,x=i.data.nodes.length;x>w;w++)if(v=v&&k.check(i.data.origin&&(i.data.origin.settings.dnd.always_copy||i.data.origin.settings.dnd.copy&&(i.event.metaKey||i.event.ctrlKey))?"copy_node":"move_node",i.data.origin&&i.data.origin!==k?i.data.origin.get_node(i.data.nodes[w]):i.data.nodes[w],a.jstree.root,"last",{dnd:!0,ref:k.get_node(a.jstree.root),pos:"i",origin:i.data.origin,is_multi:i.data.origin&&i.data.origin!==k,is_foreign:!i.data.origin}),!v)break;if(v)return c={ins:k,par:a.jstree.root,pos:"last"},g.hide(),i.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok"),void(i.event.originalEvent&&i.event.originalEvent.dataTransfer&&(i.event.originalEvent.dataTransfer.dropEffect=D?"copy":"move"))}a(".jstree-dnd-parent").removeClass("jstree-dnd-parent"),c=!1,i.helper.find(".jstree-icon").removeClass("jstree-ok").addClass("jstree-er"),i.event.originalEvent&&i.event.originalEvent.dataTransfer,g.hide()}}).on("dnd_scroll.vakata.jstree",function(a,b){b&&b.data&&b.data.jstree&&(g.hide(),c=!1,e=!1,b.helper.find(".jstree-icon").first().removeClass("jstree-ok").addClass("jstree-er"))}).on("dnd_stop.vakata.jstree",function(b,h){if(a(".jstree-dnd-parent").removeClass("jstree-dnd-parent"),f&&clearTimeout(f),h&&h.data&&h.data.jstree){g.hide().detach();var i,j,k=[];if(c){for(i=0,j=h.data.nodes.length;j>i;i++)k[i]=h.data.origin?h.data.origin.get_node(h.data.nodes[i]):h.data.nodes[i];c.ins[h.data.origin&&(h.data.origin.settings.dnd.always_copy||h.data.origin.settings.dnd.copy&&(h.event.metaKey||h.event.ctrlKey))?"copy_node":"move_node"](k,c.par,c.pos,!1,!1,!1,h.data.origin)}else i=a(h.event.target).closest(".jstree"),i.length&&d&&d.error&&"check"===d.error&&(i=i.jstree(!0),i&&i.settings.core.error.call(this,d));e=!1,c=!1}}).on("keyup.jstree keydown.jstree",function(b,h){h=a.vakata.dnd._get(),h&&h.data&&h.data.jstree&&("keyup"===b.type&&27===b.which?(f&&clearTimeout(f),c=!1,d=!1,e=!1,f=!1,g.hide().detach(),a.vakata.dnd._clean()):(h.helper.find(".jstree-copy").first()[h.data.origin&&(h.data.origin.settings.dnd.always_copy||h.data.origin.settings.dnd.copy&&(b.metaKey||b.ctrlKey))?"show":"hide"](),e&&(e.metaKey=b.metaKey,e.ctrlKey=b.ctrlKey,a.vakata.dnd._trigger("move",e))))})}),function(a){a.vakata.html={div:a("<div />"),escape:function(b){return a.vakata.html.div.text(b).html()},strip:function(b){return a.vakata.html.div.empty().append(a.parseHTML(b)).text()}};var c={element:!1,target:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1,is_touch:!1};a.vakata.dnd={settings:{scroll_speed:10,scroll_proximity:20,helper_left:5,helper_top:10,threshold:5,threshold_touch:10},_trigger:function(c,d,e){e===b&&(e=a.vakata.dnd._get()),e.event=d,a(i).triggerHandler("dnd_"+c+".vakata",e)},_get:function(){return{data:c.data,element:c.element,helper:c.helper}},_clean:function(){c.helper&&c.helper.remove(),c.scroll_i&&(clearInterval(c.scroll_i),c.scroll_i=!1),c={element:!1,target:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1,is_touch:!1},a(i).off("mousemove.vakata.jstree touchmove.vakata.jstree",a.vakata.dnd.drag),a(i).off("mouseup.vakata.jstree touchend.vakata.jstree",a.vakata.dnd.stop)},_scroll:function(b){if(!c.scroll_e||!c.scroll_l&&!c.scroll_t)return c.scroll_i&&(clearInterval(c.scroll_i),c.scroll_i=!1),!1;if(!c.scroll_i)return c.scroll_i=setInterval(a.vakata.dnd._scroll,100),!1;if(b===!0)return!1;var d=c.scroll_e.scrollTop(),e=c.scroll_e.scrollLeft();c.scroll_e.scrollTop(d+c.scroll_t*a.vakata.dnd.settings.scroll_speed),c.scroll_e.scrollLeft(e+c.scroll_l*a.vakata.dnd.settings.scroll_speed),(d!==c.scroll_e.scrollTop()||e!==c.scroll_e.scrollLeft())&&a.vakata.dnd._trigger("scroll",c.scroll_e)},start:function(b,d,e){"touchstart"===b.type&&b.originalEvent&&b.originalEvent.changedTouches&&b.originalEvent.changedTouches[0]&&(b.pageX=b.originalEvent.changedTouches[0].pageX,b.pageY=b.originalEvent.changedTouches[0].pageY,b.target=i.elementFromPoint(b.originalEvent.changedTouches[0].pageX-window.pageXOffset,b.originalEvent.changedTouches[0].pageY-window.pageYOffset)),c.is_drag&&a.vakata.dnd.stop({});try{b.currentTarget.unselectable="on",b.currentTarget.onselectstart=function(){return!1},b.currentTarget.style&&(b.currentTarget.style.touchAction="none",b.currentTarget.style.msTouchAction="none",b.currentTarget.style.MozUserSelect="none")}catch(f){}return c.init_x=b.pageX,c.init_y=b.pageY,c.data=d,c.is_down=!0,c.element=b.currentTarget,c.target=b.target,c.is_touch="touchstart"===b.type,e!==!1&&(c.helper=a("<div id='vakata-dnd'></div>").html(e).css({display:"block",margin:"0",padding:"0",position:"absolute",top:"-2000px",lineHeight:"16px",zIndex:"10000"})),a(i).on("mousemove.vakata.jstree touchmove.vakata.jstree",a.vakata.dnd.drag),a(i).on("mouseup.vakata.jstree touchend.vakata.jstree",a.vakata.dnd.stop),!1},drag:function(b){if("touchmove"===b.type&&b.originalEvent&&b.originalEvent.changedTouches&&b.originalEvent.changedTouches[0]&&(b.pageX=b.originalEvent.changedTouches[0].pageX,b.pageY=b.originalEvent.changedTouches[0].pageY,b.target=i.elementFromPoint(b.originalEvent.changedTouches[0].pageX-window.pageXOffset,b.originalEvent.changedTouches[0].pageY-window.pageYOffset)),c.is_down){if(!c.is_drag){if(!(Math.abs(b.pageX-c.init_x)>(c.is_touch?a.vakata.dnd.settings.threshold_touch:a.vakata.dnd.settings.threshold)||Math.abs(b.pageY-c.init_y)>(c.is_touch?a.vakata.dnd.settings.threshold_touch:a.vakata.dnd.settings.threshold)))return;c.helper&&(c.helper.appendTo(i.body),c.helper_w=c.helper.outerWidth()),c.is_drag=!0,a(c.target).one("click.vakata",!1),a.vakata.dnd._trigger("start",b)}var d=!1,e=!1,f=!1,g=!1,h=!1,j=!1,k=!1,l=!1,m=!1,n=!1;return c.scroll_t=0,c.scroll_l=0,c.scroll_e=!1,a(a(b.target).parentsUntil("body").addBack().get().reverse()).filter(function(){return/^auto|scroll$/.test(a(this).css("overflow"))&&(this.scrollHeight>this.offsetHeight||this.scrollWidth>this.offsetWidth)}).each(function(){var d=a(this),e=d.offset();return this.scrollHeight>this.offsetHeight&&(e.top+d.height()-b.pageY<a.vakata.dnd.settings.scroll_proximity&&(c.scroll_t=1),b.pageY-e.top<a.vakata.dnd.settings.scroll_proximity&&(c.scroll_t=-1)),this.scrollWidth>this.offsetWidth&&(e.left+d.width()-b.pageX<a.vakata.dnd.settings.scroll_proximity&&(c.scroll_l=1),b.pageX-e.left<a.vakata.dnd.settings.scroll_proximity&&(c.scroll_l=-1)),c.scroll_t||c.scroll_l?(c.scroll_e=a(this),!1):void 0}),c.scroll_e||(d=a(i),e=a(window),f=d.height(),g=e.height(),h=d.width(),j=e.width(),k=d.scrollTop(),l=d.scrollLeft(),f>g&&b.pageY-k<a.vakata.dnd.settings.scroll_proximity&&(c.scroll_t=-1),f>g&&g-(b.pageY-k)<a.vakata.dnd.settings.scroll_proximity&&(c.scroll_t=1),h>j&&b.pageX-l<a.vakata.dnd.settings.scroll_proximity&&(c.scroll_l=-1),h>j&&j-(b.pageX-l)<a.vakata.dnd.settings.scroll_proximity&&(c.scroll_l=1),(c.scroll_t||c.scroll_l)&&(c.scroll_e=d)),c.scroll_e&&a.vakata.dnd._scroll(!0),c.helper&&(m=parseInt(b.pageY+a.vakata.dnd.settings.helper_top,10),n=parseInt(b.pageX+a.vakata.dnd.settings.helper_left,10),f&&m+25>f&&(m=f-50),h&&n+c.helper_w>h&&(n=h-(c.helper_w+2)),c.helper.css({left:n+"px",top:m+"px"})),a.vakata.dnd._trigger("move",b),!1}},stop:function(b){if("touchend"===b.type&&b.originalEvent&&b.originalEvent.changedTouches&&b.originalEvent.changedTouches[0]&&(b.pageX=b.originalEvent.changedTouches[0].pageX,b.pageY=b.originalEvent.changedTouches[0].pageY,b.target=i.elementFromPoint(b.originalEvent.changedTouches[0].pageX-window.pageXOffset,b.originalEvent.changedTouches[0].pageY-window.pageYOffset)),c.is_drag)b.target!==c.target&&a(c.target).off("click.vakata"),a.vakata.dnd._trigger("stop",b);else if("touchend"===b.type&&b.target===c.target){var d=setTimeout(function(){a(b.target).click()},100);a(b.target).one("click",function(){d&&clearTimeout(d)})}return a.vakata.dnd._clean(),!1}}}(a),a.jstree.defaults.massload=null,a.jstree.plugins.massload=function(b,c){this.init=function(a,b){this._data.massload={},c.init.call(this,a,b)},this._load_nodes=function(b,d,e,f){var g=this.settings.massload,h=JSON.stringify(b),i=[],j=this._model.data,k,l,m;if(!e){for(k=0,l=b.length;l>k;k++)(!j[b[k]]||!j[b[k]].state.loaded&&!j[b[k]].state.failed||f)&&(i.push(b[k]),m=this.get_node(b[k],!0),m&&m.length&&m.addClass("jstree-loading").attr("aria-busy",!0));if(this._data.massload={},i.length){if(a.isFunction(g))return g.call(this,i,a.proxy(function(a){var g,h;if(a)for(g in a)a.hasOwnProperty(g)&&(this._data.massload[g]=a[g]);for(g=0,h=b.length;h>g;g++)m=this.get_node(b[g],!0),m&&m.length&&m.removeClass("jstree-loading").attr("aria-busy",!1);c._load_nodes.call(this,b,d,e,f)},this));if("object"==typeof g&&g&&g.url)return g=a.extend(!0,{},g),a.isFunction(g.url)&&(g.url=g.url.call(this,i)),a.isFunction(g.data)&&(g.data=g.data.call(this,i)),a.ajax(g).done(a.proxy(function(a,g,h){var i,j;if(a)for(i in a)a.hasOwnProperty(i)&&(this._data.massload[i]=a[i]);for(i=0,j=b.length;j>i;i++)m=this.get_node(b[i],!0),m&&m.length&&m.removeClass("jstree-loading").attr("aria-busy",!1);c._load_nodes.call(this,b,d,e,f)},this)).fail(a.proxy(function(a){c._load_nodes.call(this,b,d,e,f)},this))}}return c._load_nodes.call(this,b,d,e,f)},this._load_node=function(b,d){var e=this._data.massload[b.id],f=null,g;return e?(f=this["string"==typeof e?"_append_html_data":"_append_json_data"](b,"string"==typeof e?a(a.parseHTML(e)).filter(function(){return 3!==this.nodeType}):e,function(a){d.call(this,a)}),g=this.get_node(b.id,!0),g&&g.length&&g.removeClass("jstree-loading").attr("aria-busy",!1),delete this._data.massload[b.id],f):c._load_node.call(this,b,d)}},a.jstree.defaults.search={ajax:!1,fuzzy:!1,case_sensitive:!1,show_only_matches:!1,show_only_matches_children:!1,close_opened_onclear:!0,search_leaves_only:!1,search_callback:!1},a.jstree.plugins.search=function(c,d){this.bind=function(){d.bind.call(this),this._data.search.str="",this._data.search.dom=a(),this._data.search.res=[],this._data.search.opn=[],this._data.search.som=!1,this._data.search.smc=!1,this._data.search.hdn=[],this.element.on("search.jstree",a.proxy(function(b,c){if(this._data.search.som&&c.res.length){var d=this._model.data,e,f,g=[],h,i;for(e=0,f=c.res.length;f>e;e++)if(d[c.res[e]]&&!d[c.res[e]].state.hidden&&(g.push(c.res[e]),g=g.concat(d[c.res[e]].parents),this._data.search.smc))for(h=0,i=d[c.res[e]].children_d.length;i>h;h++)d[d[c.res[e]].children_d[h]]&&!d[d[c.res[e]].children_d[h]].state.hidden&&g.push(d[c.res[e]].children_d[h]);g=a.vakata.array_remove_item(a.vakata.array_unique(g),a.jstree.root),this._data.search.hdn=this.hide_all(!0),this.show_node(g,!0),this.redraw(!0)}},this)).on("clear_search.jstree",a.proxy(function(a,b){this._data.search.som&&b.res.length&&(this.show_node(this._data.search.hdn,!0),this.redraw(!0))},this))},this.search=function(c,d,e,f,g,h){if(c===!1||""===a.trim(c.toString()))return this.clear_search();f=this.get_node(f),f=f&&f.id?f.id:null,c=c.toString();var i=this.settings.search,j=i.ajax?i.ajax:!1,k=this._model.data,l=null,m=[],n=[],o,p;if(this._data.search.res.length&&!g&&this.clear_search(),e===b&&(e=i.show_only_matches),h===b&&(h=i.show_only_matches_children),!d&&j!==!1)return a.isFunction(j)?j.call(this,c,a.proxy(function(b){b&&b.d&&(b=b.d),this._load_nodes(a.isArray(b)?a.vakata.array_unique(b):[],function(){this.search(c,!0,e,f,g,h)})},this),f):(j=a.extend({},j),j.data||(j.data={}),j.data.str=c,f&&(j.data.inside=f),this._data.search.lastRequest&&this._data.search.lastRequest.abort(),this._data.search.lastRequest=a.ajax(j).fail(a.proxy(function(){this._data.core.last_error={error:"ajax",plugin:"search",id:"search_01",reason:"Could not load search parents",data:JSON.stringify(j)},this.settings.core.error.call(this,this._data.core.last_error)},this)).done(a.proxy(function(b){b&&b.d&&(b=b.d),this._load_nodes(a.isArray(b)?a.vakata.array_unique(b):[],function(){this.search(c,!0,e,f,g,h)})},this)),this._data.search.lastRequest);if(g||(this._data.search.str=c,this._data.search.dom=a(),this._data.search.res=[],this._data.search.opn=[],this._data.search.som=e,this._data.search.smc=h),l=new a.vakata.search(c,!0,{caseSensitive:i.case_sensitive,fuzzy:i.fuzzy}),a.each(k[f?f:a.jstree.root].children_d,function(a,b){var d=k[b];d.text&&!d.state.hidden&&(!i.search_leaves_only||d.state.loaded&&0===d.children.length)&&(i.search_callback&&i.search_callback.call(this,c,d)||!i.search_callback&&l.search(d.text).isMatch)&&(m.push(b),n=n.concat(d.parents))}),m.length){for(n=a.vakata.array_unique(n),o=0,p=n.length;p>o;o++)n[o]!==a.jstree.root&&k[n[o]]&&this.open_node(n[o],null,0)===!0&&this._data.search.opn.push(n[o]);g?(this._data.search.dom=this._data.search.dom.add(a(this.element[0].querySelectorAll("#"+a.map(m,function(b){return-1!=="0123456789".indexOf(b[0])?"\\3"+b[0]+" "+b.substr(1).replace(a.jstree.idregex,"\\$&"):b.replace(a.jstree.idregex,"\\$&")}).join(", #")))),this._data.search.res=a.vakata.array_unique(this._data.search.res.concat(m))):(this._data.search.dom=a(this.element[0].querySelectorAll("#"+a.map(m,function(b){return-1!=="0123456789".indexOf(b[0])?"\\3"+b[0]+" "+b.substr(1).replace(a.jstree.idregex,"\\$&"):b.replace(a.jstree.idregex,"\\$&")}).join(", #"))),this._data.search.res=m),this._data.search.dom.children(".jstree-anchor").addClass("jstree-search")}this.trigger("search",{nodes:this._data.search.dom,str:c,res:this._data.search.res,show_only_matches:e})},this.clear_search=function(){this.settings.search.close_opened_onclear&&this.close_node(this._data.search.opn,0),this.trigger("clear_search",{nodes:this._data.search.dom,str:this._data.search.str,res:this._data.search.res}),this._data.search.res.length&&(this._data.search.dom=a(this.element[0].querySelectorAll("#"+a.map(this._data.search.res,function(b){return-1!=="0123456789".indexOf(b[0])?"\\3"+b[0]+" "+b.substr(1).replace(a.jstree.idregex,"\\$&"):b.replace(a.jstree.idregex,"\\$&")}).join(", #"))),this._data.search.dom.children(".jstree-anchor").removeClass("jstree-search")),this._data.search.str="",this._data.search.res=[],this._data.search.opn=[],this._data.search.dom=a()},this.redraw_node=function(b,c,e,f){if(b=d.redraw_node.apply(this,arguments),b&&-1!==a.inArray(b.id,this._data.search.res)){var g,h,i=null;for(g=0,h=b.childNodes.length;h>g;g++)if(b.childNodes[g]&&b.childNodes[g].className&&-1!==b.childNodes[g].className.indexOf("jstree-anchor")){i=b.childNodes[g];break}i&&(i.className+=" jstree-search")}return b}},function(a){a.vakata.search=function(b,c,d){d=d||{},d=a.extend({},a.vakata.search.defaults,d),d.fuzzy!==!1&&(d.fuzzy=!0),b=d.caseSensitive?b:b.toLowerCase();var e=d.location,f=d.distance,g=d.threshold,h=b.length,i,j,k,l;return h>32&&(d.fuzzy=!1),d.fuzzy&&(i=1<<h-1,j=function(){var a={},c=0;for(c=0;h>c;c++)a[b.charAt(c)]=0;for(c=0;h>c;c++)a[b.charAt(c)]|=1<<h-c-1;return a}(),k=function(a,b){var c=a/h,d=Math.abs(e-b);return f?c+d/f:d?1:c}),l=function(a){if(a=d.caseSensitive?a:a.toLowerCase(),b===a||-1!==a.indexOf(b))return{isMatch:!0,score:0};if(!d.fuzzy)return{isMatch:!1,score:1};var c,f,l=a.length,m=g,n=a.indexOf(b,e),o,p,q=h+l,r,s,t,u,v,w=1,x=[];for(-1!==n&&(m=Math.min(k(0,n),m),n=a.lastIndexOf(b,e+h),-1!==n&&(m=Math.min(k(0,n),m))),n=-1,c=0;h>c;c++){o=0,p=q;while(p>o)k(c,e+p)<=m?o=p:q=p,p=Math.floor((q-o)/2+o);for(q=p,s=Math.max(1,e-p+1),t=Math.min(e+p,l)+h,u=new Array(t+2),u[t+1]=(1<<c)-1,f=t;f>=s;f--)if(v=j[a.charAt(f-1)],0===c?u[f]=(u[f+1]<<1|1)&v:u[f]=(u[f+1]<<1|1)&v|((r[f+1]|r[f])<<1|1)|r[f+1],u[f]&i&&(w=k(c,f-1),m>=w)){if(m=w,n=f-1,x.push(n),!(n>e))break;s=Math.max(1,2*e-n)}if(k(c+1,e)>m)break;r=u}return{isMatch:n>=0,score:w}},c===!0?{search:l}:l(c)},a.vakata.search.defaults={location:0,distance:100,threshold:.6,fuzzy:!1,caseSensitive:!1}}(a),a.jstree.defaults.sort=function(a,b){return this.get_text(a)>this.get_text(b)?1:-1},a.jstree.plugins.sort=function(b,c){this.bind=function(){c.bind.call(this),this.element.on("model.jstree",a.proxy(function(a,b){this.sort(b.parent,!0)},this)).on("rename_node.jstree create_node.jstree",a.proxy(function(a,b){this.sort(b.parent||b.node.parent,!1),this.redraw_node(b.parent||b.node.parent,!0)},this)).on("move_node.jstree copy_node.jstree",a.proxy(function(a,b){this.sort(b.parent,!1),this.redraw_node(b.parent,!0)},this))},this.sort=function(b,c){var d,e;if(b=this.get_node(b),b&&b.children&&b.children.length&&(b.children.sort(a.proxy(this.settings.sort,this)),c))for(d=0,e=b.children_d.length;e>d;d++)this.sort(b.children_d[d],!1)}};var m=!1;a.jstree.defaults.state={key:"jstree",events:"changed.jstree open_node.jstree close_node.jstree check_node.jstree uncheck_node.jstree",ttl:!1,filter:!1,preserve_loaded:!1},a.jstree.plugins.state=function(b,c){this.bind=function(){c.bind.call(this);var b=a.proxy(function(){this.element.on(this.settings.state.events,a.proxy(function(){m&&clearTimeout(m),m=setTimeout(a.proxy(function(){this.save_state()},this),100)},this)),this.trigger("state_ready")},this);this.element.on("ready.jstree",a.proxy(function(a,c){this.element.one("restore_state.jstree",b),this.restore_state()||b()},this))},this.save_state=function(){var b=this.get_state();this.settings.state.preserve_loaded||delete b.core.loaded;var c={state:b,ttl:this.settings.state.ttl,sec:+new Date};a.vakata.storage.set(this.settings.state.key,JSON.stringify(c))},this.restore_state=function(){var b=a.vakata.storage.get(this.settings.state.key);if(b)try{b=JSON.parse(b)}catch(c){return!1}return b&&b.ttl&&b.sec&&+new Date-b.sec>b.ttl?!1:(b&&b.state&&(b=b.state),b&&a.isFunction(this.settings.state.filter)&&(b=this.settings.state.filter.call(this,b)),b?(this.settings.state.preserve_loaded||delete b.core.loaded,this.element.one("set_state.jstree",function(c,d){d.instance.trigger("restore_state",{state:a.extend(!0,{},b)})}),this.set_state(b),!0):!1)},this.clear_state=function(){return a.vakata.storage.del(this.settings.state.key)}},function(a,b){a.vakata.storage={set:function(a,b){return window.localStorage.setItem(a,b)},get:function(a){return window.localStorage.getItem(a)},del:function(a){return window.localStorage.removeItem(a)}}}(a),a.jstree.defaults.types={"default":{}},a.jstree.defaults.types[a.jstree.root]={},a.jstree.plugins.types=function(c,d){this.init=function(c,e){var f,g;if(e&&e.types&&e.types["default"])for(f in e.types)if("default"!==f&&f!==a.jstree.root&&e.types.hasOwnProperty(f))for(g in e.types["default"])e.types["default"].hasOwnProperty(g)&&e.types[f][g]===b&&(e.types[f][g]=e.types["default"][g]);d.init.call(this,c,e),this._model.data[a.jstree.root].type=a.jstree.root},this.refresh=function(b,c){d.refresh.call(this,b,c),this._model.data[a.jstree.root].type=a.jstree.root},this.bind=function(){this.element.on("model.jstree",a.proxy(function(c,d){var e=this._model.data,f=d.nodes,g=this.settings.types,h,i,j="default",k;for(h=0,i=f.length;i>h;h++){if(j="default",e[f[h]].original&&e[f[h]].original.type&&g[e[f[h]].original.type]&&(j=e[f[h]].original.type),e[f[h]].data&&e[f[h]].data.jstree&&e[f[h]].data.jstree.type&&g[e[f[h]].data.jstree.type]&&(j=e[f[h]].data.jstree.type),e[f[h]].type=j,e[f[h]].icon===!0&&g[j].icon!==b&&(e[f[h]].icon=g[j].icon),g[j].li_attr!==b&&"object"==typeof g[j].li_attr)for(k in g[j].li_attr)if(g[j].li_attr.hasOwnProperty(k)){if("id"===k)continue;e[f[h]].li_attr[k]===b?e[f[h]].li_attr[k]=g[j].li_attr[k]:"class"===k&&(e[f[h]].li_attr["class"]=g[j].li_attr["class"]+" "+e[f[h]].li_attr["class"])}if(g[j].a_attr!==b&&"object"==typeof g[j].a_attr)for(k in g[j].a_attr)if(g[j].a_attr.hasOwnProperty(k)){if("id"===k)continue;e[f[h]].a_attr[k]===b?e[f[h]].a_attr[k]=g[j].a_attr[k]:"href"===k&&"#"===e[f[h]].a_attr[k]?e[f[h]].a_attr.href=g[j].a_attr.href:"class"===k&&(e[f[h]].a_attr["class"]=g[j].a_attr["class"]+" "+e[f[h]].a_attr["class"])}}e[a.jstree.root].type=a.jstree.root},this)),d.bind.call(this)},this.get_json=function(b,c,e){var f,g,h=this._model.data,i=c?a.extend(!0,{},c,{no_id:!1}):{},j=d.get_json.call(this,b,i,e);if(j===!1)return!1;if(a.isArray(j))for(f=0,g=j.length;g>f;f++)j[f].type=j[f].id&&h[j[f].id]&&h[j[f].id].type?h[j[f].id].type:"default",
c&&c.no_id&&(delete j[f].id,j[f].li_attr&&j[f].li_attr.id&&delete j[f].li_attr.id,j[f].a_attr&&j[f].a_attr.id&&delete j[f].a_attr.id);else j.type=j.id&&h[j.id]&&h[j.id].type?h[j.id].type:"default",c&&c.no_id&&(j=this._delete_ids(j));return j},this._delete_ids=function(b){if(a.isArray(b)){for(var c=0,d=b.length;d>c;c++)b[c]=this._delete_ids(b[c]);return b}return delete b.id,b.li_attr&&b.li_attr.id&&delete b.li_attr.id,b.a_attr&&b.a_attr.id&&delete b.a_attr.id,b.children&&a.isArray(b.children)&&(b.children=this._delete_ids(b.children)),b},this.check=function(c,e,f,g,h){if(d.check.call(this,c,e,f,g,h)===!1)return!1;e=e&&e.id?e:this.get_node(e),f=f&&f.id?f:this.get_node(f);var i=e&&e.id?h&&h.origin?h.origin:a.jstree.reference(e.id):null,j,k,l,m;switch(i=i&&i._model&&i._model.data?i._model.data:null,c){case"create_node":case"move_node":case"copy_node":if("move_node"!==c||-1===a.inArray(e.id,f.children)){if(j=this.get_rules(f),j.max_children!==b&&-1!==j.max_children&&j.max_children===f.children.length)return this._data.core.last_error={error:"check",plugin:"types",id:"types_01",reason:"max_children prevents function: "+c,data:JSON.stringify({chk:c,pos:g,obj:e&&e.id?e.id:!1,par:f&&f.id?f.id:!1})},!1;if(j.valid_children!==b&&-1!==j.valid_children&&-1===a.inArray(e.type||"default",j.valid_children))return this._data.core.last_error={error:"check",plugin:"types",id:"types_02",reason:"valid_children prevents function: "+c,data:JSON.stringify({chk:c,pos:g,obj:e&&e.id?e.id:!1,par:f&&f.id?f.id:!1})},!1;if(i&&e.children_d&&e.parents){for(k=0,l=0,m=e.children_d.length;m>l;l++)k=Math.max(k,i[e.children_d[l]].parents.length);k=k-e.parents.length+1}(0>=k||k===b)&&(k=1);do{if(j.max_depth!==b&&-1!==j.max_depth&&j.max_depth<k)return this._data.core.last_error={error:"check",plugin:"types",id:"types_03",reason:"max_depth prevents function: "+c,data:JSON.stringify({chk:c,pos:g,obj:e&&e.id?e.id:!1,par:f&&f.id?f.id:!1})},!1;f=this.get_node(f.parent),j=this.get_rules(f),k++}while(f)}}return!0},this.get_rules=function(a){if(a=this.get_node(a),!a)return!1;var c=this.get_type(a,!0);return c.max_depth===b&&(c.max_depth=-1),c.max_children===b&&(c.max_children=-1),c.valid_children===b&&(c.valid_children=-1),c},this.get_type=function(b,c){return b=this.get_node(b),b?c?a.extend({type:b.type},this.settings.types[b.type]):b.type:!1},this.set_type=function(c,d){var e=this._model.data,f,g,h,i,j,k,l,m;if(a.isArray(c)){for(c=c.slice(),g=0,h=c.length;h>g;g++)this.set_type(c[g],d);return!0}if(f=this.settings.types,c=this.get_node(c),!f[d]||!c)return!1;if(l=this.get_node(c,!0),l&&l.length&&(m=l.children(".jstree-anchor")),i=c.type,j=this.get_icon(c),c.type=d,(j===!0||!f[i]||f[i].icon!==b&&j===f[i].icon)&&this.set_icon(c,f[d].icon!==b?f[d].icon:!0),f[i]&&f[i].li_attr!==b&&"object"==typeof f[i].li_attr)for(k in f[i].li_attr)if(f[i].li_attr.hasOwnProperty(k)){if("id"===k)continue;"class"===k?(e[c.id].li_attr["class"]=(e[c.id].li_attr["class"]||"").replace(f[i].li_attr[k],""),l&&l.removeClass(f[i].li_attr[k])):e[c.id].li_attr[k]===f[i].li_attr[k]&&(e[c.id].li_attr[k]=null,l&&l.removeAttr(k))}if(f[i]&&f[i].a_attr!==b&&"object"==typeof f[i].a_attr)for(k in f[i].a_attr)if(f[i].a_attr.hasOwnProperty(k)){if("id"===k)continue;"class"===k?(e[c.id].a_attr["class"]=(e[c.id].a_attr["class"]||"").replace(f[i].a_attr[k],""),m&&m.removeClass(f[i].a_attr[k])):e[c.id].a_attr[k]===f[i].a_attr[k]&&("href"===k?(e[c.id].a_attr[k]="#",m&&m.attr("href","#")):(delete e[c.id].a_attr[k],m&&m.removeAttr(k)))}if(f[d].li_attr!==b&&"object"==typeof f[d].li_attr)for(k in f[d].li_attr)if(f[d].li_attr.hasOwnProperty(k)){if("id"===k)continue;e[c.id].li_attr[k]===b?(e[c.id].li_attr[k]=f[d].li_attr[k],l&&("class"===k?l.addClass(f[d].li_attr[k]):l.attr(k,f[d].li_attr[k]))):"class"===k&&(e[c.id].li_attr["class"]=f[d].li_attr[k]+" "+e[c.id].li_attr["class"],l&&l.addClass(f[d].li_attr[k]))}if(f[d].a_attr!==b&&"object"==typeof f[d].a_attr)for(k in f[d].a_attr)if(f[d].a_attr.hasOwnProperty(k)){if("id"===k)continue;e[c.id].a_attr[k]===b?(e[c.id].a_attr[k]=f[d].a_attr[k],m&&("class"===k?m.addClass(f[d].a_attr[k]):m.attr(k,f[d].a_attr[k]))):"href"===k&&"#"===e[c.id].a_attr[k]?(e[c.id].a_attr.href=f[d].a_attr.href,m&&m.attr("href",f[d].a_attr.href)):"class"===k&&(e[c.id].a_attr["class"]=f[d].a_attr["class"]+" "+e[c.id].a_attr["class"],m&&m.addClass(f[d].a_attr[k]))}return!0}},a.jstree.defaults.unique={case_sensitive:!1,trim_whitespace:!1,duplicate:function(a,b){return a+" ("+b+")"}},a.jstree.plugins.unique=function(c,d){this.check=function(b,c,e,f,g){if(d.check.call(this,b,c,e,f,g)===!1)return!1;if(c=c&&c.id?c:this.get_node(c),e=e&&e.id?e:this.get_node(e),!e||!e.children)return!0;var h="rename_node"===b?f:c.text,i=[],j=this.settings.unique.case_sensitive,k=this.settings.unique.trim_whitespace,l=this._model.data,m,n,o;for(m=0,n=e.children.length;n>m;m++)o=l[e.children[m]].text,j||(o=o.toLowerCase()),k&&(o=o.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")),i.push(o);switch(j||(h=h.toLowerCase()),k&&(h=h.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")),b){case"delete_node":return!0;case"rename_node":return o=c.text||"",j||(o=o.toLowerCase()),k&&(o=o.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")),m=-1===a.inArray(h,i)||c.text&&o===h,m||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_01",reason:"Child with name "+h+" already exists. Preventing: "+b,data:JSON.stringify({chk:b,pos:f,obj:c&&c.id?c.id:!1,par:e&&e.id?e.id:!1})}),m;case"create_node":return m=-1===a.inArray(h,i),m||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_04",reason:"Child with name "+h+" already exists. Preventing: "+b,data:JSON.stringify({chk:b,pos:f,obj:c&&c.id?c.id:!1,par:e&&e.id?e.id:!1})}),m;case"copy_node":return m=-1===a.inArray(h,i),m||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_02",reason:"Child with name "+h+" already exists. Preventing: "+b,data:JSON.stringify({chk:b,pos:f,obj:c&&c.id?c.id:!1,par:e&&e.id?e.id:!1})}),m;case"move_node":return m=c.parent===e.id&&(!g||!g.is_multi)||-1===a.inArray(h,i),m||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_03",reason:"Child with name "+h+" already exists. Preventing: "+b,data:JSON.stringify({chk:b,pos:f,obj:c&&c.id?c.id:!1,par:e&&e.id?e.id:!1})}),m}return!0},this.create_node=function(c,e,f,g,h){if(!e||e.text===b){if(null===c&&(c=a.jstree.root),c=this.get_node(c),!c)return d.create_node.call(this,c,e,f,g,h);if(f=f===b?"last":f,!f.toString().match(/^(before|after)$/)&&!h&&!this.is_loaded(c))return d.create_node.call(this,c,e,f,g,h);e||(e={});var i,j,k,l,m,n=this._model.data,o=this.settings.unique.case_sensitive,p=this.settings.unique.trim_whitespace,q=this.settings.unique.duplicate,r;for(j=i=this.get_string("New node"),k=[],l=0,m=c.children.length;m>l;l++)r=n[c.children[l]].text,o||(r=r.toLowerCase()),p&&(r=r.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")),k.push(r);l=1,r=j,o||(r=r.toLowerCase()),p&&(r=r.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""));while(-1!==a.inArray(r,k))j=q.call(this,i,++l).toString(),r=j,o||(r=r.toLowerCase()),p&&(r=r.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""));e.text=j}return d.create_node.call(this,c,e,f,g,h)}};var n=i.createElement("DIV");if(n.setAttribute("unselectable","on"),n.setAttribute("role","presentation"),n.className="jstree-wholerow",n.innerHTML="&#160;",a.jstree.plugins.wholerow=function(b,c){this.bind=function(){c.bind.call(this),this.element.on("ready.jstree set_state.jstree",a.proxy(function(){this.hide_dots()},this)).on("init.jstree loading.jstree ready.jstree",a.proxy(function(){this.get_container_ul().addClass("jstree-wholerow-ul")},this)).on("deselect_all.jstree",a.proxy(function(a,b){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked")},this)).on("changed.jstree",a.proxy(function(a,b){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked");var c=!1,d,e;for(d=0,e=b.selected.length;e>d;d++)c=this.get_node(b.selected[d],!0),c&&c.length&&c.children(".jstree-wholerow").addClass("jstree-wholerow-clicked")},this)).on("open_node.jstree",a.proxy(function(a,b){this.get_node(b.node,!0).find(".jstree-clicked").parent().children(".jstree-wholerow").addClass("jstree-wholerow-clicked")},this)).on("hover_node.jstree dehover_node.jstree",a.proxy(function(a,b){"hover_node"===a.type&&this.is_disabled(b.node)||this.get_node(b.node,!0).children(".jstree-wholerow")["hover_node"===a.type?"addClass":"removeClass"]("jstree-wholerow-hovered")},this)).on("contextmenu.jstree",".jstree-wholerow",a.proxy(function(b){if(this._data.contextmenu){b.preventDefault();var c=a.Event("contextmenu",{metaKey:b.metaKey,ctrlKey:b.ctrlKey,altKey:b.altKey,shiftKey:b.shiftKey,pageX:b.pageX,pageY:b.pageY});a(b.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(c)}},this)).on("click.jstree",".jstree-wholerow",function(b){b.stopImmediatePropagation();var c=a.Event("click",{metaKey:b.metaKey,ctrlKey:b.ctrlKey,altKey:b.altKey,shiftKey:b.shiftKey});a(b.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(c).focus()}).on("dblclick.jstree",".jstree-wholerow",function(b){b.stopImmediatePropagation();var c=a.Event("dblclick",{metaKey:b.metaKey,ctrlKey:b.ctrlKey,altKey:b.altKey,shiftKey:b.shiftKey});a(b.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(c).focus()}).on("click.jstree",".jstree-leaf > .jstree-ocl",a.proxy(function(b){b.stopImmediatePropagation();var c=a.Event("click",{metaKey:b.metaKey,ctrlKey:b.ctrlKey,altKey:b.altKey,shiftKey:b.shiftKey});a(b.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(c).focus()},this)).on("mouseover.jstree",".jstree-wholerow, .jstree-icon",a.proxy(function(a){return a.stopImmediatePropagation(),this.is_disabled(a.currentTarget)||this.hover_node(a.currentTarget),!1},this)).on("mouseleave.jstree",".jstree-node",a.proxy(function(a){this.dehover_node(a.currentTarget)},this))},this.teardown=function(){this.settings.wholerow&&this.element.find(".jstree-wholerow").remove(),c.teardown.call(this)},this.redraw_node=function(b,d,e,f){if(b=c.redraw_node.apply(this,arguments)){var g=n.cloneNode(!0);-1!==a.inArray(b.id,this._data.core.selected)&&(g.className+=" jstree-wholerow-clicked"),this._data.core.focused&&this._data.core.focused===b.id&&(g.className+=" jstree-wholerow-hovered"),b.insertBefore(g,b.childNodes[0])}return b}},window.customElements&&Object&&Object.create){var o=Object.create(HTMLElement.prototype);o.createdCallback=function(){var b={core:{},plugins:[]},c;for(c in a.jstree.plugins)a.jstree.plugins.hasOwnProperty(c)&&this.attributes[c]&&(b.plugins.push(c),this.getAttribute(c)&&JSON.parse(this.getAttribute(c))&&(b[c]=JSON.parse(this.getAttribute(c))));for(c in a.jstree.defaults.core)a.jstree.defaults.core.hasOwnProperty(c)&&this.attributes[c]&&(b.core[c]=JSON.parse(this.getAttribute(c))||this.getAttribute(c));a(this).jstree(b)};try{window.customElements.define("vakata-jstree",function(){},{prototype:o})}catch(p){}}}});;
function stockActionsClass() {
    this.lastMultiselectElement = null;
    this.FORMAT_TYPE_MEASURE = 0;
    this.FORMAT_TYPE_DIMENSION = 1;
    this.SELECT2_TYPE_PRODUCT = 1;
    this.SELECT2_TYPE_BRAND = 2;
    this.SELECT2_TYPE_SUPPLIER = 3;
    this.FORMAT_TYPE_MEASURE_NONE = 7;
    this.init = function () {
        var $this = this;
        var $body = $('body');
        $body.on('click', '.stockProductWithPhoto', function (event) {
            event.preventDefault();
            var productsId = $(this).attr('data-stockProductsId');
            //showCabinetUserProfileModal(cabinetUserId, patientId, stageId);
        });
        $body.on('click', '.stockBrandWithPhoto', function (event) {
            event.preventDefault();
            var brandsId = $(this).attr('data-stockBrandsId');
            //showCabinetUserProfileModal(cabinetUserId, patientId, stageId);
        });
        $body.on('click', '.stockSupplierWithPhoto', function (event) {
            event.preventDefault();
            var suppliersId = $(this).attr('data-stockSuppliersId');
            //showCabinetUserProfileModal(cabinetUserId, patientId, stageId);
        });
        $body.on('click', '.createProductModalTrigger', function (event) {
            event.preventDefault();
            $('.stockProducts').select2("close");
            $this.showCreateProductModal(_select2SearchTerm);
        });
        $body.on('click', '.createSuppliersModalTrigger', function (event) {
            event.preventDefault();
            $('.stockSuppliers').select2("close");
            $this.showCreateSupplierModal(_select2SearchTerm);
        });

    };

    this.showCreateProductModal = function (product_name, params) {
        var category_id = 0;
        if (typeof (params) == 'undefined' || typeof (params.category_id) == 'undefined') {
            category_id = 0;
        } else {
            if (typeof (params.category_id) != 'undefined') {
                category_id = params.category_id;
            }
        }
        var ajaxData = {
            type: 'create',
            product_id: 0,
            category_id: category_id,
            product_name: product_name
        };
        if (typeof (params) != 'undefined') {
            if (typeof (params.box) != 'undefined') {
                ajaxData.box = params.box;
            }
            if (typeof (params.boxRoom) != 'undefined') {
                ajaxData.boxRoom = params.boxRoom;
            }
        }
        ajax({
            url: '/cabinet/stock/products/get-ajax-form',
            data: ajaxData,
            success: function (data) {
                if (typeof (data.formHtml) != 'undefined') {
                    $('#stockProductModal').html(data.formHtml).modal('show');
                }
            }
        });
    };
    this.showEditProductModal = function (product_id, params) {

        var ajaxData = {
            type: 'edit',
            product_id: product_id
        };
        if (typeof (params) != 'undefined') {
            if (typeof (params.box) != 'undefined') {
                ajaxData.box = params.box;
            }
            if (typeof (params.boxRoom) != 'undefined') {
                ajaxData.boxRoom = params.boxRoom;
            }
        }
        ajax({
            url: '/cabinet/stock/products/get-ajax-form',
            data: ajaxData,
            success: function (data) {
                if (typeof (data.formHtml) != 'undefined') {
                    $('#stockProductModal').html(data.formHtml).modal('show');
                }
            }
        });
    };
    this.showCreateSupplierModal = function (supplier_name, params) {

        var ajaxData = {
            type: 'create',
            supplier_id: 0,
            supplier_name: supplier_name
        };

        ajax({
            url: '/cabinet/stock/suppliers/get-ajax-form',
            data: ajaxData,
            success: function (data) {
                if (typeof (data.formHtml) != 'undefined') {
                    $('#stockSupplierModal').html(data.formHtml).modal('show');
                }
            }
        });
    };
    this.addNewProduct2Select2 = function (data) {
        var el = stockActions.lastMultiselectElement;
        var html = '<option value="' + data.id + '" data-photo="' + data.photo + '" data-code="' + data.code + '" data-brand="' + data.brand_name + '" data-format="' + data.formatted_format + '">' + this.formatCustomProductsSelectedItem(data) + '</option>';
        el.append(html);
        el.val(data.id);
        el.trigger('change');
        el.trigger({
            type: 'select2:select',
            params: {
                data: data
            }
        });
    };
    this.addNewBrand2Select2 = function (data) {
        var el = $('#stockProductsForm_brands_id');
        var html = '<option value="' + data.id + '" data-photo="' + data.photo + '">' + this.formatCustomInvoiceBrandsSelectedItem(data) + '</option>';
        el.append(html);
        el.val(data.id);
        el.trigger('change');
        el.trigger({
            type: 'select2:select',
            params: {
                data: data
            }
        });
    };

    this.addNewSupplier2Select2 = function (data) {

        var el = $('.stockSuppliers');
        var html = '<option value="' + data.id + '" data-photo="' + data.photo + '">' + this.formatCustomSuppliersInSelect2(data) + '</option>';
        el.append(html);
        el.val(data.id);
        el.trigger('change');
        el.trigger({
            type: 'select2:select',
            params: {
                data: data
            }
        });
    };

    this.formatCustomProductsInSelect = function (data) {
        if (data.loading)
            return data.text;

        var markup = "<div class='select2-result-custom clearfix'>" +
            "<div class='select2-result-custom__avatar'>" + (typeof (data.photo) != 'undefined' && data.photo.length ? "<img src='" + data.photo + "'>" : '<img src="/a/nophoto-product.jpg">') + "</div>" +
            "<div class='select2-result-custom__meta'>" +
            "<div class='select2-result-custom__title'>" + data.text + "</div>" +
            "<div class='select2-result-custom__code'>" + TR('Article') + ": " + data.code + "</div>" +
            "<div class='select2-result-custom__barcode'>" + TR('Bar code') + ": " + data.barcode + "</div>" +
            "<div class='select2-result-custom__formatted_format'>" + TR('Format') + ": " + data.formatted_format + "</div>"
        ;
        markup += "</div></div>";
        return markup;
    };

    this.formatCustomProductsSelectedItem = function (data) {
        if (parseInt(data.id)) {
            if (typeof (data.element) != 'undefined') {
                var element = $(data.element);
                var elementPhoto = element.attr('data-photo');
            }
            if (typeof (elementPhoto) == 'undefined') // If not option element, get avatar from query
                elementPhoto = data.photo;
            if (typeof (elementPhoto) == 'undefined' || elementPhoto == "") {
                elementPhoto = '/a/nophoto-product.jpg';
            }
            return (typeof (elementPhoto) != 'undefined' ? "<img class='select2SelectedStockProduct' src='" + elementPhoto + "'>" : '') + "<span class='select2SelectedText'>" + (typeof (data.name) == 'undefined' ? data.text : data.name) + "</span>";
        } else {
            return '';
        }
    }


    this.formatCustomInvoiceBrandsInSelect = function (data) {
        if (data.loading)
            return data.text;
        var markup = "<div class='select2-result-custom clearfix'>" +
            "<div class='select2-result-custom__avatar'>" + (typeof (data.photo) != 'undefined' && data.photo.length ? "<img src='" + data.photo + "'>" : '<img src="/a/nophoto-product.jpg">') + "</div>" +
            "<div class='select2-result-custom__meta'>" +
            "<div class='select2-result-custom__title'>" + data.text + "</div>";
        markup += "</div></div>";
        return markup;
    };

    this.formatCustomInvoiceBrandsSelectedItem = function (data) {
        if (parseInt(data.id)) {

            var element = $(data.element);
            var elementPhoto = element.attr('data-photo');
            if (typeof (elementPhoto) == 'undefined') {// If not option element, get avatar from query
                elementPhoto = data.photo;
            }
            if (typeof (elementPhoto) == 'undefined' && element.parent().attr('data-photo') != '') {
                elementPhoto = element.parent().attr('data-photo');
            }
            if (typeof (elementPhoto) == 'undefined' || elementPhoto == "") {
                elementPhoto = '/a/nophoto-brand.jpg';
            }

            return (typeof (elementPhoto) != 'undefined' ? "<img class='select2SelectedStockProduct' src='" + elementPhoto + "'>" : '') + "<span class='select2SelectedText'>" + data.text + "</span>";
        } else {
            return '';
        }
    };
    this.select2NoPhoto = function (type) {
        var noPhotoSrc = '';
        switch (type) {
            case this.SELECT2_TYPE_BRAND:
                noPhotoSrc = '/a/nophoto-brand.jpg';
                break;
            case this.SELECT2_TYPE_PRODUCT:
                noPhotoSrc = '/a/nophoto-product.jpg';
                break;
            case this.SELECT2_TYPE_SUPPLIER:
                noPhotoSrc = '/a/nophoto-supplier.jpg';
                break;
        }
        return noPhotoSrc;
    };

    this.formatPhotoInSelect2 = function (data, type) {
        var noPhotoSrc = this.select2NoPhoto(type);
        if (data.loading) {
            return data.text;
        }
        var markup = "<div class='select2-result-custom clearfix'>" +
            "<div class='select2-result-custom__avatar'>" + (typeof (data.photo) != 'undefined' && data.photo.length ? "<img src='" + data.photo + "'>" : '<img src="' + noPhotoSrc + '">') + "</div>" +
            "<div class='select2-result-custom__meta'>" +
            "<div class='select2-result-custom_stock_product-subtitle'>" + data.text + "</div>";
        if (type == stockActions.SELECT2_TYPE_PRODUCT) {
            var name = data.text;
            var brand = data.brand_name;
            var code = data.code;
            var format = data.formatted_format;
            var subTitleArray = [];
            if (brand != '' /*&& name.indexOf(brand)==-1*/) {
                subTitleArray.push(brand);
            }
            if (type == stockActions.SELECT2_TYPE_PRODUCT) {
                if (code != '' /*&& !name.indexOf(code)==-1*/) {
                    subTitleArray.push(code);
                }
                if (format != '' /*&& !name.indexOf(format)==-1*/) {
                    subTitleArray.push(format);
                }
            }
            var subTitleString = '';
            if (subTitleArray.length) {
                subTitleString = subTitleArray.join('&nbsp;&nbsp;/&nbsp;&nbsp;');
            }

            markup += '<div class="select2-result-custom-stock_product-subtitle">' + subTitleString + '</div>';
        }
        markup += "</div></div>";
        return markup;
    };

    this.formatPhotoSelectedItemInSelect2 = function (data, type) {
        var photo = this.select2NoPhoto(type);
        // if (type == stockActions.SELECT2_TYPE_PRODUCT) {
        var brand = '';
        var code = '';
        var format = '';
        //}
        var name = data.text;
        if (parseInt(data.id)) {

            var element = $(data.element);
            if (typeof (data.photo) == 'undefined') {
                if (typeof (element.data('photo')) !== 'undefined') {
                    photo = element.data('photo');
                }
                if (type == stockActions.SELECT2_TYPE_PRODUCT) {
                    if (typeof (element.data('code')) !== 'undefined') {
                        code = element.data('code');
                    }
                    if (typeof (element.data('brand')) !== 'undefined') {
                        brand = element.data('brand');
                    }
                    if (typeof (element.data('format')) !== 'undefined') {
                        format = element.data('format');
                    }
                }
            } else {
                if (typeof (data.photo) !== 'undefined' && data.photo != '') {
                    photo = data.photo;
                }
                if (type == stockActions.SELECT2_TYPE_PRODUCT) {
                    if (typeof (data.code) !== 'undefined') {
                        code = data.code;
                    }
                    if (typeof (data.brand_name) !== 'undefined') {
                        brand = data.brand_name;
                    }
                    if (typeof (data.formatted_format) !== 'undefined') {
                        format = data.formatted_format;
                    }
                }
            }
            var subTitleArray = [];

            if (type == stockActions.SELECT2_TYPE_PRODUCT) {
                if (brand != '' /*&& name.indexOf(brand)==-1*/) {
                    subTitleArray.push(brand);
                }
                if (code != '' /*&& !name.indexOf(code)==-1*/) {
                    subTitleArray.push(code);
                }
                if (format != '' /*&& !name.indexOf(format)==-1*/) {
                    subTitleArray.push(format);
                }
            }
            var subTitleString = '';
            if (subTitleArray.length) {
                subTitleString = subTitleArray.join('&nbsp;&nbsp;/&nbsp;&nbsp;');
            }
            if (type == stockActions.SELECT2_TYPE_PRODUCT) {
                var selectHTML = '<div class="select2SelectedStockProductPhotoContainer">';
                selectHTML += '<img class="select2SelectedStockProductPhoto" src="' + photo + '">';
                selectHTML += '</div>';
                selectHTML += '<div class="select2-result-custom__meta">';
                selectHTML += '<div class="select2SelectedStockProductTextContainer">';
                selectHTML += '<div class="title">' + name + '</div>';
                selectHTML += '<div class="subtitle">' + subTitleString + '&nbsp;</div>';
                selectHTML += '</div>';
                selectHTML += '</div>';
                return selectHTML;
            } else {
                return '<img class="select2SelectedAvatar" src="' + photo + '"><span class="select2SelectedText">' + name + '</span>';
            }
        } else {
            return '';
        }
    };

    this.formatCustomBrandsInSelect2 = function (data) {
        return stockActions.formatPhotoInSelect2(data, stockActions.SELECT2_TYPE_BRAND);
    };

    this.formatCustomBrandsSelectedItemInSelect2 = function (data) {
        return stockActions.formatPhotoSelectedItemInSelect2(data, stockActions.SELECT2_TYPE_BRAND);
    };
    this.formatCustomSuppliersInSelect2 = function (data) {
        return stockActions.formatPhotoInSelect2(data, stockActions.SELECT2_TYPE_SUPPLIER);
    };

    this.formatCustomSuppliersSelectedItemInSelect2 = function (data) {
        return stockActions.formatPhotoSelectedItemInSelect2(data, stockActions.SELECT2_TYPE_SUPPLIER);
    };

    this.formatCustomProductsInSelect2 = function (data) {
        return stockActions.formatPhotoInSelect2(data, stockActions.SELECT2_TYPE_PRODUCT);

    };

    this.formatCustomProductsSelectedItemInSelect2 = function (data) {
        return stockActions.formatPhotoSelectedItemInSelect2(data, stockActions.SELECT2_TYPE_PRODUCT);
    };


    this.renderTemplate = function (name, data) {
        var template = document.getElementById(name).innerHTML;

        for (var property in data) {
            if (data.hasOwnProperty(property)) {
                var search = new RegExp('{' + property + '}', 'g');
                template = template.replace(search, data[property]);
            }
        }
        return template;
    };

    this.filteredValue = function (value, filter) {
        switch (filter) {
            case 'int':
                return value == null || value == '' ? 0 : parseInt(value);
                break;
            case 'float':
                return value == null || value == '' ? '' : parseFloat(value.replace(/,/g, '.'));
                break;
            case 'string':
                return value == null ? '' : value;
                break;
        }
        return value == null ? '' : value;
    };
    this.trim = function (str, charlist) {
        //
        // +   original by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
        // +   improved by: mdsjack (http://www.mdsjack.bo.it)
        // +   improved by: Alexander Ermolaev (http://snippets.dzone.com/user/AlexanderErmolaev)
        // +	  input by: Erkekjetter
        // +   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)

        charlist = !charlist ? ' \s\xA0' : charlist.replace(/([\[\]\(\)\.\?\/\*\{\}\+\$\^\:])/g, '\$1');
        var re = new RegExp('^[' + charlist + ']+|[' + charlist + ']+$', 'g');
        return str.replace(re, '');
    };

    this.substr_count = function (haystack, needle, offset, length) {	// Count the number of substring occurrences
        //
        // +   original by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)

        var pos = 0, cnt = 0;

        if (isNaN(offset)) offset = 0;
        if (isNaN(length)) length = 0;
        offset--;

        while ((offset = haystack.indexOf(needle, offset + 1)) != -1) {
            if (length > 0 && (offset + needle.length) > length) {
                return false;
            } else {
                cnt++;
            }
        }

        return cnt;
    };
    this.treesearch = function (searchValue, node) {
        var $this = this;
        var node_value = node.text.replace(/<\/?[^>]+>/gi, '');
        node_value = $this.trim(node_value.replace(/&nbsp;/gi, ''));
        return $this.substr_count(node_value.toLowerCase(), searchValue.toLowerCase());
    };

    this.priceFormat = function (price) {
        price = price.toString().replace(/&nbsp;/gi, '').replace(/ /gi, '');
        //https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/NumberFormat
        //TODO LOCALE!!!
        var formatted_price = new Intl.NumberFormat('ru-RU', {
            minimumFractionDigits: 2,
            maximumFractionDigits: 2
        }).format(price);
        return formatted_price.replace(/,/, '.');
    };

    this.ajax2PageWithCheckChangeLocation = function (ajaxData) {
        ajax({
            url: '/cabinet/' + ajaxData.hash,
            data: ajaxData,
            success: function (data) {
                showAjaxData(data);
                if (typeof (data.new_location_hash) != 'undefined') {
                    window.removeEventListener("hashchange", locationHashChanged);
                    location.hash = data.new_location_hash;
                    setTimeout(function () {
                        window.addEventListener("hashchange", locationHashChanged, false)
                    }, 1);
                }
            }
        });
    };

    this.highlightErrors = function (data) {
        var errors = data.errors;
        if (typeof (errors) != 'undefined') {
            for (var k in errors) {
                var error = errors[k];
                $('#' + k).html(error);
            }
        }
        if (typeof (data.message) != 'undefined') {
            setTimeout(function () {
                alert(data.message);
            }, 100);
        }
    };
    this.showBalances = function (products_id) {
        ajax({
            url: '/cabinet/stock/index/get-balances-info',
            data: {products_id: products_id},
            success: function (data) {
                if (typeof (data.formHtml) != 'undefined') {
                    $('#stockBalancesModal').html(data.formHtml).modal('show');
                }
            }

        });
    };
    this.changeUrlHashWithoutRedirect = function (hash) {
        window.removeEventListener("hashchange", locationHashChanged);
        location.hash = hash;
        setTimeout(function () {
            window.addEventListener("hashchange", locationHashChanged, false)
        }, 1);
    };
    this.initScripts = function () {
        $('.showStockBrandModal img').popover({
            html: true,
            trigger: 'hover',
            placement: 'auto auto',
            content: function () {
                return '<img src="' + $(this).attr('src') + '" class="popover-image"/>';
            }
        });
        $('.showStockProductModal img').popover({
            html: true,
            trigger: 'hover',
            animation: false,
            placement: 'auto auto',
            content: function () {
                if (typeof ($(this).data('popover')) != 'undefined') {
                    return '<img src="' + $(this).data('popover') + '" class="popover-image" />';
                }
                return '<img src="' + $(this).attr('src') + '" class="popover-image" />';
            }
        });
        $('img.select2SelectedStockProductPhoto').popover({
            html: true,
            trigger: 'hover',
            animation: false,
            placement: 'auto auto',
            content: function () {
                return '<img src="' + $(this).attr('src') + '" class="popover-image" />';
            }
        });
        $('.showStockSupplierModal img').popover({
            html: true,
            trigger: 'hover',
            placement: 'auto auto',
            content: function () {
                return '<img src="' + $(this).attr('src') + '" class="popover-image" />';
            }
        });
        $('.showCabinetUserProfileModal img').popover({
            html: true,
            trigger: 'hover',
            placement: 'auto auto',
            content: function () {
                return '<img src="' + $(this).attr('src') + '" class="popover-image" />';
            }
        });

    };

    this.initSimpleSelect2 = function (selector, options) {
        var defaults = {
            theme: 'bootstrap stockSelect2Theme stockSelect2SimpleTheme',
            minimumResultsForSearch: -1
        }
        var settings = $.extend({}, defaults, options);
        $(selector).select2(settings);
    };

    this.initSelect2Products = function (selector, options) {
        var defaults = {
            url: '/cabinet/stock/index/get-context-search-products',
            placeholder: TR('-- Goods --'),
            quietMillis: false,
            templateResult: this.formatCustomProductsInSelect2,
            templateSelection: this.formatCustomProductsSelectedItemInSelect2,
            additionalReturnParams: {
                d: typeof (options.additionalReturnParams) != 'undefined' ? options.additionalReturnParams : 'full',
            },
            theme: 'bootstrap stockSelect2Theme stockProductsSelect2Theme',
            language: {
                noResults: function () {
                    if (typeof (options.hideAddProductButton) != 'undefined' && options.hideAddProductButton == true) {
                        return TR('Nothing was found');
                    } else {
                        return TR('Nothing was found') + "<button class='createProductModalTrigger btn btn-icon-only green'>+</button>";
                    }
                }
            }
        }
        var settings = $.extend({}, defaults, options);
        if (typeof (options.additionalReturnParams) != 'undefined') {
            settings.additionalReturnParams = $.extend({}, defaults.additionalReturnParams, options.additionalReturnParams);
        } else {
            settings.additionalReturnParams = defaults.additionalReturnParams;
        }

        return this.initSelect2(selector, settings);
    };
    this.initSelect2 = function (selector, options) {
        var defaults = {
            width: null,
            multiple: false,
            minimumInputLength: 0,
            url: '',
            delay: 100,
            quietMillis: false,
            cache: false,
            placeholder: '--- ---',
            theme: 'bootstrap stockSelect2Theme',
            templateResult: false,
            templateSelection: false,
            additionalReturnParams: {},
            language: false
        };

        var settings = $.extend({}, defaults, options);
        var select2Params = {
            width: settings.width,
            multiple: settings.multiple,
            theme: settings.theme,
            minimumInputLength: settings.minimumInputLength,
            ajax: {
                url: settings.url,
                dataType: 'json',
                delay: settings.delay,
                data: function (params) {
                    var currentValue = $(this).val();
                    var returnParams = {
                        q: params.term,
                        v: function () {
                            if (settings.multiple === false) {
                                return currentValue;
                            }
                            return currentValue == null ? '' : currentValue.join(',');
                        }
                    };
                    returnParams = $.extend({}, returnParams, settings.additionalReturnParams);
                    return returnParams;
                },
                cache: settings.cache
            },
            placeholder: settings.placeholder,
            escapeMarkup: function (markup) {
                return markup;
            }
        };
        if (settings.quietMillis) {
            select2Params.quietMillis = settings.quietMillis;
        }
        if (settings.language) {
            select2Params.language = settings.language;
        }
        if (settings.templateResult) {
            select2Params.templateResult = settings.templateResult;
        }
        if (settings.templateSelection) {
            select2Params.templateSelection = settings.templateSelection;
        }
        return $(selector).select2(select2Params);
    };
    this.confirm = function (options) {
        if (STOCK_SKIP_CONFIRM_DIALOG == true) {
            options.action();
        } else {
            var confirmActionsOptions = {
                buttonText: typeof (options.buttonText) == 'undefined' ? T['Delete'] : options.buttonText,
                text: typeof (options.text) == 'undefined' ? T['Delete?'] : options.text,
                buttonColor: typeof (options.buttonColor) == 'undefined' ? 'red' : options.buttonColor,
                action: function () {
                    options.action();
                }
            };
            if (typeof (options.cancelAction) != 'undefined') {
                confirmActionsOptions.cancelAction = options.cancelAction;
            }
            confirmDialog(confirmActionsOptions);
        }
    };
    this.arrayFromMap = function (array, maps, multi) {
        if (!multi) {
            var newItem = {};
            for (var mapKey in maps) {
                var mapFieldName = maps[mapKey];
                newItem[mapFieldName] = array[mapKey];
            }
            return newItem;
        }
        var newItems = {};
        for (var itemId in array) {
            var oldItem = array[itemId];
            var newItem = {};
            for (var mapKey in maps) {
                var mapFieldName = maps[mapKey];
                newItem[mapFieldName] = oldItem[mapKey];
            }
            newItems[itemId] = newItem;
        }
        return newItems;
    };
    /**
     *  $count     +,  10[]+10[]
     *
     * @param $count
     * @param $measures_id
     * @param $dimension_value
     * @param $measure_name
     * @param $dimension_name
     * @param $box bool
     * @return string
     */
    this.formattedBeautyMeasure = function formattedBeautyMeasure($count, $dimension_value, $measures_id, $measure_name, $dimension_name, $box) {
        // console.log([$count, $dimension_value, $measures_id, $measure_name, $dimension_name, $box]);
        if (typeof ($box) == 'undefined') {
            $box = false;
        }

        if ($measures_id == this.FORMAT_TYPE_MEASURE_NONE) {
            if ($count == 0) {
                return '';
            }
            if ($box) {
                return '<span class="stockBoxDimensionFormat">' + this.thousandIntFormat($count) + '' + $dimension_name + '</span>';
            }
            return this.thousandIntFormat($count) + '' + $dimension_name + '';
        }

        $measure_count = Math.floor($count / $dimension_value);
        $dimensions_count = $count - $measure_count * $dimension_value;
        /**
         *   6 ,     
         */
        $dimensions_count = Math.round($dimensions_count * 100000) / 100000;
        if ($dimensions_count < 0.000001) {
            $dimensions_count = 0;
        }
        if ($measure_count != 0 && $dimensions_count != 0) {
            if ($box) {
                return '<span class="stockBoxMeasureFormat">' + this.thousandIntFormat($measure_count) + '' + $measure_name + '</span>' + '<span class="stockBoxDimensionFormat">' + ($count > 0 ? '' : '-') + this.thousandIntFormat(
                    $dimensions_count
                ) + '' + $dimension_name + '</span>';
            }
            return this.thousandIntFormat($measure_count) + '' + $measure_name + '' + ($count > 0 ? '+' : '-') + this.thousandIntFormat(
                $dimensions_count
            ) + '' + $dimension_name + '';
        } else if ($measure_count != 0) {
            if ($box) {
                return '<span class="stockBoxMeasureFormat">' + this.thousandIntFormat($measure_count) + '' + $measure_name + '</span>';
            }
            return this.thousandIntFormat($measure_count) + '' + $measure_name + '';
        } else if ($dimensions_count != 0) {
            if ($box) {
                return '<span class="stockBoxDimensionFormat">' + this.thousandIntFormat($measure_count) + '' + $measure_name + '</span>';
            }
            return this.thousandIntFormat($dimensions_count) + '' + $dimension_name + '';
        }
        return '';
    };
    this.thousandIntFormat = function ($count) {
        return $count;
        return number_format($count, 0, '', ' ');
    };
}
;
function stockBalanceActionsClass(){this.init=function(){var b=this;$("body").on("click",".moveStockItem",function(a){var e=$(this).data("id");b.initMoveForm(a,e)});$("body").on("click",".offStockItem",function(a){var e=$(this).data("id");b.initOffForm(a,e)});$("body").on("click","#clearBalanceTable",function(a){stockActions.confirm({text:TR("Are you sure you want to reset all filters?"),buttonText:"Ok",action:function(){locationHashChanged()}})});$("body").on("click",".exportStockBalance",function(a){var b=
[];a=$("#stockCategoriesTree").jstree("get_selected",!0);$.each(a,function(){b.push(this.id)});a=$("#inventoryBrand").val();a=null==a?"":a.join(",");var d=$("#inventoryProduct").val();d=null==d?"":d.join(",");var f=[];$(".room").each(function(){this.checked&&f.push(this.value)});var c=balanceDateStartPicker.data("DateTimePicker").date(),g=balanceDateEndPicker.data("DateTimePicker").date(),h=0;$(".inventoryBalance").each(function(){this.checked&&(h=this.value)});a={categories:b,brands:a,products:d,
critical:$("#inventoryCritical").get(0).checked?1:0,inventoryBalance:h,rooms:f.join(","),date_start:null===c?"":c.format("YYYY-MM-DD"),date_end:null===g?"":g.format("YYYY-MM-DD")};location.href="/cabinet/stock/balance/export?data="+JSON.stringify(a)})};this.initMoveForm=function(b,a){ajax({url:"/cabinet/stock/balance/get-ajax-move-form",data:{product_id:a},success:function(a){"undefined"!=typeof a.formHtml&&$("#stockBalanceModal").html(a.formHtml).modal("show")}})};this.initOffForm=function(b,a){ajax({url:"/cabinet/stock/balance/get-ajax-off-form",
data:{product_id:a},success:function(a){"undefined"!=typeof a.formHtml&&$("#stockBalanceModal").html(a.formHtml).modal("show")}})};this.initDataTable=function(b){$(document).ready(function(){$("#closeFullscreeen").click(function(){$("#closeFullscreeen").hide();$("#fullscreen").removeClass("fullscreen")});var a=Math.min(.55*window.innerHeight,34*(b+1));a=$("#balanceTableBlock").DataTable({paging:!1,scrollX:!0,scrollY:a,columnDefs:[{targets:"no-sort",orderable:!1}]});new $.fn.dataTable.FixedColumns(a,
{leftColumns:1,rightColumns:0})})};this.toogleFilter=function(b){var a=$("#filter_"+b).is(":visible");$(".filters").hide();$(".filtered").show();a?($("#filter_"+b).hide(),$("#filtered_"+b).show()):($("#filter_"+b).show(),$("#filtered_"+b).hide())};this.initFilters=function(b,a,e,d){$("#buildBalanceTable").click(function(){$(".filters").hide();$(".filtered").show();var a=[],c=$("#stockCategoriesTree").jstree("get_selected",!0);$.each(c,function(){a.push(this.id)});c=$("#inventoryBrand").val();c=null==
c?"":c.join(",");var b=$("#inventoryProduct").val();b=null==b?"":b.join(",");var d=[];$(".room").each(function(){this.checked&&d.push(this.value)});var e=balanceDateStartPicker.data("DateTimePicker").date(),k=balanceDateEndPicker.data("DateTimePicker").date(),l=0;$(".inventoryBalance").each(function(){this.checked&&(l=this.value)});c={categories:a,brands:c,inventoryBalance:l,products:b,critical:$("#inventoryCritical").get(0).checked?1:0,rooms:d.join(","),date_start:null===e?"":e.format("YYYY-MM-DD"),
date_end:null===k?"":k.format("YYYY-MM-DD")};$("#balanceTable").html(TR("Wait..."));ajax({url:"/cabinet/stock/balance/data",data:c,success:function(a){$("#balanceTable").html(a.dataHtml)}})});$("#stockCategoriesTree").jstree(b).bind("select_node.jstree",function(a,c){var f=[];a=$("#stockCategoriesTree").jstree("get_selected",!0);$.each(a,function(){f.push(this.text)});$("#filtered_categories").html(f.join(", "))});$(".room").change(function(){var a=[];if("all_room"!=this.id){var c=0,b=0;$(".room").each(function(){"all_room"!=
this.id&&c++;this.checked&&"all_room"!=this.id&&b++});c==b?($("#all_room").attr("checked","checked").parent().addClass("checked"),$(".room").each(function(){"all_room"!=this.id&&$(this).removeAttr("checked").parent().removeClass("checked")})):$("#all_room").removeAttr("checked").parent().removeClass("checked")}else $(".room").each(function(){"all_room"!=this.id&&$(this).removeAttr("checked").parent().removeClass("checked")});$(".room").each(function(){this.checked&&a.push($(this).data("name"))});
0==a.length&&($("#all_room").attr("checked","checked").parent().addClass("checked"),a.push($("#all_room").data("name")));$("#filtered_rooms").html(a.join(", "))});$("#inventoryBrand").select2({width:null,multiple:!0,minimumInputLength:0,ajax:{url:"/cabinet/stock/index/get-context-search-brands",dataType:"json",delay:100,data:function(a){var b=$(this).val();return{q:a.term,b:function(){return null==b?"":b.join(",")},c:function(){var a=[],b=$("#stockCategoriesTree").jstree("get_selected",!0);$.each(b,
function(){a.push(this.id)});return a}}},cache:!1},placeholder:TR("---All Brands---"),escapeMarkup:function(a){return a},templateResult:stockActions.formatCustomInvoiceBrandsInSelect,templateSelection:stockActions.formatCustomInvoiceBrandsSelectedItem});stockActions.initSelect2Products("#inventoryProduct",{multiple:!0,additionalReturnParams:{c:function(){var a=[],b=$("#stockCategoriesTree").jstree("get_selected",!0);$.each(b,function(){a.push(this.id)});return a},b:function(){var a=$("#inventoryBrand").val();
return null==a?"":a.join(",")}}});$("#stockCategoriesTree").slimScroll({height:"300px"});$("#stockCategoriesTree_q").keyup(function(){$("#stockCategoriesTree").jstree("search",$(this).val())});"en"!=d&&("ua"==d?flatpickr.localize(flatpickr.l10ns.uk):flatpickr.localize(flatpickr.l10ns.ru));$fp=$("#rangeToCopy").flatpickr({mode:"range",inline:!0,defaultDate:[a,e],dateFormat:"Y-m-d",onChange:function(a,b,d){a=$fp.formatDate($fp.selectedDates[0],"Y-m-d");b="undefined"==typeof $fp.selectedDates[1]?a:$fp.formatDate($fp.selectedDates[1],
"Y-m-d");a==b?$("#filtered_ranges").html(a):$("#filtered_ranges").html(TR("date from")+" "+a+" "+TR("date to")+" "+b)}})}};
;
function stockBrandsActionsClass(){this.init=function(){var c=this;$("body").on("click",".registerStockBrand",function(a){var b=$(this).attr("data-brandId");c.initForm(a,b,"create")})};this.initForm=function(c,a,b,d){ajax({url:"/cabinet/stock/brands/get-ajax-form",data:{type:b,default_name:"undefined"===typeof d?"":d,brand_id:a},success:function(a){"undefined"!==typeof a.formHtml&&$("#stockBrandModal").html(a.formHtml).modal("show")}})}};
;
function stockProductsActionsClass(){this.init=function(){var c=this,a=$("body");a.on("click",".registerStockProduct",function(b){var d=$(this).attr("data-productId"),a=$(this).attr("data-categoryId");c.initForm(b,d,a,0==d?"create":"edit")});a.on("click",".exportStockProducts",function(b){b=$(this).attr("data-categoryId");location.href="/cabinet/stock/products/export/"+b});a.on("click",".moveStockProduct",function(b){var a=$(this).attr("data-productId"),e=$(this).attr("data-categoryId");c.initMoveForm(b,
a,e)});a.on("click",".copyStockProduct",function(a){var b=$(this).attr("data-productId"),e=$(this).attr("data-categoryId");c.initCopyForm(a,b,e)})};this.selectStockCategory=function(c){"root"==c&&(c=0);ajax({url:"/cabinet/stock/products/get-products-for-category",data:{category_id:c},success:function(a){$("#productsView").is(":visible")||($("#treeView").hide(),$("#productsView").show(),$(".showStockCategories").show(),$(".showStockProducts").hide());$("#categoryProductsBlock").html(a.html)}})};this.initForm=
function(c,a,b,d){ajax({url:"/cabinet/stock/products/get-ajax-form",data:{type:d,product_id:a,category_id:b},success:function(a){"undefined"!=typeof a.formHtml&&$("#stockProductModal").html(a.formHtml).modal("show")}})};this.initMoveForm=function(c,a,b){ajax({url:"/cabinet/stock/products/get-ajax-move-tree",data:{product_id:a,category_id:b},success:function(a){"undefined"!=typeof a.formHtml&&$("#stockProductModal").html(a.formHtml).modal("show")}})};this.initCopyForm=function(c,a,b){this.initForm(c,
a,b,"copy")};this.initMoveActions=function(c,a){var b=this;$("#new_category_id").hierarchySelect({hierarchy:!0,search:!0,width:"100%"});$("#btnSubmitMoveProductForm").click(function(){var a=$("#newMoveCategoryId").val(),c=$("#newMoveCategoryId").data("productId");stockActions.confirm({text:TR("Do you really want to move the product?"),buttonText:"Ok",cancelAction:function(){$("#stockProductModal").html("").modal("hide")},action:function(){ajax({url:"/cabinet/stock/products/receive-move-ajax",data:{product_id:c,
category_id:a},success:function(c){b.selectStockCategory(a);$("#stockProductModal").html("").modal("hide")}})}})})}};
;
function stockCategoriesActionsClass(){this.treeVirtualMove=!1;this.init=function(){var a=this;$("body").on("click",".registerStockCategory",function(b){var e=$(this).attr("data-parentCategoryId");a.createStockCategory(b,e)});$(function(){var a=!1;$("#stockCategoriesTree_q").keyup(function(){a&&clearTimeout(a);a=setTimeout(function(){var a=$("#stockCategoriesTree_q").val();$("#stockCategoriesTree").jstree(!0).search(a)},250)})})};this.setupTree=function(a){var b=this;this.treeVirtualMove=!1;a.search.search_callback=
stockActions.treesearch;a.core.check_callback=function(a,c,d,g,f){return"#"==d.id?!1:"move_node"!==a&&"copy_node"!==a||!b.treeVirtualMove?("move_node"===a||"copy_node"===a)&&c.type&&"root"==c.type||("move_node"===a||"copy_node"===a)&&f&&f.core&&!confirm(TR("Are you sure you want to move the category?"))?!1:!0:!0};$("#stockCategoriesTree").jstree(a).bind("select_node.jstree",function(a,b){stockCategoriesActions.selectStockCategory(b.node.id)}).on("move_node.jstree",function(a,c){b.treeVirtualMove||
($("#stockCategoriesTree").jstree("open_node",c.parent),$(this),a=$("#stockCategoriesTree").jstree(!0).get_node(c.node.parent,!1).children,ajax({url:"/cabinet/stock/categories/move_category",data:{category_id:c.node.id,parent:c.parent,sort_order:a},success:function(a){}}),stockCategoriesActions.selectStockCategory(c.node.id))});$("#stockCategoriesTree_q2").keyup(function(){$("#stockCategoriesTree").jstree("search",$(this).val())})};this.selectStockCategory=function(a){"undefined"!=typeof stockProductsActions&&
stockProductsActions.selectStockCategory(a)};this.cancelBubble=function(a){a=a?a:window.event;a.stopPropagation&&a.stopPropagation();null!=a.cancelBubble&&(a.cancelBubble=!0)};this.createStockCategory=function(a,b){ajax({url:"/cabinet/stock/categories/get-ajax-form",data:{do:"create",category_id:0,parent_category_id:b},success:function(a){"undefined"!=typeof a.formHtml&&$("#stockCategoryModal").html(a.formHtml).modal("show")}});this.cancelBubble(a)};this.editStockCategory=function(a,b){ajax({url:"/cabinet/stock/categories/get-ajax-form",
data:{do:"edit",category_id:b},success:function(a){"undefined"!=typeof a.formHtml&&$("#stockCategoryModal").html(a.formHtml).modal("show")}});this.cancelBubble(a);this.selectStockCategory(b)};this.deleteStockCategory=function(a,b){stockActions.confirm({text:TR("Are you sure you want to delete the category?\nAll subcategories and related items will be deleted!"),action:function(){ajax({url:"/cabinet/stock/categories/delete-category-ajax",data:{category_id:b},success:function(a){a=$("#stockCategoriesTree").jstree(!0);
var c=a.get_node(b);a.delete_node(c)}})}});this.cancelBubble(a)};this.createTreeNode=function(a,b,e,c,d){var g=this;"undefined"==typeof c&&(c="last");a={id:a,parent:b,text:'<a href="javascript:;" onclick="stockCategoriesActions.editStockCategory(event,'+a+')"><i class="fa fa-pencil"></i></a>&nbsp;<a href="javascript:;" onclick="stockCategoriesActions.createStockCategory(event,'+a+')"><i class="fa fa-plus"></i></a>&nbsp;<a href="javascript:;" onclick="stockCategoriesActions.deleteStockCategory(event,'+
a+')"><i class="fa fa-trash"></i></a>&nbsp;'+e};$("#stockCategoriesTree").jstree().create_node(0==b?"root":b,a,c,function(){$("#stockCategoriesTree").jstree("open_node",0==b?"root":b)},!0);c=eval(d);g.treeVirtualMove=!0;setTimeout(function(){g.treeVirtualMove=!1},1E3);for(var f in c)d=c[f],$("#stockCategoriesTree").jstree("move_node",d.id,0==d.parent_id?"root":d.parent_id,d.position);$("#stockCategoryModal").html("").modal("hide")};this.updateTreeNode=function(a,b,e){b='<a href="javascript:;" onclick="stockCategoriesActions.editStockCategory(event,'+
a+')"><i class="fa fa-pencil"></i></a>&nbsp;<a href="javascript:;" onclick="stockCategoriesActions.createStockCategory(event,'+a+')"><i class="fa fa-plus"></i></a>&nbsp;<a href="javascript:;" onclick="stockCategoriesActions.deleteStockCategory(event,'+a+')"><i class="fa fa-trash"></i></a>&nbsp;'+e;$("#stockCategoriesTree").jstree("set_text",a,b);$("#stockCategoryModal").html("").modal("hide")}};
;
function stockHistoryActionsClass(){this.historyDateEndPicker=this.historyDateStartPicker=null;this.init=function(c,d,b){var a=this;stockActions.initSelect2Products("#historyProduct",{width:400,quietMillis:100}).on("select2:select",function(e){e=e.params.data;var b=$(this).closest(".element-row");a.productTriggerSelect(e,b)}).on("select2:open",function(a){}).on("select2:close",function(a){});"en"!=b&&("ua"==b?flatpickr.localize(flatpickr.l10ns.uk):flatpickr.localize(flatpickr.l10ns.ru));a.historyDateStartPicker=
$("#stockHistoryDateStartContainer");initDateTimePicker(a.historyDateStartPicker);a.historyDateEndPicker=$("#stockHistoryDateEndContainer");initDateTimePicker(a.historyDateEndPicker);$("#buildHistoryTable").click(function(){a.loadHistory()});stockActions.initSimpleSelect2("#stockType",{width:"100%"});stockActions.initSimpleSelect2("#stockRooms",{width:"100%"});stockActions.initSimpleSelect2("#stockFromRooms",{width:"100%"})};this.productTriggerSelect=function(c,d){$("#buildHistoryTable").show()};
this.loadHistory=function(){var c=this.historyDateStartPicker.data("DateTimePicker").date(),d=this.historyDateEndPicker.data("DateTimePicker").date(),b=$("#historyProduct").val();$(".historyData").html("");if(0<b){var a={};a.product_id=b;a.date_start=null===c?"":c.format("YYYY-MM-DD");a.date_end=null===d?"":d.format("YYYY-MM-DD");a.clinics_members_id=$("#stockClinicsMembersId").val();a.supplier_id=$("#stockInvoiceSupplier").val();a.type=$("#stockType").val();a.room=$("#stockRooms").val();a.from_clinics_members_id=
$("#stockFromClinicsMembersId").val();a.from_room=$("#stockFromRooms").val();ajax({url:"/cabinet/stock/history/data",data:a,success:function(a){$(".historyData").html(a.html)}})}}};
;
function stockInventoryActionsClass(){this.inventory_status=this.inventory_id=0;this.STATUS_TEMP=1;this.STATUS_DELETED=2;this.STATUS_CONFIRMED=3;this.STATUS_CLOSED=4;this.init=function(){var c=this,b=$("body");b.on("click",".createStockInventory",function(a){stockActions.confirm({text:TR("Are you sure you want to create an inventory report?"),buttonText:"Ok",action:function(){location.hash="stock/inventory/init"}})});b.on("click",".stockProductInventoryDeleteButton",function(){var a=this;stockActions.confirm({text:TR("Are you sure you want to delete?"),
action:function(){var b=$(a).closest(".element-row"),e=$(a).data("id"),d=$("#stockInventoryId").val();if(""==e)b.remove(),c.recalculateTotalAmount();else{var g={hash:"stock/inventory/delete-item"};g.item_id=e;g.inventory_id=d;ajax({url:"/cabinet/"+g.hash,data:g,success:function(a){b.remove();c.recalculateTotalAmount();$(document).trigger("deletedInventoryElement",[a])}})}}})});b.on("click",".addStockInventoryItem",function(a){c.addStockInventoryItem()});b.on("click",".exportStockInventory",function(a){a=
$(this).data("inventoryId");location.href="/cabinet/stock/inventory/export/"+a});b.on("click",".editStockInventory",function(a){a=$(this).data("id");location.hash="stock/inventory/edit/"+a});b.on("click",".autoStockInventory",function(a){var b=this;stockActions.confirm({text:TR("Are you sure you want to fill in the blank inventory fields automatically?"),buttonText:"Ok",action:function(){ajax({url:"/cabinet/stock/inventory/auto",data:{inventory_id:$(b).data("id")},success:function(a){if("success"==
a.status)alert(TR("The inventory report has been successfully completed")),locationHashChanged();else{alert(a.message);var b=0,c;for(c in a.errors){b++;1==b&&$("#"+c).focus();var f=a.errors[c];$("#error_"+c).html(f)}}}})}})});b.on("click",".doneStockInventory",function(a){var b=this;stockActions.confirm({text:TR("Are you sure you want to take inventory?\nIt will not be possible to edit it in the future"),buttonText:"Ok",action:function(){$(".formError").html("");ajax({url:"/cabinet/stock/inventory/done",
data:{inventory_id:$(b).data("id")},success:function(a){if("success"==a.status)locationHashChanged();else{alert(a.message);var b=0,c;for(c in a.errors){b++;1==b&&$("#"+c).focus();var f=a.errors[c];$("#error_"+c).html(f)}}}})}})})};this.recalculateTotalAmount=function(){var c=0;$(".postDataRealPrice").each(function(){""!=$(this).val()&&(c+=parseFloat($(this).val().replace(/&nbsp;/gi,"").replace(/ /gi,"")))});$(".stockInventoryTotalRealPrice",$(".dataTables_scrollFoot")).html(stockActions.priceFormat(c));
$(".stockInventoryTotalRealPrice").html(stockActions.priceFormat(c))};this.initForm=function(c,b){var a=this;a.inventory_id=c;a.inventory_status=b;a.inventory_status===a.STATUS_TEMP&&($scannerDetection=$(document).scannerDetection({timeBeforeScanTest:200,endChar:[13],avgTimeByChar:40,ignoreIfFocusOn:"input",stopPropagation:!0,preventDefault:!0,onComplete:function(a,b){ajax({url:"/cabinet/stock/index/detect-product-from-barcode",data:{barcode:a},success:function(a){"0"==a.product?alert(TR("Item not found!")):
"undefined"==typeof $("input.postDataRealCountMeasure[data-product="+a.product.id+"]").get(0)?alert(TR("The product was not found in the inventory report!")):$("input.postDataRealCountMeasure[data-product="+a.product.id+"]").focus()}})},scanButtonKeyCode:116,scanButtonLongPressThreshold:5,onScanButtonLongPressed:function(){},onError:function(a){}}),$("input.input-number").numeric({negative:!1,decimal:"."}),$("input.input-number-negative").numeric({negative:!0,decimal:"."}),$(".postDataRealCountMeasure").change(function(b,
c){a.saveInventoryRow(this,!0,b,c)}),$(".postDataRealCountDimension").change(function(b,c){a.saveInventoryRow(this,!0,b,c)}),$(".postDataRealPrice").change(function(b,c){a.saveInventoryRow(this,!1,b,c)}));$(".createStockCorrectionInvoice").click(function(){stockActions.confirm({text:TR("Are you sure you want to create an adjustment report?"),buttonText:"Ok",action:function(){ajax({url:"/cabinet/stock/inventory/create-correction-invoice",data:{inventory_id:a.inventory_id},success:function(a){alert(TR("Correction invoice successfully created"));
location.hash="undefined"!=typeof a.invoices_id?"stock/invoices/edit/"+a.invoices_id:"stock/invoices/index/3"}})}})})};this.addStockInventoryItem=function(){var c=stockActions.renderTemplate("addInventoryRowTemplate");$("#newStockInventoryProducts").append(c);this.setupStockInvoiceProductMultiselect();stockActions.initSimpleSelect2(".stockRooms")};this.saveInventoryRow=function(c,b,a,f){var e=this;e.recalculateTotalAmount();var d=$(c).closest(".element-row");c="undefined"!=typeof $(c).data("id")?
$(c).data("id"):0;ajax({url:"/cabinet/stock/inventory/save-item",data:{id:c,recalculate_item_price:b?1:0,inventory_id:e.inventory_id,real_count_measure:$(".postDataRealCountMeasure",d).val(),real_count_dimension:$(".postDataRealCountDimension",d).val(),real_price:$(".postDataRealPrice",d).val(),room:$(".stockRooms",d).val(),product:$(".stockProducts",d).val()},success:function(a){"undefined"!=typeof a.new_item_id&&($(".stockRooms",d).removeAttr("disabled"),$(".postDataRealCountMeasure",d).removeAttr("disabled"),
$(".postDataRealCountDimension",d).removeAttr("disabled"),$(".postDataRealPrice",d).removeAttr("disabled"),$(".stockProducts",d).attr("data-id",a.new_item_id),$(".stockRooms",d).attr("data-id",a.new_item_id),$(".postDataRealCountMeasure",d).attr("data-id",a.new_item_id).attr("id","count_"+a.new_item_id),$(".postDataRealCountDimension",d).attr("data-id",a.new_item_id),$(".postDataRealPrice",d).attr("data-id",a.new_item_id).attr("id","price_"+a.new_item_id),$(".stockProductInventoryDeleteButton",d).attr("data-id",
a.new_item_id));"undefined"!=typeof a.class&&($(".postDataRealCountMeasure",d).removeClass("equalData").removeClass("moreData").removeClass("lessData"),$(".postDataRealCountDimension",d).removeClass("equalData").removeClass("moreData").removeClass("lessData"),$(".postDataRealCountMeasure",d).addClass(a.class),$(".postDataRealCountDimension",d).addClass(a.class));"undefined"!=typeof a.newPrice&&($(".postDataRealPrice",d).val(a.newPrice),e.recalculateTotalAmount());"undefined"!=typeof f&&"undefined"!=
typeof f.skipScroll&&(a.skipScroll=!0);$(document).trigger("changedInvoiceElement",[a])}})};this.setupStockInvoiceProductMultiselect=function(){$this=this;$("input.input-number").numeric({negative:!0,decimal:"."});$(".postDataRealCountMeasure").change(function(){$this.saveInventoryRow(this,!0)});$(".postDataRealCountDimension").change(function(){$this.saveInventoryRow(this,!0)});$(".postDataRealPrice").change(function(){$this.saveInventoryRow(this,!1)});$(".stockRooms").change(function(){$this.saveInventoryRow(this,
!0)});stockActions.initSelect2Products(".stockMultiselect2",{additionalReturnParams:{d:"short"}}).on("select2:select",function(c){c=c.params.data;var b=$(this).closest(".element-row"),a=c.photo_brand;""==a&&(a="/a/nophoto-brand.jpg");$(".brand_name",b).html('<span class="tableEntryWithAvatar showStockBrandModal" data-stockbrandsid="'+c.brand_id+'"><img src="'+a+'"  spsourceindex="'+c.brand_id+'">'+c.brand_name+"</span>");$(".product_code",b).html(c.code);$(".stockProductsMeasureSize",b).html(c.measure_name+
"["+c.dimensions_value+c.dimensions_name+"]");$(".measure_name",b).html(c.measure_name);$(".dimension_name",b).html(c.dimensions_name);"undefined"!=typeof $(this).data("id")&&$(this).data("id");$this.saveInventoryRow(this,!0)}).removeClass("stockMultiselect2")};this.initFilters=function(c){$("#stockCategoriesTree").jstree(c).bind("select_node.jstree",function(b,a){});$("#inventoryBrand").select2({width:null,multiple:!0,minimumInputLength:0,ajax:{url:"/cabinet/stock/index/get-context-search-brands",
dataType:"json",delay:100,data:function(b){var a=$(this).val();return{q:b.term,without_brand_name:1,b:function(){return null==a?"":a.join(",")},c:function(){var a=[],b=$("#stockCategoriesTree").jstree("get_selected",!0);$.each(b,function(){a.push(this.id)});return a}}},cache:!1},placeholder:TR("---All Brands---"),escapeMarkup:function(b){return b},templateResult:stockActions.formatCustomBrandsInSelect2,templateSelection:stockActions.formatCustomBrandsSelectedItemInSelect2});stockActions.initSelect2Products("#inventoryProduct",
{multiple:!0,additionalReturnParams:{c:function(){var b=[],a=$("#stockCategoriesTree").jstree("get_selected",!0);$.each(a,function(){b.push(this.id)});return b},b:function(){var b=$("#inventoryBrand").val();return null==b?"":b.join(",")}}});$("#stockCategoriesTree").slimScroll({height:"300px"});$("#stockCategoriesTree_q").keyup(function(){$("#stockCategoriesTree").jstree("search",$(this).val())});$("#addStockInventoryItem").click(function(){var b=[],a=$("#stockCategoriesTree").jstree("get_selected",
!0);$.each(a,function(){b.push(this.id)});a=$("#inventoryBrand").val();a=null==a?"":a.join(",");var c=$("#inventoryProduct").val();c=null==c?"":c.join(",");var e=[];$(".room").each(function(){this.checked&&e.push(this.value)});ajax({url:"/cabinet/stock/inventory/create",data:{categories:b,brands:a,products:c,comments:$("#inventoryComment").val(),rooms:e.join(","),date:$("#stockInventoryDate").val()},success:function(a){a.inventory_id&&(location.hash="stock/inventory/edit/"+a.inventory_id)}})});$(".room").change(function(){var b=
[];if("all_room"!=this.id){var a=0,c=0;$(".room").each(function(){"all_room"!=this.id&&a++;this.checked&&"all_room"!=this.id&&c++});a==c?($("#all_room").attr("checked","checked").parent().addClass("checked"),$(".room").each(function(){"all_room"!=this.id&&$(this).removeAttr("checked").parent().removeClass("checked")})):$("#all_room").removeAttr("checked").parent().removeClass("checked")}else $(".room").each(function(){"all_room"!=this.id&&$(this).removeAttr("checked").parent().removeClass("checked")});
$(".room").each(function(){this.checked&&b.push($(this).data("name"))});0==b.length&&($("#all_room").attr("checked","checked").parent().addClass("checked"),b.push($("#all_room").data("name")))})}};
;
function stockInvoicesActionsClass(){this.invoice_id=this.invoice_type=this.invoice_status=0;this.TYPE_INCOME=1;this.TYPE_MOVE=2;this.TYPE_CORRECTION=3;this.TYPE_RETURN=4;this.TYPE_WRITE_OFF=5;this.STATUS_TEMP=1;this.STATUS_DELETED=2;this.STATUS_CONFIRMED=3;this.postTimers=null;this.init=function(){var a=this,b=$("body");b.on("click",".stockProductInvoicesDeleteButton",function(){var d=this;stockActions.confirm({text:TR("Are you sure you want to delete?"),action:function(){var e=$(d).closest(".element-row"),
c=$(d).data("id"),f=$("#stockInvoiceId").val();"undefined"==typeof f&&(f=$(d).data("invoice"));if("undefined"===typeof c)e.remove(),a.recalculateTotalAmount();else{var k={hash:"stock/invoices/delete-item"};k.item_id=c;k.invoice_id=f;ajax({url:"/cabinet/"+k.hash,data:k,success:function(c){e.remove();a.recalculateTotalAmount();$(document).trigger("deletedInvoiceElement",[c])}})}}})});b.on("change",".postInvoice",function(d,e){null!=a.postTimers&&(clearTimeout(a.postTimers),a.postTimers=null);d=$(this);
a.changeElement(d,e)});b.on("click",".registerStockInvoice",function(a){stockActions.confirm({text:TR("Are you sure you want to create a new invoice?"),buttonText:"Ok",action:function(){var a={hash:"stock/invoices/create",type:1};ajax({url:"/cabinet/"+a.hash,data:a,success:function(c){showAjaxData(c);"undefined"!=typeof c.new_location_hash&&(window.removeEventListener("hashchange",locationHashChanged),location.hash=c.new_location_hash,setTimeout(function(){window.addEventListener("hashchange",locationHashChanged,
!1)},1))}})}})});b.on("click",".registerReturnStockInvoice",function(a){stockActions.confirm({text:TR("Are you sure you want to create a new return invoice?"),buttonText:"Ok",action:function(){var a={hash:"stock/invoices/create",type:4};ajax({url:"/cabinet/"+a.hash,data:a,success:function(c){showAjaxData(c);"undefined"!==typeof c.new_location_hash&&(window.removeEventListener("hashchange",locationHashChanged),location.hash=c.new_location_hash,setTimeout(function(){window.addEventListener("hashchange",
locationHashChanged,!1)},1))}})}})});b.on("click",".registerMoveStockInvoice",function(a){stockActions.confirm({text:TR("Are you sure you want to create a new move invoice?"),buttonText:"Ok",action:function(){var a={hash:"stock/invoices/create",type:2};ajax({url:"/cabinet/"+a.hash,data:a,success:function(c){showAjaxData(c);"undefined"!==typeof c.new_location_hash&&(window.removeEventListener("hashchange",locationHashChanged),location.hash=c.new_location_hash,setTimeout(function(){window.addEventListener("hashchange",
locationHashChanged,!1)},1))}})}})});b.on("click",".registerWriteOffStockInvoice",function(a){stockActions.confirm({text:TR("Are you sure you want to create a new write-off invoice?"),buttonText:"Ok",action:function(){var a={hash:"stock/invoices/create",type:5};ajax({url:"/cabinet/"+a.hash,data:a,success:function(a){showAjaxData(a);"undefined"!==typeof a.new_location_hash&&(window.removeEventListener("hashchange",locationHashChanged),location.hash=a.new_location_hash,setTimeout(function(){window.addEventListener("hashchange",
locationHashChanged,!1)},1))}})}})});b.on("click",".copyStockInvoice",function(a){var d=$(this).attr("data-id");stockActions.confirm({text:TR("Are you sure you want to copy the invoice?"),buttonText:"Ok",action:function(){var a={hash:"stock/invoices/copy"};a.parent_invoices_id=d;ajax({url:"/cabinet/"+a.hash,data:a,success:function(a){showAjaxData(a);"undefined"!=typeof a.new_location_hash&&(window.removeEventListener("hashchange",locationHashChanged),location.hash=a.new_location_hash,setTimeout(function(){window.addEventListener("hashchange",
locationHashChanged,!1)},1))}})}})});b.on("click",".editStockInvoice",function(a){location.hash="stock/invoices/edit/"+$(this).data("id")});b.on("click",".exportStockInvoice",function(a){a=$(this).data("invoiceId");location.href="/cabinet/stock/invoices/export/"+a});b.on("click",".export2MoveStockInvoice",function(a){var b=this;stockActions.confirm({text:TR("Do you really want to create an invoice move based on the invoice?"),buttonText:"Ok",action:function(){var a=$(b).data("invoiceId"),f={hash:"stock/invoices/export2MoveStockInvoice"};
f.invoice_id=a;ajax({url:"/cabinet/"+f.hash,data:f,success:function(a){showAjaxData(a);"undefined"!==typeof a.new_location_hash&&(window.removeEventListener("hashchange",locationHashChanged),location.hash=a.new_location_hash,setTimeout(function(){window.addEventListener("hashchange",locationHashChanged,!1)},1))}})}})});b.on("click",".export2ReturnStockInvoice",function(a){var b=this;stockActions.confirm({text:TR("Do you really want to create a return invoice based on the invoice?"),buttonText:"Ok",
action:function(){var a=$(b).data("invoiceId"),f={hash:"stock/invoices/export2ReturnStockInvoice"};f.invoice_id=a;ajax({url:"/cabinet/"+f.hash,data:f,success:function(a){showAjaxData(a);"undefined"!==typeof a.new_location_hash&&(window.removeEventListener("hashchange",locationHashChanged),location.hash=a.new_location_hash,setTimeout(function(){window.addEventListener("hashchange",locationHashChanged,!1)},1))}})}})});b.on("click",".export2WriteOffStockInvoice",function(a){var b=this;stockActions.confirm({text:TR("Do you really want to create an invoice write-off based on the invoice?"),
buttonText:"Ok",action:function(){var a=$(b).data("invoiceId"),f={hash:"stock/invoices/export2WriteOffStockInvoice"};f.invoice_id=a;ajax({url:"/cabinet/"+f.hash,data:f,success:function(a){showAjaxData(a);"undefined"!==typeof a.new_location_hash&&(window.removeEventListener("hashchange",locationHashChanged),location.hash=a.new_location_hash,setTimeout(function(){window.addEventListener("hashchange",locationHashChanged,!1)},1))}})}})});b.on("click",".doneStockInvoice",function(a){var b=this;stockActions.confirm({text:TR("Are you sure you want to create an invoice?\nIt will not be possible to edit it in the future"),
buttonText:"Ok",action:function(){$(".formError").html("");ajax({url:"/cabinet/stock/invoices/done",data:{invoice_id:$(b).data("id")},success:function(a){if("success"===a.status)locationHashChanged();else{alert(a.message);for(var c in a.errors){var b=a.errors[c];$("#"+c).html(b)}}}})}})})};this.initListFilters=function(a){var b=this;stockActions.initSelect2Products("#invoiceProduct",{multiple:!0}).on("select2:select",function(d){b.refreshInvoicesListData(a,$(this).val())}).on("select2:unselect",function(d){b.refreshInvoicesListData(a,
$(this).val());d.stopImmediatePropagation();d.preventDefault()})};this.refreshInvoicesListData=function(a,b){$("#invoicesListTable").html("");ajax({url:"/cabinet/stock/invoices/table/"+a+"/"+(null===b?"":b.join(",")),success:function(a){$("#invoicesListTable").html(a.html)}})};this.recalculateTotalAmount=function(){var a=0;$(".stockProductTotalPrice").each(function(){""!==$(this).html()&&(a+=parseFloat($(this).html().replace(/&nbsp;/gi,"").replace(/ /gi,"")))});$("#totalAmount").html(stockActions.priceFormat(a))};
this.changeElement=function(a,b){var d=this,e=a.data("filter"),c=a.get(0).type,f=a.data("name");e=stockActions.filteredValue(a.val(),e);var k=$("#stockInvoiceId").val();"undefined"==typeof k&&(k=a.data("invoice"));var h={},g=a.closest(".element-row");h.hash="stock/invoices/save";h.invoice_id=k;h.name=f;h.value="checkbox"===c?a.get(0).checked?1:0:e;if("count"===f||"products"===f||"price"===f||"dimension_type"===f){if(h.item_id="{INVOICE_ITEM_ID}"==a.data("id")?a.attr("data-id"):a.data("id"),"undefined"==
typeof h.item_id&&(c=stockActions.filteredValue($(".stockProductCount",g).val(),"float"),f=stockActions.filteredValue($(".stockProductPrice",g).val(),"float"),a=stockActions.filteredValue($(".stockProducts",g).val(),"int"),e=stockActions.filteredValue($(".stockProductsDimensionType",g).val(),"int"),h.name="new_item",h.value={count:c,price:f,product:a,dimension_type:e},0===a))return!1}else if("count_d"==f||"count_m"==f)if(h.item_id="{INVOICE_ITEM_ID}"==a.data("id")?a.attr("data-id"):a.data("id"),c=
stockActions.filteredValue($(".postDataRealCountMeasure",g).val(),"float"),f=stockActions.filteredValue($(".postDataRealCountDimension",g).val(),"float"),"undefined"==typeof h.item_id){if(a=stockActions.filteredValue($(".stockProducts",g).val(),"int"),h.name="new_item",h.value={count_d:f,count_m:c,product:a},0===a)return!1}else h.name="count",h.value=[c,f];ajax({url:"/cabinet/"+h.hash,data:h,success:function(a){"new_item"==h.name&&"undefined"!==typeof a.new_item_id&&($(".stockProductCount",g).attr("data-id",
a.new_item_id),$(".stockProductPrice",g).attr("data-id",a.new_item_id),$(".stockProducts",g).attr("data-id",a.new_item_id),$(".stockProducts",g).attr("data-productId",$(".stockProducts",g).val()),$(".stockProductsDimensionType",g).attr("data-id",a.new_item_id),$(".stockProductInvoicesDeleteButton",g).attr("data-id",a.new_item_id),$(".formError",g).each(function(){var c=$(this).attr("id");$(this).attr("id",c.replace(/{INVOICE_ITEM_ID}/i,a.new_item_id))}));"undefined"!=typeof a.count_m&&$(".postDataRealCountMeasure",
g).val(a.count_m);"undefined"!=typeof a.count_d&&$(".postDataRealCountDimension",g).val(a.count_d);"undefined"!=typeof a.refreshSum&&($(".stockProductTotalPrice",g).html(stockActions.priceFormat(a.refreshSum)),d.recalculateTotalAmount());"undefined"!==typeof a.refreshPrice&&$(".stockProductPrice",g).val(a.refreshPrice);"undefined"!==typeof a.criticalBalance&&(1==a.criticalBalance?$(".stockProductCount",g).addClass("lessData"):$(".stockProductCount",g).removeClass("lessData"));"undefined"!==typeof a.refreshBalance&&
$(".balances",g).html(a.refreshBalance);"undefined"!==typeof a.locationRefresh&&locationHashChanged();"undefined"!=typeof b&&"undefined"!=typeof b.skipScroll&&(a.skipScroll=!0);$(document).trigger("changedInvoiceElement",[a])}})};this.addStockInvoiceItem=function(a,b){if("undefined"===typeof a){var d=stockActions.renderTemplate("addInvoiceRowTemplate");$("#newStockInvoiceProducts").append(d);this.setupStockInvoiceProductMultiselect();$("input.input-number").numeric({negative:!1,decimal:"."});$("input.input-number-negative").numeric({negative:!0,
decimal:"."})}else $row=$(".stockProducts[data-productid="+a.id+"]"),0===$row.length?(d=stockActions.renderTemplate("addInvoiceRowTemplate"),$("#newStockInvoiceProducts").append(d),this.setupStockInvoiceProductMultiselect(a,b),$("input.input-number").numeric({negative:!1,decimal:"."}),$("input.input-number-negative").numeric({negative:!0,decimal:"."})):(a=$row.closest(".element-row"),b=stockActions.filteredValue($(".stockProductCount",a).val(),"float")+b,$(".stockProductCount",a).val(b).trigger("keyup").trigger("change"));
stockActions.initSimpleSelect2(".stockProductsDimensionType")};this.initForm=function(a,b,d){var e=this;e.invoice_status=b;e.invoice_type=d;e.invoice_id=a;stockActions.initSimpleSelect2(".stockProductsDimensionType");stockActions.initSimpleSelect2("#stockInvoiceFromRoom");stockActions.initSimpleSelect2("#stockInvoiceRoom");$("select.stockProducts").each(function(a){$(this).val($(this).attr("data-productId")).trigger("change.select2")});$("input.input-number").numeric({negative:!1,decimal:"."});$("input.input-number-negative").numeric({negative:!0,
decimal:"."});a=$("#stockInvoiceFormDate");initDateTimePicker(a);a.datetimepicker().on("dp.change",function(a){e.changeElement($("#stockInvoiceDate"))});$(".addStockProduct2Invoice").click(function(){e.addStockInvoiceItem()});e.setupStockInvoiceProductMultiselect();if(e.invoice_type===e.TYPE_INCOME)$("#invoicesOrders").select2({width:null,multiple:!0,minimumInputLength:0,ajax:{url:"/cabinet/stock/index/get-context-search-orders",dataType:"json",delay:100,data:function(a){var c=$(this).val();return{q:a.term,
b:function(){return null==c?"":c.join(",")},s:function(){return $("#stockInvoiceSupplier").val()}}},cache:!1},placeholder:TR("---Select order---"),escapeMarkup:function(a){return a},templateSelection:function(a){return'<a href="/cabinet#stock/orders/edit/'+a.id+'" target="_blank">'+a.text+"</a>"}}).on("select2:select",function(a){setTimeout(function(){ajax({url:"/cabinet/stock/invoices/add-order",data:{invoices_id:e.invoice_id,order_id:a.params.data.id},success:function(a){locationHashChanged()}})},
100)}).on("select2:unselect",function(a){ajax({url:"/cabinet/stock/invoices/delete-order",async:!1,data:{invoices_id:e.invoice_id,order_id:a.params.data.id},success:function(a){locationHashChanged()}});a.stopImmediatePropagation();a.preventDefault()});e.invoice_status===e.STATUS_TEMP&&($scannerDetection=$(document).scannerDetection({timeBeforeScanTest:200,endChar:[13],avgTimeByChar:40,ignoreIfFocusOn:"input",onComplete:function(a,b){ajax({url:"/cabinet/stock/index/detect-product-from-barcode",data:{barcode:a},
success:function(a){"0"==a.product?alert(TR("Item not found!")):e.addStockInvoiceItem(a.product,b)}})},scanButtonKeyCode:116,scanButtonLongPressThreshold:5,onScanButtonLongPressed:function(){},onError:function(a){}}),e.invoice_type===e.TYPE_INCOME&&$("#stockInvoiceSupplier").change(function(a){var b=$(this).val();0==b?$("#invoicesOrders").attr("disabled","disabled"):$("#invoicesOrders").removeAttr("disabled","disabled");if(OLD_SUPPLIER_ID==b)return!1;null!=$("#invoicesOrders").val()&&stockActions.confirm({text:TR("If you change the supplier, the orders tied to it will be healed!\nDo you agree?"),
buttonText:"Ok",cancelAction:function(){$("#stockInvoiceSupplier").val(OLD_SUPPLIER_ID).trigger("change")},action:function(){$("#invoicesOrders").val("").trigger("change");OLD_SUPPLIER_ID=b}})}))};this.setupStockInvoiceProductMultiselect=function(a,b){var d=this;$(".stockProductCount").keyup(function(){var a=$(this).closest(".element-row"),b=stockActions.filteredValue($(this).val(),"float"),c=stockActions.filteredValue($(".stockProductPrice",a).val(),"float");$(".stockProductTotalPrice",a).html(stockActions.priceFormat(b*
c));d.recalculateTotalAmount()});$(".stockProductCount").change(function(){var a=$(this).closest(".element-row"),b=stockActions.filteredValue($(this).val(),"float"),c=stockActions.filteredValue($(".stockProductPrice",a).val(),"float");$(".stockProductTotalPrice",a).html(stockActions.priceFormat(b*c));d.recalculateTotalAmount()});$(".stockProductPrice").keyup(function(){var a=$(this).closest(".element-row"),b=stockActions.filteredValue($(this).val(),"float"),c=stockActions.filteredValue($(".stockProductCount",
a).val(),"float");$(".stockProductTotalPrice",a).html(stockActions.priceFormat(c*b));d.recalculateTotalAmount()});stockActions.initSelect2Products(".stockMultiselect2",{quietMillis:100,additionalReturnParams:{d:d.invoice_type==(d.TYPE_INCOME||d.TYPE_RETURN)?"full":"short",p:function(){var a=[];$(".stockProducts").each(function(b){b=$(this).val();a.push(b)});return a.join(",")}}}).on("select2:select",function(a){a=a.params.data;var b=$(this).closest(".element-row");d.productTriggerSelect(a,b)}).on("select2:open",
function(a){stockActions.lastMultiselectElement=$(this)}).on("select2:close",function(a){});if("undefined"!=typeof a){var e=$(".stockMultiselect2")[0],c=$(e).closest(".element-row"),f=new Option(a.text,a.id,!0,!0);$(".stockProductCount",c).val(b);$(e).append(f).trigger("change");d.productTriggerSelect(a,c)}$(".stockMultiselect2").removeClass("stockMultiselect2");d.invoice_status==d.STATUS_TEMP&&$(".stockProductCount").TouchSpin({min:0,max:1E9,firstclickvalueifempty:1,stepinterval:50,maxboostedstep:1E7})};
this.productTriggerSelect=function(a,b){if(this.invoice_type==this.TYPE_INCOME||this.invoice_type==this.TYPE_RETURN){var d=$(".stockProductsDimensionType",b),e=d.val(),c=d.get(0);c.length=0;a.measures_id==stockActions.FORMAT_TYPE_MEASURE_NONE?(c.options[c.options.length]=new Option(a.dimensions_name,stockActions.FORMAT_TYPE_DIMENSION),e=stockActions.FORMAT_TYPE_DIMENSION):(c.options[c.options.length]=new Option(a.measure_name,stockActions.FORMAT_TYPE_MEASURE),c.options[c.options.length]=new Option(a.dimensions_name,
stockActions.FORMAT_TYPE_DIMENSION),"undefined"===typeof e&&(e=stockActions.FORMAT_TYPE_MEASURE));d.val(e).removeAttr("disabled");d.trigger("select2:change")}else $(".stock-product-list-m",b).html(a.measure_name),$(".stock-product-list-d",b).html(a.dimensions_name),a.measures_id==stockActions.FORMAT_TYPE_MEASURE_NONE?$(".measureTypeCountField",b).css("display","none"):($(".measureTypeCountField",b).css("display","table-cell"),$(".measureTypeCountField",b).addClass("tablCell"));$(".stockProductPrice",
b).removeAttr("disabled");$(".stockProductCount",b).removeAttr("disabled");$(".stockProducts",b).attr("data-productId",$(".stockProducts",b).val())}};
;
function stockMaterialsActionsClass(){this.postTimers=null;this.init=function(){var a=this,b=$("body");b.on("click",".stockProductMaterialsDeleteButton",function(){var a=this;stockActions.confirm({text:TR("Are you sure you want to delete?"),action:function(){var c=$(a).closest(".element-row"),b=$(a).data("id"),d=$("#stockInvoiceId").val();"undefined"==typeof d&&(d=$(a).data("invoice"));"undefined"===typeof b?c.remove():(d={hash:"stock/materials/delete-item"},d.item_id=b,ajax({url:"/cabinet/"+d.hash,
data:d,success:function(a){c.remove();$(document).trigger("deletedMaterialsElement",[a])}}))}})});b.on("click",".stockMaterialsProductDeleteButton",function(){var a=this;stockActions.confirm({text:TR("Are you sure you want to delete?"),action:function(){var b=$(a).closest(".element-row");$(a).data("id");$("#stockInvoiceId").val();unsavedChanges=1;b.remove()}})});b.on("change",".checkChangeMaterial",function(){unsavedChanges=1});b.on("change",".postMaterial",function(b,f){null!=a.postTimers&&(clearTimeout(a.postTimers),
a.postTimers=null);b=$(this);a.changeElement(b,f)});b.on("click",".addStockProduct2Material",function(b){b=$(this).data("price");a.addStockMaterialItem(b)});b.on("click",".addStockProduct2Manipulation",function(b){b=$(this).data("planItemId");a.addStockProduct2Manupulation(b)});b.on("click",".removeMaterialGroupItem",function(a){var b=$(this).data("price");stockActions.confirm({text:TR("Are you sure you want to delete?"),action:function(){var a={hash:"stock/materials/delete-items"};a.priceItemsId=
b;ajax({url:"/cabinet/"+a.hash,data:a,success:function(a){$("#products"+b).html("")}})}})});b.on("click",".deleteWriteOffInvoice",function(a){var b=$(this).data("invoice"),c=$(this).data("patient");stockActions.confirm({text:TR("Are you sure you want to delete?"),action:function(){var a={};a.hash="invoices/delete-stock-invoice/"+b;ajax({url:"/cabinet/"+a.hash,data:a,success:function(a){unsavedChanges=!1;location.hash="#invoices-and-payments/list/"+c}})}})});b.on("click",".saveWriteOffInvoice",function(a){unsavedChanges=
!1;var b={},c=0,d=0,k=0,e=0,g=0,l=0;$(".stockProducts").each(function(){d=$(this).val();c=$(this).data("price");k=$("#stock-product-count-m-"+c+"-"+d).val();e=$("#stock-product-count-d-"+c+"-"+d).val();g=$("#priceItemsCount"+c).val();l=$("#priceItemsGroup"+c).val();0<d&&0<k+e&&("undefined"==typeof b[c]&&(b[c]={}),"undefined"==typeof b[c][d]&&(b[c][d]={}),b[c][d]={count_m:k,count_d:e,priceItemsCount:g,priceItemsGroup:l})});a=$(this).data("invoice");ajax({url:"/cabinet/invoices/write-off-save-invoice/"+
a,data:{data:b,clinics_members_id:$("#stockFromClinicsMembersId").val(),rooms_id:$("#writeOffRoomsId").val()},success:function(a){locationHashChanged()}})});$("input.input-number").numeric({negative:!1,decimal:"."});$("input.input-number-negative").numeric({negative:!0,decimal:"."});a.setupProductMultiselect()};this.changeElement=function(a,b){var c=a.data("filter"),f=a.get(0).type,h=a.data("name"),d=a.data("price");c=stockActions.filteredValue(a.val(),c);var k=$("#stockInvoiceId").val();"undefined"==
typeof k&&(k=a.data("invoice"));var e={},g=a.closest(".element-row");e.hash="stock/materials/save";e.invoice_id=k;e.name=h;e.value="checkbox"===f?a.get(0).checked?1:0:c;if("count"===h||"products"===h){if(e.item_id="{PRICE_PRODUCTS_ITEM_ID}"==a.data("id")?a.attr("data-id"):a.data("id"),"undefined"==typeof e.item_id&&(f=stockActions.filteredValue($(".stockProductCount",g).val(),"float"),a=stockActions.filteredValue($(".stockProducts",g).val(),"int"),h=stockActions.filteredValue($(".stockProductsDimensionType",
g).val(),"int"),e.name="new_item",e.value={count:f,price:d,product:a,dimension_type:h},0===a))return!1}else if("count_d"==h||"count_m"==h)if(e.item_id="{PRICE_PRODUCTS_ITEM_ID}"==a.data("id")?a.attr("data-id"):a.data("id"),d=stockActions.filteredValue($(".postDataRealCountMeasure",g).val(),"float"),f=stockActions.filteredValue($(".postDataRealCountDimension",g).val(),"float"),"undefined"==typeof e.item_id){if(a=stockActions.filteredValue($(".stockProducts",g).val(),"int"),e.name="new_item",e.value=
{count_d:f,count_m:d,product:a},0===a)return!1}else e.name="count",e.value=[d,f];ajax({url:"/cabinet/"+e.hash,data:e,success:function(a){"new_item"==e.name&&"undefined"!==typeof a.new_item_id&&($(".stockProductCount",g).attr("data-id",a.new_item_id),$(".stockProductPrice",g).attr("data-id",a.new_item_id),$(".stockProducts",g).attr("data-id",a.new_item_id),$(".stockProducts",g).attr("data-productId",$(".stockProducts",g).val()),$(".stockProductsDimensionType",g).attr("data-id",a.new_item_id),$(".stockProductMaterialsDeleteButton",
g).attr("data-id",a.new_item_id),$(".formError",g).each(function(){var b=$(this).attr("id");$(this).attr("id",b.replace(/{PRICE_PRODUCTS_ITEM_ID}/i,a.new_item_id))}));"undefined"!=typeof a.count_m&&$(".postDataRealCountMeasure",g).val(a.count_m);"undefined"!=typeof a.count_d&&$(".postDataRealCountDimension",g).val(a.count_d);"undefined"!==typeof a.locationRefresh&&locationHashChanged();"undefined"!=typeof b&&"undefined"!=typeof b.skipScroll&&(a.skipScroll=!0);$(document).trigger("changedMaterialsElement",
[a])}})};this.addStockMaterialItem=function(a,b,c){if("undefined"===typeof b){var f=stockActions.renderTemplate("addMaterialRowTemplate",{PRICE_ID:a});$("#products"+a).append(f);this.setupProductMultiselect(a);$("input.input-number").numeric({negative:!1,decimal:"."});$("input.input-number-negative").numeric({negative:!0,decimal:"."})}else $row=$(".stockProducts[data-productid="+b.id+"]"),0===$row.length?(f=stockActions.renderTemplate("addInvoiceRowTemplate"),$("#newStockInvoiceProducts").append(f),
this.setupProductMultiselect(a,b,c),$("input.input-number").numeric({negative:!1,decimal:"."}),$("input.input-number-negative").numeric({negative:!0,decimal:"."})):(a=$row.closest(".element-row"),c=stockActions.filteredValue($(".stockProductCount",a).val(),"float")+c,$(".stockProductCount",a).val(c).trigger("keyup").trigger("change"))};this.addStockProduct2Manupulation=function(a,b,c){if("undefined"===typeof b){var f=stockActions.renderTemplate("addMaterialRowTemplate",{PRICE_ITEM_ID:a});c=$(".element-manipulations-products-"+
a).last();0==c.length&&(c=$("#manipulationItem_"+a));$(f).insertAfter(c);this.setupProductMultiselect(a);$("input.input-number").numeric({negative:!1,decimal:"."});$("input.input-number-negative").numeric({negative:!0,decimal:"."})}else $row=$(".stockProducts[data-productid="+b.id+"]"),0===$row.length?(f=stockActions.renderTemplate("addInvoiceRowTemplate"),$("#newStockInvoiceProducts").append(f),this.setupProductMultiselect(a,b,c),$("input.input-number").numeric({negative:!1,decimal:"."}),$("input.input-number-negative").numeric({negative:!0,
decimal:"."})):(a=$row.closest(".element-row"),c=stockActions.filteredValue($(".stockProductCount",a).val(),"float")+c,$(".stockProductCount",a).val(c).trigger("keyup").trigger("change"))};this.initForm=function(){$("input.input-number").numeric({negative:!1,decimal:"."});$("input.input-number-negative").numeric({negative:!0,decimal:"."});this.setupProductMultiselect();$("select.stockProducts").each(function(a){$(this).val($(this).attr("data-productId")).trigger("change.select2")})};this.setupProductMultiselect=
function(a,b,c){var f=this;$(".stockMultiselect2").each(function(){a=$(this).data("price");(function(a){stockActions.initSelect2Products(".stockProducts"+a,{quietMillis:100,width:"100%",hideAddProductButton:!0,additionalReturnParams:{d:"short",p:function(){var b=[];$(".stockProducts"+a).each(function(a){a=$(this).val();b.push(a)});return b.join(",")}}}).on("select2:select",function(a){a=a.params.data;var b=$(this).closest(".element-row");f.productTriggerSelect(a,b);var c=$(".stockProducts",b).data("price");
$(".stockProducts",b).attr("data-product",a.id);$(".postDataRealCountMeasure",b).attr("data-product",a.id).attr("id","stock-product-count-m-"+c+"-"+a.id);$(".postDataRealCountDimension",b).attr("data-product",a.id).attr("id","stock-product-count-d-"+c+"-"+a.id);$(this).closest("li").attr("data-itemid",a.id)}).on("select2:open",function(a){stockActions.lastMultiselectElement=$(this)}).on("select2:close",function(a){})})(a)});if("undefined"!=typeof b){var h=$(".stockMultiselect2")[0],d=$(h).closest(".element-row"),
k=new Option(b.text,b.id,!0,!0);$(".stockProductCount",d).val(c);$(h).append(k).trigger("change");f.productTriggerSelect(b,d)}$(".stockMultiselect2").removeClass("stockMultiselect2");$(".stockProductCount").TouchSpin({min:0,max:1E9,firstclickvalueifempty:1,stepinterval:50,maxboostedstep:1E7})};this.productTriggerSelect=function(a,b){$(".stock-product-list-m",b).html(a.measure_name);$(".stock-product-list-d",b).html(a.dimensions_name);a.measures_id==stockActions.FORMAT_TYPE_MEASURE_NONE?$(".measureTypeCountField",
b).css("display","none"):($(".measureTypeCountField",b).css("display","table-cell"),$(".measureTypeCountField",b).addClass("tablCell"));$(".stockProductCount",b).removeAttr("disabled");$(".stockProducts",b).attr("data-productId",$(".stockProducts",b).val())}};
;
function stockOrdersActionsClass(){this.STATUS_TEMP=1;this.STATUS_NOT_ORDERED=2;this.order_status=0;this.init=function(){var b=this,a=$("body");a.on("click",".copyStockOrder",function(){var c=$(this).attr("data-id");stockActions.confirm({text:TR("Are you sure you want to copy the order?"),buttonText:"Ok",action:function(){stockActions.ajax2PageWithCheckChangeLocation({hash:"stock/orders/copy",parent_orders_id:c})}})});a.on("click",".registerStockOrder",function(){stockActions.confirm({text:TR("Are you sure you want to create a new vendor order?"),
buttonText:"Ok",action:function(){stockActions.ajax2PageWithCheckChangeLocation({hash:"stock/orders/create",type:1})}})});a.on("click",".stockProductOrdersDeleteButton",function(){var c=this;stockActions.confirm({text:TR("Are you sure you want to delete?"),action:function(){var a=$(c).closest(".element-row"),b=$(c).data("id"),g=$("#stockOrderId").val();if("undefined"==typeof b)a.remove();else{var f={hash:"stock/orders/delete-item"};f.item_id=b;f.orders_id=g;ajax({url:"/cabinet/"+f.hash,data:f,success:function(){a.remove()}})}}})});
a.on("change",".postOrder",function(){b.changeElement($(this))});a.on("click",".closeStockOrder",function(){var a=this;stockActions.confirm({text:TR("Do you really want to close the order?\nIt will not be possible to edit it later"),buttonText:"Ok",action:function(){ajax({url:"/cabinet/stock/orders/close",data:{order_id:$(a).data("id")},success:function(a){"success"===a.status?locationHashChanged():stockActions.highlightErrors(a)}})}})});a.on("click",".editStockOrder",function(){location.hash="stock/orders/edit/"+
$(this).data("id")});a.on("click",".exportStockOrder",function(){var a=$(this).data("orderId");location.href="/cabinet/stock/orders/export/"+a});a.on("click",".createStockInvoice",function(){var a=this;stockActions.confirm({text:TR("Do you really want to create an incoming invoice to complete the application?"),buttonText:"Ok",action:function(){var b={hash:"stock/invoices/create",type:1,order_id:$(a).data("id")};stockActions.ajax2PageWithCheckChangeLocation(b)}})});a.on("click",".doneStockOrder",
function(){var a=this;stockActions.confirm({text:TR("Are you sure you want to place an order?\nIt will not be possible to edit it in the future"),buttonText:"Ok",action:function(){$(".formError").html("");ajax({url:"/cabinet/stock/orders/done",data:{order_id:$(a).data("id")},success:function(a){"success"===a.status?locationHashChanged():stockActions.highlightErrors(a)}})}})})};this.changeElement=function(b){var a=b.data("filter"),c=b.data("name");a=stockActions.filteredValue(b.val(),a);var d={hash:"stock/orders/save",
order_id:$("#stockOrderId").val(),name:c,value:a};if("count"===c||"real_count"===c||"products"===c||"dimension_type"===c||"dimension_real_type"===c)if(d.item_id=b.data("id"),"undefined"==typeof d.item_id){var e=b.closest(".element-row");c=stockActions.filteredValue($(".stockProductCount",e).val(),"float");a=stockActions.filteredValue($(".stockProducts",e).val(),"int");e=stockActions.filteredValue($(".stockProductsDimensionType",e).val(),"int");d.name="new_item";d.value={count:c,product:a,dimension_type:e};
if(0===a)return!1}ajax({url:"/cabinet/"+d.hash,data:d,success:function(a){if("new_item"===d.name&&"undefined"!=typeof a.new_item_id){var c=b.closest(".element-row");$(".stockProductCount",c).attr("data-id",a.new_item_id);$(".stockProducts",c).attr("data-id",a.new_item_id);$(".stockProductsDimensionType",c).attr("data-id",a.new_item_id);$(".stockProductOrdersDeleteButton",c).attr("data-id",a.new_item_id);$(".formError",c).each(function(){var b=$(this).attr("id");$(this).attr("id",b.replace(/{ORDER_ITEM_ID}/i,
a.new_item_id))})}}})};this.initForm=function(b,a){var c=this;b=$("#stockorderFormDate");c.order_status=a;c.order_status===c.STATUS_NOT_ORDERED&&($scannerDetection=$(document).scannerDetection({timeBeforeScanTest:200,endChar:[13],avgTimeByChar:40,ignoreIfFocusOn:"input",onComplete:function(a,b){ajax({url:"/cabinet/stock/index/detect-product-from-barcode",data:{barcode:a,balance:1},success:function(a){"0"==a.product?alert(TR("Item not found!")):c.addStockOrderItem(a.product)}})},scanButtonKeyCode:116,
scanButtonLongPressThreshold:5,onScanButtonLongPressed:function(){},onError:function(a){}}));$("input.input-number").numeric({negative:!1,decimal:"."});$("input.input-number-negative").numeric({negative:!0,decimal:"."});initDateTimePicker(b);b.datetimepicker().on("dp.change",function(){c.changeElement($("#stockorderDate"))});$(".addStockProduct2order").click(function(){c.addStockOrderItem()});c.setSelect2ToProducts();$("select.stockProducts").each(function(){$(this).val($(this).attr("data-productId")).trigger("select2:change")});
stockActions.initSimpleSelect2(".stockProductsDimensionRealType");stockActions.initSimpleSelect2(".stockProductsDimensionType")};this.addStockOrderItem=function(b){if("undefined"==typeof b){var a=stockActions.renderTemplate("addOrderRowTemplate");$("#newStockOrderProducts").append(a);stockActions.initSimpleSelect2(".stockProductsDimensionType");$("input.input-number").numeric({negative:!1,decimal:"."});$("input.input-number-negative").numeric({negative:!0,decimal:"."});this.setSelect2ToProducts()}else $row=
$(".stockProducts[data-productid="+b.id+"]"),0==$row.length?(a=stockActions.renderTemplate("addOrderRowTemplate"),$("#newStockOrderProducts").append(a),this.setSelect2ToProducts(b),$("input.input-number").numeric({negative:!1,decimal:"."}),$("input.input-number-negative").numeric({negative:!0,decimal:"."})):(b=$row.closest(".element-row"),a=stockActions.filteredValue($(".stockProductCount",b).val(),"float")+1,$(".stockProductCount",b).val(a).trigger("keyup").trigger("change"))};this.setSelect2ToProducts=
function(b){var a=this;stockActions.initSelect2Products(".stockMultiselect2",{additionalReturnParams:{p:function(){var a=[];$(".stockProducts").each(function(b){b=$(this).val();a.push(b)});return a.join(",")}}}).on("select2:select",function(b){b=b.params.data;var c=$(this).closest(".element-row");a.productTriggerSelect(b,c)}).on("select2:open",function(){stockActions.lastMultiselectElement=$(this)}).on("select2:close",function(){});if("undefined"!=typeof b){var c=$(".stockMultiselect2")[0],d=$(c).closest(".element-row"),
e=new Option(b.text,b.id,!0,!0);$(".stockProductCount",d).val(1);$(c).append(e).trigger("change");a.productTriggerSelect(b,d)}$(".stockMultiselect2").removeClass("stockMultiselect2")};this.productTriggerSelect=function(b,a){var c=$(".stockProductsDimensionType",a),d=c.get(0);d.length=0;d.options[d.options.length]=new Option(b.measure_name,stockActions.FORMAT_TYPE_MEASURE);d.options[d.options.length]=new Option(b.dimensions_name,stockActions.FORMAT_TYPE_DIMENSION);c.val(stockActions.FORMAT_TYPE_MEASURE).removeAttr("disabled");
this.order_status!==this.STATUS_TEMP&&this.order_status!==this.STATUS_NOT_ORDERED||"undefined"==typeof b.balance||$(".balances",a).html(b.balance.count);$(".stockProductCount",a).removeAttr("disabled");$(".stockProducts",a).attr("data-productId",$(".stockProducts",a).val())}};
;
function stockRequestsActionsClass(){this.init=function(){var c=this;$("body").on("change",".stock_request_item_count",function(b){b=$(this).data("itemId");var a=$(this).val(),d={};d.groupId=b;d.value=a;ajax({url:"/cabinet/stock/requests/save-item-count",data:d,success:function(a){}})});$("body").on("change",".stock_request_item_measure",function(b){b=$(this).data("itemId");var a=$(this).val(),d={};d.groupId=b;d.value=a;ajax({url:"/cabinet/stock/requests/save-item-measure",data:d,success:function(a){}})});
$("body").on("click",".registerStockOrders",function(b){c.initFormOrders(b)});$("body").on("click",".registerStockMove",function(b){c.initFormMove(b)});$("body").on("click",".registerStockRequest",function(b){var a=$(this).data("id");c.initForm(b,a)});$("body").on("click",".unRegisterStockRequest",function(){var b=this;stockActions.confirm({text:TR("Are you sure you want to cancel the application?"),buttonText:"Ok",action:function(){ajax({url:"/cabinet/stock/requests/cancelled",data:{requests_id:$(b).data("id")},
success:function(a){locationHashChanged()}})}})});$("body").on("click",".editStockRequestGroupName",function(){ajax({url:"/cabinet/stock/requests/get-group-edit-form",data:{groups_id:$(this).data("id")},success:function(b){"undefined"!=typeof b.formHtml&&$("#stockRequestsModal").html(b.formHtml).modal("show")}})});$("body").on("click",".deleteRequestGroup",function(){var b=this;stockActions.confirm({text:TR("Are you sure you want to delete the group?\nAll products in it will be ungrouped"),action:function(){ajax({url:"/cabinet/stock/requests/delete-group",
data:{groups_id:$(b).data("id")},success:function(a){locationHashChanged()}})}})});$("body").on("click",".copyStockRequest",function(b){var a=this;stockActions.confirm({text:TR("Do you really want to reorder?"),buttonText:"Ok",action:function(){var d=$(a).data("id");c.initCopyForm(b,d)}})});$("body").on("click",".acceptedStockRequest",function(b){$(this).data("id");var a=[];$(":checkbox.new_request").each(function(){this.checked&&a.push($(this).data("productsId"))});if(0==a.length)return alert(TR("Select applications")),
!1;ajax({url:"/cabinet/stock/requests/get-accepted-form",data:{new_requests:a.join(",")},success:function(a){"undefined"!=typeof a.noGroups&&locationHashChanged();"undefined"!=typeof a.formHtml&&$("#stockRequestsModal").html(a.formHtml).modal("show")}})})};this.initForm=function(c,b){ajax({url:"/cabinet/stock/requests/get-send-form",data:{request_id:b},success:function(a){"undefined"!=typeof a.formHtml&&$("#stockRequestsModal").html(a.formHtml).modal("show")}})};this.initFormOrders=function(c,b){var a=
{};$(":checkbox.accepted_request").each(function(){if(this.checked){var d=$(this).data("groupsId"),b=$(this).data("productsId");"undefined"==typeof a[d]&&(a[d]=[]);a[d].push(b)}});if(0==a.length)return alert(TR("Select applications")),!1;stockActions.confirm({text:TR("Do you really want to send requests to the supplier?"),buttonText:"Ok",action:function(){ajax({url:"/cabinet/stock/requests/create-order",data:{accepted_request:a},success:function(a){"undefined"!=typeof a.newLocationHash?(location.hash=
a.newLocationHash,locationHashChanged()):alert(a)}})}})};this.initFormMove=function(c,b){$(this).data("id");var a=[];$(":checkbox.accepted_request").each(function(){this.checked&&a.push($(this).data("productsId"))});if(0==a.length)return alert(TR("Select applications")),!1;stockActions.confirm({text:TR("Do you really want to send requests to the supplier?"),buttonText:"Ok",action:function(){ajax({url:"/cabinet/stock/requests/get-move-form",data:{accepted_request:a.join(",")},success:function(a){$("#stockRequestsModal").html(a.formHtml).modal("show")}})}})};
this.initCopyForm=function(c,b){ajax({url:"/cabinet/stock/requests/get-copy-form",data:{request_id:b},success:function(a){"undefined"!=typeof a.formHtml&&$("#stockRequestsModal").html(a.formHtml).modal("show")}})};this.initTableActions=function(){$(".showStockRequestGroupItems").click(function(){var c=$(this),b=c.data("groupId"),a=[],d=$("i",$(this)),e=!1;d.hasClass("fa-plus")?(d.removeClass("fa-plus").addClass("fa-minus"),e=!0):d.removeClass("fa-minus").addClass("fa-plus");$(".show-stock-request-items-"+
b).each(function(){var b=$(this).data("productId");$(this).hasClass("loaded")?(d=$("i",$(this)),e?(d.removeClass("fa-plus").addClass("fa-minus"),$("tr.products-"+b+".request-groups-0").show()):(d.removeClass("fa-minus").addClass("fa-plus"),$("tr.products-"+b+".request-groups-0").hide())):a.push(b)});if(a.length){var f={};f.products=a;ajax({url:"/cabinet/stock/requests/show-new-requests-all",data:f,success:function(e){c.addClass("loaded");d=$("i",c);d.removeClass("fa-plus").addClass("fa-minus");for(var f in a){var h=
a[f],g=$(".show-stock-request-items-"+b+"-"+h);g.addClass("loaded");d=$("i",g);d.removeClass("fa-plus").addClass("fa-minus");g.closest("tr").after(e.moreHtml[h])}stockActions.initScripts();Metronic.initComponents()}})}});$(".showStockRequestItems").click(function(){var c=$(this),b=c.closest("tr"),a=c.data("productId"),d=$("i",c);c.hasClass("loaded")?d.hasClass("fa-plus")?(d.removeClass("fa-plus").addClass("fa-minus"),$("tr.products-"+a+".request-groups-0").show()):(d.removeClass("fa-minus").addClass("fa-plus"),
$("tr.products-"+a+".request-groups-0").hide()):(c.addClass("loaded"),d.removeClass("fa-plus").addClass("fa-minus"),c={},c.products_id=a,ajax({url:"/cabinet/stock/requests/show-new-requests",data:c,success:function(a){b.after(a.moreHtml);stockActions.initScripts();Metronic.initComponents()}}))});$(".showStockRequestGroupAcceptedItems").click(function(){var c=$(this),b=c.data("groupId"),a=[],d=$("i",$(this)),e=!1;d.hasClass("fa-plus")?(d.removeClass("fa-plus").addClass("fa-minus"),e=!0):d.removeClass("fa-minus").addClass("fa-plus");
$(".show-stock-accepted-items-"+b).each(function(){var c=$(this).data("productId");$(this).hasClass("loaded")?(d=$("i",$(this)),e?(d.removeClass("fa-plus").addClass("fa-minus"),$("tr.products-"+c+".request-groups-"+b).show()):(d.removeClass("fa-minus").addClass("fa-plus"),$("tr.products-"+c+".request-groups-"+b).hide())):a.push(c)});if(a.length){var f={};f.products=a;f.groups_id=b;ajax({url:"/cabinet/stock/requests/show-accepted-requests-all",data:f,success:function(e){c.addClass("loaded");d=$("i",
c);d.removeClass("fa-plus").addClass("fa-minus");for(var f in a){var h=a[f],g=$(".show-stock-accepted-items-"+b+"-"+h);g.addClass("loaded");d=$("i",g);d.removeClass("fa-plus").addClass("fa-minus");g.closest("tr").after(e.moreHtml[h])}stockActions.initScripts();Metronic.initComponents()}})}});$(".showStockRequestAcceptedItems").click(function(){var c=$(this),b=c.closest("tr"),a=c.data("productId"),d=c.data("groupId"),e=$("i",c);c.hasClass("loaded")?e.hasClass("fa-plus")?(e.removeClass("fa-plus").addClass("fa-minus"),
$("tr.products-"+a+".request-groups-"+d).show()):(e.removeClass("fa-minus").addClass("fa-plus"),$("tr.products-"+a+".request-groups-"+d).hide()):(c.addClass("loaded"),e.removeClass("fa-plus").addClass("fa-minus"),c={},c.products_id=a,c.groups_id=d,ajax({url:"/cabinet/stock/requests/show-accepted-requests",data:c,success:function(a){b.after(a.moreHtml);stockActions.initScripts();Metronic.initComponents()}}))});$(".stock_request_group_item_count").change(function(){var c=$(this).data("itemId"),b=$(this).val(),
a={};a.groupId=c;a.value=b;ajax({url:"/cabinet/stock/requests/save-group-item-count",data:a,success:function(a){}})});$(".stock_request_group_item_measure").change(function(){var c=$(this).data("itemId"),b=$(this).val(),a={};a.groupId=c;a.value=b;ajax({url:"/cabinet/stock/requests/save-group-item-measure",data:a,success:function(a){}})});$(".check-request-group").click(function(){var c=$(this).val();this.checked?$(".request-group-id-"+c).each(function(){$(this).attr("checked","checked").parent().addClass("checked")}):
$(".request-group-id-"+c).each(function(){$(this).removeAttr("checked").parent().removeClass("checked")})})};this.initFormActions=function(){stockActions.initSimpleSelect2("#stockRequestSendForm_rooms_id");var c=$("#stockRequestsNeedDate");initDateTimePicker(c);$("#stockRequestSendForm_count").numeric({negative:!1,decimal:"."});setTimeout(function(){autosize(document.getElementById("stockRequestSendForm_comments"))},10);stockActions.initSelect2Products("#stockRequestSendForm_products_id",{}).on("select2:select",
function(b){b=b.params.data;var a=$("#stockRequestSendForm_dimension").get(0);a.length=0;a.options[a.options.length]=new Option(b.measure_name,stockActions.FORMAT_TYPE_MEASURE);a.options[a.options.length]=new Option(b.dimensions_name,stockActions.FORMAT_TYPE_DIMENSION)}).on("select2:open",function(){stockActions.lastMultiselectElement=$(this)}).on("select2:close",function(){})}};
;
function stockRoomsActionsClass(){this.init=function(){var c=this;$("body").on("click",".registerStockRoom",function(a){var b=$(this).attr("data-itemId");c.initForm(a,b,"create")})};this.initForm=function(c,a,b){ajax({url:"/cabinet/stock/rooms/get-ajax-form",data:{type:b,item_id:a},success:function(a){"undefined"!=typeof a.formHtml&&$("#stockRoomModal").html(a.formHtml).modal("show")}})}};
;
function stockSuppliersActionsClass(){this.init=function(){var c=this;$("body").on("click",".registerStockSupplier",function(a){var b=$(this).attr("data-supplierId");c.initForm(a,b,"create")})};this.initForm=function(c,a,b){ajax({url:"/cabinet/stock/suppliers/get-ajax-form",data:{type:b,supplier_id:a},success:function(a){"undefined"!=typeof a.formHtml&&$("#stockSupplierModal").html(a.formHtml).modal("show")}})}};
;
(function(h){h.fn.scannerDetection=function(a){if("string"===typeof a)return this.each(function(){this.scannerDetectionTest(a)}),this;if(!1===a)return this.each(function(){this.scannerDetectionOff()}),this;var n={onComplete:!1,onError:!1,onReceive:!1,timeBeforeScanTest:100,avgTimeByChar:30,minLength:6,endChar:[9,13],startChar:[],ignoreIfFocusOn:!1,scanButtonKeyCode:0,scanButtonLongPressThreshold:3,onScanButtonLongPressed:!1,stopPropagation:!1,preventDefault:!1};"function"===typeof a&&(a={onComplete:a});
a="object"!==typeof a?h.extend({},n):h.extend({},n,a);this.each(function(){var d=this,g=h(d),e=0,l=0,c="",m=!1,k=!1,f=0;d.scannerDetectionOff=function(){g.unbind("keydown.scannerDetection");g.unbind("keypress.scannerDetection")};d.isFocusOnIgnoredElement=function(){if(!a.ignoreIfFocusOn)return!1;if("string"===typeof a.ignoreIfFocusOn)return h(":focus").is(a.ignoreIfFocusOn);if("object"===typeof a.ignoreIfFocusOn&&a.ignoreIfFocusOn.length)for(var b=h(":focus"),c=0;c<a.ignoreIfFocusOn.length;c++)if(b.is(a.ignoreIfFocusOn[c]))return!0;
return!1};d.scannerDetectionTest=function(b){b&&(e=l=0,c=b);f||(f=1);if(c.length>=a.minLength&&l-e<c.length*a.avgTimeByChar)return a.onScanButtonLongPressed&&f>a.scanButtonLongPressThreshold?a.onScanButtonLongPressed.call(d,c,f):a.onComplete&&a.onComplete.call(d,c,f),g.trigger("scannerDetectionComplete",{string:c}),e=0,c="",f=0,!0;a.onError&&a.onError.call(d,c);g.trigger("scannerDetectionError",{string:c});e=0;c="";f=0;return!1};g.data("scannerDetection",{options:a}).unbind(".scannerDetection").bind("keydown.scannerDetection",
function(b){if(a.scanButtonKeyCode&&b.which==a.scanButtonKeyCode)f++,b.preventDefault(),b.stopImmediatePropagation();else if(e&&-1!==a.endChar.indexOf(b.which)||!e&&-1!==a.startChar.indexOf(b.which)){var c=jQuery.Event("keypress",b);c.type="keypress.scannerDetection";g.triggerHandler(c);b.preventDefault();b.stopImmediatePropagation()}}).bind("keypress.scannerDetection",function(b){this.isFocusOnIgnoredElement()||(a.stopPropagation&&b.stopImmediatePropagation(),a.preventDefault&&b.preventDefault(),
e&&-1!==a.endChar.indexOf(b.which)?(b.preventDefault(),b.stopImmediatePropagation(),m=!0):(e||-1===a.startChar.indexOf(b.which)?c+=String.fromCharCode(b.which):(b.preventDefault(),b.stopImmediatePropagation()),m=!1),e||(e=Date.now()),l=Date.now(),k&&clearTimeout(k),m?(d.scannerDetectionTest(),k=!1):k=setTimeout(d.scannerDetectionTest,a.timeBeforeScanTest),a.onReceive&&a.onReceive.call(d,b),g.trigger("scannerDetectionReceive",{evt:b}))})});return this}})(jQuery);
;
function stockBoxActionsClass(){this.products={};this.productsCategories={};this.SECTION_MAIN=1;this.SECTION_INVENTORY=2;this.SECTION_SETTINGS=3;this.CART_VIEW_NONE="none";this.CART_VIEW_INVOICE="invoice";this.CART_VIEW_INVENTORY="inventory";this.CART_VIEW_REQUEST="request";this.CART_VIEW_INVOICE_MOVE="invoice_move";this.CART_VIEW_INVOICE_WRITEOFF="invoice_writeoff";this.AJAX_STATUS_ERROR="error";this.AJAX_STATUS_SUCCESS="success";this.cartView=this.CART_VIEW_NONE;this.currentSection=this.SECTION_MAIN;
this.currentRoomId=0;this.filters=[];this.filtersString="";this.filtersType=1;this.scrollPositions={};this.loadedProducts={};this.filterTypeAll=1;this.filterTypeCritical=2;this.filterTypeAbsent=3;this.BOX_PRODUCT_ABSENT="absent";this.BOX_PRODUCT_CRITICAL="critical";this.BOX_PRODUCT_PRESENT="present";this.init=function(){var a=this,e=$("body");e.on("click",".stockBoxTotalBalance",function(b){var d=$(this).data("product");a.initBalanceForm(b,d)});e.on("click",".stockBoxTotalRequest",function(b){var d=
$(this).data("product");a.initRequestForm(b,d)});e.on("click",".stockBoxTotalOrdered",function(b){var d=$(this).data("product");a.initOrderForm(b,d)});e.on("click",".registerStockBoxProduct",function(b){b=$(this).data("categoryid");stockActions.showCreateProductModal("",{category_id:b,box:1,boxRoom:a.currentRoomId})});e.on("click",".boxMoveFromRoom",function(b){b=$(this).data("room");var d=$(this).data("product");ajax({url:"/cabinet/stock/box/move-item",data:{productsId:d,currentRoomsId:$("#stockInvoiceRoomsId").val(),
roomId:b},success:function(b){a.refreshCartView(b,!1)}})});e.on("click",".boxSettingsActiveBtn",function(a){var b=$(this),c=b.data("product");ajax({url:"/cabinet/stock/box/activator",data:{productsId:c,currentRoomsId:$("#stockInvoiceRoomsId").val()},success:function(a){if("undefined"!=typeof a.enabled){var d=$("#stock-box-product-"+c);1==a.enabled?(b.addClass("checked"),d.addClass("enabled"),d.removeClass("disabled")):(b.removeClass("checked"),d.addClass("disabled"),d.removeClass("enabled"))}}})});
e.on("click",".addStockMyCartBtnMove",function(b){b=$(this).attr("rel");var d=$(".box-product-"+b);if(d.hasClass("loading"))return!1;var c=$("#stock-product-list-count-"+b);c.length?c.val(parseFloat(c.val())+1).change():(d.addClass("loading"),ajax({url:"/cabinet/stock/box/move-item",data:{productsId:b,currentRoomsId:$("#stockInvoiceRoomsId").val()},success:function(b){a.refreshCartView(b,!1);d.removeClass("loading")}}))});e.on("click",".addStockMyCartBtnRequest",function(b){b=$(this).attr("rel");
var d=$(".box-product-"+b);if(d.hasClass("loading"))return!1;var c=$("#stock-product-list-count-"+b);c.length?c.val(parseFloat(c.val())+1).change():(d.addClass("loading"),ajax({url:"/cabinet/stock/box/request-item",data:{productsId:b,currentRoomsId:$("#stockInvoiceRoomsId").val()},success:function(b){a.refreshCartView(b,!1);d.removeClass("loading")}}))});e.on("click",".stock-box-product-content",function(b){b=$(b.target);var d=$(this);if(b.hasClass("clickable")||b.hasClass("detail"))return!1;b=$(this).data("product");
if(a.cartView==a.CART_VIEW_REQUEST)return document.getElementById("stock-product-list-count-"+b)?a.setActiveDetailProduct(b,!1):$("#addStockMyCartBtnRequest-"+b).click(),!1;if(a.cartView==a.CART_VIEW_INVOICE_WRITEOFF&&document.getElementById("stock-product-list-count-d-"+b))return a.setActiveDetailProduct(b,!1),!1;if(a.cartView==a.CART_VIEW_INVOICE_MOVE)return $("#stockBoxTotalBalance-"+b).click(),!1;if(a.cartView!=a.CART_VIEW_INVOICE_WRITEOFF&&a.cartView!=a.CART_VIEW_NONE||a.currentSection!=a.SECTION_MAIN||
d.hasClass("loading"))return!1;var c=$("#stock-product-list-count-d-"+b),f=$("#stock-product-list-count-m-"+b);c.length?(c.val(parseFloat(c.val())+1).change(),a.setActiveDetailProduct(b,!1)):f.length?(f.val(parseFloat(f.val())+1).change(),a.setActiveDetailProduct(b,!1)):(d.addClass("loading"),ajax({url:"/cabinet/stock/box/write-off-item",data:{productsId:b,currentRoomsId:$("#stockInvoiceRoomsId").val()},success:function(b){a.refreshCartView(b,!1);d.removeClass("loading")}}))});e.on("dblclick",".box-product-card",
function(a){});e.on("click",".stockBoxEditProductButton",function(b){a.editProduct(b,this)});e.on("change",".boxRequestPostData",function(b,d){var c=!0;"undefined"!=typeof d&&"undefined"!=typeof d.skipScroll&&!0===d.skipScroll&&(c=!1);b=$(this).data("productsId");d=$("#stock-product-list-dimension-type-"+b).val();var f=$("#stock-product-list-count-"+b).val(),e=$("#stock-product-list-count-"+b).data("measureName"),h=$("#stock-product-list-count-"+b).data("dimensionName"),k=$("#stock-product-list-comments-"+
b).val();d==stockActions.FORMAT_TYPE_MEASURE?($(".stockCountProductsM-"+b).html(f+" "+e),$("#boxCounterProductM-"+b).show(),$("#boxCounterProductD-"+b).hide()):($(".stockCountProductsD-"+b).html(f+" "+h),$("#boxCounterProductM-"+b).hide(),$("#boxCounterProductD-"+b).show());ajax({url:"/cabinet/stock/box/request-item",data:{productsId:b,count:f,dimensionType:d,comments:k,currentRoomsId:$("#stockInvoiceRoomsId").val()},success:function(b){a.setActiveDetailProduct(b.productId,c)}})});e.on("click",".addStockInventory0",
function(b){b=$(this).attr("rel");var d=$(".box-product-"+b);if(d.hasClass("loading"))return!1;"undefined"==typeof $("#stock-product-list-count-m-"+b).get(0)&&"undefined"==typeof $("#stock-product-list-count-d-"+b).get(0)?(d.addClass("loading"),ajax({url:"/cabinet/stock/box/inventory-item",data:{productsId:b,type:"absent",currentRoomsId:$("#stockInvoiceRoomsId").val()},success:function(b){a.refreshCartView(b);d.removeClass("loading")}})):("undefined"!=typeof $("#stock-product-list-count-m-"+b).get(0)&&
($("#stock-product-list-count-m-"+b).val(0),$("#stock-product-list-count-m-"+b).trigger("change")),"undefined"!=typeof $("#stock-product-list-count-d-"+b).get(0)&&($("#stock-product-list-count-d-"+b).val(0),$("#stock-product-list-count-d-"+b).trigger("change")));$("#addStockInventory1-"+b).show();$("#addStockInventory0-"+b).hide()});e.on("click",".addStockInventory1",function(b){b=$(this).attr("rel");var d=$(".box-product-"+b);if(d.hasClass("loading"))return!1;"undefined"==typeof $("#stock-product-list-count-m-"+
b).get(0)&&"undefined"==typeof $("#stock-product-list-count-d-"+b).get(0)?(d.addClass("loading"),ajax({url:"/cabinet/stock/box/inventory-item",data:{productsId:b,type:"present",currentRoomsId:$("#stockInvoiceRoomsId").val()},success:function(b){a.refreshCartView(b);d.removeClass("loading")}})):"undefined"!=typeof $("#stock-product-list-count-m-"+b).get(0)?($("#stock-product-list-count-m-"+b).val(1),$("#stock-product-list-count-m-"+b).trigger("change"),$("#stock-product-list-count-d-"+b).val(0),$("#stock-product-list-count-d-"+
b).trigger("change")):"undefined"!=typeof $("#stock-product-list-count-d-"+b).get(0)&&($("#stock-product-list-count-d-"+b).val(1),$("#stock-product-list-count-d-"+b).trigger("change"));$("#addStockInventory1-"+b).hide();$("#addStockInventory0-"+b).show()});e.on("click",".stockMinusProductsM",function(b){b=$(this).data("productId");var d=$(".box-product-"+b),c=0;if(d.hasClass("loading"))return!1;a.currentSection==a.SECTION_INVENTORY?"undefined"==typeof $("#stock-product-list-count-m-"+b).get(0)?(d.addClass("loading"),
ajax({url:"/cabinet/stock/box/inventory-item",data:{productsId:b,type:"m-minus",currentRoomsId:$("#stockInvoiceRoomsId").val()},success:function(b){a.refreshCartView(b);d.removeClass("loading")}})):(c=parseFloat($("#stock-product-list-count-m-"+b).val()),1>=c&&(c=1),$("#stock-product-list-count-m-"+b).val(c-1),$("#stock-product-list-count-m-"+b).trigger("change",{skipScroll:!0})):a.cartView==a.CART_VIEW_INVOICE_WRITEOFF?(c=parseFloat($("#stock-product-list-count-m-"+b).val()),1>=c&&(c=1),$("#stock-product-list-count-m-"+
b).val(c-1),$("#stock-product-list-count-m-"+b).trigger("change",{skipScroll:!0})):(c=parseFloat($("#stock-product-list-count-"+b).val()),1>=c&&(c=1),$("#stock-product-list-count-"+b).val(c-1),$("#stock-product-list-count-"+b).trigger("change",{skipScroll:!0}))});e.on("click",".stockMinusProductsD",function(b){b=$(this).data("productId");var d=$(".box-product-"+b),c=0;if(d.hasClass("loading"))return!1;a.currentSection==a.SECTION_INVENTORY?"undefined"==typeof $("#stock-product-list-count-d-"+b).get(0)?
(d.addClass("loading"),ajax({url:"/cabinet/stock/box/inventory-item",data:{productsId:b,type:"d-minus",currentRoomsId:$("#stockInvoiceRoomsId").val()},success:function(b){a.refreshCartView(b);d.removeClass("loading")}})):(c=parseFloat($("#stock-product-list-count-d-"+b).val()),1>=c&&(c=1),$("#stock-product-list-count-d-"+b).val(c-1),$("#stock-product-list-count-d-"+b).trigger("change",{skipScroll:!0})):a.cartView==a.CART_VIEW_INVOICE_WRITEOFF?(c=parseFloat($("#stock-product-list-count-d-"+b).val()),
1>=c&&(c=1),$("#stock-product-list-count-d-"+b).val(c-1),$("#stock-product-list-count-d-"+b).trigger("change",{skipScroll:!0})):(c=parseFloat($("#stock-product-list-count-"+b).val()),1>=c&&(c=1),$("#stock-product-list-count-"+b).val(c-1),$("#stock-product-list-count-"+b).trigger("change",{skipScroll:!0}))});e.on("click",".stockPlusProductsM",function(b){b=$(this).data("productId");var d=$(".box-product-"+b),c=0;if(d.hasClass("loading"))return!1;a.currentSection==a.SECTION_INVENTORY?"undefined"==typeof $("#stock-product-list-count-m-"+
b).get(0)?(d.addClass("loading"),ajax({url:"/cabinet/stock/box/inventory-item",data:{productsId:b,type:"m-plus",currentRoomsId:$("#stockInvoiceRoomsId").val()},success:function(b){a.refreshCartView(b);d.removeClass("loading")}})):(c=parseFloat($("#stock-product-list-count-m-"+b).val()),$("#stock-product-list-count-m-"+b).val(c+1),$("#stock-product-list-count-m-"+b).trigger("change",{skipScroll:!0})):a.cartView==a.CART_VIEW_INVOICE_WRITEOFF?(c=parseFloat($("#stock-product-list-count-m-"+b).val()),
$("#stock-product-list-count-m-"+b).val(c+1),$("#stock-product-list-count-m-"+b).trigger("change",{skipScroll:!0})):(c=parseFloat($("#stock-product-list-count-"+b).val()),$("#stock-product-list-count-"+b).val(c+1),$("#stock-product-list-count-"+b).trigger("change",{skipScroll:!0}))});e.on("click",".stockPlusProductsD",function(b){b=$(this).data("productId");var d=$(".box-product-"+b);if(d.hasClass("loading"))return!1;if(a.currentSection==a.SECTION_INVENTORY)if("undefined"==typeof $("#stock-product-list-count-d-"+
b).get(0))d.addClass("loading"),ajax({url:"/cabinet/stock/box/inventory-item",data:{productsId:b,type:"d-plus",currentRoomsId:$("#stockInvoiceRoomsId").val()},success:function(b){a.refreshCartView(b);d.removeClass("loading")}});else{var c=parseFloat($("#stock-product-list-count-d-"+b).val());$("#stock-product-list-count-d-"+b).val(c+1);$("#stock-product-list-count-d-"+b).trigger("change",{skipScroll:!0})}else a.cartView==a.CART_VIEW_INVOICE_WRITEOFF?(c=parseFloat($("#stock-product-list-count-d-"+
b).val()),$("#stock-product-list-count-d-"+b).val(c+1),$("#stock-product-list-count-d-"+b).trigger("change",{skipScroll:!0})):(c=parseFloat($("#stock-product-list-count-"+b).val()),$("#stock-product-list-count-"+b).val(c+1),$("#stock-product-list-count-"+b).trigger("change",{skipScroll:!0}))});e.on("click",".stockBoxConfirmInvoice",function(b){b=$("#boxCartView").val();var d=$(this);if(d.hasClass("loading"))return!1;d.addClass("loading");var c=$(this).data("invoicesId");if("undefined"==typeof c&&
a.cartView!=a.CART_VIEW_REQUEST&&a.cartView!=a.CART_VIEW_INVENTORY)return $(".stockBoxConfirmInvoiceCart").click(),!1;switch(b){case a.CART_VIEW_INVOICE_MOVE:ajax({url:"/cabinet/stock/invoices/multi-done",data:{invoice_id:c},success:function(b){b.status==a.AJAX_STATUS_SUCCESS?(b=b.js,a.initProductsList(b.jsProducts,a.CART_VIEW_NONE,a.SECTION_MAIN),a.refreshProductsList(),a.setCartHTML(b.cartHTML)):b.status==a.AJAX_STATUS_ERROR&&alert(b.message);d.removeClass("loading")}});break;case a.CART_VIEW_INVOICE_WRITEOFF:ajax({url:"/cabinet/stock/invoices/done",
data:{invoice_id:c},success:function(b){b.status==a.AJAX_STATUS_SUCCESS?(b=b.js,a.initProductsList(b.jsProducts,a.CART_VIEW_NONE,a.SECTION_MAIN),a.refreshProductsList(),a.setCartHTML(b.cartHTML),setTimeout(function(){},100)):b.status==a.AJAX_STATUS_ERROR&&alert(b.message);d.removeClass("loading")}});break;case a.CART_VIEW_REQUEST:ajax({url:"/cabinet/stock/box/confirm-request",data:{currentRoomsId:$("#stockInvoiceRoomsId").val()},success:function(b){b.status==a.AJAX_STATUS_SUCCESS?(b=b.js,a.initProductsList(b.jsProducts,
a.CART_VIEW_NONE,a.SECTION_MAIN),a.refreshProductsList(),a.setCartHTML(b.cartHTML)):b.status==a.AJAX_STATUS_ERROR&&alert(b.message);d.removeClass("loading")}});break;case a.CART_VIEW_INVENTORY:ajax({url:"/cabinet/stock/inventory/done",data:{inventory_id:$("#stockInventoryId").val()},success:function(b){b.status==a.AJAX_STATUS_SUCCESS?(b=b.js,a.initProductsList(b.jsProducts,a.CART_VIEW_NONE,a.SECTION_INVENTORY),a.refreshProductsList(),a.setCartHTML(b.cartHTML)):b.status==a.AJAX_STATUS_ERROR&&alert(b.message);
d.removeClass("loading")}})}});e.on("click","#stockBoxCancelRequest",function(b){var d=this;stockActions.confirm({text:"\u0412\u0438 \u0434\u0456\u0439\u0441\u043d\u043e \u0431\u0430\u0436\u0430\u0454\u0442\u0435 \u0432\u0456\u0434\u043c\u0456\u043d\u0438\u0442\u0438?",buttonText:"Ok",action:function(){var b=$(d);if(b.hasClass("loading"))return!1;b.addClass("loading");ajax({url:"/cabinet/stock/box/delete-request",data:{currentRoomsId:$("#stockInvoiceRoomsId").val()},success:function(c){c.status==
a.AJAX_STATUS_SUCCESS?(c=c.js,a.initProductsList(c.jsProducts,a.CART_VIEW_NONE,a.SECTION_MAIN),a.refreshProductsList(),a.setCartHTML(c.cartHTML)):c.status==a.AJAX_STATUS_ERROR&&alert(c.message);b.removeClass("loading")}})}})});e.on("click",".stockProductRequestDeleteButton",function(b){var d=$(this).data("id"),c=$(this).data("productsId"),e=$("#stock-product-list-"+c),g=this;stockActions.confirm({text:TR("Are you sure you want to delete?"),action:function(){var b=$(g);if(b.hasClass("loading"))return!1;
b.addClass("loading");ajax({url:"/cabinet/stock/box/delete-request-item",data:{id:d},success:function(d){d.status==a.AJAX_STATUS_SUCCESS?($("#stock-box-product-"+c).removeClass("detailed-request"),$("#stock-box-product-"+c).removeClass("detailed"),e.remove(),"undefined"!=typeof d.emptyCart&&(d=d.js,a.initProductsList(d.jsProducts,a.CART_VIEW_NONE,a.SECTION_MAIN),a.refreshProductsList(),a.setCartHTML(d.cartHTML))):d.status==a.AJAX_STATUS_ERROR&&alert(d.message);b.removeClass("loading")}})}})});e.on("click",
"#stockBoxConfirmRequest",function(b){var d=$(this);if(d.hasClass("loading"))return!1;d.addClass("loading");ajax({url:"/cabinet/stock/box/confirm-request",data:{currentRoomsId:$("#stockInvoiceRoomsId").val()},success:function(b){b.status==a.AJAX_STATUS_SUCCESS?(b=b.js,a.initProductsList(b.jsProducts,a.CART_VIEW_NONE,a.SECTION_MAIN),a.refreshProductsList(),a.setCartHTML(b.cartHTML)):b.status==a.AJAX_STATUS_ERROR&&alert(b.message);d.removeClass("loading")}})});e.on("click",".stockBoxCancelInvoice",
function(b){var d=this;stockActions.confirm({text:"\u0412\u0438 \u0434\u0456\u0439\u0441\u043d\u043e \u0431\u0430\u0436\u0430\u0454\u0442\u0435 \u0432\u0456\u0434\u043c\u0456\u043d\u0438\u0442\u0438?",buttonText:"Ok",action:function(){var b=$(d);if(b.hasClass("loading"))return!1;b.addClass("loading");ajax({url:"/cabinet/stock/invoices/delete",data:{ids:$(d).data("invoices-id")},success:function(c){c.status==a.AJAX_STATUS_SUCCESS?(c=c.js,a.initProductsList(c.jsProducts,a.CART_VIEW_NONE,a.SECTION_MAIN),
a.refreshProductsList(),a.setCartHTML(c.cartHTML)):c.status==a.AJAX_STATUS_ERROR&&alert(c.message);b.removeClass("loading")}})}})});e.on("click","#stockBoxCancelInventory",function(b){var d=this;stockActions.confirm({text:"\u0412\u0438 \u0434\u0456\u0439\u0441\u043d\u043e \u0431\u0430\u0436\u0430\u0454\u0442\u0435 \u0432\u0456\u0434\u043c\u0456\u043d\u0438\u0442\u0438?",buttonText:"Ok",action:function(){var b=$(d);if(b.hasClass("loading"))return!1;b.addClass("loading");ajax({url:"/cabinet/stock/inventory/delete",
data:{ids:$(d).data("inventory-id")},success:function(c){c.status==a.AJAX_STATUS_SUCCESS?(c=c.js,a.initProductsList(c.jsProducts,a.CART_VIEW_NONE,a.SECTION_INVENTORY),a.refreshProductsList(),a.setCartHTML(c.cartHTML)):c.status==a.AJAX_STATUS_ERROR&&alert(c.message);b.removeClass("loading")}})}})});e.on("click","#closeBoxCart",function(b){a.slideRightBoxCart()});e.on("click","#boxCartToggle",function(b){0==parseInt($("#stockMyCart").css("right"))?a.slideRightBoxCart():(bodyScrollTop=document.body.scrollTop,
$("#stockMyCart").animate({right:"0px"},function(){window.scrollTo(0,0)}))});window.onscroll=function(){!a.isBoxPage()||!1!==stockBoxLockOnScroll||a.currentSection!=a.SECTION_MAIN&&a.currentSection!=a.SECTION_INVENTORY||(a.scrollPositions={roomId:a.currentRoomId,scrollPosition:document.body.scrollTop||document.documentElement.scrollTop})}};this.setActiveDetailProduct=function(a,e){if(this.currentSection==this.SECTION_MAIN){"undefined"==typeof e&&(e=!0);$(".box-product-card-inner").removeClass("detailed").removeClass("detailed-active-request").removeClass("detailed-active-writeoff").removeClass("detailed-active-move");
this.cartView==this.CART_VIEW_REQUEST?$("#stock-box-product-"+a).addClass("detailed detailed-active-request"):this.cartView==this.CART_VIEW_INVOICE_WRITEOFF?$("#stock-box-product-"+a).addClass("detailed detailed-active-writeoff"):this.cartView==this.CART_VIEW_INVOICE_MOVE&&$("#stock-box-product-"+a).addClass("detailed detailed-active-move");e&&this.scroll2Product(a,!1,0);var b=this;setTimeout(function(){b.autosizeText($(".stockCountProductsM-"+a))},1)}};this.detectTextWidth=function(a,e){var b=document.createElement("div");
b.style.position="absolute";b.style.left="-999em";b.style.whiteSpace="nowrap";b.style.font=e;b.innerHTML=a;document.body.appendChild(b);a=b.clientWidth;document.body.removeChild(b);return a};this.autosizeText=function(a,e,b){var d=a.parent(),c="undefined"!=typeof b?b:a.attr("max-font-size");"undefined"==typeof c&&(c="50px");b=parseInt(c,10);var f=c.replace(b,"");c="undefined"!=typeof e?e:a.attr("min-font-size");"undefined"==typeof c&&(c="15px");e=parseInt(c.replace(f,""));c=(b+e)/2;d=d.width()-20;
var g=0;do{a.css("font-size",c+f);var h=this.detectTextWidth(a.html(),a.css("font"));if(h>d)b=c,c=Math.floor((c+e)/2);else if(h<d)e=c,c=Math.floor((c+b)/2);else break;g++;if(20<=g)break}while(1<b-e&&b>e);a.css("font-size",c+f)};this.editProduct=function(a,e){$(a.target);$(e);if(this.currentSection!=this.SECTION_SETTINGS)return!1;a=$(e).data("product");stockActions.showEditProductModal(a,{box:1,boxRoom:this.currentRoomId})};this.isBoxPage=function(){return/stock\/box/i.test(location.hash)};this.slideRightBoxCart=
function(){var a=$(window).width();window.scrollTo(0,bodyScrollTop);$("#stockMyCart").animate({right:-a},function(){})};this.reloadSettings=function(a,e,b){"undefined"==typeof b&&(b=!1);b?(this.initProductsList(e.jsProducts,this.CART_VIEW_NONE,this.SECTION_SETTINGS),this.clearProductsList(),this.renderProductsList(1E4),this.setCartHTML(e.cartHTML),"undefined"!=typeof a&&this.scroll2Product(a)):(this.products["c"+this.productsCategories[a]].products["p"+a]=e,this.refreshProductCard(a),"undefined"!=
typeof a&&this.scroll2Product(a,!0))};this.realWidth=function(a){a=a.clone();a.css("visibility","hidden");$("body").append(a);var e=a.outerWidth();a.remove();return e};this.refreshMenu=function(){var a=parseInt($("#main_content").width()),e=Math.round(.6666667*a),b=Math.round(.3333333*a);900>a&&(e=Math.round(.3333333*a),b=Math.round(.6666667*a));a=$("#menuBoxHidden li");var d=0;$.each(a,function(a,b){d+=$(b).outerWidth()+2});d>e?($("#tabBoxRoom").css("visibility","hidden").css("top","-1000px").css("position",
"absolute"),$("#selectBoxRoomContent").css("visibility","visible").show()):($("#tabBoxRoom").css("visibility","visible").css("position","unset").css("top","0px"),$("#selectBoxRoomContent").css("visibility","hidden"));$("#selectBoxRoomCol").css("width",e+"px").css("height","1px");$("#filtersProductsCol").css("width",b+"px")};this.run=function(a,e,b,d){var c=this;$("#stockSearchBoxProduct").val(c.filtersString);$("#boxFiltersType").val(c.filtersType).trigger("change.select2");c.currentRoomId=d;c.initProductsList(a,
e,b);c.currentSection==c.SECTION_SETTINGS?c.renderProductsList(1E4):"undefined"!=typeof c.loadedProducts[c.currentRoomId]?c.renderProductsList(c.loadedProducts[c.currentRoomId]):c.renderProductsList();var f=$("#stockMyCart"),g=f.position(),h=$(document);if(c.currentSection==c.SECTION_MAIN||c.currentSection==c.SECTION_INVENTORY)"undefined"!=typeof c.scrollPositions.scrollPosition&&c.scrollPositions.roomId==c.currentRoomId?setTimeout(function(){window.scrollTo(0,c.scrollPositions.scrollPosition)},10):
setTimeout(function(){c.scrollPositions={};window.scrollTo(0,0)},10);window.addEventListener("scroll",function(a,b){c.isBoxPage()&&(a=h.scrollTop(),a>=g.top-145?(f.css("position","fixed"),f.css("top","145px")):(f.css("position","fixed"),f.css("top",g.top-a)))});h.on("changedInvoiceElement",function(a,b){if("undefined"!=typeof b.productsId)if(a=b.productsId,c.cartView==c.CART_VIEW_INVOICE_MOVE||c.cartView==c.CART_VIEW_INVOICE_WRITEOFF){c.setActiveDetailProduct(a,"undefined"!=typeof b.skipScroll&&!0===
b.skipScroll?!1:!0);$("#boxCounterProductD-"+a).show();var d=$("#stock-product-list-count-m-"+a).val();"undefined"!=typeof d&&(b.measureId==stockActions.FORMAT_TYPE_MEASURE_NONE?$("#boxCounterProductM-"+a).hide():$("#boxCounterProductM-"+a).show(),$(".stockCountProductsM-"+a).html(d+" "+b.measureName));d=$("#stock-product-list-count-d-"+a).val();$(".stockCountProductsD-"+a).html(d+" "+b.dimensionName)}else c.cartView!=c.CART_VIEW_INVENTORY||"undefined"!=typeof b.skipScroll&&!0===b.skipScroll||c.scroll2Product(a,
!1,0),$("#boxCounterProductD-"+a).show(),d=$("#stock-product-list-count-m-"+a).val(),"undefined"!=typeof d&&($("#boxCounterProductM-"+a).show(),$(".stockCountProductsM-"+a).html(d+b.measureName)),d=$("#stock-product-list-count-d-"+a).val(),$(".stockCountProductsD-"+a).html(d+b.dimensionName)});h.on("deletedInvoiceElement",function(a,b){$("#stock-box-product-"+b.products_id).removeClass("detailed-invoice").removeClass("detailed");"undefined"!=typeof b.emptyCart&&(a=b.js,c.initProductsList(a.jsProducts,
c.CART_VIEW_NONE,c.SECTION_MAIN),c.refreshProductsList(),c.setCartHTML(a.cartHTML))});h.on("deletedInventoryElement",function(a,b){a=b.products_id;$("#stock-box-product-"+a).removeClass("detailed");if("undefined"!=typeof b.emptyCart)a=b.js,c.initProductsList(a.jsProducts,c.CART_VIEW_NONE,c.SECTION_INVENTORY),c.refreshProductsList(),c.setCartHTML(a.cartHTML);else{if("undefined"==typeof c.productsCategories[a])return!1;b=c.productsCategories[a];var d=c.products["c"+b].products["p"+a];c.products["c"+
b].products["p"+a].countM=d.d_countM;c.products["c"+b].products["p"+a].countD=d.d_countD;c.refreshProductCard(a)}});$("#stockSearchBoxProduct").keyup(function(){c.filters=[];c.filtersString=this.value;var a=c.filtersString.toUpperCase().split(",");for(var b in a){var d=a[b].trim();""!=d&&c.filters.push(d)}delete a;c.clearProductsList();c.renderProductsList();setTimeout(function(){window.scrollTo(0,0)},10)});$("#infinite-container").boxPagination({data:{},scroller:$(window),heightOffset:10,before:function(){$("#loading").fadeIn()},
after:function(a){$("#loading").fadeOut();$(a).fadeInWithDelay();100<$("#content").children().size()&&($("#nomoreresults").fadeIn(),$("#content").stopScrollPagination())}})};this.setCartHTML=function(a){$("#stockMyCart").html(a)};this.refreshCartView=function(a,e){"undefined"==typeof e&&(e=!0);this.cartView=a.cartView;this.setCartHTML(a.formHtml);switch(this.cartView){case this.CART_VIEW_INVOICE_MOVE:case this.CART_VIEW_INVOICE_WRITEOFF:$(".stockCountProductsM-"+a.productId).html(a.count_m+" "+a.measureName);
$(".stockCountProductsD-"+a.productId).html(a.count_d+" "+a.dimensionName);a.measureId==stockActions.FORMAT_TYPE_MEASURE_NONE?$("#boxCounterProductM-"+a.productId).hide():$("#boxCounterProductM-"+a.productId).show();$("#boxCounterProductD-"+a.productId).show();break;case this.CART_VIEW_INVENTORY:var b=a.changeProductCount.split("|");"undefined"!=typeof b[1]?($(".stockCountProductsM-"+a.productId).html(b[0]),$(".stockCountProductsD-"+a.productId).html(b[1]),$("#boxCounterProductM-"+a.productId).show()):
($(".stockCountProductsD-"+a.productId).html(b[0]),$("#boxCounterProductM-"+a.productId).hide());$("#boxCounterProductD-"+a.productId).show();break;case this.CART_VIEW_REQUEST:a.changeProductDimensionType==stockActions.FORMAT_TYPE_MEASURE?($("#boxCounterProductM-"+a.productId).show(),$("#boxCounterProductD-"+a.productId).hide(),$(".stockCountProductsM-"+a.productId).html(a.changeProductCount+" "+a.changeProductDimension)):($("#boxCounterProductM-"+a.productId).hide(),$("#boxCounterProductD-"+a.productId).show(),
$(".stockCountProductsD-"+a.productId).html(a.changeProductCount+" "+a.changeProductDimension)),this.setActiveDetailProduct(a.productId,e)}this.cartView==this.CART_VIEW_REQUEST?$("#stock-box-product-"+a.productId).addClass("detailed-request"):this.cartView==this.CART_VIEW_INVOICE_WRITEOFF?$("#stock-box-product-"+a.productId).addClass("detailed-invoice"):this.cartView!=this.CART_VIEW_INVOICE_MOVE&&$("#stock-box-product-"+a.productId).addClass("detailed");this.setActiveDetailProduct(a.productId,e)};
this.initForm=function(a,e,b,d){ajax({url:"/cabinet/stock/brands/get-ajax-form",data:{type:b,default_name:"undefined"===typeof d?"":d,brand_id:e},success:function(a){"undefined"!==typeof a.formHtml&&$("#stockBrandModal").html(a.formHtml).modal("show")}})};this.initBalanceForm=function(a,e){ajax({url:"/cabinet/stock/box/get-balance",data:{product_id:e,section:this.currentSection,current_room_id:this.currentRoomId},success:function(a){"undefined"!=typeof a.formHtml&&$("#stockBoxBalanceModal").html(a.formHtml).modal("show")}})};
this.initRequestForm=function(a,e){ajax({url:"/cabinet/stock/box/get-request",data:{product_id:e},success:function(a){"undefined"!=typeof a.formHtml&&$("#stockBoxBalanceModal").html(a.formHtml).modal("show")}})};this.initOrderForm=function(a,e){ajax({url:"/cabinet/stock/box/get-order",data:{product_id:e},success:function(a){"undefined"!=typeof a.formHtml&&$("#stockBoxBalanceModal").html(a.formHtml).modal("show")}})};this.clearProductsList=function(){$("#boxProductsList").html("")};this.initProductsList=
function(a,e,b){var d=a.categories_mapping,c=a.products_mapping;delete a.categories_mapping;delete a.products_mapping;for(var f in a){var g=a[f].category;a[f].products=stockActions.arrayFromMap(a[f].products,c,!0);a[f].category=stockActions.arrayFromMap(g,d,!1);for(var h in a[f].products)g=a[f].products[h],a[f].products[h].currentRoom_balanceFormat=stockActions.formattedBeautyMeasure(g.currentRoom_balance,g.dimensions_value,g.measures_id,g.dimensionNameM,g.dimensionNameD,!0),a[f].products[h].otherRoom_balanceFormat=
stockActions.formattedBeautyMeasure(g.otherRoom_balance,g.dimensions_value,g.measures_id,g.dimensionNameM,g.dimensionNameD,!0)}this.products=a;this.productsCategories={};for(f in this.products){a=this.products[f].products;for(var k in a)this.productsCategories[k.substr(1)]=f.substr(1)}this.cartView=e;this.currentSection=b};this.renderProductsList=function(a){"undefined"==typeof a&&(a=30);var e=0;for(c in this.products){var b=this.products[c].category,d=this.products[c].products;var c=b.id;for(var f in d){var g=
!0;var h=d[f];f=h.id;if(this.filters.length){g=!1;for(var k in this.filters){var l=this.filters[k];if(-1<h.name.toUpperCase().indexOf(l)||-1<h.brand.toUpperCase().indexOf(l)||-1<h.code.toUpperCase().indexOf(l))g=!0}}if(this.filtersType!=this.filterTypeAbsent||h.currentRoom_status==this.BOX_PRODUCT_ABSENT)if(this.filtersType!=this.filterTypeCritical||h.currentRoom_status==this.BOX_PRODUCT_CRITICAL)if(this.currentSection!=this.SECTION_SETTINGS&&0==h.enabled&&""==h.currentRoom_balanceFormat&&(g=!1),
g&&!document.getElementById("stock-box-product-"+f)){e++;if(e===a)break;g=this.renderProductCardContent(h);document.getElementById("box-category-"+c)||(h="",this.currentSection==this.SECTION_SETTINGS&&(h=' <button class="btn btn-default btn-small registerStockBoxProduct" data-categoryid="'+c+'" data-productid="0"><span class="fa fa-plus"></span>&nbsp;&nbsp;\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0442\u043e\u0432\u0430\u0440</button>'),$("#boxProductsList").append('<div class="row" id="box-category-'+
c+'"><h2 class="box-'+(0<b.level?"sub":"")+'category">'+b.name+h+"</h2></div>").addClass("boxProductSection-"+this.currentSection));$("#box-category-"+c).append('<div class="noselect-text box-product-card box-product-'+f+'" data-product="'+f+'">'+g+"</div>")}}if(e==a)break}this.loadedProducts[this.currentRoomId]=$(".box-product-card").length;this.currentSection==this.SECTION_SETTINGS&&(0===this.loadedProducts[this.currentRoomId]?$("#boxProductsList").append('<button class="btn btn-default btn-small registerStockBoxProduct registerStockBoxProduct0" data-categoryid="0" data-productid="0"><span class="fa fa-plus"></span>&nbsp;&nbsp;\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0442\u043e\u0432\u0430\u0440</button>').addClass("boxProductSection-"+
this.currentSection):$("#registerStockBoxProduct0").remove())};this.refreshProductCard=function(a){if("undefined"==typeof this.productsCategories[a])return!1;var e=this.renderProductCardContent(this.products["c"+this.productsCategories[a]].products["p"+a]);$(".box-product-"+a).html(e)};this.renderProductCardContent=function(a){var e="total-box-product-"+a.otherRoom_status+"-color",b=""==a.otherRoom_balanceFormat?"0":a.otherRoom_balanceFormat,d='<div class="box-product-card-inner '+(e+" room-box-product-"+
(a.currentRoom_status+"-color ")+(this.currentSection==this.SECTION_SETTINGS?1==a.enabled?"enabled":"disabled":"")+" "+(this.currentSection==this.SECTION_INVENTORY||a.detailed?"detailed":"")+(this.currentSection==this.SECTION_INVENTORY?" detailed-inventory ":""))+'" id="stock-box-product-'+a.id+'">',c=a.id;d+='<div class="stock-box-top-shadow box-product-total-bg-color">';this.currentSection!=this.SECTION_SETTINGS&&this.currentSection!=this.SECTION_INVENTORY&&(d+='<span style="white-space: nowrap" id="stockBoxTotalBalance-'+
a.id+'" class="clickable stockBoxTotalBalance '+e+'" data-product="'+a.id+'">\u041d\u0430 \u0441\u043a\u043b\u0430\u0434\u0430\u0445: '+b+"</span>");d=d+'</div><div class="stock-box-product-content"  data-product="'+(a.id+'">');d+='<div class="stock-box-product-content-inner"><div class="topBtn noselect-text">';this.currentSection!=this.SECTION_INVENTORY&&(this.currentSection==this.SECTION_SETTINGS?d+='<span class="clickable boxSettingsActiveBtn '+(1==a.enabled?"checked":"")+'" data-product="'+a.id+
'"><i class="fa fa-check-square-o" aria-hidden="true"></i><i class="fa fa-square-o" aria-hidden="true"></i></span>':(d+='<div style="float:right;text-align: right;"><div style="height: 20px;">',"0"!=a.orders&&""!=a.orders&&(d+='<span  class="clickable stockBoxTotalOrdered" data-product="'+c+'">\u0417\u0430\u043c\u043e\u0432\u043b\u0435\u043d\u043e: '+a.orders+"</span>"),d+='</div><div style="height: 20px; margin-top: 5px">',"0"!=a.requests&&(d+='<span class="clickable stockBoxTotalRequest" data-product="'+
c+'">\u0412 \u0437\u0430\u044f\u0432\u043a\u0430\u0445: '+a.requests+"</span>"),d+='</div></div><div style="clear: both"></div>'));d=d+'</div><div style="clear: both"></div><div style="text-align: center"> <img src="'+(a.photo+'" alt=""/></div>');d+='<div style="clear: both"></div><div style="height: 30px">';this.currentSection==this.SECTION_INVENTORY&&(d=d+'<div class="boxInventoryCounterBlock"><div class="boxCounterProductM"  id="boxCounterProductM-'+(a.id+'" '+(1==a.measureNone||a.dimensionsType==
stockActions.FORMAT_TYPE_DIMENSION?' style="display:none" ':"")+">"),d+='<span class="stockPlusProductsM noselect-text" data-product-id="'+a.id+'"><i class="clickable fa fa-plus" aria-hidden="true"></i></span>',d+='<span class="stockCountProductsM clickable noselect-text stockCountProductsM-'+a.id+'">'+a.countM+a.dimensionNameM+"</span>",d+='<span class="stockMinusProductsM noselect-text" data-product-id="'+a.id+'"><i class="clickable fa fa-minus" aria-hidden="true"></i></span>',d=d+'</div><div  class="boxCounterProductD"  id="boxCounterProductD-'+
(a.id+'"'+(a.dimensionsType==stockActions.FORMAT_TYPE_MEASURE?' style="display:none" ':"")+">"),d+='<span class="stockPlusProductsD noselect-text" data-product-id="'+a.id+'"><i class="clickable fa fa-plus" aria-hidden="true"></i></span>',d+='<span class="stockCountProductsD clickable noselect-text stockCountProductsD-'+a.id+'">'+a.countD+a.dimensionNameD+"</span>",d+='<span class="stockMinusProductsD noselect-text" data-product-id="'+a.id+'"><i class="clickable fa fa-minus" aria-hidden="true"></i></span>',
d+="</div></div>");d+='<div style="clear: both"></div>';this.currentSection==this.SECTION_MAIN&&(d+='<span class="boxProductBalance box-product-room-font-color">'+(""==a.currentRoom_balanceFormat?'<span class="box-card-absent-text">\u0412\u0456\u0434\u0441\u0443\u0442\u043d\u0456\u0439</span>':a.currentRoom_balanceFormat)+"</span>");d=d+'</div><div style="height: 90px"><h3 class="boxProductName box-product-room-font-color">'+(a.name+"</h3>");d+='<div class="offer boxProductSubName box-product-room-font-color">'+
a.subTitleString+"</div>";d+="</div>";if(this.currentSection==this.SECTION_MAIN){d+='<div style="height: 32px">';if(this.cartView===this.CART_VIEW_NONE||this.cartView===this.CART_VIEW_REQUEST)d+='<button rel="'+a.id+'" id="addStockMyCartBtnRequest-'+a.id+'" class="btn clickable box-product-room-bg-color addStockMyCartBtnRequest">\u0417\u0430\u043c\u043e\u0432\u0438\u0442\u0438</button>';d+="</div>"}else this.currentSection==this.SECTION_SETTINGS?(d=d+'<div style="height: 32px"><button data-product="'+
(a.id+'" class="btn clickable stockBoxEditProductButton">\u0420\u0435\u0434\u0430\u0433\u0443\u0432\u0430\u0442\u0438</button>'),d+="</div>"):this.currentSection==this.SECTION_INVENTORY&&(d+='<div style="height: 32px">',0<a.count?(d+='<button rel="'+a.id+'" id="addStockInventory0-'+a.id+'" class="btn clickable addStockInventory0">\u0412\u0456\u0434\u0441\u0443\u0442\u043d\u0456\u0439</button>',d+='<button rel="'+a.id+'" id="addStockInventory1-'+a.id+'" style="display: none" class="btn clickable addStockInventory1">\u041d\u0430\u044f\u0432\u043d\u0438\u0439</button>'):
(d+='<button rel="'+a.id+'" id="addStockInventory0-'+a.id+'" style="display: none" class="btn clickable addStockInventory0">\u0412\u0456\u0434\u0441\u0443\u0442\u043d\u0456\u0439</button>',d+='<button rel="'+a.id+'" id="addStockInventory1-'+a.id+'" class="btn clickable addStockInventory1">\u041d\u0430\u044f\u0432\u043d\u0438\u0439</button>'),d+="</div>");d+="</div>";this.currentSection==this.SECTION_MAIN&&(d=d+'<div class="detail"><div class="detail-counter"><div class="detail-counter-M"><div class="boxCounterProductM2" id="boxCounterProductM-'+
(a.id+'" '+(1==a.measureNone||a.dimensionsType==stockActions.FORMAT_TYPE_DIMENSION&&this.cartView==this.CART_VIEW_REQUEST?' style="display:none" ':"")+">"),d+='<div class="stockCountProductsM textfill clickable noselect-text stockCountProductsM-'+a.id+'">'+a.countM+" "+a.dimensionNameM+"</div>",d+='<span class="stockPlusProductsM noselect-text" data-product-id="'+a.id+'"><i class="clickable fa fa-plus" aria-hidden="true"></i></span><span class="stockMinusProductsM noselect-text" data-product-id="'+
a.id+'"><i class="clickable fa fa-minus" aria-hidden="true"></i></span>',d=d+'</div></div><div class="detail-counter-D"><div class="boxCounterProductD2"  id="boxCounterProductD-'+(a.id+'"'+(a.dimensionsType==stockActions.FORMAT_TYPE_MEASURE?' style="display:none" ':"")+">"),d+='<div class="stockCountProductsD clickable noselect-text stockCountProductsD-'+a.id+'">'+a.countD+" "+a.dimensionNameD+"</div>",d+='<span class="stockPlusProductsD noselect-text" data-product-id="'+a.id+'"><i class="clickable fa fa-plus" aria-hidden="true"></i></span><span class="stockMinusProductsD noselect-text" data-product-id="'+
a.id+'"><i class="clickable fa fa-minus" aria-hidden="true"></i></span>',d+='</div></div></div><div class="detail-button"><button class="btn clickable btn-success stockBoxConfirmInvoice stockBoxConfirmInvoiceList">OK</button></div></div>');return d+"</div></div></div></div>"};this.scroll2Product=function(a,e,b){"undefined"==typeof b&&(b=500);setTimeout(function(){var d=$(".box-product-"+a);$([document.documentElement,document.body]).animate({scrollTop:d.offset().top-(991<=$(window).width()?195:45)},
b);"undefined"!=typeof e&&1!=e||setTimeout(function(){d.fadeOut(100).fadeIn(100).fadeOut(100).fadeIn(100).fadeOut(100).fadeIn(100)},b+100)},1)};this.refreshProductsList=function(){for(e in this.products){var a=this.products[e].products;var e=this.products[e].category.id;var b=0;for(f in a){var d=!0;var c=a[f];var f=c.id;var g=document.getElementsByClassName("box-product-"+f)[0];if(this.filters.length){d=!1;for(var h in this.filters){var k=this.filters[h];if(-1<c.name.toUpperCase().indexOf(k)||-1<
c.brand.toUpperCase().indexOf(k)||-1<c.code.toUpperCase().indexOf(k))d=!0}}if(this.filtersType==this.filterTypeAbsent&&c.currentRoom_status!=this.BOX_PRODUCT_ABSENT)g&&g.remove();else if(this.filtersType==this.filterTypeCritical&&c.currentRoom_status!=this.BOX_PRODUCT_CRITICAL)g&&g.remove();else{this.currentSection!=this.SECTION_SETTINGS&&0==c.enabled&&""==c.currentRoom_balanceFormat&&(d=!1);c=this.renderProductCardContent(c);if(this.currentSection==this.SECTION_SETTINGS)g?g.innerHTML=c:$(c).insertAfter("#box-category-"+
e+" h2");else{if(!d||!g){g&&g.remove();continue}g.innerHTML=c}b++}}0==b&&(d=document.getElementById("box-category-"+e))&&d.remove()}initTooltips()}};
;
(function(a){var e={autoload:!0,data:{page:1,size:10},before:function(){a(this.loading).fadeIn()},after:function(b){a(this.loading).fadeOut();a(b).fadeInWithDelay()},scroller:a(window),heightOffset:20,loading:"#loading",loadingText:"Wait a moment... it's loading!",loadingNomoreText:"No more.",manuallyText:"click to loading more."};a.fn.boxPagination=function(b){var c=a.extend(e,b);return this.each(function(){a.fn.boxPagination.init(a(this),c)})};a.fn.stopboxPagination=function(b,c){b=void 0===b?null:
b;c=void 0===c?null:c;if(null==b)return this.each(function(){a(this).attr("boxPagination","disabled")});a(c.loading).text(c.loadingNomoreText).fadeIn();a(b).attr("boxPagination","disabled")};a.fn.boxPagination.loadContent=function(a,c){stockBoxActions.renderProductsList()};a.fn.boxPagination.init=function(b,c){var d=c.scroller;a(b).attr("boxPagination","enabled");0===a(b).children().length&&a.fn.boxPagination.loadContent(b,c);!0===c.autoload?a(d).scroll(function(f){"enabled"==a(b).attr("boxPagination")?
Math.ceil(a(d).scrollTop())+c.heightOffset>=a(document).height()-a(d).height()&&a.fn.boxPagination.loadContent(b,c):f.stopPropagation(b,c)}):(c.loadingText=c.manuallyText,a(c.loading).text(c.loadingText).fadeIn().on("click",function(d){"enabled"==a(b).attr("boxPagination")?a.fn.boxPagination.loadContent(b,c):d.stopPropagation(b,c)}))};a.fn.fadeInWithDelay=function(){var b=0;return this.each(function(){a(this).delay(b).animate({opacity:1},200);b+=100})}})(jQuery);
;
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.checkStringArgs=function(a,c,b){if(null==a)throw new TypeError("The 'this' value for String.prototype."+b+" must not be null or undefined");if(c instanceof RegExp)throw new TypeError("First argument to String.prototype."+b+" must not be a regular expression");return a+""};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,b){a!=Array.prototype&&a!=Object.prototype&&(a[c]=b.value)};$jscomp.getGlobal=function(a){a=["object"==typeof globalThis&&globalThis,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,a];for(var c=0;c<a.length;++c){var b=a[c];if(b&&b.Math==Math)return b}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,c,b,d){if(c){b=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in b||(b[e]={});b=b[e]}a=a[a.length-1];d=b[a];c=c(d);c!=d&&null!=c&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:c})}};
$jscomp.polyfill("String.prototype.startsWith",function(a){return a?a:function(a,b){var c=$jscomp.checkStringArgs(this,a,"startsWith");a+="";var e=c.length,g=a.length;b=Math.max(0,Math.min(b|0,c.length));for(var f=0;f<g&&b<e;)if(c[b++]!=a[f++])return!1;return f>=g}},"es6","es3");
function binotelCall(a){var c=$.cookie("binotel_"+currentClinicId+"_"+currentClinicMemberId);currentClinicMemberBinotelOperatorNumber&&c?ajax({url:"/cabinet/binotel/call/"+a,data:{},success:function(a){}}):alert(T["Binotel is not enabled on this device"])}
function binotelRecord(a){$(".audio_items").html("");ajax({url:"/cabinet/binotel/record/"+a,data:{},success:function(a){a.url.startsWith("https://")?($("#binotelAudioItemPlayer").html('<video autoplay controls="" style="max-height: 60px; width: 300px"  name="media"><source src="'+a.url+'" type="audio/mpeg"></video>'),$("#binotelCallRecordModal").modal("show").on("hidden.bs.modal",function(a){$("#binotelAudioItemPlayer").html("")})):alert(T["Binotel error loading audio"])}})}
$(document).ready(function(){$("body").on("click",".scheduleTooltipPhone",function(){var a=$.cookie("binotel_"+currentClinicId+"_"+currentClinicMemberId);currentClinicMemberBinotelOperatorNumber&&a&&(a=$(this).data("phone"),binotelCall(a))})});
;
_xamzrequire=function(){function e(t,r,n){function i(s,a){if(!r[s]){if(!t[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var l=r[s]={exports:{}};t[s][0].call(l.exports,function(e){return i(t[s][1][e]||e)},l,l.exports,e,t,r,n)}return r[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)i(n[s]);return i}return e}()({38:[function(e,t,r){(function(r){function n(e,t){if("string"==typeof e){if(["legacy","regional"].indexOf(e.toLowerCase())>=0)return e.toLowerCase();throw o.util.error(new Error,t)}}function i(e,t){e=e||{};var i;if(e[t.clientConfig]&&(i=n(e[t.clientConfig],{code:"InvalidConfiguration",message:'invalid "'+t.clientConfig+'" configuration. Expect "legacy"  or "regional". Got "'+e[t.clientConfig]+'".'})))return i;if(!o.util.isNode())return i;if(Object.prototype.hasOwnProperty.call(r.env,t.env)){if(i=n(r.env[t.env],{code:"InvalidEnvironmentalVariable",message:"invalid "+t.env+' environmental variable. Expect "legacy"  or "regional". Got "'+r.env[t.env]+'".'}))return i}var s={};try{s=o.util.getProfilesFromSharedConfig(o.util.iniLoader)[r.env.AWS_PROFILE||o.util.defaultProfile]}catch(e){}if(s&&Object.prototype.hasOwnProperty.call(s,t.sharedConfig)){if(i=n(s[t.sharedConfig],{code:"InvalidConfiguration",message:"invalid "+t.sharedConfig+' profile config. Expect "legacy"  or "regional". Got "'+s[t.sharedConfig]+'".'}))return i}return i}var o=e("./core");t.exports=i}).call(this,e("_process"))},{"./core":39,_process:8}],39:[function(e,t,r){var n={util:e("./util")};({}).toString(),t.exports=n,n.util.update(n,{VERSION:"2.658.0",Signers:{},Protocol:{Json:e("./protocol/json"),Query:e("./protocol/query"),Rest:e("./protocol/rest"),RestJson:e("./protocol/rest_json"),RestXml:e("./protocol/rest_xml")},XML:{Builder:e("./xml/builder"),Parser:null},JSON:{Builder:e("./json/builder"),Parser:e("./json/parser")},Model:{Api:e("./model/api"),Operation:e("./model/operation"),Shape:e("./model/shape"),Paginator:e("./model/paginator"),ResourceWaiter:e("./model/resource_waiter")},apiLoader:e("./api_loader"),EndpointCache:e("../vendor/endpoint-cache").EndpointCache}),e("./sequential_executor"),e("./service"),e("./config"),e("./http"),e("./event_listeners"),e("./request"),e("./response"),e("./resource_waiter"),e("./signers/request_signer"),e("./param_validator"),n.events=new n.SequentialExecutor,n.util.memoizedProperty(n,"endpointCache",function(){return new n.EndpointCache(n.config.endpointCacheSize)},!0)},{"../vendor/endpoint-cache":125,"./api_loader":27,"./config":37,"./event_listeners":60,"./http":61,"./json/builder":63,"./json/parser":64,"./model/api":65,"./model/operation":67,"./model/paginator":68,"./model/resource_waiter":69,"./model/shape":70,"./param_validator":71,"./protocol/json":74,"./protocol/query":75,"./protocol/rest":76,"./protocol/rest_json":77,"./protocol/rest_xml":78,"./request":84,"./resource_waiter":85,"./response":86,"./sequential_executor":88,"./service":89,"./signers/request_signer":110,"./util":118,"./xml/builder":120}],125:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("./utils/LRU"),i=1e3,o=function(){function e(e){void 0===e&&(e=i),this.maxSize=e,this.cache=new n.LRUCache(e)}return Object.defineProperty(e.prototype,"size",{get:function(){return this.cache.length},enumerable:!0,configurable:!0}),e.prototype.put=function(t,r){var n="string"!=typeof t?e.getKeyString(t):t,i=this.populateValue(r);this.cache.put(n,i)},e.prototype.get=function(t){var r="string"!=typeof t?e.getKeyString(t):t,n=Date.now(),i=this.cache.get(r);if(i)for(var o=0;o<i.length;o++){var s=i[o];if(s.Expire<n)return void this.cache.remove(r)}return i},e.getKeyString=function(e){for(var t=[],r=Object.keys(e).sort(),n=0;n<r.length;n++){var i=r[n];void 0!==e[i]&&t.push(e[i])}return t.join(" ")},e.prototype.populateValue=function(e){var t=Date.now();return e.map(function(e){return{Address:e.Address||"",Expire:t+60*(e.CachePeriodInMinutes||1)*1e3}})},e.prototype.empty=function(){this.cache.empty()},e.prototype.remove=function(t){var r="string"!=typeof t?e.getKeyString(t):t;this.cache.remove(r)},e}();r.EndpointCache=o},{"./utils/LRU":126}],126:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){this.key=e,this.value=t}return e}(),i=function(){function e(e){if(this.nodeMap={},this.size=0,"number"!=typeof e||e<1)throw new Error("Cache size can only be positive number");this.sizeLimit=e}return Object.defineProperty(e.prototype,"length",{get:function(){return this.size},enumerable:!0,configurable:!0}),e.prototype.prependToList=function(e){this.headerNode?(this.headerNode.prev=e,e.next=this.headerNode):this.tailNode=e,this.headerNode=e,this.size++},e.prototype.removeFromTail=function(){if(this.tailNode){var e=this.tailNode,t=e.prev;return t&&(t.next=void 0),e.prev=void 0,this.tailNode=t,this.size--,e}},e.prototype.detachFromList=function(e){this.headerNode===e&&(this.headerNode=e.next),this.tailNode===e&&(this.tailNode=e.prev),e.prev&&(e.prev.next=e.next),e.next&&(e.next.prev=e.prev),e.next=void 0,e.prev=void 0,this.size--},e.prototype.get=function(e){if(this.nodeMap[e]){var t=this.nodeMap[e];return this.detachFromList(t),this.prependToList(t),t.value}},e.prototype.remove=function(e){if(this.nodeMap[e]){var t=this.nodeMap[e];this.detachFromList(t),delete this.nodeMap[e]}},e.prototype.put=function(e,t){if(this.nodeMap[e])this.remove(e);else if(this.size===this.sizeLimit){var r=this.removeFromTail(),i=r.key;delete this.nodeMap[i]}var o=new n(e,t);this.nodeMap[e]=o,this.prependToList(o)},e.prototype.empty=function(){for(var e=Object.keys(this.nodeMap),t=0;t<e.length;t++){var r=e[t],n=this.nodeMap[r];this.detachFromList(n),delete this.nodeMap[r]}},e}();r.LRUCache=i},{}],120:[function(e,t,r){function n(){}function i(e,t,r){switch(r.type){case"structure":return o(e,t,r);case"map":return s(e,t,r);case"list":return a(e,t,r);default:return u(e,t,r)}}function o(e,t,r){l.arrayEach(r.memberNames,function(n){var o=r.members[n];if("body"===o.location){var s=t[n],a=o.name;if(void 0!==s&&null!==s)if(o.isXmlAttribute)e.addAttribute(a,s);else if(o.flattened)i(e,s,o);else{var u=new h(a);e.addChildNode(u),c(u,o),i(u,s,o)}}})}function s(e,t,r){var n=r.key.name||"key",o=r.value.name||"value";l.each(t,function(t,s){var a=new h(r.flattened?r.name:"entry");e.addChildNode(a);var u=new h(n),c=new h(o);a.addChildNode(u),a.addChildNode(c),i(u,t,r.key),i(c,s,r.value)})}function a(e,t,r){r.flattened?l.arrayEach(t,function(t){var n=r.member.name||r.name,o=new h(n);e.addChildNode(o),i(o,t,r.member)}):l.arrayEach(t,function(t){var n=r.member.name||"member",o=new h(n);e.addChildNode(o),i(o,t,r.member)})}function u(e,t,r){e.addChildNode(new p(r.toWireFormat(t)))}function c(e,t,r){var n,i="xmlns";t.xmlNamespaceUri?(n=t.xmlNamespaceUri,t.xmlNamespacePrefix&&(i+=":"+t.xmlNamespacePrefix)):r&&t.api.xmlNamespaceUri&&(n=t.api.xmlNamespaceUri),n&&e.addAttribute(i,n)}var l=e("../util"),h=e("./xml-node").XmlNode,p=e("./xml-text").XmlText;n.prototype.toXML=function(e,t,r,n){var o=new h(r);return c(o,t,!0),i(o,e,t),o.children.length>0||n?o.toString():""},t.exports=n},{"../util":118,"./xml-node":123,"./xml-text":124}],124:[function(e,t,r){function n(e){this.value=e}var i=e("./escape-element").escapeElement;n.prototype.toString=function(){return i(""+this.value)},t.exports={XmlText:n}},{"./escape-element":122}],122:[function(e,t,r){function n(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}t.exports={escapeElement:n}},{}],123:[function(e,t,r){function n(e,t){void 0===t&&(t=[]),this.name=e,this.children=t,this.attributes={}}var i=e("./escape-attribute").escapeAttribute;n.prototype.addAttribute=function(e,t){return this.attributes[e]=t,this},n.prototype.addChildNode=function(e){return this.children.push(e),this},n.prototype.removeAttribute=function(e){return delete this.attributes[e],this},n.prototype.toString=function(){for(var e=Boolean(this.children.length),t="<"+this.name,r=this.attributes,n=0,o=Object.keys(r);n<o.length;n++){var s=o[n],a=r[s];void 0!==a&&null!==a&&(t+=" "+s+'="'+i(""+a)+'"')}return t+=e?">"+this.children.map(function(e){return e.toString()}).join("")+"</"+this.name+">":"/>"},t.exports={XmlNode:n}},{"./escape-attribute":121}],121:[function(e,t,r){function n(e){return e.replace(/&/g,"&amp;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}t.exports={escapeAttribute:n}},{}],110:[function(e,t,r){var n=e("../core"),i=n.util.inherit;n.Signers.RequestSigner=i({constructor:function(e){this.request=e},setServiceClientId:function(e){this.serviceClientId=e},getServiceClientId:function(){return this.serviceClientId}}),n.Signers.RequestSigner.getVersion=function(e){switch(e){case"v2":return n.Signers.V2;case"v3":return n.Signers.V3;case"s3v4":case"v4":return n.Signers.V4;case"s3":return n.Signers.S3;case"v3https":return n.Signers.V3Https}throw new Error("Unknown signing version "+e)},e("./v2"),e("./v3"),e("./v3https"),e("./v4"),e("./s3"),e("./presign")},{"../core":39,"./presign":109,"./s3":111,"./v2":112,"./v3":113,"./v3https":114,"./v4":115}],115:[function(e,t,r){var n=e("../core"),i=e("./v4_credentials"),o=n.util.inherit;n.Signers.V4=o(n.Signers.RequestSigner,{constructor:function(e,t,r){n.Signers.RequestSigner.call(this,e),this.serviceName=t,r=r||{},this.signatureCache="boolean"!=typeof r.signatureCache||r.signatureCache,this.operation=r.operation,this.signatureVersion=r.signatureVersion},algorithm:"AWS4-HMAC-SHA256",addAuthorization:function(e,t){var r=n.util.date.iso8601(t).replace(/[:\-]|\.\d{3}/g,"");this.isPresigned()?this.updateForPresigned(e,r):this.addHeaders(e,r),this.request.headers.Authorization=this.authorization(e,r)},addHeaders:function(e,t){this.request.headers["X-Amz-Date"]=t,e.sessionToken&&(this.request.headers["x-amz-security-token"]=e.sessionToken)},updateForPresigned:function(e,t){var r=this.credentialString(t),i={"X-Amz-Date":t,"X-Amz-Algorithm":this.algorithm,"X-Amz-Credential":e.accessKeyId+"/"+r,"X-Amz-Expires":this.request.headers["presigned-expires"],"X-Amz-SignedHeaders":this.signedHeaders()};e.sessionToken&&(i["X-Amz-Security-Token"]=e.sessionToken),this.request.headers["Content-Type"]&&(i["Content-Type"]=this.request.headers["Content-Type"]),this.request.headers["Content-MD5"]&&(i["Content-MD5"]=this.request.headers["Content-MD5"]),this.request.headers["Cache-Control"]&&(i["Cache-Control"]=this.request.headers["Cache-Control"]),n.util.each.call(this,this.request.headers,function(e,t){if("presigned-expires"!==e&&this.isSignableHeader(e)){var r=e.toLowerCase();0===r.indexOf("x-amz-meta-")?i[r]=t:0===r.indexOf("x-amz-")&&(i[e]=t)}});var o=this.request.path.indexOf("?")>=0?"&":"?";this.request.path+=o+n.util.queryParamsToString(i)},authorization:function(e,t){var r=[],n=this.credentialString(t);return r.push(this.algorithm+" Credential="+e.accessKeyId+"/"+n),r.push("SignedHeaders="+this.signedHeaders()),r.push("Signature="+this.signature(e,t)),r.join(", ")},signature:function(e,t){var r=i.getSigningKey(e,t.substr(0,8),this.request.region,this.serviceName,this.signatureCache);return n.util.crypto.hmac(r,this.stringToSign(t),"hex")},stringToSign:function(e){var t=[];return t.push("AWS4-HMAC-SHA256"),t.push(e),t.push(this.credentialString(e)),t.push(this.hexEncodedHash(this.canonicalString())),t.join("\n")},canonicalString:function(){var e=[],t=this.request.pathname();return"s3"!==this.serviceName&&"s3v4"!==this.signatureVersion&&(t=n.util.uriEscapePath(t)),e.push(this.request.method),e.push(t),e.push(this.request.search()),e.push(this.canonicalHeaders()+"\n"),e.push(this.signedHeaders()),e.push(this.hexEncodedBodyHash()),e.join("\n")},canonicalHeaders:function(){var e=[];n.util.each.call(this,this.request.headers,function(t,r){e.push([t,r])}),e.sort(function(e,t){return e[0].toLowerCase()<t[0].toLowerCase()?-1:1});var t=[];return n.util.arrayEach.call(this,e,function(e){var r=e[0].toLowerCase();if(this.isSignableHeader(r)){var i=e[1];if(void 0===i||null===i||"function"!=typeof i.toString)throw n.util.error(new Error("Header "+r+" contains invalid value"),{code:"InvalidHeader"});t.push(r+":"+this.canonicalHeaderValues(i.toString()))}}),t.join("\n")},canonicalHeaderValues:function(e){return e.replace(/\s+/g," ").replace(/^\s+|\s+$/g,"")},signedHeaders:function(){var e=[];return n.util.each.call(this,this.request.headers,function(t){t=t.toLowerCase(),this.isSignableHeader(t)&&e.push(t)}),e.sort().join(";")},credentialString:function(e){return i.createScope(e.substr(0,8),this.request.region,this.serviceName)},hexEncodedHash:function(e){return n.util.crypto.sha256(e,"hex")},hexEncodedBodyHash:function(){var e=this.request;return this.isPresigned()&&"s3"===this.serviceName&&!e.body?"UNSIGNED-PAYLOAD":e.headers["X-Amz-Content-Sha256"]?e.headers["X-Amz-Content-Sha256"]:this.hexEncodedHash(this.request.body||"")},unsignableHeaders:["authorization","content-type","content-length","user-agent","presigned-expires","expect","x-amzn-trace-id"],isSignableHeader:function(e){return 0===e.toLowerCase().indexOf("x-amz-")||this.unsignableHeaders.indexOf(e)<0},isPresigned:function(){return!!this.request.headers["presigned-expires"]}}),t.exports=n.Signers.V4},{"../core":39,"./v4_credentials":116}],116:[function(e,t,r){var n=e("../core"),i={},o=[];t.exports={createScope:function(e,t,r){return[e.substr(0,8),t,r,"aws4_request"].join("/")},getSigningKey:function(e,t,r,s,a){var u=n.util.crypto.hmac(e.secretAccessKey,e.accessKeyId,"base64"),c=[u,t,r,s].join("_");if((a=!1!==a)&&c in i)return i[c];var l=n.util.crypto.hmac("AWS4"+e.secretAccessKey,t,"buffer"),h=n.util.crypto.hmac(l,r,"buffer"),p=n.util.crypto.hmac(h,s,"buffer"),f=n.util.crypto.hmac(p,"aws4_request","buffer");return a&&(i[c]=f,o.push(c),o.length>50&&delete i[o.shift()]),f},emptyCache:function(){i={},o=[]}}},{"../core":39}],114:[function(e,t,r){var n=e("../core"),i=n.util.inherit;e("./v3"),n.Signers.V3Https=i(n.Signers.V3,{authorization:function(e){return"AWS3-HTTPS AWSAccessKeyId="+e.accessKeyId+",Algorithm=HmacSHA256,Signature="+this.signature(e)},stringToSign:function(){return this.request.headers["X-Amz-Date"]}}),t.exports=n.Signers.V3Https},{"../core":39,"./v3":113}],113:[function(e,t,r){var n=e("../core"),i=n.util.inherit;n.Signers.V3=i(n.Signers.RequestSigner,{addAuthorization:function(e,t){var r=n.util.date.rfc822(t);this.request.headers["X-Amz-Date"]=r,e.sessionToken&&(this.request.headers["x-amz-security-token"]=e.sessionToken),this.request.headers["X-Amzn-Authorization"]=this.authorization(e,r)},authorization:function(e){return"AWS3 AWSAccessKeyId="+e.accessKeyId+",Algorithm=HmacSHA256,SignedHeaders="+this.signedHeaders()+",Signature="+this.signature(e)},signedHeaders:function(){var e=[];return n.util.arrayEach(this.headersToSign(),function(t){e.push(t.toLowerCase())}),e.sort().join(";")},canonicalHeaders:function(){var e=this.request.headers,t=[];return n.util.arrayEach(this.headersToSign(),function(r){t.push(r.toLowerCase().trim()+":"+String(e[r]).trim())}),t.sort().join("\n")+"\n"},headersToSign:function(){var e=[];return n.util.each(this.request.headers,function(t){("Host"===t||"Content-Encoding"===t||t.match(/^X-Amz/i))&&e.push(t)}),e},signature:function(e){return n.util.crypto.hmac(e.secretAccessKey,this.stringToSign(),"base64")},stringToSign:function(){var e=[];return e.push(this.request.method),e.push("/"),e.push(""),e.push(this.canonicalHeaders()),e.push(this.request.body),n.util.crypto.sha256(e.join("\n"))}}),t.exports=n.Signers.V3},{"../core":39}],112:[function(e,t,r){var n=e("../core"),i=n.util.inherit;n.Signers.V2=i(n.Signers.RequestSigner,{addAuthorization:function(e,t){t||(t=n.util.date.getDate());var r=this.request;r.params.Timestamp=n.util.date.iso8601(t),r.params.SignatureVersion="2",r.params.SignatureMethod="HmacSHA256",r.params.AWSAccessKeyId=e.accessKeyId,e.sessionToken&&(r.params.SecurityToken=e.sessionToken),delete r.params.Signature,r.params.Signature=this.signature(e),r.body=n.util.queryParamsToString(r.params),r.headers["Content-Length"]=r.body.length},signature:function(e){return n.util.crypto.hmac(e.secretAccessKey,this.stringToSign(),"base64")},stringToSign:function(){var e=[];return e.push(this.request.method),e.push(this.request.endpoint.host.toLowerCase()),e.push(this.request.pathname()),e.push(n.util.queryParamsToString(this.request.params)),e.join("\n")}}),t.exports=n.Signers.V2},{"../core":39}],111:[function(e,t,r){var n=e("../core"),i=n.util.inherit;n.Signers.S3=i(n.Signers.RequestSigner,{subResources:{acl:1,accelerate:1,analytics:1,cors:1,lifecycle:1,delete:1,inventory:1,location:1,logging:1,metrics:1,notification:1,partNumber:1,policy:1,requestPayment:1,replication:1,restore:1,tagging:1,torrent:1,uploadId:1,uploads:1,versionId:1,versioning:1,versions:1,website:1},responseHeaders:{"response-content-type":1,"response-content-language":1,"response-expires":1,"response-cache-control":1,"response-content-disposition":1,"response-content-encoding":1},addAuthorization:function(e,t){this.request.headers["presigned-expires"]||(this.request.headers["X-Amz-Date"]=n.util.date.rfc822(t)),e.sessionToken&&(this.request.headers["x-amz-security-token"]=e.sessionToken);var r=this.sign(e.secretAccessKey,this.stringToSign()),i="AWS "+e.accessKeyId+":"+r;this.request.headers.Authorization=i},stringToSign:function(){var e=this.request,t=[];t.push(e.method),t.push(e.headers["Content-MD5"]||""),t.push(e.headers["Content-Type"]||""),t.push(e.headers["presigned-expires"]||"");var r=this.canonicalizedAmzHeaders();return r&&t.push(r),t.push(this.canonicalizedResource()),t.join("\n")},canonicalizedAmzHeaders:function(){var e=[];n.util.each(this.request.headers,function(t){t.match(/^x-amz-/i)&&e.push(t)}),e.sort(function(e,t){return e.toLowerCase()<t.toLowerCase()?-1:1});var t=[];return n.util.arrayEach.call(this,e,function(e){t.push(e.toLowerCase()+":"+String(this.request.headers[e]))}),t.join("\n")},canonicalizedResource:function(){var e=this.request,t=e.path.split("?"),r=t[0],i=t[1],o="";if(e.virtualHostedBucket&&(o+="/"+e.virtualHostedBucket),o+=r,i){var s=[];n.util.arrayEach.call(this,i.split("&"),function(e){var t=e.split("=")[0],r=e.split("=")[1];if(this.subResources[t]||this.responseHeaders[t]){var n={name:t};void 0!==r&&(this.subResources[t]?n.value=r:n.value=decodeURIComponent(r)),s.push(n)}}),s.sort(function(e,t){return e.name<t.name?-1:1}),s.length&&(i=[],n.util.arrayEach(s,function(e){void 0===e.value?i.push(e.name):i.push(e.name+"="+e.value)}),o+="?"+i.join("&"))}return o},sign:function(e,t){return n.util.crypto.hmac(e,t,"base64","sha1")}}),t.exports=n.Signers.S3},{"../core":39}],109:[function(e,t,r){function n(e){var t=e.httpRequest.headers[a],r=e.service.getSignerClass(e);if(delete e.httpRequest.headers["User-Agent"],delete e.httpRequest.headers["X-Amz-User-Agent"],r===o.Signers.V4){if(t>604800){throw o.util.error(new Error,{code:"InvalidExpiryTime",message:"Presigning does not support expiry time greater than a week with SigV4 signing.",retryable:!1})}e.httpRequest.headers[a]=t}else{if(r!==o.Signers.S3)throw o.util.error(new Error,{message:"Presigning only supports S3 or SigV4 signing.",code:"UnsupportedSigner",retryable:!1});var n=e.service?e.service.getSkewCorrectedDate():o.util.date.getDate();e.httpRequest.headers[a]=parseInt(o.util.date.unixTimestamp(n)+t,10).toString()}}function i(e){var t=e.httpRequest.endpoint,r=o.util.urlParse(e.httpRequest.path),n={};r.search&&(n=o.util.queryStringParse(r.search.substr(1)));var i=e.httpRequest.headers.Authorization.split(" ");if("AWS"===i[0])i=i[1].split(":"),n.AWSAccessKeyId=i[0],n.Signature=i[1],o.util.each(e.httpRequest.headers,function(e,t){e===a&&(e="Expires"),0===e.indexOf("x-amz-meta-")&&(delete n[e],e=e.toLowerCase()),n[e]=t}),delete e.httpRequest.headers[a],delete n.Authorization,delete n.Host;else if("AWS4-HMAC-SHA256"===i[0]){i.shift();var s=i.join(" "),u=s.match(/Signature=(.*?)(?:,|\s|\r?\n|$)/)[1];n["X-Amz-Signature"]=u,delete n.Expires}t.pathname=r.pathname,t.search=o.util.queryParamsToString(n)}var o=e("../core"),s=o.util.inherit,a="presigned-expires";o.Signers.Presign=s({sign:function(e,t,r){if(e.httpRequest.headers[a]=t||3600,e.on("build",n),e.on("sign",i),e.removeListener("afterBuild",o.EventListeners.Core.SET_CONTENT_LENGTH),e.removeListener("afterBuild",o.EventListeners.Core.COMPUTE_SHA256),e.emit("beforePresign",[e]),!r){if(e.build(),e.response.error)throw e.response.error;return o.util.urlFormat(e.httpRequest.endpoint)}e.build(function(){this.response.error?r(this.response.error):r(null,o.util.urlFormat(e.httpRequest.endpoint))})}}),t.exports=o.Signers.Presign},{"../core":39}],89:[function(e,t,r){(function(r){var n=e("./core"),i=e("./model/api"),o=e("./region_config"),s=n.util.inherit,a=0;n.Service=s({constructor:function(e){if(!this.loadServiceClass)throw n.util.error(new Error,"Service must be constructed with `new' operator");var t=this.loadServiceClass(e||{});if(t){var r=n.util.copy(e),i=new t(e);return Object.defineProperty(i,"_originalConfig",{get:function(){return r},enumerable:!1,configurable:!0}),i._clientId=++a,i}this.initialize(e)},initialize:function(e){var t=n.config[this.serviceIdentifier];if(this.config=new n.Config(n.config),t&&this.config.update(t,!0),e&&this.config.update(e,!0),this.validateService(),this.config.endpoint||o.configureEndpoint(this),this.config.endpoint=this.endpointFromTemplate(this.config.endpoint),this.setEndpoint(this.config.endpoint),n.SequentialExecutor.call(this),n.Service.addDefaultMonitoringListeners(this),(this.config.clientSideMonitoring||n.Service._clientSideMonitoring)&&this.publisher){var i=this.publisher;this.addNamedListener("PUBLISH_API_CALL","apiCall",function(e){r.nextTick(function(){i.eventHandler(e)})}),this.addNamedListener("PUBLISH_API_ATTEMPT","apiCallAttempt",function(e){r.nextTick(function(){i.eventHandler(e)})})}},validateService:function(){},loadServiceClass:function(e){var t=e;if(n.util.isEmpty(this.api)){if(t.apiConfig)return n.Service.defineServiceApi(this.constructor,t.apiConfig);if(this.constructor.services){t=new n.Config(n.config),t.update(e,!0);var r=t.apiVersions[this.constructor.serviceIdentifier];return r=r||t.apiVersion,this.getLatestServiceClass(r)}return null}return null},getLatestServiceClass:function(e){return e=this.getLatestServiceVersion(e),null===this.constructor.services[e]&&n.Service.defineServiceApi(this.constructor,e),this.constructor.services[e]},getLatestServiceVersion:function(e){if(!this.constructor.services||0===this.constructor.services.length)throw new Error("No services defined on "+this.constructor.serviceIdentifier);if(e?n.util.isType(e,Date)&&(e=n.util.date.iso8601(e).split("T")[0]):e="latest",Object.hasOwnProperty(this.constructor.services,e))return e;for(var t=Object.keys(this.constructor.services).sort(),r=null,i=t.length-1;i>=0;i--)if("*"!==t[i][t[i].length-1]&&(r=t[i]),t[i].substr(0,10)<=e)return r;throw new Error("Could not find "+this.constructor.serviceIdentifier+" API to satisfy version constraint `"+e+"'")},api:{},defaultRetryCount:3,customizeRequests:function(e){if(e){if("function"!=typeof e)throw new Error("Invalid callback type '"+typeof e+"' provided in customizeRequests");this.customRequestHandler=e}else this.customRequestHandler=null},makeRequest:function(e,t,r){if("function"==typeof t&&(r=t,t=null),t=t||{},this.config.params){var i=this.api.operations[e];i&&(t=n.util.copy(t),n.util.each(this.config.params,function(e,r){i.input.members[e]&&(void 0!==t[e]&&null!==t[e]||(t[e]=r))}))}var o=new n.Request(this,e,t);return this.addAllRequestListeners(o),this.attachMonitoringEmitter(o),r&&o.send(r),o},makeUnauthenticatedRequest:function(e,t,r){"function"==typeof t&&(r=t,t={});var n=this.makeRequest(e,t).toUnauthenticated();return r?n.send(r):n},waitFor:function(e,t,r){return new n.ResourceWaiter(this,e).wait(t,r)},addAllRequestListeners:function(e){for(var t=[n.events,n.EventListeners.Core,this.serviceInterface(),n.EventListeners.CorePost],r=0;r<t.length;r++)t[r]&&e.addListeners(t[r]);this.config.paramValidation||e.removeListener("validate",n.EventListeners.Core.VALIDATE_PARAMETERS),this.config.logger&&e.addListeners(n.EventListeners.Logger),this.setupRequestListeners(e),"function"==typeof this.constructor.prototype.customRequestHandler&&this.constructor.prototype.customRequestHandler(e),Object.prototype.hasOwnProperty.call(this,"customRequestHandler")&&"function"==typeof this.customRequestHandler&&this.customRequestHandler(e)},apiCallEvent:function(e){var t=e.service.api.operations[e.operation],r={Type:"ApiCall",Api:t?t.name:e.operation,Version:1,Service:e.service.api.serviceId||e.service.api.endpointPrefix,Region:e.httpRequest.region,MaxRetriesExceeded:0,UserAgent:e.httpRequest.getUserAgent()},n=e.response;if(n.httpResponse.statusCode&&(r.FinalHttpStatusCode=n.httpResponse.statusCode),n.error){var i=n.error;n.httpResponse.statusCode>299?(i.code&&(r.FinalAwsException=i.code),i.message&&(r.FinalAwsExceptionMessage=i.message)):((i.code||i.name)&&(r.FinalSdkException=i.code||i.name),i.message&&(r.FinalSdkExceptionMessage=i.message))}return r},apiAttemptEvent:function(e){var t=e.service.api.operations[e.operation],r={Type:"ApiCallAttempt",Api:t?t.name:e.operation,Version:1,Service:e.service.api.serviceId||e.service.api.endpointPrefix,Fqdn:e.httpRequest.endpoint.hostname,UserAgent:e.httpRequest.getUserAgent()},n=e.response;return n.httpResponse.statusCode&&(r.HttpStatusCode=n.httpResponse.statusCode),!e._unAuthenticated&&e.service.config.credentials&&e.service.config.credentials.accessKeyId&&(r.AccessKey=e.service.config.credentials.accessKeyId),n.httpResponse.headers?(e.httpRequest.headers["x-amz-security-token"]&&(r.SessionToken=e.httpRequest.headers["x-amz-security-token"]),n.httpResponse.headers["x-amzn-requestid"]&&(r.XAmznRequestId=n.httpResponse.headers["x-amzn-requestid"]),n.httpResponse.headers["x-amz-request-id"]&&(r.XAmzRequestId=n.httpResponse.headers["x-amz-request-id"]),n.httpResponse.headers["x-amz-id-2"]&&(r.XAmzId2=n.httpResponse.headers["x-amz-id-2"]),r):r},attemptFailEvent:function(e){var t=this.apiAttemptEvent(e),r=e.response,n=r.error;return r.httpResponse.statusCode>299?(n.code&&(t.AwsException=n.code),n.message&&(t.AwsExceptionMessage=n.message)):((n.code||n.name)&&(t.SdkException=n.code||n.name),n.message&&(t.SdkExceptionMessage=n.message)),t},attachMonitoringEmitter:function(e){var t,r,i,o,s,a,u=0,c=this;e.on("validate",function(){o=n.util.realClock.now(),a=Date.now()},!0),e.on("sign",function(){r=n.util.realClock.now(),t=Date.now(),s=e.httpRequest.region,u++},!0),e.on("validateResponse",function(){i=Math.round(n.util.realClock.now()-r)}),e.addNamedListener("API_CALL_ATTEMPT","success",function(){var r=c.apiAttemptEvent(e);r.Timestamp=t,r.AttemptLatency=i>=0?i:0,r.Region=s,c.emit("apiCallAttempt",[r])}),e.addNamedListener("API_CALL_ATTEMPT_RETRY","retry",function(){var o=c.attemptFailEvent(e);o.Timestamp=t,i=i||Math.round(n.util.realClock.now()-r),o.AttemptLatency=i>=0?i:0,o.Region=s,c.emit("apiCallAttempt",[o])}),e.addNamedListener("API_CALL","complete",function(){var t=c.apiCallEvent(e);if(t.AttemptCount=u,!(t.AttemptCount<=0)){t.Timestamp=a;var r=Math.round(n.util.realClock.now()-o);t.Latency=r>=0?r:0;var i=e.response;i.error&&i.error.retryable&&"number"==typeof i.retryCount&&"number"==typeof i.maxRetries&&i.retryCount>=i.maxRetries&&(t.MaxRetriesExceeded=1),c.emit("apiCall",[t])}})},setupRequestListeners:function(e){},getSignerClass:function(e){var t,r=null,i="";if(e){r=(e.service.api.operations||{})[e.operation]||null,i=r?r.authtype:""}return t=this.config.signatureVersion?this.config.signatureVersion:"v4"===i||"v4-unsigned-body"===i?"v4":this.api.signatureVersion,n.Signers.RequestSigner.getVersion(t)},serviceInterface:function(){switch(this.api.protocol){case"ec2":case"query":return n.EventListeners.Query;case"json":return n.EventListeners.Json;case"rest-json":return n.EventListeners.RestJson;case"rest-xml":return n.EventListeners.RestXml}if(this.api.protocol)throw new Error("Invalid service `protocol' "+this.api.protocol+" in API config")},successfulResponse:function(e){return e.httpResponse.statusCode<300},numRetries:function(){return void 0!==this.config.maxRetries?this.config.maxRetries:this.defaultRetryCount},retryDelays:function(e,t){return n.util.calculateRetryDelay(e,this.config.retryDelayOptions,t)},retryableError:function(e){return!!this.timeoutError(e)||(!!this.networkingError(e)||(!!this.expiredCredentialsError(e)||(!!this.throttledError(e)||e.statusCode>=500)))},networkingError:function(e){return"NetworkingError"===e.code},timeoutError:function(e){return"TimeoutError"===e.code},expiredCredentialsError:function(e){return"ExpiredTokenException"===e.code},clockSkewError:function(e){switch(e.code){case"RequestTimeTooSkewed":case"RequestExpired":case"InvalidSignatureException":case"SignatureDoesNotMatch":case"AuthFailure":case"RequestInTheFuture":return!0;default:return!1}},getSkewCorrectedDate:function(){return new Date(Date.now()+this.config.systemClockOffset)},applyClockOffset:function(e){e&&(this.config.systemClockOffset=e-Date.now())},isClockSkewed:function(e){if(e)return Math.abs(this.getSkewCorrectedDate().getTime()-e)>=3e5},throttledError:function(e){if(429===e.statusCode)return!0;switch(e.code){case"ProvisionedThroughputExceededException":case"Throttling":case"ThrottlingException":case"RequestLimitExceeded":case"RequestThrottled":case"RequestThrottledException":case"TooManyRequestsException":case"TransactionInProgressException":case"EC2ThrottledException":return!0;default:return!1}},endpointFromTemplate:function(e){if("string"!=typeof e)return e;var t=e;return t=t.replace(/\{service\}/g,this.api.endpointPrefix),t=t.replace(/\{region\}/g,this.config.region),t=t.replace(/\{scheme\}/g,this.config.sslEnabled?"https":"http")},setEndpoint:function(e){this.endpoint=new n.Endpoint(e,this.config)},paginationConfig:function(e,t){var r=this.api.operations[e].paginator;if(!r){if(t){var i=new Error;throw n.util.error(i,"No pagination configuration for "+e)}return null}return r}}),n.util.update(n.Service,{defineMethods:function(e){n.util.each(e.prototype.api.operations,function(t){if(!e.prototype[t]){"none"===e.prototype.api.operations[t].authtype?e.prototype[t]=function(e,r){return this.makeUnauthenticatedRequest(t,e,r)}:e.prototype[t]=function(e,r){return this.makeRequest(t,e,r)}}})},defineService:function(e,t,r){n.Service._serviceMap[e]=!0,Array.isArray(t)||(r=t,t=[]);var i=s(n.Service,r||{});if("string"==typeof e){n.Service.addVersions(i,t);var o=i.serviceIdentifier||e;i.serviceIdentifier=o}else i.prototype.api=e,n.Service.defineMethods(i);if(n.SequentialExecutor.call(this.prototype),!this.prototype.publisher&&n.util.clientSideMonitoring){var a=n.util.clientSideMonitoring.Publisher,u=n.util.clientSideMonitoring.configProvider,c=u();this.prototype.publisher=new a(c),c.enabled&&(n.Service._clientSideMonitoring=!0)}return n.SequentialExecutor.call(i.prototype),n.Service.addDefaultMonitoringListeners(i.prototype),i},addVersions:function(e,t){Array.isArray(t)||(t=[t]),e.services=e.services||{};for(var r=0;r<t.length;r++)void 0===e.services[t[r]]&&(e.services[t[r]]=null);e.apiVersions=Object.keys(e.services).sort()},defineServiceApi:function(e,t,r){function o(t){t.isApi?a.prototype.api=t:a.prototype.api=new i(t,{serviceIdentifier:e.serviceIdentifier})}var a=s(e,{serviceIdentifier:e.serviceIdentifier});if("string"==typeof t){if(r)o(r);else try{o(n.apiLoader(e.serviceIdentifier,t))}catch(r){throw n.util.error(r,{message:"Could not find API configuration "+e.serviceIdentifier+"-"+t})}Object.prototype.hasOwnProperty.call(e.services,t)||(e.apiVersions=e.apiVersions.concat(t).sort()),e.services[t]=a}else o(t);return n.Service.defineMethods(a),a},hasService:function(e){return Object.prototype.hasOwnProperty.call(n.Service._serviceMap,e)},
        addDefaultMonitoringListeners:function(e){e.addNamedListener("MONITOR_EVENTS_BUBBLE","apiCallAttempt",function(t){var r=Object.getPrototypeOf(e);r._events&&r.emit("apiCallAttempt",[t])}),e.addNamedListener("CALL_EVENTS_BUBBLE","apiCall",function(t){var r=Object.getPrototypeOf(e);r._events&&r.emit("apiCall",[t])})},_serviceMap:{}}),n.util.mixin(n.Service,n.SequentialExecutor),t.exports=n.Service}).call(this,e("_process"))},{"./core":39,"./model/api":65,"./region_config":82,_process:8}],82:[function(e,t,r){function n(e){if(!e)return null;var t=e.split("-");return t.length<3?null:t.slice(0,t.length-2).join("-")+"-*"}function i(e){var t=e.config.region,r=n(t),i=e.api.endpointPrefix;return[[t,i],[r,i],[t,"*"],[r,"*"],["*",i],["*","*"]].map(function(e){return e[0]&&e[1]?e.join("/"):null})}function o(e,t){u.each(t,function(t,r){"globalEndpoint"!==t&&(void 0!==e.config[t]&&null!==e.config[t]||(e.config[t]=r))})}function s(e){for(var t=i(e),r=0;r<t.length;r++){var n=t[r];if(n&&Object.prototype.hasOwnProperty.call(c.rules,n)){var s=c.rules[n];return"string"==typeof s&&(s=c.patterns[s]),e.config.useDualstack&&u.isDualstackAvailable(e)&&(s=u.copy(s),s.endpoint="{service}.dualstack.{region}.amazonaws.com"),e.isGlobalEndpoint=!!s.globalEndpoint,s.signatureVersion||(s.signatureVersion="v4"),void o(e,s)}}}function a(e){for(var t={"^(us|eu|ap|sa|ca|me)\\-\\w+\\-\\d+$":"amazonaws.com","^cn\\-\\w+\\-\\d+$":"amazonaws.com.cn","^us\\-gov\\-\\w+\\-\\d+$":"amazonaws.com","^us\\-iso\\-\\w+\\-\\d+$":"c2s.ic.gov","^us\\-isob\\-\\w+\\-\\d+$":"sc2s.sgov.gov"},r=Object.keys(t),n=0;n<r.length;n++){var i=RegExp(r[n]),o=t[r[n]];if(i.test(e))return o}return"amazonaws.com"}var u=e("./util"),c=e("./region_config_data.json");t.exports={configureEndpoint:s,getEndpointSuffix:a}},{"./region_config_data.json":83,"./util":118}],83:[function(e,t,r){t.exports={rules:{"*/*":{endpoint:"{service}.{region}.amazonaws.com"},"cn-*/*":{endpoint:"{service}.{region}.amazonaws.com.cn"},"us-iso-*/*":{endpoint:"{service}.{region}.c2s.ic.gov"},"us-isob-*/*":{endpoint:"{service}.{region}.sc2s.sgov.gov"},"*/budgets":"globalSSL","*/cloudfront":"globalSSL","*/iam":"globalSSL","*/sts":"globalSSL","*/importexport":{endpoint:"{service}.amazonaws.com",signatureVersion:"v2",globalEndpoint:!0},"*/route53":{endpoint:"https://{service}.amazonaws.com",signatureVersion:"v3https",globalEndpoint:!0},"*/waf":"globalSSL","us-gov-*/iam":"globalGovCloud","us-gov-*/sts":{endpoint:"{service}.{region}.amazonaws.com"},"us-gov-west-1/s3":"s3signature","us-west-1/s3":"s3signature","us-west-2/s3":"s3signature","eu-west-1/s3":"s3signature","ap-southeast-1/s3":"s3signature","ap-southeast-2/s3":"s3signature","ap-northeast-1/s3":"s3signature","sa-east-1/s3":"s3signature","us-east-1/s3":{endpoint:"{service}.amazonaws.com",signatureVersion:"s3"},"us-east-1/sdb":{endpoint:"{service}.amazonaws.com",signatureVersion:"v2"},"*/sdb":{endpoint:"{service}.{region}.amazonaws.com",signatureVersion:"v2"}},patterns:{globalSSL:{endpoint:"https://{service}.amazonaws.com",globalEndpoint:!0},globalGovCloud:{endpoint:"{service}.us-gov.amazonaws.com"},s3signature:{endpoint:"{service}.{region}.amazonaws.com",signatureVersion:"s3"}}}},{}],86:[function(e,t,r){var n=e("./core"),i=n.util.inherit,o=e("jmespath");n.Response=i({constructor:function(e){this.request=e,this.data=null,this.error=null,this.retryCount=0,this.redirectCount=0,this.httpResponse=new n.HttpResponse,e&&(this.maxRetries=e.service.numRetries(),this.maxRedirects=e.service.config.maxRedirects)},nextPage:function(e){var t,r=this.request.service,i=this.request.operation;try{t=r.paginationConfig(i,!0)}catch(e){this.error=e}if(!this.hasNextPage()){if(e)e(this.error,null);else if(this.error)throw this.error;return null}var o=n.util.copy(this.request.params);if(this.nextPageTokens){var s=t.inputToken;"string"==typeof s&&(s=[s]);for(var a=0;a<s.length;a++)o[s[a]]=this.nextPageTokens[a];return r.makeRequest(this.request.operation,o,e)}return e?e(null,null):null},hasNextPage:function(){return this.cacheNextPageTokens(),!!this.nextPageTokens||void 0===this.nextPageTokens&&void 0},cacheNextPageTokens:function(){if(Object.prototype.hasOwnProperty.call(this,"nextPageTokens"))return this.nextPageTokens;this.nextPageTokens=void 0;var e=this.request.service.paginationConfig(this.request.operation);if(!e)return this.nextPageTokens;if(this.nextPageTokens=null,e.moreResults&&!o.search(this.data,e.moreResults))return this.nextPageTokens;var t=e.outputToken;return"string"==typeof t&&(t=[t]),n.util.arrayEach.call(this,t,function(e){var t=o.search(this.data,e);t&&(this.nextPageTokens=this.nextPageTokens||[],this.nextPageTokens.push(t))}),this.nextPageTokens}})},{"./core":39,jmespath:7}],85:[function(e,t,r){function n(e){var t=e.request._waiter,r=t.config.acceptors,n=!1,i="retry";r.forEach(function(r){if(!n){var o=t.matchers[r.matcher];o&&o(e,r.expected,r.argument)&&(n=!0,i=r.state)}}),!n&&e.error&&(i="failure"),"success"===i?t.setSuccess(e):t.setError(e,"retry"===i)}var i=e("./core"),o=i.util.inherit,s=e("jmespath");i.ResourceWaiter=o({constructor:function(e,t){this.service=e,this.state=t,this.loadWaiterConfig(this.state)},service:null,state:null,config:null,matchers:{path:function(e,t,r){try{var n=s.search(e.data,r)}catch(e){return!1}return s.strictDeepEqual(n,t)},pathAll:function(e,t,r){try{var n=s.search(e.data,r)}catch(e){return!1}Array.isArray(n)||(n=[n]);var i=n.length;if(!i)return!1;for(var o=0;o<i;o++)if(!s.strictDeepEqual(n[o],t))return!1;return!0},pathAny:function(e,t,r){try{var n=s.search(e.data,r)}catch(e){return!1}Array.isArray(n)||(n=[n]);for(var i=n.length,o=0;o<i;o++)if(s.strictDeepEqual(n[o],t))return!0;return!1},status:function(e,t){var r=e.httpResponse.statusCode;return"number"==typeof r&&r===t},error:function(e,t){return"string"==typeof t&&e.error?t===e.error.code:t===!!e.error}},listeners:(new i.SequentialExecutor).addNamedListeners(function(e){e("RETRY_CHECK","retry",function(e){var t=e.request._waiter;e.error&&"ResourceNotReady"===e.error.code&&(e.error.retryDelay=1e3*(t.config.delay||0))}),e("CHECK_OUTPUT","extractData",n),e("CHECK_ERROR","extractError",n)}),wait:function(e,t){"function"==typeof e&&(t=e,e=void 0),e&&e.$waiter&&(e=i.util.copy(e),"number"==typeof e.$waiter.delay&&(this.config.delay=e.$waiter.delay),"number"==typeof e.$waiter.maxAttempts&&(this.config.maxAttempts=e.$waiter.maxAttempts),delete e.$waiter);var r=this.service.makeRequest(this.config.operation,e);return r._waiter=this,r.response.maxRetries=this.config.maxAttempts,r.addListeners(this.listeners),t&&r.send(t),r},setSuccess:function(e){e.error=null,e.data=e.data||{},e.request.removeAllListeners("extractData")},setError:function(e,t){e.data=null,e.error=i.util.error(e.error||new Error,{code:"ResourceNotReady",message:"Resource is not in the state "+this.state,retryable:t})},loadWaiterConfig:function(e){if(!this.service.api.waiters[e])throw new i.util.error(new Error,{code:"StateNotFoundError",message:"State "+e+" not found."});this.config=i.util.copy(this.service.api.waiters[e])}})},{"./core":39,jmespath:7}],84:[function(e,t,r){(function(t){function r(e){return Object.prototype.hasOwnProperty.call(u,e._asm.currentState)}var n=e("./core"),i=e("./state_machine"),o=n.util.inherit,s=n.util.domain,a=e("jmespath"),u={success:1,error:1,complete:1},c=new i;c.setupStates=function(){var e=function(e,t){var n=this;n._haltHandlersOnError=!1,n.emit(n._asm.currentState,function(e){if(e)if(r(n)){if(!(s&&n.domain instanceof s.Domain))throw e;e.domainEmitter=n,e.domain=n.domain,e.domainThrown=!1,n.domain.emit("error",e)}else n.response.error=e,t(e);else t(n.response.error)})};this.addState("validate","build","error",e),this.addState("build","afterBuild","restart",e),this.addState("afterBuild","sign","restart",e),this.addState("sign","send","retry",e),this.addState("retry","afterRetry","afterRetry",e),this.addState("afterRetry","sign","error",e),this.addState("send","validateResponse","retry",e),this.addState("validateResponse","extractData","extractError",e),this.addState("extractError","extractData","retry",e),this.addState("extractData","success","retry",e),this.addState("restart","build","error",e),this.addState("success","complete","complete",e),this.addState("error","complete","complete",e),this.addState("complete",null,null,e)},c.setupStates(),n.Request=o({constructor:function(e,t,r){var o=e.endpoint,a=e.config.region,u=e.config.customUserAgent;e.isGlobalEndpoint&&(a="us-east-1"),this.domain=s&&s.active,this.service=e,this.operation=t,this.params=r||{},this.httpRequest=new n.HttpRequest(o,a),this.httpRequest.appendToUserAgent(u),this.startTime=e.getSkewCorrectedDate(),this.response=new n.Response(this),this._asm=new i(c.states,"validate"),this._haltHandlersOnError=!1,n.SequentialExecutor.call(this),this.emit=this.emitEvent},send:function(e){return e&&(this.httpRequest.appendToUserAgent("callback"),this.on("complete",function(t){e.call(t,t.error,t.data)})),this.runTo(),this.response},build:function(e){return this.runTo("send",e)},runTo:function(e,t){return this._asm.runTo(e,t,this),this},abort:function(){return this.removeAllListeners("validateResponse"),this.removeAllListeners("extractError"),this.on("validateResponse",function(e){e.error=n.util.error(new Error("Request aborted by user"),{code:"RequestAbortedError",retryable:!1})}),this.httpRequest.stream&&!this.httpRequest.stream.didCallback&&(this.httpRequest.stream.abort(),this.httpRequest._abortCallback?this.httpRequest._abortCallback():this.removeAllListeners("send")),this},eachPage:function(e){function t(r){e.call(r,r.error,r.data,function(i){!1!==i&&(r.hasNextPage()?r.nextPage().on("complete",t).send():e.call(r,null,null,n.util.fn.noop))})}e=n.util.fn.makeAsync(e,3),this.on("complete",t).send()},eachItem:function(e){function t(t,i){if(t)return e(t,null);if(null===i)return e(null,null);var o=r.service.paginationConfig(r.operation),s=o.resultKey;Array.isArray(s)&&(s=s[0]);var u=a.search(i,s),c=!0;return n.util.arrayEach(u,function(t){if(!1===(c=e(null,t)))return n.util.abort}),c}var r=this;this.eachPage(t)},isPageable:function(){return!!this.service.paginationConfig(this.operation)},createReadStream:function(){var e=n.util.stream,r=this,i=null;return 2===n.HttpClient.streamsApiVersion?(i=new e.PassThrough,t.nextTick(function(){r.send()})):(i=new e.Stream,i.readable=!0,i.sent=!1,i.on("newListener",function(e){i.sent||"data"!==e||(i.sent=!0,t.nextTick(function(){r.send()}))})),this.on("error",function(e){i.emit("error",e)}),this.on("httpHeaders",function(t,o,s){if(t<300){r.removeListener("httpData",n.EventListeners.Core.HTTP_DATA),r.removeListener("httpError",n.EventListeners.Core.HTTP_ERROR),r.on("httpError",function(e){s.error=e,s.error.retryable=!1});var a,u=!1;if("HEAD"!==r.httpRequest.method&&(a=parseInt(o["content-length"],10)),void 0!==a&&!isNaN(a)&&a>=0){u=!0;var c=0}var l=function(){u&&c!==a?i.emit("error",n.util.error(new Error("Stream content length mismatch. Received "+c+" of "+a+" bytes."),{code:"StreamContentLengthMismatch"})):2===n.HttpClient.streamsApiVersion?i.end():i.emit("end")},h=s.httpResponse.createUnbufferedStream();if(2===n.HttpClient.streamsApiVersion)if(u){var p=new e.PassThrough;p._write=function(t){return t&&t.length&&(c+=t.length),e.PassThrough.prototype._write.apply(this,arguments)},p.on("end",l),i.on("error",function(e){u=!1,h.unpipe(p),p.emit("end"),p.end()}),h.pipe(p).pipe(i,{end:!1})}else h.pipe(i);else u&&h.on("data",function(e){e&&e.length&&(c+=e.length)}),h.on("data",function(e){i.emit("data",e)}),h.on("end",l);h.on("error",function(e){u=!1,i.emit("error",e)})}}),i},emitEvent:function(e,t,r){"function"==typeof t&&(r=t,t=null),r||(r=function(){}),t||(t=this.eventParameters(e,this.response)),n.SequentialExecutor.prototype.emit.call(this,e,t,function(e){e&&(this.response.error=e),r.call(this,e)})},eventParameters:function(e){switch(e){case"restart":case"validate":case"sign":case"build":case"afterValidate":case"afterBuild":return[this];case"error":return[this.response.error,this.response];default:return[this.response]}},presign:function(e,t){return t||"function"!=typeof e||(t=e,e=null),(new n.Signers.Presign).sign(this.toGet(),e,t)},isPresigned:function(){return Object.prototype.hasOwnProperty.call(this.httpRequest.headers,"presigned-expires")},toUnauthenticated:function(){return this._unAuthenticated=!0,this.removeListener("validate",n.EventListeners.Core.VALIDATE_CREDENTIALS),this.removeListener("sign",n.EventListeners.Core.SIGN),this},toGet:function(){return"query"!==this.service.api.protocol&&"ec2"!==this.service.api.protocol||(this.removeListener("build",this.buildAsGet),this.addListener("build",this.buildAsGet)),this},buildAsGet:function(e){e.httpRequest.method="GET",e.httpRequest.path=e.service.endpoint.path+"?"+e.httpRequest.body,e.httpRequest.body="",delete e.httpRequest.headers["Content-Length"],delete e.httpRequest.headers["Content-Type"]},haltHandlersOnError:function(){this._haltHandlersOnError=!0}}),n.Request.addPromisesToClass=function(e){this.prototype.promise=function(){var t=this;return this.httpRequest.appendToUserAgent("promise"),new e(function(e,r){t.on("complete",function(t){t.error?r(t.error):e(Object.defineProperty(t.data||{},"$response",{value:t}))}),t.runTo()})}},n.Request.deletePromisesFromClass=function(){delete this.prototype.promise},n.util.addPromises(n.Request),n.util.mixin(n.Request,n.SequentialExecutor)}).call(this,e("_process"))},{"./core":39,"./state_machine":117,_process:8,jmespath:7}],117:[function(e,t,r){function n(e,t){this.currentState=t||null,this.states=e||{}}n.prototype.runTo=function(e,t,r,n){"function"==typeof e&&(n=r,r=t,t=e,e=null);var i=this,o=i.states[i.currentState];o.fn.call(r||i,n,function(n){if(n){if(!o.fail)return t?t.call(r,n):null;i.currentState=o.fail}else{if(!o.accept)return t?t.call(r):null;i.currentState=o.accept}if(i.currentState===e)return t?t.call(r,n):null;i.runTo(e,t,r,n)})},n.prototype.addState=function(e,t,r,n){return"function"==typeof t?(n=t,t=null,r=null):"function"==typeof r&&(n=r,r=null),this.currentState||(this.currentState=e),this.states[e]={accept:t,fail:r,fn:n},this},t.exports=n},{}],71:[function(e,t,r){var n=e("./core");n.ParamValidator=n.util.inherit({constructor:function(e){!0!==e&&void 0!==e||(e={min:!0}),this.validation=e},validate:function(e,t,r){if(this.errors=[],this.validateMember(e,t||{},r||"params"),this.errors.length>1){var i=this.errors.join("\n* ");throw i="There were "+this.errors.length+" validation errors:\n* "+i,n.util.error(new Error(i),{code:"MultipleValidationErrors",errors:this.errors})}if(1===this.errors.length)throw this.errors[0];return!0},fail:function(e,t){this.errors.push(n.util.error(new Error(t),{code:e}))},validateStructure:function(e,t,r){this.validateType(t,r,["object"],"structure");for(var n,i=0;e.required&&i<e.required.length;i++){n=e.required[i];var o=t[n];void 0!==o&&null!==o||this.fail("MissingRequiredParameter","Missing required key '"+n+"' in "+r)}for(n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var s=t[n],a=e.members[n];if(void 0!==a){var u=[r,n].join(".");this.validateMember(a,s,u)}else this.fail("UnexpectedParameter","Unexpected key '"+n+"' found in "+r)}return!0},validateMember:function(e,t,r){switch(e.type){case"structure":return this.validateStructure(e,t,r);case"list":return this.validateList(e,t,r);case"map":return this.validateMap(e,t,r);default:return this.validateScalar(e,t,r)}},validateList:function(e,t,r){if(this.validateType(t,r,[Array])){this.validateRange(e,t.length,r,"list member count");for(var n=0;n<t.length;n++)this.validateMember(e.member,t[n],r+"["+n+"]")}},validateMap:function(e,t,r){if(this.validateType(t,r,["object"],"map")){var n=0;for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(this.validateMember(e.key,i,r+"[key='"+i+"']"),this.validateMember(e.value,t[i],r+"['"+i+"']"),n++);this.validateRange(e,n,r,"map member count")}},validateScalar:function(e,t,r){switch(e.type){case null:case void 0:case"string":return this.validateString(e,t,r);case"base64":case"binary":return this.validatePayload(t,r);case"integer":case"float":return this.validateNumber(e,t,r);case"boolean":return this.validateType(t,r,["boolean"]);case"timestamp":return this.validateType(t,r,[Date,/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(\.\d+)?Z$/,"number"],"Date object, ISO-8601 string, or a UNIX timestamp");default:return this.fail("UnkownType","Unhandled type "+e.type+" for "+r)}},validateString:function(e,t,r){var n=["string"];e.isJsonValue&&(n=n.concat(["number","object","boolean"])),null!==t&&this.validateType(t,r,n)&&(this.validateEnum(e,t,r),this.validateRange(e,t.length,r,"string length"),this.validatePattern(e,t,r),this.validateUri(e,t,r))},validateUri:function(e,t,r){"uri"===e.location&&0===t.length&&this.fail("UriParameterError",'Expected uri parameter to have length >= 1, but found "'+t+'" for '+r)},validatePattern:function(e,t,r){this.validation.pattern&&void 0!==e.pattern&&(new RegExp(e.pattern).test(t)||this.fail("PatternMatchError",'Provided value "'+t+'" does not match regex pattern /'+e.pattern+"/ for "+r))},validateRange:function(e,t,r,n){this.validation.min&&void 0!==e.min&&t<e.min&&this.fail("MinRangeError","Expected "+n+" >= "+e.min+", but found "+t+" for "+r),this.validation.max&&void 0!==e.max&&t>e.max&&this.fail("MaxRangeError","Expected "+n+" <= "+e.max+", but found "+t+" for "+r)},validateEnum:function(e,t,r){this.validation.enum&&void 0!==e.enum&&-1===e.enum.indexOf(t)&&this.fail("EnumError","Found string value of "+t+", but expected "+e.enum.join("|")+" for "+r)},validateType:function(e,t,r,i){if(null===e||void 0===e)return!1;for(var o=!1,s=0;s<r.length;s++){if("string"==typeof r[s]){if(typeof e===r[s])return!0}else if(r[s]instanceof RegExp){if((e||"").toString().match(r[s]))return!0}else{if(e instanceof r[s])return!0;if(n.util.isType(e,r[s]))return!0;i||o||(r=r.slice()),r[s]=n.util.typeName(r[s])}o=!0}var a=i;a||(a=r.join(", ").replace(/,([^,]+)$/,", or$1"));var u=a.match(/^[aeiou]/i)?"n":"";return this.fail("InvalidParameterType","Expected "+t+" to be a"+u+" "+a),!1},validateNumber:function(e,t,r){if(null!==t&&void 0!==t){if("string"==typeof t){var n=parseFloat(t);n.toString()===t&&(t=n)}this.validateType(t,r,["number"])&&this.validateRange(e,t,r,"numeric value")}},validatePayload:function(e,t){if(null!==e&&void 0!==e&&"string"!=typeof e&&(!e||"number"!=typeof e.byteLength)){if(n.util.isNode()){var r=n.util.stream.Stream;if(n.util.Buffer.isBuffer(e)||e instanceof r)return}else if(void 0!==typeof Blob&&e instanceof Blob)return;var i=["Buffer","Stream","File","Blob","ArrayBuffer","DataView"];if(e)for(var o=0;o<i.length;o++){if(n.util.isType(e,i[o]))return;if(n.util.typeName(e.constructor)===i[o])return}this.fail("InvalidParameterType","Expected "+t+" to be a string, Buffer, Stream, Blob, or typed array object")}}})},{"./core":39}],65:[function(e,t,r){function n(e,t){function r(e,t){!0===t.endpointoperation&&h(n,"endpointOperation",l.string.lowerFirst(e))}var n=this;e=e||{},t=t||{},t.api=this,e.metadata=e.metadata||{};var f=t.serviceIdentifier;delete t.serviceIdentifier,h(this,"isApi",!0,!1),h(this,"apiVersion",e.metadata.apiVersion),h(this,"endpointPrefix",e.metadata.endpointPrefix),h(this,"signingName",e.metadata.signingName),h(this,"globalEndpoint",e.metadata.globalEndpoint),h(this,"signatureVersion",e.metadata.signatureVersion),h(this,"jsonVersion",e.metadata.jsonVersion),h(this,"targetPrefix",e.metadata.targetPrefix),h(this,"protocol",e.metadata.protocol),h(this,"timestampFormat",e.metadata.timestampFormat),h(this,"xmlNamespaceUri",e.metadata.xmlNamespace),h(this,"abbreviation",e.metadata.serviceAbbreviation),h(this,"fullName",e.metadata.serviceFullName),h(this,"serviceId",e.metadata.serviceId),f&&c[f]&&h(this,"xmlNoDefaultLists",c[f].xmlNoDefaultLists,!1),p(this,"className",function(){var t=e.metadata.serviceAbbreviation||e.metadata.serviceFullName;return t?(t=t.replace(/^Amazon|AWS\s*|\(.*|\s+|\W+/g,""),"ElasticLoadBalancing"===t&&(t="ELB"),t):null}),h(this,"operations",new i(e.operations,t,function(e,r){return new o(e,r,t)},l.string.lowerFirst,r)),h(this,"shapes",new i(e.shapes,t,function(e,r){return s.create(r,t)})),h(this,"paginators",new i(e.paginators,t,function(e,r){return new a(e,r,t)})),h(this,"waiters",new i(e.waiters,t,function(e,r){return new u(e,r,t)},l.string.lowerFirst)),t.documentation&&(h(this,"documentation",e.documentation),h(this,"documentationUrl",e.documentationUrl))}var i=e("./collection"),o=e("./operation"),s=e("./shape"),a=e("./paginator"),u=e("./resource_waiter"),c=e("../../apis/metadata.json"),l=e("../util"),h=l.property,p=l.memoizedProperty;t.exports=n},{"../../apis/metadata.json":26,"../util":118,"./collection":66,"./operation":67,"./paginator":68,"./resource_waiter":69,"./shape":70}],69:[function(e,t,r){function n(e,t,r){r=r||{},o(this,"name",e),o(this,"api",r.api,!1),t.operation&&o(this,"operation",i.string.lowerFirst(t.operation));var n=this;["type","description","delay","maxAttempts","acceptors"].forEach(function(e){var r=t[e];r&&o(n,e,r)})}var i=e("../util"),o=i.property;t.exports=n},{"../util":118}],68:[function(e,t,r){function n(e,t){i(this,"inputToken",t.input_token),i(this,"limitKey",t.limit_key),i(this,"moreResults",t.more_results),i(this,"outputToken",t.output_token),i(this,"resultKey",t.result_key)}var i=e("../util").property;t.exports=n},{"../util":118}],67:[function(e,t,r){function n(e,t,r){var n=this;r=r||{},a(this,"name",t.name||e),a(this,"api",r.api,!1),t.http=t.http||{},a(this,"endpoint",t.endpoint),a(this,"httpMethod",t.http.method||"POST"),a(this,"httpPath",t.http.requestUri||"/"),a(this,"authtype",t.authtype||""),a(this,"endpointDiscoveryRequired",t.endpointdiscovery?t.endpointdiscovery.required?"REQUIRED":"OPTIONAL":"NULL"),u(this,"input",function(){return t.input?o.create(t.input,r):new o.create({type:"structure"},r)}),u(this,"output",function(){return t.output?o.create(t.output,r):new o.create({type:"structure"},r)}),u(this,"errors",function(){var e=[];if(!t.errors)return null;for(var n=0;n<t.errors.length;n++)e.push(o.create(t.errors[n],r));return e}),u(this,"paginator",function(){return r.api.paginators[e]}),r.documentation&&(a(this,"documentation",t.documentation),a(this,"documentationUrl",t.documentationUrl)),u(this,"idempotentMembers",function(){var e=[],t=n.input,r=t.members;if(!t.members)return e;for(var i in r)r.hasOwnProperty(i)&&!0===r[i].isIdempotent&&e.push(i);return e}),u(this,"hasEventOutput",function(){return i(n.output)})}function i(e){var t=e.members,r=e.payload;if(!e.members)return!1;if(r){return t[r].isEventStream}for(var n in t)if(!t.hasOwnProperty(n)&&!0===t[n].isEventStream)return!0;return!1}var o=e("./shape"),s=e("../util"),a=s.property,u=s.memoizedProperty;t.exports=n},{"../util":118,"./shape":70}],61:[function(e,t,r){var n=e("./core"),i=n.util.inherit;n.Endpoint=i({constructor:function(e,t){if(n.util.hideProperties(this,["slashes","auth","hash","search","query"]),void 0===e||null===e)throw new Error("Invalid endpoint: "+e);if("string"!=typeof e)return n.util.copy(e);if(!e.match(/^http/)){e=((t&&void 0!==t.sslEnabled?t.sslEnabled:n.config.sslEnabled)?"https":"http")+"://"+e}n.util.update(this,n.util.urlParse(e)),this.port?this.port=parseInt(this.port,10):this.port="https:"===this.protocol?443:80}}),n.HttpRequest=i({constructor:function(e,t){e=new n.Endpoint(e),this.method="POST",this.path=e.path||"/",this.headers={},this.body="",this.endpoint=e,this.region=t,this._userAgent="",this.setUserAgent()},setUserAgent:function(){this._userAgent=this.headers[this.getUserAgentHeaderName()]=n.util.userAgent()},getUserAgentHeaderName:function(){return(n.util.isBrowser()?"X-Amz-":"")+"User-Agent"},appendToUserAgent:function(e){"string"==typeof e&&e&&(this._userAgent+=" "+e),this.headers[this.getUserAgentHeaderName()]=this._userAgent},getUserAgent:function(){return this._userAgent},pathname:function(){return this.path.split("?",1)[0]},search:function(){var e=this.path.split("?",2)[1];return e?(e=n.util.queryStringParse(e),n.util.queryParamsToString(e)):""},updateEndpoint:function(e){var t=new n.Endpoint(e);this.endpoint=t,this.path=t.path||"/",this.headers.Host&&(this.headers.Host=t.host)}}),n.HttpResponse=i({constructor:function(){this.statusCode=void 0,this.headers={},this.body=void 0,this.streaming=!1,this.stream=null},createUnbufferedStream:function(){return this.streaming=!0,this.stream}}),n.HttpClient=i({}),n.HttpClient.getInstance=function(){return void 0===this.singleton&&(this.singleton=new this),this.singleton}},{"./core":39}],60:[function(e,t,r){function n(e){if(!e.service.api.operations)return"";var t=e.service.api.operations[e.operation];return t?t.authtype:""}var i=e("./core"),o=e("./sequential_executor"),s=e("./discover_endpoint").discoverEndpoint;i.EventListeners={Core:{}},i.EventListeners={Core:(new o).addNamedListeners(function(e,t){t("VALIDATE_CREDENTIALS","validate",function(e,t){if(!e.service.api.signatureVersion&&!e.service.config.signatureVersion)return t();e.service.config.getCredentials(function(r){r&&(e.response.error=i.util.error(r,{code:"CredentialsError",message:"Missing credentials in config, if using AWS_CONFIG_FILE, set AWS_SDK_LOAD_CONFIG=1"})),t()})}),e("VALIDATE_REGION","validate",function(e){e.service.config.region||e.service.isGlobalEndpoint||(e.response.error=i.util.error(new Error,{code:"ConfigError",message:"Missing region in config"}))}),e("BUILD_IDEMPOTENCY_TOKENS","validate",function(e){if(e.service.api.operations){var t=e.service.api.operations[e.operation];if(t){var r=t.idempotentMembers;if(r.length){for(var n=i.util.copy(e.params),o=0,s=r.length;o<s;o++)n[r[o]]||(n[r[o]]=i.util.uuid.v4());e.params=n}}}}),e("VALIDATE_PARAMETERS","validate",function(e){if(e.service.api.operations){var t=e.service.api.operations[e.operation].input,r=e.service.config.paramValidation;new i.ParamValidator(r).validate(t,e.params)}}),t("COMPUTE_SHA256","afterBuild",function(e,t){if(e.haltHandlersOnError(),e.service.api.operations){var r=e.service.api.operations[e.operation],n=r?r.authtype:"";if(!e.service.api.signatureVersion&&!n&&!e.service.config.signatureVersion)return t();if(e.service.getSignerClass(e)===i.Signers.V4){var o=e.httpRequest.body||"";if(n.indexOf("unsigned-body")>=0)return e.httpRequest.headers["X-Amz-Content-Sha256"]="UNSIGNED-PAYLOAD",t();i.util.computeSha256(o,function(r,n){r?t(r):(e.httpRequest.headers["X-Amz-Content-Sha256"]=n,t())})}else t()}}),e("SET_CONTENT_LENGTH","afterBuild",function(e){var t=n(e),r=i.util.getRequestPayloadShape(e);if(void 0===e.httpRequest.headers["Content-Length"])try{var o=i.util.string.byteLength(e.httpRequest.body);e.httpRequest.headers["Content-Length"]=o}catch(n){if(r&&r.isStreaming){if(r.requiresLength)throw n;if(t.indexOf("unsigned-body")>=0)return void(e.httpRequest.headers["Transfer-Encoding"]="chunked");throw n}throw n}}),e("SET_HTTP_HOST","afterBuild",function(e){e.httpRequest.headers.Host=e.httpRequest.endpoint.host}),e("RESTART","restart",function(){var e=this.response.error;e&&e.retryable&&(this.httpRequest=new i.HttpRequest(this.service.endpoint,this.service.region),this.response.retryCount<this.service.config.maxRetries?this.response.retryCount++:this.response.error=null)});t("DISCOVER_ENDPOINT","sign",s,!0),t("SIGN","sign",function(e,t){var r=e.service,n=e.service.api.operations||{},i=n[e.operation],o=i?i.authtype:"";if(!r.api.signatureVersion&&!o&&!r.config.signatureVersion)return t();r.config.getCredentials(function(n,o){if(n)return e.response.error=n,t();try{var s=r.getSkewCorrectedDate(),a=r.getSignerClass(e),u=new a(e.httpRequest,r.api.signingName||r.api.endpointPrefix,{signatureCache:r.config.signatureCache,operation:i,signatureVersion:r.api.signatureVersion});u.setServiceClientId(r._clientId),delete e.httpRequest.headers.Authorization,delete e.httpRequest.headers.Date,delete e.httpRequest.headers["X-Amz-Date"],u.addAuthorization(o,s),e.signedAt=s}catch(t){e.response.error=t}t()})}),e("VALIDATE_RESPONSE","validateResponse",function(e){this.service.successfulResponse(e,this)?(e.data={},e.error=null):(e.data=null,e.error=i.util.error(new Error,{code:"UnknownError",message:"An unknown error occurred."}))}),t("SEND","send",function(e,t){function r(r){e.httpResponse.stream=r;var n=e.request.httpRequest.stream,o=e.request.service,s=o.api,a=e.request.operation,u=s.operations[a]||{};r.on("headers",function(n,s,a){if(e.request.emit("httpHeaders",[n,s,e,a]),!e.httpResponse.streaming)if(2===i.HttpClient.streamsApiVersion){if(u.hasEventOutput&&o.successfulResponse(e))return e.request.emit("httpDone"),void t();r.on("readable",function(){var t=r.read();null!==t&&e.request.emit("httpData",[t,e])})}else r.on("data",function(t){e.request.emit("httpData",[t,e])})}),r.on("end",function(){if(!n||!n.didCallback){if(2===i.HttpClient.streamsApiVersion&&u.hasEventOutput&&o.successfulResponse(e))return;e.request.emit("httpDone"),t()}})}function n(t){t.on("sendProgress",function(t){e.request.emit("httpUploadProgress",[t,e])}),t.on("receiveProgress",function(t){e.request.emit("httpDownloadProgress",[t,e])})}function o(r){if("RequestAbortedError"!==r.code){var n="TimeoutError"===r.code?r.code:"NetworkingError";r=i.util.error(r,{code:n,region:e.request.httpRequest.region,hostname:e.request.httpRequest.endpoint.hostname,retryable:!0})}e.error=r,e.request.emit("httpError",[e.error,e],function(){t()})}function s(){var t=i.HttpClient.getInstance(),s=e.request.service.config.httpOptions||{};try{n(t.handleRequest(e.request.httpRequest,s,r,o))}catch(e){o(e)}}e.httpResponse._abortCallback=t,e.error=null,e.data=null,(e.request.service.getSkewCorrectedDate()-this.signedAt)/1e3>=600?this.emit("sign",[this],function(e){e?t(e):s()}):s()}),e("HTTP_HEADERS","httpHeaders",function(e,t,r,n){r.httpResponse.statusCode=e,r.httpResponse.statusMessage=n,r.httpResponse.headers=t,r.httpResponse.body=i.util.buffer.toBuffer(""),r.httpResponse.buffers=[],r.httpResponse.numBytes=0;var o=t.date||t.Date,s=r.request.service;if(o){var a=Date.parse(o);s.config.correctClockSkew&&s.isClockSkewed(a)&&s.applyClockOffset(a)}}),e("HTTP_DATA","httpData",function(e,t){if(e){if(i.util.isNode()){t.httpResponse.numBytes+=e.length;var r=t.httpResponse.headers["content-length"],n={loaded:t.httpResponse.numBytes,total:r};t.request.emit("httpDownloadProgress",[n,t])}t.httpResponse.buffers.push(i.util.buffer.toBuffer(e))}}),e("HTTP_DONE","httpDone",function(e){if(e.httpResponse.buffers&&e.httpResponse.buffers.length>0){var t=i.util.buffer.concat(e.httpResponse.buffers);e.httpResponse.body=t}delete e.httpResponse.numBytes,delete e.httpResponse.buffers}),e("FINALIZE_ERROR","retry",function(e){e.httpResponse.statusCode&&(e.error.statusCode=e.httpResponse.statusCode,void 0===e.error.retryable&&(e.error.retryable=this.service.retryableError(e.error,this)))}),e("INVALIDATE_CREDENTIALS","retry",function(e){if(e.error)switch(e.error.code){case"RequestExpired":case"ExpiredTokenException":case"ExpiredToken":e.error.retryable=!0,e.request.service.config.credentials.expired=!0}}),e("EXPIRED_SIGNATURE","retry",function(e){var t=e.error;t&&"string"==typeof t.code&&"string"==typeof t.message&&t.code.match(/Signature/)&&t.message.match(/expired/)&&(e.error.retryable=!0)}),e("CLOCK_SKEWED","retry",function(e){e.error&&this.service.clockSkewError(e.error)&&this.service.config.correctClockSkew&&(e.error.retryable=!0)}),e("REDIRECT","retry",function(e){e.error&&e.error.statusCode>=300&&e.error.statusCode<400&&e.httpResponse.headers.location&&(this.httpRequest.endpoint=new i.Endpoint(e.httpResponse.headers.location),this.httpRequest.headers.Host=this.httpRequest.endpoint.host,e.error.redirect=!0,e.error.retryable=!0)}),e("RETRY_CHECK","retry",function(e){e.error&&(e.error.redirect&&e.redirectCount<e.maxRedirects?e.error.retryDelay=0:e.retryCount<e.maxRetries&&(e.error.retryDelay=this.service.retryDelays(e.retryCount,e.error)||0))}),t("RESET_RETRY_STATE","afterRetry",function(e,t){var r,n=!1;e.error&&(r=e.error.retryDelay||0,
            e.error.retryable&&e.retryCount<e.maxRetries?(e.retryCount++,n=!0):e.error.redirect&&e.redirectCount<e.maxRedirects&&(e.redirectCount++,n=!0)),n&&r>=0?(e.error=null,setTimeout(t,r)):t()})}),CorePost:(new o).addNamedListeners(function(e){e("EXTRACT_REQUEST_ID","extractData",i.util.extractRequestId),e("EXTRACT_REQUEST_ID","extractError",i.util.extractRequestId),e("ENOTFOUND_ERROR","httpError",function(e){if("NetworkingError"===e.code&&"ENOTFOUND"===e.errno){var t="Inaccessible host: `"+e.hostname+"'. This service may not be available in the `"+e.region+"' region.";this.response.error=i.util.error(new Error(t),{code:"UnknownEndpoint",region:e.region,hostname:e.hostname,retryable:!0,originalError:e})}})}),Logger:(new o).addNamedListeners(function(t){t("LOG_REQUEST","complete",function(t){function r(e,t){if(!t)return t;switch(e.type){case"structure":var n={};return i.util.each(t,function(t,i){Object.prototype.hasOwnProperty.call(e.members,t)?n[t]=r(e.members[t],i):n[t]=i}),n;case"list":var o=[];return i.util.arrayEach(t,function(t,n){o.push(r(e.member,t))}),o;case"map":var s={};return i.util.each(t,function(t,n){s[t]=r(e.value,n)}),s;default:return e.isSensitive?"***SensitiveInformation***":t}}var n=t.request,o=n.service.config.logger;if(o){var s=function(){var s=t.request.service.getSkewCorrectedDate().getTime(),a=(s-n.startTime.getTime())/1e3,u=!!o.isTTY,c=t.httpResponse.statusCode,l=n.params;if(n.service.api.operations&&n.service.api.operations[n.operation]&&n.service.api.operations[n.operation].input){l=r(n.service.api.operations[n.operation].input,n.params)}var h=e("util").inspect(l,!0,null),p="";return u&&(p+="[33m"),p+="[AWS "+n.service.serviceIdentifier+" "+c,p+=" "+a.toString()+"s "+t.retryCount+" retries]",u&&(p+="[0;1m"),p+=" "+i.util.string.lowerFirst(n.operation),p+="("+h+")",u&&(p+="[0m"),p}();"function"==typeof o.log?o.log(s):"function"==typeof o.write&&o.write(s+"\n")}})}),Json:(new o).addNamedListeners(function(t){var r=e("./protocol/json");t("BUILD","build",r.buildRequest),t("EXTRACT_DATA","extractData",r.extractData),t("EXTRACT_ERROR","extractError",r.extractError)}),Rest:(new o).addNamedListeners(function(t){var r=e("./protocol/rest");t("BUILD","build",r.buildRequest),t("EXTRACT_DATA","extractData",r.extractData),t("EXTRACT_ERROR","extractError",r.extractError)}),RestJson:(new o).addNamedListeners(function(t){var r=e("./protocol/rest_json");t("BUILD","build",r.buildRequest),t("EXTRACT_DATA","extractData",r.extractData),t("EXTRACT_ERROR","extractError",r.extractError)}),RestXml:(new o).addNamedListeners(function(t){var r=e("./protocol/rest_xml");t("BUILD","build",r.buildRequest),t("EXTRACT_DATA","extractData",r.extractData),t("EXTRACT_ERROR","extractError",r.extractError)}),Query:(new o).addNamedListeners(function(t){var r=e("./protocol/query");t("BUILD","build",r.buildRequest),t("EXTRACT_DATA","extractData",r.extractData),t("EXTRACT_ERROR","extractError",r.extractError)})}},{"./core":39,"./discover_endpoint":47,"./protocol/json":74,"./protocol/query":75,"./protocol/rest":76,"./protocol/rest_json":77,"./protocol/rest_xml":78,"./sequential_executor":88,util:20}],88:[function(e,t,r){var n=e("./core");n.SequentialExecutor=n.util.inherit({constructor:function(){this._events={}},listeners:function(e){return this._events[e]?this._events[e].slice(0):[]},on:function(e,t,r){return this._events[e]?r?this._events[e].unshift(t):this._events[e].push(t):this._events[e]=[t],this},onAsync:function(e,t,r){return t._isAsync=!0,this.on(e,t,r)},removeListener:function(e,t){var r=this._events[e];if(r){for(var n=r.length,i=-1,o=0;o<n;++o)r[o]===t&&(i=o);i>-1&&r.splice(i,1)}return this},removeAllListeners:function(e){return e?delete this._events[e]:this._events={},this},emit:function(e,t,r){r||(r=function(){});var n=this.listeners(e),i=n.length;return this.callListeners(n,t,r),i>0},callListeners:function(e,t,r,i){function o(i){if(i&&(a=n.util.error(a||new Error,i),s._haltHandlersOnError))return r.call(s,a);s.callListeners(e,t,r,a)}for(var s=this,a=i||null;e.length>0;){var u=e.shift();if(u._isAsync)return void u.apply(s,t.concat([o]));try{u.apply(s,t)}catch(e){a=n.util.error(a||new Error,e)}if(a&&s._haltHandlersOnError)return void r.call(s,a)}r.call(s,a)},addListeners:function(e){var t=this;return e._events&&(e=e._events),n.util.each(e,function(e,r){"function"==typeof r&&(r=[r]),n.util.arrayEach(r,function(r){t.on(e,r)})}),t},addNamedListener:function(e,t,r,n){return this[e]=r,this.addListener(t,r,n),this},addNamedAsyncListener:function(e,t,r,n){return r._isAsync=!0,this.addNamedListener(e,t,r,n)},addNamedListeners:function(e){var t=this;return e(function(){t.addNamedListener.apply(t,arguments)},function(){t.addNamedAsyncListener.apply(t,arguments)}),this}}),n.SequentialExecutor.prototype.addListener=n.SequentialExecutor.prototype.on,t.exports=n.SequentialExecutor},{"./core":39}],78:[function(e,t,r){function n(e){var t=e.service.api.operations[e.operation].input,r=new a.XML.Builder,n=e.params,i=t.payload;if(i){var o=t.members[i];if(void 0===(n=n[i]))return;if("structure"===o.type){var s=o.name;e.httpRequest.body=r.toXML(n,o,s,!0)}else e.httpRequest.body=n}else e.httpRequest.body=r.toXML(n,t,t.name||t.shape||u.string.upperFirst(e.operation)+"Request")}function i(e){c.buildRequest(e),["GET","HEAD"].indexOf(e.httpRequest.method)<0&&n(e)}function o(e){c.extractError(e);var t;try{t=(new a.XML.Parser).parse(e.httpResponse.body.toString())}catch(r){t={Code:e.httpResponse.statusCode,Message:e.httpResponse.statusMessage}}t.Errors&&(t=t.Errors),t.Error&&(t=t.Error),t.Code?e.error=u.error(new Error,{code:t.Code,message:t.Message}):e.error=u.error(new Error,{code:e.httpResponse.statusCode,message:null})}function s(e){c.extractData(e);var t,r=e.request,n=e.httpResponse.body,i=r.service.api.operations[r.operation],o=i.output,s=(i.hasEventOutput,o.payload);if(s){var l=o.members[s];l.isEventStream?(t=new a.XML.Parser,e.data[s]=u.createEventStream(2===a.HttpClient.streamsApiVersion?e.httpResponse.stream:e.httpResponse.body,t,l)):"structure"===l.type?(t=new a.XML.Parser,e.data[s]=t.parse(n.toString(),l)):"binary"===l.type||l.isStreaming?e.data[s]=n:e.data[s]=l.toType(n)}else if(n.length>0){t=new a.XML.Parser;var h=t.parse(n.toString(),o);u.update(e.data,h)}}var a=e("../core"),u=e("../util"),c=e("./rest");t.exports={buildRequest:i,extractError:o,extractData:s}},{"../core":39,"../util":118,"./rest":76}],77:[function(e,t,r){function n(e){var t=new h,r=e.service.api.operations[e.operation].input;if(r.payload){var n={},o=r.members[r.payload];if(void 0===(n=e.params[r.payload]))return;"structure"===o.type?(e.httpRequest.body=t.build(n,o),i(e)):(e.httpRequest.body=n,("binary"===o.type||o.isStreaming)&&i(e,!0))}else{var s=t.build(e.params,r);"{}"===s&&"GET"===e.httpRequest.method||(e.httpRequest.body=s),i(e)}}function i(e,t){var r=e.service.api.operations[e.operation];r.input;if(!e.httpRequest.headers["Content-Type"]){var n=t?"binary/octet-stream":"application/json";e.httpRequest.headers["Content-Type"]=n}}function o(e){c.buildRequest(e),["HEAD","DELETE"].indexOf(e.httpRequest.method)<0&&n(e)}function s(e){l.extractError(e)}function a(e){c.extractData(e);var t,r=e.request,n=r.service.api.operations[r.operation],i=r.service.api.operations[r.operation].output||{};n.hasEventOutput;if(i.payload){var o=i.members[i.payload],s=e.httpResponse.body;if(o.isEventStream)t=new p,e.data[payload]=u.createEventStream(2===AWS.HttpClient.streamsApiVersion?e.httpResponse.stream:s,t,o);else if("structure"===o.type||"list"===o.type){var t=new p;e.data[i.payload]=t.parse(s,o)}else"binary"===o.type||o.isStreaming?e.data[i.payload]=s:e.data[i.payload]=o.toType(s)}else{var a=e.data;l.extractData(e),e.data=u.merge(a,e.data)}}var u=e("../util"),c=e("./rest"),l=e("./json"),h=e("../json/builder"),p=e("../json/parser");t.exports={buildRequest:o,extractError:s,extractData:a}},{"../json/builder":63,"../json/parser":64,"../util":118,"./json":74,"./rest":76}],76:[function(e,t,r){function n(e){e.httpRequest.method=e.service.api.operations[e.operation].httpMethod}function i(e,t,r,n){var i=[e,t].join("/");i=i.replace(/\/+/g,"/");var o={},s=!1;if(l.each(r.members,function(e,t){var r=n[e];if(null!==r&&void 0!==r)if("uri"===t.location){var a=new RegExp("\\{"+t.name+"(\\+)?\\}");i=i.replace(a,function(e,t){return(t?l.uriEscapePath:l.uriEscape)(String(r))})}else"querystring"===t.location&&(s=!0,"list"===t.type?o[t.name]=r.map(function(e){return l.uriEscape(t.member.toWireFormat(e).toString())}):"map"===t.type?l.each(r,function(e,t){Array.isArray(t)?o[e]=t.map(function(e){return l.uriEscape(String(e))}):o[e]=l.uriEscape(String(t))}):o[t.name]=l.uriEscape(t.toWireFormat(r).toString()))}),s){i+=i.indexOf("?")>=0?"&":"?";var a=[];l.arrayEach(Object.keys(o).sort(),function(e){Array.isArray(o[e])||(o[e]=[o[e]]);for(var t=0;t<o[e].length;t++)a.push(l.uriEscape(String(e))+"="+o[e][t])}),i+=a.join("&")}return i}function o(e){var t=e.service.api.operations[e.operation],r=t.input,n=i(e.httpRequest.endpoint.path,t.httpPath,r,e.params);e.httpRequest.path=n}function s(e){var t=e.service.api.operations[e.operation];l.each(t.input.members,function(t,r){var n=e.params[t];null!==n&&void 0!==n&&("headers"===r.location&&"map"===r.type?l.each(n,function(t,n){e.httpRequest.headers[r.name+t]=n}):"header"===r.location&&(n=r.toWireFormat(n).toString(),r.isJsonValue&&(n=l.base64.encode(n)),e.httpRequest.headers[r.name]=n))})}function a(e){n(e),o(e),s(e),h(e)}function u(){}function c(e){var t=e.request,r={},n=e.httpResponse,i=t.service.api.operations[t.operation],o=i.output,s={};l.each(n.headers,function(e,t){s[e.toLowerCase()]=t}),l.each(o.members,function(e,t){var i=(t.name||e).toLowerCase();if("headers"===t.location&&"map"===t.type){r[e]={};var o=t.isLocationName?t.name:"",a=new RegExp("^"+o+"(.+)","i");l.each(n.headers,function(t,n){var i=t.match(a);null!==i&&(r[e][i[1]]=n)})}else if("header"===t.location){if(void 0!==s[i]){var u=t.isJsonValue?l.base64.decode(s[i]):s[i];r[e]=t.toType(u)}}else"statusCode"===t.location&&(r[e]=parseInt(n.statusCode,10))}),e.data=r}var l=e("../util"),h=e("./helpers").populateHostPrefix;t.exports={buildRequest:a,extractError:u,extractData:c,generateURI:i}},{"../util":118,"./helpers":73}],75:[function(e,t,r){function n(e){var t=e.service.api.operations[e.operation],r=e.httpRequest;r.headers["Content-Type"]="application/x-www-form-urlencoded; charset=utf-8",r.params={Version:e.service.api.apiVersion,Action:t.name},(new u).serialize(e.params,t.input,function(e,t){r.params[e]=t}),r.body=a.queryParamsToString(r.params),l(e)}function i(e){var t,r=e.httpResponse.body.toString();if(r.match("<UnknownOperationException"))t={Code:"UnknownOperation",Message:"Unknown operation "+e.request.operation};else try{t=(new s.XML.Parser).parse(r)}catch(r){t={Code:e.httpResponse.statusCode,Message:e.httpResponse.statusMessage}}t.requestId&&!e.requestId&&(e.requestId=t.requestId),t.Errors&&(t=t.Errors),t.Error&&(t=t.Error),t.Code?e.error=a.error(new Error,{code:t.Code,message:t.Message}):e.error=a.error(new Error,{code:e.httpResponse.statusCode,message:null})}function o(e){var t=e.request,r=t.service.api.operations[t.operation],n=r.output||{},i=n;if(i.resultWrapper){var o=c.create({type:"structure"});o.members[i.resultWrapper]=n,o.memberNames=[i.resultWrapper],a.property(n,"name",n.resultWrapper),n=o}var u=new s.XML.Parser;if(n&&n.members&&!n.members._XAMZRequestId){var l=c.create({type:"string"},{api:{protocol:"query"}},"requestId");n.members._XAMZRequestId=l}var h=u.parse(e.httpResponse.body.toString(),n);e.requestId=h._XAMZRequestId||h.requestId,h._XAMZRequestId&&delete h._XAMZRequestId,i.resultWrapper&&h[i.resultWrapper]&&(a.update(h,h[i.resultWrapper]),delete h[i.resultWrapper]),e.data=h}var s=e("../core"),a=e("../util"),u=e("../query/query_param_serializer"),c=e("../model/shape"),l=e("./helpers").populateHostPrefix;t.exports={buildRequest:n,extractError:i,extractData:o}},{"../core":39,"../model/shape":70,"../query/query_param_serializer":79,"../util":118,"./helpers":73}],79:[function(e,t,r){function n(){}function i(e){return e.isQueryName||"ec2"!==e.api.protocol?e.name:e.name[0].toUpperCase()+e.name.substr(1)}function o(e,t,r,n){c.each(r.members,function(r,o){var s=t[r];if(null!==s&&void 0!==s){var a=i(o);a=e?e+"."+a:a,u(a,s,o,n)}})}function s(e,t,r,n){var i=1;c.each(t,function(t,o){var s=r.flattened?".":".entry.",a=s+i+++".",c=a+(r.key.name||"key"),l=a+(r.value.name||"value");u(e+c,t,r.key,n),u(e+l,o,r.value,n)})}function a(e,t,r,n){var o=r.member||{};if(0===t.length)return void n.call(this,e,null);c.arrayEach(t,function(t,s){var a="."+(s+1);if("ec2"===r.api.protocol)a+="";else if(r.flattened){if(o.name){var c=e.split(".");c.pop(),c.push(i(o)),e=c.join(".")}}else a="."+(o.name?o.name:"member")+a;u(e+a,t,o,n)})}function u(e,t,r,n){null!==t&&void 0!==t&&("structure"===r.type?o(e,t,r,n):"list"===r.type?a(e,t,r,n):"map"===r.type?s(e,t,r,n):n(e,r.toWireFormat(t).toString()))}var c=e("../util");n.prototype.serialize=function(e,t,r){o("",e,t,r)},t.exports=n},{"../util":118}],70:[function(e,t,r){function n(e,t,r){null!==r&&void 0!==r&&y.property.apply(this,arguments)}function i(e,t){e.constructor.prototype[t]||y.memoizedProperty.apply(this,arguments)}function o(e,t,r){t=t||{},n(this,"shape",e.shape),n(this,"api",t.api,!1),n(this,"type",e.type),n(this,"enum",e.enum),n(this,"min",e.min),n(this,"max",e.max),n(this,"pattern",e.pattern),n(this,"location",e.location||this.location||"body"),n(this,"name",this.name||e.xmlName||e.queryName||e.locationName||r),n(this,"isStreaming",e.streaming||this.isStreaming||!1),n(this,"requiresLength",e.requiresLength,!1),n(this,"isComposite",e.isComposite||!1),n(this,"isShape",!0,!1),n(this,"isQueryName",Boolean(e.queryName),!1),n(this,"isLocationName",Boolean(e.locationName),!1),n(this,"isIdempotent",!0===e.idempotencyToken),n(this,"isJsonValue",!0===e.jsonvalue),n(this,"isSensitive",!0===e.sensitive||e.prototype&&!0===e.prototype.sensitive),n(this,"isEventStream",Boolean(e.eventstream),!1),n(this,"isEvent",Boolean(e.event),!1),n(this,"isEventPayload",Boolean(e.eventpayload),!1),n(this,"isEventHeader",Boolean(e.eventheader),!1),n(this,"isTimestampFormatSet",Boolean(e.timestampFormat)||e.prototype&&!0===e.prototype.isTimestampFormatSet,!1),n(this,"endpointDiscoveryId",Boolean(e.endpointdiscoveryid),!1),n(this,"hostLabel",Boolean(e.hostLabel),!1),t.documentation&&(n(this,"documentation",e.documentation),n(this,"documentationUrl",e.documentationUrl)),e.xmlAttribute&&n(this,"isXmlAttribute",e.xmlAttribute||!1),n(this,"defaultValue",null),this.toWireFormat=function(e){return null===e||void 0===e?"":e},this.toType=function(e){return e}}function s(e){o.apply(this,arguments),n(this,"isComposite",!0),e.flattened&&n(this,"flattened",e.flattened||!1)}function a(e,t){var r=this,a=null,u=!this.isShape;s.apply(this,arguments),u&&(n(this,"defaultValue",function(){return{}}),n(this,"members",{}),n(this,"memberNames",[]),n(this,"required",[]),n(this,"isRequired",function(){return!1})),e.members&&(n(this,"members",new g(e.members,t,function(e,r){return o.create(r,t,e)})),i(this,"memberNames",function(){return e.xmlOrder||Object.keys(e.members)}),e.event&&(i(this,"eventPayloadMemberName",function(){for(var e=r.members,t=r.memberNames,n=0,i=t.length;n<i;n++)if(e[t[n]].isEventPayload)return t[n]}),i(this,"eventHeaderMemberNames",function(){for(var e=r.members,t=r.memberNames,n=[],i=0,o=t.length;i<o;i++)e[t[i]].isEventHeader&&n.push(t[i]);return n}))),e.required&&(n(this,"required",e.required),n(this,"isRequired",function(t){if(!a){a={};for(var r=0;r<e.required.length;r++)a[e.required[r]]=!0}return a[t]},!1,!0)),n(this,"resultWrapper",e.resultWrapper||null),e.payload&&n(this,"payload",e.payload),"string"==typeof e.xmlNamespace?n(this,"xmlNamespaceUri",e.xmlNamespace):"object"==typeof e.xmlNamespace&&(n(this,"xmlNamespacePrefix",e.xmlNamespace.prefix),n(this,"xmlNamespaceUri",e.xmlNamespace.uri))}function u(e,t){var r=this,a=!this.isShape;if(s.apply(this,arguments),a&&n(this,"defaultValue",function(){return[]}),e.member&&i(this,"member",function(){return o.create(e.member,t)}),this.flattened){var u=this.name;i(this,"name",function(){return r.member.name||u})}}function c(e,t){var r=!this.isShape;s.apply(this,arguments),r&&(n(this,"defaultValue",function(){return{}}),n(this,"key",o.create({type:"string"},t)),n(this,"value",o.create({type:"string"},t))),e.key&&i(this,"key",function(){return o.create(e.key,t)}),e.value&&i(this,"value",function(){return o.create(e.value,t)})}function l(e){var t=this;if(o.apply(this,arguments),e.timestampFormat)n(this,"timestampFormat",e.timestampFormat);else if(t.isTimestampFormatSet&&this.timestampFormat)n(this,"timestampFormat",this.timestampFormat);else if("header"===this.location)n(this,"timestampFormat","rfc822");else if("querystring"===this.location)n(this,"timestampFormat","iso8601");else if(this.api)switch(this.api.protocol){case"json":case"rest-json":n(this,"timestampFormat","unixTimestamp");break;case"rest-xml":case"query":case"ec2":n(this,"timestampFormat","iso8601")}this.toType=function(e){return null===e||void 0===e?null:"function"==typeof e.toUTCString?e:"string"==typeof e||"number"==typeof e?y.date.parseTimestamp(e):null},this.toWireFormat=function(e){return y.date.format(e,t.timestampFormat)}}function h(){o.apply(this,arguments);var e=["rest-xml","query","ec2"];this.toType=function(t){return t=this.api&&e.indexOf(this.api.protocol)>-1?t||"":t,this.isJsonValue?JSON.parse(t):t&&"function"==typeof t.toString?t.toString():t},this.toWireFormat=function(e){return this.isJsonValue?JSON.stringify(e):e}}function p(){o.apply(this,arguments),this.toType=function(e){return null===e||void 0===e?null:parseFloat(e)},this.toWireFormat=this.toType}function f(){o.apply(this,arguments),this.toType=function(e){return null===e||void 0===e?null:parseInt(e,10)},this.toWireFormat=this.toType}function d(){o.apply(this,arguments),this.toType=function(e){var t=y.base64.decode(e);if(this.isSensitive&&y.isNode()&&"function"==typeof y.Buffer.alloc){var r=y.Buffer.alloc(t.length,t);t.fill(0),t=r}return t},this.toWireFormat=y.base64.encode}function m(){d.apply(this,arguments)}function v(){o.apply(this,arguments),this.toType=function(e){return"boolean"==typeof e?e:null===e||void 0===e?null:"true"===e}}var g=e("./collection"),y=e("../util");o.normalizedTypes={character:"string",double:"float",long:"integer",short:"integer",biginteger:"integer",bigdecimal:"float",blob:"binary"},o.types={structure:a,list:u,map:c,boolean:v,timestamp:l,float:p,integer:f,string:h,base64:m,binary:d},o.resolve=function(e,t){if(e.shape){var r=t.api.shapes[e.shape];if(!r)throw new Error("Cannot find shape reference: "+e.shape);return r}return null},o.create=function(e,t,r){if(e.isShape)return e;var n=o.resolve(e,t);if(n){var i=Object.keys(e);t.documentation||(i=i.filter(function(e){return!e.match(/documentation/)}));var s=function(){n.constructor.call(this,e,t,r)};return s.prototype=n,new s}e.type||(e.members?e.type="structure":e.member?e.type="list":e.key?e.type="map":e.type="string");var a=e.type;if(o.normalizedTypes[e.type]&&(e.type=o.normalizedTypes[e.type]),o.types[e.type])return new o.types[e.type](e,t,r);throw new Error("Unrecognized shape type: "+a)},o.shapes={StructureShape:a,ListShape:u,MapShape:c,StringShape:h,BooleanShape:v,Base64Shape:m},t.exports=o},{"../util":118,"./collection":66}],66:[function(e,t,r){function n(e,t,r,n){o(this,n(e),function(){return r(e,t)})}function i(e,t,r,i,o){i=i||String;var s=this;for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n.call(s,a,e[a],r,i),o&&o(a,e[a]))}var o=e("../util").memoizedProperty;t.exports=i},{"../util":118}],74:[function(e,t,r){function n(e){var t=e.httpRequest,r=e.service.api,n=r.targetPrefix+"."+r.operations[e.operation].name,i=r.jsonVersion||"1.0",o=r.operations[e.operation].input,s=new a;1===i&&(i="1.0"),t.body=s.build(e.params||{},o),t.headers["Content-Type"]="application/x-amz-json-"+i,t.headers["X-Amz-Target"]=n,c(e)}function i(e){var t={},r=e.httpResponse;if(t.code=r.headers["x-amzn-errortype"]||"UnknownError","string"==typeof t.code&&(t.code=t.code.split(":")[0]),r.body.length>0)try{var n=JSON.parse(r.body.toString());(n.__type||n.code)&&(t.code=(n.__type||n.code).split("#").pop()),"RequestEntityTooLarge"===t.code?t.message="Request body must be less than 1 MB":t.message=n.message||n.Message||null}catch(n){t.statusCode=r.statusCode,t.message=r.statusMessage}else t.statusCode=r.statusCode,t.message=r.statusCode.toString();e.error=s.error(new Error,t)}function o(e){var t=e.httpResponse.body.toString()||"{}";if(!1===e.request.service.config.convertResponseTypes)e.data=JSON.parse(t);else{var r=e.request.service.api.operations[e.request.operation],n=r.output||{},i=new u;e.data=i.parse(t,n)}}var s=e("../util"),a=e("../json/builder"),u=e("../json/parser"),c=e("./helpers").populateHostPrefix;t.exports={buildRequest:n,extractError:i,extractData:o}},{"../json/builder":63,"../json/parser":64,"../util":118,"./helpers":73}],73:[function(e,t,r){function n(e){if(!e.service.config.hostPrefixEnabled)return e;var t=e.service.api.operations[e.operation];if(i(e))return e;if(t.endpoint&&t.endpoint.hostPrefix){var r=t.endpoint.hostPrefix,n=o(r,e.params,t.input);s(e.httpRequest.endpoint,n),a(e.httpRequest.endpoint.hostname)}return e}function i(e){var t=e.service.api,r=t.operations[e.operation],n=t.endpointOperation&&t.endpointOperation===u.string.lowerFirst(r.name);return"NULL"!==r.endpointDiscoveryRequired||!0===n}function o(e,t,r){return u.each(r.members,function(r,n){if(!0===n.hostLabel){if("string"!=typeof t[r]||""===t[r])throw u.error(new Error,{message:"Parameter "+r+" should be a non-empty string.",code:"InvalidParameter"});var i=new RegExp("\\{"+r+"\\}","g");e=e.replace(i,t[r])}}),e}function s(e,t){e.host&&(e.host=t+e.host),e.hostname&&(e.hostname=t+e.hostname)}function a(e){var t=e.split("."),r=/^[a-zA-Z0-9]{1}$|^[a-zA-Z0-9][a-zA-Z0-9\-]*[a-zA-Z0-9]$/;u.arrayEach(t,function(e){if(!e.length||e.length<1||e.length>63)throw u.error(new Error,{code:"ValidationError",message:"Hostname label length should be between 1 to 63 characters, inclusive."});if(!r.test(e))throw c.util.error(new Error,{code:"ValidationError",message:e+" is not hostname compatible."})})}var u=e("../util"),c=e("../core");t.exports={populateHostPrefix:n}},{"../core":39,"../util":118}],64:[function(e,t,r){function n(){}function i(e,t){if(t&&void 0!==e)switch(t.type){case"structure":return o(e,t);case"map":return a(e,t);case"list":return s(e,t);default:return u(e,t)}}function o(e,t){if(null!=e){var r={},n=t.members;return c.each(n,function(t,n){var o=n.isLocationName?n.name:t;if(Object.prototype.hasOwnProperty.call(e,o)){var s=e[o],a=i(s,n);void 0!==a&&(r[t]=a)}}),r}}function s(e,t){if(null!=e){var r=[];return c.arrayEach(e,function(e){var n=i(e,t.member);void 0===n?r.push(null):r.push(n)}),r}}function a(e,t){if(null!=e){var r={};return c.each(e,function(e,n){var o=i(n,t.value);r[e]=void 0===o?null:o}),r}}function u(e,t){return t.toType(e)}var c=e("../util");n.prototype.parse=function(e,t){return i(JSON.parse(e),t)},t.exports=n},{"../util":118}],63:[function(e,t,r){function n(){}function i(e,t){if(t&&void 0!==e&&null!==e)switch(t.type){case"structure":return o(e,t);case"map":return a(e,t);case"list":return s(e,t);default:return u(e,t)}}function o(e,t){var r={};return c.each(e,function(e,n){var o=t.members[e];if(o){if("body"!==o.location)return;var s=o.isLocationName?o.name:e,a=i(n,o);void 0!==a&&(r[s]=a)}}),r}function s(e,t){var r=[];return c.arrayEach(e,function(e){var n=i(e,t.member);void 0!==n&&r.push(n)}),r}function a(e,t){var r={};return c.each(e,function(e,n){var o=i(n,t.value);void 0!==o&&(r[e]=o)}),r}function u(e,t){return t.toWireFormat(e)}var c=e("../util");n.prototype.build=function(e,t){return JSON.stringify(i(e,t))},t.exports=n},{"../util":118}],47:[function(e,t,r){(function(r){function n(e){var t=e.service,r=t.api||{},n={};return t.config.region&&(n.region=t.config.region),r.serviceId&&(n.serviceId=r.serviceId),t.config.credentials.accessKeyId&&(n.accessKeyId=t.config.credentials.accessKeyId),n}function i(e,t,r){r&&void 0!==t&&null!==t&&"structure"===r.type&&r.required&&r.required.length>0&&m.arrayEach(r.required,function(n){var o=r.members[n];if(!0===o.endpointDiscoveryId){var s=o.isLocationName?o.name:n;e[s]=String(t[n])}else i(e,t[n],o)})}function o(e,t){var r={};return i(r,e.params,t),r}function s(e){var t=e.service,r=t.api,i=r.operations?r.operations[e.operation]:void 0,s=i?i.input:void 0,a=o(e,s),c=n(e);Object.keys(a).length>0&&(c=m.update(c,a),i&&(c.operation=i.name));var l=d.endpointCache.get(c);if(!l||1!==l.length||""!==l[0].Address)if(l&&l.length>0)e.httpRequest.updateEndpoint(l[0].Address);else{var h=t.makeRequest(r.endpointOperation,{Operation:i.name,Identifiers:a});u(h),h.removeListener("validate",d.EventListeners.Core.VALIDATE_PARAMETERS),h.removeListener("retry",d.EventListeners.Core.RETRY_CHECK),d.endpointCache.put(c,[{Address:"",CachePeriodInMinutes:1}]),h.send(function(e,t){t&&t.Endpoints?d.endpointCache.put(c,t.Endpoints):e&&d.endpointCache.put(c,[{Address:"",CachePeriodInMinutes:1}])})}}function a(e,t){var r=e.service,i=r.api,s=i.operations?i.operations[e.operation]:void 0,a=s?s.input:void 0,c=o(e,a),l=n(e);Object.keys(c).length>0&&(l=m.update(l,c),s&&(l.operation=s.name));var h=d.EndpointCache.getKeyString(l),p=d.endpointCache.get(h);if(p&&1===p.length&&""===p[0].Address)return g[h]||(g[h]=[]),void g[h].push({request:e,callback:t});if(p&&p.length>0)e.httpRequest.updateEndpoint(p[0].Address),t();else{var f=r.makeRequest(i.endpointOperation,{Operation:s.name,Identifiers:c});f.removeListener("validate",d.EventListeners.Core.VALIDATE_PARAMETERS),u(f),d.endpointCache.put(h,[{Address:"",CachePeriodInMinutes:60}]),f.send(function(r,n){if(r){var i={code:"EndpointDiscoveryException",message:"Request cannot be fulfilled without specifying an endpoint",retryable:!1};if(e.response.error=m.error(r,i),d.endpointCache.remove(l),g[h]){var o=g[h];m.arrayEach(o,function(e){e.request.response.error=m.error(r,i),e.callback()}),delete g[h]}}else if(n&&(d.endpointCache.put(h,n.Endpoints),e.httpRequest.updateEndpoint(n.Endpoints[0].Address),g[h])){var o=g[h];m.arrayEach(o,function(e){e.request.httpRequest.updateEndpoint(n.Endpoints[0].Address),e.callback()}),delete g[h]}t()})}}function u(e){var t=e.service.api,r=t.apiVersion;r&&!e.httpRequest.headers["x-amz-api-version"]&&(e.httpRequest.headers["x-amz-api-version"]=r)}function c(e){var t=e.error,r=e.httpResponse;if(t&&("InvalidEndpointException"===t.code||421===r.statusCode)){var i=e.request,s=i.service.api.operations||{},a=s[i.operation]?s[i.operation].input:void 0,u=o(i,a),c=n(i);Object.keys(u).length>0&&(c=m.update(c,u),s[i.operation]&&(c.operation=s[i.operation].name)),d.endpointCache.remove(c)}}function l(e){if(e._originalConfig&&e._originalConfig.endpoint&&!0===e._originalConfig.endpointDiscoveryEnabled)throw m.error(new Error,{code:"ConfigurationException",message:"Custom endpoint is supplied; endpointDiscoveryEnabled must not be true."});var t=d.config[e.serviceIdentifier]||{};return Boolean(d.config.endpoint||t.endpoint||e._originalConfig&&e._originalConfig.endpoint)}function h(e){return["false","0"].indexOf(e)>=0}function p(e){if(!0===(e.service||{}).config.endpointDiscoveryEnabled)return!0;if(m.isBrowser())return!1;for(var t=0;t<v.length;t++){var n=v[t];if(Object.prototype.hasOwnProperty.call(r.env,n)){if(""===r.env[n]||void 0===r.env[n])throw m.error(new Error,{code:"ConfigurationException",message:"environmental variable "+n+" cannot be set to nothing"});if(!h(r.env[n]))return!0}}var i={};try{i=d.util.iniLoader?d.util.iniLoader.loadFrom({isConfig:!0,filename:r.env[d.util.sharedConfigFileEnv]}):{}}catch(e){}var o=i[r.env.AWS_PROFILE||d.util.defaultProfile]||{};if(Object.prototype.hasOwnProperty.call(o,"endpoint_discovery_enabled")){if(void 0===o.endpoint_discovery_enabled)throw m.error(new Error,{code:"ConfigurationException",message:"config file entry 'endpoint_discovery_enabled' cannot be set to nothing"});if(!h(o.endpoint_discovery_enabled))return!0}return!1}function f(e,t){var r=e.service||{};if(l(r)||e.isPresigned())return t();var n=r.api.operations||{},i=n[e.operation],o=i?i.endpointDiscoveryRequired:"NULL";if(!p(e)){if("REQUIRED"===o)throw m.error(new Error,{code:"ConfigurationException",message:"Endpoint Discovery is not enabled but this operation requires it."});return t()}switch(e.httpRequest.appendToUserAgent("endpoint-discovery"),o){case"OPTIONAL":s(e),e.addNamedListener("INVALIDATE_CACHED_ENDPOINTS","extractError",c),t();break;case"REQUIRED":e.addNamedListener("INVALIDATE_CACHED_ENDPOINTS","extractError",c),a(e,t);break;case"NULL":default:t()}}var d=e("./core"),m=e("./util"),v=["AWS_ENABLE_ENDPOINT_DISCOVERY","AWS_ENDPOINT_DISCOVERY_ENABLED"],g={};t.exports={discoverEndpoint:f,requiredDiscoverEndpoint:a,optionalDiscoverEndpoint:s,marshallCustomIdentifiers:o,getCacheKey:n,invalidateCachedEndpoint:c}}).call(this,e("_process"))},{"./core":39,"./util":118,_process:8}],118:[function(e,t,r){(function(r,n){var i,o={environment:"nodejs",engine:function(){if(o.isBrowser()&&"undefined"!=typeof navigator)return navigator.userAgent;var e=r.platform+"/"+r.version;return r.env.AWS_EXECUTION_ENV&&(e+=" exec-env/"+r.env.AWS_EXECUTION_ENV),e},userAgent:function(){var t=o.environment,r="aws-sdk-"+t+"/"+e("./core").VERSION;return"nodejs"===t&&(r+=" "+o.engine()),r},uriEscape:function(e){var t=encodeURIComponent(e);return t=t.replace(/[^A-Za-z0-9_.~\-%]+/g,escape),t=t.replace(/[*]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})},uriEscapePath:function(e){var t=[];return o.arrayEach(e.split("/"),function(e){t.push(o.uriEscape(e))}),t.join("/")},urlParse:function(e){return o.url.parse(e)},urlFormat:function(e){return o.url.format(e)},queryStringParse:function(e){return o.querystring.parse(e)},queryParamsToString:function(e){var t=[],r=o.uriEscape,n=Object.keys(e).sort();return o.arrayEach(n,function(n){var i=e[n],s=r(n),a=s+"=";if(Array.isArray(i)){var u=[];o.arrayEach(i,function(e){u.push(r(e))}),a=s+"="+u.sort().join("&"+s+"=")}else void 0!==i&&null!==i&&(a=s+"="+r(i));t.push(a)}),t.join("&")},readFileSync:function(t){return o.isBrowser()?null:e("fs").readFileSync(t,"utf-8")},base64:{encode:function(e){if("number"==typeof e)throw o.error(new Error("Cannot base64 encode number "+e));return null===e||void 0===e?e:o.buffer.toBuffer(e).toString("base64")},decode:function(e){if("number"==typeof e)throw o.error(new Error("Cannot base64 decode number "+e));return null===e||void 0===e?e:o.buffer.toBuffer(e,"base64")}},buffer:{toBuffer:function(e,t){return"function"==typeof o.Buffer.from&&o.Buffer.from!==Uint8Array.from?o.Buffer.from(e,t):new o.Buffer(e,t)},alloc:function(e,t,r){if("number"!=typeof e)throw new Error("size passed to alloc must be a number.");if("function"==typeof o.Buffer.alloc)return o.Buffer.alloc(e,t,r);var n=new o.Buffer(e);return void 0!==t&&"function"==typeof n.fill&&n.fill(t,void 0,void 0,r),n},toStream:function(e){o.Buffer.isBuffer(e)||(e=o.buffer.toBuffer(e));var t=new o.stream.Readable,r=0;return t._read=function(n){if(r>=e.length)return t.push(null);var i=r+n;i>e.length&&(i=e.length),t.push(e.slice(r,i)),r=i},t},concat:function(e){var t,r=0,n=0,i=null;for(t=0;t<e.length;t++)r+=e[t].length;for(i=o.buffer.alloc(r),t=0;t<e.length;t++)e[t].copy(i,n),n+=e[t].length;return i}},string:{byteLength:function(t){if(null===t||void 0===t)return 0;if("string"==typeof t&&(t=o.buffer.toBuffer(t)),"number"==typeof t.byteLength)return t.byteLength;if("number"==typeof t.length)return t.length;if("number"==typeof t.size)return t.size;if("string"==typeof t.path)return e("fs").lstatSync(t.path).size;throw o.error(new Error("Cannot determine length of "+t),{object:t})},upperFirst:function(e){return e[0].toUpperCase()+e.substr(1)},lowerFirst:function(e){return e[0].toLowerCase()+e.substr(1)}},ini:{parse:function(e){var t,r={}
            ;return o.arrayEach(e.split(/\r?\n/),function(e){e=e.split(/(^|\s)[;#]/)[0];var n=e.match(/^\s*\[([^\[\]]+)\]\s*$/);if(n)t=n[1];else if(t){var i=e.match(/^\s*(.+?)\s*=\s*(.+?)\s*$/);i&&(r[t]=r[t]||{},r[t][i[1]]=i[2])}}),r}},fn:{noop:function(){},callback:function(e){if(e)throw e},makeAsync:function(e,t){return t&&t<=e.length?e:function(){var t=Array.prototype.slice.call(arguments,0);t.pop()(e.apply(null,t))}}},date:{getDate:function(){return i||(i=e("./core")),i.config.systemClockOffset?new Date((new Date).getTime()+i.config.systemClockOffset):new Date},iso8601:function(e){return void 0===e&&(e=o.date.getDate()),e.toISOString().replace(/\.\d{3}Z$/,"Z")},rfc822:function(e){return void 0===e&&(e=o.date.getDate()),e.toUTCString()},unixTimestamp:function(e){return void 0===e&&(e=o.date.getDate()),e.getTime()/1e3},from:function(e){return"number"==typeof e?new Date(1e3*e):new Date(e)},format:function(e,t){return t||(t="iso8601"),o.date[t](o.date.from(e))},parseTimestamp:function(e){if("number"==typeof e)return new Date(1e3*e);if(e.match(/^\d+$/))return new Date(1e3*e);if(e.match(/^\d{4}/))return new Date(e);if(e.match(/^\w{3},/))return new Date(e);throw o.error(new Error("unhandled timestamp format: "+e),{code:"TimestampParserError"})}},crypto:{crc32Table:[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],crc32:function(e){var t=o.crypto.crc32Table,r=-1;"string"==typeof e&&(e=o.buffer.toBuffer(e));for(var n=0;n<e.length;n++){r=r>>>8^t[255&(r^e.readUInt8(n))]}return(-1^r)>>>0},hmac:function(e,t,r,n){return r||(r="binary"),"buffer"===r&&(r=void 0),n||(n="sha256"),"string"==typeof t&&(t=o.buffer.toBuffer(t)),o.crypto.lib.createHmac(n,e).update(t).digest(r)},md5:function(e,t,r){return o.crypto.hash("md5",e,t,r)},sha256:function(e,t,r){return o.crypto.hash("sha256",e,t,r)},hash:function(e,t,r,n){var i=o.crypto.createHash(e);r||(r="binary"),"buffer"===r&&(r=void 0),"string"==typeof t&&(t=o.buffer.toBuffer(t));var s=o.arraySliceFn(t),a=o.Buffer.isBuffer(t);if(o.isBrowser()&&"undefined"!=typeof ArrayBuffer&&t&&t.buffer instanceof ArrayBuffer&&(a=!0),n&&"object"==typeof t&&"function"==typeof t.on&&!a)t.on("data",function(e){i.update(e)}),t.on("error",function(e){n(e)}),t.on("end",function(){n(null,i.digest(r))});else{if(!n||!s||a||"undefined"==typeof FileReader){o.isBrowser()&&"object"==typeof t&&!a&&(t=new o.Buffer(new Uint8Array(t)));var u=i.update(t).digest(r);return n&&n(null,u),u}var c=0,l=new FileReader;l.onerror=function(){n(new Error("Failed to read data."))},l.onload=function(){var e=new o.Buffer(new Uint8Array(l.result));i.update(e),c+=e.length,l._continueReading()},l._continueReading=function(){if(c>=t.size)return void n(null,i.digest(r));var e=c+524288;e>t.size&&(e=t.size),l.readAsArrayBuffer(s.call(t,c,e))},l._continueReading()}},toHex:function(e){for(var t=[],r=0;r<e.length;r++)t.push(("0"+e.charCodeAt(r).toString(16)).substr(-2,2));return t.join("")},createHash:function(e){return o.crypto.lib.createHash(e)}},abort:{},each:function(e,t){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=t.call(this,r,e[r]);if(n===o.abort)break}},arrayEach:function(e,t){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=t.call(this,e[r],parseInt(r,10));if(n===o.abort)break}},update:function(e,t){return o.each(t,function(t,r){e[t]=r}),e},merge:function(e,t){return o.update(o.copy(e),t)},copy:function(e){if(null===e||void 0===e)return e;var t={};for(var r in e)t[r]=e[r];return t},isEmpty:function(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0},arraySliceFn:function(e){var t=e.slice||e.webkitSlice||e.mozSlice;return"function"==typeof t?t:null},isType:function(e,t){return"function"==typeof t&&(t=o.typeName(t)),Object.prototype.toString.call(e)==="[object "+t+"]"},typeName:function(e){if(Object.prototype.hasOwnProperty.call(e,"name"))return e.name;var t=e.toString(),r=t.match(/^\s*function (.+)\(/);return r?r[1]:t},error:function(e,t){var r=null;return"string"==typeof e.message&&""!==e.message&&("string"==typeof t||t&&t.message)&&(r=o.copy(e),r.message=e.message),e.message=e.message||null,"string"==typeof t?e.message=t:"object"==typeof t&&null!==t&&(o.update(e,t),t.message&&(e.message=t.message),(t.code||t.name)&&(e.code=t.code||t.name),t.stack&&(e.stack=t.stack)),"function"==typeof Object.defineProperty&&(Object.defineProperty(e,"name",{writable:!0,enumerable:!1}),Object.defineProperty(e,"message",{enumerable:!0})),e.name=String(t&&t.name||e.name||e.code||"Error"),e.time=new Date,r&&(e.originalError=r),e},inherit:function(e,t){var r=null;if(void 0===t)t=e,e=Object,r={};else{var n=function(){};n.prototype=e.prototype,r=new n}return t.constructor===Object&&(t.constructor=function(){if(e!==Object)return e.apply(this,arguments)}),t.constructor.prototype=r,o.update(t.constructor.prototype,t),t.constructor.__super__=e,t.constructor},mixin:function(){for(var e=arguments[0],t=1;t<arguments.length;t++)for(var r in arguments[t].prototype){var n=arguments[t].prototype[r];"constructor"!==r&&(e.prototype[r]=n)}return e},hideProperties:function(e,t){"function"==typeof Object.defineProperty&&o.arrayEach(t,function(t){Object.defineProperty(e,t,{enumerable:!1,writable:!0,configurable:!0})})},property:function(e,t,r,n,i){var o={configurable:!0,enumerable:void 0===n||n};"function"!=typeof r||i?(o.value=r,o.writable=!0):o.get=r,Object.defineProperty(e,t,o)},memoizedProperty:function(e,t,r,n){var i=null;o.property(e,t,function(){return null===i&&(i=r()),i},n)},hoistPayloadMember:function(e){var t=e.request,r=t.operation,n=t.service.api.operations[r],i=n.output;if(i.payload&&!n.hasEventOutput){var s=i.members[i.payload],a=e.data[i.payload];"structure"===s.type&&o.each(a,function(t,r){o.property(e.data,t,r,!1)})}},computeSha256:function(t,r){if(o.isNode()){var n=o.stream.Stream,i=e("fs");if("function"==typeof n&&t instanceof n){if("string"!=typeof t.path)return r(new Error("Non-file stream objects are not supported with SigV4"));var s={};"number"==typeof t.start&&(s.start=t.start),"number"==typeof t.end&&(s.end=t.end),t=i.createReadStream(t.path,s)}}o.crypto.sha256(t,"hex",function(e,t){e?r(e):r(null,t)})},isClockSkewed:function(e){if(e)return o.property(i.config,"isClockSkewed",Math.abs((new Date).getTime()-e)>=3e5,!1),i.config.isClockSkewed},applyClockOffset:function(e){e&&(i.config.systemClockOffset=e-(new Date).getTime())},extractRequestId:function(e){var t=e.httpResponse.headers["x-amz-request-id"]||e.httpResponse.headers["x-amzn-requestid"];!t&&e.data&&e.data.ResponseMetadata&&(t=e.data.ResponseMetadata.RequestId),t&&(e.requestId=t),e.error&&(e.error.requestId=t)},addPromises:function(e,t){var r=!1;void 0===t&&i&&i.config&&(t=i.config.getPromisesDependency()),void 0===t&&"undefined"!=typeof Promise&&(t=Promise),"function"!=typeof t&&(r=!0),Array.isArray(e)||(e=[e]);for(var n=0;n<e.length;n++){var o=e[n];r?o.deletePromisesFromClass&&o.deletePromisesFromClass():o.addPromisesToClass&&o.addPromisesToClass(t)}},promisifyMethod:function(e,t){return function(){var r=this,n=Array.prototype.slice.call(arguments);return new t(function(t,i){n.push(function(e,r){e?i(e):t(r)}),r[e].apply(r,n)})}},isDualstackAvailable:function(t){if(!t)return!1;var r=e("../apis/metadata.json");return"string"!=typeof t&&(t=t.serviceIdentifier),!("string"!=typeof t||!r.hasOwnProperty(t))&&!!r[t].dualstackAvailable},calculateRetryDelay:function(e,t,r){t||(t={});var n=t.customBackoff||null;if("function"==typeof n)return n(e,r);var i="number"==typeof t.base?t.base:100;return Math.random()*(Math.pow(2,e)*i)},handleRequestWithRetries:function(e,t,r){t||(t={});var n=i.HttpClient.getInstance(),s=t.httpOptions||{},a=0,u=function(e){var n=t.maxRetries||0;e&&"TimeoutError"===e.code&&(e.retryable=!0);var i=o.calculateRetryDelay(a,t.retryDelayOptions,e);e&&e.retryable&&a<n&&i>=0?(a++,setTimeout(c,i+(e.retryAfter||0))):r(e)},c=function(){var t="";n.handleRequest(e,s,function(e){e.on("data",function(e){t+=e.toString()}),e.on("end",function(){var n=e.statusCode;if(n<300)r(null,t);else{var i=1e3*parseInt(e.headers["retry-after"],10)||0,s=o.error(new Error,{statusCode:n,retryable:n>=500||429===n});i&&s.retryable&&(s.retryAfter=i),u(s)}})},u)};i.util.defer(c)},uuid:{v4:function(){return e("uuid").v4()}},convertPayloadToString:function(e){var t=e.request,r=t.operation,n=t.service.api.operations[r].output||{};n.payload&&e.data[n.payload]&&(e.data[n.payload]=e.data[n.payload].toString())},defer:function(e){"object"==typeof r&&"function"==typeof r.nextTick?r.nextTick(e):"function"==typeof n?n(e):setTimeout(e,0)},getRequestPayloadShape:function(e){var t=e.service.api.operations;if(t){var r=(t||{})[e.operation];if(r&&r.input&&r.input.payload)return r.input.members[r.input.payload]}},getProfilesFromSharedConfig:function(e,t){var n={},i={};if(r.env[o.configOptInEnv])var i=e.loadFrom({isConfig:!0,filename:r.env[o.sharedConfigFileEnv]});for(var s=e.loadFrom({filename:t||r.env[o.configOptInEnv]&&r.env[o.sharedCredentialsFileEnv]}),a=0,u=Object.keys(i);a<u.length;a++)n[u[a]]=i[u[a]];for(var a=0,u=Object.keys(s);a<u.length;a++)n[u[a]]=s[u[a]];return n},ARN:{validate:function(e){return e&&0===e.indexOf("arn:")&&e.split(":").length>=6},parse:function(e){var t=e.split(":");return{partition:t[1],service:t[2],region:t[3],accountId:t[4],resource:t.slice(5).join(":")}},build:function(e){if(void 0===e.service||void 0===e.region||void 0===e.accountId||void 0===e.resource)throw o.error(new Error("Input ARN object is invalid"));return"arn:"+(e.partition||"aws")+":"+e.service+":"+e.region+":"+e.accountId+":"+e.resource}},defaultProfile:"default",configOptInEnv:"AWS_SDK_LOAD_CONFIG",sharedCredentialsFileEnv:"AWS_SHARED_CREDENTIALS_FILE",sharedConfigFileEnv:"AWS_CONFIG_FILE",imdsDisabledEnv:"AWS_EC2_METADATA_DISABLED"};t.exports=o}).call(this,e("_process"),e("timers").setImmediate)},{"../apis/metadata.json":26,"./core":39,_process:8,fs:2,timers:16,uuid:21}],37:[function(e,t,r){var n=e("./core");e("./credentials"),e("./credentials/credential_provider_chain");var i;n.Config=n.util.inherit({constructor:function(e){void 0===e&&(e={}),e=this.extractCredentials(e),n.util.each.call(this,this.keys,function(t,r){this.set(t,e[t],r)})},getCredentials:function(e){function t(t){e(t,t?null:i.credentials)}function r(e,t){return new n.util.error(t||new Error,{code:"CredentialsError",message:e,name:"CredentialsError"})}var i=this;i.credentials?"function"==typeof i.credentials.get?function(){i.credentials.get(function(e){e&&(e=r("Could not load credentials from "+i.credentials.constructor.name,e)),t(e)})}():function(){var e=null;i.credentials.accessKeyId&&i.credentials.secretAccessKey||(e=r("Missing credentials")),t(e)}():i.credentialProvider?i.credentialProvider.resolve(function(e,n){e&&(e=r("Could not load credentials from any providers",e)),i.credentials=n,t(e)}):t(r("No credentials to load"))},update:function(e,t){t=t||!1,e=this.extractCredentials(e),n.util.each.call(this,e,function(e,r){(t||Object.prototype.hasOwnProperty.call(this.keys,e)||n.Service.hasService(e))&&this.set(e,r)})},loadFromPath:function(e){this.clear();var t=JSON.parse(n.util.readFileSync(e)),r=new n.FileSystemCredentials(e),i=new n.CredentialProviderChain;return i.providers.unshift(r),i.resolve(function(e,r){if(e)throw e;t.credentials=r}),this.constructor(t),this},clear:function(){n.util.each.call(this,this.keys,function(e){delete this[e]}),this.set("credentials",void 0),this.set("credentialProvider",void 0)},set:function(e,t,r){void 0===t?(void 0===r&&(r=this.keys[e]),this[e]="function"==typeof r?r.call(this):r):"httpOptions"===e&&this[e]?this[e]=n.util.merge(this[e],t):this[e]=t},keys:{credentials:null,credentialProvider:null,region:null,logger:null,apiVersions:{},apiVersion:null,endpoint:void 0,httpOptions:{timeout:12e4},maxRetries:void 0,maxRedirects:10,paramValidation:!0,sslEnabled:!0,s3ForcePathStyle:!1,s3BucketEndpoint:!1,s3DisableBodySigning:!0,s3UsEast1RegionalEndpoint:"legacy",s3UseArnRegion:void 0,computeChecksums:!0,convertResponseTypes:!0,correctClockSkew:!1,customUserAgent:null,dynamoDbCrc32:!0,systemClockOffset:0,signatureVersion:null,signatureCache:!0,retryDelayOptions:{},useAccelerateEndpoint:!1,clientSideMonitoring:!1,endpointDiscoveryEnabled:!1,endpointCacheSize:1e3,hostPrefixEnabled:!0,stsRegionalEndpoints:"legacy"},extractCredentials:function(e){return e.accessKeyId&&e.secretAccessKey&&(e=n.util.copy(e),e.credentials=new n.Credentials(e)),e},setPromisesDependency:function(e){i=e,null===e&&"function"==typeof Promise&&(i=Promise);var t=[n.Request,n.Credentials,n.CredentialProviderChain];n.S3&&(t.push(n.S3),n.S3.ManagedUpload&&t.push(n.S3.ManagedUpload)),n.util.addPromises(t,i)},getPromisesDependency:function(){return i}}),n.config=new n.Config},{"./core":39,"./credentials":40,"./credentials/credential_provider_chain":43}],43:[function(e,t,r){var n=e("../core");n.CredentialProviderChain=n.util.inherit(n.Credentials,{constructor:function(e){this.providers=e||n.CredentialProviderChain.defaultProviders.slice(0),this.resolveCallbacks=[]},resolve:function(e){function t(e,s){if(!e&&s||i===o.length)return n.util.arrayEach(r.resolveCallbacks,function(t){t(e,s)}),void(r.resolveCallbacks.length=0);var a=o[i++];s="function"==typeof a?a.call():a,s.get?s.get(function(e){t(e,e?null:s)}):t(null,s)}var r=this;if(0===r.providers.length)return e(new Error("No providers")),r;if(1===r.resolveCallbacks.push(e)){var i=0,o=r.providers.slice(0);t()}return r}}),n.CredentialProviderChain.defaultProviders=[],n.CredentialProviderChain.addPromisesToClass=function(e){this.prototype.resolvePromise=n.util.promisifyMethod("resolve",e)},n.CredentialProviderChain.deletePromisesFromClass=function(){delete this.prototype.resolvePromise},n.util.addPromises(n.CredentialProviderChain)},{"../core":39}],40:[function(e,t,r){var n=e("./core");n.Credentials=n.util.inherit({constructor:function(){if(n.util.hideProperties(this,["secretAccessKey"]),this.expired=!1,this.expireTime=null,this.refreshCallbacks=[],1===arguments.length&&"object"==typeof arguments[0]){var e=arguments[0].credentials||arguments[0];this.accessKeyId=e.accessKeyId,this.secretAccessKey=e.secretAccessKey,this.sessionToken=e.sessionToken}else this.accessKeyId=arguments[0],this.secretAccessKey=arguments[1],this.sessionToken=arguments[2]},expiryWindow:15,needsRefresh:function(){var e=n.util.date.getDate().getTime(),t=new Date(e+1e3*this.expiryWindow);return!!(this.expireTime&&t>this.expireTime)||(this.expired||!this.accessKeyId||!this.secretAccessKey)},get:function(e){var t=this;this.needsRefresh()?this.refresh(function(r){r||(t.expired=!1),e&&e(r)}):e&&e()},refresh:function(e){this.expired=!1,e()},coalesceRefresh:function(e,t){var r=this;1===r.refreshCallbacks.push(e)&&r.load(function(e){n.util.arrayEach(r.refreshCallbacks,function(r){t?r(e):n.util.defer(function(){r(e)})}),r.refreshCallbacks.length=0})},load:function(e){e()}}),n.Credentials.addPromisesToClass=function(e){this.prototype.getPromise=n.util.promisifyMethod("get",e),this.prototype.refreshPromise=n.util.promisifyMethod("refresh",e)},n.Credentials.deletePromisesFromClass=function(){delete this.prototype.getPromise,delete this.prototype.refreshPromise},n.util.addPromises(n.Credentials)},{"./core":39}],27:[function(e,t,r){function n(e,t){if(!n.services.hasOwnProperty(e))throw new Error("InvalidService: Failed to load api for "+e);return n.services[e][t]}n.services={},t.exports=n},{}],26:[function(e,t,r){t.exports={acm:{name:"ACM",cors:!0},apigateway:{name:"APIGateway",cors:!0},applicationautoscaling:{prefix:"application-autoscaling",name:"ApplicationAutoScaling",cors:!0},appstream:{name:"AppStream"},autoscaling:{name:"AutoScaling",cors:!0},batch:{name:"Batch"},budgets:{name:"Budgets"},clouddirectory:{name:"CloudDirectory",versions:["2016-05-10*"]},cloudformation:{name:"CloudFormation",cors:!0},cloudfront:{name:"CloudFront",versions:["2013-05-12*","2013-11-11*","2014-05-31*","2014-10-21*","2014-11-06*","2015-04-17*","2015-07-27*","2015-09-17*","2016-01-13*","2016-01-28*","2016-08-01*","2016-08-20*","2016-09-07*","2016-09-29*","2016-11-25*","2017-03-25*","2017-10-30*","2018-06-18*","2018-11-05*"],cors:!0},cloudhsm:{name:"CloudHSM",cors:!0},cloudsearch:{name:"CloudSearch"},cloudsearchdomain:{name:"CloudSearchDomain"},cloudtrail:{name:"CloudTrail",cors:!0},cloudwatch:{prefix:"monitoring",name:"CloudWatch",cors:!0},cloudwatchevents:{prefix:"events",name:"CloudWatchEvents",versions:["2014-02-03*"],cors:!0},cloudwatchlogs:{prefix:"logs",name:"CloudWatchLogs",cors:!0},codebuild:{name:"CodeBuild",cors:!0},codecommit:{name:"CodeCommit",cors:!0},codedeploy:{name:"CodeDeploy",cors:!0},codepipeline:{name:"CodePipeline",cors:!0},cognitoidentity:{prefix:"cognito-identity",name:"CognitoIdentity",cors:!0},cognitoidentityserviceprovider:{prefix:"cognito-idp",name:"CognitoIdentityServiceProvider",cors:!0},cognitosync:{prefix:"cognito-sync",name:"CognitoSync",cors:!0},configservice:{prefix:"config",name:"ConfigService",cors:!0},cur:{name:"CUR",cors:!0},datapipeline:{name:"DataPipeline"},devicefarm:{name:"DeviceFarm",cors:!0},directconnect:{name:"DirectConnect",cors:!0},directoryservice:{prefix:"ds",name:"DirectoryService"},discovery:{name:"Discovery"},dms:{name:"DMS"},dynamodb:{name:"DynamoDB",cors:!0},dynamodbstreams:{prefix:"streams.dynamodb",name:"DynamoDBStreams",cors:!0},ec2:{name:"EC2",versions:["2013-06-15*","2013-10-15*","2014-02-01*","2014-05-01*","2014-06-15*","2014-09-01*","2014-10-01*","2015-03-01*","2015-04-15*","2015-10-01*","2016-04-01*","2016-09-15*"],cors:!0},ecr:{name:"ECR",cors:!0},ecs:{name:"ECS",cors:!0},efs:{prefix:"elasticfilesystem",name:"EFS",cors:!0},elasticache:{name:"ElastiCache",versions:["2012-11-15*","2014-03-24*","2014-07-15*","2014-09-30*"],cors:!0},elasticbeanstalk:{name:"ElasticBeanstalk",cors:!0},elb:{prefix:"elasticloadbalancing",name:"ELB",cors:!0},elbv2:{prefix:"elasticloadbalancingv2",name:"ELBv2",cors:!0},emr:{prefix:"elasticmapreduce",name:"EMR",cors:!0},es:{name:"ES"},elastictranscoder:{name:"ElasticTranscoder",cors:!0},firehose:{name:"Firehose",cors:!0},gamelift:{name:"GameLift",cors:!0},glacier:{name:"Glacier"},health:{name:"Health"},iam:{name:"IAM",cors:!0},importexport:{name:"ImportExport"},inspector:{name:"Inspector",versions:["2015-08-18*"],cors:!0},iot:{name:"Iot",cors:!0},iotdata:{prefix:"iot-data",name:"IotData",cors:!0},kinesis:{name:"Kinesis",cors:!0},kinesisanalytics:{name:"KinesisAnalytics"},kms:{name:"KMS",cors:!0},lambda:{name:"Lambda",cors:!0},lexruntime:{prefix:"runtime.lex",name:"LexRuntime",cors:!0},lightsail:{name:"Lightsail"},machinelearning:{name:"MachineLearning",cors:!0},marketplacecommerceanalytics:{name:"MarketplaceCommerceAnalytics",cors:!0},marketplacemetering:{prefix:"meteringmarketplace",name:"MarketplaceMetering"},mturk:{prefix:"mturk-requester",name:"MTurk",cors:!0},mobileanalytics:{name:"MobileAnalytics",cors:!0},opsworks:{name:"OpsWorks",cors:!0},opsworkscm:{name:"OpsWorksCM"},organizations:{name:"Organizations"},pinpoint:{name:"Pinpoint"},polly:{name:"Polly",cors:!0},rds:{name:"RDS",versions:["2014-09-01*"],cors:!0},redshift:{name:"Redshift",cors:!0},rekognition:{name:"Rekognition",cors:!0},resourcegroupstaggingapi:{name:"ResourceGroupsTaggingAPI"},route53:{name:"Route53",cors:!0},route53domains:{name:"Route53Domains",cors:!0},s3:{name:"S3",dualstackAvailable:!0,cors:!0},s3control:{name:"S3Control",dualstackAvailable:!0,xmlNoDefaultLists:!0},servicecatalog:{name:"ServiceCatalog",cors:!0},ses:{prefix:"email",name:"SES",cors:!0},shield:{name:"Shield"},simpledb:{prefix:"sdb",name:"SimpleDB"},sms:{name:"SMS"},snowball:{name:"Snowball"},sns:{name:"SNS",cors:!0},sqs:{name:"SQS",cors:!0},ssm:{name:"SSM",cors:!0},storagegateway:{name:"StorageGateway",cors:!0},stepfunctions:{prefix:"states",name:"StepFunctions"},sts:{name:"STS",cors:!0},support:{name:"Support"},swf:{name:"SWF"},xray:{name:"XRay",cors:!0},waf:{name:"WAF",cors:!0},wafregional:{prefix:"waf-regional",name:"WAFRegional"},workdocs:{name:"WorkDocs",cors:!0},workspaces:{name:"WorkSpaces"},codestar:{name:"CodeStar"},lexmodelbuildingservice:{prefix:"lex-models",name:"LexModelBuildingService",cors:!0},marketplaceentitlementservice:{prefix:"entitlement.marketplace",name:"MarketplaceEntitlementService"},athena:{name:"Athena"},greengrass:{name:"Greengrass"},dax:{name:"DAX"},migrationhub:{prefix:"AWSMigrationHub",name:"MigrationHub"},cloudhsmv2:{name:"CloudHSMV2"},glue:{name:"Glue"},mobile:{name:"Mobile"},pricing:{name:"Pricing",cors:!0},costexplorer:{prefix:"ce",name:"CostExplorer",cors:!0},mediaconvert:{name:"MediaConvert"},medialive:{name:"MediaLive"},mediapackage:{name:"MediaPackage"},mediastore:{name:"MediaStore"},mediastoredata:{prefix:"mediastore-data",name:"MediaStoreData",cors:!0},appsync:{name:"AppSync"},guardduty:{name:"GuardDuty"},mq:{name:"MQ"},comprehend:{name:"Comprehend",cors:!0},iotjobsdataplane:{prefix:"iot-jobs-data",name:"IoTJobsDataPlane"},kinesisvideoarchivedmedia:{prefix:"kinesis-video-archived-media",name:"KinesisVideoArchivedMedia",cors:!0},kinesisvideomedia:{prefix:"kinesis-video-media",name:"KinesisVideoMedia",cors:!0},kinesisvideo:{name:"KinesisVideo",cors:!0},sagemakerruntime:{prefix:"runtime.sagemaker",name:"SageMakerRuntime"},sagemaker:{name:"SageMaker"},translate:{name:"Translate",cors:!0},resourcegroups:{prefix:"resource-groups",name:"ResourceGroups",cors:!0},alexaforbusiness:{name:"AlexaForBusiness"},cloud9:{name:"Cloud9"},serverlessapplicationrepository:{prefix:"serverlessrepo",name:"ServerlessApplicationRepository"},servicediscovery:{name:"ServiceDiscovery"},workmail:{name:"WorkMail"},autoscalingplans:{prefix:"autoscaling-plans",name:"AutoScalingPlans"},transcribeservice:{prefix:"transcribe",name:"TranscribeService"},connect:{name:"Connect",cors:!0},acmpca:{prefix:"acm-pca",name:"ACMPCA"},fms:{name:"FMS"},secretsmanager:{name:"SecretsManager",cors:!0},iotanalytics:{name:"IoTAnalytics",cors:!0},iot1clickdevicesservice:{prefix:"iot1click-devices",name:"IoT1ClickDevicesService"},iot1clickprojects:{prefix:"iot1click-projects",name:"IoT1ClickProjects"},pi:{name:"PI"},neptune:{name:"Neptune"},mediatailor:{name:"MediaTailor"},eks:{name:"EKS"},macie:{name:"Macie"},dlm:{name:"DLM"},signer:{name:"Signer"},chime:{name:"Chime"},pinpointemail:{prefix:"pinpoint-email",name:"PinpointEmail"},ram:{name:"RAM"},route53resolver:{name:"Route53Resolver"},pinpointsmsvoice:{prefix:"sms-voice",name:"PinpointSMSVoice"},quicksight:{name:"QuickSight"},rdsdataservice:{prefix:"rds-data",name:"RDSDataService"},amplify:{name:"Amplify"},datasync:{name:"DataSync"},robomaker:{name:"RoboMaker"},transfer:{name:"Transfer"},globalaccelerator:{name:"GlobalAccelerator"},comprehendmedical:{name:"ComprehendMedical",cors:!0},kinesisanalyticsv2:{name:"KinesisAnalyticsV2"},mediaconnect:{name:"MediaConnect"},fsx:{name:"FSx"},securityhub:{name:"SecurityHub"},appmesh:{name:"AppMesh",versions:["2018-10-01*"]},licensemanager:{prefix:"license-manager",name:"LicenseManager"},kafka:{name:"Kafka"},apigatewaymanagementapi:{name:"ApiGatewayManagementApi"},apigatewayv2:{name:"ApiGatewayV2"},docdb:{name:"DocDB"},backup:{name:"Backup"},worklink:{name:"WorkLink"},textract:{name:"Textract"},managedblockchain:{name:"ManagedBlockchain"},mediapackagevod:{prefix:"mediapackage-vod",name:"MediaPackageVod"},groundstation:{name:"GroundStation"},iotthingsgraph:{name:"IoTThingsGraph"},iotevents:{name:"IoTEvents"},ioteventsdata:{prefix:"iotevents-data",name:"IoTEventsData"},personalize:{name:"Personalize",cors:!0},personalizeevents:{prefix:"personalize-events",name:"PersonalizeEvents",cors:!0},personalizeruntime:{prefix:"personalize-runtime",name:"PersonalizeRuntime",cors:!0},applicationinsights:{prefix:"application-insights",name:"ApplicationInsights"},servicequotas:{prefix:"service-quotas",name:"ServiceQuotas"},ec2instanceconnect:{prefix:"ec2-instance-connect",name:"EC2InstanceConnect"},eventbridge:{name:"EventBridge"},lakeformation:{name:"LakeFormation"},forecastservice:{prefix:"forecast",name:"ForecastService",cors:!0},forecastqueryservice:{prefix:"forecastquery",name:"ForecastQueryService",cors:!0},qldb:{name:"QLDB"},qldbsession:{prefix:"qldb-session",name:"QLDBSession"},workmailmessageflow:{name:"WorkMailMessageFlow"},codestarnotifications:{prefix:"codestar-notifications",name:"CodeStarNotifications"},savingsplans:{name:"SavingsPlans"},sso:{name:"SSO"},ssooidc:{prefix:"sso-oidc",name:"SSOOIDC"},marketplacecatalog:{prefix:"marketplace-catalog",name:"MarketplaceCatalog"},dataexchange:{name:"DataExchange"},sesv2:{name:"SESV2"},migrationhubconfig:{prefix:"migrationhub-config",name:"MigrationHubConfig"},connectparticipant:{name:"ConnectParticipant"},appconfig:{name:"AppConfig"},iotsecuretunneling:{name:"IoTSecureTunneling"},wafv2:{name:"WAFV2"},elasticinference:{prefix:"elastic-inference",name:"ElasticInference"},imagebuilder:{name:"Imagebuilder"},schemas:{name:"Schemas"},accessanalyzer:{name:"AccessAnalyzer"},codegurureviewer:{prefix:"codeguru-reviewer",name:"CodeGuruReviewer"},codeguruprofiler:{name:"CodeGuruProfiler"},computeoptimizer:{prefix:"compute-optimizer",name:"ComputeOptimizer"},frauddetector:{name:"FraudDetector"},kendra:{name:"Kendra"},networkmanager:{name:"NetworkManager"},outposts:{name:"Outposts"},augmentedairuntime:{prefix:"sagemaker-a2i-runtime",name:"AugmentedAIRuntime"},ebs:{name:"EBS"},kinesisvideosignalingchannels:{prefix:"kinesis-video-signaling",name:"KinesisVideoSignalingChannels",cors:!0},detective:{name:"Detective"},codestarconnections:{prefix:"codestar-connections",name:"CodeStarconnections"}}},{}],21:[function(e,t,r){var n=e("./v1"),i=e("./v4"),o=i;o.v1=n,o.v4=i,t.exports=o},{"./v1":24,"./v4":25}],25:[function(e,t,r){function n(e,t,r){var n=t&&r||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null),e=e||{};var s=e.random||(e.rng||i)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t)for(var a=0;a<16;++a)t[n+a]=s[a];return t||o(s)}var i=e("./lib/rng"),o=e("./lib/bytesToUuid");t.exports=n},{"./lib/bytesToUuid":22,"./lib/rng":23}],24:[function(e,t,r){function n(e,t,r){var n=t&&r||0,l=t||[];e=e||{};var h=e.node||i,p=void 0!==e.clockseq?e.clockseq:o;if(null==h||null==p){var f=s();null==h&&(h=i=[1|f[0],f[1],f[2],f[3],f[4],f[5]]),null==p&&(p=o=16383&(f[6]<<8|f[7]))}var d=void 0!==e.msecs?e.msecs:(new Date).getTime(),m=void 0!==e.nsecs?e.nsecs:c+1,v=d-u+(m-c)/1e4;if(v<0&&void 0===e.clockseq&&(p=p+1&16383),(v<0||d>u)&&void 0===e.nsecs&&(m=0),m>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");u=d,c=m,o=p,d+=122192928e5;var g=(1e4*(268435455&d)+m)%4294967296;l[n++]=g>>>24&255,l[n++]=g>>>16&255,l[n++]=g>>>8&255,l[n++]=255&g;var y=d/4294967296*1e4&268435455;l[n++]=y>>>8&255,l[n++]=255&y,l[n++]=y>>>24&15|16,l[n++]=y>>>16&255,l[n++]=p>>>8|128,l[n++]=255&p;for(var b=0;b<6;++b)l[n+b]=h[b];return t||a(l)}var i,o,s=e("./lib/rng"),a=e("./lib/bytesToUuid"),u=0,c=0;t.exports=n},{"./lib/bytesToUuid":22,"./lib/rng":23}],23:[function(e,t,r){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var i=new Uint8Array(16);t.exports=function(){return n(i),i}}else{var o=new Array(16);t.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),o[t]=e>>>((3&t)<<3)&255;return o}}},{}],22:[function(e,t,r){function n(e,t){var r=t||0,n=i;return[n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]]].join("")}for(var i=[],o=0;o<256;++o)i[o]=(o+256).toString(16).substr(1);t.exports=n},{}],20:[function(e,t,r){(function(t,n){function i(e,t){var n={seen:[],stylize:s};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),m(t)?n.showHidden=t:t&&r._extend(n,t),E(n.showHidden)&&(n.showHidden=!1),E(n.depth)&&(n.depth=2),E(n.colors)&&(n.colors=!1),E(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=o),u(n,e,n.depth)}function o(e,t){var r=i.styles[t];return r?"["+i.colors[r][0]+"m"+e+"["+i.colors[r][1]+"m":e}function s(e,t){return e}function a(e){var t={};return e.forEach(function(e,r){t[e]=!0}),t}function u(e,t,n){if(e.customInspect&&t&&R(t.inspect)&&t.inspect!==r.inspect&&(!t.constructor||t.constructor.prototype!==t)){var i=t.inspect(n,e);return b(i)||(i=u(e,i,n)),i}var o=c(e,t);if(o)return o;var s=Object.keys(t),m=a(s);if(e.showHidden&&(s=Object.getOwnPropertyNames(t)),x(t)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return l(t);if(0===s.length){if(R(t)){var v=t.name?": "+t.name:"";return e.stylize("[Function"+v+"]","special")}if(_(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(C(t))return e.stylize(Date.prototype.toString.call(t),"date");if(x(t))return l(t)}var g="",y=!1,w=["{","}"];if(d(t)&&(y=!0,w=["[","]"]),R(t)){g=" [Function"+(t.name?": "+t.name:"")+"]"}if(_(t)&&(g=" "+RegExp.prototype.toString.call(t)),C(t)&&(g=" "+Date.prototype.toUTCString.call(t)),x(t)&&(g=" "+l(t)),0===s.length&&(!y||0==t.length))return w[0]+g+w[1];if(n<0)return _(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special");e.seen.push(t);var E;return E=y?h(e,t,n,m,s):s.map(function(r){return p(e,t,n,m,r,y)}),e.seen.pop(),f(E,g,w)}function c(e,t){
        if(E(t))return e.stylize("undefined","undefined");if(b(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}return y(t)?e.stylize(""+t,"number"):m(t)?e.stylize(""+t,"boolean"):v(t)?e.stylize("null","null"):void 0}function l(e){return"["+Error.prototype.toString.call(e)+"]"}function h(e,t,r,n,i){for(var o=[],s=0,a=t.length;s<a;++s)L(t,String(s))?o.push(p(e,t,r,n,String(s),!0)):o.push("");return i.forEach(function(i){i.match(/^\d+$/)||o.push(p(e,t,r,n,i,!0))}),o}function p(e,t,r,n,i,o){var s,a,c;if(c=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]},c.get?a=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(a=e.stylize("[Setter]","special")),L(n,i)||(s="["+i+"]"),a||(e.seen.indexOf(c.value)<0?(a=v(r)?u(e,c.value,null):u(e,c.value,r-1),a.indexOf("\n")>-1&&(a=o?a.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+a.split("\n").map(function(e){return"   "+e}).join("\n"))):a=e.stylize("[Circular]","special")),E(s)){if(o&&i.match(/^\d+$/))return a;s=JSON.stringify(""+i),s.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+a}function f(e,t,r){var n=0;return e.reduce(function(e,t){return n++,t.indexOf("\n")>=0&&n++,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?r[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1]:r[0]+t+" "+e.join(", ")+" "+r[1]}function d(e){return Array.isArray(e)}function m(e){return"boolean"==typeof e}function v(e){return null===e}function g(e){return null==e}function y(e){return"number"==typeof e}function b(e){return"string"==typeof e}function w(e){return"symbol"==typeof e}function E(e){return void 0===e}function _(e){return S(e)&&"[object RegExp]"===T(e)}function S(e){return"object"==typeof e&&null!==e}function C(e){return S(e)&&"[object Date]"===T(e)}function x(e){return S(e)&&("[object Error]"===T(e)||e instanceof Error)}function R(e){return"function"==typeof e}function A(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e}function T(e){return Object.prototype.toString.call(e)}function k(e){return e<10?"0"+e.toString(10):e.toString(10)}function I(){var e=new Date,t=[k(e.getHours()),k(e.getMinutes()),k(e.getSeconds())].join(":");return[e.getDate(),N[e.getMonth()],t].join(" ")}function L(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var P=/%[sdj%]/g;r.format=function(e){if(!b(e)){for(var t=[],r=0;r<arguments.length;r++)t.push(i(arguments[r]));return t.join(" ")}for(var r=1,n=arguments,o=n.length,s=String(e).replace(P,function(e){if("%%"===e)return"%";if(r>=o)return e;switch(e){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(e){return"[Circular]"}default:return e}}),a=n[r];r<o;a=n[++r])v(a)||!S(a)?s+=" "+a:s+=" "+i(a);return s},r.deprecate=function(e,i){function o(){if(!s){if(t.throwDeprecation)throw new Error(i);t.traceDeprecation?console.trace(i):console.error(i),s=!0}return e.apply(this,arguments)}if(E(n.process))return function(){return r.deprecate(e,i).apply(this,arguments)};if(!0===t.noDeprecation)return e;var s=!1;return o};var q,O={};r.debuglog=function(e){if(E(q)&&(q=t.env.NODE_DEBUG||""),e=e.toUpperCase(),!O[e])if(new RegExp("\\b"+e+"\\b","i").test(q)){var n=t.pid;O[e]=function(){var t=r.format.apply(r,arguments);console.error("%s %d: %s",e,n,t)}}else O[e]=function(){};return O[e]},r.inspect=i,i.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},i.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},r.isArray=d,r.isBoolean=m,r.isNull=v,r.isNullOrUndefined=g,r.isNumber=y,r.isString=b,r.isSymbol=w,r.isUndefined=E,r.isRegExp=_,r.isObject=S,r.isDate=C,r.isError=x,r.isFunction=R,r.isPrimitive=A,r.isBuffer=e("./support/isBuffer");var N=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];r.log=function(){console.log("%s - %s",I(),r.format.apply(r,arguments))},r.inherits=e("inherits"),r._extend=function(e,t){if(!t||!S(t))return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e}}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":19,_process:8,inherits:18}],19:[function(e,t,r){t.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},{}],18:[function(e,t,r){"function"==typeof Object.create?t.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}},{}],16:[function(e,t,r){(function(t,n){function i(e,t){this._id=e,this._clearFn=t}var o=e("process/browser.js").nextTick,s=Function.prototype.apply,a=Array.prototype.slice,u={},c=0;r.setTimeout=function(){return new i(s.call(setTimeout,window,arguments),clearTimeout)},r.setInterval=function(){return new i(s.call(setInterval,window,arguments),clearInterval)},r.clearTimeout=r.clearInterval=function(e){e.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(window,this._id)},r.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},r.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},r._unrefActive=r.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},r.setImmediate="function"==typeof t?t:function(e){var t=c++,n=!(arguments.length<2)&&a.call(arguments,1);return u[t]=!0,o(function(){u[t]&&(n?e.apply(null,n):e.call(null),r.clearImmediate(t))}),t},r.clearImmediate="function"==typeof n?n:function(e){delete u[e]}}).call(this,e("timers").setImmediate,e("timers").clearImmediate)},{"process/browser.js":8,timers:16}],8:[function(e,t,r){function n(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function o(e){if(h===setTimeout)return setTimeout(e,0);if((h===n||!h)&&setTimeout)return h=setTimeout,setTimeout(e,0);try{return h(e,0)}catch(t){try{return h.call(null,e,0)}catch(t){return h.call(this,e,0)}}}function s(e){if(p===clearTimeout)return clearTimeout(e);if((p===i||!p)&&clearTimeout)return p=clearTimeout,clearTimeout(e);try{return p(e)}catch(t){try{return p.call(null,e)}catch(t){return p.call(this,e)}}}function a(){v&&d&&(v=!1,d.length?m=d.concat(m):g=-1,m.length&&u())}function u(){if(!v){var e=o(a);v=!0;for(var t=m.length;t;){for(d=m,m=[];++g<t;)d&&d[g].run();g=-1,t=m.length}d=null,v=!1,s(e)}}function c(e,t){this.fun=e,this.array=t}function l(){}var h,p,f=t.exports={};!function(){try{h="function"==typeof setTimeout?setTimeout:n}catch(e){h=n}try{p="function"==typeof clearTimeout?clearTimeout:i}catch(e){p=i}}();var d,m=[],v=!1,g=-1;f.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];m.push(new c(e,t)),1!==m.length||v||o(u)},c.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=l,f.addListener=l,f.once=l,f.off=l,f.removeListener=l,f.removeAllListeners=l,f.emit=l,f.prependListener=l,f.prependOnceListener=l,f.listeners=function(e){return[]},f.binding=function(e){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(e){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},{}],7:[function(e,t,r){!function(e){"use strict";function t(e){return null!==e&&"[object Array]"===Object.prototype.toString.call(e)}function r(e){return null!==e&&"[object Object]"===Object.prototype.toString.call(e)}function n(e,i){if(e===i)return!0;if(Object.prototype.toString.call(e)!==Object.prototype.toString.call(i))return!1;if(!0===t(e)){if(e.length!==i.length)return!1;for(var o=0;o<e.length;o++)if(!1===n(e[o],i[o]))return!1;return!0}if(!0===r(e)){var s={};for(var a in e)if(hasOwnProperty.call(e,a)){if(!1===n(e[a],i[a]))return!1;s[a]=!0}for(var u in i)if(hasOwnProperty.call(i,u)&&!0!==s[u])return!1;return!0}return!1}function i(e){if(""===e||!1===e||null===e)return!0;if(t(e)&&0===e.length)return!0;if(r(e)){for(var n in e)if(e.hasOwnProperty(n))return!1;return!0}return!1}function o(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;n++)r.push(e[t[n]]);return r}function s(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"||"_"===e}function a(e){return e>="0"&&e<="9"||"-"===e}function u(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"||e>="0"&&e<="9"||"_"===e}function c(){}function l(){}function h(e){this.runtime=e}function p(e){this._interpreter=e,this.functionTable={abs:{_func:this._functionAbs,_signature:[{types:[g]}]},avg:{_func:this._functionAvg,_signature:[{types:[S]}]},ceil:{_func:this._functionCeil,_signature:[{types:[g]}]},contains:{_func:this._functionContains,_signature:[{types:[b,w]},{types:[y]}]},ends_with:{_func:this._functionEndsWith,_signature:[{types:[b]},{types:[b]}]},floor:{_func:this._functionFloor,_signature:[{types:[g]}]},length:{_func:this._functionLength,_signature:[{types:[b,w,E]}]},map:{_func:this._functionMap,_signature:[{types:[_]},{types:[w]}]},max:{_func:this._functionMax,_signature:[{types:[S,C]}]},merge:{_func:this._functionMerge,_signature:[{types:[E],variadic:!0}]},max_by:{_func:this._functionMaxBy,_signature:[{types:[w]},{types:[_]}]},sum:{_func:this._functionSum,_signature:[{types:[S]}]},starts_with:{_func:this._functionStartsWith,_signature:[{types:[b]},{types:[b]}]},min:{_func:this._functionMin,_signature:[{types:[S,C]}]},min_by:{_func:this._functionMinBy,_signature:[{types:[w]},{types:[_]}]},type:{_func:this._functionType,_signature:[{types:[y]}]},keys:{_func:this._functionKeys,_signature:[{types:[E]}]},values:{_func:this._functionValues,_signature:[{types:[E]}]},sort:{_func:this._functionSort,_signature:[{types:[C,S]}]},sort_by:{_func:this._functionSortBy,_signature:[{types:[w]},{types:[_]}]},join:{_func:this._functionJoin,_signature:[{types:[b]},{types:[C]}]},reverse:{_func:this._functionReverse,_signature:[{types:[b,w]}]},to_array:{_func:this._functionToArray,_signature:[{types:[y]}]},to_string:{_func:this._functionToString,_signature:[{types:[y]}]},to_number:{_func:this._functionToNumber,_signature:[{types:[y]}]},not_null:{_func:this._functionNotNull,_signature:[{types:[y],variadic:!0}]}}}function f(e){return(new l).parse(e)}function d(e){return(new c).tokenize(e)}function m(e,t){var r=new l,n=new p,i=new h(n);n._interpreter=i;var o=r.parse(t);return i.search(o,e)}var v;v="function"==typeof String.prototype.trimLeft?function(e){return e.trimLeft()}:function(e){return e.match(/^\s*(.*)/)[1]};var g=0,y=1,b=2,w=3,E=4,_=6,S=8,C=9,x={".":"Dot","*":"Star",",":"Comma",":":"Colon","{":"Lbrace","}":"Rbrace","]":"Rbracket","(":"Lparen",")":"Rparen","@":"Current"},R={"<":!0,">":!0,"=":!0,"!":!0},A={" ":!0,"\t":!0,"\n":!0};c.prototype={tokenize:function(e){var t=[];this._current=0;for(var r,n,i;this._current<e.length;)if(s(e[this._current]))r=this._current,n=this._consumeUnquotedIdentifier(e),t.push({type:"UnquotedIdentifier",value:n,start:r});else if(void 0!==x[e[this._current]])t.push({type:x[e[this._current]],value:e[this._current],start:this._current}),this._current++;else if(a(e[this._current]))i=this._consumeNumber(e),t.push(i);else if("["===e[this._current])i=this._consumeLBracket(e),t.push(i);else if('"'===e[this._current])r=this._current,n=this._consumeQuotedIdentifier(e),t.push({type:"QuotedIdentifier",value:n,start:r});else if("'"===e[this._current])r=this._current,n=this._consumeRawStringLiteral(e),t.push({type:"Literal",value:n,start:r});else if("`"===e[this._current]){r=this._current;var o=this._consumeLiteral(e);t.push({type:"Literal",value:o,start:r})}else if(void 0!==R[e[this._current]])t.push(this._consumeOperator(e));else if(void 0!==A[e[this._current]])this._current++;else if("&"===e[this._current])r=this._current,this._current++,"&"===e[this._current]?(this._current++,t.push({type:"And",value:"&&",start:r})):t.push({type:"Expref",value:"&",start:r});else{if("|"!==e[this._current]){var u=new Error("Unknown character:"+e[this._current]);throw u.name="LexerError",u}r=this._current,this._current++,"|"===e[this._current]?(this._current++,t.push({type:"Or",value:"||",start:r})):t.push({type:"Pipe",value:"|",start:r})}return t},_consumeUnquotedIdentifier:function(e){var t=this._current;for(this._current++;this._current<e.length&&u(e[this._current]);)this._current++;return e.slice(t,this._current)},_consumeQuotedIdentifier:function(e){var t=this._current;this._current++;for(var r=e.length;'"'!==e[this._current]&&this._current<r;){var n=this._current;"\\"!==e[n]||"\\"!==e[n+1]&&'"'!==e[n+1]?n++:n+=2,this._current=n}return this._current++,JSON.parse(e.slice(t,this._current))},_consumeRawStringLiteral:function(e){var t=this._current;this._current++;for(var r=e.length;"'"!==e[this._current]&&this._current<r;){var n=this._current;"\\"!==e[n]||"\\"!==e[n+1]&&"'"!==e[n+1]?n++:n+=2,this._current=n}return this._current++,e.slice(t+1,this._current-1).replace("\\'","'")},_consumeNumber:function(e){var t=this._current;this._current++;for(var r=e.length;a(e[this._current])&&this._current<r;)this._current++;return{type:"Number",value:parseInt(e.slice(t,this._current)),start:t}},_consumeLBracket:function(e){var t=this._current;return this._current++,"?"===e[this._current]?(this._current++,{type:"Filter",value:"[?",start:t}):"]"===e[this._current]?(this._current++,{type:"Flatten",value:"[]",start:t}):{type:"Lbracket",value:"[",start:t}},_consumeOperator:function(e){var t=this._current,r=e[t];return this._current++,"!"===r?"="===e[this._current]?(this._current++,{type:"NE",value:"!=",start:t}):{type:"Not",value:"!",start:t}:"<"===r?"="===e[this._current]?(this._current++,{type:"LTE",value:"<=",start:t}):{type:"LT",value:"<",start:t}:">"===r?"="===e[this._current]?(this._current++,{type:"GTE",value:">=",start:t}):{type:"GT",value:">",start:t}:"="===r&&"="===e[this._current]?(this._current++,{type:"EQ",value:"==",start:t}):void 0},_consumeLiteral:function(e){this._current++;for(var t,r=this._current,n=e.length;"`"!==e[this._current]&&this._current<n;){var i=this._current;"\\"!==e[i]||"\\"!==e[i+1]&&"`"!==e[i+1]?i++:i+=2,this._current=i}var o=v(e.slice(r,this._current));return o=o.replace("\\`","`"),t=this._looksLikeJSON(o)?JSON.parse(o):JSON.parse('"'+o+'"'),this._current++,t},_looksLikeJSON:function(e){var t='[{"',r=["true","false","null"],n="-0123456789";if(""===e)return!1;if(t.indexOf(e[0])>=0)return!0;if(r.indexOf(e)>=0)return!0;if(!(n.indexOf(e[0])>=0))return!1;try{return JSON.parse(e),!0}catch(e){return!1}}};var T={};T.EOF=0,T.UnquotedIdentifier=0,T.QuotedIdentifier=0,T.Rbracket=0,T.Rparen=0,T.Comma=0,T.Rbrace=0,T.Number=0,T.Current=0,T.Expref=0,T.Pipe=1,T.Or=2,T.And=3,T.EQ=5,T.GT=5,T.LT=5,T.GTE=5,T.LTE=5,T.NE=5,T.Flatten=9,T.Star=20,T.Filter=21,T.Dot=40,T.Not=45,T.Lbrace=50,T.Lbracket=55,T.Lparen=60,l.prototype={parse:function(e){this._loadTokens(e),this.index=0;var t=this.expression(0);if("EOF"!==this._lookahead(0)){var r=this._lookaheadToken(0),n=new Error("Unexpected token type: "+r.type+", value: "+r.value);throw n.name="ParserError",n}return t},_loadTokens:function(e){var t=new c,r=t.tokenize(e);r.push({type:"EOF",value:"",start:e.length}),this.tokens=r},expression:function(e){var t=this._lookaheadToken(0);this._advance();for(var r=this.nud(t),n=this._lookahead(0);e<T[n];)this._advance(),r=this.led(n,r),n=this._lookahead(0);return r},_lookahead:function(e){return this.tokens[this.index+e].type},_lookaheadToken:function(e){return this.tokens[this.index+e]},_advance:function(){this.index++},nud:function(e){var t,r,n;switch(e.type){case"Literal":return{type:"Literal",value:e.value};case"UnquotedIdentifier":return{type:"Field",name:e.value};case"QuotedIdentifier":var i={type:"Field",name:e.value};if("Lparen"===this._lookahead(0))throw new Error("Quoted identifier not allowed for function names.");return i;case"Not":return r=this.expression(T.Not),{type:"NotExpression",children:[r]};case"Star":return t={type:"Identity"},r=null,r="Rbracket"===this._lookahead(0)?{type:"Identity"}:this._parseProjectionRHS(T.Star),{type:"ValueProjection",children:[t,r]};case"Filter":return this.led(e.type,{type:"Identity"});case"Lbrace":return this._parseMultiselectHash();case"Flatten":return t={type:"Flatten",children:[{type:"Identity"}]},r=this._parseProjectionRHS(T.Flatten),{type:"Projection",children:[t,r]};case"Lbracket":return"Number"===this._lookahead(0)||"Colon"===this._lookahead(0)?(r=this._parseIndexExpression(),this._projectIfSlice({type:"Identity"},r)):"Star"===this._lookahead(0)&&"Rbracket"===this._lookahead(1)?(this._advance(),this._advance(),r=this._parseProjectionRHS(T.Star),{type:"Projection",children:[{type:"Identity"},r]}):this._parseMultiselectList();case"Current":return{type:"Current"};case"Expref":return n=this.expression(T.Expref),{type:"ExpressionReference",children:[n]};case"Lparen":for(var o=[];"Rparen"!==this._lookahead(0);)"Current"===this._lookahead(0)?(n={type:"Current"},this._advance()):n=this.expression(0),o.push(n);return this._match("Rparen"),o[0];default:this._errorToken(e)}},led:function(e,t){var r;switch(e){case"Dot":var n=T.Dot;return"Star"!==this._lookahead(0)?(r=this._parseDotRHS(n),{type:"Subexpression",children:[t,r]}):(this._advance(),r=this._parseProjectionRHS(n),{type:"ValueProjection",children:[t,r]});case"Pipe":return r=this.expression(T.Pipe),{type:"Pipe",children:[t,r]};case"Or":return r=this.expression(T.Or),{type:"OrExpression",children:[t,r]};case"And":return r=this.expression(T.And),{type:"AndExpression",children:[t,r]};case"Lparen":for(var i,o=t.name,s=[];"Rparen"!==this._lookahead(0);)"Current"===this._lookahead(0)?(i={type:"Current"},this._advance()):i=this.expression(0),"Comma"===this._lookahead(0)&&this._match("Comma"),s.push(i);return this._match("Rparen"),{type:"Function",name:o,children:s};case"Filter":var a=this.expression(0);return this._match("Rbracket"),r="Flatten"===this._lookahead(0)?{type:"Identity"}:this._parseProjectionRHS(T.Filter),{type:"FilterProjection",children:[t,r,a]};case"Flatten":return{type:"Projection",children:[{type:"Flatten",children:[t]},this._parseProjectionRHS(T.Flatten)]};case"EQ":case"NE":case"GT":case"GTE":case"LT":case"LTE":return this._parseComparator(t,e);case"Lbracket":var u=this._lookaheadToken(0);return"Number"===u.type||"Colon"===u.type?(r=this._parseIndexExpression(),this._projectIfSlice(t,r)):(this._match("Star"),this._match("Rbracket"),r=this._parseProjectionRHS(T.Star),{type:"Projection",children:[t,r]});default:this._errorToken(this._lookaheadToken(0))}},_match:function(e){if(this._lookahead(0)!==e){var t=this._lookaheadToken(0),r=new Error("Expected "+e+", got: "+t.type);throw r.name="ParserError",r}this._advance()},_errorToken:function(e){var t=new Error("Invalid token ("+e.type+'): "'+e.value+'"');throw t.name="ParserError",t},_parseIndexExpression:function(){if("Colon"===this._lookahead(0)||"Colon"===this._lookahead(1))return this._parseSliceExpression();var e={type:"Index",value:this._lookaheadToken(0).value};return this._advance(),this._match("Rbracket"),e},_projectIfSlice:function(e,t){var r={type:"IndexExpression",children:[e,t]};return"Slice"===t.type?{type:"Projection",children:[r,this._parseProjectionRHS(T.Star)]}:r},_parseSliceExpression:function(){for(var e=[null,null,null],t=0,r=this._lookahead(0);"Rbracket"!==r&&t<3;){if("Colon"===r)t++,this._advance();else{if("Number"!==r){var n=this._lookahead(0),i=new Error("Syntax error, unexpected token: "+n.value+"("+n.type+")");throw i.name="Parsererror",i}e[t]=this._lookaheadToken(0).value,this._advance()}r=this._lookahead(0)}return this._match("Rbracket"),{type:"Slice",children:e}},_parseComparator:function(e,t){return{type:"Comparator",name:t,children:[e,this.expression(T[t])]}},_parseDotRHS:function(e){var t=this._lookahead(0);return["UnquotedIdentifier","QuotedIdentifier","Star"].indexOf(t)>=0?this.expression(e):"Lbracket"===t?(this._match("Lbracket"),this._parseMultiselectList()):"Lbrace"===t?(this._match("Lbrace"),this._parseMultiselectHash()):void 0},_parseProjectionRHS:function(e){var t;if(T[this._lookahead(0)]<10)t={type:"Identity"};else if("Lbracket"===this._lookahead(0))t=this.expression(e);else if("Filter"===this._lookahead(0))t=this.expression(e);else{if("Dot"!==this._lookahead(0)){var r=this._lookaheadToken(0),n=new Error("Sytanx error, unexpected token: "+r.value+"("+r.type+")");throw n.name="ParserError",n}this._match("Dot"),t=this._parseDotRHS(e)}return t},_parseMultiselectList:function(){for(var e=[];"Rbracket"!==this._lookahead(0);){var t=this.expression(0);if(e.push(t),"Comma"===this._lookahead(0)&&(this._match("Comma"),"Rbracket"===this._lookahead(0)))throw new Error("Unexpected token Rbracket")}return this._match("Rbracket"),{type:"MultiSelectList",children:e}},_parseMultiselectHash:function(){for(var e,t,r,n,i=[],o=["UnquotedIdentifier","QuotedIdentifier"];;){if(e=this._lookaheadToken(0),o.indexOf(e.type)<0)throw new Error("Expecting an identifier token, got: "+e.type);if(t=e.value,this._advance(),this._match("Colon"),r=this.expression(0),n={type:"KeyValuePair",name:t,value:r},i.push(n),"Comma"===this._lookahead(0))this._match("Comma");else if("Rbrace"===this._lookahead(0)){this._match("Rbrace");break}}return{type:"MultiSelectHash",children:i}}},h.prototype={search:function(e,t){return this.visit(e,t)},visit:function(e,s){var a,u,c,l,h,p,f,d,m;switch(e.type){case"Field":return null===s?null:r(s)?(p=s[e.name],void 0===p?null:p):null;case"Subexpression":for(c=this.visit(e.children[0],s),m=1;m<e.children.length;m++)if(null===(c=this.visit(e.children[1],c)))return null;return c;case"IndexExpression":return f=this.visit(e.children[0],s),this.visit(e.children[1],f);case"Index":if(!t(s))return null;var v=e.value;return v<0&&(v=s.length+v),c=s[v],void 0===c&&(c=null),c;case"Slice":if(!t(s))return null;var g=e.children.slice(0),y=this.computeSliceParams(s.length,g),b=y[0],w=y[1],E=y[2];if(c=[],E>0)for(m=b;m<w;m+=E)c.push(s[m]);else for(m=b;m>w;m+=E)c.push(s[m]);return c;case"Projection":var _=this.visit(e.children[0],s);if(!t(_))return null;for(d=[],m=0;m<_.length;m++)null!==(u=this.visit(e.children[1],_[m]))&&d.push(u);return d;case"ValueProjection":if(_=this.visit(e.children[0],s),!r(_))return null;d=[];var S=o(_);for(m=0;m<S.length;m++)null!==(u=this.visit(e.children[1],S[m]))&&d.push(u);return d;case"FilterProjection":if(_=this.visit(e.children[0],s),!t(_))return null;var C=[],x=[];for(m=0;m<_.length;m++)a=this.visit(e.children[2],_[m]),i(a)||C.push(_[m]);for(var R=0;R<C.length;R++)null!==(u=this.visit(e.children[1],C[R]))&&x.push(u);return x;case"Comparator":switch(l=this.visit(e.children[0],s),h=this.visit(e.children[1],s),e.name){case"EQ":c=n(l,h);break;case"NE":c=!n(l,h);break;case"GT":c=l>h;break;case"GTE":c=l>=h;break;case"LT":c=l<h;break;case"LTE":c=l<=h;break;default:throw new Error("Unknown comparator: "+e.name)}return c;case"Flatten":var A=this.visit(e.children[0],s);if(!t(A))return null;var T=[];for(m=0;m<A.length;m++)u=A[m],t(u)?T.push.apply(T,u):T.push(u);return T;case"Identity":return s;case"MultiSelectList":if(null===s)return null;for(d=[],m=0;m<e.children.length;m++)d.push(this.visit(e.children[m],s));return d;case"MultiSelectHash":if(null===s)return null;d={};var k;for(m=0;m<e.children.length;m++)k=e.children[m],d[k.name]=this.visit(k.value,s);return d;case"OrExpression":return a=this.visit(e.children[0],s),i(a)&&(a=this.visit(e.children[1],s)),a;case"AndExpression":return l=this.visit(e.children[0],s),!0===i(l)?l:this.visit(e.children[1],s);case"NotExpression":return l=this.visit(e.children[0],s),i(l);case"Literal":return e.value;case"Pipe":return f=this.visit(e.children[0],s),this.visit(e.children[1],f);case"Current":return s;case"Function":var I=[];for(m=0;m<e.children.length;m++)I.push(this.visit(e.children[m],s));return this.runtime.callFunction(e.name,I);case"ExpressionReference":var L=e.children[0];return L.jmespathType="Expref",L;default:throw new Error("Unknown node type: "+e.type)}},computeSliceParams:function(e,t){var r=t[0],n=t[1],i=t[2],o=[null,null,null];if(null===i)i=1;else if(0===i){var s=new Error("Invalid slice, step cannot be 0");throw s.name="RuntimeError",s}var a=i<0;return r=null===r?a?e-1:0:this.capSliceRange(e,r,i),n=null===n?a?-1:e:this.capSliceRange(e,n,i),o[0]=r,o[1]=n,o[2]=i,o},capSliceRange:function(e,t,r){return t<0?(t+=e)<0&&(t=r<0?-1:0):t>=e&&(t=r<0?e-1:e),t}},p.prototype={callFunction:function(e,t){var r=this.functionTable[e];if(void 0===r)throw new Error("Unknown function: "+e+"()");return this._validateArgs(e,t,r._signature),r._func.call(this,t)},_validateArgs:function(e,t,r){var n;if(r[r.length-1].variadic){if(t.length<r.length)throw n=1===r.length?" argument":" arguments",new Error("ArgumentError: "+e+"() takes at least"+r.length+n+" but received "+t.length)}else if(t.length!==r.length)throw n=1===r.length?" argument":" arguments",new Error("ArgumentError: "+e+"() takes "+r.length+n+" but received "+t.length);for(var i,o,s,a=0;a<r.length;a++){s=!1,i=r[a].types,o=this._getTypeName(t[a]);for(var u=0;u<i.length;u++)if(this._typeMatches(o,i[u],t[a])){s=!0;break}if(!s)throw new Error("TypeError: "+e+"() expected argument "+(a+1)+" to be type "+i+" but received type "+o+" instead.")}},_typeMatches:function(e,t,r){if(t===y)return!0;if(t!==C&&t!==S&&t!==w)return e===t;if(t===w)return e===w;if(e===w){var n;t===S?n=g:t===C&&(n=b);for(var i=0;i<r.length;i++)if(!this._typeMatches(this._getTypeName(r[i]),n,r[i]))return!1;return!0}},_getTypeName:function(e){switch(Object.prototype.toString.call(e)){case"[object String]":return b;case"[object Number]":return g;case"[object Array]":return w;case"[object Boolean]":return 5;case"[object Null]":return 7;case"[object Object]":return"Expref"===e.jmespathType?_:E}},_functionStartsWith:function(e){return 0===e[0].lastIndexOf(e[1])},_functionEndsWith:function(e){var t=e[0],r=e[1];return-1!==t.indexOf(r,t.length-r.length)},_functionReverse:function(e){if(this._getTypeName(e[0])===b){for(var t=e[0],r="",n=t.length-1;n>=0;n--)r+=t[n];return r}var i=e[0].slice(0);return i.reverse(),i},_functionAbs:function(e){return Math.abs(e[0])},_functionCeil:function(e){return Math.ceil(e[0])},_functionAvg:function(e){for(var t=0,r=e[0],n=0;n<r.length;n++)t+=r[n];return t/r.length},_functionContains:function(e){return e[0].indexOf(e[1])>=0},_functionFloor:function(e){return Math.floor(e[0])},_functionLength:function(e){return r(e[0])?Object.keys(e[0]).length:e[0].length},_functionMap:function(e){for(var t=[],r=this._interpreter,n=e[0],i=e[1],o=0;o<i.length;o++)t.push(r.visit(n,i[o]));return t},_functionMerge:function(e){for(var t={},r=0;r<e.length;r++){var n=e[r];for(var i in n)t[i]=n[i]}return t},_functionMax:function(e){if(e[0].length>0){if(this._getTypeName(e[0][0])===g)return Math.max.apply(Math,e[0]);for(var t=e[0],r=t[0],n=1;n<t.length;n++)r.localeCompare(t[n])<0&&(r=t[n]);return r}return null},_functionMin:function(e){if(e[0].length>0){if(this._getTypeName(e[0][0])===g)return Math.min.apply(Math,e[0]);for(var t=e[0],r=t[0],n=1;n<t.length;n++)t[n].localeCompare(r)<0&&(r=t[n]);return r}return null},_functionSum:function(e){for(var t=0,r=e[0],n=0;n<r.length;n++)t+=r[n];return t},_functionType:function(e){switch(this._getTypeName(e[0])){case g:return"number";case b:return"string";case w:return"array";case E:return"object";case 5:return"boolean";case _:return"expref";case 7:return"null"}},_functionKeys:function(e){return Object.keys(e[0])},_functionValues:function(e){for(var t=e[0],r=Object.keys(t),n=[],i=0;i<r.length;i++)n.push(t[r[i]]);return n},_functionJoin:function(e){var t=e[0];return e[1].join(t)},_functionToArray:function(e){return this._getTypeName(e[0])===w?e[0]:[e[0]]},_functionToString:function(e){return this._getTypeName(e[0])===b?e[0]:JSON.stringify(e[0])},_functionToNumber:function(e){var t,r=this._getTypeName(e[0]);return r===g?e[0]:r!==b||(t=+e[0],isNaN(t))?null:t},_functionNotNull:function(e){for(var t=0;t<e.length;t++)if(7!==this._getTypeName(e[t]))return e[t];return null},_functionSort:function(e){var t=e[0].slice(0);return t.sort(),t},_functionSortBy:function(e){var t=e[0].slice(0);if(0===t.length)return t;var r=this._interpreter,n=e[1],i=this._getTypeName(r.visit(n,t[0]));if([g,b].indexOf(i)<0)throw new Error("TypeError");for(var o=this,s=[],a=0;a<t.length;a++)s.push([a,t[a]]);s.sort(function(e,t){var s=r.visit(n,e[1]),a=r.visit(n,t[1]);if(o._getTypeName(s)!==i)throw new Error("TypeError: expected "+i+", received "+o._getTypeName(s));if(o._getTypeName(a)!==i)throw new Error("TypeError: expected "+i+", received "+o._getTypeName(a));return s>a?1:s<a?-1:e[0]-t[0]});for(var u=0;u<s.length;u++)t[u]=s[u][1];return t},_functionMaxBy:function(e){for(var t,r,n=e[1],i=e[0],o=this.createKeyFunction(n,[g,b]),s=-1/0,a=0;a<i.length;a++)(r=o(i[a]))>s&&(s=r,t=i[a]);return t},_functionMinBy:function(e){for(var t,r,n=e[1],i=e[0],o=this.createKeyFunction(n,[g,b]),s=1/0,a=0;a<i.length;a++)(r=o(i[a]))<s&&(s=r,t=i[a]);return t},createKeyFunction:function(e,t){var r=this,n=this._interpreter;return function(i){var o=n.visit(e,i);if(t.indexOf(r._getTypeName(o))<0){var s="TypeError: expected one of "+t+", received "+r._getTypeName(o);throw new Error(s)}return o}}},e.tokenize=d,e.compile=f,e.search=m,e.strictDeepEqual=n}(void 0===r?this.jmespath={}:r)},{}],2:[function(e,t,r){},{}]},{},[]),_xamzrequire=function e(t,r,n){function i(s,a){if(!r[s]){if(!t[s]){var u="function"==typeof _xamzrequire&&_xamzrequire;if(!a&&u)return u(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var l=r[s]={exports:{}};t[s][0].call(l.exports,function(e){var r=t[s][1][e];return i(r||e)},l,l.exports,e,t,r,n)}return r[s].exports}for(var o="function"==typeof _xamzrequire&&_xamzrequire,s=0;s<n.length;s++)i(n[s]);return i}({28:[function(e,t,r){e("./browser_loader");var n=e("./core");"undefined"!=typeof window&&(window.AWS=n),void 0!==t&&(t.exports=n),"undefined"!=typeof self&&(self.AWS=n)},{"./browser_loader":35,"./core":39}],35:[function(e,t,r){(function(r){var n=e("./util");n.crypto.lib=e("./browserCryptoLib"),n.Buffer=e("buffer/").Buffer,n.url=e("url/"),n.querystring=e("querystring/"),n.realClock=e("./realclock/browserClock"),n.environment="js",n.createEventStream=e("./event-stream/buffered-create-event-stream").createEventStream,n.isBrowser=function(){return!0},n.isNode=function(){return!1};var i=e("./core");if(t.exports=i,e("./credentials"),e("./credentials/credential_provider_chain"),e("./credentials/temporary_credentials"),e("./credentials/chainable_temporary_credentials"),e("./credentials/web_identity_credentials"),e("./credentials/cognito_identity_credentials"),e("./credentials/saml_credentials"),i.XML.Parser=e("./xml/browser_parser"),e("./http/xhr"),void 0===r)var r={browser:!0}}).call(this,e("_process"))},{"./browserCryptoLib":29,"./core":39,"./credentials":40,"./credentials/chainable_temporary_credentials":41,"./credentials/cognito_identity_credentials":42,"./credentials/credential_provider_chain":43,"./credentials/saml_credentials":44,"./credentials/temporary_credentials":45,"./credentials/web_identity_credentials":46,"./event-stream/buffered-create-event-stream":54,"./http/xhr":62,"./realclock/browserClock":81,"./util":118,"./xml/browser_parser":119,_process:8,"buffer/":3,"querystring/":15,"url/":17}],119:[function(e,t,r){function n(){}function i(e,t){
        for(var r=e.getElementsByTagName(t),n=0,i=r.length;n<i;n++)if(r[n].parentNode===e)return r[n]}function o(e,t){switch(t||(t={}),t.type){case"structure":return s(e,t);case"map":return a(e,t);case"list":return u(e,t);case void 0:case null:return l(e);default:return c(e,t)}}function s(e,t){var r={};return null===e?r:(h.each(t.members,function(n,s){if(s.isXmlAttribute){if(Object.prototype.hasOwnProperty.call(e.attributes,s.name)){var a=e.attributes[s.name].value;r[n]=o({textContent:a},s)}}else{var u=s.flattened?e:i(e,s.name);u?r[n]=o(u,s):s.flattened||"list"!==s.type||t.api.xmlNoDefaultLists||(r[n]=s.defaultValue)}}),r)}function a(e,t){for(var r={},n=t.key.name||"key",s=t.value.name||"value",a=t.flattened?t.name:"entry",u=e.firstElementChild;u;){if(u.nodeName===a){var c=i(u,n).textContent,l=i(u,s);r[c]=o(l,t.value)}u=u.nextElementSibling}return r}function u(e,t){for(var r=[],n=t.flattened?t.name:t.member.name||"member",i=e.firstElementChild;i;)i.nodeName===n&&r.push(o(i,t.member)),i=i.nextElementSibling;return r}function c(e,t){if(e.getAttribute){var r=e.getAttribute("encoding");"base64"===r&&(t=new p.create({type:r}))}var n=e.textContent;return""===n&&(n=null),"function"==typeof t.toType?t.toType(n):n}function l(e){if(void 0===e||null===e)return"";if(!e.firstElementChild)return null===e.parentNode.parentNode?{}:0===e.childNodes.length?"":e.textContent;for(var t={type:"structure",members:{}},r=e.firstElementChild;r;){var n=r.nodeName;Object.prototype.hasOwnProperty.call(t.members,n)?t.members[n].type="list":t.members[n]={name:n},r=r.nextElementSibling}return s(e,t)}var h=e("../util"),p=e("../model/shape");n.prototype.parse=function(e,t){if(""===e.replace(/^\s+/,""))return{};var r,n;try{if(window.DOMParser){try{r=(new DOMParser).parseFromString(e,"text/xml")}catch(e){throw h.error(new Error("Parse error in document"),{originalError:e,code:"XMLParserError",retryable:!0})}if(null===r.documentElement)throw h.error(new Error("Cannot parse empty document."),{code:"XMLParserError",retryable:!0});var s=r.getElementsByTagName("parsererror")[0];if(s&&(s.parentNode===r||"body"===s.parentNode.nodeName||s.parentNode.parentNode===r||"body"===s.parentNode.parentNode.nodeName)){var a=s.getElementsByTagName("div")[0]||s;throw h.error(new Error(a.textContent||"Parser error in document"),{code:"XMLParserError",retryable:!0})}}else{if(!window.ActiveXObject)throw new Error("Cannot load XML parser");if(r=new window.ActiveXObject("Microsoft.XMLDOM"),r.async=!1,!r.loadXML(e))throw h.error(new Error("Parse error in document"),{code:"XMLParserError",retryable:!0})}}catch(e){n=e}if(r&&r.documentElement&&!n){var u=o(r.documentElement,t),c=i(r.documentElement,"ResponseMetadata");return c&&(u.ResponseMetadata=o(c,{})),u}if(n)throw h.error(n||new Error,{code:"XMLParserError",retryable:!0});return{}},t.exports=n},{"../model/shape":70,"../util":118}],81:[function(e,t,r){t.exports={now:function(){return"undefined"!=typeof performance&&"function"==typeof performance.now?performance.now():Date.now()}}},{}],62:[function(e,t,r){var n=e("../core"),i=e("events").EventEmitter;e("../http"),n.XHRClient=n.util.inherit({handleRequest:function(e,t,r,o){var s=this,a=e.endpoint,u=new i,c=a.protocol+"//"+a.hostname;80!==a.port&&443!==a.port&&(c+=":"+a.port),c+=e.path;var l=new XMLHttpRequest,h=!1;e.stream=l,l.addEventListener("readystatechange",function(){try{if(0===l.status)return}catch(e){return}this.readyState>=this.HEADERS_RECEIVED&&!h&&(u.statusCode=l.status,u.headers=s.parseHeaders(l.getAllResponseHeaders()),u.emit("headers",u.statusCode,u.headers,l.statusText),h=!0),this.readyState===this.DONE&&s.finishRequest(l,u)},!1),l.upload.addEventListener("progress",function(e){u.emit("sendProgress",e)}),l.addEventListener("progress",function(e){u.emit("receiveProgress",e)},!1),l.addEventListener("timeout",function(){o(n.util.error(new Error("Timeout"),{code:"TimeoutError"}))},!1),l.addEventListener("error",function(){o(n.util.error(new Error("Network Failure"),{code:"NetworkingError"}))},!1),l.addEventListener("abort",function(){o(n.util.error(new Error("Request aborted"),{code:"RequestAbortedError"}))},!1),r(u),l.open(e.method,c,!1!==t.xhrAsync),n.util.each(e.headers,function(e,t){"Content-Length"!==e&&"User-Agent"!==e&&"Host"!==e&&l.setRequestHeader(e,t)}),t.timeout&&!1!==t.xhrAsync&&(l.timeout=t.timeout),t.xhrWithCredentials&&(l.withCredentials=!0);try{l.responseType="arraybuffer"}catch(e){}try{e.body?l.send(e.body):l.send()}catch(t){if(!e.body||"object"!=typeof e.body.buffer)throw t;l.send(e.body.buffer)}return u},parseHeaders:function(e){var t={};return n.util.arrayEach(e.split(/\r?\n/),function(e){var r=e.split(":",1)[0],n=e.substring(r.length+2);r.length>0&&(t[r.toLowerCase()]=n)}),t},finishRequest:function(e,t){var r;if("arraybuffer"===e.responseType&&e.response){var i=e.response;r=new n.util.Buffer(i.byteLength);for(var o=new Uint8Array(i),s=0;s<r.length;++s)r[s]=o[s]}try{r||"string"!=typeof e.responseText||(r=new n.util.Buffer(e.responseText))}catch(e){}r&&t.emit("data",r),t.emit("end")}}),n.HttpClient.prototype=n.XHRClient.prototype,n.HttpClient.streamsApiVersion=1},{"../core":39,"../http":61,events:4}],54:[function(e,t,r){function n(e,t,r){for(var n=i(e),s=[],a=0;a<n.length;a++)s.push(o(t,n[a],r));return s}var i=e("../event-stream/event-message-chunker").eventMessageChunker,o=e("./parse-event").parseEvent;t.exports={createEventStream:n}},{"../event-stream/event-message-chunker":55,"./parse-event":57}],57:[function(e,t,r){function n(e,t,r){var n=o(t),s=n.headers[":message-type"];if(s){if("error"===s.value)throw i(n);if("event"!==s.value)return}var a=n.headers[":event-type"],u=r.members[a.value];if(u){var c={},l=u.eventPayloadMemberName;if(l){var h=u.members[l];"binary"===h.type?c[l]=n.body:c[l]=e.parse(n.body.toString(),h)}for(var p=u.eventHeaderMemberNames,f=0;f<p.length;f++){var d=p[f];n.headers[d]&&(c[d]=u.members[d].toType(n.headers[d].value))}var m={};return m[a.value]=c,m}}function i(e){var t=e.headers[":error-code"],r=e.headers[":error-message"],n=new Error(r.value||r);return n.code=n.name=t.value||t,n}var o=e("./parse-message").parseMessage;t.exports={parseEvent:n}},{"./parse-message":58}],58:[function(e,t,r){function n(e){for(var t={},r=0;r<e.length;){var n=e.readUInt8(r++),i=e.slice(r,r+n).toString();switch(r+=n,e.readUInt8(r++)){case 0:t[i]={type:a,value:!0};break;case 1:t[i]={type:a,value:!1};break;case 2:t[i]={type:u,value:e.readInt8(r++)};break;case 3:t[i]={type:c,value:e.readInt16BE(r)},r+=2;break;case 4:t[i]={type:l,value:e.readInt32BE(r)},r+=4;break;case 5:t[i]={type:h,value:new o(e.slice(r,r+8))},r+=8;break;case 6:var s=e.readUInt16BE(r);r+=2,t[i]={type:p,value:e.slice(r,r+s)},r+=s;break;case 7:var v=e.readUInt16BE(r);r+=2,t[i]={type:f,value:e.slice(r,r+v).toString()},r+=v;break;case 8:t[i]={type:d,value:new Date(new o(e.slice(r,r+8)).valueOf())},r+=8;break;case 9:var g=e.slice(r,r+16).toString("hex");r+=16,t[i]={type:m,value:g.substr(0,8)+"-"+g.substr(8,4)+"-"+g.substr(12,4)+"-"+g.substr(16,4)+"-"+g.substr(20)};break;default:throw new Error("Unrecognized header type tag")}}return t}function i(e){var t=s(e);return{headers:n(t.headers),body:t.body}}var o=e("./int64").Int64,s=e("./split-message").splitMessage,a="boolean",u="byte",c="short",l="integer",h="long",p="binary",f="string",d="timestamp",m="uuid";t.exports={parseMessage:i}},{"./int64":56,"./split-message":59}],59:[function(e,t,r){function n(e){if(i.Buffer.isBuffer(e)||(e=o(e)),e.length<c)throw new Error("Provided message too short to accommodate event stream message overhead");if(e.length!==e.readUInt32BE(0))throw new Error("Reported message length does not match received message length");var t=e.readUInt32BE(a);if(t!==i.crypto.crc32(e.slice(0,a)))throw new Error("The prelude checksum specified in the message ("+t+") does not match the calculated CRC32 checksum.");var r=e.readUInt32BE(e.length-u);if(r!==i.crypto.crc32(e.slice(0,e.length-u)))throw new Error("The message checksum did not match the expected value of "+r);var n=a+u,l=n+e.readUInt32BE(s);return{headers:e.slice(n,l),body:e.slice(l,e.length-u)}}var i=e("../core").util,o=i.buffer.toBuffer,s=4,a=2*s,u=4,c=a+2*u;t.exports={splitMessage:n}},{"../core":39}],56:[function(e,t,r){function n(e){if(8!==e.length)throw new Error("Int64 buffers must be exactly 8 bytes");o.Buffer.isBuffer(e)||(e=s(e)),this.bytes=e}function i(e){for(var t=0;t<8;t++)e[t]^=255;for(var t=7;t>-1&&0===++e[t];t--);}var o=e("../core").util,s=o.buffer.toBuffer;n.fromNumber=function(e){if(e>0x8000000000000000||e<-0x8000000000000000)throw new Error(e+" is too large (or, if negative, too small) to represent as an Int64");for(var t=new Uint8Array(8),r=7,o=Math.abs(Math.round(e));r>-1&&o>0;r--,o/=256)t[r]=o;return e<0&&i(t),new n(t)},n.prototype.valueOf=function(){var e=this.bytes.slice(0),t=128&e[0];return t&&i(e),parseInt(e.toString("hex"),16)*(t?-1:1)},n.prototype.toString=function(){return String(this.valueOf())},t.exports={Int64:n}},{"../core":39}],55:[function(e,t,r){function n(e){for(var t=[],r=0;r<e.length;){var n=e.readInt32BE(r),i=e.slice(r,n+r);r+=n,t.push(i)}return t}t.exports={eventMessageChunker:n}},{}],46:[function(e,t,r){var n=e("../core");n.WebIdentityCredentials=n.util.inherit(n.Credentials,{constructor:function(e,t){n.Credentials.call(this),this.expired=!0,this.params=e,this.params.RoleSessionName=this.params.RoleSessionName||"web-identity",this.data=null,this._clientConfig=n.util.copy(t||{})},refresh:function(e){this.coalesceRefresh(e||n.util.fn.callback)},load:function(e){var t=this;t.createClients(),t.service.assumeRoleWithWebIdentity(function(r,n){t.data=null,r||(t.data=n,t.service.credentialsFrom(n,t)),e(r)})},createClients:function(){if(!this.service){var e=n.util.merge({},this._clientConfig);e.params=this.params,this.service=new n.STS(e)}}})},{"../core":39}],45:[function(e,t,r){var n=e("../core");n.TemporaryCredentials=n.util.inherit(n.Credentials,{constructor:function(e,t){n.Credentials.call(this),this.loadMasterCredentials(t),this.expired=!0,this.params=e||{},this.params.RoleArn&&(this.params.RoleSessionName=this.params.RoleSessionName||"temporary-credentials")},refresh:function(e){this.coalesceRefresh(e||n.util.fn.callback)},load:function(e){var t=this;t.createClients(),t.masterCredentials.get(function(){t.service.config.credentials=t.masterCredentials,(t.params.RoleArn?t.service.assumeRole:t.service.getSessionToken).call(t.service,function(r,n){r||t.service.credentialsFrom(n,t),e(r)})})},loadMasterCredentials:function(e){for(this.masterCredentials=e||n.config.credentials;this.masterCredentials.masterCredentials;)this.masterCredentials=this.masterCredentials.masterCredentials;"function"!=typeof this.masterCredentials.get&&(this.masterCredentials=new n.Credentials(this.masterCredentials))},createClients:function(){this.service=this.service||new n.STS({params:this.params})}})},{"../core":39}],44:[function(e,t,r){var n=e("../core");n.SAMLCredentials=n.util.inherit(n.Credentials,{constructor:function(e){n.Credentials.call(this),this.expired=!0,this.params=e},refresh:function(e){this.coalesceRefresh(e||n.util.fn.callback)},load:function(e){var t=this;t.createClients(),t.service.assumeRoleWithSAML(function(r,n){r||t.service.credentialsFrom(n,t),e(r)})},createClients:function(){this.service=this.service||new n.STS({params:this.params})}})},{"../core":39}],42:[function(e,t,r){var n=e("../core");n.CognitoIdentityCredentials=n.util.inherit(n.Credentials,{localStorageKey:{id:"aws.cognito.identity-id.",providers:"aws.cognito.identity-providers."},constructor:function(e,t){n.Credentials.call(this),this.expired=!0,this.params=e,this.data=null,this._identityId=null,this._clientConfig=n.util.copy(t||{}),this.loadCachedId();var r=this;Object.defineProperty(this,"identityId",{get:function(){return r.loadCachedId(),r._identityId||r.params.IdentityId},set:function(e){r._identityId=e}})},refresh:function(e){this.coalesceRefresh(e||n.util.fn.callback)},load:function(e){var t=this;t.createClients(),t.data=null,t._identityId=null,t.getId(function(r){r?(t.clearIdOnNotAuthorized(r),e(r)):t.params.RoleArn?t.getCredentialsFromSTS(e):t.getCredentialsForIdentity(e)})},clearCachedId:function(){this._identityId=null,delete this.params.IdentityId;var e=this.params.IdentityPoolId,t=this.params.LoginId||"";delete this.storage[this.localStorageKey.id+e+t],delete this.storage[this.localStorageKey.providers+e+t]},clearIdOnNotAuthorized:function(e){var t=this;"NotAuthorizedException"==e.code&&t.clearCachedId()},getId:function(e){var t=this;if("string"==typeof t.params.IdentityId)return e(null,t.params.IdentityId);t.cognito.getId(function(r,n){!r&&n.IdentityId?(t.params.IdentityId=n.IdentityId,e(null,n.IdentityId)):e(r)})},loadCredentials:function(e,t){e&&t&&(t.expired=!1,t.accessKeyId=e.Credentials.AccessKeyId,t.secretAccessKey=e.Credentials.SecretKey,t.sessionToken=e.Credentials.SessionToken,t.expireTime=e.Credentials.Expiration)},getCredentialsForIdentity:function(e){var t=this;t.cognito.getCredentialsForIdentity(function(r,n){r?t.clearIdOnNotAuthorized(r):(t.cacheId(n),t.data=n,t.loadCredentials(t.data,t)),e(r)})},getCredentialsFromSTS:function(e){var t=this;t.cognito.getOpenIdToken(function(r,n){r?(t.clearIdOnNotAuthorized(r),e(r)):(t.cacheId(n),t.params.WebIdentityToken=n.Token,t.webIdentityCredentials.refresh(function(r){r||(t.data=t.webIdentityCredentials.data,t.sts.credentialsFrom(t.data,t)),e(r)}))})},loadCachedId:function(){var e=this;if(n.util.isBrowser()&&!e.params.IdentityId){var t=e.getStorage("id");if(t&&e.params.Logins){var r=Object.keys(e.params.Logins);0!==(e.getStorage("providers")||"").split(",").filter(function(e){return-1!==r.indexOf(e)}).length&&(e.params.IdentityId=t)}else t&&(e.params.IdentityId=t)}},createClients:function(){var e=this._clientConfig;if(this.webIdentityCredentials=this.webIdentityCredentials||new n.WebIdentityCredentials(this.params,e),!this.cognito){var t=n.util.merge({},e);t.params=this.params,this.cognito=new n.CognitoIdentity(t)}this.sts=this.sts||new n.STS(e)},cacheId:function(e){this._identityId=e.IdentityId,this.params.IdentityId=this._identityId,n.util.isBrowser()&&(this.setStorage("id",e.IdentityId),this.params.Logins&&this.setStorage("providers",Object.keys(this.params.Logins).join(",")))},getStorage:function(e){return this.storage[this.localStorageKey[e]+this.params.IdentityPoolId+(this.params.LoginId||"")]},setStorage:function(e,t){try{this.storage[this.localStorageKey[e]+this.params.IdentityPoolId+(this.params.LoginId||"")]=t}catch(e){}},storage:function(){try{var e=n.util.isBrowser()&&null!==window.localStorage&&"object"==typeof window.localStorage?window.localStorage:{};return e["aws.test-storage"]="foobar",delete e["aws.test-storage"],e}catch(e){return{}}}()})},{"../core":39}],41:[function(e,t,r){var n=e("../core");n.ChainableTemporaryCredentials=n.util.inherit(n.Credentials,{constructor:function(e){n.Credentials.call(this),e=e||{},this.errorCode="ChainableTemporaryCredentialsProviderFailure",this.expired=!0,this.tokenCodeFn=null;var t=n.util.copy(e.params)||{};if(t.RoleArn&&(t.RoleSessionName=t.RoleSessionName||"temporary-credentials"),t.SerialNumber){if(!e.tokenCodeFn||"function"!=typeof e.tokenCodeFn)throw new n.util.error(new Error("tokenCodeFn must be a function when params.SerialNumber is given"),{code:this.errorCode});this.tokenCodeFn=e.tokenCodeFn}var r=n.util.merge({params:t,credentials:e.masterCredentials||n.config.credentials},e.stsConfig||{});this.service=new n.STS(r)},refresh:function(e){this.coalesceRefresh(e||n.util.fn.callback)},load:function(e){var t=this,r=t.service.config.params.RoleArn?"assumeRole":"getSessionToken";this.getTokenCode(function(n,i){var o={};if(n)return void e(n);i&&(o.TokenCode=i),t.service[r](o,function(r,n){r||t.service.credentialsFrom(n,t),e(r)})})},getTokenCode:function(e){var t=this;this.tokenCodeFn?this.tokenCodeFn(this.service.config.params.SerialNumber,function(r,i){if(r){var o=r;return r instanceof Error&&(o=r.message),void e(n.util.error(new Error("Error fetching MFA token: "+o),{code:t.errorCode}))}e(null,i)}):e(null)}})},{"../core":39}],29:[function(e,t,r){var n=e("./browserHmac"),i=e("./browserMd5"),o=e("./browserSha1"),s=e("./browserSha256");t.exports={createHash:function(e){if("md5"===(e=e.toLowerCase()))return new i;if("sha256"===e)return new s;if("sha1"===e)return new o;throw new Error("Hash algorithm "+e+" is not supported in the browser SDK")},createHmac:function(e,t){if("md5"===(e=e.toLowerCase()))return new n(i,t);if("sha256"===e)return new n(s,t);if("sha1"===e)return new n(o,t);throw new Error("HMAC algorithm "+e+" is not supported in the browser SDK")},createSign:function(){throw new Error("createSign is not implemented in the browser")}}},{"./browserHmac":31,"./browserMd5":32,"./browserSha1":33,"./browserSha256":34}],34:[function(e,t,r){function n(){this.state=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.temp=new Int32Array(64),this.buffer=new Uint8Array(64),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}var i=e("buffer/").Buffer,o=e("./browserHashUtils"),s=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),a=Math.pow(2,53)-1;t.exports=n,n.BLOCK_SIZE=64,n.prototype.update=function(e){if(this.finished)throw new Error("Attempted to update an already finished hash.");if(o.isEmptyData(e))return this;e=o.convertToBuffer(e);var t=0,r=e.byteLength;if(this.bytesHashed+=r,8*this.bytesHashed>a)throw new Error("Cannot hash more than 2^53 - 1 bits");for(;r>0;)this.buffer[this.bufferLength++]=e[t++],r--,64===this.bufferLength&&(this.hashBuffer(),this.bufferLength=0);return this},n.prototype.digest=function(e){if(!this.finished){var t=8*this.bytesHashed,r=new DataView(this.buffer.buffer,this.buffer.byteOffset,this.buffer.byteLength),n=this.bufferLength;if(r.setUint8(this.bufferLength++,128),n%64>=56){for(var o=this.bufferLength;o<64;o++)r.setUint8(o,0);this.hashBuffer(),this.bufferLength=0}for(var o=this.bufferLength;o<56;o++)r.setUint8(o,0);r.setUint32(56,Math.floor(t/4294967296),!0),r.setUint32(60,t),this.hashBuffer(),this.finished=!0}for(var s=new i(32),o=0;o<8;o++)s[4*o]=this.state[o]>>>24&255,s[4*o+1]=this.state[o]>>>16&255,s[4*o+2]=this.state[o]>>>8&255,s[4*o+3]=this.state[o]>>>0&255;return e?s.toString(e):s},n.prototype.hashBuffer=function(){for(var e=this,t=e.buffer,r=e.state,n=r[0],i=r[1],o=r[2],a=r[3],u=r[4],c=r[5],l=r[6],h=r[7],p=0;p<64;p++){if(p<16)this.temp[p]=(255&t[4*p])<<24|(255&t[4*p+1])<<16|(255&t[4*p+2])<<8|255&t[4*p+3];else{var f=this.temp[p-2],d=(f>>>17|f<<15)^(f>>>19|f<<13)^f>>>10;f=this.temp[p-15];var m=(f>>>7|f<<25)^(f>>>18|f<<14)^f>>>3;this.temp[p]=(d+this.temp[p-7]|0)+(m+this.temp[p-16]|0)}var v=(((u>>>6|u<<26)^(u>>>11|u<<21)^(u>>>25|u<<7))+(u&c^~u&l)|0)+(h+(s[p]+this.temp[p]|0)|0)|0,g=((n>>>2|n<<30)^(n>>>13|n<<19)^(n>>>22|n<<10))+(n&i^n&o^i&o)|0;h=l,l=c,c=u,u=a+v|0,a=o,o=i,i=n,n=v+g|0}r[0]+=n,r[1]+=i,r[2]+=o,r[3]+=a,r[4]+=u,r[5]+=c,r[6]+=l,r[7]+=h}},{"./browserHashUtils":30,"buffer/":3}],33:[function(e,t,r){function n(){this.h0=1732584193,this.h1=4023233417,this.h2=2562383102,this.h3=271733878,this.h4=3285377520,this.block=new Uint32Array(80),this.offset=0,this.shift=24,this.totalLength=0}var i=e("buffer/").Buffer,o=e("./browserHashUtils");new Uint32Array([1518500249,1859775393,-1894007588,-899497514]),Math.pow(2,53);t.exports=n,n.BLOCK_SIZE=64,n.prototype.update=function(e){if(this.finished)throw new Error("Attempted to update an already finished hash.");if(o.isEmptyData(e))return this;e=o.convertToBuffer(e);var t=e.length;this.totalLength+=8*t;for(var r=0;r<t;r++)this.write(e[r]);return this},n.prototype.write=function(e){this.block[this.offset]|=(255&e)<<this.shift,this.shift?this.shift-=8:(this.offset++,this.shift=24),16===this.offset&&this.processBlock()},n.prototype.digest=function(e){this.write(128),(this.offset>14||14===this.offset&&this.shift<24)&&this.processBlock(),this.offset=14,this.shift=24,this.write(0),this.write(0),this.write(this.totalLength>0xffffffffff?this.totalLength/1099511627776:0),this.write(this.totalLength>4294967295?this.totalLength/4294967296:0);for(var t=24;t>=0;t-=8)this.write(this.totalLength>>t);var r=new i(20),n=new DataView(r.buffer);return n.setUint32(0,this.h0,!1),n.setUint32(4,this.h1,!1),n.setUint32(8,this.h2,!1),n.setUint32(12,this.h3,!1),n.setUint32(16,this.h4,!1),e?r.toString(e):r},n.prototype.processBlock=function(){for(var e=16;e<80;e++){var t=this.block[e-3]^this.block[e-8]^this.block[e-14]^this.block[e-16];this.block[e]=t<<1|t>>>31}var r,n,i=this.h0,o=this.h1,s=this.h2,a=this.h3,u=this.h4;for(e=0;e<80;e++){e<20?(r=a^o&(s^a),n=1518500249):e<40?(r=o^s^a,n=1859775393):e<60?(r=o&s|a&(o|s),n=2400959708):(r=o^s^a,n=3395469782);var c=(i<<5|i>>>27)+r+u+n+(0|this.block[e]);u=a,a=s,s=o<<30|o>>>2,o=i,i=c}for(this.h0=this.h0+i|0,this.h1=this.h1+o|0,this.h2=this.h2+s|0,this.h3=this.h3+a|0,this.h4=this.h4+u|0,this.offset=0,e=0;e<16;e++)this.block[e]=0}},{"./browserHashUtils":30,"buffer/":3}],32:[function(e,t,r){function n(){this.state=[1732584193,4023233417,2562383102,271733878],this.buffer=new DataView(new ArrayBuffer(h)),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}function i(e,t,r,n,i,o){return((t=(t+e&4294967295)+(n+o&4294967295)&4294967295)<<i|t>>>32-i)+r&4294967295}function o(e,t,r,n,o,s,a){return i(t&r|~t&n,e,t,o,s,a)}function s(e,t,r,n,o,s,a){return i(t&n|r&~n,e,t,o,s,a)}function a(e,t,r,n,o,s,a){return i(t^r^n,e,t,o,s,a)}function u(e,t,r,n,o,s,a){return i(r^(t|~n),e,t,o,s,a)}var c=e("./browserHashUtils"),l=e("buffer/").Buffer,h=64;t.exports=n,n.BLOCK_SIZE=h,n.prototype.update=function(e){if(c.isEmptyData(e))return this;if(this.finished)throw new Error("Attempted to update an already finished hash.");var t=c.convertToBuffer(e),r=0,n=t.byteLength;for(this.bytesHashed+=n;n>0;)this.buffer.setUint8(this.bufferLength++,t[r++]),n--,this.bufferLength===h&&(this.hashBuffer(),this.bufferLength=0);return this},n.prototype.digest=function(e){if(!this.finished){var t=this,r=t.buffer,n=t.bufferLength,i=t.bytesHashed,o=8*i;if(r.setUint8(this.bufferLength++,128),n%h>=h-8){for(var s=this.bufferLength;s<h;s++)r.setUint8(s,0);this.hashBuffer(),this.bufferLength=0}for(var s=this.bufferLength;s<h-8;s++)r.setUint8(s,0);r.setUint32(h-8,o>>>0,!0),r.setUint32(h-4,Math.floor(o/4294967296),!0),this.hashBuffer(),this.finished=!0}for(var a=new DataView(new ArrayBuffer(16)),s=0;s<4;s++)a.setUint32(4*s,this.state[s],!0);var u=new l(a.buffer,a.byteOffset,a.byteLength);return e?u.toString(e):u},n.prototype.hashBuffer=function(){var e=this,t=e.buffer,r=e.state,n=r[0],i=r[1],c=r[2],l=r[3];n=o(n,i,c,l,t.getUint32(0,!0),7,3614090360),l=o(l,n,i,c,t.getUint32(4,!0),12,3905402710),c=o(c,l,n,i,t.getUint32(8,!0),17,606105819),i=o(i,c,l,n,t.getUint32(12,!0),22,3250441966),n=o(n,i,c,l,t.getUint32(16,!0),7,4118548399),l=o(l,n,i,c,t.getUint32(20,!0),12,1200080426),c=o(c,l,n,i,t.getUint32(24,!0),17,2821735955),i=o(i,c,l,n,t.getUint32(28,!0),22,4249261313),n=o(n,i,c,l,t.getUint32(32,!0),7,1770035416),l=o(l,n,i,c,t.getUint32(36,!0),12,2336552879),c=o(c,l,n,i,t.getUint32(40,!0),17,4294925233),i=o(i,c,l,n,t.getUint32(44,!0),22,2304563134),n=o(n,i,c,l,t.getUint32(48,!0),7,1804603682),l=o(l,n,i,c,t.getUint32(52,!0),12,4254626195),c=o(c,l,n,i,t.getUint32(56,!0),17,2792965006),i=o(i,c,l,n,t.getUint32(60,!0),22,1236535329),n=s(n,i,c,l,t.getUint32(4,!0),5,4129170786),l=s(l,n,i,c,t.getUint32(24,!0),9,3225465664),c=s(c,l,n,i,t.getUint32(44,!0),14,643717713),i=s(i,c,l,n,t.getUint32(0,!0),20,3921069994),n=s(n,i,c,l,t.getUint32(20,!0),5,3593408605),l=s(l,n,i,c,t.getUint32(40,!0),9,38016083),c=s(c,l,n,i,t.getUint32(60,!0),14,3634488961),i=s(i,c,l,n,t.getUint32(16,!0),20,3889429448),n=s(n,i,c,l,t.getUint32(36,!0),5,568446438),l=s(l,n,i,c,t.getUint32(56,!0),9,3275163606),c=s(c,l,n,i,t.getUint32(12,!0),14,4107603335),i=s(i,c,l,n,t.getUint32(32,!0),20,1163531501),n=s(n,i,c,l,t.getUint32(52,!0),5,2850285829),l=s(l,n,i,c,t.getUint32(8,!0),9,4243563512),c=s(c,l,n,i,t.getUint32(28,!0),14,1735328473),i=s(i,c,l,n,t.getUint32(48,!0),20,2368359562),n=a(n,i,c,l,t.getUint32(20,!0),4,4294588738),l=a(l,n,i,c,t.getUint32(32,!0),11,2272392833),c=a(c,l,n,i,t.getUint32(44,!0),16,1839030562),i=a(i,c,l,n,t.getUint32(56,!0),23,4259657740),n=a(n,i,c,l,t.getUint32(4,!0),4,2763975236),l=a(l,n,i,c,t.getUint32(16,!0),11,1272893353),c=a(c,l,n,i,t.getUint32(28,!0),16,4139469664),i=a(i,c,l,n,t.getUint32(40,!0),23,3200236656),n=a(n,i,c,l,t.getUint32(52,!0),4,681279174),l=a(l,n,i,c,t.getUint32(0,!0),11,3936430074),c=a(c,l,n,i,t.getUint32(12,!0),16,3572445317),i=a(i,c,l,n,t.getUint32(24,!0),23,76029189),n=a(n,i,c,l,t.getUint32(36,!0),4,3654602809),l=a(l,n,i,c,t.getUint32(48,!0),11,3873151461),c=a(c,l,n,i,t.getUint32(60,!0),16,530742520),i=a(i,c,l,n,t.getUint32(8,!0),23,3299628645),n=u(n,i,c,l,t.getUint32(0,!0),6,4096336452),l=u(l,n,i,c,t.getUint32(28,!0),10,1126891415),c=u(c,l,n,i,t.getUint32(56,!0),15,2878612391),i=u(i,c,l,n,t.getUint32(20,!0),21,4237533241),n=u(n,i,c,l,t.getUint32(48,!0),6,1700485571),l=u(l,n,i,c,t.getUint32(12,!0),10,2399980690),c=u(c,l,n,i,t.getUint32(40,!0),15,4293915773),i=u(i,c,l,n,t.getUint32(4,!0),21,2240044497),n=u(n,i,c,l,t.getUint32(32,!0),6,1873313359),l=u(l,n,i,c,t.getUint32(60,!0),10,4264355552),c=u(c,l,n,i,t.getUint32(24,!0),15,2734768916),i=u(i,c,l,n,t.getUint32(52,!0),21,1309151649),n=u(n,i,c,l,t.getUint32(16,!0),6,4149444226),l=u(l,n,i,c,t.getUint32(44,!0),10,3174756917),c=u(c,l,n,i,t.getUint32(8,!0),15,718787259),i=u(i,c,l,n,t.getUint32(36,!0),21,3951481745),r[0]=n+r[0]&4294967295,r[1]=i+r[1]&4294967295,r[2]=c+r[2]&4294967295,r[3]=l+r[3]&4294967295}},{"./browserHashUtils":30,"buffer/":3}],31:[function(e,t,r){function n(e,t){this.hash=new e,this.outer=new e;var r=i(e,t),n=new Uint8Array(e.BLOCK_SIZE);n.set(r);for(var o=0;o<e.BLOCK_SIZE;o++)r[o]^=54,n[o]^=92;this.hash.update(r),this.outer.update(n);for(var o=0;o<r.byteLength;o++)r[o]=0}function i(e,t){var r=o.convertToBuffer(t);if(r.byteLength>e.BLOCK_SIZE){var n=new e;n.update(r),r=n.digest()}var i=new Uint8Array(e.BLOCK_SIZE);return i.set(r),i}var o=e("./browserHashUtils");t.exports=n,n.prototype.update=function(e){if(o.isEmptyData(e)||this.error)return this;try{this.hash.update(o.convertToBuffer(e))}catch(e){this.error=e}return this},n.prototype.digest=function(e){return this.outer.finished||this.outer.update(this.hash.digest()),this.outer.digest(e)}},{"./browserHashUtils":30}],30:[function(e,t,r){function n(e){return"string"==typeof e?0===e.length:0===e.byteLength}function i(e){return"string"==typeof e&&(e=new o(e,"utf8")),ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(e)}var o=e("buffer/").Buffer;"undefined"!=typeof ArrayBuffer&&void 0===ArrayBuffer.isView&&(ArrayBuffer.isView=function(e){return s.indexOf(Object.prototype.toString.call(e))>-1});var s=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]","[object DataView]"];t.exports={isEmptyData:n,convertToBuffer:i}},{"buffer/":3}],17:[function(e,t,r){function n(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function i(e,t,r){if(e&&c(e)&&e instanceof n)return e;var i=new n;return i.parse(e,t,r),i}function o(e){return u(e)&&(e=i(e)),e instanceof n?e.format():n.prototype.format.call(e)}function s(e,t){return i(e,!1,!0).resolve(t)}function a(e,t){return e?i(e,!1,!0).resolveObject(t):t}function u(e){return"string"==typeof e}function c(e){return"object"==typeof e&&null!==e}function l(e){return null===e}function h(e){return null==e}var p=e("punycode");r.parse=i,r.resolve=s,r.resolveObject=a,r.format=o,r.Url=n;var f=/^([a-z0-9.+-]+:)/i,d=/:[0-9]*$/,m=["<",">",'"',"`"," ","\r","\n","\t"],v=["{","}","|","\\","^","`"].concat(m),g=["'"].concat(v),y=["%","/","?",";","#"].concat(g),b=["/","?","#"],w=/^[a-z0-9A-Z_-]{0,63}$/,E=/^([a-z0-9A-Z_-]{0,63})(.*)$/,_={javascript:!0,"javascript:":!0},S={javascript:!0,"javascript:":!0},C={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},x=e("querystring");n.prototype.parse=function(e,t,r){if(!u(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var n=e;n=n.trim();var i=f.exec(n);if(i){i=i[0];var o=i.toLowerCase();this.protocol=o,n=n.substr(i.length)}if(r||i||n.match(/^\/\/[^@\/]+@[^@\/]+/)){var s="//"===n.substr(0,2);!s||i&&S[i]||(n=n.substr(2),this.slashes=!0)}if(!S[i]&&(s||i&&!C[i])){for(var a=-1,c=0;c<b.length;c++){var l=n.indexOf(b[c]);-1!==l&&(-1===a||l<a)&&(a=l)}var h,d;d=-1===a?n.lastIndexOf("@"):n.lastIndexOf("@",a),-1!==d&&(h=n.slice(0,d),n=n.slice(d+1),this.auth=decodeURIComponent(h)),a=-1;for(var c=0;c<y.length;c++){var l=n.indexOf(y[c]);-1!==l&&(-1===a||l<a)&&(a=l)}-1===a&&(a=n.length),this.host=n.slice(0,a),n=n.slice(a),this.parseHost(),this.hostname=this.hostname||"";var m="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!m)for(var v=this.hostname.split(/\./),c=0,R=v.length;c<R;c++){var A=v[c];if(A&&!A.match(w)){for(var T="",k=0,I=A.length;k<I;k++)A.charCodeAt(k)>127?T+="x":T+=A[k];if(!T.match(w)){var L=v.slice(0,c),P=v.slice(c+1),q=A.match(E);q&&(L.push(q[1]),P.unshift(q[2])),P.length&&(n="/"+P.join(".")+n),this.hostname=L.join(".");break}}}if(this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),!m){for(var O=this.hostname.split("."),N=[],c=0;c<O.length;++c){var U=O[c];N.push(U.match(/[^A-Za-z0-9_-]/)?"xn--"+p.encode(U):U)}this.hostname=N.join(".")}var D=this.port?":"+this.port:"",M=this.hostname||"";this.host=M+D,this.href+=this.host,m&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==n[0]&&(n="/"+n))}if(!_[o])for(var c=0,R=g.length;c<R;c++){var j=g[c],B=encodeURIComponent(j);B===j&&(B=escape(j)),n=n.split(j).join(B)}var F=n.indexOf("#");-1!==F&&(this.hash=n.substr(F),n=n.slice(0,F));var H=n.indexOf("?");if(-1!==H?(this.search=n.substr(H),this.query=n.substr(H+1),t&&(this.query=x.parse(this.query)),n=n.slice(0,H)):t&&(this.search="",this.query={}),n&&(this.pathname=n),C[o]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var D=this.pathname||"",U=this.search||"";this.path=D+U}return this.href=this.format(),this},n.prototype.format=function(){var e=this.auth||"";e&&(e=encodeURIComponent(e),e=e.replace(/%3A/i,":"),e+="@");var t=this.protocol||"",r=this.pathname||"",n=this.hash||"",i=!1,o="";this.host?i=e+this.host:this.hostname&&(i=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&c(this.query)&&Object.keys(this.query).length&&(o=x.stringify(this.query));var s=this.search||o&&"?"+o||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||C[t])&&!1!==i?(i="//"+(i||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):i||(i=""),n&&"#"!==n.charAt(0)&&(n="#"+n),s&&"?"!==s.charAt(0)&&(s="?"+s),r=r.replace(/[?#]/g,function(e){return encodeURIComponent(e)}),s=s.replace("#","%23"),t+i+r+s+n},n.prototype.resolve=function(e){return this.resolveObject(i(e,!1,!0)).format()},n.prototype.resolveObject=function(e){if(u(e)){var t=new n;t.parse(e,!1,!0),e=t}var r=new n
    ;if(Object.keys(this).forEach(function(e){r[e]=this[e]},this),r.hash=e.hash,""===e.href)return r.href=r.format(),r;if(e.slashes&&!e.protocol)return Object.keys(e).forEach(function(t){"protocol"!==t&&(r[t]=e[t])}),C[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r;if(e.protocol&&e.protocol!==r.protocol){if(!C[e.protocol])return Object.keys(e).forEach(function(t){r[t]=e[t]}),r.href=r.format(),r;if(r.protocol=e.protocol,e.host||S[e.protocol])r.pathname=e.pathname;else{for(var i=(e.pathname||"").split("/");i.length&&!(e.host=i.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==i[0]&&i.unshift(""),i.length<2&&i.unshift(""),r.pathname=i.join("/")}if(r.search=e.search,r.query=e.query,r.host=e.host||"",r.auth=e.auth,r.hostname=e.hostname||e.host,r.port=e.port,r.pathname||r.search){var o=r.pathname||"",s=r.search||"";r.path=o+s}return r.slashes=r.slashes||e.slashes,r.href=r.format(),r}var a=r.pathname&&"/"===r.pathname.charAt(0),c=e.host||e.pathname&&"/"===e.pathname.charAt(0),p=c||a||r.host&&e.pathname,f=p,d=r.pathname&&r.pathname.split("/")||[],i=e.pathname&&e.pathname.split("/")||[],m=r.protocol&&!C[r.protocol];if(m&&(r.hostname="",r.port=null,r.host&&(""===d[0]?d[0]=r.host:d.unshift(r.host)),r.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===i[0]?i[0]=e.host:i.unshift(e.host)),e.host=null),p=p&&(""===i[0]||""===d[0])),c)r.host=e.host||""===e.host?e.host:r.host,r.hostname=e.hostname||""===e.hostname?e.hostname:r.hostname,r.search=e.search,r.query=e.query,d=i;else if(i.length)d||(d=[]),d.pop(),d=d.concat(i),r.search=e.search,r.query=e.query;else if(!h(e.search)){if(m){r.hostname=r.host=d.shift();var v=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@");v&&(r.auth=v.shift(),r.host=r.hostname=v.shift())}return r.search=e.search,r.query=e.query,l(r.pathname)&&l(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!d.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var g=d.slice(-1)[0],y=(r.host||e.host)&&("."===g||".."===g)||""===g,b=0,w=d.length;w>=0;w--)g=d[w],"."==g?d.splice(w,1):".."===g?(d.splice(w,1),b++):b&&(d.splice(w,1),b--);if(!p&&!f)for(;b--;b)d.unshift("..");!p||""===d[0]||d[0]&&"/"===d[0].charAt(0)||d.unshift(""),y&&"/"!==d.join("/").substr(-1)&&d.push("");var E=""===d[0]||d[0]&&"/"===d[0].charAt(0);if(m){r.hostname=r.host=E?"":d.length?d.shift():"";var v=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@");v&&(r.auth=v.shift(),r.host=r.hostname=v.shift())}return p=p||r.host&&d.length,p&&!E&&d.unshift(""),d.length?r.pathname=d.join("/"):(r.pathname=null,r.path=null),l(r.pathname)&&l(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=e.auth||r.auth,r.slashes=r.slashes||e.slashes,r.href=r.format(),r},n.prototype.parseHost=function(){var e=this.host,t=d.exec(e);t&&(t=t[0],":"!==t&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},{punycode:9,querystring:12}],15:[function(e,t,r){arguments[4][12][0].apply(r,arguments)},{"./decode":13,"./encode":14,dup:12}],14:[function(e,t,r){"use strict";var n=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};t.exports=function(e,t,r,i){return t=t||"&",r=r||"=",null===e&&(e=void 0),"object"==typeof e?Object.keys(e).map(function(i){var o=encodeURIComponent(n(i))+r;return Array.isArray(e[i])?e[i].map(function(e){return o+encodeURIComponent(n(e))}).join(t):o+encodeURIComponent(n(e[i]))}).join(t):i?encodeURIComponent(n(i))+r+encodeURIComponent(n(e)):""}},{}],13:[function(e,t,r){"use strict";function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.exports=function(e,t,r,i){t=t||"&",r=r||"=";var o={};if("string"!=typeof e||0===e.length)return o;var s=/\+/g;e=e.split(t);var a=1e3;i&&"number"==typeof i.maxKeys&&(a=i.maxKeys);var u=e.length;a>0&&u>a&&(u=a);for(var c=0;c<u;++c){var l,h,p,f,d=e[c].replace(s,"%20"),m=d.indexOf(r);m>=0?(l=d.substr(0,m),h=d.substr(m+1)):(l=d,h=""),p=decodeURIComponent(l),f=decodeURIComponent(h),n(o,p)?Array.isArray(o[p])?o[p].push(f):o[p]=[o[p],f]:o[p]=f}return o}},{}],12:[function(e,t,r){"use strict";r.decode=r.parse=e("./decode"),r.encode=r.stringify=e("./encode")},{"./decode":10,"./encode":11}],11:[function(e,t,r){"use strict";function n(e,t){if(e.map)return e.map(t);for(var r=[],n=0;n<e.length;n++)r.push(t(e[n],n));return r}var i=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};t.exports=function(e,t,r,a){return t=t||"&",r=r||"=",null===e&&(e=void 0),"object"==typeof e?n(s(e),function(s){var a=encodeURIComponent(i(s))+r;return o(e[s])?n(e[s],function(e){return a+encodeURIComponent(i(e))}).join(t):a+encodeURIComponent(i(e[s]))}).join(t):a?encodeURIComponent(i(a))+r+encodeURIComponent(i(e)):""};var o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},s=Object.keys||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t}},{}],10:[function(e,t,r){"use strict";function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.exports=function(e,t,r,o){t=t||"&",r=r||"=";var s={};if("string"!=typeof e||0===e.length)return s;var a=/\+/g;e=e.split(t);var u=1e3;o&&"number"==typeof o.maxKeys&&(u=o.maxKeys);var c=e.length;u>0&&c>u&&(c=u);for(var l=0;l<c;++l){var h,p,f,d,m=e[l].replace(a,"%20"),v=m.indexOf(r);v>=0?(h=m.substr(0,v),p=m.substr(v+1)):(h=m,p=""),f=decodeURIComponent(h),d=decodeURIComponent(p),n(s,f)?i(s[f])?s[f].push(d):s[f]=[s[f],d]:s[f]=d}return s};var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},{}],9:[function(e,t,r){(function(e){!function(n){function i(e){throw RangeError(q[e])}function o(e,t){for(var r=e.length,n=[];r--;)n[r]=t(e[r]);return n}function s(e,t){var r=e.split("@"),n="";return r.length>1&&(n=r[0]+"@",e=r[1]),e=e.replace(P,"."),n+o(e.split("."),t).join(".")}function a(e){for(var t,r,n=[],i=0,o=e.length;i<o;)t=e.charCodeAt(i++),t>=55296&&t<=56319&&i<o?(r=e.charCodeAt(i++),56320==(64512&r)?n.push(((1023&t)<<10)+(1023&r)+65536):(n.push(t),i--)):n.push(t);return n}function u(e){return o(e,function(e){var t="";return e>65535&&(e-=65536,t+=U(e>>>10&1023|55296),e=56320|1023&e),t+=U(e)}).join("")}function c(e){return e-48<10?e-22:e-65<26?e-65:e-97<26?e-97:_}function l(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function h(e,t,r){var n=0;for(e=r?N(e/R):e>>1,e+=N(e/t);e>O*C>>1;n+=_)e=N(e/O);return N(n+(O+1)*e/(e+x))}function p(e){var t,r,n,o,s,a,l,p,f,d,m=[],v=e.length,g=0,y=T,b=A;for(r=e.lastIndexOf(k),r<0&&(r=0),n=0;n<r;++n)e.charCodeAt(n)>=128&&i("not-basic"),m.push(e.charCodeAt(n));for(o=r>0?r+1:0;o<v;){for(s=g,a=1,l=_;o>=v&&i("invalid-input"),p=c(e.charCodeAt(o++)),(p>=_||p>N((E-g)/a))&&i("overflow"),g+=p*a,f=l<=b?S:l>=b+C?C:l-b,!(p<f);l+=_)d=_-f,a>N(E/d)&&i("overflow"),a*=d;t=m.length+1,b=h(g-s,t,0==s),N(g/t)>E-y&&i("overflow"),y+=N(g/t),g%=t,m.splice(g++,0,y)}return u(m)}function f(e){var t,r,n,o,s,u,c,p,f,d,m,v,g,y,b,w=[];for(e=a(e),v=e.length,t=T,r=0,s=A,u=0;u<v;++u)(m=e[u])<128&&w.push(U(m));for(n=o=w.length,o&&w.push(k);n<v;){for(c=E,u=0;u<v;++u)(m=e[u])>=t&&m<c&&(c=m);for(g=n+1,c-t>N((E-r)/g)&&i("overflow"),r+=(c-t)*g,t=c,u=0;u<v;++u)if(m=e[u],m<t&&++r>E&&i("overflow"),m==t){for(p=r,f=_;d=f<=s?S:f>=s+C?C:f-s,!(p<d);f+=_)b=p-d,y=_-d,w.push(U(l(d+b%y,0))),p=N(b/y);w.push(U(l(p,0))),s=h(r,g,n==o),r=0,++n}++r,++t}return w.join("")}function d(e){return s(e,function(e){return I.test(e)?p(e.slice(4).toLowerCase()):e})}function m(e){return s(e,function(e){return L.test(e)?"xn--"+f(e):e})}var v="object"==typeof r&&r&&!r.nodeType&&r,g="object"==typeof t&&t&&!t.nodeType&&t,y="object"==typeof e&&e;y.global!==y&&y.window!==y&&y.self!==y||(n=y);var b,w,E=2147483647,_=36,S=1,C=26,x=38,R=700,A=72,T=128,k="-",I=/^xn--/,L=/[^\x20-\x7E]/,P=/[\x2E\u3002\uFF0E\uFF61]/g,q={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},O=_-S,N=Math.floor,U=String.fromCharCode;if(b={version:"1.3.2",ucs2:{decode:a,encode:u},decode:p,encode:f,toASCII:m,toUnicode:d},"function"==typeof define&&"object"==typeof define.amd&&define.amd)define("punycode",function(){return b});else if(v&&g)if(t.exports==v)g.exports=b;else for(w in b)b.hasOwnProperty(w)&&(v[w]=b[w]);else n.punycode=b}(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],4:[function(e,t,r){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(e){return"function"==typeof e}function o(e){return"number"==typeof e}function s(e){return"object"==typeof e&&null!==e}function a(e){return void 0===e}t.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if(!o(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,r,n,o,u,c;if(this._events||(this._events={}),"error"===e&&(!this._events.error||s(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var l=new Error('Uncaught, unspecified "error" event. ('+t+")");throw l.context=t,l}if(r=this._events[e],a(r))return!1;if(i(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:o=Array.prototype.slice.call(arguments,1),r.apply(this,o)}else if(s(r))for(o=Array.prototype.slice.call(arguments,1),c=r.slice(),n=c.length,u=0;u<n;u++)c[u].apply(this,o);return!0},n.prototype.addListener=function(e,t){var r;if(!i(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,i(t.listener)?t.listener:t),this._events[e]?s(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,s(this._events[e])&&!this._events[e].warned&&(r=a(this._maxListeners)?n.defaultMaxListeners:this._maxListeners)&&r>0&&this._events[e].length>r&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){function r(){this.removeListener(e,r),n||(n=!0,t.apply(this,arguments))}if(!i(t))throw TypeError("listener must be a function");var n=!1;return r.listener=t,this.on(e,r),this},n.prototype.removeListener=function(e,t){var r,n,o,a;if(!i(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(r=this._events[e],o=r.length,n=-1,r===t||i(r.listener)&&r.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(s(r)){for(a=o;a-- >0;)if(r[a]===t||r[a].listener&&r[a].listener===t){n=a;break}if(n<0)return this;1===r.length?(r.length=0,delete this._events[e]):r.splice(n,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(r=this._events[e],i(r))this.removeListener(e,r);else if(r)for(;r.length;)this.removeListener(e,r[r.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){return this._events&&this._events[e]?i(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(i(t))return 1;if(t)return t.length}return 0},n.listenerCount=function(e,t){return e.listenerCount(t)}},{}],3:[function(e,t,r){(function(t,n){"use strict";function i(){return n.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function o(e,t){if(i()<t)throw new RangeError("Invalid typed array length");return n.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t),e.__proto__=n.prototype):(null===e&&(e=new n(t)),e.length=t),e}function n(e,t,r){if(!(n.TYPED_ARRAY_SUPPORT||this instanceof n))return new n(e,t,r);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return c(this,e)}return s(this,e,t,r)}function s(e,t,r,n){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?p(e,t,r,n):"string"==typeof t?l(e,t,r):f(e,t)}function a(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function u(e,t,r,n){return a(t),t<=0?o(e,t):void 0!==r?"string"==typeof n?o(e,t).fill(r,n):o(e,t).fill(r):o(e,t)}function c(e,t){if(a(t),e=o(e,t<0?0:0|d(t)),!n.TYPED_ARRAY_SUPPORT)for(var r=0;r<t;++r)e[r]=0;return e}function l(e,t,r){if("string"==typeof r&&""!==r||(r="utf8"),!n.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var i=0|v(t,r);e=o(e,i);var s=e.write(t,r);return s!==i&&(e=e.slice(0,s)),e}function h(e,t){var r=t.length<0?0:0|d(t.length);e=o(e,r);for(var n=0;n<r;n+=1)e[n]=255&t[n];return e}function p(e,t,r,i){if(t.byteLength,r<0||t.byteLength<r)throw new RangeError("'offset' is out of bounds");if(t.byteLength<r+(i||0))throw new RangeError("'length' is out of bounds");return t=void 0===r&&void 0===i?new Uint8Array(t):void 0===i?new Uint8Array(t,r):new Uint8Array(t,r,i),n.TYPED_ARRAY_SUPPORT?(e=t,e.__proto__=n.prototype):e=h(e,t),e}function f(e,t){if(n.isBuffer(t)){var r=0|d(t.length);return e=o(e,r),0===e.length?e:(t.copy(e,0,0,r),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||G(t.length)?o(e,0):h(e,t);if("Buffer"===t.type&&Q(t.data))return h(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function d(e){if(e>=i())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i().toString(16)+" bytes");return 0|e}function m(e){return+e!=e&&(e=0),n.alloc(+e)}function v(e,t){if(n.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var r=e.length;if(0===r)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return V(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return X(e).length;default:if(i)return V(e).length;t=(""+t).toLowerCase(),i=!0}}function g(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if(r>>>=0,t>>>=0,r<=t)return"";for(e||(e="utf8");;)switch(e){case"hex":return P(this,t,r);case"utf8":case"utf-8":return T(this,t,r);case"ascii":return I(this,t,r);case"latin1":case"binary":return L(this,t,r);case"base64":return A(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return q(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function y(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function b(e,t,r,i,o){if(0===e.length)return-1;if("string"==typeof r?(i=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=o?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(o)return-1;r=e.length-1}else if(r<0){if(!o)return-1;r=0}if("string"==typeof t&&(t=n.from(t,i)),n.isBuffer(t))return 0===t.length?-1:w(e,t,r,i,o);if("number"==typeof t)return t&=255,n.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):w(e,[t],r,i,o);throw new TypeError("val must be string, number or Buffer")}function w(e,t,r,n,i){function o(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}var s=1,a=e.length,u=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;s=2,a/=2,u/=2,r/=2}var c;if(i){var l=-1;for(c=r;c<a;c++)if(o(e,c)===o(t,-1===l?0:c-l)){if(-1===l&&(l=c),c-l+1===u)return l*s}else-1!==l&&(c-=c-l),l=-1}else for(r+u>a&&(r=a-u),c=r;c>=0;c--){for(var h=!0,p=0;p<u;p++)if(o(e,c+p)!==o(t,p)){h=!1;break}if(h)return c}return-1}function E(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");n>o/2&&(n=o/2);for(var s=0;s<n;++s){var a=parseInt(t.substr(2*s,2),16);if(isNaN(a))return s;e[r+s]=a}return s}function _(e,t,r,n){return Y(V(t,e.length-r),e,r,n)}function S(e,t,r,n){return Y(K(t),e,r,n)}function C(e,t,r,n){return S(e,t,r,n)}function x(e,t,r,n){return Y(X(t),e,r,n)}function R(e,t,r,n){return Y(W(t,e.length-r),e,r,n)}function A(e,t,r){return 0===t&&r===e.length?J.fromByteArray(e):J.fromByteArray(e.slice(t,r))}function T(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var o=e[i],s=null,a=o>239?4:o>223?3:o>191?2:1;if(i+a<=r){var u,c,l,h;switch(a){case 1:o<128&&(s=o);break;case 2:u=e[i+1],128==(192&u)&&(h=(31&o)<<6|63&u)>127&&(s=h);break;case 3:u=e[i+1],c=e[i+2],128==(192&u)&&128==(192&c)&&(h=(15&o)<<12|(63&u)<<6|63&c)>2047&&(h<55296||h>57343)&&(s=h);break;case 4:u=e[i+1],c=e[i+2],l=e[i+3],128==(192&u)&&128==(192&c)&&128==(192&l)&&(h=(15&o)<<18|(63&u)<<12|(63&c)<<6|63&l)>65535&&h<1114112&&(s=h)}}null===s?(s=65533,a=1):s>65535&&(s-=65536,n.push(s>>>10&1023|55296),s=56320|1023&s),n.push(s),i+=a}return k(n)}function k(e){var t=e.length;if(t<=Z)return String.fromCharCode.apply(String,e);for(var r="",n=0;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=Z));return r}function I(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function L(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function P(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var i="",o=t;o<r;++o)i+=z(e[o]);return i}function q(e,t,r){for(var n=e.slice(t,r),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function O(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function N(e,t,r,i,o,s){if(!n.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>o||t<s)throw new RangeError('"value" argument is out of bounds');if(r+i>e.length)throw new RangeError("Index out of range")}function U(e,t,r,n){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-r,2);i<o;++i)e[r+i]=(t&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function D(e,t,r,n){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-r,4);i<o;++i)e[r+i]=t>>>8*(n?i:3-i)&255}function M(e,t,r,n,i,o){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function j(e,t,r,n,i){return i||M(e,t,r,4,3.4028234663852886e38,-3.4028234663852886e38),$.write(e,t,r,n,23,4),r+4}function B(e,t,r,n,i){return i||M(e,t,r,8,1.7976931348623157e308,-1.7976931348623157e308),$.write(e,t,r,n,52,8),r+8}function F(e){if(e=H(e).replace(ee,""),e.length<2)return"";for(;e.length%4!=0;)e+="=";return e}function H(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function z(e){return e<16?"0"+e.toString(16):e.toString(16)}function V(e,t){t=t||1/0;for(var r,n=e.length,i=null,o=[],s=0;s<n;++s){if((r=e.charCodeAt(s))>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(s+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function K(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}function W(e,t){for(var r,n,i,o=[],s=0;s<e.length&&!((t-=2)<0);++s)r=e.charCodeAt(s),n=r>>8,i=r%256,o.push(i),o.push(n);return o}function X(e){return J.toByteArray(F(e))}function Y(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function G(e){return e!==e}var J=e("base64-js"),$=e("ieee754"),Q=e("isarray");r.Buffer=n,r.SlowBuffer=m,r.INSPECT_MAX_BYTES=50,n.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),r.kMaxLength=i(),n.poolSize=8192,n._augment=function(e){return e.__proto__=n.prototype,e},n.from=function(e,t,r){return s(null,e,t,r)},n.TYPED_ARRAY_SUPPORT&&(n.prototype.__proto__=Uint8Array.prototype,n.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&n[Symbol.species]===n&&Object.defineProperty(n,Symbol.species,{value:null,configurable:!0})),n.alloc=function(e,t,r){return u(null,e,t,r)},n.allocUnsafe=function(e){return c(null,e)},n.allocUnsafeSlow=function(e){return c(null,e)},n.isBuffer=function(e){return!(null==e||!e._isBuffer)},n.compare=function(e,t){if(!n.isBuffer(e)||!n.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var r=e.length,i=t.length,o=0,s=Math.min(r,i);o<s;++o)if(e[o]!==t[o]){r=e[o],i=t[o];break}return r<i?-1:i<r?1:0},n.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},n.concat=function(e,t){if(!Q(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return n.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var i=n.allocUnsafe(t),o=0;for(r=0;r<e.length;++r){var s=e[r];if(!n.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(i,o),o+=s.length}return i},n.byteLength=v,n.prototype._isBuffer=!0,n.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)y(this,t,t+1);return this},n.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)y(this,t,t+3),y(this,t+1,t+2);return this},n.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)y(this,t,t+7),y(this,t+1,t+6),y(this,t+2,t+5),y(this,t+3,t+4);return this},n.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?T(this,0,e):g.apply(this,arguments)},n.prototype.equals=function(e){if(!n.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===n.compare(this,e)},n.prototype.inspect=function(){var e="",t=r.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,t).match(/.{2}/g).join(" "),this.length>t&&(e+=" ... ")),"<Buffer "+e+">"},n.prototype.compare=function(e,t,r,i,o){if(!n.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===i&&(i=0),void 0===o&&(o=this.length),t<0||r>e.length||i<0||o>this.length)throw new RangeError("out of range index");if(i>=o&&t>=r)return 0;if(i>=o)return-1;if(t>=r)return 1;if(t>>>=0,r>>>=0,i>>>=0,o>>>=0,this===e)return 0;for(var s=o-i,a=r-t,u=Math.min(s,a),c=this.slice(i,o),l=e.slice(t,r),h=0;h<u;++h)if(c[h]!==l[h]){s=c[h],a=l[h];break}return s<a?-1:a<s?1:0},n.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},n.prototype.indexOf=function(e,t,r){return b(this,e,t,r,!0)},n.prototype.lastIndexOf=function(e,t,r){return b(this,e,t,r,!1)},n.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return E(this,e,t,r);case"utf8":case"utf-8":return _(this,e,t,r);case"ascii":return S(this,e,t,r);case"latin1":case"binary":return C(this,e,t,r);case"base64":return x(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R(this,e,t,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},n.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Z=4096;n.prototype.slice=function(e,t){var r=this.length;e=~~e,t=void 0===t?r:~~t,e<0?(e+=r)<0&&(e=0):e>r&&(e=r),t<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);var i;if(n.TYPED_ARRAY_SUPPORT)i=this.subarray(e,t),i.__proto__=n.prototype;else{var o=t-e;i=new n(o,void 0);for(var s=0;s<o;++s)i[s]=this[s+e]}return i},n.prototype.readUIntLE=function(e,t,r){e|=0,t|=0,r||O(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n},n.prototype.readUIntBE=function(e,t,r){e|=0,t|=0,r||O(e,t,this.length);for(var n=this[e+--t],i=1;t>0&&(i*=256);)n+=this[e+--t]*i;return n},n.prototype.readUInt8=function(e,t){return t||O(e,1,this.length),this[e]},n.prototype.readUInt16LE=function(e,t){return t||O(e,2,this.length),this[e]|this[e+1]<<8},n.prototype.readUInt16BE=function(e,t){return t||O(e,2,this.length),this[e]<<8|this[e+1]},n.prototype.readUInt32LE=function(e,t){return t||O(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},n.prototype.readUInt32BE=function(e,t){return t||O(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},n.prototype.readIntLE=function(e,t,r){e|=0,t|=0,r||O(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return i*=128,n>=i&&(n-=Math.pow(2,8*t)),n},n.prototype.readIntBE=function(e,t,r){e|=0,t|=0,r||O(e,t,this.length);for(var n=t,i=1,o=this[e+--n];n>0&&(i*=256);)o+=this[e+--n]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*t)),o},n.prototype.readInt8=function(e,t){return t||O(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},n.prototype.readInt16LE=function(e,t){t||O(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},n.prototype.readInt16BE=function(e,t){t||O(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},n.prototype.readInt32LE=function(e,t){return t||O(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},n.prototype.readInt32BE=function(e,t){return t||O(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},n.prototype.readFloatLE=function(e,t){return t||O(e,4,this.length),$.read(this,e,!0,23,4)},n.prototype.readFloatBE=function(e,t){return t||O(e,4,this.length),$.read(this,e,!1,23,4)},n.prototype.readDoubleLE=function(e,t){return t||O(e,8,this.length),$.read(this,e,!0,52,8)},n.prototype.readDoubleBE=function(e,t){return t||O(e,8,this.length),$.read(this,e,!1,52,8)},n.prototype.writeUIntLE=function(e,t,r,n){if(e=+e,t|=0,r|=0,!n){N(this,e,t,r,Math.pow(2,8*r)-1,0)}var i=1,o=0;for(this[t]=255&e;++o<r&&(i*=256);)this[t+o]=e/i&255;return t+r},n.prototype.writeUIntBE=function(e,t,r,n){if(e=+e,t|=0,r|=0,!n){N(this,e,t,r,Math.pow(2,8*r)-1,0)}var i=r-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+r},n.prototype.writeUInt8=function(e,t,r){return e=+e,t|=0,r||N(this,e,t,1,255,0),n.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},n.prototype.writeUInt16LE=function(e,t,r){return e=+e,t|=0,r||N(this,e,t,2,65535,0),n.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):U(this,e,t,!0),t+2},n.prototype.writeUInt16BE=function(e,t,r){return e=+e,t|=0,r||N(this,e,t,2,65535,0),n.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):U(this,e,t,!1),t+2},n.prototype.writeUInt32LE=function(e,t,r){return e=+e,t|=0,r||N(this,e,t,4,4294967295,0),n.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):D(this,e,t,!0),t+4},n.prototype.writeUInt32BE=function(e,t,r){return e=+e,t|=0,r||N(this,e,t,4,4294967295,0),n.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):D(this,e,t,!1),t+4},n.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);N(this,e,t,r,i-1,-i)}var o=0,s=1,a=0;for(this[t]=255&e;++o<r&&(s*=256);)e<0&&0===a&&0!==this[t+o-1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+r},n.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);N(this,e,t,r,i-1,-i)}var o=r-1,s=1,a=0;for(this[t+o]=255&e;--o>=0&&(s*=256);)e<0&&0===a&&0!==this[t+o+1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+r},n.prototype.writeInt8=function(e,t,r){return e=+e,t|=0,r||N(this,e,t,1,127,-128),n.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},n.prototype.writeInt16LE=function(e,t,r){return e=+e,t|=0,r||N(this,e,t,2,32767,-32768),n.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):U(this,e,t,!0),t+2},n.prototype.writeInt16BE=function(e,t,r){return e=+e,t|=0,r||N(this,e,t,2,32767,-32768),n.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):U(this,e,t,!1),t+2},n.prototype.writeInt32LE=function(e,t,r){return e=+e,t|=0,r||N(this,e,t,4,2147483647,-2147483648),n.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):D(this,e,t,!0),t+4},n.prototype.writeInt32BE=function(e,t,r){return e=+e,t|=0,r||N(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),n.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):D(this,e,t,!1),t+4},n.prototype.writeFloatLE=function(e,t,r){return j(this,e,t,!0,r)},n.prototype.writeFloatBE=function(e,t,r){return j(this,e,t,!1,r)},n.prototype.writeDoubleLE=function(e,t,r){return B(this,e,t,!0,r)},n.prototype.writeDoubleBE=function(e,t,r){return B(this,e,t,!1,r)},n.prototype.copy=function(e,t,r,i){if(r||(r=0),i||0===i||(i=this.length),t>=e.length&&(t=e.length),t||(t=0),i>0&&i<r&&(i=r),i===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-r&&(i=e.length-t+r);var o,s=i-r;if(this===e&&r<t&&t<i)for(o=s-1;o>=0;--o)e[o+t]=this[o+r];else if(s<1e3||!n.TYPED_ARRAY_SUPPORT)for(o=0;o<s;++o)e[o+t]=this[o+r];else Uint8Array.prototype.set.call(e,this.subarray(r,r+s),t);return s},n.prototype.fill=function(e,t,r,i){if("string"==typeof e){if("string"==typeof t?(i=t,t=0,r=this.length):"string"==typeof r&&(i=r,r=this.length),1===e.length){var o=e.charCodeAt(0);o<256&&(e=o)}if(void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!n.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0);var s;if("number"==typeof e)for(s=t;s<r;++s)this[s]=e;else{var a=n.isBuffer(e)?e:V(new n(e,i).toString()),u=a.length
    ;for(s=0;s<r-t;++s)this[s+t]=a[s%u]}return this};var ee=/[^+\/0-9A-Za-z-_]/g}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer)},{"base64-js":1,buffer:3,ieee754:5,isarray:6}],6:[function(e,t,r){var n={}.toString;t.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},{}],5:[function(e,t,r){r.read=function(e,t,r,n,i){var o,s,a=8*i-n-1,u=(1<<a)-1,c=u>>1,l=-7,h=r?i-1:0,p=r?-1:1,f=e[t+h];for(h+=p,o=f&(1<<-l)-1,f>>=-l,l+=a;l>0;o=256*o+e[t+h],h+=p,l-=8);for(s=o&(1<<-l)-1,o>>=-l,l+=n;l>0;s=256*s+e[t+h],h+=p,l-=8);if(0===o)o=1-c;else{if(o===u)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,n),o-=c}return(f?-1:1)*s*Math.pow(2,o-n)},r.write=function(e,t,r,n,i,o){var s,a,u,c=8*o-i-1,l=(1<<c)-1,h=l>>1,p=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=n?0:o-1,d=n?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=l):(s=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-s))<1&&(s--,u*=2),t+=s+h>=1?p/u:p*Math.pow(2,1-h),t*u>=2&&(s++,u/=2),s+h>=l?(a=0,s=l):s+h>=1?(a=(t*u-1)*Math.pow(2,i),s+=h):(a=t*Math.pow(2,h-1)*Math.pow(2,i),s=0));i>=8;e[r+f]=255&a,f+=d,a/=256,i-=8);for(s=s<<i|a,c+=i;c>0;e[r+f]=255&s,f+=d,s/=256,c-=8);e[r+f-d]|=128*m}},{}],1:[function(e,t,r){"use strict";function n(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function i(e){var t=n(e),r=t[0],i=t[1];return 3*(r+i)/4-i}function o(e,t,r){return 3*(t+r)/4-r}function s(e){var t,r,i=n(e),s=i[0],a=i[1],u=new p(o(e,s,a)),c=0,l=a>0?s-4:s;for(r=0;r<l;r+=4)t=h[e.charCodeAt(r)]<<18|h[e.charCodeAt(r+1)]<<12|h[e.charCodeAt(r+2)]<<6|h[e.charCodeAt(r+3)],u[c++]=t>>16&255,u[c++]=t>>8&255,u[c++]=255&t;return 2===a&&(t=h[e.charCodeAt(r)]<<2|h[e.charCodeAt(r+1)]>>4,u[c++]=255&t),1===a&&(t=h[e.charCodeAt(r)]<<10|h[e.charCodeAt(r+1)]<<4|h[e.charCodeAt(r+2)]>>2,u[c++]=t>>8&255,u[c++]=255&t),u}function a(e){return l[e>>18&63]+l[e>>12&63]+l[e>>6&63]+l[63&e]}function u(e,t,r){for(var n,i=[],o=t;o<r;o+=3)n=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),i.push(a(n));return i.join("")}function c(e){for(var t,r=e.length,n=r%3,i=[],o=0,s=r-n;o<s;o+=16383)i.push(u(e,o,o+16383>s?s:o+16383));return 1===n?(t=e[r-1],i.push(l[t>>2]+l[t<<4&63]+"==")):2===n&&(t=(e[r-2]<<8)+e[r-1],i.push(l[t>>10]+l[t>>4&63]+l[t<<2&63]+"=")),i.join("")}r.byteLength=i,r.toByteArray=s,r.fromByteArray=c;for(var l=[],h=[],p="undefined"!=typeof Uint8Array?Uint8Array:Array,f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",d=0,m=f.length;d<m;++d)l[d]=f[d],h[f.charCodeAt(d)]=d;h["-".charCodeAt(0)]=62,h["_".charCodeAt(0)]=63},{}]},{},[28]);AWS.apiLoader.services.cognitoidentity={},AWS.CognitoIdentity=AWS.Service.defineService("cognitoidentity",["2014-06-30"]),_xamzrequire=function e(t,n,r){function i(u,a){if(!n[u]){if(!t[u]){var c="function"==typeof _xamzrequire&&_xamzrequire;if(!a&&c)return c(u,!0);if(o)return o(u,!0);var d=new Error("Cannot find module '"+u+"'");throw d.code="MODULE_NOT_FOUND",d}var f=n[u]={exports:{}};t[u][0].call(f.exports,function(e){var n=t[u][1][e];return i(n||e)},f,f.exports,e,t,n,r)}return n[u].exports}for(var o="function"==typeof _xamzrequire&&_xamzrequire,u=0;u<r.length;u++)i(r[u]);return i}({93:[function(e,t,n){var r=e("../core");r.util.update(r.CognitoIdentity.prototype,{getOpenIdToken:function(e,t){return this.makeUnauthenticatedRequest("getOpenIdToken",e,t)},getId:function(e,t){return this.makeUnauthenticatedRequest("getId",e,t)},getCredentialsForIdentity:function(e,t){return this.makeUnauthenticatedRequest("getCredentialsForIdentity",e,t)}})},{"../core":39}]},{},[93]);AWS.apiLoader.services.cognitoidentity["2014-06-30"]={version:"2.0",metadata:{apiVersion:"2014-06-30",endpointPrefix:"cognito-identity",jsonVersion:"1.1",protocol:"json",serviceFullName:"Amazon Cognito Identity",serviceId:"Cognito Identity",signatureVersion:"v4",targetPrefix:"AWSCognitoIdentityService",uid:"cognito-identity-2014-06-30"},operations:{CreateIdentityPool:{input:{type:"structure",required:["IdentityPoolName","AllowUnauthenticatedIdentities"],members:{IdentityPoolName:{},AllowUnauthenticatedIdentities:{type:"boolean"},AllowClassicFlow:{type:"boolean"},SupportedLoginProviders:{shape:"S5"},DeveloperProviderName:{},OpenIdConnectProviderARNs:{shape:"S9"},CognitoIdentityProviders:{shape:"Sb"},SamlProviderARNs:{shape:"Sg"},IdentityPoolTags:{shape:"Sh"}}},output:{shape:"Sk"}},DeleteIdentities:{input:{type:"structure",required:["IdentityIdsToDelete"],members:{IdentityIdsToDelete:{type:"list",member:{}}}},output:{type:"structure",members:{UnprocessedIdentityIds:{type:"list",member:{type:"structure",members:{IdentityId:{},ErrorCode:{}}}}}}},DeleteIdentityPool:{input:{type:"structure",required:["IdentityPoolId"],members:{IdentityPoolId:{}}}},DescribeIdentity:{input:{type:"structure",required:["IdentityId"],members:{IdentityId:{}}},output:{shape:"Sv"}},DescribeIdentityPool:{input:{type:"structure",required:["IdentityPoolId"],members:{IdentityPoolId:{}}},output:{shape:"Sk"}},GetCredentialsForIdentity:{input:{type:"structure",required:["IdentityId"],members:{IdentityId:{},Logins:{shape:"S10"},CustomRoleArn:{}}},output:{type:"structure",members:{IdentityId:{},Credentials:{type:"structure",members:{AccessKeyId:{},SecretKey:{},SessionToken:{},Expiration:{type:"timestamp"}}}}}},GetId:{input:{type:"structure",required:["IdentityPoolId"],members:{AccountId:{},IdentityPoolId:{},Logins:{shape:"S10"}}},output:{type:"structure",members:{IdentityId:{}}}},GetIdentityPoolRoles:{input:{type:"structure",required:["IdentityPoolId"],members:{IdentityPoolId:{}}},output:{type:"structure",members:{IdentityPoolId:{},Roles:{shape:"S1c"},RoleMappings:{shape:"S1e"}}}},GetOpenIdToken:{input:{type:"structure",required:["IdentityId"],members:{IdentityId:{},Logins:{shape:"S10"}}},output:{type:"structure",members:{IdentityId:{},Token:{}}}},GetOpenIdTokenForDeveloperIdentity:{input:{type:"structure",required:["IdentityPoolId","Logins"],members:{IdentityPoolId:{},IdentityId:{},Logins:{shape:"S10"},TokenDuration:{type:"long"}}},output:{type:"structure",members:{IdentityId:{},Token:{}}}},ListIdentities:{input:{type:"structure",required:["IdentityPoolId","MaxResults"],members:{IdentityPoolId:{},MaxResults:{type:"integer"},NextToken:{},HideDisabled:{type:"boolean"}}},output:{type:"structure",members:{IdentityPoolId:{},Identities:{type:"list",member:{shape:"Sv"}},NextToken:{}}}},ListIdentityPools:{input:{type:"structure",required:["MaxResults"],members:{MaxResults:{type:"integer"},NextToken:{}}},output:{type:"structure",members:{IdentityPools:{type:"list",member:{type:"structure",members:{IdentityPoolId:{},IdentityPoolName:{}}}},NextToken:{}}}},ListTagsForResource:{input:{type:"structure",required:["ResourceArn"],members:{ResourceArn:{}}},output:{type:"structure",members:{Tags:{shape:"Sh"}}}},LookupDeveloperIdentity:{input:{type:"structure",required:["IdentityPoolId"],members:{IdentityPoolId:{},IdentityId:{},DeveloperUserIdentifier:{},MaxResults:{type:"integer"},NextToken:{}}},output:{type:"structure",members:{IdentityId:{},DeveloperUserIdentifierList:{type:"list",member:{}},NextToken:{}}}},MergeDeveloperIdentities:{input:{type:"structure",required:["SourceUserIdentifier","DestinationUserIdentifier","DeveloperProviderName","IdentityPoolId"],members:{SourceUserIdentifier:{},DestinationUserIdentifier:{},DeveloperProviderName:{},IdentityPoolId:{}}},output:{type:"structure",members:{IdentityId:{}}}},SetIdentityPoolRoles:{input:{type:"structure",required:["IdentityPoolId","Roles"],members:{IdentityPoolId:{},Roles:{shape:"S1c"},RoleMappings:{shape:"S1e"}}}},TagResource:{input:{type:"structure",required:["ResourceArn","Tags"],members:{ResourceArn:{},Tags:{shape:"Sh"}}},output:{type:"structure",members:{}}},UnlinkDeveloperIdentity:{input:{type:"structure",required:["IdentityId","IdentityPoolId","DeveloperProviderName","DeveloperUserIdentifier"],members:{IdentityId:{},IdentityPoolId:{},DeveloperProviderName:{},DeveloperUserIdentifier:{}}}},UnlinkIdentity:{input:{type:"structure",required:["IdentityId","Logins","LoginsToRemove"],members:{IdentityId:{},Logins:{shape:"S10"},LoginsToRemove:{shape:"Sw"}}}},UntagResource:{input:{type:"structure",required:["ResourceArn","TagKeys"],members:{ResourceArn:{},TagKeys:{type:"list",member:{}}}},output:{type:"structure",members:{}}},UpdateIdentityPool:{input:{shape:"Sk"},output:{shape:"Sk"}}},shapes:{S5:{type:"map",key:{},value:{}},S9:{type:"list",member:{}},Sb:{type:"list",member:{type:"structure",members:{ProviderName:{},ClientId:{},ServerSideTokenCheck:{type:"boolean"}}}},Sg:{type:"list",member:{}},Sh:{type:"map",key:{},value:{}},Sk:{type:"structure",required:["IdentityPoolId","IdentityPoolName","AllowUnauthenticatedIdentities"],members:{IdentityPoolId:{},IdentityPoolName:{},AllowUnauthenticatedIdentities:{type:"boolean"},AllowClassicFlow:{type:"boolean"},SupportedLoginProviders:{shape:"S5"},DeveloperProviderName:{},OpenIdConnectProviderARNs:{shape:"S9"},CognitoIdentityProviders:{shape:"Sb"},SamlProviderARNs:{shape:"Sg"},IdentityPoolTags:{shape:"Sh"}}},Sv:{type:"structure",members:{IdentityId:{},Logins:{shape:"Sw"},CreationDate:{type:"timestamp"},LastModifiedDate:{type:"timestamp"}}},Sw:{type:"list",member:{}},S10:{type:"map",key:{},value:{}},S1c:{type:"map",key:{},value:{}},S1e:{type:"map",key:{},value:{type:"structure",required:["Type"],members:{Type:{},AmbiguousRoleResolution:{},RulesConfiguration:{type:"structure",required:["Rules"],members:{Rules:{type:"list",member:{type:"structure",required:["Claim","MatchType","Value","RoleARN"],members:{Claim:{},MatchType:{},Value:{},RoleARN:{}}}}}}}}}},paginators:{}};AWS.apiLoader.services.lambda={},AWS.Lambda=AWS.Service.defineService("lambda",["2014-11-11","2015-03-31"]),_xamzrequire=function e(r,t,a){function n(i,u){if(!t[i]){if(!r[i]){var c="function"==typeof _xamzrequire&&_xamzrequire;if(!u&&c)return c(i,!0);if(o)return o(i,!0);var f=new Error("Cannot find module '"+i+"'");throw f.code="MODULE_NOT_FOUND",f}var d=t[i]={exports:{}};r[i][0].call(d.exports,function(e){var t=r[i][1][e];return n(t||e)},d,d.exports,e,r,t,a)}return t[i].exports}for(var o="function"==typeof _xamzrequire&&_xamzrequire,i=0;i<a.length;i++)n(a[i]);return n}({98:[function(e,r,t){var a=e("../core");a.util.update(a.Lambda.prototype,{setupRequestListeners:function(e){"invoke"===e.operation&&e.addListener("extractData",a.util.convertPayloadToString)}})},{"../core":39}]},{},[98]);AWS.apiLoader.services.lambda["2015-03-31"]={version:"2.0",metadata:{apiVersion:"2015-03-31",endpointPrefix:"lambda",protocol:"rest-json",serviceFullName:"AWS Lambda",serviceId:"Lambda",signatureVersion:"v4",uid:"lambda-2015-03-31"},operations:{AddLayerVersionPermission:{http:{requestUri:"/2018-10-31/layers/{LayerName}/versions/{VersionNumber}/policy",responseCode:201},input:{type:"structure",required:["LayerName","VersionNumber","StatementId","Action","Principal"],members:{LayerName:{location:"uri",locationName:"LayerName"},VersionNumber:{location:"uri",locationName:"VersionNumber",type:"long"},StatementId:{},Action:{},Principal:{},OrganizationId:{},RevisionId:{location:"querystring",locationName:"RevisionId"}}},output:{type:"structure",members:{Statement:{},RevisionId:{}}}},AddPermission:{http:{requestUri:"/2015-03-31/functions/{FunctionName}/policy",responseCode:201},input:{type:"structure",required:["FunctionName","StatementId","Action","Principal"],members:{FunctionName:{location:"uri",locationName:"FunctionName"},StatementId:{},Action:{},Principal:{},SourceArn:{},SourceAccount:{},EventSourceToken:{},Qualifier:{location:"querystring",locationName:"Qualifier"},RevisionId:{}}},output:{type:"structure",members:{Statement:{}}}},CreateAlias:{http:{requestUri:"/2015-03-31/functions/{FunctionName}/aliases",responseCode:201},input:{type:"structure",required:["FunctionName","Name","FunctionVersion"],members:{FunctionName:{location:"uri",locationName:"FunctionName"},Name:{},FunctionVersion:{},Description:{},RoutingConfig:{shape:"Sn"}}},output:{shape:"Sr"}},CreateEventSourceMapping:{http:{requestUri:"/2015-03-31/event-source-mappings/",responseCode:202},input:{type:"structure",required:["EventSourceArn","FunctionName"],members:{EventSourceArn:{},FunctionName:{},Enabled:{type:"boolean"},BatchSize:{type:"integer"},MaximumBatchingWindowInSeconds:{type:"integer"},ParallelizationFactor:{type:"integer"},StartingPosition:{},StartingPositionTimestamp:{type:"timestamp"},DestinationConfig:{shape:"S10"},MaximumRecordAgeInSeconds:{type:"integer"},BisectBatchOnFunctionError:{type:"boolean"},MaximumRetryAttempts:{type:"integer"}}},output:{shape:"S17"}},CreateFunction:{http:{requestUri:"/2015-03-31/functions",responseCode:201},input:{type:"structure",required:["FunctionName","Runtime","Role","Handler","Code"],members:{FunctionName:{},Runtime:{},Role:{},Handler:{},Code:{type:"structure",members:{ZipFile:{shape:"S1d"},S3Bucket:{},S3Key:{},S3ObjectVersion:{}}},Description:{},Timeout:{type:"integer"},MemorySize:{type:"integer"},Publish:{type:"boolean"},VpcConfig:{shape:"S1k"},DeadLetterConfig:{shape:"S1p"},Environment:{shape:"S1r"},KMSKeyArn:{},TracingConfig:{shape:"S1w"},Tags:{shape:"S1y"},Layers:{shape:"S21"}}},output:{shape:"S23"}},DeleteAlias:{http:{method:"DELETE",requestUri:"/2015-03-31/functions/{FunctionName}/aliases/{Name}",responseCode:204},input:{type:"structure",required:["FunctionName","Name"],members:{FunctionName:{location:"uri",locationName:"FunctionName"},Name:{location:"uri",locationName:"Name"}}}},DeleteEventSourceMapping:{http:{method:"DELETE",requestUri:"/2015-03-31/event-source-mappings/{UUID}",responseCode:202},input:{type:"structure",required:["UUID"],members:{UUID:{location:"uri",locationName:"UUID"}}},output:{shape:"S17"}},DeleteFunction:{http:{method:"DELETE",requestUri:"/2015-03-31/functions/{FunctionName}",responseCode:204},input:{type:"structure",required:["FunctionName"],members:{FunctionName:{location:"uri",locationName:"FunctionName"},Qualifier:{location:"querystring",locationName:"Qualifier"}}}},DeleteFunctionConcurrency:{http:{method:"DELETE",requestUri:"/2017-10-31/functions/{FunctionName}/concurrency",responseCode:204},input:{type:"structure",required:["FunctionName"],members:{FunctionName:{location:"uri",locationName:"FunctionName"}}}},DeleteFunctionEventInvokeConfig:{http:{method:"DELETE",requestUri:"/2019-09-25/functions/{FunctionName}/event-invoke-config",responseCode:204},input:{type:"structure",required:["FunctionName"],members:{FunctionName:{location:"uri",locationName:"FunctionName"},Qualifier:{location:"querystring",locationName:"Qualifier"}}}},DeleteLayerVersion:{http:{method:"DELETE",requestUri:"/2018-10-31/layers/{LayerName}/versions/{VersionNumber}",responseCode:204},input:{type:"structure",required:["LayerName","VersionNumber"],members:{LayerName:{location:"uri",locationName:"LayerName"},VersionNumber:{location:"uri",locationName:"VersionNumber",type:"long"}}}},DeleteProvisionedConcurrencyConfig:{http:{method:"DELETE",requestUri:"/2019-09-30/functions/{FunctionName}/provisioned-concurrency",responseCode:204},input:{type:"structure",required:["FunctionName","Qualifier"],members:{FunctionName:{location:"uri",locationName:"FunctionName"},Qualifier:{location:"querystring",locationName:"Qualifier"}}}},GetAccountSettings:{http:{method:"GET",requestUri:"/2016-08-19/account-settings/",responseCode:200},input:{type:"structure",members:{}},output:{type:"structure",members:{AccountLimit:{type:"structure",members:{TotalCodeSize:{type:"long"},CodeSizeUnzipped:{type:"long"},CodeSizeZipped:{type:"long"},ConcurrentExecutions:{type:"integer"},UnreservedConcurrentExecutions:{type:"integer"}}},AccountUsage:{type:"structure",members:{TotalCodeSize:{type:"long"},FunctionCount:{type:"long"}}}}}},GetAlias:{http:{method:"GET",requestUri:"/2015-03-31/functions/{FunctionName}/aliases/{Name}",responseCode:200},input:{type:"structure",required:["FunctionName","Name"],members:{FunctionName:{location:"uri",locationName:"FunctionName"},Name:{location:"uri",locationName:"Name"}}},output:{shape:"Sr"}},GetEventSourceMapping:{http:{method:"GET",requestUri:"/2015-03-31/event-source-mappings/{UUID}",responseCode:200},input:{type:"structure",required:["UUID"],members:{UUID:{location:"uri",locationName:"UUID"}}},output:{shape:"S17"}},GetFunction:{http:{method:"GET",requestUri:"/2015-03-31/functions/{FunctionName}",responseCode:200},input:{type:"structure",required:["FunctionName"],members:{FunctionName:{location:"uri",locationName:"FunctionName"},Qualifier:{location:"querystring",locationName:"Qualifier"}}},output:{type:"structure",members:{Configuration:{shape:"S23"},Code:{type:"structure",members:{RepositoryType:{},Location:{}}},Tags:{shape:"S1y"},Concurrency:{shape:"S34"}}}},GetFunctionConcurrency:{http:{method:"GET",requestUri:"/2019-09-30/functions/{FunctionName}/concurrency",responseCode:200},input:{type:"structure",required:["FunctionName"],members:{FunctionName:{location:"uri",locationName:"FunctionName"}}},output:{type:"structure",members:{ReservedConcurrentExecutions:{type:"integer"}}}},GetFunctionConfiguration:{http:{method:"GET",requestUri:"/2015-03-31/functions/{FunctionName}/configuration",responseCode:200},input:{type:"structure",required:["FunctionName"],members:{FunctionName:{location:"uri",locationName:"FunctionName"},Qualifier:{location:"querystring",locationName:"Qualifier"}}},output:{shape:"S23"}},GetFunctionEventInvokeConfig:{http:{method:"GET",requestUri:"/2019-09-25/functions/{FunctionName}/event-invoke-config",responseCode:200},input:{type:"structure",required:["FunctionName"],members:{FunctionName:{location:"uri",locationName:"FunctionName"},Qualifier:{location:"querystring",locationName:"Qualifier"}}},output:{shape:"S3a"}},GetLayerVersion:{http:{method:"GET",requestUri:"/2018-10-31/layers/{LayerName}/versions/{VersionNumber}",responseCode:200},input:{type:"structure",required:["LayerName","VersionNumber"],members:{LayerName:{location:"uri",locationName:"LayerName"},VersionNumber:{location:"uri",locationName:"VersionNumber",type:"long"}}},output:{shape:"S3e"}},GetLayerVersionByArn:{http:{method:"GET",requestUri:"/2018-10-31/layers?find=LayerVersion",responseCode:200},input:{type:"structure",required:["Arn"],members:{Arn:{location:"querystring",locationName:"Arn"}}},output:{shape:"S3e"}},GetLayerVersionPolicy:{http:{method:"GET",requestUri:"/2018-10-31/layers/{LayerName}/versions/{VersionNumber}/policy",responseCode:200},input:{type:"structure",required:["LayerName","VersionNumber"],members:{LayerName:{location:"uri",locationName:"LayerName"},VersionNumber:{location:"uri",locationName:"VersionNumber",type:"long"}}},output:{type:"structure",members:{Policy:{},RevisionId:{}}}},GetPolicy:{http:{method:"GET",requestUri:"/2015-03-31/functions/{FunctionName}/policy",responseCode:200},input:{type:"structure",required:["FunctionName"],members:{FunctionName:{location:"uri",locationName:"FunctionName"},Qualifier:{location:"querystring",locationName:"Qualifier"}}},output:{type:"structure",members:{Policy:{},RevisionId:{}}}},GetProvisionedConcurrencyConfig:{http:{method:"GET",requestUri:"/2019-09-30/functions/{FunctionName}/provisioned-concurrency",responseCode:200},input:{type:"structure",required:["FunctionName","Qualifier"],members:{FunctionName:{location:"uri",locationName:"FunctionName"},Qualifier:{location:"querystring",locationName:"Qualifier"}}},output:{type:"structure",members:{RequestedProvisionedConcurrentExecutions:{type:"integer"},AvailableProvisionedConcurrentExecutions:{type:"integer"},AllocatedProvisionedConcurrentExecutions:{type:"integer"},Status:{},StatusReason:{},LastModified:{}}}},Invoke:{http:{requestUri:"/2015-03-31/functions/{FunctionName}/invocations"},input:{type:"structure",required:["FunctionName"],members:{FunctionName:{location:"uri",locationName:"FunctionName"},InvocationType:{location:"header",locationName:"X-Amz-Invocation-Type"},LogType:{location:"header",locationName:"X-Amz-Log-Type"},ClientContext:{location:"header",locationName:"X-Amz-Client-Context"},Payload:{shape:"S1d"},Qualifier:{location:"querystring",locationName:"Qualifier"}},payload:"Payload"},output:{type:"structure",members:{StatusCode:{location:"statusCode",type:"integer"},FunctionError:{location:"header",locationName:"X-Amz-Function-Error"},LogResult:{location:"header",locationName:"X-Amz-Log-Result"},Payload:{shape:"S1d"},ExecutedVersion:{location:"header",locationName:"X-Amz-Executed-Version"}},payload:"Payload"}},InvokeAsync:{http:{requestUri:"/2014-11-13/functions/{FunctionName}/invoke-async/",responseCode:202},input:{type:"structure",required:["FunctionName","InvokeArgs"],members:{FunctionName:{location:"uri",locationName:"FunctionName"},InvokeArgs:{type:"blob",streaming:!0}},deprecated:!0,payload:"InvokeArgs"},output:{type:"structure",members:{Status:{location:"statusCode",type:"integer"}},deprecated:!0},deprecated:!0},ListAliases:{http:{method:"GET",requestUri:"/2015-03-31/functions/{FunctionName}/aliases",responseCode:200},input:{type:"structure",required:["FunctionName"],members:{FunctionName:{location:"uri",locationName:"FunctionName"},FunctionVersion:{location:"querystring",locationName:"FunctionVersion"},Marker:{location:"querystring",locationName:"Marker"},MaxItems:{location:"querystring",locationName:"MaxItems",type:"integer"}}},output:{type:"structure",members:{NextMarker:{},Aliases:{type:"list",member:{shape:"Sr"}}}}},ListEventSourceMappings:{http:{method:"GET",requestUri:"/2015-03-31/event-source-mappings/",responseCode:200},input:{type:"structure",members:{EventSourceArn:{location:"querystring",locationName:"EventSourceArn"},FunctionName:{location:"querystring",locationName:"FunctionName"},Marker:{location:"querystring",locationName:"Marker"},MaxItems:{location:"querystring",locationName:"MaxItems",type:"integer"}}},output:{type:"structure",members:{NextMarker:{},EventSourceMappings:{type:"list",member:{shape:"S17"}}}}},ListFunctionEventInvokeConfigs:{http:{method:"GET",requestUri:"/2019-09-25/functions/{FunctionName}/event-invoke-config/list",responseCode:200},input:{type:"structure",required:["FunctionName"],members:{FunctionName:{location:"uri",locationName:"FunctionName"},Marker:{location:"querystring",locationName:"Marker"},MaxItems:{location:"querystring",locationName:"MaxItems",type:"integer"}}},output:{type:"structure",members:{FunctionEventInvokeConfigs:{type:"list",member:{shape:"S3a"}},NextMarker:{}}}},ListFunctions:{http:{method:"GET",requestUri:"/2015-03-31/functions/",responseCode:200},input:{type:"structure",members:{MasterRegion:{location:"querystring",locationName:"MasterRegion"},FunctionVersion:{location:"querystring",locationName:"FunctionVersion"},Marker:{location:"querystring",locationName:"Marker"},MaxItems:{location:"querystring",locationName:"MaxItems",type:"integer"}}},output:{type:"structure",members:{NextMarker:{},Functions:{shape:"S4g"}}}},ListLayerVersions:{http:{method:"GET",requestUri:"/2018-10-31/layers/{LayerName}/versions",responseCode:200},input:{type:"structure",required:["LayerName"],members:{CompatibleRuntime:{location:"querystring",locationName:"CompatibleRuntime"},LayerName:{location:"uri",locationName:"LayerName"},Marker:{location:"querystring",locationName:"Marker"},MaxItems:{location:"querystring",locationName:"MaxItems",type:"integer"}}},output:{type:"structure",members:{NextMarker:{},LayerVersions:{type:"list",member:{shape:"S4l"}}}}},ListLayers:{http:{method:"GET",requestUri:"/2018-10-31/layers",responseCode:200},input:{type:"structure",members:{CompatibleRuntime:{location:"querystring",locationName:"CompatibleRuntime"},Marker:{location:"querystring",locationName:"Marker"},MaxItems:{location:"querystring",locationName:"MaxItems",type:"integer"}}},output:{type:"structure",members:{NextMarker:{},Layers:{type:"list",member:{type:"structure",members:{LayerName:{},LayerArn:{},LatestMatchingVersion:{shape:"S4l"}}}}}}},ListProvisionedConcurrencyConfigs:{http:{method:"GET",requestUri:"/2019-09-30/functions/{FunctionName}/provisioned-concurrency?List=ALL",responseCode:200},input:{type:"structure",required:["FunctionName"],members:{FunctionName:{location:"uri",locationName:"FunctionName"},Marker:{location:"querystring",locationName:"Marker"},MaxItems:{location:"querystring",locationName:"MaxItems",type:"integer"}}},output:{type:"structure",members:{ProvisionedConcurrencyConfigs:{type:"list",member:{type:"structure",members:{FunctionArn:{},RequestedProvisionedConcurrentExecutions:{type:"integer"},AvailableProvisionedConcurrentExecutions:{type:"integer"},AllocatedProvisionedConcurrentExecutions:{type:"integer"},Status:{},StatusReason:{},LastModified:{}}}},NextMarker:{}}}},ListTags:{http:{method:"GET",requestUri:"/2017-03-31/tags/{ARN}"},input:{type:"structure",required:["Resource"],members:{Resource:{location:"uri",locationName:"ARN"}}},output:{type:"structure",members:{Tags:{shape:"S1y"}}}},ListVersionsByFunction:{http:{method:"GET",requestUri:"/2015-03-31/functions/{FunctionName}/versions",responseCode:200},input:{type:"structure",required:["FunctionName"],members:{FunctionName:{location:"uri",locationName:"FunctionName"},Marker:{location:"querystring",locationName:"Marker"},MaxItems:{location:"querystring",locationName:"MaxItems",type:"integer"}}},output:{type:"structure",members:{NextMarker:{},Versions:{shape:"S4g"}}}},PublishLayerVersion:{http:{requestUri:"/2018-10-31/layers/{LayerName}/versions",responseCode:201},input:{type:"structure",required:["LayerName","Content"],members:{LayerName:{location:"uri",locationName:"LayerName"},Description:{},Content:{type:"structure",members:{S3Bucket:{},S3Key:{},S3ObjectVersion:{},ZipFile:{shape:"S1d"}}},CompatibleRuntimes:{shape:"S3h"},LicenseInfo:{}}},output:{type:"structure",members:{Content:{shape:"S3f"},LayerArn:{},LayerVersionArn:{},Description:{},CreatedDate:{},Version:{type:"long"},CompatibleRuntimes:{shape:"S3h"},LicenseInfo:{}}}},PublishVersion:{http:{requestUri:"/2015-03-31/functions/{FunctionName}/versions",responseCode:201},input:{type:"structure",required:["FunctionName"],members:{FunctionName:{location:"uri",locationName:"FunctionName"},CodeSha256:{},Description:{},RevisionId:{}}},output:{shape:"S23"}},PutFunctionConcurrency:{http:{method:"PUT",requestUri:"/2017-10-31/functions/{FunctionName}/concurrency",responseCode:200},input:{type:"structure",required:["FunctionName","ReservedConcurrentExecutions"],members:{FunctionName:{location:"uri",locationName:"FunctionName"},ReservedConcurrentExecutions:{type:"integer"}}},output:{shape:"S34"}},PutFunctionEventInvokeConfig:{http:{method:"PUT",requestUri:"/2019-09-25/functions/{FunctionName}/event-invoke-config",responseCode:200},input:{type:"structure",required:["FunctionName"],members:{FunctionName:{location:"uri",locationName:"FunctionName"},Qualifier:{location:"querystring",locationName:"Qualifier"},MaximumRetryAttempts:{type:"integer"},MaximumEventAgeInSeconds:{type:"integer"},DestinationConfig:{shape:"S10"}}},output:{shape:"S3a"}},PutProvisionedConcurrencyConfig:{http:{method:"PUT",requestUri:"/2019-09-30/functions/{FunctionName}/provisioned-concurrency",responseCode:202},input:{type:"structure",required:["FunctionName","Qualifier","ProvisionedConcurrentExecutions"],members:{FunctionName:{location:"uri",locationName:"FunctionName"},Qualifier:{location:"querystring",locationName:"Qualifier"},ProvisionedConcurrentExecutions:{type:"integer"}}},output:{type:"structure",members:{RequestedProvisionedConcurrentExecutions:{type:"integer"},AvailableProvisionedConcurrentExecutions:{type:"integer"},AllocatedProvisionedConcurrentExecutions:{type:"integer"},Status:{},StatusReason:{},LastModified:{}}}},RemoveLayerVersionPermission:{http:{method:"DELETE",requestUri:"/2018-10-31/layers/{LayerName}/versions/{VersionNumber}/policy/{StatementId}",responseCode:204},input:{type:"structure",required:["LayerName","VersionNumber","StatementId"],members:{LayerName:{location:"uri",locationName:"LayerName"},VersionNumber:{location:"uri",locationName:"VersionNumber",type:"long"},StatementId:{location:"uri",locationName:"StatementId"},RevisionId:{location:"querystring",locationName:"RevisionId"}}}},RemovePermission:{http:{method:"DELETE",requestUri:"/2015-03-31/functions/{FunctionName}/policy/{StatementId}",responseCode:204},input:{type:"structure",required:["FunctionName","StatementId"],members:{FunctionName:{location:"uri",locationName:"FunctionName"},StatementId:{location:"uri",locationName:"StatementId"},Qualifier:{location:"querystring",locationName:"Qualifier"},RevisionId:{location:"querystring",locationName:"RevisionId"}}}},TagResource:{http:{requestUri:"/2017-03-31/tags/{ARN}",responseCode:204},input:{type:"structure",required:["Resource","Tags"],members:{Resource:{location:"uri",locationName:"ARN"},Tags:{shape:"S1y"}}}},UntagResource:{http:{method:"DELETE",requestUri:"/2017-03-31/tags/{ARN}",responseCode:204},input:{type:"structure",required:["Resource","TagKeys"],members:{Resource:{location:"uri",locationName:"ARN"},TagKeys:{location:"querystring",locationName:"tagKeys",type:"list",member:{}}}}},UpdateAlias:{http:{method:"PUT",requestUri:"/2015-03-31/functions/{FunctionName}/aliases/{Name}",responseCode:200},input:{type:"structure",required:["FunctionName","Name"],members:{FunctionName:{location:"uri",locationName:"FunctionName"},Name:{location:"uri",locationName:"Name"},FunctionVersion:{},Description:{},RoutingConfig:{shape:"Sn"},RevisionId:{}}},output:{shape:"Sr"}},UpdateEventSourceMapping:{http:{method:"PUT",requestUri:"/2015-03-31/event-source-mappings/{UUID}",responseCode:202},input:{type:"structure",required:["UUID"],members:{UUID:{location:"uri",locationName:"UUID"},FunctionName:{},Enabled:{type:"boolean"},BatchSize:{type:"integer"},MaximumBatchingWindowInSeconds:{type:"integer"},DestinationConfig:{shape:"S10"},MaximumRecordAgeInSeconds:{type:"integer"},BisectBatchOnFunctionError:{type:"boolean"},MaximumRetryAttempts:{type:"integer"},ParallelizationFactor:{type:"integer"}}},output:{shape:"S17"}},UpdateFunctionCode:{http:{method:"PUT",requestUri:"/2015-03-31/functions/{FunctionName}/code",responseCode:200},input:{type:"structure",required:["FunctionName"],members:{FunctionName:{location:"uri",locationName:"FunctionName"},ZipFile:{shape:"S1d"},S3Bucket:{},S3Key:{},S3ObjectVersion:{},Publish:{type:"boolean"},DryRun:{type:"boolean"},RevisionId:{}}},output:{shape:"S23"}},UpdateFunctionConfiguration:{http:{method:"PUT",requestUri:"/2015-03-31/functions/{FunctionName}/configuration",responseCode:200},input:{type:"structure",required:["FunctionName"],members:{FunctionName:{location:"uri",locationName:"FunctionName"},Role:{},Handler:{},Description:{},Timeout:{type:"integer"},MemorySize:{type:"integer"},VpcConfig:{shape:"S1k"},Environment:{shape:"S1r"},Runtime:{},DeadLetterConfig:{shape:"S1p"},KMSKeyArn:{},TracingConfig:{shape:"S1w"},RevisionId:{},Layers:{shape:"S21"}}},output:{shape:"S23"}},UpdateFunctionEventInvokeConfig:{http:{requestUri:"/2019-09-25/functions/{FunctionName}/event-invoke-config",responseCode:200},input:{type:"structure",required:["FunctionName"],members:{FunctionName:{location:"uri",locationName:"FunctionName"},Qualifier:{location:"querystring",locationName:"Qualifier"},MaximumRetryAttempts:{type:"integer"},MaximumEventAgeInSeconds:{type:"integer"},DestinationConfig:{shape:"S10"}}},output:{shape:"S3a"}}},shapes:{Sn:{type:"structure",members:{AdditionalVersionWeights:{type:"map",key:{},value:{type:"double"}}}},Sr:{type:"structure",members:{AliasArn:{},Name:{},FunctionVersion:{},Description:{},RoutingConfig:{shape:"Sn"},RevisionId:{}}},S10:{type:"structure",members:{OnSuccess:{type:"structure",members:{Destination:{}}},OnFailure:{type:"structure",members:{Destination:{}}}}},S17:{type:"structure",members:{UUID:{},BatchSize:{type:"integer"},MaximumBatchingWindowInSeconds:{type:"integer"},ParallelizationFactor:{type:"integer"},EventSourceArn:{},FunctionArn:{},LastModified:{type:"timestamp"},LastProcessingResult:{},State:{},StateTransitionReason:{},DestinationConfig:{shape:"S10"},MaximumRecordAgeInSeconds:{type:"integer"},BisectBatchOnFunctionError:{type:"boolean"},MaximumRetryAttempts:{type:"integer"}}},S1d:{type:"blob",sensitive:!0},S1k:{type:"structure",members:{SubnetIds:{shape:"S1l"},SecurityGroupIds:{shape:"S1n"}}},S1l:{type:"list",member:{}},S1n:{type:"list",member:{}},S1p:{type:"structure",members:{TargetArn:{}}},S1r:{type:"structure",members:{Variables:{shape:"S1s"}}},S1s:{type:"map",key:{type:"string",sensitive:!0},value:{type:"string",sensitive:!0},sensitive:!0},S1w:{type:"structure",members:{Mode:{}}},S1y:{type:"map",key:{},value:{}},S21:{type:"list",member:{}},S23:{type:"structure",members:{FunctionName:{},FunctionArn:{},Runtime:{},Role:{},Handler:{},CodeSize:{type:"long"},Description:{},Timeout:{type:"integer"},MemorySize:{type:"integer"},LastModified:{},CodeSha256:{},Version:{},VpcConfig:{type:"structure",members:{SubnetIds:{shape:"S1l"},SecurityGroupIds:{shape:"S1n"},VpcId:{}}},DeadLetterConfig:{shape:"S1p"},Environment:{type:"structure",members:{Variables:{shape:"S1s"},Error:{type:"structure",members:{ErrorCode:{},Message:{type:"string",sensitive:!0}}}}},KMSKeyArn:{},TracingConfig:{type:"structure",members:{Mode:{}}},MasterArn:{},RevisionId:{},Layers:{type:"list",member:{type:"structure",members:{Arn:{},CodeSize:{type:"long"}}}},State:{},StateReason:{},StateReasonCode:{},LastUpdateStatus:{},LastUpdateStatusReason:{},LastUpdateStatusReasonCode:{}}},S34:{type:"structure",members:{ReservedConcurrentExecutions:{type:"integer"}}},S3a:{type:"structure",members:{LastModified:{type:"timestamp"},FunctionArn:{},MaximumRetryAttempts:{type:"integer"},MaximumEventAgeInSeconds:{type:"integer"},DestinationConfig:{shape:"S10"}}},S3e:{type:"structure",members:{Content:{shape:"S3f"},LayerArn:{},LayerVersionArn:{},Description:{},CreatedDate:{},Version:{type:"long"},CompatibleRuntimes:{shape:"S3h"},LicenseInfo:{}}},S3f:{type:"structure",members:{Location:{},CodeSha256:{},CodeSize:{type:"long"}}},S3h:{type:"list",member:{}},S4g:{type:"list",member:{shape:"S23"}},S4l:{type:"structure",members:{LayerVersionArn:{},Version:{type:"long"},Description:{},CreatedDate:{},CompatibleRuntimes:{shape:"S3h"},LicenseInfo:{}}}},paginators:{ListAliases:{input_token:"Marker",limit_key:"MaxItems",output_token:"NextMarker",result_key:"Aliases"},ListEventSourceMappings:{input_token:"Marker",limit_key:"MaxItems",output_token:"NextMarker",result_key:"EventSourceMappings"},ListFunctionEventInvokeConfigs:{input_token:"Marker",limit_key:"MaxItems",output_token:"NextMarker",result_key:"FunctionEventInvokeConfigs"},ListFunctions:{input_token:"Marker",limit_key:"MaxItems",output_token:"NextMarker",result_key:"Functions"},ListLayerVersions:{input_token:"Marker",limit_key:"MaxItems",output_token:"NextMarker",result_key:"LayerVersions"},ListLayers:{input_token:"Marker",limit_key:"MaxItems",output_token:"NextMarker",result_key:"Layers"},ListProvisionedConcurrencyConfigs:{input_token:"Marker",limit_key:"MaxItems",output_token:"NextMarker",result_key:"ProvisionedConcurrencyConfigs"},ListVersionsByFunction:{input_token:"Marker",limit_key:"MaxItems",output_token:"NextMarker",result_key:"Versions"}},waiters:{FunctionExists:{delay:1,operation:"GetFunction",maxAttempts:20,acceptors:[{state:"success",matcher:"status",expected:200},{state:"retry",matcher:"error",expected:"ResourceNotFoundException"}]},FunctionActive:{delay:5,maxAttempts:60,operation:"GetFunctionConfiguration",description:"Waits for the function's State to be Active.",acceptors:[{state:"success",matcher:"path",argument:"State",expected:"Active"},{state:"failure",matcher:"path",argument:"State",expected:"Failed"},{state:"retry",matcher:"path",argument:"State",expected:"Pending"}]},FunctionUpdated:{delay:5,maxAttempts:60,operation:"GetFunctionConfiguration",description:"Waits for the function's LastUpdateStatus to be Successful.",acceptors:[{state:"success",matcher:"path",argument:"LastUpdateStatus",expected:"Successful"},{state:"failure",matcher:"path",argument:"LastUpdateStatus",expected:"Failed"},{state:"retry",matcher:"path",argument:"LastUpdateStatus",expected:"InProgress"}]}}};AWS.apiLoader.services.sts={},AWS.STS=AWS.Service.defineService("sts",["2011-06-15"]),_xamzrequire=function e(n,i,t){function r(s,a){if(!i[s]){if(!n[s]){var u="function"==typeof _xamzrequire&&_xamzrequire;if(!a&&u)return u(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var d=i[s]={exports:{}};n[s][0].call(d.exports,function(e){var i=n[s][1][e];return r(i||e)},d,d.exports,e,n,i,t)}return i[s].exports}for(var o="function"==typeof _xamzrequire&&_xamzrequire,s=0;s<t.length;s++)r(t[s]);return r}({107:[function(e,n,i){var t=e("../core"),r=e("../config_regional_endpoint");t.util.update(t.STS.prototype,{credentialsFrom:function(e,n){return e?(n||(n=new t.TemporaryCredentials),n.expired=!1,n.accessKeyId=e.Credentials.AccessKeyId,n.secretAccessKey=e.Credentials.SecretAccessKey,n.sessionToken=e.Credentials.SessionToken,n.expireTime=e.Credentials.Expiration,n):null},assumeRoleWithWebIdentity:function(e,n){return this.makeUnauthenticatedRequest("assumeRoleWithWebIdentity",e,n)},assumeRoleWithSAML:function(e,n){return this.makeUnauthenticatedRequest("assumeRoleWithSAML",e,n)},setupRequestListeners:function(e){e.addListener("validate",this.optInRegionalEndpoint,!0)},optInRegionalEndpoint:function(e){var n=e.service,i=n.config;if(i.stsRegionalEndpoints=r(n._originalConfig,{env:"AWS_STS_REGIONAL_ENDPOINTS",sharedConfig:"sts_regional_endpoints",clientConfig:"stsRegionalEndpoints"}),"regional"===i.stsRegionalEndpoints&&n.isGlobalEndpoint){if(!i.region)throw t.util.error(new Error,{code:"ConfigError",message:"Missing region in config"});var o=i.endpoint.indexOf(".amazonaws.com"),s=i.endpoint.substring(0,o)+"."+i.region+i.endpoint.substring(o);e.httpRequest.updateEndpoint(s),e.httpRequest.region=i.region}}})},{"../config_regional_endpoint":38,"../core":39}]},{},[107]);AWS.apiLoader.services.sts["2011-06-15"]={version:"2.0",metadata:{apiVersion:"2011-06-15",endpointPrefix:"sts",globalEndpoint:"sts.amazonaws.com",protocol:"query",serviceAbbreviation:"AWS STS",serviceFullName:"AWS Security Token Service",serviceId:"STS",signatureVersion:"v4",uid:"sts-2011-06-15",xmlNamespace:"https://sts.amazonaws.com/doc/2011-06-15/"},operations:{AssumeRole:{input:{type:"structure",required:["RoleArn","RoleSessionName"],members:{RoleArn:{},RoleSessionName:{},PolicyArns:{shape:"S4"},Policy:{},DurationSeconds:{type:"integer"},Tags:{shape:"S8"},TransitiveTagKeys:{type:"list",member:{}},ExternalId:{},SerialNumber:{},TokenCode:{}}},output:{resultWrapper:"AssumeRoleResult",type:"structure",members:{Credentials:{shape:"Sh"},AssumedRoleUser:{shape:"Sm"},PackedPolicySize:{type:"integer"}}}},AssumeRoleWithSAML:{input:{type:"structure",required:["RoleArn","PrincipalArn","SAMLAssertion"],members:{RoleArn:{},PrincipalArn:{},SAMLAssertion:{},PolicyArns:{shape:"S4"},Policy:{},DurationSeconds:{type:"integer"}}},output:{resultWrapper:"AssumeRoleWithSAMLResult",type:"structure",members:{Credentials:{shape:"Sh"},AssumedRoleUser:{shape:"Sm"},PackedPolicySize:{type:"integer"},Subject:{},SubjectType:{},Issuer:{},Audience:{},NameQualifier:{}}}},AssumeRoleWithWebIdentity:{input:{type:"structure",required:["RoleArn","RoleSessionName","WebIdentityToken"],members:{RoleArn:{},RoleSessionName:{},WebIdentityToken:{},ProviderId:{},PolicyArns:{shape:"S4"},Policy:{},DurationSeconds:{type:"integer"}}},output:{resultWrapper:"AssumeRoleWithWebIdentityResult",type:"structure",members:{Credentials:{shape:"Sh"},SubjectFromWebIdentityToken:{},AssumedRoleUser:{shape:"Sm"},PackedPolicySize:{type:"integer"},Provider:{},Audience:{}}}},DecodeAuthorizationMessage:{input:{type:"structure",required:["EncodedMessage"],members:{EncodedMessage:{}}},output:{resultWrapper:"DecodeAuthorizationMessageResult",type:"structure",members:{DecodedMessage:{}}}},GetAccessKeyInfo:{input:{type:"structure",required:["AccessKeyId"],members:{AccessKeyId:{}}},output:{resultWrapper:"GetAccessKeyInfoResult",type:"structure",members:{Account:{}}}},GetCallerIdentity:{input:{type:"structure",members:{}},output:{resultWrapper:"GetCallerIdentityResult",type:"structure",members:{UserId:{},Account:{},Arn:{}}}},GetFederationToken:{input:{type:"structure",required:["Name"],members:{Name:{},Policy:{},PolicyArns:{shape:"S4"},DurationSeconds:{type:"integer"},Tags:{shape:"S8"}}},output:{resultWrapper:"GetFederationTokenResult",type:"structure",members:{Credentials:{shape:"Sh"},FederatedUser:{type:"structure",required:["FederatedUserId","Arn"],members:{FederatedUserId:{},Arn:{}}},PackedPolicySize:{type:"integer"}}}},GetSessionToken:{input:{type:"structure",members:{DurationSeconds:{type:"integer"},SerialNumber:{},TokenCode:{}}},output:{resultWrapper:"GetSessionTokenResult",type:"structure",members:{Credentials:{shape:"Sh"}}}}},shapes:{S4:{type:"list",member:{type:"structure",members:{arn:{}}}},S8:{type:"list",member:{type:"structure",required:["Key","Value"],members:{Key:{},Value:{}}}},Sh:{type:"structure",required:["AccessKeyId","SecretAccessKey","SessionToken","Expiration"],members:{AccessKeyId:{},SecretAccessKey:{},SessionToken:{},Expiration:{type:"timestamp"}}},Sm:{type:"structure",required:["AssumedRoleId","Arn"],members:{AssumedRoleId:{},Arn:{}}}},paginators:{}};;
/*! @license DOMPurify | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.0.8/LICENSE */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).DOMPurify=t()}(this,(function(){"use strict";var e=Object.hasOwnProperty,t=Object.setPrototypeOf,n=Object.isFrozen,r=Object.keys,o=Object.freeze,i=Object.seal,a="undefined"!=typeof Reflect&&Reflect,l=a.apply,c=a.construct;l||(l=function(e,t,n){return e.apply(t,n)}),o||(o=function(e){return e}),i||(i=function(e){return e}),c||(c=function(e,t){return new(Function.prototype.bind.apply(e,[null].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(t))))});var s=S(Array.prototype.forEach),u=S(Array.prototype.indexOf),d=S(Array.prototype.join),f=S(Array.prototype.pop),p=S(Array.prototype.push),m=S(Array.prototype.slice),y=S(String.prototype.toLowerCase),g=S(String.prototype.match),h=S(String.prototype.replace),v=S(String.prototype.indexOf),b=S(String.prototype.trim),T=S(RegExp.prototype.test),A=k(RegExp),x=k(TypeError);function S(e){return function(t){for(var n=arguments.length,r=Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return l(e,t,r)}}function k(e){return function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return c(e,n)}}function L(e,r){t&&t(e,null);for(var o=r.length;o--;){var i=r[o];if("string"==typeof i){var a=y(i);a!==i&&(n(r)||(r[o]=a),i=a)}e[i]=!0}return e}function _(t){var n={},r=void 0;for(r in t)l(e,t,[r])&&(n[r]=t[r]);return n}var E=o(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),M=o(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","audio","canvas","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","video","view","vkern"]),D=o(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),R=o(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),N=o(["#text"]),O=o(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns"]),w=o(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","tabindex","targetx","targety","transform","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),H=o(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),C=o(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),F=i(/\{\{[\s\S]*|[\s\S]*\}\}/gm),z=i(/<%[\s\S]*|[\s\S]*%>/gm),I=i(/^data-[\-\w.\u00B7-\uFFFF]/),U=i(/^aria-[\-\w]+$/),j=i(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),P=i(/^(?:\w+script|data):/i),G=i(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g),W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function B(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var q=function(){return"undefined"==typeof window?null:window},K=function(e,t){if("object"!==(void 0===e?"undefined":W(e))||"function"!=typeof e.createPolicy)return null;var n=null;t.currentScript&&t.currentScript.hasAttribute("data-tt-policy-suffix")&&(n=t.currentScript.getAttribute("data-tt-policy-suffix"));var r="dompurify"+(n?"#"+n:"");try{return e.createPolicy(r,{createHTML:function(e){return e}})}catch(e){return console.warn("TrustedTypes policy "+r+" could not be created."),null}};return function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:q(),n=function(t){return e(t)};if(n.version="2.0.10",n.removed=[],!t||!t.document||9!==t.document.nodeType)return n.isSupported=!1,n;var i=t.document,a=!1,l=t.document,c=t.DocumentFragment,S=t.HTMLTemplateElement,k=t.Node,V=t.NodeFilter,Y=t.NamedNodeMap,X=void 0===Y?t.NamedNodeMap||t.MozNamedAttrMap:Y,$=t.Text,J=t.Comment,Q=t.DOMParser,Z=t.trustedTypes;if("function"==typeof S){var ee=l.createElement("template");ee.content&&ee.content.ownerDocument&&(l=ee.content.ownerDocument)}var te=K(Z,i),ne=te?te.createHTML(""):"",re=l,oe=re.implementation,ie=re.createNodeIterator,ae=re.getElementsByTagName,le=re.createDocumentFragment,ce=i.importNode,se={};n.isSupported=oe&&void 0!==oe.createHTMLDocument&&9!==l.documentMode;var ue=F,de=z,fe=I,pe=U,me=P,ye=G,ge=j,he=null,ve=L({},[].concat(B(E),B(M),B(D),B(R),B(N))),be=null,Te=L({},[].concat(B(O),B(w),B(H),B(C))),Ae=null,xe=null,Se=!0,ke=!0,Le=!1,_e=!1,Ee=!1,Me=!1,De=!1,Re=!1,Ne=!1,Oe=!1,we=!1,He=!1,Ce=!0,Fe=!0,ze=!1,Ie={},Ue=L({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","plaintext","script","style","svg","template","thead","title","video","xmp"]),je=null,Pe=L({},["audio","video","img","source","image","track"]),Ge=null,We=L({},["alt","class","for","id","label","name","pattern","placeholder","summary","title","value","style","xmlns"]),Be=null,qe=l.createElement("form"),Ke=function(e){Be&&Be===e||(e&&"object"===(void 0===e?"undefined":W(e))||(e={}),he="ALLOWED_TAGS"in e?L({},e.ALLOWED_TAGS):ve,be="ALLOWED_ATTR"in e?L({},e.ALLOWED_ATTR):Te,Ge="ADD_URI_SAFE_ATTR"in e?L(_(We),e.ADD_URI_SAFE_ATTR):We,je="ADD_DATA_URI_TAGS"in e?L(_(Pe),e.ADD_DATA_URI_TAGS):Pe,Ae="FORBID_TAGS"in e?L({},e.FORBID_TAGS):{},xe="FORBID_ATTR"in e?L({},e.FORBID_ATTR):{},Ie="USE_PROFILES"in e&&e.USE_PROFILES,Se=!1!==e.ALLOW_ARIA_ATTR,ke=!1!==e.ALLOW_DATA_ATTR,Le=e.ALLOW_UNKNOWN_PROTOCOLS||!1,_e=e.SAFE_FOR_JQUERY||!1,Ee=e.SAFE_FOR_TEMPLATES||!1,Me=e.WHOLE_DOCUMENT||!1,Ne=e.RETURN_DOM||!1,Oe=e.RETURN_DOM_FRAGMENT||!1,we=e.RETURN_DOM_IMPORT||!1,He=e.RETURN_TRUSTED_TYPE||!1,Re=e.FORCE_BODY||!1,Ce=!1!==e.SANITIZE_DOM,Fe=!1!==e.KEEP_CONTENT,ze=e.IN_PLACE||!1,ge=e.ALLOWED_URI_REGEXP||ge,Ee&&(ke=!1),Oe&&(Ne=!0),Ie&&(he=L({},[].concat(B(N))),be=[],!0===Ie.html&&(L(he,E),L(be,O)),!0===Ie.svg&&(L(he,M),L(be,w),L(be,C)),!0===Ie.svgFilters&&(L(he,D),L(be,w),L(be,C)),!0===Ie.mathMl&&(L(he,R),L(be,H),L(be,C))),e.ADD_TAGS&&(he===ve&&(he=_(he)),L(he,e.ADD_TAGS)),e.ADD_ATTR&&(be===Te&&(be=_(be)),L(be,e.ADD_ATTR)),e.ADD_URI_SAFE_ATTR&&L(Ge,e.ADD_URI_SAFE_ATTR),Fe&&(he["#text"]=!0),Me&&L(he,["html","head","body"]),he.table&&(L(he,["tbody"]),delete Ae.tbody),o&&o(e),Be=e)},Ve=function(e){p(n.removed,{element:e});try{e.parentNode.removeChild(e)}catch(t){e.outerHTML=ne}},Ye=function(e,t){try{p(n.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){p(n.removed,{attribute:null,from:t})}t.removeAttribute(e)},Xe=function(e){var t=void 0,n=void 0;if(Re)e="<remove></remove>"+e;else{var r=g(e,/^[\s]+/);n=r&&r[0]}var o=te?te.createHTML(e):e;try{t=(new Q).parseFromString(o,"text/html")}catch(e){}if(a&&L(Ae,["title"]),!t||!t.documentElement){var i=(t=oe.createHTMLDocument("")).body;i.parentNode.removeChild(i.parentNode.firstElementChild),i.outerHTML=o}return e&&n&&t.body.insertBefore(l.createTextNode(n),t.body.childNodes[0]||null),ae.call(t,Me?"html":"body")[0]};n.isSupported&&function(){try{var e=Xe("<x/><title>&lt;/title&gt;&lt;img&gt;");T(/<\/title/,e.querySelector("title").innerHTML)&&(a=!0)}catch(e){}}();var $e=function(e){return ie.call(e.ownerDocument||e,e,V.SHOW_ELEMENT|V.SHOW_COMMENT|V.SHOW_TEXT,(function(){return V.FILTER_ACCEPT}),!1)},Je=function(e){return!(e instanceof $||e instanceof J)&&!("string"==typeof e.nodeName&&"string"==typeof e.textContent&&"function"==typeof e.removeChild&&e.attributes instanceof X&&"function"==typeof e.removeAttribute&&"function"==typeof e.setAttribute&&"string"==typeof e.namespaceURI)},Qe=function(e){return"object"===(void 0===k?"undefined":W(k))?e instanceof k:e&&"object"===(void 0===e?"undefined":W(e))&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName},Ze=function(e,t,r){se[e]&&s(se[e],(function(e){e.call(n,t,r,Be)}))},et=function(e){var t=void 0;if(Ze("beforeSanitizeElements",e,null),Je(e))return Ve(e),!0;var r=y(e.nodeName);if(Ze("uponSanitizeElement",e,{tagName:r,allowedTags:he}),("svg"===r||"math"===r)&&0!==e.querySelectorAll("p, br").length)return Ve(e),!0;if(!he[r]||Ae[r]){if(Fe&&!Ue[r]&&"function"==typeof e.insertAdjacentHTML)try{var o=e.innerHTML;e.insertAdjacentHTML("AfterEnd",te?te.createHTML(o):o)}catch(e){}return Ve(e),!0}return"noscript"===r&&T(/<\/noscript/i,e.innerHTML)||"noembed"===r&&T(/<\/noembed/i,e.innerHTML)?(Ve(e),!0):(!_e||e.firstElementChild||e.content&&e.content.firstElementChild||!T(/</g,e.textContent)||(p(n.removed,{element:e.cloneNode()}),e.innerHTML?e.innerHTML=h(e.innerHTML,/</g,"&lt;"):e.innerHTML=h(e.textContent,/</g,"&lt;")),Ee&&3===e.nodeType&&(t=e.textContent,t=h(t,ue," "),t=h(t,de," "),e.textContent!==t&&(p(n.removed,{element:e.cloneNode()}),e.textContent=t)),Ze("afterSanitizeElements",e,null),!1)},tt=function(e,t,n){if(Ce&&("id"===t||"name"===t)&&(n in l||n in qe))return!1;if(ke&&T(fe,t));else if(Se&&T(pe,t));else{if(!be[t]||xe[t])return!1;if(Ge[t]);else if(T(ge,h(n,ye,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==v(n,"data:")||!je[e]){if(Le&&!T(me,h(n,ye,"")));else if(n)return!1}else;}return!0},nt=function(e){var t=void 0,o=void 0,i=void 0,a=void 0,l=void 0;Ze("beforeSanitizeAttributes",e,null);var c=e.attributes;if(c){var s={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:be};for(l=c.length;l--;){var p=t=c[l],g=p.name,v=p.namespaceURI;if(o=b(t.value),i=y(g),s.attrName=i,s.attrValue=o,s.keepAttr=!0,s.forceKeepAttr=void 0,Ze("uponSanitizeAttribute",e,s),o=s.attrValue,!s.forceKeepAttr){if("name"===i&&"IMG"===e.nodeName&&c.id)a=c.id,c=m(c,[]),Ye("id",e),Ye(g,e),u(c,a)>l&&e.setAttribute("id",a.value);else{if("INPUT"===e.nodeName&&"type"===i&&"file"===o&&s.keepAttr&&(be[i]||!xe[i]))continue;"id"===g&&e.setAttribute(g,""),Ye(g,e)}if(s.keepAttr)if(_e&&T(/\/>/i,o))Ye(g,e);else if(T(/svg|math/i,e.namespaceURI)&&T(A("</("+d(r(Ue),"|")+")","i"),o))Ye(g,e);else{Ee&&(o=h(o,ue," "),o=h(o,de," "));var x=e.nodeName.toLowerCase();if(tt(x,i,o))try{v?e.setAttributeNS(v,g,o):e.setAttribute(g,o),f(n.removed)}catch(e){}}}}Ze("afterSanitizeAttributes",e,null)}},rt=function e(t){var n=void 0,r=$e(t);for(Ze("beforeSanitizeShadowDOM",t,null);n=r.nextNode();)Ze("uponSanitizeShadowNode",n,null),et(n)||(n.content instanceof c&&e(n.content),nt(n));Ze("afterSanitizeShadowDOM",t,null)};return n.sanitize=function(e,r){var o=void 0,a=void 0,l=void 0,s=void 0,u=void 0;if(e||(e="\x3c!--\x3e"),"string"!=typeof e&&!Qe(e)){if("function"!=typeof e.toString)throw x("toString is not a function");if("string"!=typeof(e=e.toString()))throw x("dirty is not a string, aborting")}if(!n.isSupported){if("object"===W(t.toStaticHTML)||"function"==typeof t.toStaticHTML){if("string"==typeof e)return t.toStaticHTML(e);if(Qe(e))return t.toStaticHTML(e.outerHTML)}return e}if(De||Ke(r),n.removed=[],"string"==typeof e&&(ze=!1),ze);else if(e instanceof k)1===(a=(o=Xe("\x3c!--\x3e")).ownerDocument.importNode(e,!0)).nodeType&&"BODY"===a.nodeName||"HTML"===a.nodeName?o=a:o.appendChild(a);else{if(!Ne&&!Ee&&!Me&&He&&-1===e.indexOf("<"))return te?te.createHTML(e):e;if(!(o=Xe(e)))return Ne?null:ne}o&&Re&&Ve(o.firstChild);for(var d=$e(ze?e:o);l=d.nextNode();)3===l.nodeType&&l===s||et(l)||(l.content instanceof c&&rt(l.content),nt(l),s=l);if(s=null,ze)return e;if(Ne){if(Oe)for(u=le.call(o.ownerDocument);o.firstChild;)u.appendChild(o.firstChild);else u=o;return we&&(u=ce.call(i,u,!0)),u}var f=Me?o.outerHTML:o.innerHTML;return Ee&&(f=h(f,ue," "),f=h(f,de," ")),te&&He?te.createHTML(f):f},n.setConfig=function(e){Ke(e),De=!0},n.clearConfig=function(){Be=null,De=!1},n.isValidAttribute=function(e,t,n){Be||Ke({});var r=y(e),o=y(t);return tt(r,o,n)},n.addHook=function(e,t){"function"==typeof t&&(se[e]=se[e]||[],p(se[e],t))},n.removeHook=function(e){se[e]&&f(se[e])},n.removeHooks=function(e){se[e]&&(se[e]=[])},n.removeAllHooks=function(){se={}},n}()}));
;
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(b,f,e){b instanceof String&&(b=String(b));for(var h=b.length,g=0;g<h;g++){var q=b[g];if(f.call(e,q,g,b))return{i:g,v:q}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,f,e){if(b==Array.prototype||b==Object.prototype)return b;b[f]=e.value;return b};$jscomp.getGlobal=function(b){b=["object"==typeof globalThis&&globalThis,b,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var f=0;f<b.length;++f){var e=b[f];if(e&&e.Math==Math)return e}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(b,f){var e=$jscomp.propertyToPolyfillSymbol[f];if(null==e)return b[f];e=b[e];return void 0!==e?e:b[f]};
$jscomp.polyfill=function(b,f,e,h){f&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(b,f,e,h):$jscomp.polyfillUnisolated(b,f,e,h))};$jscomp.polyfillUnisolated=function(b,f,e,h){e=$jscomp.global;b=b.split(".");for(h=0;h<b.length-1;h++){var g=b[h];g in e||(e[g]={});e=e[g]}b=b[b.length-1];h=e[b];f=f(h);f!=h&&null!=f&&$jscomp.defineProperty(e,b,{configurable:!0,writable:!0,value:f})};
$jscomp.polyfillIsolated=function(b,f,e,h){var g=b.split(".");b=1===g.length;h=g[0];h=!b&&h in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var q=0;q<g.length-1;q++){var u=g[q];u in h||(h[u]={});h=h[u]}g=g[g.length-1];e=$jscomp.IS_SYMBOL_NATIVE&&"es6"===e?h[g]:null;f=f(e);null!=f&&(b?$jscomp.defineProperty($jscomp.polyfills,g,{configurable:!0,writable:!0,value:f}):f!==e&&($jscomp.propertyToPolyfillSymbol[g]=$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(g):$jscomp.POLYFILL_PREFIX+g,g=$jscomp.propertyToPolyfillSymbol[g],
$jscomp.defineProperty(h,g,{configurable:!0,writable:!0,value:f})))};$jscomp.polyfill("Array.prototype.find",function(b){return b?b:function(b,e){return $jscomp.findInternal(this,b,e).v}},"es6","es3");
(function(b){"function"===typeof define&&define.amd?define(["jquery"],b):"object"===typeof module&&module.exports?module.exports=function(f,e){void 0===e&&(e="undefined"!==typeof window?require("jquery"):require("jquery")(f));b(e);return e}:b(jQuery)})(function(b){var f=0;b.fn.TouchSpin=function(e){var h={min:0,max:100,initval:"",replacementval:"",firstclickvalueifempty:null,step:1,decimals:0,stepinterval:100,forcestepdivisibility:"round",stepintervaldelay:500,verticalbuttons:!1,verticalup:"+",verticaldown:"-",
verticalupclass:"",verticaldownclass:"",prefix:"",postfix:"",prefix_extraclass:"",postfix_extraclass:"",booster:!0,boostat:10,maxboostedstep:!1,mousewheel:!0,buttondown_class:"btn btn-primary",buttonup_class:"btn btn-primary",buttondown_txt:"-",buttonup_txt:"+",callback_before_calculation:function(b){return b},callback_after_calculation:function(b){return b}},g={min:"min",max:"max",initval:"init-val",replacementval:"replacement-val",firstclickvalueifempty:"first-click-value-if-empty",step:"step",
decimals:"decimals",stepinterval:"step-interval",verticalbuttons:"vertical-buttons",verticalupclass:"vertical-up-class",verticaldownclass:"vertical-down-class",forcestepdivisibility:"force-step-divisibility",stepintervaldelay:"step-interval-delay",prefix:"prefix",postfix:"postfix",prefix_extraclass:"prefix-extra-class",postfix_extraclass:"postfix-extra-class",booster:"booster",boostat:"boostat",maxboostedstep:"max-boosted-step",mousewheel:"mouse-wheel",buttondown_class:"button-down-class",buttonup_class:"button-up-class",
buttondown_txt:"button-down-txt",buttonup_txt:"button-up-txt"};return this.each(function(){function q(){var d={};b.each(g,function(a,b){b="bts-"+b;c.is("[data-"+b+"]")&&(d[a]=c.data(b))});return d}function u(){""===a.prefix&&(z=k.prefix.detach());""===a.postfix&&(A=k.postfix.detach())}function H(d){switch(a.forcestepdivisibility){case "round":return(Math.round(d/a.step)*a.step).toFixed(a.decimals);case "floor":return(Math.floor(d/a.step)*a.step).toFixed(a.decimals);case "ceil":return(Math.ceil(d/
a.step)*a.step).toFixed(a.decimals);default:return d.toFixed(a.decimals)}}function w(){var d=a.callback_before_calculation(c.val());if(""===d)""!==a.replacementval&&(c.val(a.replacementval),c.trigger("change"));else if(!(0<a.decimals&&"."===d)){var b=parseFloat(d);isNaN(b)&&(b=""!==a.replacementval?a.replacementval:0);var e=b;b.toString()!==d&&(e=b);null!==a.min&&b<a.min&&(e=a.min);null!==a.max&&b>a.max&&(e=a.max);e=H(e);Number(d).toString()!==e.toString()&&(c.val(e),c.trigger("change"))}}function B(){if(a.booster){var d=
Math.pow(2,Math.floor(v/a.boostat))*a.step;a.maxboostedstep&&d>a.maxboostedstep&&(d=a.maxboostedstep,l=Math.round(l/d)*d);return Math.max(a.step,d)}return a.step}function C(){return"number"===typeof a.firstclickvalueifempty?a.firstclickvalueifempty:(a.min+a.max)/2}function r(){w();var d=l=parseFloat(a.callback_before_calculation(k.input.val()));if(isNaN(l))l=C();else{var b=B();l+=b}null!==a.max&&l>a.max&&(l=a.max,c.trigger("touchspin.on.max"),m());k.input.val(a.callback_after_calculation(Number(l).toFixed(a.decimals)));
d!==l&&c.trigger("change")}function t(){w();var d=l=parseFloat(a.callback_before_calculation(k.input.val()));if(isNaN(l))l=C();else{var b=B();l-=b}null!==a.min&&l<a.min&&(l=a.min,c.trigger("touchspin.on.min"),m());k.input.val(a.callback_after_calculation(Number(l).toFixed(a.decimals)));d!==l&&c.trigger("change")}function x(){m();v=0;n="down";c.trigger("touchspin.on.startspin");c.trigger("touchspin.on.startdownspin");D=setTimeout(function(){E=setInterval(function(){v++;t()},a.stepinterval)},a.stepintervaldelay)}
function y(){m();v=0;n="up";c.trigger("touchspin.on.startspin");c.trigger("touchspin.on.startupspin");F=setTimeout(function(){G=setInterval(function(){v++;r()},a.stepinterval)},a.stepintervaldelay)}function m(){clearTimeout(D);clearTimeout(F);clearInterval(E);clearInterval(G);switch(n){case "up":c.trigger("touchspin.on.stopupspin");c.trigger("touchspin.on.stopspin");break;case "down":c.trigger("touchspin.on.stopdownspin"),c.trigger("touchspin.on.stopspin")}v=0;n=!1}var c=b(this),I=c.data(),z,A,p,
l,E,G,D,F,v=0,n=!1;if(!c.data("alreadyinitialized"))if(c.data("alreadyinitialized",!0),f+=1,c.data("spinnerid",f),c.is("input")){var a=b.extend({},h,I,q(),e);""!==a.initval&&""===c.val()&&c.val(a.initval);w();(function(){var d=c.val(),e=c.parent();""!==d&&(d=a.callback_after_calculation(Number(d).toFixed(a.decimals)));c.data("initvalue",d).val(d);c.addClass("form-control");if(e.hasClass("input-group")){e.addClass("bootstrap-touchspin");var f=c.prev();d=c.next();var g='<span class="input-group-addon input-group-prepend bootstrap-touchspin-prefix input-group-prepend bootstrap-touchspin-injected"><span class="input-group-text">'+
a.prefix+"</span></span>",k='<span class="input-group-addon input-group-append bootstrap-touchspin-postfix input-group-append bootstrap-touchspin-injected"><span class="input-group-text">'+a.postfix+"</span></span>";if(f.hasClass("input-group-btn")||f.hasClass("input-group-prepend")){var h='<button class="'+a.buttondown_class+' bootstrap-touchspin-down bootstrap-touchspin-injected" type="button">'+a.buttondown_txt+"</button>";f.append(h)}else h='<span class="input-group-btn input-group-prepend bootstrap-touchspin-injected"><button class="'+
a.buttondown_class+' bootstrap-touchspin-down" type="button">'+a.buttondown_txt+"</button></span>",b(h).insertBefore(c);d.hasClass("input-group-btn")||d.hasClass("input-group-append")?(f='<button class="'+a.buttonup_class+' bootstrap-touchspin-up bootstrap-touchspin-injected" type="button">'+a.buttonup_txt+"</button>",d.prepend(f)):(f='<span class="input-group-btn input-group-append bootstrap-touchspin-injected"><button class="'+a.buttonup_class+' bootstrap-touchspin-up" type="button">'+a.buttonup_txt+
"</button></span>",b(f).insertAfter(c));b(g).insertBefore(c);b(k).insertAfter(c);p=e}else e="",c.hasClass("input-sm")&&(e="input-group-sm"),c.hasClass("input-lg")&&(e="input-group-lg"),p=b(a.verticalbuttons?'<div class="input-group '+e+' bootstrap-touchspin bootstrap-touchspin-injected"><span class="input-group-addon input-group-prepend bootstrap-touchspin-prefix"><span class="input-group-text">'+a.prefix+'</span></span><span class="input-group-addon bootstrap-touchspin-postfix input-group-append"><span class="input-group-text">'+
a.postfix+'</span></span><span class="input-group-btn-vertical"><button class="'+a.buttondown_class+" bootstrap-touchspin-up "+a.verticalupclass+'" type="button">'+a.verticalup+'</button><button class="'+a.buttonup_class+" bootstrap-touchspin-down "+a.verticaldownclass+'" type="button">'+a.verticaldown+"</button></span></div>":'<div class="input-group bootstrap-touchspin bootstrap-touchspin-injected"><span class="input-group-btn input-group-prepend"><button class="'+a.buttondown_class+' bootstrap-touchspin-down" type="button">'+
a.buttondown_txt+'</button></span><span class="input-group-addon bootstrap-touchspin-prefix input-group-prepend"><span class="input-group-text">'+a.prefix+'</span></span><span class="input-group-addon bootstrap-touchspin-postfix input-group-append"><span class="input-group-text">'+a.postfix+'</span></span><span class="input-group-btn input-group-append"><button class="'+a.buttonup_class+' bootstrap-touchspin-up" type="button">'+a.buttonup_txt+"</button></span></div>").insertBefore(c),b(".bootstrap-touchspin-prefix",
p).after(c),c.hasClass("input-sm")?p.addClass("input-group-sm"):c.hasClass("input-lg")&&p.addClass("input-group-lg")})();var k={down:b(".bootstrap-touchspin-down",p),up:b(".bootstrap-touchspin-up",p),input:b("input",p),prefix:b(".bootstrap-touchspin-prefix",p).addClass(a.prefix_extraclass),postfix:b(".bootstrap-touchspin-postfix",p).addClass(a.postfix_extraclass)};u();(function(){c.on("keydown.touchspin",function(d){var a=d.keyCode||d.which;38===a?("up"!==n&&(r(),y()),d.preventDefault()):40===a&&
("down"!==n&&(t(),x()),d.preventDefault())});c.on("keyup.touchspin",function(d){d=d.keyCode||d.which;38===d?m():40===d&&m()});c.on("blur.touchspin",function(){w();c.val(a.callback_after_calculation(c.val()))});k.down.on("keydown",function(d){var a=d.keyCode||d.which;if(32===a||13===a)"down"!==n&&(t(),x()),d.preventDefault()});k.down.on("keyup.touchspin",function(d){d=d.keyCode||d.which;32!==d&&13!==d||m()});k.up.on("keydown.touchspin",function(d){var a=d.keyCode||d.which;if(32===a||13===a)"up"!==
n&&(r(),y()),d.preventDefault()});k.up.on("keyup.touchspin",function(a){a=a.keyCode||a.which;32!==a&&13!==a||m()});k.down.on("mousedown.touchspin",function(a){k.down.off("touchstart.touchspin");c.is(":disabled")||(t(),x(),a.preventDefault(),a.stopPropagation())});k.down.on("touchstart.touchspin",function(a){k.down.off("mousedown.touchspin");c.is(":disabled")||(t(),x(),a.preventDefault(),a.stopPropagation())});k.up.on("mousedown.touchspin",function(a){k.up.off("touchstart.touchspin");c.is(":disabled")||
(r(),y(),a.preventDefault(),a.stopPropagation())});k.up.on("touchstart.touchspin",function(a){k.up.off("mousedown.touchspin");c.is(":disabled")||(r(),y(),a.preventDefault(),a.stopPropagation())});k.up.on("mouseup.touchspin mouseout.touchspin touchleave.touchspin touchend.touchspin touchcancel.touchspin",function(a){n&&(a.stopPropagation(),m())});k.down.on("mouseup.touchspin mouseout.touchspin touchleave.touchspin touchend.touchspin touchcancel.touchspin",function(a){n&&(a.stopPropagation(),m())});
k.down.on("mousemove.touchspin touchmove.touchspin",function(a){n&&(a.stopPropagation(),a.preventDefault())});k.up.on("mousemove.touchspin touchmove.touchspin",function(a){n&&(a.stopPropagation(),a.preventDefault())});c.on("mousewheel.touchspin DOMMouseScroll.touchspin",function(b){if(a.mousewheel&&c.is(":focus")){var d=b.originalEvent.wheelDelta||-b.originalEvent.deltaY||-b.originalEvent.detail;b.stopPropagation();b.preventDefault();0>d?t():r()}})})();(function(){c.on("touchspin.destroy",function(){var a=
c.parent();m();c.off(".touchspin");a.hasClass("bootstrap-touchspin-injected")?(c.siblings().remove(),c.unwrap()):(b(".bootstrap-touchspin-injected",a).remove(),a.removeClass("bootstrap-touchspin"));c.data("alreadyinitialized",!1)});c.on("touchspin.uponce",function(){m();r()});c.on("touchspin.downonce",function(){m();t()});c.on("touchspin.startupspin",function(){y()});c.on("touchspin.startdownspin",function(){x()});c.on("touchspin.stopspin",function(){m()});c.on("touchspin.updatesettings",function(d,
e){a=b.extend({},a,e);e.postfix&&(0===c.parent().find(".bootstrap-touchspin-postfix").length&&A.insertAfter(c),c.parent().find(".bootstrap-touchspin-postfix .input-group-text").text(e.postfix));e.prefix&&(0===c.parent().find(".bootstrap-touchspin-prefix").length&&z.insertBefore(c),c.parent().find(".bootstrap-touchspin-prefix .input-group-text").text(e.prefix));u();w();d=k.input.val();""!==d&&(d=Number(a.callback_before_calculation(k.input.val())),k.input.val(a.callback_after_calculation(Number(d).toFixed(a.decimals))))})})()}else console.log("Must be an input.")})}});
;
/*
 jQuery lightweight Fly to
 Author: @ElmahdiMahmoud
 Licensed under the MIT license
*/
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,c,b){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var f=a[e];if(c.call(b,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,b){if(a==Array.prototype||a==Object.prototype)return a;a[c]=b.value;return a};$jscomp.getGlobal=function(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var c=0;c<a.length;++c){var b=a[c];if(b&&b.Math==Math)return b}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(a,c){var b=$jscomp.propertyToPolyfillSymbol[c];if(null==b)return a[c];b=a[b];return void 0!==b?b:a[c]};
$jscomp.polyfill=function(a,c,b,d){c&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(a,c,b,d):$jscomp.polyfillUnisolated(a,c,b,d))};$jscomp.polyfillUnisolated=function(a,c,b,d){b=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in b||(b[e]={});b=b[e]}a=a[a.length-1];d=b[a];c=c(d);c!=d&&null!=c&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:c})};
$jscomp.polyfillIsolated=function(a,c,b,d){var e=a.split(".");a=1===e.length;d=e[0];d=!a&&d in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var f=0;f<e.length-1;f++){var g=e[f];g in d||(d[g]={});d=d[g]}e=e[e.length-1];b=$jscomp.IS_SYMBOL_NATIVE&&"es6"===b?d[e]:null;c=c(b);null!=c&&(a?$jscomp.defineProperty($jscomp.polyfills,e,{configurable:!0,writable:!0,value:c}):c!==b&&($jscomp.propertyToPolyfillSymbol[e]=$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(e):$jscomp.POLYFILL_PREFIX+e,e=$jscomp.propertyToPolyfillSymbol[e],
$jscomp.defineProperty(d,e,{configurable:!0,writable:!0,value:c})))};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,b){return $jscomp.findInternal(this,a,b).v}},"es6","es3");
(function(a,c,b,d){a.fn.flyto=function(b){var c=a.extend({item:".flyto-item",target:".flyto-target",button:".flyto-btn",shake:!0},b);return this.each(function(){var b=a(this),e=b.find(c.button),d=a(c.target);b.find(c.item);e.on("click",function(){var b=a(this).parent().find("img").eq(0);b&&(b=b.clone().offset({top:b.offset().top,left:b.offset().left}).css({opacity:"0.5",position:"absolute",height:b.height()/2,width:b.width()/2,"z-index":"100"}).appendTo(a("body")).animate({top:d.offset().top+10,left:d.offset().left+
15,height:b.height()/2,width:b.width()/2},1E3,"easeInOutExpo"),c.shake&&setTimeout(function(){d.effect("shake",{times:2},200)},1500),b.animate({width:0,height:0},function(){a(this).detach()}))})})}})(jQuery,window,document);
;
/*! js-cookie v3.0.0-rc.0 | MIT */
!function (e, t) {
	"object" == typeof exports && "undefined" != typeof module ? module.exports = t() : "function" == typeof define && define.amd ? define(t) : (e = e || self, function () {
		var r = e.Cookies, n = e.Cookies = t();
		n.noConflict = function () {
			return e.Cookies = r, n
		}
	}())
}(this, function () {
	"use strict";

	function e(e) {
		for (var t = 1; t < arguments.length; t++) {
			var r = arguments[t];
			for (var n in r) e[n] = r[n]
		}
		return e
	}

	var t = {
		read: function (e) {
			return e.replace(/%3B/g, ";")
		}, write: function (e) {
			return e.replace(/;/g, "%3B")
		}
	};
	return function r(n, i) {
		function o(r, o, u) {
			if ("undefined" != typeof document) {
				"number" == typeof (u = e({}, i, u)).expires && (u.expires = new Date(Date.now() + 864e5 * u.expires)), u.expires && (u.expires = u.expires.toUTCString()), r = t.write(r).replace(/=/g, "%3D"), o = n.write(String(o), r);
				var c = "";
				for (var f in u) u[f] && (c += "; " + f, !0 !== u[f] && (c += "=" + u[f].split(";")[0]));
				return document.cookie = r + "=" + o + c
			}
		}

		return Object.create({
			set: o, get: function (e) {
				if ("undefined" != typeof document && (!arguments.length || e)) {
					for (var r = document.cookie ? document.cookie.split("; ") : [], i = {}, o = 0; o < r.length; o++) {
						var u = r[o].split("="), c = u.slice(1).join("="),
							f = t.read(u[0]).replace(/%3D/g, "=");
						if (i[f] = n.read(c, f), e === f) break
					}
					return e ? i[e] : i
				}
			}, remove: function (t, r) {
				o(t, "", e({}, r, {expires: -1}))
			}, withAttributes: function (t) {
				return r(this.converter, e({}, this.attributes, t))
			}, withConverter: function (t) {
				return r(e({}, this.converter, t), this.attributes)
			}
		}, {attributes: {value: Object.freeze(i)}, converter: {value: Object.freeze(n)}})
	}(t, {path: "/"})
});;
//1.10
//**********************************************************
//New in 1.10 => fix issue with rotation at 0 angle
//New in 1.10 => fix issue with colored STL on vsb
//New in 1.10 => make all vsb ids -1
//New in 1.10 => fixed issue with mesh cloning
//New in 1.10 => mm/inch settings
//New in 1.10 => Option to trigger 'no model' click event - 'send_no_model_click_event'
//New in 1.10 => Scale always 1 for vsb file, ro avoid double scalling
//New in 1.10 => define default path for loading THREE JS files by script path (and not by html page path) - thanks venkyr!
//New in 1.10 => get both onmousedown + onmouseclick
//New in 1.10 => fix rotation issues
//New in 1.09 => get_camera_state - get camera's info
//New in 1.09 => set_camera_state - set camera
//New in 1.09 => Returns 'orig_filename' optional parameter at 'get_model_info'
//New in 1.09 => 'get_vsj' - returns object current stands as json, files not included
//New in 1.09 => 'download_vsj' - download json descriptor of current scene
//New in 1.09 => 'load_vsj' - apply scene as described in json file
//New in 1.09 => 'get_stl_bin' - returns STL formatted model as arraybuffer
//New in 1.09 => 'download_model' - download model as STL file
//New in 1.09 => 'get_vsb' - returns object current stands as json, plus binary files
//New in 1.09 => 'download_vsb' - download vsb (see get_vsb) as ZIP file
//New in 1.09 => 'load_vsb' - load vsb file

//New in 1.08 => Returns x/y/z dimentions of a model on 'get_model_info'
//New in 1.08 => Fixed finding file extention, thanks Rafael!
//**********************************************************
var stl_viewer_script_path="";

function StlViewer(parent_element_obj, options)
{
	if (!parent_element_obj) console.log ('error: no parent element');

	var _this=this;

	this.error=null; //will contain error string, if any

	this.options=options;

	this.parent_element=parent_element_obj;

	this.get_opt = function (opt_id, def)
	{
		if (!_this.options) return def;

		if (_this.options[opt_id]===false) return false;
		return _this.options[opt_id]?_this.options[opt_id]:def;
	}

	this.canvas_width="100%";
	this.canvas_height="100%";
	this.bg_color="transparent";
	this.models_to_add=null; //at start
	this.models=new Array();
	this.models_count=0;
	this.models_ref=new Array(); //models with index - direct reference from id(comes from user) to model array (above)
	this.allow_drag_and_drop=_this.get_opt("allow_drag_and_drop",true);
	this.model_loaded_callback=null;
	this.all_loaded_callback=null;
	this.load_error_callback=null;
	this.loading_progress_callback=null;
	this.max_model_id=0; //what is the maximum id of any model?
	this.load_status=new Array(); //loaded/total bytes info for each model
	this.load_session=0; //usefull in more than one session of loading
	this.loaded_models_arr=new Array(); //contain ids of loaded models
	this.status=0; //0=all good
	this.onmousedown_callback=null;
	this.zoom=-1; //-1 = auto zoom
	this.camerax=0;
	this.cameray=0;
	this.cameraz=0;

	this.camera_state=null;
	this.auto_rotate=false;
	this.mouse_zoom=true;
	//this.load_three_files=_this.get_opt("load_three_files","");
	this.load_three_files=_this.get_opt("load_three_files", stl_viewer_script_path);
	this.ready=(typeof THREE != 'undefined');
	this.ready_callback=null;
	this.auto_resize=true;
	this.on_model_drop=null;
	this.center_models=true;
	this.controls_type=0; //0=orbitcontrols, 1=trackbacllcontrols
	this.zoom=-1;
	this.pre_loaded_ab_files=null; //STL files as ArrayBuffer, waiting to be loaded (used when loading VSB)
	this.pre_loaded_vsj=null; //VSJ file content, waiting to be loaded (used when loading VSB)
	this.zip_load_count=-1; //Zip files waiting to be loaded to memory (used when loading VSB)
	this.send_no_model_click_event=false; //will trigger click event even if no model was clicked (just parent element was clicked)

    // custom
    this.on_init_done_callback = null;
    this.model_worker = null;
    this.detach = function () {
        Object
            .keys(_this.models)
            .forEach(function (key) {
                // detach scene
                _this.scene.remove(_this.models[key].mesh);
                // _this.scene = null;

                // detach camera
                // _this.camera = null;

                // detach mesh
                _this.models[key].mesh.geometry.dispose();
                _this.models[key].mesh.geometry = undefined;

                _this.models[key].mesh.material.dispose();
                _this.models[key].mesh.material = undefined;

                /*
                if (_this.models[key].mesh.material.map) {
                    _this.models[key].mesh.material.map.dispose();
                    _this.models[key].mesh.material.map = undefined;
                }

                if (_this.models[key].mesh.texture) {
                    _this.models[key].mesh.texture.dispose();
                    _this.models[key].mesh.texture = undefined;
                }
                 */

                //
                _this.models[key].mesh = undefined;

                /*
                _this.scene.traverse(function (object) {
                    if (object.geometry) {
                        object.geometry.dispose();
                    }
                    if (object.material) {
                        if (object.material.map) {
                            object.material.map.dispose();
                        }
                        object.material.dispose();
                    }
                    _this.scene.remove(object);
                });
                */

                // doDisposeScene(_this.scene);

                // detach renderer
                _this.renderer.dispose();
                _this.renderer.forceContextLoss();
                _this.renderer.context=undefined;
                _this.renderer.domElement=undefined;

                // detach model
                delete _this.models[key];
            });
    };
    // custom

	this.set_on_model_mousedown = function (callback)
	{
		_this.onmousedown_callback=callback;

		if (_this.onmousedown_callback)
		{
			_this.parent_element.addEventListener('mousedown', _this.onmousedown);
			_this.parent_element.addEventListener('touchstart', _this.onmousedown);
		}
	}

	this.set_drag_and_drop = function(b)
	{
		if (b)
		{
			_this.parent_element.addEventListener('dragover', _this.handleDragOver);
			_this.parent_element.addEventListener('drop', _this.handleFileDrop);
		}
		else
		{
			_this.parent_element.removeEventListener('dragover', _this.handleDragOver);
			_this.parent_element.removeEventListener('drop', _this.handleFileDrop);
		}
	}

	this.set_options = function ()
	{
		_this.canvas_width=_this.get_opt("width",_this.canvas_width);
		_this.canvas_height=_this.get_opt("height",_this.canvas_height);
		_this.bg_color=_this.get_opt("bgcolor",_this.bg_color);
		_this.models_to_add=_this.get_opt("models",_this.models_to_add);
		_this.model_loaded_callback=_this.get_opt("model_loaded_callback",_this.model_loaded_callback);
		_this.all_loaded_callback=_this.get_opt("all_loaded_callback",_this.all_loaded_callback);
		_this.load_error_callback=_this.get_opt("load_error_callback",_this.load_error_callback);
		_this.loading_progress_callback=_this.get_opt("loading_progress_callback",_this.loading_progress_callback);
		_this.onmousedown_callback=_this.get_opt("on_model_mousedown", _this.onmousedown_callback);
		if (!_this.onmousedown_callback) _this.onmousedown_callback=_this.get_opt("on_model_mouseclick",null);
		_this.send_no_model_click_event=_this.get_opt("send_no_model_click_event", _this.send_no_model_click_event);
		_this.zoom=_this.get_opt("zoom",_this.zoom); //-1 = auto zoom
		_this.camerax=_this.get_opt("camerax",_this.camerax);
		_this.cameray=_this.get_opt("cameray",_this.cameray);
		_this.auto_rotate=_this.get_opt("auto_rotate",_this.auto_rotate);
		_this.mouse_zoom=_this.get_opt("mouse_zoom",_this.mouse_zoom);
		_this.ready_callback=_this.get_opt("ready_callback",null);
		_this.auto_resize=_this.get_opt("auto_resize",_this.auto_resize);
		_this.on_model_drop=_this.get_opt("on_model_drop",_this.on_model_drop);
		_this.center_models=_this.get_opt("center_models",_this.center_models);
		_this.controls_type=_this.get_opt("controls", _this.controls_type);
		if (_this.zoom>=0)
			_this.cameraz=_this.zoom;
		else
			_this.cameraz=_this.get_opt("cameraz",_this.cameraz);

		_this.camera_state=_this.get_opt("camera_state",_this.camera_state);

		//drag and drop?
		if (_this.allow_drag_and_drop)
			_this.set_drag_and_drop(true);

		//_this.set_on_model_mousedown(_this.onmousedown_callback);

        // custom
        _this.on_init_done_callback = _this.get_opt("on_init_done_callback", _this.on_init_done_callback);
        // custom
	}

	_this.is_ie = !!window.MSStream;


	//messages
	this.MSG2WORKER_DATA=0;
	this.MSG2WORKER_LOAD=1;
	this.MSG2WORKER_ERROR=2;
	this.MSGFROMWORKER_STL_LOADED=3;
	this.MSGFROMWORKER_LOAD_IN_PROGRESS=4;

	this.load_model = function (model)
	{
		_this.max_model_id=Math.max(_this.max_model_id, model.id);
		if ((model.filename)||(model.local_file)) return _this.load_from_stl_file(model, false);
		if (model.mesh) return _this.add_from_existing_mesh(model);
		_this.models_count--; //WTF? no good model
	}

	this.add_from_existing_mesh = function(model)
	{
		_this.set_model_custom_props(model); //position, color, scale
		model.mesh.model_id=model.id; //loop-back link (useful to detect clicks)
		//_this.set_geo_minmax(model.mesh.geometry);
		_this.set_geo_minmax(model);
		_this.recalc_dims(model);

		model.color='#'+model.mesh.material.color.getHexString();

		_this.scene.add(model.mesh);
		_this.model_loaded(model.id);
		_this.check_loading_status(model, 0, 0);
		if (!model.mesh.geometry.boundingBox) model.mesh.geometry.computeBoundingBox();

		if (_this.model_loaded_callback)
			_this.model_loaded_callback(_this); // custom
	}

	this.load_from_stl_file = function (model)
	{
		var model_worker=new Worker(((typeof _this.load_three_files == "string")?_this.load_three_files:"")+"load_stl.js");
		//
		// _this.model_worker = model_worker;
		//
		//var model_worker=new Worker(((typeof _this.load_three_files == "string")?_this.load_three_files:"")+"load_stl.js");
		model_worker.onmessage = function(e)
		{
			//console.log("msg from worker: ");
			//console.log(e.data);
			switch (e.data.msg_type)
			{
				case _this.MSGFROMWORKER_STL_LOADED:
					model.colors=e.data.colors;
					var geo=_this.vf_to_geo(e.data.vertices, e.data.faces, e.data.colors?e.data.colors:false);
					if (geo)
					{
						//if (!geo.boundingBox) geo.computeBoundingBox();
						var material=new THREE.MeshLambertMaterial({color:0x909090, overdraw: 1, wireframe: false, vertexColors: model.color?THREE.NoColors:THREE.FaceColors}); //if model color is set, ignores face colors set on the STL file itself (if any)
						if (!_this.is_ie) material.side = THREE.DoubleSide;
						if (!model.display) model.display="flat";
						_this.set_material_display(model.display, material, geo); //shading (aka display)
						console.log(material);
						model.mesh=new THREE.Mesh(geo, material);
						_this.set_model_custom_props(model); //position, color, scale
						_this.set_geo_minmax(model);
						model.mesh.model_id=model.id; //loop-back link (useful to detect clicks)
						_this.recalc_dims(model);
						_this.scene.add(model.mesh);
						_this.model_loaded(model.id);
						console.log(_this);
						if (_this.model_loaded_callback)
							_this.model_loaded_callback(_this); // custom
					}
					else
						console.log("Error VF data ");


					model_worker.terminate();
					model_worker=undefined;
					if (_this.pre_loaded_ab_files) if (model.filename) if (_this.pre_loaded_ab_files[model.filename]) delete (_this.pre_loaded_ab_files[model.filename]);
					break;

				case _this.MSGFROMWORKER_LOAD_IN_PROGRESS:
					_this.check_loading_status(model, e.data.loaded, e.data.total);
					break;

				case _this.MSG2WORKER_ERROR:
					//console.log('Loading error', _this.load_error_callback);
					_this.models_count--; //one less model to load in this session
					_this.model_error("ERROR: "+e.data.data, _this.load_error_callback);
					if (_this.pre_loaded_ab_files) if (model.filename) if (_this.pre_loaded_ab_files[model.filename]) delete (_this.pre_loaded_ab_files[model.filename]);
					break;
			}
		};

		console.log(model);

		model.bytes_loaded=0;
		model.bytes_total=0;

		var blob_to_load=null;
		if (_this.pre_loaded_ab_files) if (model.filename) if (_this.pre_loaded_ab_files[model.filename]) blob_to_load=_this.pre_loaded_ab_files[model.filename];

		model_worker.postMessage({msg_type:_this.MSG2WORKER_DATA, data:model, load_from_blob_or_ab:blob_to_load, get_progress:(_this.loading_progress_callback!=null)});
		model_worker.postMessage({msg_type:_this.MSG2WORKER_LOAD});

	}

	//called after model is loaded
	this.model_loaded = function(model_id)
	{
		_this.loaded_models_arr[model_id]=1;

		if (Object.keys(_this.loaded_models_arr).length>=_this.models_count)
		{
			//all models are loaded
			if (!_this.camera_state)
				_this.set_zoom(); //camera state overrides zoom
			else
				_this.camera_state=null; //it is one time thingy (next bunch of models will have to set camera state again)

			_this.set_light();

			_this.load_session++; //from now on it is a new loading session

			if (_this.all_loaded_callback)
			{
				_this.all_loaded_callback();
			}
		}
	}

	this.remove_model_all = function () {
        Object.keys(_this.models).forEach(
            function (key) {
                console.log(key);
                console.log(_this.models);
                console.log( _this.models_ref);
                console.log(_this.loaded_models_arr);

                var model = _this.models[key];

                console.log('###remove_model_all###');
                console.log(model);
                console.log('###remove_model_all###');

                var model_id = _this.models[key].id;

                delete _this.loaded_models_arr[model_id];
                delete _this.models_ref[model_id];
                delete _this.models[key];

                _this.scene.remove(model.mesh);

                if (model.mesh.material.map) {
                    console.log('model.mesh.material.map');
                    model.mesh.material.map.dispose();
                }

                if (model.mesh.geometry) {
                    console.log('model.mesh.geometry');
                    model.mesh.geometry.dispose();
                }

                if (model.mesh.material) {
                    console.log('model.mesh.material');
                    model.mesh.material.dispose();
                }

                // if (model.indices) {
                //     console.log('model.indices');
                //     model.indices = [];
                // }
                //
                // if (model.vertices) {
                //     console.log('model.vertices');
                //     model.vertices = [];
                // }
                //
                // if (model.uvs) {
                //     console.log('model.uvs');
                //     model.uvs = [];
                // }

                model = null;
            }
        );
    }

	this.remove_model = function(model_id)
	{
		if (_this.models_ref[model_id]===undefined) return _this.model_error("remove_model - id not found: "+model_id);

		var model=_this.models[_this.models_ref[model_id]];
		if (!model) return;

		delete _this.models[_this.models_ref[model_id]];
		delete _this.models_ref[model_id];
		delete _this.loaded_models_arr[model_id];

		//recalc max_model_id
		_this.max_model_id=-1;
		Object.keys(_this.models_ref).forEach(function(key)
		{
			_this.max_model_id=Math.max(_this.models[_this.models_ref[key]].id, _this.max_model_id);
		});

		_this.models_count=Object.keys(_this.models).length;

		_this.scene.remove(model.mesh);
	}

	//called after set of models were loaded
	this.zoom_done=false;
	this.set_zoom=function (zoom, force_zoom)
	{
		if (zoom) _this.zoom=zoom;

		//if ((_this.zoom_done)&&(!force_zoom)&&(_this.zoom>=0)) //don't do zoom for more than once
		if ((_this.zoom_done)&&(!force_zoom)) //don't do zoom for more than once
			return;

		_this.zoom_done=true;

		var max_dim = Math.max(_this.maxx*2, _this.maxy*2, _this.maxz);
			_this.camera.position.set(_this.camera.position.x,_this.camera.position.y,_this.zoom>=0?_this.zoom:(max_dim*1.2*Math.max(1,_this.camera.aspect/2))); //-1 = auto zoom
	}

	//position, up and target vectors (each 3 coors vector) described camera's position
	this.get_camera_state=function()
	{
		if (!_this.camera) return null;
		var vpos=new THREE.Vector3();
		var vup=new THREE.Vector3();
		var vtarget=new THREE.Vector3(0,0,0);
		vpos.copy(_this.camera.position);
		vup.copy(_this.camera.up);

		if (_this.controls)
			vtarget.copy(_this.controls.target);

		return {position:vpos, up:vup, target:vtarget}
	}

	//state{position, up, target} = x,y,z object/vector
	//all parameters are optionals
	this.set_camera_state=function (state)
	{
		if (!_this.camera) return null;
		if (!state) return _this.model_error("set_camera_state - no state vector");

		if (state.position!==undefined)
		{
			if (state.position.x===undefined) return _this.model_error("set_camera_state - invalid position x");
			if (state.position.y===undefined) return _this.model_error("set_camera_state - invalid position y");
			if (state.position.z===undefined) return _this.model_error("set_camera_state - invalid position z");
			_this.camera.position.set(state.position.x, state.position.y, state.position.z);
		}

		if (state.up!==undefined)
		{
			if (state.up.x===undefined) return _this.model_error("set_camera_state invalid up x");
			if (state.up.y===undefined) return _this.model_error("set_camera_state invalid up y");
			if (state.up.z===undefined) return _this.model_error("set_camera_state invalid up z");
			_this.camera.up.set(state.up.x, state.up.y, state.up.z);
		}

		if (!_this.controls) return;

		if (state.target!==undefined)
		{
			if (state.target.x===undefined) return _this.model_error("set_camera_state - invalid target x");
			if (state.target.y===undefined) return _this.model_error("set_camera_state - invalid target y");
			if (state.target.z===undefined) return _this.model_error("set_camera_state - invalid target z");
			_this.controls.target.set(state.target.x, state.target.y, state.target.z);
		}
	}

	this.set_center_models=function (b)
	{
		_this.center_models=b;
	}


	//called after set of models were loaded
	this.set_light=function()
	{
		_this.directionalLight.position.x = _this.maxy * 2;
		_this.directionalLight.position.y = _this.miny * 2;
		_this.directionalLight.position.z = _this.maxz * 2;

		_this.pointLight.position.x = (_this.miny+_this.maxy)/2;
		_this.pointLight.position.y = (_this.miny+_this.maxy)/2;
		_this.pointLight.position.z = _this.maxz * 2;
	}

	this.stop_auto_zoom=function ()
	{
		_this.zoom=_this.camera.position.z;
		_this.zoom_done=true;
	}

	this.set_camera=function (x,y,z)
	{
		if (y) _this.zoom=y;
		_this.camera.position.set(!_this.is_empty(x)?x:_this.camera.position.x,!_this.is_empty(y)?y:_this.camera.position.y,_this.zoom>=0?_this.zoom:Math.max(_this.maxx*3, _this.maxy*3, _this.maxz*3.5));
	}

	this.set_auto_zoom=function()
	{
		_this.set_zoom(-1);
	}

	//go over ALL models for loaded/total status
	this.check_loading_status=function(model, loaded, total)
	{
		if (model)
			_this.load_status[model.id]={loaded:loaded, total:total, load_session:_this.load_session};

		if (!_this.loading_progress_callback) return; //no callback, we're done here

		//console.log(Object.keys(_this.load_status).length,_this.models_count);

		//if every model (loaded and pending) has loading status - send a message to parent
		if (Object.keys(_this.load_status).length==_this.models_count)
			_this.loading_progress_callback(_this.load_status, _this.load_session);
	}

	this.set_edges = function(model_id, b)
	{
		if (_this.models_ref[model_id]===undefined) return _this.model_error("set_edges - id not found: "+model_id);

		var model=_this.models[_this.models_ref[model_id]];
		if (!model) return;

		_this.set_or_update_geo_edges (model, b);
	}

	this.set_or_update_geo_edges = function (model, b, force_geo_recalc)
	{
		if ((!b)||(force_geo_recalc))
		{
			if (model.edges)
				_this.scene.remove(model.edges);

			model.edges=null;

			if (!b) return;
		}

		var add_to_scene=false;
		force_geo_recalc=force_geo_recalc||false;
		if ((!model.edges)||(force_geo_recalc))
		{
			//no edges - create new
			var geo=model.mesh.geometry;
			model.edges = new THREE.LineSegments( new THREE.EdgesGeometry( geo ), _this.edges_material );
			add_to_scene=true;
		}

		//position
		if (model.x||model.y||model.z)
			model.edges.position.set(model.x?model.x:0, model.y?model.y:0, model.z?model.z:0);

		//rotation
		model.edges.rotation.setFromRotationMatrix(model.mesh.matrix);

		if (add_to_scene) //add only if not already added
			_this.scene.add( model.edges );
	}

	//set model custome properties
	this.set_model_custom_props = function (model)
	{
		//units
		model.units=model.units?model.units:'mm';
		_this.set_model_units(model.id, model.units, true);

		//position
		model.x=model.x?model.x:0;
		model.y=model.y?model.y:0;
		model.z=model.z?model.z:0;
		model.mesh.position.set(model.x, model.y, model.z);

		//color
		if (model.color)
		{
			//color for whole mesh
			_this.update_mesh_color(model.mesh, model.color, false);
		}
		else if (model.colors)
			//custome colors for each face - default 'whole' body color should be white
			_this.update_mesh_color(model.mesh, "#FFFFFF", true);

		//rotation
		model.rotationx=model.rotationx?(model.rotationx):0;
		model.rotationy=model.rotationy?(model.rotationy):0;
		model.rotationz=model.rotationz?(model.rotationz):0;
		if (model.rotationx||model.rotationy||model.rotationz)
			_this.set_rotation(model.id, model.rotationx, model.rotationy, model.rotationz);

		//scale
		var scale=(typeof model.scale !== 'undefined')?model.scale:1;
		var scalex=(typeof model.scalex !== 'undefined')?model.scalex:scale;
		var scaley=(typeof model.scaley !== 'undefined')?model.scaley:scale;
		var scalez=(typeof model.scalez !== 'undefined')?model.scalez:scale;
		model.scalex=scalex;
		model.scaley=scaley;
		model.scalez=scalez;

		if ((scalex!=1)||(scaley!=1)||(scalez!=1))
			_this.scale_geo(model,scalex,scaley,scalez);

		//view edges?
		if (model.view_edges)
			_this.set_or_update_geo_edges (model, true);

		//opacity
		if (typeof model.opacity !== 'undefined')
			this.set_material_opacity(model.mesh.material, model.opacity);

		//animation
		if (model.animation)
			_this.animation[model.id]=1;
	}

	this.set_scale = function(model_id, scalex, scaley, scalez)
	{
		if (_this.models_ref[model_id]===undefined) return _this.model_error("set_scale - id not found: "+model_id);

		var model=_this.models[_this.models_ref[model_id]];
		if (!model) return;
		if (!model.mesh) return;
		if (!model.mesh.geometry) return;

		var prev_scalex=Math.max(model.scalex,0.01);
		var prev_scaley=Math.max(model.scaley,0.01);
		var prev_scalez=Math.max(model.scalez,0.01);

		if (scalex) model.scalex=Math.max(scalex,0.01);
		model.scaley=Math.max(scaley?scaley:scalex,0.01);
		model.scalez=Math.max(scalez?scalez:scalex,0.01);

		_this.scale_geo(model,model.scalex/prev_scalex,model.scaley/prev_scaley,model.scalez/prev_scalez);

		//if model has edges - we need to update it
		if (model.edges)
			_this.set_or_update_geo_edges (model, true, true);

		//console.log(model.scalex+"/"+model.scaley+"/"+model.scalez);
	}

	this.scale_geo = function(model,scalex,scaley,scalez)
	{
		var geo=model.mesh.geometry;
		geo.scale(scalex,scaley,scalez);
	}

	//recalc whole scene dims, and reset camera - after adding new geometry to scene
	this.recalc_dims = function (model)
	{
		var geo=model.mesh.geometry;

		_this.maxx=_this.maxx?(Math.max(_this.maxx, geo.maxx+model.x)):geo.maxx+model.x;
		_this.maxy=_this.maxy?(Math.max(_this.maxy, geo.maxy+model.y)):geo.maxy+model.y;
		_this.maxz=_this.maxz?(Math.max(_this.maxz, geo.maxz+model.z)):geo.maxz+model.z;
		_this.minx=_this.maxx?(Math.min(_this.minx, geo.minx+model.x)):geo.minx+model.x;
		_this.miny=_this.maxy?(Math.min(_this.miny, geo.miny+model.y)):geo.miny+model.y;
		_this.minz=_this.maxz?(Math.min(_this.minz, geo.minz+model.z)):geo.minz+model.z;
	}

	//set mesh color according to 'color' var
	this.update_mesh_color = function(mesh, color, model_colors)
	{
		if (mesh==null) return;

		if (color=='transparent')
		{
			mesh.traverse( function ( object ) { object.visible = false; } );
			return;
		}

		mesh.traverse( function ( object ) { object.visible = true; } );

		mesh.material.vertexColors=model_colors?THREE.FaceColors:THREE.NoColors; //use model original face colors (from STL file)?  or user defined color (aka NoColors to specific faces)
		if ((model_colors) && (!color)) color='#FFFFFF';

		//console.log(color, model_colors);

		if (color)
			mesh.material.color.set(parseInt(color.substr(1),16));

		mesh.material.needsUpdate=true;
	}

	//set color - called from outside
	this.set_color = function(model_id, color)
	{
		//console.log(_this.models_ref, model_id, _this.models_ref, _this.models, _this.models[0], _this.models_ref[model_id]);
		if (_this.models_ref[model_id]===undefined) return _this.model_error("set_color - id not found: "+model_id);

		var model=_this.models[_this.models_ref[model_id]];
		if (!model) return;
		if (!model.mesh) return;

		if (color.length<6) return;
		if (color.charAt(0)!='#') color='#'+color;

		model.color=color;

		_this.update_mesh_color(model.mesh, color, color?false:model.colors);
	}

	//check for error in model syntax
	this.error_in_model = function(model)
	{
		if ((!model.id)&&(model.id!=0)&&(model.id!=-1)) return _this.model_error("missing id");
		if (!Number.isInteger(model.id)) return _this.model_error("invalid id");
		if (model.id<-1) return _this.model_error("id must be positive");
		if ((!model.filename) && (!model.mesh) && (!model.local_file))
		{
			if (model.name)
				model.filename=model.name;
			else
				return _this.model_error("missing filename or mesh");
		}
		if (_this.models_ref[model.id]) return _this.model_error ("such model ID already exists: "+model.id);
		return null;
	}

	this.model_error = function (s, callback)
	{
		console.log(s);
		_this.status=-1;
		_this.error=s;

		if (callback)
			callback(s, _this);

		return s;
	}

	this.set_bg_color = function (bg_color)
	{
		if (bg_color=='transparent')
			this.renderer.setClearColor(0x000000, 0);
		else
			this.renderer.setClearColor(bg_color, 1);
	}

	this.set_display = function(model_id, display)
	{
		if (_this.models_ref[model_id]===undefined) return _this.model_error("set_display - id not found: "+model_id);

		var model=_this.models[_this.models_ref[model_id]];
		if (!model) return;

		_this.set_material_display(display, model.mesh.material, model.mesh.geometry);
		model.display=display;

		if (model.mesh)
			model.mesh.normalsNeedUpdate = true;
	}

	this.set_opacity = function(model_id, opacity)
	{
		if (_this.models_ref[model_id]===undefined) return _this.model_error("set_display - id not found: "+model_id);

		var model=_this.models[_this.models_ref[model_id]];
		if (!model) return;

		model.opacity=opacity;
		this.set_material_opacity(model.mesh.material, opacity);
	}

	this.set_material_opacity=function(material, opacity)
	{
		if (!material) return;
		if (opacity<1)
		{
			material.opacity=opacity;
			material.transparent = true;
		}
		else
		{
			material.opacity=1;
			material.transparent = false;
		}
	}

	this.onmousedown=function (event)
	{
		event.stopPropagation();
		event.preventDefault();

		switch (event.type)
		{
			case 'touchstart':
				var touch = event.touches[0] || event.changedTouches[0];
				_this.mouse.x = ( (touch.pageX-_this.parent_element.offsetLeft) / _this.parent_element.clientWidth ) * 2 - 1;
				_this.mouse.y = - ( (touch.pageY-_this.parent_element.offsetTop) / _this.parent_element.clientHeight ) * 2 + 1;
				break;

			default: //click
				_this.mouse.x = ( (event.clientX-_this.parent_element.offsetLeft) / _this.parent_element.clientWidth ) * 2 - 1;
				_this.mouse.y = - ( (event.clientY-_this.parent_element.offsetTop) / _this.parent_element.clientHeight ) * 2 + 1;
		}

		_this.raycaster.setFromCamera( _this.mouse, _this.camera );
		var intersects = _this.raycaster.intersectObjects( _this.scene.children );

		if (intersects.length>0)
		{
			if (intersects[0].object.model_id===undefined) return;
			if (_this.onmousedown_callback)
			{
				_this.onmousedown_callback(intersects[0].object.model_id, event, intersects[0].distance);
			}
		}
		else if (_this.send_no_model_click_event)
			_this.onmousedown_callback(null, event, 0);
	}

	//will return if value is empty (null/undefined etc.) and not zero (which is valid)
	this.is_empty=function(a)
	{
		return (!a && a !== 0);
	}

	this.set_model_units = function(model_id, units, scale)
	{
		if (_this.models_ref[model_id]===undefined) return _this.model_error("set_model_units - id not found: "+model_id);

		var model=_this.models[_this.models_ref[model_id]];
		if (!model) return;
		if (!model.mesh) return;

		var scale_factor=1;
		switch (units)
		{
			case 'mm':
				if (scale) if (model.units=='inch') scale_factor=1/25.4;
				model.units='mm';
				break;

			case 'inch':
				if (scale) if (model.units=='mm') scale_factor=25.4;
				model.units='inch';
				break;

			default:
				return _this.model_error("set_model_units - invalid unit "+units);
		}

		if (scale_factor!=1)
		{
			_this.set_scale(model.id,
			model.scalex*scale_factor,
			model.scaley*scale_factor,
			model.scalez*scale_factor
			);
		}
	}

	this.set_position = function(model_id, x,y,z)
	{
		if (_this.models_ref[model_id]===undefined) return _this.model_error("set_position - id not found: "+model_id);

		var model=_this.models[_this.models_ref[model_id]];
		if (!model) return;
		if (!model.mesh) return;

		model.x=(!_this.is_empty(x)?x:(model.x));
		model.y=(!_this.is_empty(y)?y:(model.y));
		model.z=(!_this.is_empty(z)?z:(model.z));

		model.mesh.position.set(model.x, model.y, model.z);

		//console.log("x/y/z: "+model.x+"/"+model.y+"/"+model.z+"/");

		//if model has edges - we need to update it
		if (model.edges)
			_this.set_or_update_geo_edges (model, true, true);
	}

	this.set_material_display = function(display, material, geo)
	{
		switch (display.toLowerCase())
		{
			case "wireframe":
				material.wireframe=true;
				break;

			case "smooth":
				material.wireframe=false;
				material.shading=THREE.SmoothShading;
				if (geo)
				{
					geo.mergeVertices();
					geo.computeVertexNormals();
				}
				break;

			case "flat":
				material.wireframe=false;
				material.shading=THREE.FlatShading;
				if (geo)
					geo.computeFlatVertexNormals();
				break;
		}
	}

	//rotate the mesh around itself (which is relative to world, not for mesh)
	//axis_x_angel, axis_y_angel, axis_z_angel - radians - set rotation
	this.set_rotation = function (model_id, axis_x_angel, axis_y_angel, axis_z_angel, add_to_current)
	{
		if (_this.models_ref[model_id]===undefined) return _this.model_error("rotate - id not found: "+model_id);

		var model=_this.models[_this.models_ref[model_id]];
		if (!model) return;

		var c=add_to_current?1:0; //add or set angle

		if (axis_x_angel!==undefined)
		{
			model.rotationx=axis_x_angel+model.mesh.rotation.x*c;
			model.mesh.rotation.x=model.rotationx;
		}

		if (axis_y_angel!==undefined)
		{
			model.rotationy=axis_y_angel+model.mesh.rotation.y*c;
			model.mesh.rotation.y=model.rotationy;
		}

		if (axis_z_angel!==undefined)
		{
			model.rotationz=axis_z_angel+model.mesh.rotation.z*c;
			model.mesh.rotation.z=model.rotationz;
		}

		model.mesh.updateMatrixWorld();

		//if model has edges - we need to update it
		if (model.edges)
			_this.set_or_update_geo_edges (model, true);
	}

	//rotate the mesh around itself (which is relative to world, not for mesh)
	//axis_x_angel, axis_y_angel, axis_z_angel - radians - add to current rotation
	this.rotate = function (model_id, axis_x_angel, axis_y_angel, axis_z_angel)
	{
		_this.set_rotation(model_id, axis_x_angel, axis_y_angel, axis_z_angel,true);
	}

	//no path, with ext
	this.basename=function (filename)
	{
		return filename.split(/[\\/]/).pop();
	}


	this.get_model_filename=function(model, no_null, basename, skip_url)
	{
		var fn=null;

		if ((model.orig_url)&&(!skip_url)) fn=decodeURIComponent(model.orig_url);
		else if (model.orig_filename) fn=model.orig_filename;
		else if (model.temp_filename) fn=model.temp_filename;
		else if (model.local_file)
		{
			if (model.local_file.name) fn=model.local_file.name;
		}
		else if (model.filename)
		{
			if (model.filename instanceof File) fn=File.name;
			fn=model.filename;
		}

		if (!fn) if (no_null) return 'model_'+model.id+'.stl'; //relevant for manually added meshes
		if (!fn) return null;

		if (basename) fn=_this.basename(fn);

		return fn;
	}

	this.add_model = function(new_model, dont_add_to_model_count)
	{
		if (Array.isArray(new_model)) return _this.add_models(new_model);

		if (!_this.ready)
		{
			//THREE files not ready - queuing
			_this.models_to_add.push(new_model);
			return _this.model_error("THREE JS files are not ready");
		}

		var model_filename=_this.get_model_filename(new_model);
		if (model_filename)
		{
			switch (model_filename.split('.').pop())
			{
				case 'vsj':
					return _this.load_vsj(new_model.local_file?new_model.local_file:model_filename);

				case 'vsb':
					return _this.load_vsb(new_model.local_file?new_model.local_file:model_filename);

				//default: assumed as a regular model (STL etc.) - do nothing, continue below
			}
		}

		if (typeof(new_model.id) == 'undefined') new_model.id=-1;
		var model_error=_this.error_in_model(new_model);
		if (model_error)
			return model_error;

		if (new_model.id==-1)
			new_model.id=(++_this.max_model_id);

		_this.models.push(new_model);
		var key=_this.models.indexOf(new_model);

		if (!dont_add_to_model_count)
			if (_this.models_ref[new_model.id]===undefined) _this.models_count++;

		_this.models_ref[new_model.id]=key;

		//console.log("id:",new_model.id, "count",_this.models_count, "ref:",_this.models_ref[new_model.id], dont_add_to_model_count);

		//console.log('added', new_model.id, _this.models_count, _this.models_ref[new_model.id]);
		_this.load_model(new_model);
		return _this.status;
	}

	//add models, input is array of models
	this.add_models=function (new_models)
	{
		if (!Array.isArray(new_models)) return _this.add_model(new_models);
		_this.status=0;
		var model_keys=Object.keys(new_models);
		//_this.models_count+=model_keys.length;

		//count models to load
		model_keys.forEach(function(key)
		{
			var model_filename=_this.get_model_filename(new_models[model_keys[key]]);

			if (model_filename)
			{
				switch (model_filename.split('.').pop())
				{
					case 'vsj':
					case 'vsb':
						//do nothing
						break;

					default:
						if (_this.models_ref[new_models[key].id]===undefined) _this.models_count++;
				}
			}
			else
				if (_this.models_ref[new_models[key].id]===undefined) _this.models_count++;
		});

		//add model by model
		model_keys.forEach(function(key)
		{
			_this.add_model(new_models[key], true);
		});

		return _this.status;
	}

	this.calc_volume_and_area=function(geo, factor)
	{
		var x1,x2,x3,y1,y2,y3,z1,z2,z3,i;
		var len=geo.faces.length;
		var totalVolume=0;
		var totalArea=0;
		var a,b,c,s;

		for (i=0;i<len;i++)
		{
			x1=geo.vertices[geo.faces[i].a].x*factor;
			y1=geo.vertices[geo.faces[i].a].y*factor;
			z1=geo.vertices[geo.faces[i].a].z*factor;
			x2=geo.vertices[geo.faces[i].b].x*factor;
			y2=geo.vertices[geo.faces[i].b].y*factor;
			z2=geo.vertices[geo.faces[i].b].z*factor;
			x3=geo.vertices[geo.faces[i].c].x*factor;
			y3=geo.vertices[geo.faces[i].c].y*factor;
			z3=geo.vertices[geo.faces[i].c].z*factor;

			totalVolume +=
				(-x3 * y2 * z1 +
				x2 * y3 * z1 +
				x3 * y1 * z2 -
				x1 * y3 * z2 -
				x2 * y1 * z3 +
				x1 * y2 * z3);

			a=geo.vertices[geo.faces[i].a].distanceTo(geo.vertices[geo.faces[i].b])*factor;
			b=geo.vertices[geo.faces[i].b].distanceTo(geo.vertices[geo.faces[i].c])*factor;
			c=geo.vertices[geo.faces[i].c].distanceTo(geo.vertices[geo.faces[i].a])*factor;
			s=(a+b+c)/2;
			totalArea+=Math.sqrt(s*(s-a)*(s-b)*(s-c));
		}

		return [Math.abs(totalVolume/6), totalArea, geo.faces.length];
	}

	this.get_model_info = function(model_id)
	{
		if (_this.models_ref[model_id]===undefined) return _this.model_error("get_model_info - id not found: "+model_id);

		var model=_this.models[_this.models_ref[model_id]];

		if (!model) return null;
		if (!model.mesh) return null;
		if (!model.mesh.geometry) return null;

		var vol_and_area=model.mesh.geometry?_this.calc_volume_and_area(model.mesh.geometry, model.units=='inch'?1/25.4:1):[0,0,0];
		return {name:model.filename?model.filename:(model.local_file?model.local_file.name:""), orig_filename:model.orig_filename?model.orig_filename:null, position:{x:model.x, y:model.y, z:model.z}, dims:{x:model.mesh.geometry.maxx-model.mesh.geometry.minx, y:model.mesh.geometry.maxy-model.mesh.geometry.miny, z:model.mesh.geometry.maxz-model.mesh.geometry.minz}, rotation:{x:model.mesh.rotation.x,y:model.mesh.rotation.y,z:model.mesh.rotation.z}, display:model.display?model.display:null, color:model.color?model.color:null, scale:{x:model.scalex,y:model.scaley,z:model.scalez}, volume:vol_and_area[0], area:vol_and_area[1], triangles:vol_and_area[2], units:model.units, opacity:model.opacity!==undefined?model.opacity:1};
	}

	this.get_vsb = function()
	{
		var files_arr=[]; //array of model binary data (as arraybuffer)

		Object.keys(_this.models_ref).forEach(function(key)
		{
			files_arr.push({id:key, bin:_this.get_stl_bin(key)});
		});

		//console.log(files_arr);
		//console.log(_this.get_vsj(true));

		return {vsj:_this.get_vsj(true,true,true), files:files_arr};
	}

	this.get_vsj = function(as_js_obj, force_basename, for_vsb)
	{
		//get object info in json format
		var pos=_this.camera.position;
		var data={canvas_height:_this.canvas_height, bg_color:_this.bg_color, camera_state:_this.get_camera_state(), auto_rotate:_this.auto_rotate, mouse_zoom:_this.mouse_zoom, auto_resize:_this.auto_resize, center_models:_this.center_models};
		data['models']=[];

		Object.keys(_this.models_ref).forEach(function(key)
		{
			var model=_this.models[_this.models_ref[key]];
			var info={id:for_vsb?-1:model.id};

			if (for_vsb)
			{
				//console.log(model);
				//var curr_filename=_this.get_model_filename(model, true, true, true);
				//if (curr_filename) info['filename']=curr_filename;
				info['filename']=model.id+'.stl';
			}
			else
			{
				var curr_filename=_this.get_model_filename(model, true, force_basename);
				if (curr_filename) info['filename']=curr_filename;
				if (model.local_file) info['local_file']=model.local_file;
			}

			if (model.x) info['x']=model.x;
			if (model.y) info['y']=model.y;
			if (model.z) info['z']=model.z;
			if (model.display) info['display']=model.display;
			if (!((model.colors)&&(model.color=='#ffffff'))) if (model.color) info['color']=model.color; //if model is colored stl and the color is #FFFFFF, skip color property (cause this is the defauly for colored STL)
			if (model.units) info['units']=model.units;
			if (model.rotationx) info['rotationx']=model.rotationx;
			if (model.rotationy) info['rotationy']=model.rotationy;
			if (model.rotationz) info['rotationz']=model.rotationz;
			if ((model.scale!==undefined)&&(!for_vsb)) if (model.scale!=1) info['scale']=model.scale;
			if ((model.scalex!=1)&&(!for_vsb)) info['scalex']=model.scalex; //in vsb the scale will always be 1, in order to skip scaling when the vsb will be loaded (to avoid double scaling as the geometry is already scalled)
			if ((model.scaley!=1)&&(!for_vsb)) info['scaley']=model.scaley;
			if ((model.scalez!=1)&&(!for_vsb)) info['scalez']=model.scalez;
			if (model.opacity!==undefined) if (model.opacity!=1) info['opacity']=model.opacity;
			if (model.view_edges) info['view_edges']=model.view_edges;
			if (model.animation)
			{
				info['animation']=JSON.parse(JSON.stringify(model.animation)); //clone
				delete info['animation'].start_time;
				delete info['animation'].last_time;
			}

			//data['models'].push(info);
			data['models'][_this.models_ref[key]]=info;


		});

		return as_js_obj?data:_this.json_without_nulls(data);
	}

	this.download_vsj = function(filename)
	{
		var blob = new Blob([_this.get_vsj()], {type: "application/json"});
		var link = document.createElement("a");
		link.href = window.URL.createObjectURL(blob);
		var download_name=filename?filename:"1";
		var p=download_name.toLowerCase().indexOf('.vsj');
		if (p>=0) download_name=download_name.substring( 0, p );
		if (download_name.length<1) download_name='1';

		if (window.navigator.msSaveOrOpenBlob)
		{
			//only for IE
			window.navigator.msSaveBlob(blob, download_name+'.vsj');
			return;
		}

		link.download = download_name+'.vsj';
		link.click();
	}

	this.load_vsj = function(filename)
	{
		if (!filename)
		{
			//not filename, check if VSJ is in memory
			if (_this.pre_loaded_vsj)
			{
				stl_viewer.init_by_json(_this.pre_loaded_vsj);
				_this.pre_loaded_vsj=null;
				return true;
			}

			return _this.model_error("load_vsj - invalid filename"+filename, _this.load_error_callback);
		}

		if (filename instanceof File)
		{
			//a local file - as text, then pass it to init_by_json
			return _this.read_bin_file(filename, _this.init_by_json, null, true);
		}

		//a url - load scene from vsj file
		var xhr = new XMLHttpRequest();

		xhr.onreadystatechange =
		function(e)
		{
			if (xhr.readyState == 4)
			{
				if (xhr.status==200)
				{
					_this.init_by_json(xhr.response.trim());
				}
			}
		}

		xhr.open("GET", filename, true);
		xhr.send(null);
	}


	this.padend=function(s,targetLength,padString)
	{
		targetLength = targetLength>>0; //floor if number or convert non-number to 0;
		padString = String((typeof padString !== 'undefined' ? padString : ' '));
		if (s.length > targetLength)
		{
			return String(s);
		}
		else
		{
			targetLength = targetLength-s.length;
			if (targetLength > padString.length)
			{
				padString += padString.repeat(targetLength/padString.length); //append to original to ensure we are longer than needed
			}
			return String(s) + padString.slice(0,targetLength);
		}
	}

	this.get_normal = function (v1, v2, v3)
	{
		var u= {x:v2.x-v1.x, y:v2.y-v1.y, z:v2.z-v1.z};
		var v= {x:v3.x-v1.x, y:v3.y-v1.y, z:v3.z-v1.z};

		var n={x:0,y:0,z:0};
		n.x=u.y*v.z - u.z*v.y;
		n.y=u.z*v.x - u.x*v.z;
		n.z=u.x*v.y - u.y*v.x;

		//normalize
		var div_val=Math.sqrt(n.x * n.x + n.y * n.y + n.z * n.z);
		if (div_val!=0)
		{
			n.x /= div_val;
			n.y /= div_val;
			n.z /= div_val;
		}

		return(n);
	}

	this.get_stl_bin = function(model_id)
	{
		if (_this.models_ref[model_id]===undefined) return _this.model_error("get_stl_bin - id not found: "+model_id);

		var model=_this.models[_this.models_ref[model_id]];
		if (!model) return;
		if (!model.mesh) return;

		var geo=model.mesh.geometry;
		if (!geo) return;

		var a=new ArrayBuffer(80+4+geo.faces.length*50);
		var d = new DataView(a);

		var enc = new TextEncoder();

		var s=_this.padend(('Binary'+(model.colors?' colored':'')+' STL by viewstl.com'), 80, ' ');
		for (var i=0; i < 80; i++)
		{
			d.setUint8(i, s.charCodeAt(i), true);
		}

		d.setUint32(80, geo.faces.length, true);

		var pos=84;
		Object.keys(geo.faces).forEach(function(face_key)
		{
			var fdata=geo.faces[face_key];
			var v1=geo.vertices[fdata.a];
			var v2=geo.vertices[fdata.b];
			var v3=geo.vertices[fdata.c];
			var color=1;
			var n=_this.get_normal(v1,v2,v3);

			//console.log(v1.x, v1.x.toString(2));

			//normal
			d.setFloat32(pos, n.x, true);pos+=4;
			d.setFloat32(pos, n.y, true);pos+=4;
			d.setFloat32(pos, n.z, true);pos+=4;

			//vertex1
			d.setFloat32(pos, v1.x, true);pos+=4;
			d.setFloat32(pos, v1.y, true);pos+=4;
			d.setFloat32(pos, v1.z, true);pos+=4;

			//vertex2
			d.setFloat32(pos, v2.x, true);pos+=4;
			d.setFloat32(pos, v2.y, true);pos+=4;
			d.setFloat32(pos, v2.z, true);pos+=4;

			//vertex3
			d.setFloat32(pos, v3.x, true);pos+=4;
			d.setFloat32(pos, v3.y, true);pos+=4;
			d.setFloat32(pos, v3.z, true);pos+=4;

			//color (?)
			if (model.colors)
				d.setUint16(pos, Math.ceil(fdata.color.r*31) | (Math.ceil(fdata.color.g*31)<<5) | (Math.ceil(fdata.color.b*31)<<10), true);
			else
				d.setUint16(pos, 0, true);

			pos+=2;

		});

		return a;
	}

	this.basename=function(str)
	{
		return str.substr(str.lastIndexOf('/') + 1);
	}

	this.json_without_nulls=function(arr)
	{
		return JSON.stringify(arr).split(",null").join("");
	}

	this.download_vsb = function(filename)
	{
		var zip=null;
		try
		{
			zip = new JSZip();
		}
		catch(err)
		{
			console.log('download_vsb - JSZip is missing ', err.message);
			return false;
		}

		var vsb=_this.get_vsb();

		zip.file("json_data.vsj", _this.json_without_nulls(vsb.vsj));
		Object.keys(vsb.files).forEach(function(key)
		{
			//console.log("KEY: ",key,vsb.files[key],_this.models_ref,_this.models_ref[vsb.files[key].id],vsb.vsj.models);
			var curr_filename=_this.get_model_filename(vsb.vsj.models[_this.models_ref[vsb.files[key].id]], true, true);
			zip.file(curr_filename, vsb.files[key].bin);
		});

		zip.generateAsync({type:"blob"})
			.then(function(content)
			{
				var blob = new Blob([content], {type: "application/zip"});

				var link = document.createElement("a");
				link.href = window.URL.createObjectURL(blob);
				var download_name=filename?filename:"1";
				var p=download_name.toLowerCase().indexOf('.vsb');
				if (p>=0) download_name=download_name.substring( 0, p );
				if (download_name.length<1) download_name='1';

				if (window.navigator.msSaveOrOpenBlob)
				{
					//only for IE
					window.navigator.msSaveBlob(blob, download_name+'.vsb');
					return;
				}


				link.download = download_name+'.vsb';
				link.click();
			});

		return;
	}

	this.load_vsb = function(filename)
	{
		_this.pre_loaded_ab_files=[];
		_this.pre_loaded_vsj=null;

		if (filename instanceof File)
		{
			//return _this.read_bin_file(filename, _this.load_vsb_from_blob, _this.loading_progress_callback);
			return _this.read_bin_file(filename, _this.load_vsb_from_blob);  //read file - as arraybuffer, then pass it to load_vsb_from_blob
		}

		JSZipUtils.getBinaryContent(decodeURIComponent(filename), function(err, data)
		{
			if(err)
			{
				return _this.model_error("load_vsb "+err, _this.load_error_callback);
			}

			_this.load_vsb_from_blob(data);
		});
	}

	this.read_bin_file=function(f, after_read_func, prog_func, as_text)
	{
		var reader = new FileReader();

		reader.onerror = function(e)
		{
			console.log("reading file error", e);
			return null;
		}

		reader.onload = function(e)
		{
			return after_read_func(e.target.result);
		};

		if (prog_func)
		{
			reader.onprogress = function(e)
			{
				prog_func({loaded:e.loaded, total:e.total, load_session:-1}, -1);
			};
		}

		if (as_text)
			reader.readAsText(f);
		else
			reader.readAsArrayBuffer(f);
	}

	this.load_vsb_from_blob = function(blob)
	{
		var zip=null;
		try
		{
			zip = new JSZip();
		}
		catch(err)
		{
			console.log('load vsb - JSZip is missing ', err.message);
			return false;
		}

		zip.loadAsync(blob).then(function ()
		{
			_this.zip_load_count=Object.keys(zip.files).length;
			zip.forEach(function (relativePath, zipEntry)
			{
				if (zipEntry.name=="json_data.vsj")
				{
					zip.files[zipEntry.name].async('string').then(function (fileData)
					{
						_this.pre_loaded_vsj=fileData;
						_this.zip_load_count--;if (_this.zip_load_count==0) _this.load_vsj(null);
					});
				}
				else
				{
					zip.files[zipEntry.name].async('blob').then(function (fileData)
					{
						_this.pre_loaded_ab_files[zipEntry.name]=fileData;
						_this.zip_load_count--;if (_this.zip_load_count==0) _this.load_vsj(null);
					});
				}
            });
		});
	}

	//load arraybuffer to memory (for later loading)
	this.load_bin_to_ab_file=function(url, ab_data)
	{
		if (!_this.pre_loaded_ab_files) _this.pre_loaded_ab_files=[];
		_this.pre_loaded_ab_files[url]=ab_data;
		_this.add_model({id:-1, filename:url});
	}

	this.download_model = function(model_id, filename)
	{
		if (_this.models_ref[model_id]===undefined) return _this.model_error("download_model - id not found: "+model_id);

		var model=_this.models[_this.models_ref[model_id]];
		if (!model) return;
		if (!model.mesh) return;

		var blob = new Blob([_this.get_stl_bin(model_id)], {type: "application/sla"});
		var link = document.createElement("a");
		link.href = window.URL.createObjectURL(blob);
		//var download_name=filename?filename:(model.filename?model.filename:(model.local_file?model.local_file.name:"1"));
		var download_name=_this.get_model_filename(model,true,true,true);

		var p=download_name.toLowerCase().indexOf('.stl');
		if (p>=0) download_name=download_name.substring( 0, p );
		if (download_name.length<1) download_name='1';

		if (window.navigator.msSaveOrOpenBlob)
		{
			//only for IE
			window.navigator.msSaveBlob(blob, download_name+'.stl');
			return;
		}

		link.download = download_name+'.stl';
		link.click();
	}

	this.get_model_mesh = function(model_id)
	{
		if (_this.models_ref[model_id]===undefined) return _this.model_error("get_model_mesh - id not found: "+model_id);

		var model=_this.models[_this.models_ref[model_id]];
		if (!model) return;
		if (!model.mesh) return;

		var mesh=model.mesh.clone();
		mesh.geometry=model.mesh.geometry.clone();
		mesh.material=model.mesh.material.clone();
		return mesh;
	}


	this.set_auto_rotate = function(b)
	{
		_this.controls.autoRotate=b;
	}

	this.set_mouse_zoom = function(b)
	{
		_this.controls.noZoom=!b;
	}

	//THREE.JS stuff
	//world vectors
	this.WORLD_X_VECTOR=null;
	this.WORLD_Y_VECTOR=null;
	this.WORLD_Z_VECTOR=null;

	this.maxx=null;
	this.maxy=null;
	this.maxz=null;
	this.minx=null;
	this.miny=null;
	this.minz=null;
	this.edges_material=null;
	this.raycaster=null; //used for onmousedown events
	this.mouse =null; //used for onmousedown events
	this.scene = null;
	this.is_webgl=null;
	this.renderer = null;
	this.camera = null;
	this.ambientLight = null;
	this.directionalLight = null;
	this.pointLight = null;
	this.controls = null;

	this.do_resize = function()
	{
		var r=_this.parent_element.getBoundingClientRect();
		var rsize_width=r.width;
		var rsize_height=r.height;

		_this.camera.aspect = rsize_width / rsize_height;
		_this.camera.updateProjectionMatrix();
		_this.renderer.setSize(rsize_width-5, rsize_height-5);
	}

	this.animation=new Array();
	this.animate = function()
	{
		Object.keys(_this.animation).forEach(function(key)
		{
			if (!(_this.models_ref[key]===undefined))
				_this.do_model_animation(_this.models[_this.models_ref[key]]);
		});

 		requestAnimationFrame(_this.animate);
 		_this.renderer.render(_this.scene, _this.camera);

        // screen
        // var w = window.open('', '');
        // w.document.title = "Screenshot";
        // //w.document.body.style.backgroundColor = "red";
        // var img = new Image();
        // // Without 'preserveDrawingBuffer' set to true, we must render now
        // // _this.renderer.render(_this.scene, _this.camera);
        // img.src = _this.renderer.domElement.toDataURL();
        // w.document.body.appendChild(img);
        // screen

 		//console.log(_this.camera.position);

 		if (_this.controls)
			_this.controls.update();
	}

	//called by animate
	this.do_model_animation=function(model)
	{
		//console.log('animation '+model+animation);
		if (!model.animation) return;

		var curr_time=Date.now();
		if (!model.animation.start_time) model.animation.start_time=curr_time;

		if (model.animation.delta)
		{
			var p=(curr_time-model.animation.start_time)/model.animation.delta.msec; //percentage
			var p_from_last_time=model.animation.last_time?((curr_time-model.animation.last_time)/model.animation.delta.msec):p;
			_this.animation_next_delta(model,model.animation.delta,p_from_last_time);

			if (p>=1)
			{
				if (!model.animation.delta.loop)
				{
					_this.remove_model_animation(model, true);
					return;
				}
				else
					//loop - start over
					model.animation.delta.start_time=null;
			}
		}

		if (model.animation.exact)
		{
			var p_from_last_time=(curr_time-(model.animation.last_time?(model.animation.last_time):(model.animation.start_time)))/model.animation.exact.msec;
			_this.animation_next_exact(model,model.animation.exact,p_from_last_time);

			if (curr_time>=model.animation.start_time+model.animation.exact.msec)
			{
				_this.remove_model_animation(model,false,true);
				return;
			}
		}


		model.animation.last_time=curr_time;
	}

	//increments values during animation
	this.animation_next_delta=function(model,a_data,inc_const)
	{
		var done_position=false;
		var done_rotation=false;
		var done_scale=false;
		Object.keys(a_data).forEach(function(key)
		{
			switch(key)
			{
				case 'x':
				case 'y':
				case 'z':
					if (!done_position) //we'll do all x/y/z at once (and one time ...)
					{
						done_position=true;
						_this.set_position(model.id,
							model.x+((a_data.x!==undefined)?(a_data.x*inc_const):0),
							model.y+((a_data.y!==undefined)?(a_data.y*inc_const):0),
							model.z+((a_data.z!==undefined)?(a_data.z*inc_const):0)
						);
					}
					break;

				case 'rotationx':
				case 'rotationy':
				case 'rotationz':
					if (!done_rotation) //we'll do all x/y/z at once (and one time ...)
					{
						done_rotation=true;
						_this.rotate(model.id,
							((a_data.rotationx!==undefined)?(a_data.rotationx*inc_const):0),
							((a_data.rotationy!==undefined)?(a_data.rotationy*inc_const):0),
							((a_data.rotationz!==undefined)?(a_data.rotationz*inc_const):0)
						);
					}
					break;

				case 'scale':
				case 'scalex':
				case 'scaley':
				case 'scalez':
					if (!done_scale) //we'll do all x/y/z at once (and one time ...)
					{
						done_scale=true;
						a_data.scalex=a_data.scalex?a_data.scalex:(a_data.scale?a_data.scale:null);
						a_data.scaley=a_data.scaley?a_data.scaley:(a_data.scale?a_data.scale:null);
						a_data.scalez=a_data.scalez?a_data.scalez:(a_data.scale?a_data.scale:null);
						_this.set_scale(model.id,
							model.scalex+((a_data.scalex!==undefined)?(a_data.scalex*inc_const):0),
							model.scaley+((a_data.scaley!==undefined)?(a_data.scaley*inc_const):0),
							model.scalez+((a_data.scalez!==undefined)?(a_data.scalez*inc_const):0)
						);
					}
					break;

			}
		});
	}

	this.animation_next_exact=function(model,a_data,p_from_last_time)
	{
		var done_position=false;
		var done_rotation=false;
		var done_scale=false;
		Object.keys(a_data).forEach(function(key)
		{
			switch(key)
			{
				case 'x':
				case 'y':
				case 'z':
					if (!done_position) //we'll do all x/y/z at once (and one time ...)
					{
						done_position=true;
						if (a_data.xtotal===undefined) a_data.xtotal=a_data.x-model.x;
						if (a_data.ytotal===undefined) a_data.ytotal=a_data.y-model.y;
						if (a_data.ztotal===undefined) a_data.ztotal=a_data.z-model.z;
						_this.set_position(model.id,
							model.x+((a_data.x!==undefined)?(a_data.xtotal*p_from_last_time):0),
							model.y+((a_data.y!==undefined)?(a_data.ytotal*p_from_last_time):0),
							model.z+((a_data.z!==undefined)?(a_data.ztotal*p_from_last_time):0)
						);
					}
					break;

				case 'rotationx':
				case 'rotationy':
				case 'rotationz':
					if (!done_rotation) //we'll do all x/y/z at once (and one time ...)
					{
						done_rotation=true;
						var rot=model.mesh.getWorldRotation();
						if (a_data.rotxtotal===undefined) a_data.rotxtotal=a_data.rotationx-rot.x;
						if (a_data.rotytotal===undefined) a_data.rotytotal=a_data.rotationy-rot.y;
						if (a_data.rotztotal===undefined) a_data.rotztotal=a_data.rotationz-rot.z;
						_this.rotate(model.id,
							((a_data.rotationx!==undefined)?(a_data.rotxtotal*p_from_last_time):0),
							((a_data.rotationy!==undefined)?(a_data.rotytotal*p_from_last_time):0),
							((a_data.rotationz!==undefined)?(a_data.rotztotal*p_from_last_time):0)
						);
					}
					break;

				case 'scale':
				case 'scalex':
				case 'scaley':
				case 'scalez':
					if (!done_scale) //we'll do all x/y/z at once (and one time ...)
					{
						done_scale=true;
						a_data.scalex=a_data.scalex?a_data.scalex:(a_data.scale?a_data.scale:null);
						a_data.scaley=a_data.scaley?a_data.scaley:(a_data.scale?a_data.scale:null);
						a_data.scalez=a_data.scalez?a_data.scalez:(a_data.scale?a_data.scale:null);
						if (a_data.scalextotal===undefined) a_data.scalextotal=a_data.scalex-model.scalex;
						if (a_data.scaleytotal===undefined) a_data.scaleytotal=a_data.scaley-model.scaley;
						if (a_data.scaleztotal===undefined) a_data.scaleztotal=a_data.scalez-model.scalez;
						_this.set_scale(model.id,
							model.scalex+((a_data.scalex!==undefined)?(a_data.scalextotal*p_from_last_time):0),
							model.scaley+((a_data.scaley!==undefined)?(a_data.scaleytotal*p_from_last_time):0),
							model.scalez+((a_data.scalez!==undefined)?(a_data.scaleztotal*p_from_last_time):0)
						);
					}
					break;

			}
		});
	}

	this.remove_model_animation=function(model, remove_delta, remove_exact)
	{
		if (remove_delta)
			//remove delta part only
			model.animation.delta=null;

		if (remove_exact)
			//remove exact part only
			model.animation.exact=null;

		if ((model.animation.delta)||(model.animation.exact)) return;

		model.animation=null;
		//_this.animation[model.id]=0;
		delete _this.animation[model.id];
	}

	this.animate_model = function(model_id, animation)
	{
		if (_this.models_ref[model_id]===undefined) return _this.model_error("animate-model - id not found: "+model_id);

		var model=_this.models[_this.models_ref[model_id]];
		if (!model) return;

		if (!animation) return _this.remove_model_animation(model,true,true);

		model.animation=JSON.parse(JSON.stringify(animation)); //cloning the animation object

		if (model.animation.delta) if (!model.animation.delta.msec) model.animation.delta.msec=300;
		if (model.animation.exact) if (!model.animation.exact.msec) model.animation.exact.msec=300;
		_this.animation[model_id]=1;
	}

	//init (mainly three js stuff)
	this.init_done=false;
	this.init=function()
	{
		//console.log('init '+_this.parent_element.id, _this.models_to_add);
		if (!_this.init_done) //one time only
		{
			_this.WORLD_X_VECTOR=new THREE.Vector3(1, 0, 0);
			_this.WORLD_Y_VECTOR=new THREE.Vector3(0, 1, 0);
			_this.WORLD_Z_VECTOR=new THREE.Vector3(0, 0, 1);

			_this.edges_material=new THREE.LineBasicMaterial( { color: 0x000000 } );
			_this.raycaster = new THREE.Raycaster(); //used for onmousedown events
			_this.mouse = new THREE.Vector2(); //used for onmousedown events

			//this.material=new THREE.MeshLambertMaterial({color:0x909090, overdraw: 1, wireframe: false, shading:THREE.FlatShading, vertexColors: THREE.FaceColors});
			_this.scene = new THREE.Scene();
			_this.is_webgl=webgl_Detector.webgl;
			_this.renderer = _this.is_webgl ? new THREE.WebGLRenderer({preserveDrawingBuffer:true, alpha:true}): new THREE.CanvasRenderer({alpha:true});
			_this.camera = new THREE.PerspectiveCamera(45, 1, 0.1, 10000);
			_this.parent_element.appendChild(_this.renderer.domElement);
			_this.scene.add(_this.camera);

			_this.ambientLight = new THREE.AmbientLight(0x202020);
			_this.camera.add(_this.ambientLight);

			_this.directionalLight = new THREE.DirectionalLight(0xffffff, 0.75);
			_this.directionalLight.position.x = 1;
			_this.directionalLight.position.y = 1;
			_this.directionalLight.position.z = 2;
			_this.directionalLight.position.normalize();
			_this.camera.add(_this.directionalLight);

			_this.pointLight = new THREE.PointLight(0xffffff, 0.3);
			_this.pointLight.position.x = 0;
			_this.pointLight.position.y = -25;
			_this.pointLight.position.z = 10;
			_this.camera.add(_this.pointLight);

			switch (_this.controls_type)
			{
				case 1: //TrackballControls
					_this.controls = new THREE.TrackballControls(_this.camera, _this.renderer.domElement);
					break;

				default: //OrbitControls
					_this.controls = new THREE.OrbitControls(_this.camera, _this.renderer.domElement);
					_this.controls.autoRotate=_this.auto_rotate;
					break;
			}

			_this.set_on_model_mousedown(_this.onmousedown_callback);
		}

		_this.set_bg_color(_this.bg_color);

		if (_this.mouse_zoom===false)
			_this.set_mouse_zoom(_this.mouse_zoom);

		if (_this.camera_state)
			_this.set_camera_state(_this.camera_state);
		else
			_this.camera.position.set(_this.camerax,_this.cameray,_this.cameraz);

		_this.do_resize();


		//start action
		if (_this.models_to_add)
		{
			_this.add_models(_this.models_to_add);
		}

		_this.set_auto_resize(_this.auto_resize);

		_this.animate();

		_this.init_done=true;

		// custom
        if (_this.on_init_done_callback) {
            _this.on_init_done_callback(_this);
        }
        // custom
	}

	this.set_auto_resize=function(b)
	{
		if (!_this.do_resize) return;

		window.removeEventListener('resize', _this.do_resize);

		if (b)
			window.addEventListener('resize', _this.do_resize);

	}

	this.vf_to_geo = function (vertices, faces, colors)
	{
		if (!vertices) return null;
		if (!faces) return null;

		var geo_vertices=[];
		var geo_faces=[];

		var len=vertices.length;
		for (i=0;i<len;i++)
			geo_vertices.push(new THREE.Vector3(vertices[i][0],vertices[i][1],vertices[i][2]));

		var len=faces.length;

		if (!colors)
		{
			for (i=0;i<len;i++)
				geo_faces.push(new THREE.Face3(faces[i][0],faces[i][1],faces[i][2]));
		}
		else
		{
			for (i=0;i<len;i++)
			{
				var face=new THREE.Face3(faces[i][0],faces[i][1],faces[i][2]);
				face.color.setRGB ( faces[i][3], faces[i][4], faces[i][5] );
				geo_faces.push(face);
			}
		}


		var geo=new THREE.Geometry;
		geo.vertices=geo_vertices;
		geo.faces=geo_faces;
		geo.computeBoundingBox();
		geo.computeFaceNormals();
		geo.computeVertexNormals();

		if (_this.center_models)
			geo.center(geo);

		//_this.set_geo_minmax(geo);

		return (geo);
	}

	//calc min/max positions for a geometry - useful
	this.set_geo_minmax = function (model)
	{
		var geo=model.mesh.geometry;
		if (geo.boundingBox)
		{
			geo.minx=geo.boundingBox.min.x;
			geo.miny=geo.boundingBox.min.y;
			geo.minz=geo.boundingBox.min.z;
			geo.maxx=geo.boundingBox.max.x;
			geo.maxy=geo.boundingBox.max.y;
			geo.maxz=geo.boundingBox.max.z;
		}
		else
		{
			var vertices=geo.vertices;
			var minx=vertices[0].x;
			var miny=vertices[0].y;
			var minz=vertices[0].z;
			var maxx=vertices[0].x;
			var maxy=vertices[0].y;
			var maxz=vertices[0].z;

			var i=vertices.length;
			while (i--)
			{
				if (vertices[i].x<minx) minx=vertices[i].x;
				if (vertices[i].y<miny) miny=vertices[i].y;
				if (vertices[i].z<minz) minz=vertices[i].z;
				if (vertices[i].x>maxx) maxx=vertices[i].x;
				if (vertices[i].y>maxy) maxy=vertices[i].y;
				if (vertices[i].z>maxz) maxz=vertices[i].z;
			}
			geo.minx=minx+model.x;
			geo.miny=miny+model.y;
			geo.minz=minz+model.z;
			geo.maxx=maxx+model.x;
			geo.maxy=maxy+model.y;
			geo.maxz=maxz+model.z;
		}
	}

	//drag and drop
	this.handleDragOver = function(e)
	{
		e.stopPropagation();
		e.preventDefault();
		e.dataTransfer.dropEffect = 'copy';
	}

	this.handleFileDrop = function(e)
	{
		e.stopPropagation();
		e.preventDefault();

		//first, check if its a file
		if (e.dataTransfer.files.length>0)
		{
			_this.load_local_files(e.dataTransfer.files);
		}

		else if (typeof e.dataTransfer.getData("Text") === 'string')
		{
			//check - maybe a url?
			_this.add_model({id:-1, filename:e.dataTransfer.getData("Text")});
			if (_this.on_model_drop) _this.on_model_drop(e.dataTransfer.getData("Text"));
		}
	}

	this.load_local_files = function(files)
	{
		//first, check if its a file
		if (files.length>0)
		{
			var dropped_models=new Array();
			var len=files.length;
			for (var i=0;i<len;i++)
			{
				switch (files[i].name.split('.').pop())
				{
					case 'vsj':
						_this.load_vsj(files[i]);
						break;

					case 'vsb':
						_this.load_vsb(files[i]);
						break;

					default:
						//assumed as a regular model (STL etc.)
						dropped_models.push({id:-1, local_file:files[i]});
				}

				if (_this.on_model_drop) _this.on_model_drop(files[i].name);
			}
			_this.add_models(dropped_models);

		}
	}

	this.clean = function()
	{
		if (!_this.scene) return;
		var scene=_this.scene;
		i=scene.children.length;
		while (i--)
		{
			if (scene.children[i].type==='Mesh')
				scene.remove(scene.children[i]);
		}

		_this.camera.position.set(_this.camerax,_this.cameray,_this.cameraz);

		_this.models=new Array();
		_this.models_count=0;
		_this.models_ref=new Array();
		_this.max_model_id=0;
		_this.load_status=new Array();
		_this.load_session=0;
		_this.loaded_models_arr=new Array();
		_this.animation=new Array();
	}

	this.reset_parent_element=function(parent_element_obj)
	{
		_this.parent_element=parent_element_obj;
		if (_this.allow_drag_and_drop)
			_this.set_drag_and_drop(true);

		_this.set_on_model_mousedown(_this.onmousedown_callback);

		_this.parent_element.appendChild(_this.renderer.domElement);
	}

	this.scripts_loader=null;
	this.external_files_loaded = function()
	{
		_this.ready=true;
		_this.init();
		if (_this.ready_callback)
			_this.ready_callback();
	}

	this.load_three=function(path)
	{
	    console.log(path);
		if (typeof _this.load_three_files != "string") _this.load_three_files="";
		_this.scripts_loader=new ScriptsLoader();
		//_this.scripts_loader.load_scripts(new Array(path+"three.min.js", path+"webgl_detector.js", path+"Projector.js", path+"CanvasRenderer.js", path+"OrbitControls.js"), _this.external_files_loaded);
		//_this.scripts_loader.load_scripts(new Array(path+"three.min.js", path+"webgl_detector.js", path+"Projector.js", path+"CanvasRenderer.js", path+"TrackballControls.js"), _this.external_files_loaded);
		_this.scripts_loader.load_scripts(new Array(path+"three.min.js", path+"webgl_detector.js", path+"Projector.js", path+"CanvasRenderer.js", path+(_this.controls_type==0?"OrbitControls.js":"TrackballControls.js")), _this.external_files_loaded);
	}

	this.init_by_json = function(json_str)
	{
		var data=null;
		try
		{
			data=JSON.parse(json_str);
		}
		catch(err)
		{
			console.log('json error ', json_str);
			return false;
		}

		_this.options=data;

		_this.set_options();

		if (_this.ready)
			_this.init();
	}

	//constructor
	_this.set_options();

	//init if ready
	if (_this.ready)
	{
		_this.init();
		if (_this.ready_callback)
			_this.ready_callback();
	}
	else
	{
		if (!(_this.load_three_files===false))
		{
			//we'll load THREE files by ourselves
			_this.load_three(_this.load_three_files);
		}
		else
			_this.model_error("No THREE files were loaded");
	}

}



function ScriptsLoader()
{
	var _this=this;
	this.all_loaded_callback=null;

	this.scripts_to_load=new Array(); //files in before loading, key=just an index (number)
	this.loading_scripts=new Array(); //loading in progress, key=script name
	this.loaded_scripts=new Array(); //done loading, key=script name

	//returns wheter all scripts in array are loaded
	this.scripts_are_loaded=function(scripts_arr)
	{
		var keys=Object.keys(scripts_arr);

		i=keys.length;

		while (i--)
		{
			if (!_this.loaded_scripts[_this.get_full_name(scripts_arr[i])])
				return false;
		}

		return true;
	}

	//get url with domain and such
	this.get_short_name=function (s)
	{
		if (!s) return '';
		return s.substring(s.lastIndexOf("/") + 1);
	}

	this.load_scripts = function (scripts_arr, all_loaded_callback)
	{
		if (all_loaded_callback) _this.all_loaded_callback=all_loaded_callback;
		Object.keys(scripts_arr).forEach(function(key)
		{
			//var curr_script_name=_this.get_full_name(scripts_arr[key]);
			var curr_script_name=_this.get_short_name(scripts_arr[key]);
			if (_this.scripts_to_load.indexOf(curr_script_name)==-1)
				if (!_this.loading_scripts[curr_script_name])
					if (!_this.loaded_scripts[curr_script_name])
						_this.scripts_to_load.push(scripts_arr[key]);
		});
		_this.load_files();
	}

	this.load_files = function()
	{
		if (_this.scripts_to_load.length==0)
		{
			if (_this.all_loaded_callback) _this.all_loaded_callback();
			return;
		}

		while (_this.scripts_to_load.length)
		{
			var script_name=_this.scripts_to_load.shift();
			if (!_this.loading_scripts[script_name])
			{
				_this.loading_scripts[script_name]=1;

				var script = document.createElement('script');
				script.onload = function ()
				{
					//console.log(_this.scripts_to_load);
					var curr_script_name=_this.get_short_name(script.src);
					//console.log(script.src+" - > "+curr_script_name);
					_this.loaded_scripts[curr_script_name]=1;
					_this.loading_scripts[curr_script_name]=0;

					_this.load_files(); //load next file, if any
				};
				script.src=script_name;
				document.head.appendChild(script);
				return;
			}
		}

	}
}

Number.isInteger = Number.isInteger || function(value)
{
	return typeof value === "number" &&
		isFinite(value) &&
		Math.floor(value) === value;
};

init = function()
{
	if (!!window.MSStream) return; //IE
	var script_path=document.currentScript.attributes['src'].value;
	var x=script_path.lastIndexOf('/');
	stl_viewer_script_path = x > 0 ? script_path.substring(0, x+1) : "";
}();
;
function showRatesForm(b){ajax({url:"/cabinet/cash-desks/get-rates-form",data:{id:b},success:function(a){"undefined"!=typeof a.formHtml&&$("#showRatesForm").html(a.formHtml).modal("show")}})};
;
/**
 * AutoNumeric.js v4.6.0
 *  2009-2019 Robert J. Knothe, Alexandre Bonneau
 * Released under the MIT License.
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.AutoNumeric=t():e.AutoNumeric=t()}(this,function(){return n={},a.m=i=[function(e,t,i){"use strict";i.r(t);var n={allowedTagList:["b","caption","cite","code","const","dd","del","div","dfn","dt","em","h1","h2","h3","h4","h5","h6","input","ins","kdb","label","li","option","output","p","q","s","sample","span","strong","td","th","u"]};Object.freeze(n.allowedTagList),Object.defineProperty(n,"allowedTagList",{configurable:!1,writable:!1}),n.keyCode={Backspace:8,Tab:9,Enter:13,Shift:16,Ctrl:17,Alt:18,Pause:19,CapsLock:20,Esc:27,Space:32,PageUp:33,PageDown:34,End:35,Home:36,LeftArrow:37,UpArrow:38,RightArrow:39,DownArrow:40,Insert:45,Delete:46,num0:48,num1:49,num2:50,num3:51,num4:52,num5:53,num6:54,num7:55,num8:56,num9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,OSLeft:91,OSRight:92,ContextMenu:93,numpad0:96,numpad1:97,numpad2:98,numpad3:99,numpad4:100,numpad5:101,numpad6:102,numpad7:103,numpad8:104,numpad9:105,MultiplyNumpad:106,PlusNumpad:107,MinusNumpad:109,DotNumpad:110,SlashNumpad:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NumLock:144,ScrollLock:145,HyphenFirefox:173,MyComputer:182,MyCalculator:183,Semicolon:186,Equal:187,Comma:188,Hyphen:189,Dot:190,Slash:191,Backquote:192,LeftBracket:219,Backslash:220,RightBracket:221,Quote:222,Command:224,AltGraph:225,AndroidDefault:229},Object.freeze(n.keyCode),Object.defineProperty(n,"keyCode",{configurable:!1,writable:!1}),n.fromCharCodeKeyCode={0:"LaunchCalculator",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",91:"OS",92:"OSRight",93:"ContextMenu",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",173:"-",182:"MyComputer",183:"MyCalculator",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",224:"Meta",225:"AltGraph"},Object.freeze(n.fromCharCodeKeyCode),Object.defineProperty(n,"fromCharCodeKeyCode",{configurable:!1,writable:!1}),n.keyName={Unidentified:"Unidentified",AndroidDefault:"AndroidDefault",Alt:"Alt",AltGr:"AltGraph",CapsLock:"CapsLock",Ctrl:"Control",Fn:"Fn",FnLock:"FnLock",Hyper:"Hyper",Meta:"Meta",OSLeft:"OS",OSRight:"OS",Command:"OS",NumLock:"NumLock",ScrollLock:"ScrollLock",Shift:"Shift",Super:"Super",Symbol:"Symbol",SymbolLock:"SymbolLock",Enter:"Enter",Tab:"Tab",Space:" ",LeftArrow:"ArrowLeft",UpArrow:"ArrowUp",RightArrow:"ArrowRight",DownArrow:"ArrowDown",End:"End",Home:"Home",PageUp:"PageUp",PageDown:"PageDown",Backspace:"Backspace",Clear:"Clear",Copy:"Copy",CrSel:"CrSel",Cut:"Cut",Delete:"Delete",EraseEof:"EraseEof",ExSel:"ExSel",Insert:"Insert",Paste:"Paste",Redo:"Redo",Undo:"Undo",Accept:"Accept",Again:"Again",Attn:"Attn",Cancel:"Cancel",ContextMenu:"ContextMenu",Esc:"Escape",Execute:"Execute",Find:"Find",Finish:"Finish",Help:"Help",Pause:"Pause",Play:"Play",Props:"Props",Select:"Select",ZoomIn:"ZoomIn",ZoomOut:"ZoomOut",BrightnessDown:"BrightnessDown",BrightnessUp:"BrightnessUp",Eject:"Eject",LogOff:"LogOff",Power:"Power",PowerOff:"PowerOff",PrintScreen:"PrintScreen",Hibernate:"Hibernate",Standby:"Standby",WakeUp:"WakeUp",Compose:"Compose",Dead:"Dead",F1:"F1",F2:"F2",F3:"F3",F4:"F4",F5:"F5",F6:"F6",F7:"F7",F8:"F8",F9:"F9",F10:"F10",F11:"F11",F12:"F12",Print:"Print",num0:"0",num1:"1",num2:"2",num3:"3",num4:"4",num5:"5",num6:"6",num7:"7",num8:"8",num9:"9",a:"a",b:"b",c:"c",d:"d",e:"e",f:"f",g:"g",h:"h",i:"i",j:"j",k:"k",l:"l",m:"m",n:"n",o:"o",p:"p",q:"q",r:"r",s:"s",t:"t",u:"u",v:"v",w:"w",x:"x",y:"y",z:"z",A:"A",B:"B",C:"C",D:"D",E:"E",F:"F",G:"G",H:"H",I:"I",J:"J",K:"K",L:"L",M:"M",N:"N",O:"O",P:"P",Q:"Q",R:"R",S:"S",T:"T",U:"U",V:"V",W:"W",X:"X",Y:"Y",Z:"Z",Semicolon:";",Equal:"=",Comma:",",Hyphen:"-",Minus:"-",Plus:"+",Dot:".",Slash:"/",Backquote:"`",LeftParenthesis:"(",RightParenthesis:")",LeftBracket:"[",RightBracket:"]",Backslash:"\\",Quote:"'",numpad0:"0",numpad1:"1",numpad2:"2",numpad3:"3",numpad4:"4",numpad5:"5",numpad6:"6",numpad7:"7",numpad8:"8",numpad9:"9",NumpadDot:".",NumpadDotAlt:",",NumpadMultiply:"*",NumpadPlus:"+",NumpadMinus:"-",NumpadSubtract:"-",NumpadSlash:"/",NumpadDotObsoleteBrowsers:"Decimal",NumpadMultiplyObsoleteBrowsers:"Multiply",NumpadPlusObsoleteBrowsers:"Add",NumpadMinusObsoleteBrowsers:"Subtract",NumpadSlashObsoleteBrowsers:"Divide",_allFnKeys:["F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12"],_someNonPrintableKeys:["Tab","Enter","Shift","ShiftLeft","ShiftRight","Control","ControlLeft","ControlRight","Alt","AltLeft","AltRight","Pause","CapsLock","Escape"],_directionKeys:["PageUp","PageDown","End","Home","ArrowDown","ArrowLeft","ArrowRight","ArrowUp"]},Object.freeze(n.keyName._allFnKeys),Object.freeze(n.keyName._someNonPrintableKeys),Object.freeze(n.keyName._directionKeys),Object.freeze(n.keyName),Object.defineProperty(n,"keyName",{configurable:!1,writable:!1}),Object.freeze(n);var d=n;function a(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||s(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}).apply(this,arguments)}function h(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var i=[],n=!0,a=!1,r=void 0;try{for(var s,o=e[Symbol.iterator]();!(n=(s=o.next()).done)&&(i.push(s.value),!t||i.length!==t);n=!0);}catch(e){a=!0,r=e}finally{try{n||null==o.return||o.return()}finally{if(a)throw r}}return i}}(e,t)||s(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){if(e){if("string"==typeof e)return o(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(i):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?o(e,t):void 0}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var M=function(){function s(){!function(e){if(!(e instanceof s))throw new TypeError("Cannot call a class as a function")}(this)}return function(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(s,[{key:"isNull",value:function(e){return null===e}},{key:"isUndefined",value:function(e){return void 0===e}},{key:"isUndefinedOrNullOrEmpty",value:function(e){return null==e||""===e}},{key:"isString",value:function(e){return"string"==typeof e||e instanceof String}},{key:"isEmptyString",value:function(e){return""===e}},{key:"isBoolean",value:function(e){return"boolean"==typeof e}},{key:"isTrueOrFalseString",value:function(e){var t=String(e).toLowerCase();return"true"===t||"false"===t}},{key:"isObject",value:function(e){return"object"===l(e)&&null!==e&&!Array.isArray(e)}},{key:"isEmptyObj",value:function(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}},{key:"isNumberStrict",value:function(e){return"number"==typeof e}},{key:"isNumber",value:function(e){return!this.isArray(e)&&!isNaN(parseFloat(e))&&isFinite(e)}},{key:"isDigit",value:function(e){return/\d/.test(e)}},{key:"isNumberOrArabic",value:function(e){var t=this.arabicToLatinNumbers(e,!1,!0,!0);return this.isNumber(t)}},{key:"isInt",value:function(e){return"number"==typeof e&&parseFloat(e)===parseInt(e,10)&&!isNaN(e)}},{key:"isFunction",value:function(e){return"function"==typeof e}},{key:"isIE11",value:function(){return"undefined"!=typeof window&&!!window.MSInputMethodContext&&!!document.documentMode}},{key:"contains",value:function(e,t){return!(!this.isString(e)||!this.isString(t)||""===e||""===t)&&-1!==e.indexOf(t)}},{key:"isInArray",value:function(e,t){return!(!this.isArray(t)||t===[]||this.isUndefined(e))&&-1!==t.indexOf(e)}},{key:"isArray",value:function(e){if("[object Array]"===Object.prototype.toString.call([]))return Array.isArray(e)||"object"===l(e)&&"[object Array]"===Object.prototype.toString.call(e);throw new Error("toString message changed for Object Array")}},{key:"isElement",value:function(e){return"undefined"!=typeof Element&&e instanceof Element}},{key:"isInputElement",value:function(e){return this.isElement(e)&&"input"===e.tagName.toLowerCase()}},{key:"decimalPlaces",value:function(e){var t=h(e.split("."),2)[1];return this.isUndefined(t)?0:t.length}},{key:"indexFirstNonZeroDecimalPlace",value:function(e){var t=h(String(Math.abs(e)).split("."),2)[1];if(this.isUndefined(t))return 0;var i=t.lastIndexOf("0");return-1===i?i=0:i+=2,i}},{key:"keyCodeNumber",value:function(e){return void 0===e.which?e.keyCode:e.which}},{key:"character",value:function(e){var t;if("Unidentified"===e.key||void 0===e.key||this.isSeleniumBot()){var i=this.keyCodeNumber(e);if(i===d.keyCode.AndroidDefault)return d.keyName.AndroidDefault;var n=d.fromCharCodeKeyCode[i];t=s.isUndefinedOrNullOrEmpty(n)?String.fromCharCode(i):n}else{var a;switch(e.key){case"Add":t=d.keyName.NumpadPlus;break;case"Apps":t=d.keyName.ContextMenu;break;case"Crsel":t=d.keyName.CrSel;break;case"Decimal":t=e.char?e.char:d.keyName.NumpadDot;break;case"Del":t="firefox"===(a=this.browser()).name&&a.version<=36||"ie"===a.name&&a.version<=9?d.keyName.Dot:d.keyName.Delete;break;case"Divide":t=d.keyName.NumpadSlash;break;case"Down":t=d.keyName.DownArrow;break;case"Esc":t=d.keyName.Esc;break;case"Exsel":t=d.keyName.ExSel;break;case"Left":t=d.keyName.LeftArrow;break;case"Meta":case"Super":t=d.keyName.OSLeft;break;case"Multiply":t=d.keyName.NumpadMultiply;break;case"Right":t=d.keyName.RightArrow;break;case"Spacebar":t=d.keyName.Space;break;case"Subtract":t=d.keyName.NumpadMinus;break;case"Up":t=d.keyName.UpArrow;break;default:t=e.key}}return t}},{key:"browser",value:function(){var e,t=navigator.userAgent,i=t.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(i[1])?{name:"ie",version:(e=/\brv[ :]+(\d+)/g.exec(t)||[])[1]||""}:"Chrome"===i[1]&&null!==(e=t.match(/\b(OPR|Edge)\/(\d+)/))?{name:e[1].replace("OPR","opera"),version:e[2]}:(i=i[2]?[i[1],i[2]]:[navigator.appName,navigator.appVersion,"-?"],null!==(e=t.match(/version\/(\d+)/i))&&i.splice(1,1,e[1]),{name:i[0].toLowerCase(),version:i[1]})}},{key:"isSeleniumBot",value:function(){return!0===window.navigator.webdriver}},{key:"isNegative",value:function(e,t,i){var n=1<arguments.length&&void 0!==t?t:"-",a=!(2<arguments.length&&void 0!==i)||i;return e===n||""!==e&&(s.isNumber(e)?e<0:a?this.contains(e,n):this.isNegativeStrict(e,n))}},{key:"isNegativeStrict",value:function(e,t){var i=1<arguments.length&&void 0!==t?t:"-";return e.charAt(0)===i}},{key:"isNegativeWithBrackets",value:function(e,t,i){return e.charAt(0)===t&&this.contains(e,i)}},{key:"isZeroOrHasNoValue",value:function(e){return!/[1-9]/g.test(e)}},{key:"setRawNegativeSign",value:function(e){return this.isNegativeStrict(e,"-")?e:"-".concat(e)}},{key:"replaceCharAt",value:function(e,t,i){return"".concat(e.substr(0,t)).concat(i).concat(e.substr(t+i.length))}},{key:"clampToRangeLimits",value:function(e,t){return Math.max(t.minimumValue,Math.min(t.maximumValue,e))}},{key:"countNumberCharactersOnTheCaretLeftSide",value:function(e,t,i){for(var n=new RegExp("[0-9".concat(i,"-]")),a=0,r=0;r<t;r++)n.test(e[r])&&a++;return a}},{key:"findCaretPositionInFormattedNumber",value:function(e,t,i,n){var a,r=i.length,s=e.length,o=0;for(a=0;a<r&&o<s&&o<t;a++)(e[o]===i[a]||"."===e[o]&&i[a]===n)&&o++;return a}},{key:"countCharInText",value:function(e,t){for(var i=0,n=0;n<t.length;n++)t[n]===e&&i++;return i}},{key:"convertCharacterCountToIndexPosition",value:function(e){return Math.max(e,e-1)}},{key:"getElementSelection",value:function(e){var t,i={};try{t=this.isUndefined(e.selectionStart)}catch(e){t=!1}try{if(t){var n=window.getSelection().getRangeAt(0);i.start=n.startOffset,i.end=n.endOffset,i.length=i.end-i.start}else i.start=e.selectionStart,i.end=e.selectionEnd,i.length=i.end-i.start}catch(e){i.start=0,i.end=0,i.length=0}return i}},{key:"setElementSelection",value:function(e,t,i){var n=2<arguments.length&&void 0!==i?i:null;if(this.isUndefinedOrNullOrEmpty(n)&&(n=t),this.isInputElement(e))e.setSelectionRange(t,n);else if(!s.isNull(e.firstChild)){var a=document.createRange();a.setStart(e.firstChild,t),a.setEnd(e.firstChild,n);var r=window.getSelection();r.removeAllRanges(),r.addRange(a)}}},{key:"throwError",value:function(e){throw new Error(e)}},{key:"warning",value:function(e,t){1<arguments.length&&void 0!==t&&!t||console.warn("Warning: ".concat(e))}},{key:"isWheelUpEvent",value:function(e){return e.deltaY||this.throwError("The event passed as a parameter is not a valid wheel event, '".concat(e.type,"' given.")),e.deltaY<0}},{key:"isWheelDownEvent",value:function(e){return e.deltaY||this.throwError("The event passed as a parameter is not a valid wheel event, '".concat(e.type,"' given.")),0<e.deltaY}},{key:"forceDecimalPlaces",value:function(e,t){var i=h(String(e).split("."),2),n=i[0],a=i[1];return a?"".concat(n,".").concat(a.substr(0,t)):e}},{key:"roundToNearest",value:function(e,t){var i=1<arguments.length&&void 0!==t?t:1e3;return 0===e?0:(0===i&&this.throwError("The `stepPlace` used to round is equal to `0`. This value must not be equal to zero."),Math.round(e/i)*i)}},{key:"modifyAndRoundToNearestAuto",value:function(e,t,i){e=Number(this.forceDecimalPlaces(e,i));var n=Math.abs(e);if(0<=n&&n<1){var a,r=Math.pow(10,-i);if(0===e)return t?r:-r;var s,o=i,l=this.indexFirstNonZeroDecimalPlace(e);return a=o-1<=l?r:Math.pow(10,-(l+1)),s=t?e+a:e-a,this.roundToNearest(s,a)}e=parseInt(e,10);var u,c=Math.abs(e).toString().length;switch(c){case 1:u=0;break;case 2:case 3:u=1;break;case 4:case 5:u=2;break;default:u=c-3}var h,m=Math.pow(10,u);return(h=t?e+m:e-m)<=10&&-10<=h?h:this.roundToNearest(h,m)}},{key:"addAndRoundToNearestAuto",value:function(e,t){return this.modifyAndRoundToNearestAuto(e,!0,t)}},{key:"subtractAndRoundToNearestAuto",value:function(e,t){return this.modifyAndRoundToNearestAuto(e,!1,t)}},{key:"arabicToLatinNumbers",value:function(e,t,i,n){var a=!(1<arguments.length&&void 0!==t)||t,r=2<arguments.length&&void 0!==i&&i,s=3<arguments.length&&void 0!==n&&n;if(this.isNull(e))return e;var o=e.toString();if(""===o)return e;if(null===o.match(/[]/g))return a&&(o=Number(o)),o;r&&(o=o.replace(//,".")),s&&(o=o.replace(//g,"")),o=o.replace(/[]/g,function(e){return e.charCodeAt(0)-1632}).replace(/[]/g,function(e){return e.charCodeAt(0)-1776});var l=Number(o);return isNaN(l)?l:(a&&(o=l),o)}},{key:"triggerEvent",value:function(e,t,i,n,a){var r,s=1<arguments.length&&void 0!==t?t:document,o=2<arguments.length&&void 0!==i?i:null,l=!(3<arguments.length&&void 0!==n)||n,u=!(4<arguments.length&&void 0!==a)||a;window.CustomEvent?r=new CustomEvent(e,{detail:o,bubbles:l,cancelable:u}):(r=document.createEvent("CustomEvent")).initCustomEvent(e,l,u,{detail:o}),s.dispatchEvent(r)}},{key:"parseStr",value:function(e){var t,i,n,a,r={};if(0===e&&1/e<0&&(e="-0"),e=e.toString(),this.isNegativeStrict(e,"-")?(e=e.slice(1),r.s=-1):r.s=1,-1<(t=e.indexOf("."))&&(e=e.replace(".","")),t<0&&(t=e.length),(i=-1===e.search(/[1-9]/i)?e.length:e.search(/[1-9]/i))===(n=e.length))r.e=0,r.c=[0];else{for(a=n-1;"0"===e.charAt(a);--a)--n;for(--n,r.e=t-i-1,r.c=[],t=0;i<=n;i+=1)r.c[t]=+e.charAt(i),t+=1}return r}},{key:"testMinMax",value:function(e,t){var i=t.c,n=e.c,a=t.s,r=e.s,s=t.e,o=e.e;if(!i[0]||!n[0])return i[0]?a:n[0]?-r:0;if(a!==r)return a;var l=a<0;if(s!==o)return o<s^l?1:-1;for(a=-1,r=(s=i.length)<(o=n.length)?s:o,a+=1;a<r;a+=1)if(i[a]!==n[a])return i[a]>n[a]^l?1:-1;return s===o?0:o<s^l?1:-1}},{key:"randomString",value:function(e){var t=0<arguments.length&&void 0!==e?e:5;return Math.random().toString(36).substr(2,t)}},{key:"domElement",value:function(e){return s.isString(e)?document.querySelector(e):e}},{key:"getElementValue",value:function(e){return"input"===e.tagName.toLowerCase()?e.value:this.text(e)}},{key:"setElementValue",value:function(e,t){var i=1<arguments.length&&void 0!==t?t:null;"input"===e.tagName.toLowerCase()?e.value=i:e.textContent=i}},{key:"setInvalidState",value:function(e,t){var i=1<arguments.length&&void 0!==t?t:"Invalid";""!==i&&!this.isNull(i)||this.throwError("Cannot set the invalid state with an empty message."),e.setCustomValidity(i)}},{key:"setValidState",value:function(e){e.setCustomValidity("")}},{key:"cloneObject",value:function(e){return r({},e)}},{key:"camelize",value:function(e,t,i,n){var a=1<arguments.length&&void 0!==t?t:"-",r=!(2<arguments.length&&void 0!==i)||i,s=!(3<arguments.length&&void 0!==n)||n;if(this.isNull(e))return null;r&&(e=e.replace(/^data-/,""));var o=e.split(a).map(function(e){return"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1))});return o=o.join(""),s&&(o="".concat(o.charAt(0).toLowerCase()).concat(o.slice(1))),o}},{key:"text",value:function(e){var t=e.nodeType;return t===Node.ELEMENT_NODE||t===Node.DOCUMENT_NODE||t===Node.DOCUMENT_FRAGMENT_NODE?e.textContent:t===Node.TEXT_NODE?e.nodeValue:""}},{key:"setText",value:function(e,t){var i=e.nodeType;i!==Node.ELEMENT_NODE&&i!==Node.DOCUMENT_NODE&&i!==Node.DOCUMENT_FRAGMENT_NODE||(e.textContent=t)}},{key:"filterOut",value:function(e,t){var i=this;return e.filter(function(e){return!i.isInArray(e,t)})}},{key:"trimPaddedZerosFromDecimalPlaces",value:function(e){if(""===(e=String(e)))return"";var t=h(e.split("."),2),i=t[0],n=t[1];if(this.isUndefinedOrNullOrEmpty(n))return i;var a=n.replace(/0+$/g,"");return""===a?i:"".concat(i,".").concat(a)}},{key:"getHoveredElement",value:function(){var e=a(document.querySelectorAll(":hover"));return e[e.length-1]}},{key:"arrayTrim",value:function(e,t){var i=e.length;return 0===i||i<t?e:t<0?[]:(e.length=parseInt(t,10),e)}},{key:"arrayUnique",value:function(){var e;return a(new Set((e=[]).concat.apply(e,arguments)))}},{key:"mergeMaps",value:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return new Map(t.reduce(function(e,t){return e.concat(a(t))},[]))}},{key:"objectKeyLookup",value:function(e,t){var i=Object.entries(e).find(function(e){return e[1]===t}),n=null;return void 0!==i&&(n=i[0]),n}},{key:"insertAt",value:function(e,t,i){if(i>(e=String(e)).length)throw new Error("The given index is out of the string range.");if(1!==t.length)throw new Error("The given string `char` should be only one character long.");return""===e&&0===i?t:"".concat(e.slice(0,i)).concat(t).concat(e.slice(i))}},{key:"scientificToDecimal",value:function(e){var t=Number(e);if(isNaN(t))return NaN;if(e=String(e),!this.contains(e,"e")&&!this.contains(e,"E"))return e;var i=h(e.split(/e/i),2),n=i[0],a=i[1],r=n<0;r&&(n=n.replace("-",""));var s=+a<0;s&&(a=a.replace("-",""));var o,l=h(n.split(/\./),2),u=l[0],c=l[1];return o=s?(o=u.length>a?this.insertAt(u,".",u.length-a):"0.".concat("0".repeat(a-u.length)).concat(u),"".concat(o).concat(c||"")):c?(n="".concat(u).concat(c),a<c.length?this.insertAt(n,".",+a+u.length):"".concat(n).concat("0".repeat(a-c.length))):(n=n.replace(".",""),"".concat(n).concat("0".repeat(Number(a)))),r&&(o="-".concat(o)),o}}]),s}(),u=function(){function t(e){if(function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),null===e)throw new Error("Invalid AST")}return function(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(t.prototype,[{key:"evaluate",value:function(e){if(null==e)throw new Error("Invalid AST sub-tree");if("number"===e.type)return e.value;if("unaryMinus"===e.type)return-this.evaluate(e.left);var t=this.evaluate(e.left),i=this.evaluate(e.right);switch(e.type){case"op_+":return Number(t)+Number(i);case"op_-":return t-i;case"op_*":return t*i;case"op_/":return t/i;default:throw new Error("Invalid operator '".concat(e.type,"'"))}}}]),t}(),c=function(){function a(){!function(e){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}(this)}return function(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(a,[{key:"createNode",value:function(e,t,i){var n=new a;return n.type=e,n.left=t,n.right=i,n}},{key:"createUnaryNode",value:function(e){var t=new a;return t.type="unaryMinus",t.left=e,t.right=null,t}},{key:"createLeaf",value:function(e){var t=new a;return t.type="number",t.value=e,t}}]),a}();function m(e,t,i){!function(e){if(!(e instanceof m))throw new TypeError("Cannot call a class as a function")}(this),this.type=e,this.value=t,this.symbol=i}var g=function(){function t(e){!function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.text=e,this.textLength=e.length,this.index=0,this.token=new m("Error",0,0)}return function(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(t.prototype,[{key:"_skipSpaces",value:function(){for(;" "===this.text[this.index]&&this.index<=this.textLength;)this.index++}},{key:"getIndex",value:function(){return this.index}},{key:"getNextToken",value:function(e){var t=0<arguments.length&&void 0!==e?e:".";if(this._skipSpaces(),this.textLength===this.index)return this.token.type="EOT",this.token;if(M.isDigit(this.text[this.index]))return this.token.type="num",this.token.value=this._getNumber(t),this.token;switch(this.token.type="Error",this.text[this.index]){case"+":this.token.type="+";break;case"-":this.token.type="-";break;case"*":this.token.type="*";break;case"/":this.token.type="/";break;case"(":this.token.type="(";break;case")":this.token.type=")"}if("Error"===this.token.type)throw new Error("Unexpected token '".concat(this.token.symbol,"' at position '").concat(this.token.index,"' in the token function"));return this.token.symbol=this.text[this.index],this.index++,this.token}},{key:"_getNumber",value:function(e){this._skipSpaces();for(var t=this.index;this.index<=this.textLength&&M.isDigit(this.text[this.index]);)this.index++;for(this.text[this.index]===e&&this.index++;this.index<=this.textLength&&M.isDigit(this.text[this.index]);)this.index++;if(this.index===t)throw new Error("No number has been found while it was expected");return this.text.substring(t,this.index).replace(e,".")}}]),t}(),v=function(){function i(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:".";return function(e){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}(this),this.text=e,this.decimalCharacter=t,this.lexer=new g(e),this.token=this.lexer.getNextToken(this.decimalCharacter),this._exp()}return function(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(i.prototype,[{key:"_exp",value:function(){var e=this._term(),t=this._moreExp();return c.createNode("op_+",e,t)}},{key:"_moreExp",value:function(){var e,t;switch(this.token.type){case"+":return this.token=this.lexer.getNextToken(this.decimalCharacter),e=this._term(),t=this._moreExp(),c.createNode("op_+",t,e);case"-":return this.token=this.lexer.getNextToken(this.decimalCharacter),e=this._term(),t=this._moreExp(),c.createNode("op_-",t,e)}return c.createLeaf(0)}},{key:"_term",value:function(){var e=this._factor(),t=this._moreTerms();return c.createNode("op_*",e,t)}},{key:"_moreTerms",value:function(){var e,t;switch(this.token.type){case"*":return this.token=this.lexer.getNextToken(this.decimalCharacter),e=this._factor(),t=this._moreTerms(),c.createNode("op_*",t,e);case"/":return this.token=this.lexer.getNextToken(this.decimalCharacter),e=this._factor(),t=this._moreTerms(),c.createNode("op_/",t,e)}return c.createLeaf(1)}},{key:"_factor",value:function(){var e,t,i;switch(this.token.type){case"num":return i=this.token.value,this.token=this.lexer.getNextToken(this.decimalCharacter),c.createLeaf(i);case"-":return this.token=this.lexer.getNextToken(this.decimalCharacter),t=this._factor(),c.createUnaryNode(t);case"(":return this.token=this.lexer.getNextToken(this.decimalCharacter),e=this._exp(),this._match(")"),e;default:throw new Error("Unexpected token '".concat(this.token.symbol,"' with type '").concat(this.token.type,"' at position '").concat(this.token.index,"' in the factor function"))}}},{key:"_match",value:function(e){var t=this.lexer.getIndex()-1;if(this.text[t]!==e)throw new Error("Unexpected token '".concat(this.token.symbol,"' at position '").concat(t,"' in the match function"));this.token=this.lexer.getNextToken(this.decimalCharacter)}}]),i}();function p(e){return function(e){if(Array.isArray(e))return y(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||f(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var i=[],n=!0,a=!1,r=void 0;try{for(var s,o=e[Symbol.iterator]();!(n=(s=o.next()).done)&&(i.push(s.value),!t||i.length!==t);n=!0);}catch(e){a=!0,r=e}finally{try{n||null==o.return||o.return()}finally{if(a)throw r}}return i}}(e,t)||f(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){if(e){if("string"==typeof e)return y(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(i):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?y(e,t):void 0}}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function b(){return(b=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}).apply(this,arguments)}function w(e){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function P(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var O,k=function(){function B(){var s=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;!function(e){if(!(e instanceof B))throw new TypeError("Cannot call a class as a function")}(this);var n=B._setArgumentsValues(e,t,i),a=n.domElement,r=n.initialValue,o=n.userOptions;if(this.domElement=a,this.defaultRawValue="",this._setSettings(o,!1),this._checkElement(),this.savedCancellableValue=null,this.historyTable=[],this.historyTableIndex=-1,this.onGoingRedo=!1,this.parentForm=this._getParentForm(),!this.runOnce&&this.settings.formatOnPageLoad)this._formatDefaultValueOnPageLoad(r);else{var l;if(M.isNull(r))switch(this.settings.emptyInputBehavior){case B.options.emptyInputBehavior.min:l=this.settings.minimumValue;break;case B.options.emptyInputBehavior.max:l=this.settings.maximumValue;break;case B.options.emptyInputBehavior.zero:l="0";break;case B.options.emptyInputBehavior.focus:case B.options.emptyInputBehavior.press:case B.options.emptyInputBehavior.always:case B.options.emptyInputBehavior.null:l="";break;default:l=this.settings.emptyInputBehavior}else l=r;this._setElementAndRawValue(l)}this.runOnce=!0,this.hasEventListeners=!1,(this.isInputElement||this.isContentEditable)&&(this.settings.noEventListeners||this._createEventListeners(),this._setWritePermissions(!0)),this._saveInitialValues(r),this.sessionStorageAvailable=this.constructor._storageTest(),this.storageNamePrefix="AUTO_",this._setPersistentStorageName(),this.validState=!0,this.isFocused=!1,this.isWheelEvent=!1,this.isDropEvent=!1,this.isEditing=!1,this.rawValueOnFocus=void 0,this.internalModification=!1,this.attributeToWatch=this._getAttributeToWatch(),this.getterSetter=Object.getOwnPropertyDescriptor(this.domElement.__proto__,this.attributeToWatch),this._addWatcher(),this.settings.createLocalList&&this._createLocalList(),this.constructor._addToGlobalList(this),this.global={set:function(t,e){var i=1<arguments.length&&void 0!==e?e:null;s.autoNumericLocalList.forEach(function(e){e.set(t,i)})},setUnformatted:function(t,e){var i=1<arguments.length&&void 0!==e?e:null;s.autoNumericLocalList.forEach(function(e){e.setUnformatted(t,i)})},get:function(e){var t=0<arguments.length&&void 0!==e?e:null,i=[];return s.autoNumericLocalList.forEach(function(e){i.push(e.get())}),s._executeCallback(i,t),i},getNumericString:function(e){var t=0<arguments.length&&void 0!==e?e:null,i=[];return s.autoNumericLocalList.forEach(function(e){i.push(e.getNumericString())}),s._executeCallback(i,t),i},getFormatted:function(e){var t=0<arguments.length&&void 0!==e?e:null,i=[];return s.autoNumericLocalList.forEach(function(e){i.push(e.getFormatted())}),s._executeCallback(i,t),i},getNumber:function(e){var t=0<arguments.length&&void 0!==e?e:null,i=[];return s.autoNumericLocalList.forEach(function(e){i.push(e.getNumber())}),s._executeCallback(i,t),i},getLocalized:function(e){var t=0<arguments.length&&void 0!==e?e:null,i=[];return s.autoNumericLocalList.forEach(function(e){i.push(e.getLocalized())}),s._executeCallback(i,t),i},reformat:function(){s.autoNumericLocalList.forEach(function(e){e.reformat()})},unformat:function(){s.autoNumericLocalList.forEach(function(e){e.unformat()})},unformatLocalized:function(e){var t=0<arguments.length&&void 0!==e?e:null;s.autoNumericLocalList.forEach(function(e){e.unformatLocalized(t)})},update:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];s.autoNumericLocalList.forEach(function(e){e.update.apply(e,t)})},isPristine:function(){var t=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],i=!0;return s.autoNumericLocalList.forEach(function(e){i&&!e.isPristine(t)&&(i=!1)}),i},clear:function(e){var t=0<arguments.length&&void 0!==e&&e;s.autoNumericLocalList.forEach(function(e){e.clear(t)})},remove:function(){s.autoNumericLocalList.forEach(function(e){e.remove()})},wipe:function(){s.autoNumericLocalList.forEach(function(e){e.wipe()})},nuke:function(){s.autoNumericLocalList.forEach(function(e){e.nuke()})},has:function(e){return e instanceof B?s.autoNumericLocalList.has(e.node()):s.autoNumericLocalList.has(e)},addObject:function(e){var t,i;i=e instanceof B?(t=e.node(),e):B.getAutoNumericElement(t=e),s._hasLocalList()||s._createLocalList();var n,a=i._getLocalList();0===a.size&&(i._createLocalList(),a=i._getLocalList()),(n=a instanceof Map?M.mergeMaps(s._getLocalList(),a):(s._addToLocalList(t,i),s._getLocalList())).forEach(function(e){e._setLocalList(n)})},removeObject:function(e,t){var i,n,a=1<arguments.length&&void 0!==t&&t;n=e instanceof B?(i=e.node(),e):B.getAutoNumericElement(i=e);var r=s.autoNumericLocalList;s.autoNumericLocalList.delete(i),r.forEach(function(e){e._setLocalList(s.autoNumericLocalList)}),a||i!==s.node()?n._createLocalList():n._setLocalList(new Map)},empty:function(e){var t=0<arguments.length&&void 0!==e&&e;s.autoNumericLocalList.forEach(function(e){t?e._createLocalList():e._setLocalList(new Map)})},elements:function(){var t=[];return s.autoNumericLocalList.forEach(function(e){t.push(e.node())}),t},getList:function(){return s.autoNumericLocalList},size:function(){return s.autoNumericLocalList.size}},this.options={reset:function(){return s.settings={rawValue:s.defaultRawValue},s.update(B.defaultSettings),s},allowDecimalPadding:function(e){return s.update({allowDecimalPadding:e}),s},alwaysAllowDecimalCharacter:function(e){return s.update({alwaysAllowDecimalCharacter:e}),s},caretPositionOnFocus:function(e){return s.settings.caretPositionOnFocus=e,s},createLocalList:function(e){return s.settings.createLocalList=e,s.settings.createLocalList?s._hasLocalList()||s._createLocalList():s._deleteLocalList(),s},currencySymbol:function(e){return s.update({currencySymbol:e}),s},currencySymbolPlacement:function(e){return s.update({currencySymbolPlacement:e}),s},decimalCharacter:function(e){return s.update({decimalCharacter:e}),s},decimalCharacterAlternative:function(e){return s.settings.decimalCharacterAlternative=e,s},decimalPlaces:function(e){return M.warning("Using `options.decimalPlaces()` instead of calling the specific `options.decimalPlacesRawValue()`, `options.decimalPlacesShownOnFocus()` and `options.decimalPlacesShownOnBlur()` methods will reset those options.\nPlease call the specific methods if you do not want to reset those.",s.settings.showWarnings),s.update({decimalPlaces:e}),s},decimalPlacesRawValue:function(e){return s.update({decimalPlacesRawValue:e}),s},decimalPlacesShownOnBlur:function(e){return s.update({decimalPlacesShownOnBlur:e}),s},decimalPlacesShownOnFocus:function(e){return s.update({decimalPlacesShownOnFocus:e}),s},defaultValueOverride:function(e){return s.update({defaultValueOverride:e}),s},digitalGroupSpacing:function(e){return s.update({digitalGroupSpacing:e}),s},digitGroupSeparator:function(e){return s.update({digitGroupSeparator:e}),s},divisorWhenUnfocused:function(e){return s.update({divisorWhenUnfocused:e}),s},emptyInputBehavior:function(e){return null===s.rawValue&&e!==B.options.emptyInputBehavior.null&&(M.warning("You are trying to modify the `emptyInputBehavior` option to something different than `'null'` (".concat(e,"), but the element raw value is currently set to `null`. This would result in an invalid `rawValue`. In order to fix that, the element value has been changed to the empty string `''`."),s.settings.showWarnings),s.rawValue=""),s.update({emptyInputBehavior:e}),s},eventBubbles:function(e){return s.settings.eventBubbles=e,s},eventIsCancelable:function(e){return s.settings.eventIsCancelable=e,s},failOnUnknownOption:function(e){return s.settings.failOnUnknownOption=e,s},formatOnPageLoad:function(e){return s.settings.formatOnPageLoad=e,s},formulaMode:function(e){return s.settings.formulaMode=e,s},historySize:function(e){return s.settings.historySize=e,s},invalidClass:function(e){return s.settings.invalidClass=e,s},isCancellable:function(e){return s.settings.isCancellable=e,s},leadingZero:function(e){return s.update({leadingZero:e}),s},maximumValue:function(e){return s.update({maximumValue:e}),s},minimumValue:function(e){return s.update({minimumValue:e}),s},modifyValueOnWheel:function(e){return s.settings.modifyValueOnWheel=e,s},negativeBracketsTypeOnBlur:function(e){return s.update({negativeBracketsTypeOnBlur:e}),s},negativePositiveSignPlacement:function(e){return s.update({negativePositiveSignPlacement:e}),s},negativeSignCharacter:function(e){return s.update({negativeSignCharacter:e}),s},noEventListeners:function(e){return e===B.options.noEventListeners.noEvents&&s.settings.noEventListeners===B.options.noEventListeners.addEvents&&s._removeEventListeners(),s.update({noEventListeners:e}),s},onInvalidPaste:function(e){return s.settings.onInvalidPaste=e,s},outputFormat:function(e){return s.settings.outputFormat=e,s},overrideMinMaxLimits:function(e){return s.update({overrideMinMaxLimits:e}),s},positiveSignCharacter:function(e){return s.update({positiveSignCharacter:e}),s},rawValueDivisor:function(e){return s.update({rawValueDivisor:e}),s},readOnly:function(e){return s.settings.readOnly=e,s._setWritePermissions(),s},roundingMethod:function(e){return s.update({roundingMethod:e}),s},saveValueToSessionStorage:function(e){return s.update({saveValueToSessionStorage:e}),s},symbolWhenUnfocused:function(e){return s.update({symbolWhenUnfocused:e}),s},selectNumberOnly:function(e){return s.settings.selectNumberOnly=e,s},selectOnFocus:function(e){return s.settings.selectOnFocus=e,s},serializeSpaces:function(e){return s.settings.serializeSpaces=e,s},showOnlyNumbersOnFocus:function(e){return s.update({showOnlyNumbersOnFocus:e}),s},showPositiveSign:function(e){return s.update({showPositiveSign:e}),s},showWarnings:function(e){return s.settings.showWarnings=e,s},styleRules:function(e){return s.update({styleRules:e}),s},suffixText:function(e){return s.update({suffixText:e}),s},unformatOnHover:function(e){return s.settings.unformatOnHover=e,s},unformatOnSubmit:function(e){return s.settings.unformatOnSubmit=e,s},valuesToStrings:function(e){return s.update({valuesToStrings:e}),s},watchExternalChanges:function(e){return s.update({watchExternalChanges:e}),s},wheelOn:function(e){return s.settings.wheelOn=e,s},wheelStep:function(e){return s.settings.wheelStep=e,s}},this._triggerEvent(B.events.initialized,this.domElement,{newValue:M.getElementValue(this.domElement),newRawValue:this.rawValue,error:null,aNElement:this})}var e,t;return t=[{key:"version",value:function(){return"4.6.0"}},{key:"_setArgumentsValues",value:function(e,t,i){M.isNull(e)&&M.throwError("At least one valid parameter is needed in order to initialize an AutoNumeric object");var n,a,r,s=M.isElement(e),o=M.isString(e),l=M.isObject(t),u=Array.isArray(t)&&0<t.length,c=M.isNumberOrArabic(t)||""===t,h=this._isPreDefinedOptionValid(t),m=M.isNull(t),g=M.isEmptyString(t),d=M.isObject(i),v=Array.isArray(i)&&0<i.length,p=M.isNull(i),f=this._isPreDefinedOptionValid(i);return s&&m&&p?(n=e,a=r=null):s&&c&&p?(n=e,r=t,a=null):s&&l&&p?(n=e,r=null,a=t):s&&h&&p?(n=e,r=null,a=this._getOptionObject(t)):s&&u&&p?(n=e,r=null,a=this.mergeOptions(t)):s&&(m||g)&&d?(n=e,r=null,a=i):s&&(m||g)&&v?(n=e,r=null,a=this.mergeOptions(i)):o&&m&&p?(n=document.querySelector(e),a=r=null):o&&l&&p?(n=document.querySelector(e),r=null,a=t):o&&h&&p?(n=document.querySelector(e),r=null,a=this._getOptionObject(t)):o&&u&&p?(n=document.querySelector(e),r=null,a=this.mergeOptions(t)):o&&(m||g)&&d?(n=document.querySelector(e),r=null,a=i):o&&(m||g)&&v?(n=document.querySelector(e),r=null,a=this.mergeOptions(i)):o&&c&&p?(n=document.querySelector(e),r=t,a=null):o&&c&&d?(n=document.querySelector(e),r=t,a=i):o&&c&&f?(n=document.querySelector(e),r=t,a=this._getOptionObject(i)):o&&c&&v?(n=document.querySelector(e),r=t,a=this.mergeOptions(i)):s&&c&&d?(n=e,r=t,a=i):s&&c&&f?(n=e,r=t,a=this._getOptionObject(i)):s&&c&&v?(n=e,r=t,a=this.mergeOptions(i)):M.throwError("The parameters given to the AutoNumeric object are not valid, '".concat(e,"', '").concat(t,"' and '").concat(i,"' given.")),M.isNull(n)&&M.throwError("The selector '".concat(e,"' did not select any valid DOM element. Please check on which element you called AutoNumeric.")),{domElement:n,initialValue:r,userOptions:a}}},{key:"mergeOptions",value:function(e){var t=this,i={};return e.forEach(function(e){b(i,t._getOptionObject(e))}),i}},{key:"_isPreDefinedOptionValid",value:function(e){return Object.prototype.hasOwnProperty.call(B.predefinedOptions,e)}},{key:"_getOptionObject",value:function(e){var t;return M.isString(e)?null==(t=B.getPredefinedOptions()[e])&&M.warning("The given pre-defined option [".concat(e,"] is not recognized by autoNumeric. Please check that pre-defined option name."),!0):t=e,t}},{key:"_doesFormHandlerListExists",value:function(){var e=w(window.aNFormHandlerMap);return"undefined"!==e&&"object"===e}},{key:"_createFormHandlerList",value:function(){window.aNFormHandlerMap=new Map}},{key:"_checkValuesToStringsArray",value:function(e,t){return M.isInArray(String(e),t)}},{key:"_checkValuesToStringsSettings",value:function(e,t){return this._checkValuesToStringsArray(e,Object.keys(t.valuesToStrings))}},{key:"_checkStringsToValuesSettings",value:function(e,t){return this._checkValuesToStringsArray(e,Object.values(t.valuesToStrings))}},{key:"_unformatAltHovered",value:function(e){e.hoveredWithAlt=!0,e.unformat()}},{key:"_reformatAltHovered",value:function(e){e.hoveredWithAlt=!1,e.reformat()}},{key:"_getChildANInputElement",value:function(e){var t=this,i=e.getElementsByTagName("input"),n=[];return Array.prototype.slice.call(i,0).forEach(function(e){t.test(e)&&n.push(e)}),n}},{key:"test",value:function(e){return this._isInGlobalList(M.domElement(e))}},{key:"_createWeakMap",value:function(e){window[e]=new WeakMap}},{key:"_createGlobalList",value:function(){this.autoNumericGlobalListName="autoNumericGlobalList",this._createWeakMap(this.autoNumericGlobalListName)}},{key:"_doesGlobalListExists",value:function(){var e=w(window[this.autoNumericGlobalListName]);return"undefined"!==e&&"object"===e}},{key:"_addToGlobalList",value:function(e){this._doesGlobalListExists()||this._createGlobalList();var t=e.node();if(this._isInGlobalList(t)){if(this._getFromGlobalList(t)===this)return;M.warning("A reference to the DOM element you just initialized already exists in the global AutoNumeric element list. Please make sure to not initialize the same DOM element multiple times.",e.getSettings().showWarnings)}window[this.autoNumericGlobalListName].set(t,e)}},{key:"_removeFromGlobalList",value:function(e){this._doesGlobalListExists()&&window[this.autoNumericGlobalListName].delete(e.node())}},{key:"_getFromGlobalList",value:function(e){return this._doesGlobalListExists()?window[this.autoNumericGlobalListName].get(e):null}},{key:"_isInGlobalList",value:function(e){return!!this._doesGlobalListExists()&&window[this.autoNumericGlobalListName].has(e)}},{key:"validate",value:function(e,t,i){var n=!(1<arguments.length&&void 0!==t)||t,a=2<arguments.length&&void 0!==i?i:null;!M.isUndefinedOrNullOrEmpty(e)&&M.isObject(e)||M.throwError("The userOptions are invalid ; it should be a valid object, [".concat(e,"] given."));var r,s=M.isObject(a);s||M.isNull(a)||M.throwError("The 'originalOptions' parameter is invalid ; it should either be a valid option object or `null`, [".concat(e,"] given.")),M.isNull(e)||this._convertOldOptionsToNewOnes(e),r=n?b({},this.getDefaultConfig(),e):e,M.isTrueOrFalseString(r.showWarnings)||M.isBoolean(r.showWarnings)||M.throwError("The debug option 'showWarnings' is invalid ; it should be either 'true' or 'false', [".concat(r.showWarnings,"] given."));var o,l=/^[0-9]+$/,u=/[0-9]+/,c=/^-?[0-9]+(\.?[0-9]+)?$/,h=/^[0-9]+(\.?[0-9]+)?$/;M.isTrueOrFalseString(r.allowDecimalPadding)||M.isBoolean(r.allowDecimalPadding)||r.allowDecimalPadding===B.options.allowDecimalPadding.floats||M.throwError("The decimal padding option 'allowDecimalPadding' is invalid ; it should either be `false`, `true` or `'floats'`, [".concat(r.allowDecimalPadding,"] given.")),r.allowDecimalPadding!==B.options.allowDecimalPadding.never&&"false"!==r.allowDecimalPadding||r.decimalPlaces===B.options.decimalPlaces.none&&r.decimalPlacesShownOnBlur===B.options.decimalPlacesShownOnBlur.none&&r.decimalPlacesShownOnFocus===B.options.decimalPlacesShownOnFocus.none||M.warning("Setting 'allowDecimalPadding' to [".concat(r.allowDecimalPadding,"] will override the current 'decimalPlaces*' settings [").concat(r.decimalPlaces,", ").concat(r.decimalPlacesShownOnBlur," and ").concat(r.decimalPlacesShownOnFocus,"]."),r.showWarnings),M.isTrueOrFalseString(r.alwaysAllowDecimalCharacter)||M.isBoolean(r.alwaysAllowDecimalCharacter)||M.throwError("The option 'alwaysAllowDecimalCharacter' is invalid ; it should either be `true` or `false`, [".concat(r.alwaysAllowDecimalCharacter,"] given.")),M.isNull(r.caretPositionOnFocus)||M.isInArray(r.caretPositionOnFocus,[B.options.caretPositionOnFocus.start,B.options.caretPositionOnFocus.end,B.options.caretPositionOnFocus.decimalLeft,B.options.caretPositionOnFocus.decimalRight])||M.throwError("The display on empty string option 'caretPositionOnFocus' is invalid ; it should either be `null`, 'focus', 'press', 'always' or 'zero', [".concat(r.caretPositionOnFocus,"] given.")),o=s?a:this._correctCaretPositionOnFocusAndSelectOnFocusOptions(e),M.isNull(o)||o.caretPositionOnFocus===B.options.caretPositionOnFocus.doNoForceCaretPosition||o.selectOnFocus!==B.options.selectOnFocus.select||M.warning("The 'selectOnFocus' option is set to 'select', which is in conflict with the 'caretPositionOnFocus' which is set to '".concat(o.caretPositionOnFocus,"'. As a result, if this has been called when instantiating an AutoNumeric object, the 'selectOnFocus' option is forced to 'doNotSelect'."),r.showWarnings),M.isInArray(r.digitGroupSeparator,[B.options.digitGroupSeparator.comma,B.options.digitGroupSeparator.dot,B.options.digitGroupSeparator.normalSpace,B.options.digitGroupSeparator.thinSpace,B.options.digitGroupSeparator.narrowNoBreakSpace,B.options.digitGroupSeparator.noBreakSpace,B.options.digitGroupSeparator.noSeparator,B.options.digitGroupSeparator.apostrophe,B.options.digitGroupSeparator.arabicThousandsSeparator,B.options.digitGroupSeparator.dotAbove,B.options.digitGroupSeparator.privateUseTwo])||M.throwError("The thousand separator character option 'digitGroupSeparator' is invalid ; it should be ',', '.', '', '', \"'\", '', ' ', '', '', '' or empty (''), [".concat(r.digitGroupSeparator,"] given.")),M.isTrueOrFalseString(r.showOnlyNumbersOnFocus)||M.isBoolean(r.showOnlyNumbersOnFocus)||M.throwError("The 'showOnlyNumbersOnFocus' option is invalid ; it should be either 'true' or 'false', [".concat(r.showOnlyNumbersOnFocus,"] given.")),M.isInArray(r.digitalGroupSpacing,[B.options.digitalGroupSpacing.two,B.options.digitalGroupSpacing.twoScaled,B.options.digitalGroupSpacing.three,B.options.digitalGroupSpacing.four])||2<=r.digitalGroupSpacing&&r.digitalGroupSpacing<=4||M.throwError("The grouping separator option for thousands 'digitalGroupSpacing' is invalid ; it should be '2', '2s', '3', or '4', [".concat(r.digitalGroupSpacing,"] given.")),M.isInArray(r.decimalCharacter,[B.options.decimalCharacter.comma,B.options.decimalCharacter.dot,B.options.decimalCharacter.middleDot,B.options.decimalCharacter.arabicDecimalSeparator,B.options.decimalCharacter.decimalSeparatorKeySymbol])||M.throwError("The decimal separator character option 'decimalCharacter' is invalid ; it should be '.', ',', '', '' or '', [".concat(r.decimalCharacter,"] given.")),r.decimalCharacter===r.digitGroupSeparator&&M.throwError("autoNumeric will not function properly when the decimal character 'decimalCharacter' [".concat(r.decimalCharacter,"] and the thousand separator 'digitGroupSeparator' [").concat(r.digitGroupSeparator,"] are the same character.")),M.isNull(r.decimalCharacterAlternative)||M.isString(r.decimalCharacterAlternative)||M.throwError("The alternate decimal separator character option 'decimalCharacterAlternative' is invalid ; it should be a string, [".concat(r.decimalCharacterAlternative,"] given.")),""===r.currencySymbol||M.isString(r.currencySymbol)||M.throwError("The currency symbol option 'currencySymbol' is invalid ; it should be a string, [".concat(r.currencySymbol,"] given.")),M.isInArray(r.currencySymbolPlacement,[B.options.currencySymbolPlacement.prefix,B.options.currencySymbolPlacement.suffix])||M.throwError("The placement of the currency sign option 'currencySymbolPlacement' is invalid ; it should either be 'p' (prefix) or 's' (suffix), [".concat(r.currencySymbolPlacement,"] given.")),M.isInArray(r.negativePositiveSignPlacement,[B.options.negativePositiveSignPlacement.prefix,B.options.negativePositiveSignPlacement.suffix,B.options.negativePositiveSignPlacement.left,B.options.negativePositiveSignPlacement.right,B.options.negativePositiveSignPlacement.none])||M.throwError("The placement of the negative sign option 'negativePositiveSignPlacement' is invalid ; it should either be 'p' (prefix), 's' (suffix), 'l' (left), 'r' (right) or 'null', [".concat(r.negativePositiveSignPlacement,"] given.")),M.isTrueOrFalseString(r.showPositiveSign)||M.isBoolean(r.showPositiveSign)||M.throwError("The show positive sign option 'showPositiveSign' is invalid ; it should be either 'true' or 'false', [".concat(r.showPositiveSign,"] given.")),M.isString(r.suffixText)&&(""===r.suffixText||!M.isNegative(r.suffixText,r.negativeSignCharacter)&&!u.test(r.suffixText))||M.throwError("The additional suffix option 'suffixText' is invalid ; it should not contains the negative sign '".concat(r.negativeSignCharacter,"' nor any numerical characters, [").concat(r.suffixText,"] given.")),M.isString(r.negativeSignCharacter)&&1===r.negativeSignCharacter.length&&!M.isUndefinedOrNullOrEmpty(r.negativeSignCharacter)&&!u.test(r.negativeSignCharacter)||M.throwError("The negative sign character option 'negativeSignCharacter' is invalid ; it should be a single character, and cannot be any numerical characters, [".concat(r.negativeSignCharacter,"] given.")),M.isString(r.positiveSignCharacter)&&1===r.positiveSignCharacter.length&&!M.isUndefinedOrNullOrEmpty(r.positiveSignCharacter)&&!u.test(r.positiveSignCharacter)||M.throwError("The positive sign character option 'positiveSignCharacter' is invalid ; it should be a single character, and cannot be any numerical characters, [".concat(r.positiveSignCharacter,"] given.\nIf you want to hide the positive sign character, you need to set the `showPositiveSign` option to `true`.")),r.negativeSignCharacter===r.positiveSignCharacter&&M.throwError("The positive 'positiveSignCharacter' and negative 'negativeSignCharacter' sign characters cannot be identical ; [".concat(r.negativeSignCharacter,"] given."));var m=S(M.isNull(r.negativeBracketsTypeOnBlur)?["",""]:r.negativeBracketsTypeOnBlur.split(","),2),g=m[0],d=m[1];(M.contains(r.digitGroupSeparator,r.negativeSignCharacter)||M.contains(r.decimalCharacter,r.negativeSignCharacter)||M.contains(r.decimalCharacterAlternative,r.negativeSignCharacter)||M.contains(g,r.negativeSignCharacter)||M.contains(d,r.negativeSignCharacter)||M.contains(r.suffixText,r.negativeSignCharacter))&&M.throwError("The negative sign character option 'negativeSignCharacter' is invalid ; it should not be equal or a part of the digit separator, the decimal character, the decimal character alternative, the negative brackets or the suffix text, [".concat(r.negativeSignCharacter,"] given.")),(M.contains(r.digitGroupSeparator,r.positiveSignCharacter)||M.contains(r.decimalCharacter,r.positiveSignCharacter)||M.contains(r.decimalCharacterAlternative,r.positiveSignCharacter)||M.contains(g,r.positiveSignCharacter)||M.contains(d,r.positiveSignCharacter)||M.contains(r.suffixText,r.positiveSignCharacter))&&M.throwError("The positive sign character option 'positiveSignCharacter' is invalid ; it should not be equal or a part of the digit separator, the decimal character, the decimal character alternative, the negative brackets or the suffix text, [".concat(r.positiveSignCharacter,"] given.")),M.isNull(r.overrideMinMaxLimits)||M.isInArray(r.overrideMinMaxLimits,[B.options.overrideMinMaxLimits.ceiling,B.options.overrideMinMaxLimits.floor,B.options.overrideMinMaxLimits.ignore,B.options.overrideMinMaxLimits.invalid])||M.throwError("The override min & max limits option 'overrideMinMaxLimits' is invalid ; it should either be 'ceiling', 'floor', 'ignore' or 'invalid', [".concat(r.overrideMinMaxLimits,"] given.")),r.overrideMinMaxLimits!==B.options.overrideMinMaxLimits.invalid&&r.overrideMinMaxLimits!==B.options.overrideMinMaxLimits.ignore&&(0<r.minimumValue||r.maximumValue<0)&&M.warning("You've set a `minimumValue` or a `maximumValue` excluding the value `0`. AutoNumeric will force the users to always have a valid value in the input, hence preventing them to clear the field. If you want to allow for temporary invalid values (ie. out-of-range), you should use the 'invalid' option for the 'overrideMinMaxLimits' setting."),M.isString(r.maximumValue)&&c.test(r.maximumValue)||M.throwError("The maximum possible value option 'maximumValue' is invalid ; it should be a string that represents a positive or negative number, [".concat(r.maximumValue,"] given.")),M.isString(r.minimumValue)&&c.test(r.minimumValue)||M.throwError("The minimum possible value option 'minimumValue' is invalid ; it should be a string that represents a positive or negative number, [".concat(r.minimumValue,"] given.")),parseFloat(r.minimumValue)>parseFloat(r.maximumValue)&&M.throwError("The minimum possible value option is greater than the maximum possible value option ; 'minimumValue' [".concat(r.minimumValue,"] should be smaller than 'maximumValue' [").concat(r.maximumValue,"].")),M.isInt(r.decimalPlaces)&&0<=r.decimalPlaces||M.isString(r.decimalPlaces)&&l.test(r.decimalPlaces)||M.throwError("The number of decimal places option 'decimalPlaces' is invalid ; it should be a positive integer, [".concat(r.decimalPlaces,"] given.")),M.isNull(r.decimalPlacesRawValue)||M.isInt(r.decimalPlacesRawValue)&&0<=r.decimalPlacesRawValue||M.isString(r.decimalPlacesRawValue)&&l.test(r.decimalPlacesRawValue)||M.throwError("The number of decimal places for the raw value option 'decimalPlacesRawValue' is invalid ; it should be a positive integer or `null`, [".concat(r.decimalPlacesRawValue,"] given.")),this._validateDecimalPlacesRawValue(r),M.isNull(r.decimalPlacesShownOnFocus)||l.test(String(r.decimalPlacesShownOnFocus))||M.throwError("The number of expanded decimal places option 'decimalPlacesShownOnFocus' is invalid ; it should be a positive integer or `null`, [".concat(r.decimalPlacesShownOnFocus,"] given.")),!M.isNull(r.decimalPlacesShownOnFocus)&&Number(r.decimalPlaces)>Number(r.decimalPlacesShownOnFocus)&&M.warning("The extended decimal places 'decimalPlacesShownOnFocus' [".concat(r.decimalPlacesShownOnFocus,"] should be greater than the 'decimalPlaces' [").concat(r.decimalPlaces,"] value. Currently, this will limit the ability of your user to manually change some of the decimal places. Do you really want to do that?"),r.showWarnings),(M.isNull(r.divisorWhenUnfocused)||h.test(r.divisorWhenUnfocused))&&0!==r.divisorWhenUnfocused&&"0"!==r.divisorWhenUnfocused&&1!==r.divisorWhenUnfocused&&"1"!==r.divisorWhenUnfocused||M.throwError("The divisor option 'divisorWhenUnfocused' is invalid ; it should be a positive number higher than one, preferably an integer, [".concat(r.divisorWhenUnfocused,"] given.")),M.isNull(r.decimalPlacesShownOnBlur)||l.test(r.decimalPlacesShownOnBlur)||M.throwError("The number of decimals shown when unfocused option 'decimalPlacesShownOnBlur' is invalid ; it should be a positive integer or `null`, [".concat(r.decimalPlacesShownOnBlur,"] given.")),M.isNull(r.symbolWhenUnfocused)||M.isString(r.symbolWhenUnfocused)||M.throwError("The symbol to show when unfocused option 'symbolWhenUnfocused' is invalid ; it should be a string, [".concat(r.symbolWhenUnfocused,"] given.")),M.isTrueOrFalseString(r.saveValueToSessionStorage)||M.isBoolean(r.saveValueToSessionStorage)||M.throwError("The save to session storage option 'saveValueToSessionStorage' is invalid ; it should be either 'true' or 'false', [".concat(r.saveValueToSessionStorage,"] given.")),M.isInArray(r.onInvalidPaste,[B.options.onInvalidPaste.error,B.options.onInvalidPaste.ignore,B.options.onInvalidPaste.clamp,B.options.onInvalidPaste.truncate,B.options.onInvalidPaste.replace])||M.throwError("The paste behavior option 'onInvalidPaste' is invalid ; it should either be 'error', 'ignore', 'clamp', 'truncate' or 'replace' (cf. documentation), [".concat(r.onInvalidPaste,"] given.")),M.isInArray(r.roundingMethod,[B.options.roundingMethod.halfUpSymmetric,B.options.roundingMethod.halfUpAsymmetric,B.options.roundingMethod.halfDownSymmetric,B.options.roundingMethod.halfDownAsymmetric,B.options.roundingMethod.halfEvenBankersRounding,B.options.roundingMethod.upRoundAwayFromZero,B.options.roundingMethod.downRoundTowardZero,B.options.roundingMethod.toCeilingTowardPositiveInfinity,B.options.roundingMethod.toFloorTowardNegativeInfinity,B.options.roundingMethod.toNearest05,B.options.roundingMethod.toNearest05Alt,B.options.roundingMethod.upToNext05,B.options.roundingMethod.downToNext05])||M.throwError("The rounding method option 'roundingMethod' is invalid ; it should either be 'S', 'A', 's', 'a', 'B', 'U', 'D', 'C', 'F', 'N05', 'CHF', 'U05' or 'D05' (cf. documentation), [".concat(r.roundingMethod,"] given.")),M.isNull(r.negativeBracketsTypeOnBlur)||M.isInArray(r.negativeBracketsTypeOnBlur,[B.options.negativeBracketsTypeOnBlur.parentheses,B.options.negativeBracketsTypeOnBlur.brackets,B.options.negativeBracketsTypeOnBlur.chevrons,B.options.negativeBracketsTypeOnBlur.curlyBraces,B.options.negativeBracketsTypeOnBlur.angleBrackets,B.options.negativeBracketsTypeOnBlur.japaneseQuotationMarks,B.options.negativeBracketsTypeOnBlur.halfBrackets,B.options.negativeBracketsTypeOnBlur.whiteSquareBrackets,B.options.negativeBracketsTypeOnBlur.quotationMarks,B.options.negativeBracketsTypeOnBlur.guillemets])||M.throwError("The brackets for negative values option 'negativeBracketsTypeOnBlur' is invalid ; it should either be '(,)', '[,]', '<,>', '{,}', ',', ',', ',', ',', ',' or ',', [".concat(r.negativeBracketsTypeOnBlur,"] given.")),(M.isString(r.emptyInputBehavior)||M.isNumber(r.emptyInputBehavior))&&(M.isInArray(r.emptyInputBehavior,[B.options.emptyInputBehavior.focus,B.options.emptyInputBehavior.press,B.options.emptyInputBehavior.always,B.options.emptyInputBehavior.min,B.options.emptyInputBehavior.max,B.options.emptyInputBehavior.zero,B.options.emptyInputBehavior.null])||c.test(r.emptyInputBehavior))||M.throwError("The display on empty string option 'emptyInputBehavior' is invalid ; it should either be 'focus', 'press', 'always', 'min', 'max', 'zero', 'null', a number, or a string that represents a number, [".concat(r.emptyInputBehavior,"] given.")),r.emptyInputBehavior===B.options.emptyInputBehavior.zero&&(0<r.minimumValue||r.maximumValue<0)&&M.throwError("The 'emptyInputBehavior' option is set to 'zero', but this value is outside of the range defined by 'minimumValue' and 'maximumValue' [".concat(r.minimumValue,", ").concat(r.maximumValue,"].")),c.test(String(r.emptyInputBehavior))&&(this._isWithinRangeWithOverrideOption(r.emptyInputBehavior,r)||M.throwError("The 'emptyInputBehavior' option is set to a number or a string that represents a number, but its value [".concat(r.emptyInputBehavior,"] is outside of the range defined by the 'minimumValue' and 'maximumValue' options [").concat(r.minimumValue,", ").concat(r.maximumValue,"]."))),M.isTrueOrFalseString(r.eventBubbles)||M.isBoolean(r.eventBubbles)||M.throwError("The event bubbles option 'eventBubbles' is invalid ; it should be either 'true' or 'false', [".concat(r.eventBubbles,"] given.")),M.isTrueOrFalseString(r.eventIsCancelable)||M.isBoolean(r.eventIsCancelable)||M.throwError("The event is cancelable option 'eventIsCancelable' is invalid ; it should be either 'true' or 'false', [".concat(r.eventIsCancelable,"] given.")),!M.isBoolean(r.invalidClass)&&/^-?[_a-zA-Z]+[_a-zA-Z0-9-]*$/.test(r.invalidClass)||M.throwError("The name of the 'invalidClass' option is not a valid CSS class name ; it should not be empty, and should follow the '^-?[_a-zA-Z]+[_a-zA-Z0-9-]*$' regex, [".concat(r.invalidClass,"] given.")),M.isInArray(r.leadingZero,[B.options.leadingZero.allow,B.options.leadingZero.deny,B.options.leadingZero.keep])||M.throwError("The leading zero behavior option 'leadingZero' is invalid ; it should either be 'allow', 'deny' or 'keep', [".concat(r.leadingZero,"] given.")),M.isTrueOrFalseString(r.formatOnPageLoad)||M.isBoolean(r.formatOnPageLoad)||M.throwError("The format on initialization option 'formatOnPageLoad' is invalid ; it should be either 'true' or 'false', [".concat(r.formatOnPageLoad,"] given.")),M.isTrueOrFalseString(r.formulaMode)||M.isBoolean(r.formulaMode)||M.throwError("The formula mode option 'formulaMode' is invalid ; it should be either 'true' or 'false', [".concat(r.formulaMode,"] given.")),l.test(r.historySize)&&0!==r.historySize||M.throwError("The history size option 'historySize' is invalid ; it should be a positive integer, [".concat(r.historySize,"] given.")),M.isTrueOrFalseString(r.selectNumberOnly)||M.isBoolean(r.selectNumberOnly)||M.throwError("The select number only option 'selectNumberOnly' is invalid ; it should be either 'true' or 'false', [".concat(r.selectNumberOnly,"] given.")),M.isTrueOrFalseString(r.selectOnFocus)||M.isBoolean(r.selectOnFocus)||M.throwError("The select on focus option 'selectOnFocus' is invalid ; it should be either 'true' or 'false', [".concat(r.selectOnFocus,"] given.")),M.isNull(r.defaultValueOverride)||""===r.defaultValueOverride||c.test(r.defaultValueOverride)||M.throwError("The unformatted default value option 'defaultValueOverride' is invalid ; it should be a string that represents a positive or negative number, [".concat(r.defaultValueOverride,"] given.")),M.isTrueOrFalseString(r.unformatOnSubmit)||M.isBoolean(r.unformatOnSubmit)||M.throwError("The remove formatting on submit option 'unformatOnSubmit' is invalid ; it should be either 'true' or 'false', [".concat(r.unformatOnSubmit,"] given.")),M.isNull(r.valuesToStrings)||M.isObject(r.valuesToStrings)||M.throwError("The option 'valuesToStrings' is invalid ; it should be an object, ideally with 'key -> value' entries, [".concat(r.valuesToStrings,"] given.")),M.isNull(r.outputFormat)||M.isInArray(r.outputFormat,[B.options.outputFormat.string,B.options.outputFormat.number,B.options.outputFormat.dot,B.options.outputFormat.negativeDot,B.options.outputFormat.comma,B.options.outputFormat.negativeComma,B.options.outputFormat.dotNegative,B.options.outputFormat.commaNegative])||M.throwError("The custom locale format option 'outputFormat' is invalid ; it should either be null, 'string', 'number', '.', '-.', ',', '-,', '.-' or ',-', [".concat(r.outputFormat,"] given.")),M.isTrueOrFalseString(r.isCancellable)||M.isBoolean(r.isCancellable)||M.throwError("The cancellable behavior option 'isCancellable' is invalid ; it should be either 'true' or 'false', [".concat(r.isCancellable,"] given.")),M.isTrueOrFalseString(r.modifyValueOnWheel)||M.isBoolean(r.modifyValueOnWheel)||M.throwError("The increment/decrement on mouse wheel option 'modifyValueOnWheel' is invalid ; it should be either 'true' or 'false', [".concat(r.modifyValueOnWheel,"] given.")),M.isTrueOrFalseString(r.watchExternalChanges)||M.isBoolean(r.watchExternalChanges)||M.throwError("The option 'watchExternalChanges' is invalid ; it should be either 'true' or 'false', [".concat(r.watchExternalChanges,"] given.")),M.isInArray(r.wheelOn,[B.options.wheelOn.focus,B.options.wheelOn.hover])||M.throwError("The wheel behavior option 'wheelOn' is invalid ; it should either be 'focus' or 'hover', [".concat(r.wheelOn,"] given.")),(M.isString(r.wheelStep)||M.isNumber(r.wheelStep))&&("progressive"===r.wheelStep||h.test(r.wheelStep))&&0!==Number(r.wheelStep)||M.throwError("The wheel step value option 'wheelStep' is invalid ; it should either be the string 'progressive', or a number or a string that represents a positive number (excluding zero), [".concat(r.wheelStep,"] given.")),M.isInArray(r.serializeSpaces,[B.options.serializeSpaces.plus,B.options.serializeSpaces.percent])||M.throwError("The space replacement character option 'serializeSpaces' is invalid ; it should either be '+' or '%20', [".concat(r.serializeSpaces,"] given.")),M.isTrueOrFalseString(r.noEventListeners)||M.isBoolean(r.noEventListeners)||M.throwError("The option 'noEventListeners' that prevent the creation of event listeners is invalid ; it should be either 'true' or 'false', [".concat(r.noEventListeners,"] given.")),M.isNull(r.styleRules)||M.isObject(r.styleRules)&&(Object.prototype.hasOwnProperty.call(r.styleRules,"positive")||Object.prototype.hasOwnProperty.call(r.styleRules,"negative")||Object.prototype.hasOwnProperty.call(r.styleRules,"ranges")||Object.prototype.hasOwnProperty.call(r.styleRules,"userDefined"))||M.throwError("The option 'styleRules' is invalid ; it should be a correctly structured object, with one or more 'positive', 'negative', 'ranges' or 'userDefined' attributes, [".concat(r.styleRules,"] given.")),M.isNull(r.styleRules)||!Object.prototype.hasOwnProperty.call(r.styleRules,"userDefined")||M.isNull(r.styleRules.userDefined)||r.styleRules.userDefined.forEach(function(e){Object.prototype.hasOwnProperty.call(e,"callback")&&!M.isFunction(e.callback)&&M.throwError("The callback defined in the `userDefined` attribute is not a function, ".concat(w(e.callback)," given."))}),(M.isNull(r.rawValueDivisor)||h.test(r.rawValueDivisor))&&0!==r.rawValueDivisor&&"0"!==r.rawValueDivisor&&1!==r.rawValueDivisor&&"1"!==r.rawValueDivisor||M.throwError("The raw value divisor option 'rawValueDivisor' is invalid ; it should be a positive number higher than one, preferably an integer, [".concat(r.rawValueDivisor,"] given.")),M.isTrueOrFalseString(r.readOnly)||M.isBoolean(r.readOnly)||M.throwError("The option 'readOnly' is invalid ; it should be either 'true' or 'false', [".concat(r.readOnly,"] given.")),M.isTrueOrFalseString(r.unformatOnHover)||M.isBoolean(r.unformatOnHover)||M.throwError("The option 'unformatOnHover' is invalid ; it should be either 'true' or 'false', [".concat(r.unformatOnHover,"] given.")),M.isTrueOrFalseString(r.failOnUnknownOption)||M.isBoolean(r.failOnUnknownOption)||M.throwError("The debug option 'failOnUnknownOption' is invalid ; it should be either 'true' or 'false', [".concat(r.failOnUnknownOption,"] given.")),M.isTrueOrFalseString(r.createLocalList)||M.isBoolean(r.createLocalList)||M.throwError("The debug option 'createLocalList' is invalid ; it should be either 'true' or 'false', [".concat(r.createLocalList,"] given."))}},{key:"_validateDecimalPlacesRawValue",value:function(e){M.isNull(e.decimalPlacesRawValue)||(e.decimalPlacesRawValue<e.decimalPlaces&&M.warning("The number of decimal places to store in the raw value [".concat(e.decimalPlacesRawValue,"] is lower than the ones to display [").concat(e.decimalPlaces,"]. This will likely confuse your users.\nTo solve that, you'd need to either set `decimalPlacesRawValue` to `null`, or set a number of decimal places for the raw value equal of bigger than `decimalPlaces`."),e.showWarnings),e.decimalPlacesRawValue<e.decimalPlacesShownOnFocus&&M.warning("The number of decimal places to store in the raw value [".concat(e.decimalPlacesRawValue,"] is lower than the ones shown on focus [").concat(e.decimalPlacesShownOnFocus,"]. This will likely confuse your users.\nTo solve that, you'd need to either set `decimalPlacesRawValue` to `null`, or set a number of decimal places for the raw value equal of bigger than `decimalPlacesShownOnFocus`."),e.showWarnings),e.decimalPlacesRawValue<e.decimalPlacesShownOnBlur&&M.warning("The number of decimal places to store in the raw value [".concat(e.decimalPlacesRawValue,"] is lower than the ones shown when unfocused [").concat(e.decimalPlacesShownOnBlur,"]. This will likely confuse your users.\nTo solve that, you'd need to either set `decimalPlacesRawValue` to `null`, or set a number of decimal places for the raw value equal of bigger than `decimalPlacesShownOnBlur`."),e.showWarnings))}},{key:"areSettingsValid",value:function(e){var t=!0;try{this.validate(e,!0)}catch(e){t=!1}return t}},{key:"getDefaultConfig",value:function(){return B.defaultSettings}},{key:"getPredefinedOptions",value:function(){return B.predefinedOptions}},{key:"_generateOptionsObjectFromOptionsArray",value:function(e){var t,i=this;return M.isUndefinedOrNullOrEmpty(e)||0===e.length?t=null:(t={},1===e.length&&Array.isArray(e[0])?e[0].forEach(function(e){b(t,i._getOptionObject(e))}):1<=e.length&&e.forEach(function(e){b(t,i._getOptionObject(e))})),t}},{key:"format",value:function(e){if(M.isUndefined(e)||null===e)return null;var t;t=M.isElement(e)?M.getElementValue(e):e,M.isString(t)||M.isNumber(t)||M.throwError('The value "'.concat(t,'" being "set" is not numeric and therefore cannot be used appropriately.'));for(var i=arguments.length,n=new Array(1<i?i-1:0),a=1;a<i;a++)n[a-1]=arguments[a];var r=this._generateOptionsObjectFromOptionsArray(n),s=b({},this.getDefaultConfig(),r);s.isNegativeSignAllowed=t<0,s.isPositiveSignAllowed=0<=t,this._setBrackets(s),this._cachesUsualRegularExpressions(s,{});var o=this._toNumericValue(t,s);return isNaN(Number(o))&&M.throwError("The value [".concat(o,"] that you are trying to format is not a recognized number.")),this._isWithinRangeWithOverrideOption(o,s)||(M.triggerEvent(B.events.formatted,document,{oldValue:null,newValue:null,oldRawValue:null,newRawValue:null,isPristine:null,error:"Range test failed",aNElement:null},!0,!0),M.throwError("The value [".concat(o,"] being set falls outside of the minimumValue [").concat(s.minimumValue,"] and maximumValue [").concat(s.maximumValue,"] range set for this element"))),s.valuesToStrings&&this._checkValuesToStringsSettings(t,s)?s.valuesToStrings[t]:(this._correctNegativePositiveSignPlacementOption(s),this._calculateDecimalPlacesOnInit(s),M.isUndefinedOrNullOrEmpty(s.rawValueDivisor)||0===s.rawValueDivisor||""===o||null===o||(o*=s.rawValueDivisor),o=this._roundFormattedValueShownOnFocus(o,s),o=this._modifyNegativeSignAndDecimalCharacterForFormattedValue(o,s),o=this._addGroupSeparators(o,s,!1,o))}},{key:"formatAndSet",value:function(e,t){var i=1<arguments.length&&void 0!==t?t:null,n=this.format(e,i);return M.setElementValue(e,n),n}},{key:"unformat",value:function(e){if(M.isNumberStrict(e))return e;var t;if(""===(t=M.isElement(e)?M.getElementValue(e):e))return"";if(M.isUndefined(t)||null===t)return null;(M.isArray(t)||M.isObject(t))&&M.throwError("A number or a string representing a number is needed to be able to unformat it, [".concat(t,"] given."));for(var i=arguments.length,n=new Array(1<i?i-1:0),a=1;a<i;a++)n[a-1]=arguments[a];var r=this._generateOptionsObjectFromOptionsArray(n),s=b({},this.getDefaultConfig(),r);if(s.isNegativeSignAllowed=!1,s.isPositiveSignAllowed=!0,t=t.toString(),s.valuesToStrings&&this._checkStringsToValuesSettings(t,s))return M.objectKeyLookup(s.valuesToStrings,t);if(M.isNegative(t,s.negativeSignCharacter))s.isNegativeSignAllowed=!0,s.isPositiveSignAllowed=!1;else if(!M.isNull(s.negativeBracketsTypeOnBlur)){var o=S(s.negativeBracketsTypeOnBlur.split(","),2);s.firstBracket=o[0],s.lastBracket=o[1],t.charAt(0)===s.firstBracket&&t.charAt(t.length-1)===s.lastBracket&&(s.isNegativeSignAllowed=!0,s.isPositiveSignAllowed=!1,t=this._removeBrackets(t,s,!1))}return t=this._convertToNumericString(t,s),new RegExp("[^+-0123456789.]","gi").test(t)?NaN:(this._correctNegativePositiveSignPlacementOption(s),s.decimalPlacesRawValue?s.originalDecimalPlacesRawValue=s.decimalPlacesRawValue:s.originalDecimalPlacesRawValue=s.decimalPlaces,this._calculateDecimalPlacesOnInit(s),M.isUndefinedOrNullOrEmpty(s.rawValueDivisor)||0===s.rawValueDivisor||""===t||null===t||(t/=s.rawValueDivisor),t=(t=this._roundRawValue(t,s)).replace(s.decimalCharacter,"."),t=this._toLocale(t,s.outputFormat,s))}},{key:"unformatAndSet",value:function(e,t){var i=1<arguments.length&&void 0!==t?t:null,n=this.unformat(e,i);return M.setElementValue(e,n),n}},{key:"localize",value:function(e,t){var i,n,a=1<arguments.length&&void 0!==t?t:null;return""===(i=M.isElement(e)?M.getElementValue(e):e)?"":(M.isNull(a)&&(a=B.defaultSettings),i=this.unformat(i,a),0===Number(i)&&a.leadingZero!==B.options.leadingZero.keep&&(i="0"),n=M.isNull(a)?a.outputFormat:B.defaultSettings.outputFormat,this._toLocale(i,n,a))}},{key:"localizeAndSet",value:function(e,t){var i=1<arguments.length&&void 0!==t?t:null,n=this.localize(e,i);return M.setElementValue(e,n),n}},{key:"isManagedByAutoNumeric",value:function(e){return this._isInGlobalList(M.domElement(e))}},{key:"getAutoNumericElement",value:function(e){var t=M.domElement(e);return this.isManagedByAutoNumeric(t)?this._getFromGlobalList(t):null}},{key:"set",value:function(e,t,i,n){var a,r=2<arguments.length&&void 0!==i?i:null,s=!(3<arguments.length&&void 0!==n)||n,o=M.domElement(e);return this.isManagedByAutoNumeric(o)?this.getAutoNumericElement(o).set(t,r,s):(a=!(!M.isNull(r)&&Object.prototype.hasOwnProperty.call(r,"showWarnings"))||r.showWarnings,M.warning("Impossible to find an AutoNumeric object for the given DOM element or selector.",a),null)}},{key:"getNumericString",value:function(e,t){var i=1<arguments.length&&void 0!==t?t:null;return this._get(e,"getNumericString",i)}},{key:"getFormatted",value:function(e,t){var i=1<arguments.length&&void 0!==t?t:null;return this._get(e,"getFormatted",i)}},{key:"getNumber",value:function(e,t){var i=1<arguments.length&&void 0!==t?t:null;return this._get(e,"getNumber",i)}},{key:"_get",value:function(e,t,i){var n=2<arguments.length&&void 0!==i?i:null,a=M.domElement(e);return this.isManagedByAutoNumeric(a)||M.throwError("Impossible to find an AutoNumeric object for the given DOM element or selector."),this.getAutoNumericElement(a)[t](n)}},{key:"getLocalized",value:function(e,t,i){var n=1<arguments.length&&void 0!==t?t:null,a=2<arguments.length&&void 0!==i?i:null,r=M.domElement(e);return this.isManagedByAutoNumeric(r)||M.throwError("Impossible to find an AutoNumeric object for the given DOM element or selector."),this.getAutoNumericElement(r).getLocalized(n,a)}},{key:"_stripAllNonNumberCharacters",value:function(e,t,i,n){return this._stripAllNonNumberCharactersExceptCustomDecimalChar(e,t,i,n).replace(t.decimalCharacter,".")}},{key:"_stripAllNonNumberCharactersExceptCustomDecimalChar",value:function(e,t,i,n){var a=(e=(e=this._normalizeCurrencySuffixAndNegativeSignCharacters(e,t)).replace(t.allowedAutoStrip,"")).match(t.numRegAutoStrip);if(e=a?[a[1],a[2],a[3]].join(""):"",t.leadingZero===B.options.leadingZero.allow||t.leadingZero===B.options.leadingZero.keep){var r="",s=S(e.split(t.decimalCharacter),2),o=s[0],l=s[1],u=o;M.contains(u,t.negativeSignCharacter)&&(r=t.negativeSignCharacter,u=u.replace(t.negativeSignCharacter,"")),""===r&&u.length>t.mIntPos&&"0"===u.charAt(0)&&(u=u.slice(1)),""!==r&&u.length>t.mIntNeg&&"0"===u.charAt(0)&&(u=u.slice(1)),e="".concat(r).concat(u).concat(M.isUndefined(l)?"":t.decimalCharacter+l)}return(i&&t.leadingZero===B.options.leadingZero.deny||!n&&t.leadingZero===B.options.leadingZero.allow)&&(e=e.replace(t.stripReg,"$1$2")),e}},{key:"_toggleNegativeBracket",value:function(e,t,i){return i?this._removeBrackets(e,t):this._addBrackets(e,t)}},{key:"_addBrackets",value:function(e,t){return M.isNull(t.negativeBracketsTypeOnBlur)?e:"".concat(t.firstBracket).concat(e.replace(t.negativeSignCharacter,"")).concat(t.lastBracket)}},{key:"_removeBrackets",value:function(e,t,i){var n,a=!(2<arguments.length&&void 0!==i)||i;return M.isNull(t.negativeBracketsTypeOnBlur)||e.charAt(0)!==t.firstBracket?e:(n=(n=e.replace(t.firstBracket,"")).replace(t.lastBracket,""),a?(n=n.replace(t.currencySymbol,""),this._mergeCurrencySignNegativePositiveSignAndValue(n,t,!0,!1)):"".concat(t.negativeSignCharacter).concat(n))}},{key:"_setBrackets",value:function(e){if(M.isNull(e.negativeBracketsTypeOnBlur))e.firstBracket="",e.lastBracket="";else{var t=S(e.negativeBracketsTypeOnBlur.split(","),2),i=t[0],n=t[1];e.firstBracket=i,e.lastBracket=n}}},{key:"_convertToNumericString",value:function(e,t){e=this._removeBrackets(e,t,!1),e=(e=this._normalizeCurrencySuffixAndNegativeSignCharacters(e,t)).replace(new RegExp("[".concat(t.digitGroupSeparator,"]"),"g"),""),"."!==t.decimalCharacter&&(e=e.replace(t.decimalCharacter,".")),M.isNegative(e)&&e.lastIndexOf("-")===e.length-1&&(e=e.replace("-",""),e="-".concat(e)),t.showPositiveSign&&(e=e.replace(t.positiveSignCharacter,""));var i=t.leadingZero!==B.options.leadingZero.keep,n=M.arabicToLatinNumbers(e,i,!1,!1);return isNaN(n)||(e=n.toString()),e}},{key:"_normalizeCurrencySuffixAndNegativeSignCharacters",value:function(e,t){return e=String(e),t.currencySymbol!==B.options.currencySymbol.none&&(e=e.replace(t.currencySymbol,"")),t.suffixText!==B.options.suffixText.none&&(e=e.replace(t.suffixText,"")),t.negativeSignCharacter!==B.options.negativeSignCharacter.hyphen&&(e=e.replace(t.negativeSignCharacter,"-")),e}},{key:"_toLocale",value:function(e,t,i){if(M.isNull(t)||t===B.options.outputFormat.string)return e;var n;switch(t){case B.options.outputFormat.number:n=Number(e);break;case B.options.outputFormat.dotNegative:n=M.isNegative(e)?e.replace("-","")+"-":e;break;case B.options.outputFormat.comma:case B.options.outputFormat.negativeComma:n=e.replace(".",",");break;case B.options.outputFormat.commaNegative:n=e.replace(".",","),n=M.isNegative(n)?n.replace("-","")+"-":n;break;case B.options.outputFormat.dot:case B.options.outputFormat.negativeDot:n=e;break;default:M.throwError("The given outputFormat [".concat(t,"] option is not recognized."))}return t!==B.options.outputFormat.number&&"-"!==i.negativeSignCharacter&&(n=n.replace("-",i.negativeSignCharacter)),n}},{key:"_modifyNegativeSignAndDecimalCharacterForFormattedValue",value:function(e,t){return"-"!==t.negativeSignCharacter&&(e=e.replace("-",t.negativeSignCharacter)),"."!==t.decimalCharacter&&(e=e.replace(".",t.decimalCharacter)),e}},{key:"_isElementValueEmptyOrOnlyTheNegativeSign",value:function(e,t){return""===e||e===t.negativeSignCharacter}},{key:"_orderValueCurrencySymbolAndSuffixText",value:function(e,t,i){var n;if(t.emptyInputBehavior===B.options.emptyInputBehavior.always||i)switch(t.negativePositiveSignPlacement){case B.options.negativePositiveSignPlacement.left:case B.options.negativePositiveSignPlacement.prefix:case B.options.negativePositiveSignPlacement.none:n=e+t.currencySymbol+t.suffixText;break;default:n=t.currencySymbol+e+t.suffixText}else n=e;return n}},{key:"_addGroupSeparators",value:function(e,t,i,n,a){var r,s=4<arguments.length&&void 0!==a?a:null;if(r=M.isNull(s)?M.isNegative(e,t.negativeSignCharacter)||M.isNegativeWithBrackets(e,t.firstBracket,t.lastBracket):s<0,e=this._stripAllNonNumberCharactersExceptCustomDecimalChar(e,t,!1,i),this._isElementValueEmptyOrOnlyTheNegativeSign(e,t))return this._orderValueCurrencySymbolAndSuffixText(e,t,!0);var o,l=M.isZeroOrHasNoValue(e);switch(r&&(e=e.replace("-","")),t.digitalGroupSpacing=t.digitalGroupSpacing.toString(),t.digitalGroupSpacing){case B.options.digitalGroupSpacing.two:o=/(\d)((\d)(\d{2}?)+)$/;break;case B.options.digitalGroupSpacing.twoScaled:o=/(\d)((?:\d{2}){0,2}\d{3}(?:(?:\d{2}){2}\d{3})*?)$/;break;case B.options.digitalGroupSpacing.four:o=/(\d)((\d{4}?)+)$/;break;case B.options.digitalGroupSpacing.three:default:o=/(\d)((\d{3}?)+)$/}var u,c=S(e.split(t.decimalCharacter),2),h=c[0],m=c[1];if(t.decimalCharacterAlternative&&M.isUndefined(m)){var g=S(e.split(t.decimalCharacterAlternative),2);h=g[0],m=g[1]}if(""!==t.digitGroupSeparator)for(;o.test(h);)h=h.replace(o,"$1".concat(t.digitGroupSeparator,"$2"));return e=0===(u=i?t.decimalPlacesShownOnFocus:t.decimalPlacesShownOnBlur)||M.isUndefined(m)?h:(m.length>u&&(m=m.substring(0,u)),"".concat(h).concat(t.decimalCharacter).concat(m)),e=B._mergeCurrencySignNegativePositiveSignAndValue(e,t,r,l),M.isNull(s)&&(s=n),null!==t.negativeBracketsTypeOnBlur&&(s<0||M.isNegativeStrict(e,t.negativeSignCharacter))&&(e=this._toggleNegativeBracket(e,t,i)),t.suffixText?"".concat(e).concat(t.suffixText):e}},{key:"_mergeCurrencySignNegativePositiveSignAndValue",value:function(e,t,i,n){var a,r="";if(i?r=t.negativeSignCharacter:t.showPositiveSign&&!n&&(r=t.positiveSignCharacter),t.currencySymbolPlacement===B.options.currencySymbolPlacement.prefix)if(t.negativePositiveSignPlacement!==B.options.negativePositiveSignPlacement.none&&(i||!i&&t.showPositiveSign&&!n))switch(t.negativePositiveSignPlacement){case B.options.negativePositiveSignPlacement.prefix:case B.options.negativePositiveSignPlacement.left:a="".concat(r).concat(t.currencySymbol).concat(e);break;case B.options.negativePositiveSignPlacement.right:a="".concat(t.currencySymbol).concat(r).concat(e);break;case B.options.negativePositiveSignPlacement.suffix:a="".concat(t.currencySymbol).concat(e).concat(r)}else a=t.currencySymbol+e;else if(t.currencySymbolPlacement===B.options.currencySymbolPlacement.suffix)if(t.negativePositiveSignPlacement!==B.options.negativePositiveSignPlacement.none&&(i||!i&&t.showPositiveSign&&!n))switch(t.negativePositiveSignPlacement){case B.options.negativePositiveSignPlacement.suffix:case B.options.negativePositiveSignPlacement.right:a="".concat(e).concat(t.currencySymbol).concat(r);break;case B.options.negativePositiveSignPlacement.left:a="".concat(e).concat(r).concat(t.currencySymbol);break;case B.options.negativePositiveSignPlacement.prefix:a="".concat(r).concat(e).concat(t.currencySymbol)}else a=e+t.currencySymbol;return a}},{key:"_truncateZeros",value:function(e,t){var i;switch(t){case 0:i=/(\.(?:\d*[1-9])?)0*$/;break;case 1:i=/(\.\d(?:\d*[1-9])?)0*$/;break;default:i=new RegExp("(\\.\\d{".concat(t,"}(?:\\d*[1-9])?)0*"))}return e=e.replace(i,"$1"),0===t&&(e=e.replace(/\.$/,"")),e}},{key:"_roundRawValue",value:function(e,t){return this._roundValue(e,t,t.decimalPlacesRawValue)}},{key:"_roundFormattedValueShownOnFocus",value:function(e,t){return this._roundValue(e,t,Number(t.decimalPlacesShownOnFocus))}},{key:"_roundFormattedValueShownOnBlur",value:function(e,t){return this._roundValue(e,t,Number(t.decimalPlacesShownOnBlur))}},{key:"_roundFormattedValueShownOnFocusOrBlur",value:function(e,t,i){return i?this._roundFormattedValueShownOnFocus(e,t):this._roundFormattedValueShownOnBlur(e,t)}},{key:"_roundValue",value:function(e,t,i){if(M.isNull(e))return e;if(e=""===e?"0":e.toString(),t.roundingMethod===B.options.roundingMethod.toNearest05||t.roundingMethod===B.options.roundingMethod.toNearest05Alt||t.roundingMethod===B.options.roundingMethod.upToNext05||t.roundingMethod===B.options.roundingMethod.downToNext05)return this._roundCloseTo05(e,t);var n,a=S(B._prepareValueForRounding(e,t),2),r=a[0],s=(e=a[1]).lastIndexOf("."),o=-1===s,l=S(e.split("."),2),u=l[0];if(!(0<l[1]||t.allowDecimalPadding!==B.options.allowDecimalPadding.never&&t.allowDecimalPadding!==B.options.allowDecimalPadding.floats))return 0===Number(e)?u:"".concat(r).concat(u);n=t.allowDecimalPadding===B.options.allowDecimalPadding.always||t.allowDecimalPadding===B.options.allowDecimalPadding.floats?i:0;var c,h=o?e.length-1:s,m=e.length-1-h,g="";if(m<=i){if(g=e,m<n){o&&(g="".concat(g).concat(t.decimalCharacter));for(var d="000000";m<n;)g+=d=d.substring(0,n-m),m+=d.length}else n<m?g=this._truncateZeros(g,n):0===m&&0===n&&(g=g.replace(/\.$/,""));return 0===Number(g)?g:"".concat(r).concat(g)}c=o?i-1:Number(i)+Number(s);var v,p=Number(e.charAt(c+1)),f=e.substring(0,c+1).split("");if(v="."===e.charAt(c)?e.charAt(c-1)%2:e.charAt(c)%2,this._shouldRoundUp(p,t,r,v))for(var y=f.length-1;0<=y;--y)if("."!==f[y]){if(f[y]=+f[y]+1,f[y]<10)break;0<y&&(f[y]="0")}return f=f.slice(0,c+1),g=this._truncateZeros(f.join(""),n),0===Number(g)?g:"".concat(r).concat(g)}},{key:"_roundCloseTo05",value:function(e,t){switch(t.roundingMethod){case B.options.roundingMethod.toNearest05:case B.options.roundingMethod.toNearest05Alt:e=(Math.round(20*e)/20).toString();break;case B.options.roundingMethod.upToNext05:e=(Math.ceil(20*e)/20).toString();break;default:e=(Math.floor(20*e)/20).toString()}return M.contains(e,".")?e.length-e.indexOf(".")<3?e+"0":e:e+".00"}},{key:"_prepareValueForRounding",value:function(e,t){var i="";return M.isNegativeStrict(e,"-")&&(i="-",e=e.replace("-","")),e.match(/^\d/)||(e="0".concat(e)),0===Number(e)&&(i=""),(0<Number(e)&&t.leadingZero!==B.options.leadingZero.keep||0<e.length&&t.leadingZero===B.options.leadingZero.allow)&&(e=e.replace(/^0*(\d)/,"$1")),[i,e]}},{key:"_shouldRoundUp",value:function(e,t,i,n){return 4<e&&t.roundingMethod===B.options.roundingMethod.halfUpSymmetric||4<e&&t.roundingMethod===B.options.roundingMethod.halfUpAsymmetric&&""===i||5<e&&t.roundingMethod===B.options.roundingMethod.halfUpAsymmetric&&"-"===i||5<e&&t.roundingMethod===B.options.roundingMethod.halfDownSymmetric||5<e&&t.roundingMethod===B.options.roundingMethod.halfDownAsymmetric&&""===i||4<e&&t.roundingMethod===B.options.roundingMethod.halfDownAsymmetric&&"-"===i||5<e&&t.roundingMethod===B.options.roundingMethod.halfEvenBankersRounding||5===e&&t.roundingMethod===B.options.roundingMethod.halfEvenBankersRounding&&1===n||0<e&&t.roundingMethod===B.options.roundingMethod.toCeilingTowardPositiveInfinity&&""===i||0<e&&t.roundingMethod===B.options.roundingMethod.toFloorTowardNegativeInfinity&&"-"===i||0<e&&t.roundingMethod===B.options.roundingMethod.upRoundAwayFromZero}},{key:"_truncateDecimalPlaces",value:function(e,t,i,n){i&&(e=this._roundFormattedValueShownOnFocus(e,t));var a=S(e.split(t.decimalCharacter),2),r=a[0],s=a[1];if(s&&s.length>n)if(0<n){var o=s.substring(0,n);e="".concat(r).concat(t.decimalCharacter).concat(o)}else e=r;return e}},{key:"_checkIfInRangeWithOverrideOption",value:function(e,t){if(M.isNull(e)&&t.emptyInputBehavior===B.options.emptyInputBehavior.null||t.overrideMinMaxLimits===B.options.overrideMinMaxLimits.ignore||t.overrideMinMaxLimits===B.options.overrideMinMaxLimits.invalid)return[!0,!0];e=(e=e.toString()).replace(",",".");var i,n=M.parseStr(t.minimumValue),a=M.parseStr(t.maximumValue),r=M.parseStr(e);switch(t.overrideMinMaxLimits){case B.options.overrideMinMaxLimits.floor:i=[-1<M.testMinMax(n,r),!0];break;case B.options.overrideMinMaxLimits.ceiling:i=[!0,M.testMinMax(a,r)<1];break;default:i=[-1<M.testMinMax(n,r),M.testMinMax(a,r)<1]}return i}},{key:"_isWithinRangeWithOverrideOption",value:function(e,t){var i=S(this._checkIfInRangeWithOverrideOption(e,t),2),n=i[0],a=i[1];return n&&a}},{key:"_cleanValueForRangeParse",value:function(e){return e=e.toString().replace(",","."),M.parseStr(e)}},{key:"_isMinimumRangeRespected",value:function(e,t){return-1<M.testMinMax(M.parseStr(t.minimumValue),this._cleanValueForRangeParse(e))}},{key:"_isMaximumRangeRespected",value:function(e,t){return M.testMinMax(M.parseStr(t.maximumValue),this._cleanValueForRangeParse(e))<1}},{key:"_readCookie",value:function(e){for(var t=e+"=",i=document.cookie.split(";"),n="",a=0;a<i.length;a+=1){for(n=i[a];" "===n.charAt(0);)n=n.substring(1,n.length);if(0===n.indexOf(t))return n.substring(t.length,n.length)}return null}},{key:"_storageTest",value:function(){var e="modernizr";try{return sessionStorage.setItem(e,e),sessionStorage.removeItem(e),!0}catch(e){return!1}}},{key:"_correctNegativePositiveSignPlacementOption",value:function(e){if(M.isNull(e.negativePositiveSignPlacement))if(M.isUndefined(e)||!M.isUndefinedOrNullOrEmpty(e.negativePositiveSignPlacement)||M.isUndefinedOrNullOrEmpty(e.currencySymbol))e.negativePositiveSignPlacement=B.options.negativePositiveSignPlacement.left;else switch(e.currencySymbolPlacement){case B.options.currencySymbolPlacement.suffix:e.negativePositiveSignPlacement=B.options.negativePositiveSignPlacement.prefix;break;case B.options.currencySymbolPlacement.prefix:e.negativePositiveSignPlacement=B.options.negativePositiveSignPlacement.left}}},{key:"_correctCaretPositionOnFocusAndSelectOnFocusOptions",value:function(e){return M.isNull(e)?null:(!M.isUndefinedOrNullOrEmpty(e.caretPositionOnFocus)&&M.isUndefinedOrNullOrEmpty(e.selectOnFocus)&&(e.selectOnFocus=B.options.selectOnFocus.doNotSelect),M.isUndefinedOrNullOrEmpty(e.caretPositionOnFocus)&&!M.isUndefinedOrNullOrEmpty(e.selectOnFocus)&&e.selectOnFocus===B.options.selectOnFocus.select&&(e.caretPositionOnFocus=B.options.caretPositionOnFocus.doNoForceCaretPosition),e)}},{key:"_calculateDecimalPlacesOnInit",value:function(e){this._validateDecimalPlacesRawValue(e),e.decimalPlacesShownOnFocus===B.options.decimalPlacesShownOnFocus.useDefault&&(e.decimalPlacesShownOnFocus=e.decimalPlaces),e.decimalPlacesShownOnBlur===B.options.decimalPlacesShownOnBlur.useDefault&&(e.decimalPlacesShownOnBlur=e.decimalPlaces),e.decimalPlacesRawValue===B.options.decimalPlacesRawValue.useDefault&&(e.decimalPlacesRawValue=e.decimalPlaces);var t=0;e.rawValueDivisor&&e.rawValueDivisor!==B.options.rawValueDivisor.none&&(t=String(e.rawValueDivisor).length-1)<0&&(t=0),e.decimalPlacesRawValue=Math.max(Math.max(e.decimalPlacesShownOnBlur,e.decimalPlacesShownOnFocus)+t,Number(e.originalDecimalPlacesRawValue)+t)}},{key:"_calculateDecimalPlacesOnUpdate",value:function(e,t){var i=1<arguments.length&&void 0!==t?t:null;this._validateDecimalPlacesRawValue(e),M.isNull(i)&&M.throwError("When updating the settings, the previous ones should be passed as an argument.");var n="decimalPlaces"in e;if(n||"decimalPlacesRawValue"in e||"decimalPlacesShownOnFocus"in e||"decimalPlacesShownOnBlur"in e||"rawValueDivisor"in e){n?("decimalPlacesShownOnFocus"in e&&e.decimalPlacesShownOnFocus!==B.options.decimalPlacesShownOnFocus.useDefault||(e.decimalPlacesShownOnFocus=e.decimalPlaces),"decimalPlacesShownOnBlur"in e&&e.decimalPlacesShownOnBlur!==B.options.decimalPlacesShownOnBlur.useDefault||(e.decimalPlacesShownOnBlur=e.decimalPlaces),"decimalPlacesRawValue"in e&&e.decimalPlacesRawValue!==B.options.decimalPlacesRawValue.useDefault||(e.decimalPlacesRawValue=e.decimalPlaces)):(M.isUndefined(e.decimalPlacesShownOnFocus)&&(e.decimalPlacesShownOnFocus=i.decimalPlacesShownOnFocus),M.isUndefined(e.decimalPlacesShownOnBlur)&&(e.decimalPlacesShownOnBlur=i.decimalPlacesShownOnBlur));var a=0;e.rawValueDivisor&&e.rawValueDivisor!==B.options.rawValueDivisor.none&&(a=String(e.rawValueDivisor).length-1)<0&&(a=0),e.decimalPlaces||e.decimalPlacesRawValue?e.decimalPlacesRawValue=Math.max(Math.max(e.decimalPlacesShownOnBlur,e.decimalPlacesShownOnFocus)+a,Number(e.decimalPlacesRawValue)+a):e.decimalPlacesRawValue=Math.max(Math.max(e.decimalPlacesShownOnBlur,e.decimalPlacesShownOnFocus)+a,Number(i.originalDecimalPlacesRawValue)+a)}}},{key:"_cachesUsualRegularExpressions",value:function(e,t){var i;i=e.negativeSignCharacter!==B.options.negativeSignCharacter.hyphen?"([-\\".concat(e.negativeSignCharacter,"]?)"):"(-?)",t.aNegRegAutoStrip=i,e.allowedAutoStrip=new RegExp("[^-0123456789\\".concat(e.decimalCharacter,"]"),"g"),e.numRegAutoStrip=new RegExp("".concat(i,"(?:\\").concat(e.decimalCharacter,"?([0-9]+\\").concat(e.decimalCharacter,"[0-9]+)|([0-9]*(?:\\").concat(e.decimalCharacter,"[0-9]*)?))")),e.stripReg=new RegExp("^".concat(t.aNegRegAutoStrip,"0*([0-9])")),e.formulaChars=new RegExp("[0-9".concat(e.decimalCharacter,"+\\-*/() ]"))}},{key:"_convertOldOptionsToNewOnes",value:function(e){var t={aSep:"digitGroupSeparator",nSep:"showOnlyNumbersOnFocus",dGroup:"digitalGroupSpacing",aDec:"decimalCharacter",altDec:"decimalCharacterAlternative",aSign:"currencySymbol",pSign:"currencySymbolPlacement",pNeg:"negativePositiveSignPlacement",aSuffix:"suffixText",oLimits:"overrideMinMaxLimits",vMax:"maximumValue",vMin:"minimumValue",mDec:"decimalPlacesOverride",eDec:"decimalPlacesShownOnFocus",scaleDecimal:"decimalPlacesShownOnBlur",aStor:"saveValueToSessionStorage",mRound:"roundingMethod",aPad:"allowDecimalPadding",nBracket:"negativeBracketsTypeOnBlur",wEmpty:"emptyInputBehavior",lZero:"leadingZero",aForm:"formatOnPageLoad",sNumber:"selectNumberOnly",anDefault:"defaultValueOverride",unSetOnSubmit:"unformatOnSubmit",outputType:"outputFormat",debug:"showWarnings",allowDecimalPadding:!0,alwaysAllowDecimalCharacter:!0,caretPositionOnFocus:!0,createLocalList:!0,currencySymbol:!0,currencySymbolPlacement:!0,decimalCharacter:!0,decimalCharacterAlternative:!0,decimalPlaces:!0,decimalPlacesRawValue:!0,decimalPlacesShownOnBlur:!0,decimalPlacesShownOnFocus:!0,defaultValueOverride:!0,digitalGroupSpacing:!0,digitGroupSeparator:!0,divisorWhenUnfocused:!0,emptyInputBehavior:!0,eventBubbles:!0,eventIsCancelable:!0,failOnUnknownOption:!0,formatOnPageLoad:!0,formulaMode:!0,historySize:!0,isCancellable:!0,leadingZero:!0,maximumValue:!0,minimumValue:!0,modifyValueOnWheel:!0,negativeBracketsTypeOnBlur:!0,negativePositiveSignPlacement:!0,negativeSignCharacter:!0,noEventListeners:!0,onInvalidPaste:!0,outputFormat:!0,overrideMinMaxLimits:!0,positiveSignCharacter:!0,rawValueDivisor:!0,readOnly:!0,roundingMethod:!0,saveValueToSessionStorage:!0,selectNumberOnly:!0,selectOnFocus:!0,serializeSpaces:!0,showOnlyNumbersOnFocus:!0,showPositiveSign:!0,showWarnings:!0,styleRules:!0,suffixText:!0,symbolWhenUnfocused:!0,unformatOnHover:!0,unformatOnSubmit:!0,valuesToStrings:!0,watchExternalChanges:!0,wheelOn:!0,wheelStep:!0,allowedAutoStrip:!0,formulaChars:!0,isNegativeSignAllowed:!0,isPositiveSignAllowed:!0,mIntNeg:!0,mIntPos:!0,numRegAutoStrip:!0,originalDecimalPlaces:!0,originalDecimalPlacesRawValue:!0,stripReg:!0};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(!0===t[i])continue;Object.prototype.hasOwnProperty.call(t,i)?(M.warning("You are using the deprecated option name '".concat(i,"'. Please use '").concat(t[i],"' instead from now on. The old option name will be dropped very soon."),!0),e[t[i]]=e[i],delete e[i]):e.failOnUnknownOption&&M.throwError("Option name '".concat(i,"' is unknown. Please fix the options passed to autoNumeric"))}"mDec"in e&&M.warning("The old `mDec` option has been deprecated in favor of more accurate options ; `decimalPlaces`, `decimalPlacesRawValue`, `decimalPlacesShownOnFocus` and `decimalPlacesShownOnBlur`.",!0)}},{key:"_setNegativePositiveSignPermissions",value:function(e){e.isNegativeSignAllowed=e.minimumValue<0,e.isPositiveSignAllowed=0<=e.maximumValue}},{key:"_toNumericValue",value:function(e,t){var i;return M.isNumber(Number(e))?i=M.scientificToDecimal(e):(i=this._convertToNumericString(e.toString(),t),M.isNumber(Number(i))||(M.warning('The given value "'.concat(e,'" cannot be converted to a numeric one and therefore cannot be used appropriately.'),t.showWarnings),i=NaN)),i}},{key:"_checkIfInRange",value:function(e,t,i){var n=M.parseStr(e);return-1<M.testMinMax(t,n)&&M.testMinMax(i,n)<1}},{key:"_shouldSkipEventKey",value:function(e){var t=M.isInArray(e,d.keyName._allFnKeys),i=e===d.keyName.OSLeft||e===d.keyName.OSRight,n=e===d.keyName.ContextMenu,a=M.isInArray(e,d.keyName._someNonPrintableKeys),r=e===d.keyName.NumLock||e===d.keyName.ScrollLock||e===d.keyName.Insert||e===d.keyName.Command,s=e===d.keyName.Unidentified;return t||i||n||a||s||r}},{key:"_serialize",value:function(e,t,i,n,a){var r,s=this,o=1<arguments.length&&void 0!==t&&t,l=2<arguments.length&&void 0!==i?i:"unformatted",u=3<arguments.length&&void 0!==n?n:"+",c=4<arguments.length&&void 0!==a?a:null,h=[];return"object"===w(e)&&"form"===e.nodeName.toLowerCase()&&Array.prototype.slice.call(e.elements).forEach(function(t){if(t.name&&!t.disabled&&-1===["file","reset","submit","button"].indexOf(t.type))if("select-multiple"===t.type)Array.prototype.slice.call(t.options).forEach(function(e){e.selected&&(o?h.push({name:t.name,value:e.value}):h.push("".concat(encodeURIComponent(t.name),"=").concat(encodeURIComponent(e.value))))});else if(-1===["checkbox","radio"].indexOf(t.type)||t.checked){var e,i;if(s.isManagedByAutoNumeric(t))switch(l){case"unformatted":i=s.getAutoNumericElement(t),M.isNull(i)||(e=s.unformat(t,i.getSettings()));break;case"localized":if(i=s.getAutoNumericElement(t),!M.isNull(i)){var n=M.cloneObject(i.getSettings());M.isNull(c)||(n.outputFormat=c),e=s.localize(t,n)}break;case"formatted":default:e=t.value}else e=t.value;M.isUndefined(e)&&M.throwError("This error should never be hit. If it has, something really wrong happened!"),o?h.push({name:t.name,value:e}):h.push("".concat(encodeURIComponent(t.name),"=").concat(encodeURIComponent(e)))}}),o?r=h:(r=h.join("&"),"+"===u&&(r=r.replace(/%20/g,"+"))),r}},{key:"_serializeNumericString",value:function(e,t){var i=1<arguments.length&&void 0!==t?t:"+";return this._serialize(e,!1,"unformatted",i)}},{key:"_serializeFormatted",value:function(e,t){var i=1<arguments.length&&void 0!==t?t:"+";return this._serialize(e,!1,"formatted",i)}},{key:"_serializeLocalized",value:function(e,t,i){var n=1<arguments.length&&void 0!==t?t:"+",a=2<arguments.length&&void 0!==i?i:null;return this._serialize(e,!1,"localized",n,a)}},{key:"_serializeNumericStringArray",value:function(e,t){var i=1<arguments.length&&void 0!==t?t:"+";return this._serialize(e,!0,"unformatted",i)}},{key:"_serializeFormattedArray",value:function(e,t){var i=1<arguments.length&&void 0!==t?t:"+";return this._serialize(e,!0,"formatted",i)}},{key:"_serializeLocalizedArray",value:function(e,t,i){var n=1<arguments.length&&void 0!==t?t:"+",a=2<arguments.length&&void 0!==i?i:null;return this._serialize(e,!0,"localized",n,a)}}],P((e=B).prototype,[{key:"_saveInitialValues",value:function(e){this.initialValueHtmlAttribute=M.scientificToDecimal(this.domElement.getAttribute("value")),M.isNull(this.initialValueHtmlAttribute)&&(this.initialValueHtmlAttribute=""),this.initialValue=e,M.isNull(this.initialValue)&&(this.initialValue="")}},{key:"_createEventListeners",value:function(){var t=this;this.formulaMode=!1,this._onFocusInFunc=function(e){t._onFocusIn(e)},this._onFocusInAndMouseEnterFunc=function(e){t._onFocusInAndMouseEnter(e)},this._onFocusFunc=function(){t._onFocus()},this._onKeydownFunc=function(e){t._onKeydown(e)},this._onKeypressFunc=function(e){t._onKeypress(e)},this._onKeyupFunc=function(e){t._onKeyup(e)},this._onFocusOutAndMouseLeaveFunc=function(e){t._onFocusOutAndMouseLeave(e)},this._onPasteFunc=function(e){t._onPaste(e)},this._onWheelFunc=function(e){t._onWheel(e)},this._onDropFunc=function(e){t._onDrop(e)},this._onKeydownGlobalFunc=function(e){t._onKeydownGlobal(e)},this._onKeyupGlobalFunc=function(e){t._onKeyupGlobal(e)},this.domElement.addEventListener("focusin",this._onFocusInFunc,!1),this.domElement.addEventListener("focus",this._onFocusInAndMouseEnterFunc,!1),this.domElement.addEventListener("focus",this._onFocusFunc,!1),this.domElement.addEventListener("mouseenter",this._onFocusInAndMouseEnterFunc,!1),this.domElement.addEventListener("keydown",this._onKeydownFunc,!1),this.domElement.addEventListener("keypress",this._onKeypressFunc,!1),this.domElement.addEventListener("keyup",this._onKeyupFunc,!1),this.domElement.addEventListener("blur",this._onFocusOutAndMouseLeaveFunc,!1),this.domElement.addEventListener("mouseleave",this._onFocusOutAndMouseLeaveFunc,!1),this.domElement.addEventListener("paste",this._onPasteFunc,!1),this.domElement.addEventListener("wheel",this._onWheelFunc,!1),this.domElement.addEventListener("drop",this._onDropFunc,!1),this._setupFormListener(),this.hasEventListeners=!0,B._doesGlobalListExists()||(document.addEventListener("keydown",this._onKeydownGlobalFunc,!1),document.addEventListener("keyup",this._onKeyupGlobalFunc,!1))}},{key:"_removeEventListeners",value:function(){this.domElement.removeEventListener("focusin",this._onFocusInFunc,!1),this.domElement.removeEventListener("focus",this._onFocusInAndMouseEnterFunc,!1),this.domElement.removeEventListener("focus",this._onFocusFunc,!1),this.domElement.removeEventListener("mouseenter",this._onFocusInAndMouseEnterFunc,!1),this.domElement.removeEventListener("blur",this._onFocusOutAndMouseLeaveFunc,!1),this.domElement.removeEventListener("mouseleave",this._onFocusOutAndMouseLeaveFunc,!1),this.domElement.removeEventListener("keydown",this._onKeydownFunc,!1),this.domElement.removeEventListener("keypress",this._onKeypressFunc,!1),this.domElement.removeEventListener("keyup",this._onKeyupFunc,!1),this.domElement.removeEventListener("paste",this._onPasteFunc,!1),this.domElement.removeEventListener("wheel",this._onWheelFunc,!1),this.domElement.removeEventListener("drop",this._onDropFunc,!1),this._removeFormListener(),this.hasEventListeners=!1,document.removeEventListener("keydown",this._onKeydownGlobalFunc,!1),document.removeEventListener("keyup",this._onKeyupGlobalFunc,!1)}},{key:"_updateEventListeners",value:function(){this.settings.noEventListeners||this.hasEventListeners||this._createEventListeners(),this.settings.noEventListeners&&this.hasEventListeners&&this._removeEventListeners()}},{key:"_setupFormListener",value:function(){var e=this;M.isNull(this.parentForm)||(this._onFormSubmitFunc=function(){e._onFormSubmit()},this._onFormResetFunc=function(){e._onFormReset()},this._hasParentFormCounter()?this._incrementParentFormCounter():(this._initializeFormCounterToOne(),this.parentForm.addEventListener("submit",this._onFormSubmitFunc,!1),this.parentForm.addEventListener("reset",this._onFormResetFunc,!1),this._storeFormHandlerFunction()))}},{key:"_removeFormListener",value:function(){if(!M.isNull(this.parentForm)){var e=this._getParentFormCounter();1===e?(this.parentForm.removeEventListener("submit",this._getFormHandlerFunction().submitFn,!1),this.parentForm.removeEventListener("reset",this._getFormHandlerFunction().resetFn,!1),this._removeFormDataSetInfo()):1<e?this._decrementParentFormCounter():M.throwError("The AutoNumeric object count on the form is incoherent.")}}},{key:"_hasParentFormCounter",value:function(){return"anCount"in this.parentForm.dataset}},{key:"_getParentFormCounter",value:function(){return Number(this.parentForm.dataset.anCount)}},{key:"_initializeFormCounterToOne",value:function(e){var t=0<arguments.length&&void 0!==e?e:null;this._getFormElement(t).dataset.anCount=1}},{key:"_incrementParentFormCounter",value:function(e){var t=0<arguments.length&&void 0!==e?e:null;this._getFormElement(t).dataset.anCount++}},{key:"_decrementParentFormCounter",value:function(){this.parentForm.dataset.anCount--}},{key:"_hasFormHandlerFunction",value:function(e){var t=0<arguments.length&&void 0!==e?e:null;return"anFormHandler"in this._getFormElement(t).dataset}},{key:"_getFormElement",value:function(e){var t=0<arguments.length&&void 0!==e?e:null;return M.isNull(t)?this.parentForm:t}},{key:"_storeFormHandlerFunction",value:function(e){var t=0<arguments.length&&void 0!==e?e:null;this.constructor._doesFormHandlerListExists()||this.constructor._createFormHandlerList();var i=M.randomString();this._getFormElement(t).dataset.anFormHandler=i,window.aNFormHandlerMap.set(i,{submitFn:this._onFormSubmitFunc,resetFn:this._onFormResetFunc})}},{key:"_getFormHandlerKey",value:function(){this._hasFormHandlerFunction()||M.throwError("Unable to retrieve the form handler name");var e=this.parentForm.dataset.anFormHandler;return""===e&&M.throwError("The form handler name is invalid"),e}},{key:"_getFormHandlerFunction",value:function(){var e=this._getFormHandlerKey();return window.aNFormHandlerMap.get(e)}},{key:"_removeFormDataSetInfo",value:function(){this._decrementParentFormCounter(),window.aNFormHandlerMap.delete(this._getFormHandlerKey()),this.parentForm.removeAttribute("data-an-count"),this.parentForm.removeAttribute("data-an-form-handler")}},{key:"_setWritePermissions",value:function(e){0<arguments.length&&void 0!==e&&e&&this.domElement.readOnly||this.settings.readOnly?this._setReadOnly():this._setReadWrite()}},{key:"_setReadOnly",value:function(){this.isInputElement?this.domElement.readOnly=!0:this.domElement.setAttribute("contenteditable",!1)}},{key:"_setReadWrite",value:function(){this.isInputElement?this.domElement.readOnly=!1:this.domElement.setAttribute("contenteditable",!0)}},{key:"_addWatcher",value:function(){var t=this;if(!M.isUndefined(this.getterSetter)){var e=this.getterSetter,i=e.set,n=e.get;Object.defineProperty(this.domElement,this.attributeToWatch,{configurable:!0,get:function(){return n.call(t.domElement)},set:function(e){i.call(t.domElement,e),t.settings.watchExternalChanges&&!t.internalModification&&t.set(e)}})}}},{key:"_removeWatcher",value:function(){var t=this;if(!M.isUndefined(this.getterSetter)){var e=this.getterSetter,i=e.set,n=e.get;Object.defineProperty(this.domElement,this.attributeToWatch,{configurable:!0,get:function(){return n.call(t.domElement)},set:function(e){i.call(t.domElement,e)}})}}},{key:"_getAttributeToWatch",value:function(){var e;if(this.isInputElement)e="value";else{var t=this.domElement.nodeType;t===Node.ELEMENT_NODE||t===Node.DOCUMENT_NODE||t===Node.DOCUMENT_FRAGMENT_NODE?e="textContent":t===Node.TEXT_NODE&&(e="nodeValue")}return e}},{key:"_historyTableAdd",value:function(){var e=0===this.historyTable.length;if(e||this.rawValue!==this._historyTableCurrentValueUsed()){var t=!0;if(!e){var i=this.historyTableIndex+1;i<this.historyTable.length&&this.rawValue===this.historyTable[i].value?t=!1:M.arrayTrim(this.historyTable,this.historyTableIndex+1)}if(this.historyTableIndex++,t){var n=M.getElementSelection(this.domElement);this.selectionStart=n.start,this.selectionEnd=n.end,this.historyTable.push({value:this.rawValue,start:this.selectionStart+1,end:this.selectionEnd+1}),1<this.historyTable.length&&(this.historyTable[this.historyTableIndex-1].start=this.selectionStart,this.historyTable[this.historyTableIndex-1].end=this.selectionEnd)}this.historyTable.length>this.settings.historySize&&this._historyTableForget()}}},{key:"_historyTableUndoOrRedo",value:function(e){var t;if(0<arguments.length&&void 0!==e&&!e?(t=this.historyTableIndex+1<this.historyTable.length)&&this.historyTableIndex++:(t=0<this.historyTableIndex)&&this.historyTableIndex--,t){var i=this.historyTable[this.historyTableIndex];this.set(i.value,null,!1),M.setElementSelection(this.domElement,i.start,i.end)}}},{key:"_historyTableUndo",value:function(){this._historyTableUndoOrRedo(!0)}},{key:"_historyTableRedo",value:function(){this._historyTableUndoOrRedo(!1)}},{key:"_historyTableForget",value:function(e){for(var t=0<arguments.length&&void 0!==e?e:1,i=[],n=0;n<t;n++)i.push(this.historyTable.shift()),this.historyTableIndex--,this.historyTableIndex<0&&(this.historyTableIndex=0);return 1===i.length?i[0]:i}},{key:"_historyTableCurrentValueUsed",value:function(){var e=this.historyTableIndex;return e<0&&(e=0),M.isUndefinedOrNullOrEmpty(this.historyTable[e])?"":this.historyTable[e].value}},{key:"_parseStyleRules",value:function(){var n=this;M.isUndefinedOrNullOrEmpty(this.settings.styleRules)||""===this.rawValue||(M.isUndefinedOrNullOrEmpty(this.settings.styleRules.positive)||(0<=this.rawValue?this._addCSSClass(this.settings.styleRules.positive):this._removeCSSClass(this.settings.styleRules.positive)),M.isUndefinedOrNullOrEmpty(this.settings.styleRules.negative)||(this.rawValue<0?this._addCSSClass(this.settings.styleRules.negative):this._removeCSSClass(this.settings.styleRules.negative)),M.isUndefinedOrNullOrEmpty(this.settings.styleRules.ranges)||0===this.settings.styleRules.ranges.length||this.settings.styleRules.ranges.forEach(function(e){n.rawValue>=e.min&&n.rawValue<e.max?n._addCSSClass(e.class):n._removeCSSClass(e.class)}),M.isUndefinedOrNullOrEmpty(this.settings.styleRules.userDefined)||0===this.settings.styleRules.userDefined.length||this.settings.styleRules.userDefined.forEach(function(e){if(M.isFunction(e.callback))if(M.isString(e.classes))e.callback(n.rawValue)?n._addCSSClass(e.classes):n._removeCSSClass(e.classes);else if(M.isArray(e.classes))if(2===e.classes.length)e.callback(n.rawValue)?(n._addCSSClass(e.classes[0]),n._removeCSSClass(e.classes[1])):(n._removeCSSClass(e.classes[0]),n._addCSSClass(e.classes[1]));else if(2<e.classes.length){var i=e.callback(n.rawValue);M.isArray(i)?e.classes.forEach(function(e,t){M.isInArray(t,i)?n._addCSSClass(e):n._removeCSSClass(e)}):M.isInt(i)?e.classes.forEach(function(e,t){t===i?n._addCSSClass(e):n._removeCSSClass(e)}):M.isNull(i)?e.classes.forEach(function(e){n._removeCSSClass(e)}):M.throwError("The callback result is not an array nor a valid array index, ".concat(w(i)," given."))}else M.throwError("The classes attribute is not valid for the `styleRules` option.");else M.isUndefinedOrNullOrEmpty(e.classes)?e.callback(n):M.throwError("The callback/classes structure is not valid for the `styleRules` option.");else M.warning("The given `styleRules` callback is not a function, ".concat("undefined"==typeof callback?"undefined":w(callback)," given."),n.settings.showWarnings)}))}},{key:"_addCSSClass",value:function(e){this.domElement.classList.add(e)}},{key:"_removeCSSClass",value:function(e){this.domElement.classList.remove(e)}},{key:"update",value:function(){for(var t=this,e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];Array.isArray(i)&&Array.isArray(i[0])&&(i=i[0]);var a=M.cloneObject(this.settings),r=this.rawValue,s={};M.isUndefinedOrNullOrEmpty(i)||0===i.length?s=null:1<=i.length&&i.forEach(function(e){t.constructor._isPreDefinedOptionValid(e)&&(e=t.constructor._getOptionObject(e)),b(s,e)});try{this._setSettings(s,!0),this._setWritePermissions(),this._updateEventListeners(),this.set(r)}catch(e){return this._setSettings(a,!0),M.throwError("Unable to update the settings, those are invalid: [".concat(e,"]")),this}return this}},{key:"getSettings",value:function(){return this.settings}},{key:"set",value:function(e,t,i){var n,a=1<arguments.length&&void 0!==t?t:null,r=!(2<arguments.length&&void 0!==i)||i;if(M.isUndefined(e))return M.warning("You are trying to set an 'undefined' value ; an error could have occurred.",this.settings.showWarnings),this;if(M.isNull(a)||this._setSettings(a,!0),null===e&&this.settings.emptyInputBehavior!==B.options.emptyInputBehavior.null)return M.warning("You are trying to set the `null` value while the `emptyInputBehavior` option is set to ".concat(this.settings.emptyInputBehavior,". If you want to be able to set the `null` value, you need to change the 'emptyInputBehavior' option to `'null'`."),this.settings.showWarnings),this;if(null===e)return this._setElementAndRawValue(null,null,r),this._saveValueToPersistentStorage(),this;if(n=this.constructor._toNumericValue(e,this.settings),isNaN(Number(n)))return M.warning("The value you are trying to set results in `NaN`. The element value is set to the empty string instead.",this.settings.showWarnings),this.setValue("",r),this;if(""===n)switch(this.settings.emptyInputBehavior){case B.options.emptyInputBehavior.zero:n=0;break;case B.options.emptyInputBehavior.min:n=this.settings.minimumValue;break;case B.options.emptyInputBehavior.max:n=this.settings.maximumValue;break;default:M.isNumber(this.settings.emptyInputBehavior)&&(n=Number(this.settings.emptyInputBehavior))}if(""===n)return s=this.settings.emptyInputBehavior===B.options.emptyInputBehavior.always?this.settings.currencySymbol:"",this._setElementAndRawValue(s,"",r),this;var s,o=S(this.constructor._checkIfInRangeWithOverrideOption(n,this.settings),2),l=o[0],u=o[1];if(l&&u&&this.settings.valuesToStrings&&this._checkValuesToStrings(n))return this._setElementAndRawValue(this.settings.valuesToStrings[n],n,r),this._saveValueToPersistentStorage(),this;if(M.isZeroOrHasNoValue(n)&&(n="0"),l&&u){var c=this.constructor._roundRawValue(n,this.settings);return c=this._trimLeadingAndTrailingZeros(c.replace(this.settings.decimalCharacter,".")),n=this._getRawValueToFormat(n),n=this.isFocused?this.constructor._roundFormattedValueShownOnFocus(n,this.settings):(this.settings.divisorWhenUnfocused&&(n=(n/=this.settings.divisorWhenUnfocused).toString()),this.constructor._roundFormattedValueShownOnBlur(n,this.settings)),n=this.constructor._modifyNegativeSignAndDecimalCharacterForFormattedValue(n,this.settings),n=this.constructor._addGroupSeparators(n,this.settings,this.isFocused,this.rawValue,c),!this.isFocused&&this.settings.symbolWhenUnfocused&&(n="".concat(n).concat(this.settings.symbolWhenUnfocused)),(this.settings.decimalPlacesShownOnFocus||this.settings.divisorWhenUnfocused)&&this._saveValueToPersistentStorage(),this._setElementAndRawValue(n,c,r),this._setValidOrInvalidState(c),this}return this._triggerRangeEvents(l,u),M.throwError("The value [".concat(n,"] being set falls outside of the minimumValue [").concat(this.settings.minimumValue,"] and maximumValue [").concat(this.settings.maximumValue,"] range set for this element")),this._removeValueFromPersistentStorage(),this.setValue("",r),this}},{key:"setUnformatted",value:function(e,t){var i=1<arguments.length&&void 0!==t?t:null;if(null===e||M.isUndefined(e))return this;M.isNull(i)||this._setSettings(i,!0);var n=this.constructor._removeBrackets(e,this.settings),a=this.constructor._stripAllNonNumberCharacters(n,this.settings,!0,this.isFocused);return M.isNumber(a)||M.throwError("The value is not a valid one, it's not a numeric string nor a recognized currency."),this.constructor._isWithinRangeWithOverrideOption(a,this.settings)?this.setValue(e):M.throwError("The value is out of the range limits [".concat(this.settings.minimumValue,", ").concat(this.settings.maximumValue,"].")),this}},{key:"setValue",value:function(e,t){var i=!(1<arguments.length&&void 0!==t)||t;return this._setElementAndRawValue(e,i),this}},{key:"_setRawValue",value:function(e,t){var i=!(1<arguments.length&&void 0!==t)||t;if(this.rawValue!==e){var n=this.rawValue;this.rawValue=e,!M.isNull(this.settings.rawValueDivisor)&&0!==this.settings.rawValueDivisor&&""!==e&&null!==e&&this._isUserManuallyEditingTheValue()&&(this.rawValue/=this.settings.rawValueDivisor),this._triggerEvent(B.events.rawValueModified,this.domElement,{oldRawValue:n,newRawValue:this.rawValue,isPristine:this.isPristine(!0),error:null,aNElement:this}),this._parseStyleRules(),i&&this._historyTableAdd()}}},{key:"_setElementValue",value:function(e,t){var i=!(1<arguments.length&&void 0!==t)||t,n=M.getElementValue(this.domElement);return e!==n&&(this.internalModification=!0,M.setElementValue(this.domElement,e),this.internalModification=!1,i&&this._triggerEvent(B.events.formatted,this.domElement,{oldValue:n,newValue:e,oldRawValue:this.rawValue,newRawValue:this.rawValue,isPristine:this.isPristine(!1),error:null,aNElement:this})),this}},{key:"_setElementAndRawValue",value:function(e,t,i){var n=1<arguments.length&&void 0!==t?t:null,a=!(2<arguments.length&&void 0!==i)||i;return M.isNull(n)?n=e:M.isBoolean(n)&&(a=n,n=e),this._setElementValue(e),this._setRawValue(n,a),this}},{key:"_getRawValueToFormat",value:function(e){return M.isNull(this.settings.rawValueDivisor)||0===this.settings.rawValueDivisor||""===e||null===e?e:e*this.settings.rawValueDivisor}},{key:"_checkValuesToStrings",value:function(e){return this.constructor._checkValuesToStringsArray(e,this.valuesToStringsKeys)}},{key:"_isUserManuallyEditingTheValue",value:function(){return this.isFocused&&this.isEditing||this.isDropEvent}},{key:"_executeCallback",value:function(e,t){!M.isNull(t)&&M.isFunction(t)&&t(e,this)}},{key:"_triggerEvent",value:function(e,t,i){var n=1<arguments.length&&void 0!==t?t:document,a=2<arguments.length&&void 0!==i?i:null;M.triggerEvent(e,n,a,this.settings.eventBubbles,this.settings.eventIsCancelable)}},{key:"get",value:function(e){var t=0<arguments.length&&void 0!==e?e:null;return this.getNumericString(t)}},{key:"getNumericString",value:function(e){var t,i=0<arguments.length&&void 0!==e?e:null;return t=M.isNull(this.rawValue)?null:M.trimPaddedZerosFromDecimalPlaces(this.rawValue),this._executeCallback(t,i),t}},{key:"getFormatted",value:function(e){var t=0<arguments.length&&void 0!==e?e:null;"value"in this.domElement||"textContent"in this.domElement||M.throwError("Unable to get the formatted string from the element.");var i=M.getElementValue(this.domElement);return this._executeCallback(i,t),i}},{key:"getNumber",value:function(e){var t,i=0<arguments.length&&void 0!==e?e:null;return t=null===this.rawValue?null:this.constructor._toLocale(this.getNumericString(),"number",this.settings),this._executeCallback(t,i),t}},{key:"getLocalized",value:function(e,t){var i,n,a=0<arguments.length&&void 0!==e?e:null,r=1<arguments.length&&void 0!==t?t:null;M.isFunction(a)&&M.isNull(r)&&(r=a,a=null),(i=M.isEmptyString(this.rawValue)?"":""+Number(this.rawValue))&&0===Number(i)&&this.settings.leadingZero!==B.options.leadingZero.keep&&(i="0"),n=M.isNull(a)?this.settings.outputFormat:a;var s=this.constructor._toLocale(i,n,this.settings);return this._executeCallback(s,r),s}},{key:"reformat",value:function(){return this.set(this.rawValue),this}},{key:"unformat",value:function(){return this._setElementValue(this.getNumericString()),this}},{key:"unformatLocalized",value:function(e){var t=0<arguments.length&&void 0!==e?e:null;return this._setElementValue(this.getLocalized(t)),this}},{key:"isPristine",value:function(e){return 0<arguments.length&&void 0!==e&&!e?this.initialValueHtmlAttribute===this.getFormatted():this.initialValue===this.getNumericString()}},{key:"select",value:function(){return this.settings.selectNumberOnly?this.selectNumber():this._defaultSelectAll(),this}},{key:"_defaultSelectAll",value:function(){M.setElementSelection(this.domElement,0,M.getElementValue(this.domElement).length)}},{key:"selectNumber",value:function(){var e,t,i=M.getElementValue(this.domElement),n=i.length,a=this.settings.currencySymbol.length,r=this.settings.currencySymbolPlacement,s=M.isNegative(i,this.settings.negativeSignCharacter)?1:0,o=this.settings.suffixText.length;if(e=r===B.options.currencySymbolPlacement.suffix?0:this.settings.negativePositiveSignPlacement===B.options.negativePositiveSignPlacement.left&&1==s&&0<a?a+1:a,r===B.options.currencySymbolPlacement.prefix)t=n-o;else switch(this.settings.negativePositiveSignPlacement){case B.options.negativePositiveSignPlacement.left:t=n-(o+a);break;case B.options.negativePositiveSignPlacement.right:t=0<a?n-(a+s+o):n-(a+o);break;default:t=n-(a+o)}return M.setElementSelection(this.domElement,e,t),this}},{key:"selectInteger",value:function(){var e=0,t=0<=this.rawValue;this.settings.currencySymbolPlacement!==B.options.currencySymbolPlacement.prefix&&(this.settings.currencySymbolPlacement!==B.options.currencySymbolPlacement.suffix||this.settings.negativePositiveSignPlacement!==B.options.negativePositiveSignPlacement.prefix&&this.settings.negativePositiveSignPlacement!==B.options.negativePositiveSignPlacement.none)||(this.settings.showPositiveSign&&t||!t&&this.settings.currencySymbolPlacement===B.options.currencySymbolPlacement.prefix&&this.settings.negativePositiveSignPlacement===B.options.negativePositiveSignPlacement.left)&&(e+=1),this.settings.currencySymbolPlacement===B.options.currencySymbolPlacement.prefix&&(e+=this.settings.currencySymbol.length);var i=M.getElementValue(this.domElement),n=i.indexOf(this.settings.decimalCharacter);return-1===n&&(n=this.settings.currencySymbolPlacement===B.options.currencySymbolPlacement.suffix?i.length-this.settings.currencySymbol.length:i.length,t||this.settings.negativePositiveSignPlacement!==B.options.negativePositiveSignPlacement.suffix&&this.settings.currencySymbolPlacement!==B.options.currencySymbolPlacement.suffix||--n,n-=this.settings.suffixText.length),M.setElementSelection(this.domElement,e,n),this}},{key:"selectDecimal",value:function(){var e,t,i=M.getElementValue(this.domElement).indexOf(this.settings.decimalCharacter);return e=-1===i?i=0:(i+=1,t=this.isFocused?this.settings.decimalPlacesShownOnFocus:this.settings.decimalPlacesShownOnBlur,i+Number(t)),M.setElementSelection(this.domElement,i,e),this}},{key:"node",value:function(){return this.domElement}},{key:"parent",value:function(){return this.domElement.parentNode}},{key:"detach",value:function(e){var t,i=0<arguments.length&&void 0!==e?e:null;return t=M.isNull(i)?this.domElement:i.node(),this._removeFromLocalList(t),this}},{key:"attach",value:function(e,t){var i=!(1<arguments.length&&void 0!==t)||t;return this._addToLocalList(e.node()),i&&e.update(this.settings),this}},{key:"formatOther",value:function(e,t){var i=1<arguments.length&&void 0!==t?t:null;return this._formatOrUnformatOther(!0,e,i)}},{key:"unformatOther",value:function(e,t){var i=1<arguments.length&&void 0!==t?t:null;return this._formatOrUnformatOther(!1,e,i)}},{key:"_formatOrUnformatOther",value:function(e,t,i){var n,a,r=2<arguments.length&&void 0!==i?i:null;if(n=M.isNull(r)?this.settings:this._cloneAndMergeSettings(r),M.isElement(t)){var s=M.getElementValue(t);return a=e?B.format(s,n):B.unformat(s,n),M.setElementValue(t,a),null}return e?B.format(t,n):B.unformat(t,n)}},{key:"init",value:function(e,t){var n=this,a=!(1<arguments.length&&void 0!==t)||t,i=!1,r=[];if(M.isString(e)?r=p(document.querySelectorAll(e)):M.isElement(e)?(r.push(e),i=!0):M.isArray(e)?r=e:M.throwError("The given parameters to the 'init' function are invalid."),0===r.length)return M.warning("No valid DOM elements were given hence no AutoNumeric object were instantiated.",!0),[];var s=this._getLocalList(),o=[];return r.forEach(function(e){var t=n.settings.createLocalList;a&&(n.settings.createLocalList=!1);var i=new B(e,M.getElementValue(e),n.settings);a&&(i._setLocalList(s),n._addToLocalList(e,i),n.settings.createLocalList=t),o.push(i)}),i?o[0]:o}},{key:"clear",value:function(e){if(0<arguments.length&&void 0!==e&&e){var t={emptyInputBehavior:B.options.emptyInputBehavior.focus};this.set("",t)}else this.set("");return this}},{key:"remove",value:function(){this._removeValueFromPersistentStorage(),this._removeEventListeners(),this._removeWatcher(),this._removeFromLocalList(this.domElement),this.constructor._removeFromGlobalList(this)}},{key:"wipe",value:function(){this._setElementValue("",!1),this.remove()}},{key:"nuke",value:function(){this.remove(),this.domElement.parentNode.removeChild(this.domElement)}},{key:"form",value:function(e){if(0<arguments.length&&void 0!==e&&e||M.isUndefinedOrNullOrEmpty(this.parentForm)){var t=this._getParentForm();if(!M.isNull(t)&&t!==this.parentForm){var i=this._getFormAutoNumericChildren(this.parentForm);this.parentForm.dataset.anCount=i.length,this._hasFormHandlerFunction(t)?this._incrementParentFormCounter(t):(this._storeFormHandlerFunction(t),this._initializeFormCounterToOne(t))}this.parentForm=t}return this.parentForm}},{key:"_getFormAutoNumericChildren",value:function(e){var t=this;return p(e.querySelectorAll("input")).filter(function(e){return t.constructor.isManagedByAutoNumeric(e)})}},{key:"_getParentForm",value:function(){if("body"===this.domElement.tagName.toLowerCase())return null;var e,t=this.domElement;do{if(t=t.parentNode,M.isNull(t))return null;if("body"===(e=t.tagName?t.tagName.toLowerCase():""))break}while("form"!==e);return"form"===e?t:null}},{key:"formNumericString",value:function(){return this.constructor._serializeNumericString(this.form(),this.settings.serializeSpaces)}},{key:"formFormatted",value:function(){return this.constructor._serializeFormatted(this.form(),this.settings.serializeSpaces)}},{key:"formLocalized",value:function(e){var t,i=0<arguments.length&&void 0!==e?e:null;return t=M.isNull(i)?this.settings.outputFormat:i,this.constructor._serializeLocalized(this.form(),this.settings.serializeSpaces,t)}},{key:"formArrayNumericString",value:function(){return this.constructor._serializeNumericStringArray(this.form(),this.settings.serializeSpaces)}},{key:"formArrayFormatted",value:function(){return this.constructor._serializeFormattedArray(this.form(),this.settings.serializeSpaces)}},{key:"formArrayLocalized",value:function(e){var t,i=0<arguments.length&&void 0!==e?e:null;return t=M.isNull(i)?this.settings.outputFormat:i,this.constructor._serializeLocalizedArray(this.form(),this.settings.serializeSpaces,t)}},{key:"formJsonNumericString",value:function(){return JSON.stringify(this.formArrayNumericString())}},{key:"formJsonFormatted",value:function(){return JSON.stringify(this.formArrayFormatted())}},{key:"formJsonLocalized",value:function(e){var t=0<arguments.length&&void 0!==e?e:null;return JSON.stringify(this.formArrayLocalized(t))}},{key:"formUnformat",value:function(){return this.constructor._getChildANInputElement(this.form()).forEach(function(e){B.getAutoNumericElement(e).unformat()}),this}},{key:"formUnformatLocalized",value:function(){return this.constructor._getChildANInputElement(this.form()).forEach(function(e){B.getAutoNumericElement(e).unformatLocalized()}),this}},{key:"formReformat",value:function(){return this.constructor._getChildANInputElement(this.form()).forEach(function(e){B.getAutoNumericElement(e).reformat()}),this}},{key:"formSubmitNumericString",value:function(e){var t=0<arguments.length&&void 0!==e?e:null;return M.isNull(t)?(this.formUnformat(),this.form().submit(),this.formReformat()):M.isFunction(t)?t(this.formNumericString()):M.throwError("The given callback is not a function."),this}},{key:"formSubmitFormatted",value:function(e){var t=0<arguments.length&&void 0!==e?e:null;return M.isNull(t)?this.form().submit():M.isFunction(t)?t(this.formFormatted()):M.throwError("The given callback is not a function."),this}},{key:"formSubmitLocalized",value:function(e,t){var i=0<arguments.length&&void 0!==e?e:null,n=1<arguments.length&&void 0!==t?t:null;return M.isNull(n)?(this.formUnformatLocalized(),this.form().submit(),this.formReformat()):M.isFunction(n)?n(this.formLocalized(i)):M.throwError("The given callback is not a function."),this}},{key:"formSubmitArrayNumericString",value:function(e){return M.isFunction(e)?e(this.formArrayNumericString()):M.throwError("The given callback is not a function."),this}},{key:"formSubmitArrayFormatted",value:function(e){return M.isFunction(e)?e(this.formArrayFormatted()):M.throwError("The given callback is not a function."),this}},{key:"formSubmitArrayLocalized",value:function(e,t){var i=1<arguments.length&&void 0!==t?t:null;return M.isFunction(e)?e(this.formArrayLocalized(i)):M.throwError("The given callback is not a function."),this}},{key:"formSubmitJsonNumericString",value:function(e){return M.isFunction(e)?e(this.formJsonNumericString()):M.throwError("The given callback is not a function."),this}},{key:"formSubmitJsonFormatted",value:function(e){return M.isFunction(e)?e(this.formJsonFormatted()):M.throwError("The given callback is not a function."),this}},{key:"formSubmitJsonLocalized",value:function(e,t){var i=1<arguments.length&&void 0!==t?t:null;return M.isFunction(e)?e(this.formJsonLocalized(i)):M.throwError("The given callback is not a function."),this}},{key:"_createLocalList",value:function(){this.autoNumericLocalList=new Map,this._addToLocalList(this.domElement)}},{key:"_deleteLocalList",value:function(){delete this.autoNumericLocalList}},{key:"_setLocalList",value:function(e){this.autoNumericLocalList=e}},{key:"_getLocalList",value:function(){return this.autoNumericLocalList}},{key:"_hasLocalList",value:function(){return this.autoNumericLocalList instanceof Map&&0!==this.autoNumericLocalList.size}},{key:"_addToLocalList",value:function(e,t){var i=1<arguments.length&&void 0!==t?t:null;M.isNull(i)&&(i=this),M.isUndefined(this.autoNumericLocalList)?M.throwError("The local list provided does not exists when trying to add an element. [".concat(this.autoNumericLocalList,"] given.")):this.autoNumericLocalList.set(e,i)}},{key:"_removeFromLocalList",value:function(e){M.isUndefined(this.autoNumericLocalList)?this.settings.createLocalList&&M.throwError("The local list provided does not exists when trying to remove an element. [".concat(this.autoNumericLocalList,"] given.")):this.autoNumericLocalList.delete(e)}},{key:"_mergeSettings",value:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];b.apply(void 0,[this.settings].concat(t))}},{key:"_cloneAndMergeSettings",value:function(){for(var e={},t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];return b.apply(void 0,[e,this.settings].concat(i)),e}},{key:"_updatePredefinedOptions",value:function(e,t){var i=1<arguments.length&&void 0!==t?t:null;return M.isNull(i)?this.update(e):(this._mergeSettings(e,i),this.update(this.settings)),this}},{key:"french",value:function(e){var t=0<arguments.length&&void 0!==e?e:null;return this._updatePredefinedOptions(B.getPredefinedOptions().French,t),this}},{key:"northAmerican",value:function(e){var t=0<arguments.length&&void 0!==e?e:null;return this._updatePredefinedOptions(B.getPredefinedOptions().NorthAmerican,t),this}},{key:"british",value:function(e){var t=0<arguments.length&&void 0!==e?e:null;return this._updatePredefinedOptions(B.getPredefinedOptions().British,t),this}},{key:"swiss",value:function(e){var t=0<arguments.length&&void 0!==e?e:null;return this._updatePredefinedOptions(B.getPredefinedOptions().Swiss,t),this}},{key:"japanese",value:function(e){var t=0<arguments.length&&void 0!==e?e:null;return this._updatePredefinedOptions(B.getPredefinedOptions().Japanese,t),this}},{key:"spanish",value:function(e){var t=0<arguments.length&&void 0!==e?e:null;return this._updatePredefinedOptions(B.getPredefinedOptions().Spanish,t),this}},{key:"chinese",value:function(e){var t=0<arguments.length&&void 0!==e?e:null;return this._updatePredefinedOptions(B.getPredefinedOptions().Chinese,t),this}},{key:"brazilian",value:function(e){var t=0<arguments.length&&void 0!==e?e:null;return this._updatePredefinedOptions(B.getPredefinedOptions().Brazilian,t),this}},{key:"_runCallbacksFoundInTheSettingsObject",value:function(){for(var e in this.settings)if(Object.prototype.hasOwnProperty.call(this.settings,e)){var t=this.settings[e];if("function"==typeof t)this.settings[e]=t(this,e);else{var i=this.domElement.getAttribute(e);i=M.camelize(i),"function"==typeof this.settings[i]&&(this.settings[e]=i(this,e))}}}},{key:"_setTrailingNegativeSignInfo",value:function(){this.isTrailingNegative=this.settings.currencySymbolPlacement===B.options.currencySymbolPlacement.prefix&&this.settings.negativePositiveSignPlacement===B.options.negativePositiveSignPlacement.suffix||this.settings.currencySymbolPlacement===B.options.currencySymbolPlacement.suffix&&(this.settings.negativePositiveSignPlacement===B.options.negativePositiveSignPlacement.left||this.settings.negativePositiveSignPlacement===B.options.negativePositiveSignPlacement.right)}},{key:"_modifyNegativeSignAndDecimalCharacterForRawValue",value:function(e){return"."!==this.settings.decimalCharacter&&(e=e.replace(this.settings.decimalCharacter,".")),"-"!==this.settings.negativeSignCharacter&&this.settings.isNegativeSignAllowed&&(e=e.replace(this.settings.negativeSignCharacter,"-")),e.match(/\d/)||(e+="0"),e}},{key:"_initialCaretPosition",value:function(e){M.isNull(this.settings.caretPositionOnFocus)&&this.settings.selectOnFocus===B.options.selectOnFocus.doNotSelect&&M.throwError("`_initialCaretPosition()` should never be called when the `caretPositionOnFocus` option is `null`.");var t=this.rawValue<0,i=M.isZeroOrHasNoValue(e),n=e.length,a=0,r=0,s=!1,o=0;this.settings.caretPositionOnFocus!==B.options.caretPositionOnFocus.start&&(a=(e=(e=(e=e.replace(this.settings.negativeSignCharacter,"")).replace(this.settings.positiveSignCharacter,"")).replace(this.settings.currencySymbol,"")).length,s=M.contains(e,this.settings.decimalCharacter),this.settings.caretPositionOnFocus!==B.options.caretPositionOnFocus.decimalLeft&&this.settings.caretPositionOnFocus!==B.options.caretPositionOnFocus.decimalRight||(o=s?(r=e.indexOf(this.settings.decimalCharacter),this.settings.decimalCharacter.length):(r=a,0)));var l="";t?l=this.settings.negativeSignCharacter:this.settings.showPositiveSign&&!i&&(l=this.settings.positiveSignCharacter);var u,c=l.length,h=this.settings.currencySymbol.length;if(this.settings.currencySymbolPlacement===B.options.currencySymbolPlacement.prefix){if(this.settings.caretPositionOnFocus===B.options.caretPositionOnFocus.start)if(this.settings.negativePositiveSignPlacement!==B.options.negativePositiveSignPlacement.none&&(t||!t&&this.settings.showPositiveSign&&!i))switch(this.settings.negativePositiveSignPlacement){case B.options.negativePositiveSignPlacement.prefix:case B.options.negativePositiveSignPlacement.left:case B.options.negativePositiveSignPlacement.right:u=c+h;break;case B.options.negativePositiveSignPlacement.suffix:u=h}else u=h;else if(this.settings.caretPositionOnFocus===B.options.caretPositionOnFocus.end)if(this.settings.negativePositiveSignPlacement!==B.options.negativePositiveSignPlacement.none&&(t||!t&&this.settings.showPositiveSign&&!i))switch(this.settings.negativePositiveSignPlacement){case B.options.negativePositiveSignPlacement.prefix:case B.options.negativePositiveSignPlacement.left:case B.options.negativePositiveSignPlacement.right:u=n;break;case B.options.negativePositiveSignPlacement.suffix:u=h+a}else u=n;else if(this.settings.caretPositionOnFocus===B.options.caretPositionOnFocus.decimalLeft)if(this.settings.negativePositiveSignPlacement!==B.options.negativePositiveSignPlacement.none&&(t||!t&&this.settings.showPositiveSign&&!i))switch(this.settings.negativePositiveSignPlacement){case B.options.negativePositiveSignPlacement.prefix:case B.options.negativePositiveSignPlacement.left:case B.options.negativePositiveSignPlacement.right:u=c+h+r;break;case B.options.negativePositiveSignPlacement.suffix:u=h+r}else u=h+r;else if(this.settings.caretPositionOnFocus===B.options.caretPositionOnFocus.decimalRight)if(this.settings.negativePositiveSignPlacement!==B.options.negativePositiveSignPlacement.none&&(t||!t&&this.settings.showPositiveSign&&!i))switch(this.settings.negativePositiveSignPlacement){case B.options.negativePositiveSignPlacement.prefix:case B.options.negativePositiveSignPlacement.left:case B.options.negativePositiveSignPlacement.right:u=c+h+r+o;break;case B.options.negativePositiveSignPlacement.suffix:u=h+r+o}else u=h+r+o}else if(this.settings.currencySymbolPlacement===B.options.currencySymbolPlacement.suffix)if(this.settings.caretPositionOnFocus===B.options.caretPositionOnFocus.start)if(this.settings.negativePositiveSignPlacement!==B.options.negativePositiveSignPlacement.none&&(t||!t&&this.settings.showPositiveSign&&!i))switch(this.settings.negativePositiveSignPlacement){case B.options.negativePositiveSignPlacement.suffix:case B.options.negativePositiveSignPlacement.right:case B.options.negativePositiveSignPlacement.left:u=0;break;case B.options.negativePositiveSignPlacement.prefix:u=c}else u=0;else if(this.settings.caretPositionOnFocus===B.options.caretPositionOnFocus.end)if(this.settings.negativePositiveSignPlacement!==B.options.negativePositiveSignPlacement.none&&(t||!t&&this.settings.showPositiveSign&&!i))switch(this.settings.negativePositiveSignPlacement){case B.options.negativePositiveSignPlacement.suffix:case B.options.negativePositiveSignPlacement.right:case B.options.negativePositiveSignPlacement.left:u=a;break;case B.options.negativePositiveSignPlacement.prefix:u=c+a}else u=a;else if(this.settings.caretPositionOnFocus===B.options.caretPositionOnFocus.decimalLeft)if(this.settings.negativePositiveSignPlacement!==B.options.negativePositiveSignPlacement.none&&(t||!t&&this.settings.showPositiveSign&&!i))switch(this.settings.negativePositiveSignPlacement){case B.options.negativePositiveSignPlacement.suffix:case B.options.negativePositiveSignPlacement.right:case B.options.negativePositiveSignPlacement.left:u=r;break;case B.options.negativePositiveSignPlacement.prefix:u=c+r}else u=r;else if(this.settings.caretPositionOnFocus===B.options.caretPositionOnFocus.decimalRight)if(this.settings.negativePositiveSignPlacement!==B.options.negativePositiveSignPlacement.none&&(t||!t&&this.settings.showPositiveSign&&!i))switch(this.settings.negativePositiveSignPlacement){case B.options.negativePositiveSignPlacement.suffix:case B.options.negativePositiveSignPlacement.right:case B.options.negativePositiveSignPlacement.left:u=r+o;break;case B.options.negativePositiveSignPlacement.prefix:u=c+r+o}else u=r+o;return u}},{key:"_triggerRangeEvents",value:function(e,t){e||this._triggerEvent(B.events.minRangeExceeded,this.domElement),t||this._triggerEvent(B.events.maxRangeExceeded,this.domElement)}},{key:"_setInvalidState",value:function(){this.isInputElement?M.setInvalidState(this.domElement):this._addCSSClass(this.settings.invalidClass),this._triggerEvent(B.events.invalidValue,this.domElement),this.validState=!1}},{key:"_setValidState",value:function(){this.isInputElement?M.setValidState(this.domElement):this._removeCSSClass(this.settings.invalidClass),this.validState||this._triggerEvent(B.events.correctedValue,this.domElement),this.validState=!0}},{key:"_setValidOrInvalidState",value:function(e){if(this.settings.overrideMinMaxLimits===B.options.overrideMinMaxLimits.invalid){var t=this.constructor._isMinimumRangeRespected(e,this.settings),i=this.constructor._isMaximumRangeRespected(e,this.settings);t&&i?this._setValidState():this._setInvalidState(),this._triggerRangeEvents(t,i)}}},{key:"_keepAnOriginalSettingsCopy",value:function(){this.originalDigitGroupSeparator=this.settings.digitGroupSeparator,this.originalCurrencySymbol=this.settings.currencySymbol,this.originalSuffixText=this.settings.suffixText}},{key:"_trimLeadingAndTrailingZeros",value:function(e){if(""===e||null===e)return e;if(this.settings.leadingZero!==B.options.leadingZero.keep){if(0===Number(e))return"0";e=e.replace(/^(-)?0+(?=\d)/g,"$1")}return M.contains(e,".")&&(e=e.replace(/(\.[0-9]*?)0+$/,"$1")),e.replace(/\.$/,"")}},{key:"_setPersistentStorageName",value:function(){this.settings.saveValueToSessionStorage&&(""===this.domElement.name||M.isUndefined(this.domElement.name)?this.rawValueStorageName="".concat(this.storageNamePrefix).concat(this.domElement.id):this.rawValueStorageName="".concat(this.storageNamePrefix).concat(decodeURIComponent(this.domElement.name)))}},{key:"_saveValueToPersistentStorage",value:function(){this.settings.saveValueToSessionStorage&&(this.sessionStorageAvailable?sessionStorage.setItem(this.rawValueStorageName,this.rawValue):document.cookie="".concat(this.rawValueStorageName,"=").concat(this.rawValue,"; expires= ; path=/"))}},{key:"_getValueFromPersistentStorage",value:function(){return this.settings.saveValueToSessionStorage?this.sessionStorageAvailable?sessionStorage.getItem(this.rawValueStorageName):this.constructor._readCookie(this.rawValueStorageName):(M.warning("`_getValueFromPersistentStorage()` is called but `settings.saveValueToSessionStorage` is false. There must be an error that needs fixing.",this.settings.showWarnings),null)}},{key:"_removeValueFromPersistentStorage",value:function(){if(this.settings.saveValueToSessionStorage)if(this.sessionStorageAvailable)sessionStorage.removeItem(this.rawValueStorageName);else{var e=new Date;e.setTime(e.getTime()-864e5);var t="; expires=".concat(e.toUTCString());document.cookie="".concat(this.rawValueStorageName,"='' ;").concat(t,"; path=/")}}},{key:"_getDefaultValue",value:function(e){var t=e.getAttribute("value");return M.isNull(t)?"":t}},{key:"_onFocusInAndMouseEnter",value:function(e){if(this.isEditing=!1,!this.formulaMode&&this.settings.unformatOnHover&&"mouseenter"===e.type&&e.altKey)this.constructor._unformatAltHovered(this);else if("focus"===e.type&&(this.isFocused=!0,this.rawValueOnFocus=this.rawValue),"focus"===e.type&&this.settings.unformatOnHover&&this.hoveredWithAlt&&this.constructor._reformatAltHovered(this),"focus"===e.type||"mouseenter"===e.type&&!this.isFocused){var t=null;this.settings.emptyInputBehavior===B.options.emptyInputBehavior.focus&&this.rawValue<0&&null!==this.settings.negativeBracketsTypeOnBlur&&this.settings.isNegativeSignAllowed&&(t=this.constructor._removeBrackets(M.getElementValue(this.domElement),this.settings));var i=this._getRawValueToFormat(this.rawValue);if(""!==i){var n=this.constructor._roundFormattedValueShownOnFocusOrBlur(i,this.settings,this.isFocused);t=this.settings.showOnlyNumbersOnFocus===B.options.showOnlyNumbersOnFocus.onlyNumbers?(this.settings.digitGroupSeparator="",this.settings.currencySymbol="",this.settings.suffixText="",n.replace(".",this.settings.decimalCharacter)):M.isNull(n)?"":this.constructor._addGroupSeparators(n.replace(".",this.settings.decimalCharacter),this.settings,this.isFocused,i)}M.isNull(t)?this.valueOnFocus="":this.valueOnFocus=t,this.lastVal=this.valueOnFocus;var a=this.constructor._isElementValueEmptyOrOnlyTheNegativeSign(this.valueOnFocus,this.settings),r=this.constructor._orderValueCurrencySymbolAndSuffixText(this.valueOnFocus,this.settings,!0),s=a&&""!==r&&this.settings.emptyInputBehavior===B.options.emptyInputBehavior.focus;s&&(t=r),M.isNull(t)||this._setElementValue(t),s&&r===this.settings.currencySymbol&&this.settings.currencySymbolPlacement===B.options.currencySymbolPlacement.suffix&&M.setElementSelection(e.target,0)}}},{key:"_onFocus",value:function(){this.settings.isCancellable&&this._saveCancellableValue()}},{key:"_onFocusIn",value:function(e){this.settings.selectOnFocus?this.select():M.isNull(this.settings.caretPositionOnFocus)||M.setElementSelection(e.target,this._initialCaretPosition(M.getElementValue(this.domElement)))}},{key:"_enterFormulaMode",value:function(){this.settings.formulaMode&&(this.formulaMode=!0,M.setElementValue(this.domElement,"="),M.setElementSelection(this.domElement,1))}},{key:"_exitFormulaMode",value:function(){var e,t=M.getElementValue(this.domElement);t=t.replace(/^\s*=/,"");try{var i=new v(t,this.settings.decimalCharacter);e=(new u).evaluate(i)}catch(e){return this._triggerEvent(B.events.invalidFormula,this.domElement,{formula:t,aNElement:this}),this.reformat(),void(this.formulaMode=!1)}this._triggerEvent(B.events.validFormula,this.domElement,{formula:t,result:e,aNElement:this}),this.set(e),this.formulaMode=!1}},{key:"_acceptNonPrintableKeysInFormulaMode",value:function(){return this.eventKey===d.keyName.Backspace||this.eventKey===d.keyName.Delete||this.eventKey===d.keyName.LeftArrow||this.eventKey===d.keyName.RightArrow||this.eventKey===d.keyName.Home||this.eventKey===d.keyName.End}},{key:"_onKeydown",value:function(e){if(this.formatted=!1,this.isEditing=!0,this.formulaMode||this.isFocused||!this.settings.unformatOnHover||!e.altKey||this.domElement!==M.getHoveredElement()){if(this._updateEventKeyInfo(e),this.keydownEventCounter+=1,1===this.keydownEventCounter&&(this.initialValueOnFirstKeydown=M.getElementValue(e.target),this.initialRawValueOnFirstKeydown=this.rawValue),this.formulaMode){if(this.eventKey===d.keyName.Esc)return this.formulaMode=!1,void this.reformat();if(this.eventKey===d.keyName.Enter)return void this._exitFormulaMode();if(this._acceptNonPrintableKeysInFormulaMode())return}else if(this.eventKey===d.keyName.Equal)return void this._enterFormulaMode();if(this.domElement.readOnly||this.settings.readOnly||this.domElement.disabled)this.processed=!0;else{this.eventKey===d.keyName.Esc&&(e.preventDefault(),this.settings.isCancellable&&this.rawValue!==this.savedCancellableValue&&(this.set(this.savedCancellableValue),this._triggerEvent(B.events.native.input,e.target)),this.select());var t=M.getElementValue(e.target);if(this.eventKey===d.keyName.Enter&&this.rawValue!==this.rawValueOnFocus&&(this._triggerEvent(B.events.native.change,e.target),this.valueOnFocus=t,this.rawValueOnFocus=this.rawValue,this.settings.isCancellable&&this._saveCancellableValue()),this._updateInternalProperties(e),this._processNonPrintableKeysAndShortcuts(e))this.processed=!0;else if(this.eventKey===d.keyName.Backspace||this.eventKey===d.keyName.Delete){var i=this._processCharacterDeletion();if(this.processed=!0,!i)return void e.preventDefault();this._formatValue(e),(t=M.getElementValue(e.target))!==this.lastVal&&this.throwInput&&(this._triggerEvent(B.events.native.input,e.target),e.preventDefault()),this.lastVal=t,this.throwInput=!0}}}else this.constructor._unformatAltHovered(this)}},{key:"_onKeypress",value:function(e){if(this.formulaMode){if(this._acceptNonPrintableKeysInFormulaMode())return;if(this.settings.formulaChars.test(this.eventKey))return;e.preventDefault()}else if(this.eventKey!==d.keyName.Insert){var t=this.processed;if(this._updateInternalProperties(e),!this._processNonPrintableKeysAndShortcuts(e))if(t)e.preventDefault();else{if(this._processCharacterInsertion()){this._formatValue(e);var i=M.getElementValue(e.target);if(i!==this.lastVal&&this.throwInput)this._triggerEvent(B.events.native.input,e.target),e.preventDefault();else{if((this.eventKey===this.settings.decimalCharacter||this.eventKey===this.settings.decimalCharacterAlternative)&&M.getElementSelection(e.target).start===M.getElementSelection(e.target).end&&M.getElementSelection(e.target).start===i.indexOf(this.settings.decimalCharacter)){var n=M.getElementSelection(e.target).start+1;M.setElementSelection(e.target,n)}e.preventDefault()}return this.lastVal=M.getElementValue(e.target),this.throwInput=!0,void this._setValidOrInvalidState(this.rawValue)}e.preventDefault()}}}},{key:"_onKeyup",value:function(e){if(this.isEditing=!1,this.keydownEventCounter=0,!this.formulaMode)if(this.settings.isCancellable&&this.eventKey===d.keyName.Esc)e.preventDefault();else{if(this.eventKey===d.keyName.Z||this.eventKey===d.keyName.z){if(e.ctrlKey&&e.shiftKey)return e.preventDefault(),this._historyTableRedo(),void(this.onGoingRedo=!0);if(e.ctrlKey&&!e.shiftKey){if(!this.onGoingRedo)return e.preventDefault(),void this._historyTableUndo();this.onGoingRedo=!1}}if(this.onGoingRedo&&(e.ctrlKey||e.shiftKey)&&(this.onGoingRedo=!1),(e.ctrlKey||e.metaKey)&&this.eventKey===d.keyName.x){var t=M.getElementSelection(this.domElement).start,i=this.constructor._toNumericValue(M.getElementValue(e.target),this.settings);this.set(i),this._setCaretPosition(t)}if(this.eventKey===d.keyName.Alt&&this.settings.unformatOnHover&&this.hoveredWithAlt)this.constructor._reformatAltHovered(this);else if(!e.ctrlKey&&!e.metaKey||this.eventKey!==d.keyName.Backspace&&this.eventKey!==d.keyName.Delete){this._updateInternalProperties(e);var n=this._processNonPrintableKeysAndShortcuts(e);delete this.valuePartsBeforePaste;var a=M.getElementValue(e.target);if(!(n||""===a&&""===this.initialValueOnFirstKeydown)&&(a===this.settings.currencySymbol?this.settings.currencySymbolPlacement===B.options.currencySymbolPlacement.suffix?M.setElementSelection(e.target,0):M.setElementSelection(e.target,this.settings.currencySymbol.length):this.eventKey===d.keyName.Tab&&M.setElementSelection(e.target,0,a.length),(a===this.settings.suffixText||""===this.rawValue&&""!==this.settings.currencySymbol&&""!==this.settings.suffixText)&&M.setElementSelection(e.target,0),null!==this.settings.decimalPlacesShownOnFocus&&this._saveValueToPersistentStorage(),this.formatted||this._formatValue(e),this._setValidOrInvalidState(this.rawValue),this._saveRawValueForAndroid(),a!==this.initialValueOnFirstKeydown&&this._triggerEvent(B.events.formatted,e.target,{oldValue:this.initialValueOnFirstKeydown,newValue:a,oldRawValue:this.initialRawValueOnFirstKeydown,newRawValue:this.rawValue,isPristine:this.isPristine(!1),error:null,aNElement:this}),1<this.historyTable.length)){var r=M.getElementSelection(this.domElement);this.selectionStart=r.start,this.selectionEnd=r.end,this.historyTable[this.historyTableIndex].start=this.selectionStart,this.historyTable[this.historyTableIndex].end=this.selectionEnd}}else{var s=M.getElementValue(e.target);this._setRawValue(this._formatOrUnformatOther(!1,s))}}}},{key:"_saveRawValueForAndroid",value:function(){if(this.eventKey===d.keyName.AndroidDefault){var e=this.constructor._stripAllNonNumberCharactersExceptCustomDecimalChar(this.getFormatted(),this.settings,!0,this.isFocused);e=this.constructor._convertToNumericString(e,this.settings),this._setRawValue(e)}}},{key:"_onFocusOutAndMouseLeave",value:function(e){if(this.isEditing=!1,"mouseleave"!==e.type||!this.formulaMode)if(this.settings.unformatOnHover&&"mouseleave"===e.type&&this.hoveredWithAlt)this.constructor._reformatAltHovered(this);else if("mouseleave"===e.type&&!this.isFocused||"blur"===e.type){"blur"===e.type&&this.formulaMode&&this._exitFormulaMode(),this._saveValueToPersistentStorage(),this.settings.showOnlyNumbersOnFocus===B.options.showOnlyNumbersOnFocus.onlyNumbers&&(this.settings.digitGroupSeparator=this.originalDigitGroupSeparator,this.settings.currencySymbol=this.originalCurrencySymbol,this.settings.suffixText=this.originalSuffixText);var t=this._getRawValueToFormat(this.rawValue),i=M.isNull(t),n=S(this.constructor._checkIfInRangeWithOverrideOption(t,this.settings),2),a=n[0],r=n[1],s=!1;if(""===t||i||(this._triggerRangeEvents(a,r),this.settings.valuesToStrings&&this._checkValuesToStrings(t)&&(this._setElementValue(this.settings.valuesToStrings[t]),s=!0)),!s){var o;if(o=i||""===t?t:String(t),""===t||i){if(""===t)switch(this.settings.emptyInputBehavior){case B.options.emptyInputBehavior.zero:this._setRawValue("0"),o=this.constructor._roundValue("0",this.settings,0);break;case B.options.emptyInputBehavior.min:this._setRawValue(this.settings.minimumValue),o=this.constructor._roundFormattedValueShownOnFocusOrBlur(this.settings.minimumValue,this.settings,this.isFocused);break;case B.options.emptyInputBehavior.max:this._setRawValue(this.settings.maximumValue),o=this.constructor._roundFormattedValueShownOnFocusOrBlur(this.settings.maximumValue,this.settings,this.isFocused);break;default:M.isNumber(this.settings.emptyInputBehavior)&&(this._setRawValue(this.settings.emptyInputBehavior),o=this.constructor._roundFormattedValueShownOnFocusOrBlur(this.settings.emptyInputBehavior,this.settings,this.isFocused))}}else a&&r&&!this.constructor._isElementValueEmptyOrOnlyTheNegativeSign(t,this.settings)?(o=this._modifyNegativeSignAndDecimalCharacterForRawValue(o),this.settings.divisorWhenUnfocused&&!M.isNull(o)&&(o=(o/=this.settings.divisorWhenUnfocused).toString()),o=this.constructor._roundFormattedValueShownOnBlur(o,this.settings),o=this.constructor._modifyNegativeSignAndDecimalCharacterForFormattedValue(o,this.settings)):this._triggerRangeEvents(a,r);var l=this.constructor._orderValueCurrencySymbolAndSuffixText(o,this.settings,!1);this.constructor._isElementValueEmptyOrOnlyTheNegativeSign(o,this.settings)||i&&this.settings.emptyInputBehavior===B.options.emptyInputBehavior.null||(l=this.constructor._addGroupSeparators(o,this.settings,!1,t)),l===t&&""!==t&&this.settings.allowDecimalPadding!==B.options.allowDecimalPadding.never&&this.settings.allowDecimalPadding!==B.options.allowDecimalPadding.floats||(this.settings.symbolWhenUnfocused&&""!==t&&null!==t&&(l="".concat(l).concat(this.settings.symbolWhenUnfocused)),this._setElementValue(l))}this._setValidOrInvalidState(this.rawValue),"blur"===e.type&&this._onBlur(e)}}},{key:"_onPaste",value:function(e){if(e.preventDefault(),!(this.settings.readOnly||this.domElement.readOnly||this.domElement.disabled)){var t,i;window.clipboardData&&window.clipboardData.getData?t=window.clipboardData.getData("Text"):e.clipboardData&&e.clipboardData.getData?t=e.clipboardData.getData("text/plain"):M.throwError("Unable to retrieve the pasted value. Please use a modern browser (ie. Firefox or Chromium)."),i=e.target.tagName?e.target:e.explicitOriginalTarget;var n=M.getElementValue(i),a=i.selectionStart||0,r=i.selectionEnd||0,s=r-a;if(s===n.length){var o=this._preparePastedText(t),l=M.arabicToLatinNumbers(o,!1,!1,!1);return"."===l||""===l||"."!==l&&!M.isNumber(l)?(this.formatted=!0,void(this.settings.onInvalidPaste===B.options.onInvalidPaste.error&&M.throwError("The pasted value '".concat(t,"' is not a valid paste content.")))):(this.set(l),this.formatted=!0,void this._triggerEvent(B.events.native.input,i))}var u=M.isNegativeStrict(t,this.settings.negativeSignCharacter);u&&(t=t.slice(1,t.length));var c,h,m=this._preparePastedText(t);if("."!==(c="."===m?".":M.arabicToLatinNumbers(m,!1,!1,!1))&&(!M.isNumber(c)||""===c))return this.formatted=!0,void(this.settings.onInvalidPaste===B.options.onInvalidPaste.error&&M.throwError("The pasted value '".concat(t,"' is not a valid paste content.")));var g,d,v=M.isNegativeStrict(this.getNumericString(),this.settings.negativeSignCharacter);g=!(!u||v)&&(v=!0);var p=n.slice(0,a),f=n.slice(r,n.length);d=a!==r?this._preparePastedText(p+f):this._preparePastedText(n),v&&(d=M.setRawNegativeSign(d)),h=M.convertCharacterCountToIndexPosition(M.countNumberCharactersOnTheCaretLeftSide(n,a,this.settings.decimalCharacter)),g&&h++;var y=d.slice(0,h),S=d.slice(h,d.length),b=!1;"."===c&&(M.contains(y,".")&&(b=!0,y=y.replace(".","")),S=S.replace(".",""));var w=!1;switch(""===y&&"-"===S&&(y="-",w=!(S="")),this.settings.onInvalidPaste){case B.options.onInvalidPaste.truncate:case B.options.onInvalidPaste.replace:for(var P=M.parseStr(this.settings.minimumValue),O=M.parseStr(this.settings.maximumValue),k=d,N=0,E=y;N<c.length&&(d=(E+=c[N])+S,this.constructor._checkIfInRange(d,P,O));)k=d,N++;if(h+=N,w&&h++,this.settings.onInvalidPaste===B.options.onInvalidPaste.truncate){d=k,b&&h--;break}for(var _=h,C=k.length;N<c.length&&_<C;)if("."!==k[_]){if(d=M.replaceCharAt(k,_,c[N]),!this.constructor._checkIfInRange(d,P,O))break;k=d,N++,_++}else _++;h=_,b&&h--,d=k;break;case B.options.onInvalidPaste.error:case B.options.onInvalidPaste.ignore:case B.options.onInvalidPaste.clamp:default:if(d="".concat(y).concat(c).concat(S),a===r)h=M.convertCharacterCountToIndexPosition(M.countNumberCharactersOnTheCaretLeftSide(n,a,this.settings.decimalCharacter))+c.length;else if(""===S)h=M.convertCharacterCountToIndexPosition(M.countNumberCharactersOnTheCaretLeftSide(n,a,this.settings.decimalCharacter))+c.length,w&&h++;else{var F=M.convertCharacterCountToIndexPosition(M.countNumberCharactersOnTheCaretLeftSide(n,r,this.settings.decimalCharacter)),x=M.getElementValue(i).slice(a,r);h=F-s+M.countCharInText(this.settings.digitGroupSeparator,x)+c.length}g&&h++,b&&h--}if(M.isNumber(d)&&""!==d){var V=!1,T=!1;try{this.set(d),V=!0}catch(e){var A;switch(this.settings.onInvalidPaste){case B.options.onInvalidPaste.clamp:A=M.clampToRangeLimits(d,this.settings);try{this.set(A)}catch(e){M.throwError("Fatal error: Unable to set the clamped value '".concat(A,"'."))}V=T=!0,d=A;break;case B.options.onInvalidPaste.error:case B.options.onInvalidPaste.truncate:case B.options.onInvalidPaste.replace:M.throwError("The pasted value '".concat(t,"' results in a value '").concat(d,"' that is outside of the minimum [").concat(this.settings.minimumValue,"] and maximum [").concat(this.settings.maximumValue,"] value range."));case B.options.onInvalidPaste.ignore:default:return}}var L,I=M.getElementValue(i);if(V)switch(this.settings.onInvalidPaste){case B.options.onInvalidPaste.clamp:if(T){this.settings.currencySymbolPlacement===B.options.currencySymbolPlacement.suffix?M.setElementSelection(i,I.length-this.settings.currencySymbol.length):M.setElementSelection(i,I.length);break}case B.options.onInvalidPaste.error:case B.options.onInvalidPaste.ignore:case B.options.onInvalidPaste.truncate:case B.options.onInvalidPaste.replace:default:L=M.findCaretPositionInFormattedNumber(d,h,I,this.settings.decimalCharacter),M.setElementSelection(i,L)}V&&n!==I&&this._triggerEvent(B.events.native.input,i)}else this.settings.onInvalidPaste===B.options.onInvalidPaste.error&&M.throwError("The pasted value '".concat(t,"' would result into an invalid content '").concat(d,"'."))}}},{key:"_onBlur",value:function(e){this.isFocused=!1,this.isEditing=!1,this.rawValue!==this.rawValueOnFocus&&this._triggerEvent(B.events.native.change,e.target),this.rawValueOnFocus=void 0}},{key:"_onWheel",value:function(e){this.formulaMode||this.settings.readOnly||this.domElement.readOnly||this.domElement.disabled||this.settings.modifyValueOnWheel&&(this.settings.wheelOn===B.options.wheelOn.focus?this.isFocused?e.shiftKey||this.wheelAction(e):e.shiftKey&&this.wheelAction(e):this.settings.wheelOn===B.options.wheelOn.hover?e.shiftKey?(e.preventDefault(),window.scrollBy(0,M.isNegativeStrict(String(e.deltaY))?-50:50)):this.wheelAction(e):M.throwError("Unknown `wheelOn` option."))}},{key:"wheelAction",value:function(e){this.isWheelEvent=!0;var t,i=e.target.selectionStart||0,n=e.target.selectionEnd||0,a=this.rawValue;if(M.isUndefinedOrNullOrEmpty(a)?0<this.settings.minimumValue||this.settings.maximumValue<0?M.isWheelUpEvent(e)?t=this.settings.minimumValue:M.isWheelDownEvent(e)?t=this.settings.maximumValue:M.throwError("The event is not a 'wheel' event."):t=0:t=a,t=+t,M.isNumber(this.settings.wheelStep)){var r=+this.settings.wheelStep;M.isWheelUpEvent(e)?t+=r:M.isWheelDownEvent(e)&&(t-=r)}else M.isWheelUpEvent(e)?t=M.addAndRoundToNearestAuto(t,this.settings.decimalPlacesRawValue):M.isWheelDownEvent(e)&&(t=M.subtractAndRoundToNearestAuto(t,this.settings.decimalPlacesRawValue));(t=M.clampToRangeLimits(t,this.settings))!==+a&&(this.set(t),this._triggerEvent(B.events.native.input,e.target)),e.preventDefault(),this._setSelection(i,n),this.isWheelEvent=!1}},{key:"_onDrop",value:function(e){if(!this.formulaMode){var t;this.isDropEvent=!0,e.preventDefault(),t=M.isIE11()?"text":"text/plain";var i=e.dataTransfer.getData(t),n=this.unformatOther(i);this.set(n),this.isDropEvent=!1}}},{key:"_onFormSubmit",value:function(){var t=this;return this._getFormAutoNumericChildren(this.parentForm).map(function(e){return t.constructor.getAutoNumericElement(e)}).forEach(function(e){return e._unformatOnSubmit()}),!0}},{key:"_onFormReset",value:function(){var i=this;this._getFormAutoNumericChildren(this.parentForm).map(function(e){return i.constructor.getAutoNumericElement(e)}).forEach(function(e){var t=i._getDefaultValue(e.node());setTimeout(function(){return e.set(t)},0)})}},{key:"_unformatOnSubmit",value:function(){this.settings.unformatOnSubmit&&this._setElementValue(this.rawValue)}},{key:"_onKeydownGlobal",value:function(e){if(M.character(e)===d.keyName.Alt){var t=M.getHoveredElement();if(B.isManagedByAutoNumeric(t)){var i=B.getAutoNumericElement(t);!i.formulaMode&&i.settings.unformatOnHover&&this.constructor._unformatAltHovered(i)}}}},{key:"_onKeyupGlobal",value:function(e){if(M.character(e)===d.keyName.Alt){var t=M.getHoveredElement();if(B.isManagedByAutoNumeric(t)){var i=B.getAutoNumericElement(t);if(i.formulaMode||!i.settings.unformatOnHover)return;this.constructor._reformatAltHovered(i)}}}},{key:"_isElementTagSupported",value:function(){return M.isElement(this.domElement)||M.throwError("The DOM element is not valid, ".concat(this.domElement," given.")),M.isInArray(this.domElement.tagName.toLowerCase(),this.allowedTagList)}},{key:"_isInputElement",value:function(){return"input"===this.domElement.tagName.toLowerCase()}},{key:"_isInputTypeSupported",value:function(){return"text"===this.domElement.type||"hidden"===this.domElement.type||"tel"===this.domElement.type||M.isUndefinedOrNullOrEmpty(this.domElement.type)}},{key:"_checkElement",value:function(){var e=this.domElement.tagName.toLowerCase();this._isElementTagSupported()||M.throwError("The <".concat(e,"> tag is not supported by autoNumeric")),this._isInputElement()?(this._isInputTypeSupported()||M.throwError('The input type "'.concat(this.domElement.type,'" is not supported by autoNumeric')),this.isInputElement=!0):(this.isInputElement=!1,this.isContentEditable=this.domElement.hasAttribute("contenteditable")&&"true"===this.domElement.getAttribute("contenteditable"))}},{key:"_formatDefaultValueOnPageLoad",value:function(e){var t,i=0<arguments.length&&void 0!==e?e:null,n=!0;if(M.isNull(i)?(t=M.getElementValue(this.domElement).trim(),this.domElement.setAttribute("value",t)):t=i,this.isInputElement||this.isContentEditable){var a=this.constructor._toNumericValue(t,this.settings);if(this.domElement.hasAttribute("value")&&""!==this.domElement.getAttribute("value")){if(null!==this.settings.defaultValueOverride&&this.settings.defaultValueOverride.toString()!==t||null===this.settings.defaultValueOverride&&""!==t&&t!==this.domElement.getAttribute("value")||""!==t&&"hidden"===this.domElement.getAttribute("type")&&!M.isNumber(a)){if(this.settings.saveValueToSessionStorage&&(null!==this.settings.decimalPlacesShownOnFocus||this.settings.divisorWhenUnfocused)&&this._setRawValue(this._getValueFromPersistentStorage()),!this.settings.saveValueToSessionStorage){var r=this.constructor._removeBrackets(t,this.settings);(this.settings.negativePositiveSignPlacement===B.options.negativePositiveSignPlacement.suffix||this.settings.negativePositiveSignPlacement!==B.options.negativePositiveSignPlacement.prefix&&this.settings.currencySymbolPlacement===B.options.currencySymbolPlacement.suffix)&&""!==this.settings.negativeSignCharacter&&M.isNegative(t,this.settings.negativeSignCharacter)?this._setRawValue("-".concat(this.constructor._stripAllNonNumberCharacters(r,this.settings,!0,this.isFocused))):this._setRawValue(this.constructor._stripAllNonNumberCharacters(r,this.settings,!0,this.isFocused))}n=!1}}else isNaN(Number(a))||1/0===a?M.throwError("The value [".concat(t,"] used in the input is not a valid value autoNumeric can work with.")):(this.set(a),n=!1);if(""===t)switch(this.settings.emptyInputBehavior){case B.options.emptyInputBehavior.focus:case B.options.emptyInputBehavior.null:case B.options.emptyInputBehavior.press:break;case B.options.emptyInputBehavior.always:this._setElementValue(this.settings.currencySymbol);break;case B.options.emptyInputBehavior.min:this.set(this.settings.minimumValue);break;case B.options.emptyInputBehavior.max:this.set(this.settings.maximumValue);break;case B.options.emptyInputBehavior.zero:this.set("0");break;default:this.set(this.settings.emptyInputBehavior)}else n&&t===this.domElement.getAttribute("value")&&this.set(t)}else null!==this.settings.defaultValueOverride&&this.settings.defaultValueOverride!==t||this.set(t)}},{key:"_calculateVMinAndVMaxIntegerSizes",value:function(){var e=S(this.settings.maximumValue.toString().split("."),1)[0],t=S(this.settings.minimumValue||0===this.settings.minimumValue?this.settings.minimumValue.toString().split("."):[],1)[0];e=e.replace(this.settings.negativeSignCharacter,""),t=t.replace(this.settings.negativeSignCharacter,""),this.settings.mIntPos=Math.max(e.length,1),this.settings.mIntNeg=Math.max(t.length,1)}},{key:"_calculateValuesToStringsKeys",value:function(){this.settings.valuesToStrings?this.valuesToStringsKeys=Object.keys(this.settings.valuesToStrings):this.valuesToStringsKeys=[]}},{key:"_transformOptionsValuesToDefaultTypes",value:function(){for(var e in this.settings)if(Object.prototype.hasOwnProperty.call(this.settings,e)){var t=this.settings[e];"true"!==t&&"false"!==t||(this.settings[e]="true"===t),"number"==typeof t&&(this.settings[e]=t.toString())}}},{key:"_setSettings",value:function(e,t){var i=1<arguments.length&&void 0!==t&&t;!i&&M.isNull(e)||this.constructor._convertOldOptionsToNewOnes(e),i?("decimalPlacesRawValue"in e&&(this.settings.originalDecimalPlacesRawValue=e.decimalPlacesRawValue),"decimalPlaces"in e&&(this.settings.originalDecimalPlaces=e.decimalPlaces),this.constructor._calculateDecimalPlacesOnUpdate(e,this.settings),this._mergeSettings(e)):(this.settings={},this._mergeSettings(this.constructor.getDefaultConfig(),this.domElement.dataset,e,{rawValue:this.defaultRawValue}),this.caretFix=!1,this.throwInput=!0,this.allowedTagList=d.allowedTagList,this.runOnce=!1,this.hoveredWithAlt=!1),this._transformOptionsValuesToDefaultTypes(),this._runCallbacksFoundInTheSettingsObject(),this.constructor._correctNegativePositiveSignPlacementOption(this.settings),this.constructor._correctCaretPositionOnFocusAndSelectOnFocusOptions(this.settings),this.constructor._setNegativePositiveSignPermissions(this.settings),i||(M.isNull(e)||!e.decimalPlaces?this.settings.originalDecimalPlaces=null:this.settings.originalDecimalPlaces=e.decimalPlaces,this.settings.originalDecimalPlacesRawValue=this.settings.decimalPlacesRawValue,this.constructor._calculateDecimalPlacesOnInit(this.settings)),this._calculateVMinAndVMaxIntegerSizes(),this._setTrailingNegativeSignInfo(),this.regex={},this.constructor._cachesUsualRegularExpressions(this.settings,this.regex),this.constructor._setBrackets(this.settings),this._calculateValuesToStringsKeys(),M.isEmptyObj(this.settings)&&M.throwError("Unable to set the settings, those are invalid ; an empty object was given."),this.constructor.validate(this.settings,!1,e),this._keepAnOriginalSettingsCopy()}},{key:"_preparePastedText",value:function(e){return this.constructor._stripAllNonNumberCharacters(e,this.settings,!0,this.isFocused)}},{key:"_updateInternalProperties",value:function(){this.selection=M.getElementSelection(this.domElement),this.processed=!1}},{key:"_updateEventKeyInfo",value:function(e){this.eventKey=M.character(e)}},{key:"_saveCancellableValue",value:function(){this.savedCancellableValue=this.rawValue}},{key:"_setSelection",value:function(e,t){e=Math.max(e,0),t=Math.min(t,M.getElementValue(this.domElement).length),this.selection={start:e,end:t,length:t-e},M.setElementSelection(this.domElement,e,t)}},{key:"_setCaretPosition",value:function(e){this._setSelection(e,e)}},{key:"_getLeftAndRightPartAroundTheSelection",value:function(){var e=M.getElementValue(this.domElement);return[e.substring(0,this.selection.start),e.substring(this.selection.end,e.length)]}},{key:"_getUnformattedLeftAndRightPartAroundTheSelection",value:function(){var e=S(this._getLeftAndRightPartAroundTheSelection(),2),t=e[0],i=e[1];if(""===t&&""===i)return["",""];var n=!0;return this.eventKey!==d.keyName.Hyphen&&this.eventKey!==d.keyName.Minus||0!==Number(t)||(n=!1),this.isTrailingNegative&&(M.isNegative(i,this.settings.negativeSignCharacter)&&!M.isNegative(t,this.settings.negativeSignCharacter)||""===i&&M.isNegative(t,this.settings.negativeSignCharacter,!0))&&(t=t.replace(this.settings.negativeSignCharacter,""),i=i.replace(this.settings.negativeSignCharacter,""),t=t.replace("-",""),i=i.replace("-",""),t="-".concat(t)),[t=B._stripAllNonNumberCharactersExceptCustomDecimalChar(t,this.settings,n,this.isFocused),i=B._stripAllNonNumberCharactersExceptCustomDecimalChar(i,this.settings,!1,this.isFocused)]}},{key:"_normalizeParts",value:function(e,t){var i=!0;this.eventKey!==d.keyName.Hyphen&&this.eventKey!==d.keyName.Minus||0!==Number(e)||(i=!1),this.isTrailingNegative&&M.isNegative(t,this.settings.negativeSignCharacter)&&!M.isNegative(e,this.settings.negativeSignCharacter)&&(e="-".concat(e),t=t.replace(this.settings.negativeSignCharacter,"")),e=B._stripAllNonNumberCharactersExceptCustomDecimalChar(e,this.settings,i,this.isFocused),t=B._stripAllNonNumberCharactersExceptCustomDecimalChar(t,this.settings,!1,this.isFocused),this.settings.leadingZero!==B.options.leadingZero.deny||this.eventKey!==d.keyName.num0&&this.eventKey!==d.keyName.numpad0||0!==Number(e)||M.contains(e,this.settings.decimalCharacter)||""===t||(e=e.substring(0,e.length-1));var n=e+t;if(this.settings.decimalCharacter){var a=n.match(new RegExp("^".concat(this.regex.aNegRegAutoStrip,"\\").concat(this.settings.decimalCharacter)));a&&(n=(e=e.replace(a[1],a[1]+"0"))+t)}return[e,t,n]}},{key:"_setValueParts",value:function(e,t,i){var n=2<arguments.length&&void 0!==i&&i,a=S(this._normalizeParts(e,t),3),r=a[0],s=a[1],o=a[2],l=S(B._checkIfInRangeWithOverrideOption(o,this.settings),2),u=l[0],c=l[1];if(u&&c){var h=B._truncateDecimalPlaces(o,this.settings,n,this.settings.decimalPlacesRawValue).replace(this.settings.decimalCharacter,".");if(""===h||h===this.settings.negativeSignCharacter){var m;switch(this.settings.emptyInputBehavior){case B.options.emptyInputBehavior.focus:case B.options.emptyInputBehavior.press:case B.options.emptyInputBehavior.always:m="";break;case B.options.emptyInputBehavior.min:m=this.settings.minimumValue;break;case B.options.emptyInputBehavior.max:m=this.settings.maximumValue;break;case B.options.emptyInputBehavior.zero:m="0";break;case B.options.emptyInputBehavior.null:m=null;break;default:m=this.settings.emptyInputBehavior}this._setRawValue(m)}else this._setRawValue(this._trimLeadingAndTrailingZeros(h));var g=B._truncateDecimalPlaces(o,this.settings,n,this.settings.decimalPlacesShownOnFocus),d=r.length;return d>g.length&&(d=g.length),1===d&&"0"===r&&this.settings.leadingZero===B.options.leadingZero.deny&&(d=""===s||"0"===r&&""!==s?1:0),this._setElementValue(g,!1),this._setCaretPosition(d),!0}return this._triggerRangeEvents(u,c),!1}},{key:"_getSignPosition",value:function(){var e;if(this.settings.currencySymbol){var t=this.settings.currencySymbol.length,i=M.getElementValue(this.domElement);if(this.settings.currencySymbolPlacement===B.options.currencySymbolPlacement.prefix)e=this.settings.negativeSignCharacter&&i&&i.charAt(0)===this.settings.negativeSignCharacter?[1,t+1]:[0,t];else{var n=i.length;e=[n-t,n]}}else e=[1e3,-1];return e}},{key:"_expandSelectionOnSign",value:function(){var e=S(this._getSignPosition(),2),t=e[0],i=e[1],n=this.selection;n.start<i&&n.end>t&&((n.start<t||n.end>i)&&M.getElementValue(this.domElement).substring(Math.max(n.start,t),Math.min(n.end,i)).match(/^\s*$/)?n.start<t?this._setSelection(n.start,t):this._setSelection(i,n.end):this._setSelection(Math.min(n.start,t),Math.max(n.end,i)))}},{key:"_checkPaste",value:function(){if(!this.formatted&&!M.isUndefined(this.valuePartsBeforePaste)){var e=this.valuePartsBeforePaste,t=S(this._getLeftAndRightPartAroundTheSelection(),2),i=t[0],n=t[1];delete this.valuePartsBeforePaste;var a=i.substr(0,e[0].length)+B._stripAllNonNumberCharactersExceptCustomDecimalChar(i.substr(e[0].length),this.settings,!0,this.isFocused);this._setValueParts(a,n,!0)||(this._setElementValue(e.join(""),!1),this._setCaretPosition(e[0].length))}}},{key:"_processNonPrintableKeysAndShortcuts",value:function(e){if((e.ctrlKey||e.metaKey)&&"keyup"===e.type&&!M.isUndefined(this.valuePartsBeforePaste)||e.shiftKey&&this.eventKey===d.keyName.Insert)return this._checkPaste(),!1;if(this.constructor._shouldSkipEventKey(this.eventKey))return!0;if((e.ctrlKey||e.metaKey)&&this.eventKey===d.keyName.a)return this.settings.selectNumberOnly&&(e.preventDefault(),this.selectNumber()),!0;if((e.ctrlKey||e.metaKey)&&(this.eventKey===d.keyName.c||this.eventKey===d.keyName.v||this.eventKey===d.keyName.x))return"keydown"===e.type&&this._expandSelectionOnSign(),this.eventKey!==d.keyName.v&&this.eventKey!==d.keyName.Insert||("keydown"===e.type||"keypress"===e.type?M.isUndefined(this.valuePartsBeforePaste)&&(this.valuePartsBeforePaste=this._getLeftAndRightPartAroundTheSelection()):this._checkPaste()),"keydown"===e.type||"keypress"===e.type||this.eventKey===d.keyName.c;if(e.ctrlKey||e.metaKey)return!(this.eventKey===d.keyName.Z||this.eventKey===d.keyName.z);if(this.eventKey!==d.keyName.LeftArrow&&this.eventKey!==d.keyName.RightArrow)return M.isInArray(this.eventKey,d.keyName._directionKeys);if("keydown"===e.type&&!e.shiftKey){var t=M.getElementValue(this.domElement);this.eventKey!==d.keyName.LeftArrow||t.charAt(this.selection.start-2)!==this.settings.digitGroupSeparator&&t.charAt(this.selection.start-2)!==this.settings.decimalCharacter?this.eventKey!==d.keyName.RightArrow||t.charAt(this.selection.start+1)!==this.settings.digitGroupSeparator&&t.charAt(this.selection.start+1)!==this.settings.decimalCharacter||this._setCaretPosition(this.selection.start+1):this._setCaretPosition(this.selection.start-1)}return!0}},{key:"_processCharacterDeletionIfTrailingNegativeSign",value:function(e){var t=S(e,2),i=t[0],n=t[1],a=M.getElementValue(this.domElement),r=M.isNegative(a,this.settings.negativeSignCharacter);if(this.settings.currencySymbolPlacement===B.options.currencySymbolPlacement.prefix&&this.settings.negativePositiveSignPlacement===B.options.negativePositiveSignPlacement.suffix&&(this.eventKey===d.keyName.Backspace?(this.caretFix=this.selection.start>=a.indexOf(this.settings.suffixText)&&""!==this.settings.suffixText,"-"===a.charAt(this.selection.start-1)?i=i.substring(1):this.selection.start<=a.length-this.settings.suffixText.length&&(i=i.substring(0,i.length-1))):(this.caretFix=this.selection.start>=a.indexOf(this.settings.suffixText)&&""!==this.settings.suffixText,this.selection.start>=a.indexOf(this.settings.currencySymbol)+this.settings.currencySymbol.length&&(n=n.substring(1,n.length)),M.isNegative(i,this.settings.negativeSignCharacter)&&"-"===a.charAt(this.selection.start)&&(i=i.substring(1)))),this.settings.currencySymbolPlacement===B.options.currencySymbolPlacement.suffix)switch(this.settings.negativePositiveSignPlacement){case B.options.negativePositiveSignPlacement.left:this.caretFix=this.selection.start>=a.indexOf(this.settings.negativeSignCharacter)+this.settings.negativeSignCharacter.length,this.eventKey===d.keyName.Backspace?this.selection.start===a.indexOf(this.settings.negativeSignCharacter)+this.settings.negativeSignCharacter.length&&r?i=i.substring(1):"-"!==i&&(this.selection.start<=a.indexOf(this.settings.negativeSignCharacter)||!r)&&(i=i.substring(0,i.length-1)):("-"===i[0]&&(n=n.substring(1)),this.selection.start===a.indexOf(this.settings.negativeSignCharacter)&&r&&(i=i.substring(1)));break;case B.options.negativePositiveSignPlacement.right:this.caretFix=this.selection.start>=a.indexOf(this.settings.negativeSignCharacter)+this.settings.negativeSignCharacter.length,this.eventKey===d.keyName.Backspace?this.selection.start===a.indexOf(this.settings.negativeSignCharacter)+this.settings.negativeSignCharacter.length?i=i.substring(1):("-"!==i&&this.selection.start<=a.indexOf(this.settings.negativeSignCharacter)-this.settings.currencySymbol.length||""!==i&&!r)&&(i=i.substring(0,i.length-1)):(this.caretFix=this.selection.start>=a.indexOf(this.settings.currencySymbol)&&""!==this.settings.currencySymbol,this.selection.start===a.indexOf(this.settings.negativeSignCharacter)&&(i=i.substring(1)),n=n.substring(1))}return[i,n]}},{key:"_processCharacterDeletion",value:function(){var e,t;if(this.selection.length){this._expandSelectionOnSign();var i=S(this._getUnformattedLeftAndRightPartAroundTheSelection(),2);e=i[0],t=i[1]}else{var n=S(this._getUnformattedLeftAndRightPartAroundTheSelection(),2);if(e=n[0],t=n[1],""===e&&""===t&&(this.throwInput=!1),this.isTrailingNegative&&M.isNegative(M.getElementValue(this.domElement),this.settings.negativeSignCharacter)){var a=S(this._processCharacterDeletionIfTrailingNegativeSign([e,t]),2);e=a[0],t=a[1]}else this.eventKey===d.keyName.Backspace?e=e.substring(0,e.length-1):t=t.substring(1,t.length)}return!!this.constructor._isWithinRangeWithOverrideOption("".concat(e).concat(t),this.settings)&&(this._setValueParts(e,t),!0)}},{key:"_isDecimalCharacterInsertionAllowed",value:function(){return String(this.settings.decimalPlacesShownOnFocus)!==String(B.options.decimalPlacesShownOnFocus.none)&&String(this.settings.decimalPlaces)!==String(B.options.decimalPlaces.none)}},{key:"_processCharacterInsertion",value:function(){var e=S(this._getUnformattedLeftAndRightPartAroundTheSelection(),2),t=e[0],i=e[1];if(this.eventKey!==d.keyName.AndroidDefault&&(this.throwInput=!0),this.eventKey===this.settings.decimalCharacter||this.settings.decimalCharacterAlternative&&this.eventKey===this.settings.decimalCharacterAlternative){if(!this._isDecimalCharacterInsertionAllowed()||!this.settings.decimalCharacter)return!1;if(this.settings.alwaysAllowDecimalCharacter)t=t.replace(this.settings.decimalCharacter,""),i=i.replace(this.settings.decimalCharacter,"");else{if(M.contains(t,this.settings.decimalCharacter))return!0;if(0<i.indexOf(this.settings.decimalCharacter))return!0;0===i.indexOf(this.settings.decimalCharacter)&&(i=i.substr(1))}return this.settings.negativeSignCharacter&&M.contains(i,this.settings.negativeSignCharacter)&&(t="".concat(this.settings.negativeSignCharacter).concat(t),i=i.replace(this.settings.negativeSignCharacter,"")),this._setValueParts(t+this.settings.decimalCharacter,i),!0}if(("-"===this.eventKey||"+"===this.eventKey)&&this.settings.isNegativeSignAllowed)return""===t&&M.contains(i,"-")?i=i.replace("-",""):t=M.isNegativeStrict(t,"-")?t.replace("-",""):"".concat(this.settings.negativeSignCharacter).concat(t),this._setValueParts(t,i),!0;var n=Number(this.eventKey);return 0<=n&&n<=9?(this.settings.isNegativeSignAllowed&&""===t&&M.contains(i,"-")&&(t="-",i=i.substring(1,i.length)),this.settings.maximumValue<=0&&this.settings.minimumValue<this.settings.maximumValue&&!M.contains(M.getElementValue(this.domElement),this.settings.negativeSignCharacter)&&"0"!==this.eventKey&&(t="-".concat(t)),this._setValueParts("".concat(t).concat(this.eventKey),i),!0):this.throwInput=!1}},{key:"_formatValue",value:function(e){var t=M.getElementValue(this.domElement),i=S(this._getUnformattedLeftAndRightPartAroundTheSelection(),1)[0];if((""===this.settings.digitGroupSeparator||""!==this.settings.digitGroupSeparator&&!M.contains(t,this.settings.digitGroupSeparator))&&(""===this.settings.currencySymbol||""!==this.settings.currencySymbol&&!M.contains(t,this.settings.currencySymbol))){var n=S(t.split(this.settings.decimalCharacter),1)[0],a="";M.isNegative(n,this.settings.negativeSignCharacter)&&(a=this.settings.negativeSignCharacter,n=n.replace(this.settings.negativeSignCharacter,""),i=i.replace("-","")),""===a&&n.length>this.settings.mIntPos&&"0"===i.charAt(0)&&(i=i.slice(1)),a===this.settings.negativeSignCharacter&&n.length>this.settings.mIntNeg&&"0"===i.charAt(0)&&(i=i.slice(1)),this.isTrailingNegative||(i="".concat(a).concat(i))}var r=this.constructor._addGroupSeparators(t,this.settings,this.isFocused,this.rawValue),s=r.length;if(r){var o,l=i.split("");if((this.settings.negativePositiveSignPlacement===B.options.negativePositiveSignPlacement.suffix||this.settings.negativePositiveSignPlacement!==B.options.negativePositiveSignPlacement.prefix&&this.settings.currencySymbolPlacement===B.options.currencySymbolPlacement.suffix)&&l[0]===this.settings.negativeSignCharacter&&!this.settings.isNegativeSignAllowed&&(l.shift(),(this.eventKey===d.keyName.Backspace||this.eventKey===d.keyName.Delete)&&this.caretFix&&((this.settings.currencySymbolPlacement===B.options.currencySymbolPlacement.suffix&&this.settings.negativePositiveSignPlacement===B.options.negativePositiveSignPlacement.left||this.settings.currencySymbolPlacement===B.options.currencySymbolPlacement.prefix&&this.settings.negativePositiveSignPlacement===B.options.negativePositiveSignPlacement.suffix)&&(l.push(this.settings.negativeSignCharacter),this.caretFix="keydown"===e.type),this.settings.currencySymbolPlacement===B.options.currencySymbolPlacement.suffix&&this.settings.negativePositiveSignPlacement===B.options.negativePositiveSignPlacement.right))){var u=this.settings.currencySymbol.split(""),c=["\\","^","$",".","|","?","*","+","(",")","["],h=[];u.forEach(function(e,t){t=u[e],M.isInArray(t,c)?h.push("\\"+t):h.push(t)}),this.eventKey===d.keyName.Backspace&&"-"===this.settings.negativeSignCharacter&&h.push("-"),l.push(h.join("")),this.caretFix="keydown"===e.type}for(var m=0;m<l.length;m++)l[m].match("\\d")||(l[m]="\\"+l[m]);o=this.settings.currencySymbolPlacement===B.options.currencySymbolPlacement.suffix?new RegExp("^.*?".concat(l.join(".*?"))):new RegExp("^.*?".concat(this.settings.currencySymbol).concat(l.join(".*?")));var g=r.match(o);g?(s=g[0].length,this.settings.showPositiveSign&&(0===s&&g.input.charAt(0)===this.settings.positiveSignCharacter&&(s=1===g.input.indexOf(this.settings.currencySymbol)?this.settings.currencySymbol.length+1:1),0===s&&g.input.charAt(this.settings.currencySymbol.length)===this.settings.positiveSignCharacter&&(s=this.settings.currencySymbol.length+1)),(0===s&&r.charAt(0)!==this.settings.negativeSignCharacter||1===s&&r.charAt(0)===this.settings.negativeSignCharacter)&&this.settings.currencySymbol&&this.settings.currencySymbolPlacement===B.options.currencySymbolPlacement.prefix&&(s=this.settings.currencySymbol.length+(M.isNegativeStrict(r,this.settings.negativeSignCharacter)?1:0))):(this.settings.currencySymbol&&this.settings.currencySymbolPlacement===B.options.currencySymbolPlacement.suffix&&(s-=this.settings.currencySymbol.length),this.settings.suffixText&&(s-=this.settings.suffixText.length))}r!==t&&(this._setElementValue(r,!1),this._setCaretPosition(s)),this.formatted=!0}}]),P(e,t),B}();function N(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var i=document.createEvent("CustomEvent");return i.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),i}k.multiple=function(e){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=[];if(M.isObject(i)&&(t=i,i=null),M.isString(e))e=p(document.querySelectorAll(e));else if(M.isObject(e)){Object.prototype.hasOwnProperty.call(e,"rootElement")||M.throwError("The object passed to the 'multiple' function is invalid ; no 'rootElement' attribute found.");var a=p(e.rootElement.querySelectorAll("input"));e=Object.prototype.hasOwnProperty.call(e,"exclude")?(Array.isArray(e.exclude)||M.throwError("The 'exclude' array passed to the 'multiple' function is invalid."),M.filterOut(a,e.exclude)):a}else M.isArray(e)||M.throwError("The given parameters to the 'multiple' function are invalid.");if(0===e.length){var r=!0;return!M.isNull(t)&&M.isBoolean(t.showWarnings)&&(r=t.showWarnings),M.warning("No valid DOM elements were given hence no AutoNumeric objects were instantiated.",r),[]}var s=M.isArray(i)&&1<=i.length,o=!1,l=!1;if(s){var u=w(Number(i[0]));(o="number"===u&&!isNaN(Number(i[0])))||"string"!==u&&!isNaN(u)&&"object"!==u||(l=!0)}var c,h=!1;if(M.isArray(t)&&1<=t.length){var m=w(t[0]);"string"!==m&&"object"!==m||(h=!0)}c=l?k.mergeOptions(i):h?k.mergeOptions(t):t;var g,d=M.isNumber(i);return o&&(g=i.length),e.forEach(function(e,t){d?n.push(new k(e,i,c)):o&&t<=g?n.push(new k(e,i[t],c)):n.push(new k(e,null,c))}),n},Array.from||(Array.from=function(e){return[].slice.call(e)}),"undefined"!=typeof window&&"function"!=typeof window.CustomEvent&&(N.prototype=window.Event.prototype,window.CustomEvent=N),k.events={correctedValue:"autoNumeric:correctedValue",initialized:"autoNumeric:initialized",invalidFormula:"autoNumeric:invalidFormula",invalidValue:"autoNumeric:invalidValue",formatted:"autoNumeric:formatted",rawValueModified:"autoNumeric:rawValueModified",minRangeExceeded:"autoNumeric:minExceeded",maxRangeExceeded:"autoNumeric:maxExceeded",native:{input:"input",change:"change"},validFormula:"autoNumeric:validFormula"},Object.freeze(k.events.native),Object.freeze(k.events),Object.defineProperty(k,"events",{configurable:!1,writable:!1}),k.options={allowDecimalPadding:{always:!0,never:!1,floats:"floats"},alwaysAllowDecimalCharacter:{alwaysAllow:!0,doNotAllow:!1},caretPositionOnFocus:{start:"start",end:"end",decimalLeft:"decimalLeft",decimalRight:"decimalRight",doNoForceCaretPosition:null},createLocalList:{createList:!0,doNotCreateList:!1},currencySymbol:{none:"",currencySign:"",austral:"",australCentavo:"",baht:"",cedi:"",cent:"",colon:"",cruzeiro:"",dollar:"$",dong:"",drachma:"",dram:"",european:"",euro:"",florin:"",franc:"",guarani:"",hryvnia:"",kip:"",att:"",lepton:".",lira:"",liraOld:"",lari:"",mark:"",mill:"",naira:"",peseta:"",peso:"",pfennig:"",pound:"",real:"R$",riel:"",ruble:"",rupee:"",rupeeOld:"",shekel:"",shekelAlt:"",taka:"",tenge:"",togrog:"",won:"",yen:""},currencySymbolPlacement:{prefix:"p",suffix:"s"},decimalCharacter:{comma:",",dot:".",middleDot:"",arabicDecimalSeparator:"",decimalSeparatorKeySymbol:""},decimalCharacterAlternative:{none:null,comma:",",dot:"."},decimalPlaces:{none:0,one:1,two:2,three:3,four:4,five:5,six:6},decimalPlacesRawValue:{useDefault:null,none:0,one:1,two:2,three:3,four:4,five:5,six:6},decimalPlacesShownOnBlur:{useDefault:null,none:0,one:1,two:2,three:3,four:4,five:5,six:6},decimalPlacesShownOnFocus:{useDefault:null,none:0,one:1,two:2,three:3,four:4,five:5,six:6},defaultValueOverride:{doNotOverride:null},digitalGroupSpacing:{two:"2",twoScaled:"2s",three:"3",four:"4"},digitGroupSeparator:{comma:",",dot:".",normalSpace:" ",thinSpace:"",narrowNoBreakSpace:"",noBreakSpace:"",noSeparator:"",apostrophe:"'",arabicThousandsSeparator:"",dotAbove:"",privateUseTwo:""},divisorWhenUnfocused:{none:null,percentage:100,permille:1e3,basisPoint:1e4},emptyInputBehavior:{focus:"focus",press:"press",always:"always",zero:"zero",min:"min",max:"max",null:"null"},eventBubbles:{bubbles:!0,doesNotBubble:!1},eventIsCancelable:{isCancelable:!0,isNotCancelable:!1},failOnUnknownOption:{fail:!0,ignore:!1},formatOnPageLoad:{format:!0,doNotFormat:!1},formulaMode:{enabled:!0,disabled:!1},historySize:{verySmall:5,small:10,medium:20,large:50,veryLarge:100,insane:Number.MAX_SAFE_INTEGER},invalidClass:"an-invalid",isCancellable:{cancellable:!0,notCancellable:!1},leadingZero:{allow:"allow",deny:"deny",keep:"keep"},maximumValue:{tenTrillions:"10000000000000",oneBillion:"1000000000",zero:"0"},minimumValue:{tenTrillions:"-10000000000000",oneBillion:"-1000000000",zero:"0"},modifyValueOnWheel:{modifyValue:!0,doNothing:!1},negativeBracketsTypeOnBlur:{parentheses:"(,)",brackets:"[,]",chevrons:"<,>",curlyBraces:"{,}",angleBrackets:",",japaneseQuotationMarks:",",halfBrackets:",",whiteSquareBrackets:",",quotationMarks:",",guillemets:",",none:null},negativePositiveSignPlacement:{prefix:"p",suffix:"s",left:"l",right:"r",none:null},negativeSignCharacter:{hyphen:"-",minus:"",heavyMinus:"",fullWidthHyphen:"",circledMinus:"",squaredMinus:"",triangleMinus:"",plusMinus:"",minusPlus:"",dotMinus:"",minusTilde:"",not:""},noEventListeners:{noEvents:!0,addEvents:!1},onInvalidPaste:{error:"error",ignore:"ignore",clamp:"clamp",truncate:"truncate",replace:"replace"},outputFormat:{string:"string",number:"number",dot:".",negativeDot:"-.",comma:",",negativeComma:"-,",dotNegative:".-",commaNegative:",-",none:null},overrideMinMaxLimits:{ceiling:"ceiling",floor:"floor",ignore:"ignore",invalid:"invalid",doNotOverride:null},positiveSignCharacter:{plus:"+",fullWidthPlus:"",heavyPlus:"",doublePlus:"",triplePlus:"",circledPlus:"",squaredPlus:"",trianglePlus:"",plusMinus:"",minusPlus:"",dotPlus:"",altHebrewPlus:"",normalSpace:" ",thinSpace:"",narrowNoBreakSpace:"",noBreakSpace:""},rawValueDivisor:{none:null,percentage:100,permille:1e3,basisPoint:1e4},readOnly:{readOnly:!0,readWrite:!1},roundingMethod:{halfUpSymmetric:"S",halfUpAsymmetric:"A",halfDownSymmetric:"s",halfDownAsymmetric:"a",halfEvenBankersRounding:"B",upRoundAwayFromZero:"U",downRoundTowardZero:"D",toCeilingTowardPositiveInfinity:"C",toFloorTowardNegativeInfinity:"F",toNearest05:"N05",toNearest05Alt:"CHF",upToNext05:"U05",downToNext05:"D05"},saveValueToSessionStorage:{save:!0,doNotSave:!1},selectNumberOnly:{selectNumbersOnly:!0,selectAll:!1},selectOnFocus:{select:!0,doNotSelect:!1},serializeSpaces:{plus:"+",percent:"%20"},showOnlyNumbersOnFocus:{onlyNumbers:!0,showAll:!1},showPositiveSign:{show:!0,hide:!1},showWarnings:{show:!0,hide:!1},styleRules:{none:null,positiveNegative:{positive:"autoNumeric-positive",negative:"autoNumeric-negative"},range0To100With4Steps:{ranges:[{min:0,max:25,class:"autoNumeric-red"},{min:25,max:50,class:"autoNumeric-orange"},{min:50,max:75,class:"autoNumeric-yellow"},{min:75,max:100,class:"autoNumeric-green"}]},evenOdd:{userDefined:[{callback:function(e){return e%2==0},classes:["autoNumeric-even","autoNumeric-odd"]}]},rangeSmallAndZero:{userDefined:[{callback:function(e){return-1<=e&&e<0?0:0===Number(e)?1:0<e&&e<=1?2:null},classes:["autoNumeric-small-negative","autoNumeric-zero","autoNumeric-small-positive"]}]}},suffixText:{none:"",percentage:"%",permille:"",basisPoint:""},symbolWhenUnfocused:{none:null,percentage:"%",permille:"",basisPoint:""},unformatOnHover:{unformat:!0,doNotUnformat:!1},unformatOnSubmit:{unformat:!0,keepCurrentValue:!1},valuesToStrings:{none:null,zeroDash:{0:"-"},oneAroundZero:{"-1":"Min",1:"Max"}},watchExternalChanges:{watch:!0,doNotWatch:!1},wheelOn:{focus:"focus",hover:"hover"},wheelStep:{progressive:"progressive"}},O=k.options,Object.getOwnPropertyNames(O).forEach(function(e){"valuesToStrings"===e?Object.getOwnPropertyNames(O.valuesToStrings).forEach(function(e){M.isIE11()||null===O.valuesToStrings[e]||Object.freeze(O.valuesToStrings[e])}):"styleRules"!==e&&(M.isIE11()||null===O[e]||Object.freeze(O[e]))}),Object.freeze(O),Object.defineProperty(k,"options",{configurable:!1,writable:!1}),k.defaultSettings={allowDecimalPadding:k.options.allowDecimalPadding.always,alwaysAllowDecimalCharacter:k.options.alwaysAllowDecimalCharacter.doNotAllow,caretPositionOnFocus:k.options.caretPositionOnFocus.doNoForceCaretPosition,createLocalList:k.options.createLocalList.createList,currencySymbol:k.options.currencySymbol.none,currencySymbolPlacement:k.options.currencySymbolPlacement.prefix,decimalCharacter:k.options.decimalCharacter.dot,decimalCharacterAlternative:k.options.decimalCharacterAlternative.none,decimalPlaces:k.options.decimalPlaces.two,decimalPlacesRawValue:k.options.decimalPlacesRawValue.useDefault,decimalPlacesShownOnBlur:k.options.decimalPlacesShownOnBlur.useDefault,decimalPlacesShownOnFocus:k.options.decimalPlacesShownOnFocus.useDefault,defaultValueOverride:k.options.defaultValueOverride.doNotOverride,digitalGroupSpacing:k.options.digitalGroupSpacing.three,digitGroupSeparator:k.options.digitGroupSeparator.comma,divisorWhenUnfocused:k.options.divisorWhenUnfocused.none,emptyInputBehavior:k.options.emptyInputBehavior.focus,eventBubbles:k.options.eventBubbles.bubbles,eventIsCancelable:k.options.eventIsCancelable.isCancelable,failOnUnknownOption:k.options.failOnUnknownOption.ignore,formatOnPageLoad:k.options.formatOnPageLoad.format,formulaMode:k.options.formulaMode.disabled,historySize:k.options.historySize.medium,invalidClass:k.options.invalidClass,isCancellable:k.options.isCancellable.cancellable,leadingZero:k.options.leadingZero.deny,maximumValue:k.options.maximumValue.tenTrillions,minimumValue:k.options.minimumValue.tenTrillions,modifyValueOnWheel:k.options.modifyValueOnWheel.modifyValue,negativeBracketsTypeOnBlur:k.options.negativeBracketsTypeOnBlur.none,negativePositiveSignPlacement:k.options.negativePositiveSignPlacement.none,negativeSignCharacter:k.options.negativeSignCharacter.hyphen,noEventListeners:k.options.noEventListeners.addEvents,onInvalidPaste:k.options.onInvalidPaste.error,outputFormat:k.options.outputFormat.none,overrideMinMaxLimits:k.options.overrideMinMaxLimits.doNotOverride,positiveSignCharacter:k.options.positiveSignCharacter.plus,rawValueDivisor:k.options.rawValueDivisor.none,readOnly:k.options.readOnly.readWrite,roundingMethod:k.options.roundingMethod.halfUpSymmetric,saveValueToSessionStorage:k.options.saveValueToSessionStorage.doNotSave,selectNumberOnly:k.options.selectNumberOnly.selectNumbersOnly,selectOnFocus:k.options.selectOnFocus.select,serializeSpaces:k.options.serializeSpaces.plus,showOnlyNumbersOnFocus:k.options.showOnlyNumbersOnFocus.showAll,showPositiveSign:k.options.showPositiveSign.hide,showWarnings:k.options.showWarnings.show,styleRules:k.options.styleRules.none,suffixText:k.options.suffixText.none,symbolWhenUnfocused:k.options.symbolWhenUnfocused.none,unformatOnHover:k.options.unformatOnHover.unformat,unformatOnSubmit:k.options.unformatOnSubmit.keepCurrentValue,valuesToStrings:k.options.valuesToStrings.none,watchExternalChanges:k.options.watchExternalChanges.doNotWatch,wheelOn:k.options.wheelOn.focus,wheelStep:k.options.wheelStep.progressive},Object.freeze(k.defaultSettings),Object.defineProperty(k,"defaultSettings",{configurable:!1,writable:!1});var E={digitGroupSeparator:k.options.digitGroupSeparator.dot,decimalCharacter:k.options.decimalCharacter.comma,decimalCharacterAlternative:k.options.decimalCharacterAlternative.dot,currencySymbol:"",currencySymbolPlacement:k.options.currencySymbolPlacement.suffix,negativePositiveSignPlacement:k.options.negativePositiveSignPlacement.prefix},_={digitGroupSeparator:k.options.digitGroupSeparator.comma,decimalCharacter:k.options.decimalCharacter.dot,currencySymbol:k.options.currencySymbol.dollar,currencySymbolPlacement:k.options.currencySymbolPlacement.prefix,negativePositiveSignPlacement:k.options.negativePositiveSignPlacement.right},C={digitGroupSeparator:k.options.digitGroupSeparator.comma,decimalCharacter:k.options.decimalCharacter.dot,currencySymbol:k.options.currencySymbol.yen,currencySymbolPlacement:k.options.currencySymbolPlacement.prefix,negativePositiveSignPlacement:k.options.negativePositiveSignPlacement.right};M.cloneObject(E).formulaMode=k.options.formulaMode.enabled;var F=M.cloneObject(E);F.minimumValue=0;var x=M.cloneObject(E);x.maximumValue=0,x.negativePositiveSignPlacement=k.options.negativePositiveSignPlacement.prefix;var V=M.cloneObject(E);V.digitGroupSeparator=k.options.digitGroupSeparator.normalSpace;var T=M.cloneObject(V);T.minimumValue=0;var A=M.cloneObject(V);A.maximumValue=0,A.negativePositiveSignPlacement=k.options.negativePositiveSignPlacement.prefix;var L=M.cloneObject(E);L.currencySymbol=k.options.currencySymbol.none,L.suffixText="".concat(k.options.suffixText.percentage),L.wheelStep=1e-4,L.rawValueDivisor=k.options.rawValueDivisor.percentage;var I=M.cloneObject(L);I.minimumValue=0;var B=M.cloneObject(L);B.maximumValue=0,B.negativePositiveSignPlacement=k.options.negativePositiveSignPlacement.prefix;var D=M.cloneObject(L);D.decimalPlaces=3;var R=M.cloneObject(I);R.decimalPlaces=3;var U=M.cloneObject(B);U.decimalPlaces=3,M.cloneObject(_).formulaMode=k.options.formulaMode.enabled;var j=M.cloneObject(_);j.minimumValue=0;var z=M.cloneObject(_);z.maximumValue=0,z.negativePositiveSignPlacement=k.options.negativePositiveSignPlacement.prefix;var K=M.cloneObject(z);K.negativeBracketsTypeOnBlur=k.options.negativeBracketsTypeOnBlur.parentheses;var G=M.cloneObject(_);G.currencySymbol=k.options.currencySymbol.none,G.suffixText=k.options.suffixText.percentage,G.wheelStep=1e-4,G.rawValueDivisor=k.options.rawValueDivisor.percentage;var W=M.cloneObject(G);W.minimumValue=0;var H=M.cloneObject(G);H.maximumValue=0,H.negativePositiveSignPlacement=k.options.negativePositiveSignPlacement.prefix;var Z=M.cloneObject(G);Z.decimalPlaces=3;var q=M.cloneObject(W);q.decimalPlaces=3;var $=M.cloneObject(H);$.decimalPlaces=3;var J=M.cloneObject(E);J.currencySymbol=k.options.currencySymbol.lira,k.predefinedOptions={euro:E,euroPos:F,euroNeg:x,euroSpace:V,euroSpacePos:T,euroSpaceNeg:A,percentageEU2dec:L,percentageEU2decPos:I,percentageEU2decNeg:B,percentageEU3dec:D,percentageEU3decPos:R,percentageEU3decNeg:U,dollar:_,dollarPos:j,dollarNeg:z,dollarNegBrackets:K,percentageUS2dec:G,percentageUS2decPos:W,percentageUS2decNeg:H,percentageUS3dec:Z,percentageUS3decPos:q,percentageUS3decNeg:$,French:E,Spanish:E,NorthAmerican:_,British:{digitGroupSeparator:k.options.digitGroupSeparator.comma,decimalCharacter:k.options.decimalCharacter.dot,currencySymbol:k.options.currencySymbol.pound,currencySymbolPlacement:k.options.currencySymbolPlacement.prefix,negativePositiveSignPlacement:k.options.negativePositiveSignPlacement.right},Swiss:{digitGroupSeparator:k.options.digitGroupSeparator.apostrophe,decimalCharacter:k.options.decimalCharacter.dot,currencySymbol:"CHF",currencySymbolPlacement:k.options.currencySymbolPlacement.suffix,negativePositiveSignPlacement:k.options.negativePositiveSignPlacement.prefix},Japanese:C,Chinese:C,Brazilian:{digitGroupSeparator:k.options.digitGroupSeparator.dot,decimalCharacter:k.options.decimalCharacter.comma,currencySymbol:k.options.currencySymbol.real,currencySymbolPlacement:k.options.currencySymbolPlacement.prefix,negativePositiveSignPlacement:k.options.negativePositiveSignPlacement.right},Turkish:J,dotDecimalCharCommaSeparator:{digitGroupSeparator:k.options.digitGroupSeparator.comma,decimalCharacter:k.options.decimalCharacter.dot},commaDecimalCharDotSeparator:{digitGroupSeparator:k.options.digitGroupSeparator.dot,decimalCharacter:k.options.decimalCharacter.comma,decimalCharacterAlternative:k.options.decimalCharacterAlternative.dot},integer:{decimalPlaces:0},integerPos:{minimumValue:k.options.minimumValue.zero,decimalPlaces:0},integerNeg:{maximumValue:k.options.maximumValue.zero,decimalPlaces:0},float:{allowDecimalPadding:k.options.allowDecimalPadding.never},floatPos:{allowDecimalPadding:k.options.allowDecimalPadding.never,minimumValue:k.options.minimumValue.zero,maximumValue:k.options.maximumValue.tenTrillions},floatNeg:{allowDecimalPadding:k.options.allowDecimalPadding.never,minimumValue:k.options.minimumValue.tenTrillions,maximumValue:k.options.maximumValue.zero},numeric:{digitGroupSeparator:k.options.digitGroupSeparator.noSeparator,decimalCharacter:k.options.decimalCharacter.dot,currencySymbol:k.options.currencySymbol.none},numericPos:{digitGroupSeparator:k.options.digitGroupSeparator.noSeparator,decimalCharacter:k.options.decimalCharacter.dot,currencySymbol:k.options.currencySymbol.none,minimumValue:k.options.minimumValue.zero,maximumValue:k.options.maximumValue.tenTrillions},numericNeg:{digitGroupSeparator:k.options.digitGroupSeparator.noSeparator,decimalCharacter:k.options.decimalCharacter.dot,currencySymbol:k.options.currencySymbol.none,minimumValue:k.options.minimumValue.tenTrillions,maximumValue:k.options.maximumValue.zero}},Object.getOwnPropertyNames(k.predefinedOptions).forEach(function(e){Object.freeze(k.predefinedOptions[e])}),Object.freeze(k.predefinedOptions),Object.defineProperty(k,"predefinedOptions",{configurable:!1,writable:!1}),t.default=k}],a.c=n,a.d=function(e,t,i){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(a.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)a.d(i,n,function(e){return t[e]}.bind(null,n));return i},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=0).default;function a(e){if(n[e])return n[e].exports;var t=n[e]={i:e,l:!1,exports:{}};return i[e].call(t.exports,t,t.exports,a),t.l=!0,t.exports}var i,n});
//# sourceMappingURL=autoNumeric.min.js.map;